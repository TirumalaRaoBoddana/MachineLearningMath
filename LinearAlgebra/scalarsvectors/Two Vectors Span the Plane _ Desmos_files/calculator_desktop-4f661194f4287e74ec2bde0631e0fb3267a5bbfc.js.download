(() => {
  const __dcg_shared_module_source__ = "// shared.js\n  (() => {\n    const __dcg_chunk_exports__ = {};var TA=Object.create;var Eh=Object.defineProperty;var IA=Object.getOwnPropertyDescriptor;var EA=Object.getOwnPropertyNames;var MA=Object.getPrototypeOf,vA=Object.prototype.hasOwnProperty;var Uk=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,r)=>(typeof require!=\"undefined\"?require:t)[r]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw Error('Dynamic require of \"'+e+'\" is not supported')});var qk=(e,t)=>()=>(e&&(t=e(e=0)),t);var $k=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),wo=(e,t)=>{for(var r in t)Eh(e,r,{get:t[r],enumerable:!0})},DA=(e,t,r,n)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let i of EA(t))!vA.call(e,i)&&i!==r&&Eh(e,i,{get:()=>t[i],enumerable:!(n=IA(t,i))||n.enumerable});return e};var Yk=(e,t,r)=>(r=e!=null?TA(MA(e)):{},DA(t||!e||!e.__esModule?Eh(r,\"default\",{value:e,enumerable:!0}):r,e));var Xk=(()=>{for(var e=new Uint8Array(128),t=0;t<64;t++)e[t<26?t+65:t<52?t+71:t<62?t-4:t*4-205]=t;return r=>{for(var n=r.length,i=new Uint8Array((n-(r[n-1]==\"=\")-(r[n-2]==\"=\"))*3/4|0),s=0,o=0;s<n;){var a=e[r.charCodeAt(s++)],u=e[r.charCodeAt(s++)],c=e[r.charCodeAt(s++)],l=e[r.charCodeAt(s++)];i[o++]=a<<2|u>>4,i[o++]=u<<4|c>>2,i[o++]=c<<6|l}return i}})();var lM=function(){{var e=function(){},t=[\"log\",\"info\",\"warn\",\"error\",\"assert\",\"dir\",\"clear\",\"profile\",\"profileEnd\",\"time\",\"timeEnd\",\"group\",\"groupCollapsed\",\"groupEnd\",\"trace\"],r={},n=function(i){typeof window!=\"undefined\"&&window.console&&window.console[i]?r[i]=function(){Function.prototype.apply.call(window.console[i],window.console,arguments)}:r[i]=e};return t.forEach(n),r}}(),Wk=lM,{log:jk,warn:Jk,error:Qk,assert:Kk,dir:eH,clear:tH,profile:rH,profileEnd:nH,time:iH,timeEnd:sH,group:oH,groupCollapsed:aH,groupEnd:uH,trace:cH}=lM;var Ud={};wo(Ud,{getFrame:()=>N_});function gi(e,t,r){return{input:e,start:t,end:r}}function so(e,t){return gi(e,t,t)}function Qn(e,t){if(e.input!==t.input)throw new Error(\"Programming Error: cannot form a span on different inputs\");return gi(e.input,e.start,t.end)}function Sr(e){return e.input.slice(e.start,e.end)}var ca=()=>({type:\"empty\"}),Xr=()=>SA([-1/0,1/0]),Fo=()=>Ji([-1/0,1/0]),Ji=e=>vd(e,!0),SA=e=>vd(e,!1),vd=(e,t)=>isNaN(e[0])||isNaN(e[1])||e[1]<e[0]?ca():{type:\"interval\",bounds:e,tight:t};function hi(e){return e.type===\"empty\"}function ji(e){return hi(e)||e.tight}var Yc=(e,t)=>{if(t===0)return e>0?Fo():ca();let r=-e/t,n=t<0?[-1/0,r]:[r,1/0];return Ji(n)},Mr=(e,t)=>{if(hi(e)||hi(t))return ca();let r=[Math.max(e.bounds[0],t.bounds[0]),Math.min(e.bounds[1],t.bounds[1])],n=ji(e)&&ji(t);return vd(r,n)},xp=(e,t)=>{if(hi(e))return t;if(hi(t))return e;let r=[Math.min(e.bounds[0],t.bounds[0]),Math.max(e.bounds[1],t.bounds[1])],n;return!ji(e)&&!ji(t)?n=!1:ji(e)&&!ji(t)?n=e.bounds[0]<=t.bounds[0]&&e.bounds[1]>=t.bounds[1]:!ji(e)&&ji(t)?n=t.bounds[0]<=e.bounds[0]&&t.bounds[1]>=e.bounds[1]:n=e.bounds[0]<=t.bounds[1]&&t.bounds[0]<=e.bounds[1],vd(r,n)},fM=(e,t,r)=>{if(hi(e))return r;let n=Mr(e,t);return ji(e)?(e.bounds[0]>-1/0&&(n=xp(n,Mr(Ji([-1/0,e.bounds[0]]),r))),e.bounds[1]<1/0&&(n=xp(n,Mr(Ji([e.bounds[1],1/0]),r)))):n=xp(n,Mr(r,Xr())),n};var Le={};wo(Le,{Action:()=>Ke,AngleMarker:()=>Ge,Any:()=>vt,Arc:()=>fe,Bool:()=>Ee,Circle:()=>he,DirectedAngleMarker:()=>Ae,Distribution:()=>Dt,EmptyList:()=>Xe,ErrorType:()=>oo,Line:()=>be,ListOfAngleMarker:()=>mr,ListOfAny:()=>or,ListOfArc:()=>Fr,ListOfBool:()=>_r,ListOfCircle:()=>wr,ListOfColor:()=>Zr,ListOfDirectedAngleMarker:()=>yr,ListOfDistribution:()=>Lr,ListOfLine:()=>Vr,ListOfMapInterval2DPoint:()=>Nn,ListOfMapInterval2DPoint3D:()=>An,ListOfMapIntervalPoint:()=>Rn,ListOfMapIntervalPoint3D:()=>Cn,ListOfNumber:()=>le,ListOfPoint:()=>xt,ListOfPoint3D:()=>tn,ListOfPolygon:()=>Or,ListOfRay:()=>Br,ListOfRestriction:()=>kn,ListOfSegment:()=>xr,ListOfSegment3D:()=>rn,ListOfSphere3D:()=>xn,ListOfTone:()=>Hn,ListOfTransformation:()=>bn,ListOfTriangle3D:()=>nn,ListOfVector:()=>Gr,ListOfVector3D:()=>sn,MapInterval2DPoint:()=>cn,MapInterval2DPoint3D:()=>ln,MapIntervalPoint:()=>Wr,MapIntervalPoint3D:()=>jr,Number:()=>T,Point:()=>C,Point3D:()=>V,Polygon:()=>Be,RGBColor:()=>qt,Ray:()=>_e,Restriction:()=>Gt,SeedType:()=>et,Segment:()=>Se,Segment3D:()=>Rt,Sphere3D:()=>Rr,Tone:()=>pr,Transformation:()=>Ue,Triangle3D:()=>Pr,Vector:()=>Me,Vector3D:()=>Ce,allListTypes:()=>Qi,allValueTypes:()=>OA,assertTypeIsOneOf:()=>Ep,broadcastable:()=>ti,broadcastableArg:()=>qu,commonCoerceableTypeWithBroadcast:()=>la,elementType:()=>ze,hasListType:()=>ei,hasMapType:()=>Oh,isGeometryType:()=>Tp,isList:()=>W,isMapOrListOfMap:()=>pa,isOneOf:()=>Xc,isSubType:()=>_s,isSubTypeOrCoercible:()=>Kn,isTypeOrListOfType:()=>ce,isValidOnLogScales:()=>Ip,listType:()=>pn,mapType:()=>Rh,maxArity:()=>Pp,minArity:()=>Ha,prettyPrint:()=>ne,repr:()=>$t,straightTypes:()=>Dd,summableElementTypes:()=>Dh,valueTypes:()=>mM,vectorTypes:()=>Sh});function S(e,t){return{key:e,vars:t}}var vt=0,T=1,Ee=2,C=3,Dt=4,Ke=5,or=6,le=7,_r=8,xt=9,Lr=10,Xe=11,oo=12,et=13,qt=14,Zr=15,Be=16,Or=17,Se=18,xr=19,he=20,wr=21,fe=22,Fr=23,be=24,Vr=25,_e=26,Br=27,Ge=28,mr=29,Ae=30,yr=31,Ue=32,bn=33,Me=34,Gr=35,Gt=36,kn=37,pr=50,Hn=51,V=100,tn=101,Rt=102,rn=103,Pr=104,nn=105,Rr=106,xn=107,Ce=108,sn=109,Wr=200,jr=201,cn=202,ln=203,Rn=204,Cn=205,Nn=206,An=207,mM={Any:vt,Number:T,Bool:Ee,Point:C,Point3D:V,Distribution:Dt,Action:Ke,ListOfAny:or,ListOfNumber:le,ListOfBool:_r,ListOfPoint:xt,ListOfPoint3D:tn,ListOfDistribution:Lr,EmptyList:Xe,ErrorType:oo,SeedType:et,RGBColor:qt,ListOfColor:Zr,Polygon:Be,ListOfPolygon:Or,Segment:Se,ListOfSegment:xr,Circle:he,ListOfCircle:wr,Arc:fe,ListOfArc:Fr,Line:be,ListOfLine:Vr,Ray:_e,ListOfRay:Br,Vector:Me,ListOfVector:Gr,Restriction:Gt,ListOfRestriction:kn,AngleMarker:Ge,ListOfAngleMarker:mr,DirectedAngleMarker:Ae,ListOfDirectedAngleMarker:yr,Transformation:Ue,ListOfTransformation:bn,Segment3D:Rt,ListOfSegment3D:rn,Triangle3D:Pr,ListOfTriangle3D:nn,Sphere3D:Rr,ListOfSphere3D:xn,Vector3D:Ce,ListOfVector3D:sn,Tone:pr,ListOfTone:Hn,MapIntervalPoint:Wr,MapIntervalPoint3D:jr,MapInterval2ToPoint:cn,MapInterval2DPoint3D:ln,ListOfMapIntervalPoint:Rn,ListOfMapIntervalPoint3D:Cn,ListOfMapInterval2ToPoint:Nn,ListOfMapInterval2DPoint3D:An},OA=Object.values(mM);function Ha(e){return Array.isArray(e)?e.length:e.initial.length}function Pp(e){return Array.isArray(e)?e.length:1/0}function qu(e){if(typeof e==\"number\")return ei(e)?{meta:\"union\",types:[e,pn(e)]}:e;let t=[];for(let r of e.types){let n=qu(r);typeof n==\"number\"?t.push(n):t.push(...n.types)}return{meta:\"union\",types:t}}function ti(e){return Array.isArray(e)?e.map(qu):{type:\"variadic\",initial:e.initial.map(qu),rest:qu(e.rest)}}function $t(e){switch(e){case vt:return\"Any\";case T:return\"Number\";case Ee:return\"Bool\";case C:return\"Point\";case V:return\"Point3D\";case Dt:return\"Distribution\";case Ke:return\"Action\";case or:return\"ListOfAny\";case le:return\"ListOfNumber\";case _r:return\"ListOfBool\";case xt:return\"ListOfPoint\";case tn:return\"ListOfPoint3D\";case Lr:return\"ListOfDistribution\";case Xe:return\"EmptyList\";case oo:return\"ErrorType\";case et:return\"SeedType\";case qt:return\"RGBColor\";case Zr:return\"ListOfColor\";case Be:return\"Polygon\";case Or:return\"ListOfPolygon\";case Se:return\"Segment\";case xr:return\"ListOfSegment\";case he:return\"Circle\";case wr:return\"ListOfCircle\";case fe:return\"Arc\";case Fr:return\"ListOfArc\";case be:return\"Line\";case Vr:return\"ListOfLine\";case _e:return\"Ray\";case Br:return\"ListOfRay\";case Me:return\"Vector\";case Gr:return\"ListOfVector\";case Gt:return\"Restriction\";case kn:return\"ListOfRestriction\";case Ge:return\"Angle\";case mr:return\"ListOfAngle\";case Ae:return\"DirectedAngle\";case yr:return\"ListOfDirectedAngle\";case Ue:return\"Transformation\";case bn:return\"ListOfTransformation\";case Rt:return\"Segment3D\";case rn:return\"ListOfSegment3D\";case Ce:return\"Vector3D\";case sn:return\"ListOfVector3D\";case Pr:return\"Triangle3D\";case nn:return\"ListOfTriangle3D\";case Rr:return\"Sphere3D\";case xn:return\"ListOfSphere3D\";case pr:return\"Tone\";case Hn:return\"ListOfTone\";case Wr:return\"MapIntervalPoint\";case jr:return\"MapIntervalPoint3D\";case cn:return\"MapInterval2ToPoint\";case ln:return\"MapInterval2DPoint3D\";case Rn:return\"ListOfMapIntervalPoint\";case Cn:return\"ListOfMapIntervalPoint3D\";case Nn:return\"ListOfMapInterval2ToPoint\";case An:return\"ListOfMapInterval2DPoint3D\";default:let t=e;throw new Error(`Invalid type: ${t}`)}}function ne(e){switch(e){case vt:return S(\"shared-calculator-label-value-type-any\");case T:return S(\"shared-calculator-label-value-type-number\");case Ee:return S(\"shared-calculator-label-value-type-bool\");case C:return S(\"shared-calculator-label-value-type-point\");case V:return S(\"shared-calculator-label-value-type-point3d\");case Dt:return S(\"shared-calculator-label-value-type-distribution\");case Ke:return S(\"shared-calculator-label-value-type-action\");case or:return S(\"shared-calculator-label-value-type-list-of-any\");case le:return S(\"shared-calculator-label-value-type-list-of-numbers\");case _r:return S(\"shared-calculator-label-value-type-list-of-bool\");case xt:return S(\"shared-calculator-label-value-type-list-of-points\");case tn:return S(\"shared-calculator-label-value-type-list-of-3d-points\");case Lr:return S(\"shared-calculator-label-value-type-list-of-distributions\");case Xe:return S(\"shared-calculator-label-value-type-empty-list\");case oo:return S(\"shared-calculator-label-value-type-error\");case et:return S(\"shared-calculator-label-value-type-seed\");case qt:return S(\"shared-calculator-label-value-type-color\");case Zr:return S(\"shared-calculator-label-value-type-list-of-colors\");case Be:return S(\"shared-calculator-label-value-type-polygon\");case Or:return S(\"shared-calculator-label-value-type-list-of-polygons\");case Se:return S(\"shared-calculator-label-value-type-segment\");case xr:return S(\"shared-calculator-label-value-type-list-of-segments\");case he:return S(\"shared-calculator-label-value-type-circle\");case wr:return S(\"shared-calculator-label-value-type-list-of-circles\");case fe:return S(\"shared-calculator-label-value-type-arc\");case Fr:return S(\"shared-calculator-label-value-type-list-of-arcs\");case be:return S(\"shared-calculator-label-value-type-line\");case Vr:return S(\"shared-calculator-label-value-type-list-of-lines\");case _e:return S(\"shared-calculator-label-value-type-ray\");case Br:return S(\"shared-calculator-label-value-type-list-of-rays\");case Me:return S(\"shared-calculator-label-value-type-vector\");case Gr:return S(\"shared-calculator-label-value-type-list-of-vectors\");case Gt:return S(\"shared-calculator-label-value-type-restriction\");case kn:return S(\"shared-calculator-label-value-type-list-of-restrictions\");case Ge:return S(\"shared-calculator-label-value-type-angle\");case mr:return S(\"shared-calculator-label-value-type-list-of-angles\");case Ae:return S(\"shared-calculator-label-value-type-directed-angle\");case yr:return S(\"shared-calculator-label-value-type-list-of-directed-angles\");case Ue:return S(\"shared-calculator-label-value-type-transformation\");case bn:return S(\"shared-calculator-label-value-type-list-of-transformations\");case Rt:return S(\"shared-calculator-label-value-type-segment3d\");case rn:return S(\"shared-calculator-label-value-type-list-of-segment3d\");case Ce:return S(\"shared-calculator-label-value-type-vector3d\");case sn:return S(\"shared-calculator-label-value-type-list-of-vector3d\");case Pr:return S(\"shared-calculator-label-value-type-triangle3d\");case nn:return S(\"shared-calculator-label-value-type-list-of-triangle3d\");case Rr:return S(\"shared-calculator-label-value-type-sphere3d\");case xn:return S(\"shared-calculator-label-value-type-list-of-sphere3d\");case pr:return S(\"shared-calculator-label-value-type-tone\");case Hn:return S(\"shared-calculator-label-value-type-list-of-tone\");case Wr:case cn:return S(\"shared-calculator-label-value-type-lambda-point\");case jr:case ln:return S(\"shared-calculator-label-value-type-lambda-point3d\");case Rn:case Nn:return S(\"shared-calculator-label-value-type-list-of-lambda-point\");case Cn:case An:return S(\"shared-calculator-label-value-type-list-of-lambda-point3d\");default:let t=e;throw new Error(`Invalid type: ${t}`)}}var Qi=[or,le,_r,kn,xt,tn,Lr,Xe,Zr,Or,xr,wr,Fr,Vr,Br,Gr,mr,yr,bn,rn,sn,nn,xn,Hn,Rn,Cn,Nn,An],pH={[or]:vt,[Xe]:T,[le]:T,[_r]:Ee,[kn]:Gt,[xt]:C,[tn]:V,[Lr]:Dt,[Zr]:qt,[Or]:Be,[xr]:Se,[wr]:he,[Fr]:fe,[Vr]:be,[Br]:_e,[Gr]:Me,[mr]:Ge,[yr]:Ae,[bn]:Ue,[rn]:Rt,[sn]:Ce,[nn]:Pr,[xn]:Rr,[Hn]:pr,[Rn]:Wr,[Cn]:jr,[Nn]:cn,[An]:ln};function W(e){switch(e){case void 0:return!1;case or:case le:case _r:case kn:case xt:case tn:case Lr:case Zr:case Or:case xr:case wr:case Fr:case Vr:case Br:case Gr:case mr:case yr:case bn:case rn:case sn:case nn:case xn:case Hn:case Rn:case Cn:case Nn:case An:return!0;case Xe:return!0;case vt:case T:case Ee:case Gt:case C:case V:case Dt:case oo:case et:case qt:case Ke:case Be:case Se:case he:case fe:case be:case _e:case Me:case Ge:case Ae:case Ue:case Rt:case Ce:case Pr:case pr:case Rr:case Wr:case jr:case cn:case ln:return!1;default:throw new Error(`Invalid type: ${e}`)}}function ze(e){switch(e){case Xe:case le:return T;case _r:return Ee;case kn:return Gt;case xt:return C;case tn:return V;case Lr:return Dt;case Zr:return qt;case Or:return Be;case rn:return Rt;case sn:return Ce;case nn:return Pr;case xn:return Rr;case or:return vt;case xr:return Se;case wr:return he;case Fr:return fe;case Vr:return be;case Br:return _e;case Gr:return Me;case mr:return Ge;case yr:return Ae;case bn:return Ue;case Hn:return pr;case Rn:return Wr;case Cn:return jr;case Nn:return cn;case An:return ln;case vt:case T:case Ee:case C:case V:case Dt:case oo:case et:case qt:case Ke:case Be:case Se:case he:case fe:case be:case _e:case Me:case Gt:case Ge:case Ae:case Ue:case Rt:case Ce:case Pr:case Rr:case pr:case Wr:case jr:case cn:case ln:throw new Error(\"Type \"+$t(e)+\" does not implement elementType.\");default:let t=e;throw new Error(`Invalid type: ${t}`)}}function pn(e){switch(e){case vt:return or;case T:return le;case Ee:return _r;case Gt:return kn;case C:return xt;case V:return tn;case Dt:return Lr;case qt:return Zr;case Be:return Or;case Se:return xr;case he:return wr;case fe:return Fr;case be:return Vr;case _e:return Br;case Me:return Gr;case Ge:return mr;case Ae:return yr;case Ue:return bn;case Rt:return rn;case Ce:return sn;case Pr:return nn;case Rr:return xn;case pr:return Hn;case Wr:return Rn;case jr:return Cn;case cn:return Nn;case ln:return An;case Xe:case le:case _r:case kn:case xt:case tn:case Lr:case Zr:case Or:case xr:case wr:case Fr:case Vr:case Br:case Gr:case mr:case yr:case bn:case rn:case sn:case nn:case xn:case or:case Hn:case oo:case et:case Ke:case Rn:case Cn:case Nn:case An:throw new Error(\"Type \"+$t(e)+\" does not implement listType.\");default:let t=e;throw new Error(`Invalid type: ${t}`)}}function ei(e){switch(e){case vt:case T:case Ee:case Gt:case C:case V:case Dt:case qt:case Be:case Se:case he:case fe:case be:case _e:case Me:case Ge:case Ae:case Ue:case Rt:case Ce:case Pr:case Rr:case pr:case Wr:case jr:case cn:case ln:return!0;case Xe:case le:case _r:case kn:case xt:case tn:case Lr:case Zr:case Or:case xr:case wr:case Fr:case Vr:case Br:case Gr:case mr:case yr:case bn:case rn:case sn:case nn:case xn:case or:case Hn:case Rn:case Cn:case Nn:case An:case et:case Ke:case oo:return!1;default:throw new Error(`Invalid type: ${e}`)}}function Tp(e){if(e===void 0)return!1;switch(e){case C:case Be:case Se:case he:case fe:case be:case _e:case Me:case Ge:case Ae:case Ue:return!0;default:return!1}}function Ip(e){switch(e){case T:case vt:case Ee:case Gt:case C:case Dt:case Ke:case or:case le:case _r:case kn:case xt:case Lr:case Xe:case oo:case et:case qt:case Zr:case pr:case Hn:return!0;case V:case tn:case Rt:case rn:case Ce:case sn:case Pr:case nn:case Rr:case xn:case Be:case Or:case Se:case xr:case he:case wr:case fe:case Fr:case be:case Vr:case _e:case Br:case Me:case Gr:case Ge:case mr:case Ae:case yr:case Ue:case bn:case Wr:case jr:case cn:case ln:case Rn:case Cn:case Nn:case An:return!1;default:let t=e;throw new Error(`Invalid type: ${t}`)}}function Xc(e,t){for(let r of t)if(e===r)return!0;return!1}function _s(e,t){return e===Xe&&W(t)||t===or&&W(e)||t===vt&&!W(e)?!0:e===t}function Kn(e,t){return!!(_s(e,t)||t===RA(e))}function RA(e){switch(e){case Ge:case Ae:case Gt:return T;case mr:case yr:case kn:return le;default:return}}function dM(e){switch(e){case Gt:return T;case kn:return le;default:return e}}function vh(e,t){var r,n;if(Kn(e,t))return t;if(Kn(t,e))return e;if(e=(r=dM(e))!=null?r:e,t=(n=dM(t))!=null?n:t,Kn(e,t))return t;if(Kn(t,e))return e}function la(e,t){return W(e)&&ei(t)?vh(e,pn(t)):ei(e)&&W(t)?vh(pn(e),t):vh(e,t)}var Dh=[T,C,V],Dd=[be,_e,Se,Me],Sh={meta:\"union\",types:[Me,Ce]};function ce(e,t){return e===t?!0:W(e)?e===Xe?!0:ze(e)===t:!1}function pa(e){return Xc(e,[Wr,jr,cn,ln,Rn,Cn,Nn,An])}var CA={[C]:Wr,[V]:jr},NA={[C]:cn,[V]:ln};function Oh(e){return Xc(e,[C,V])}function Rh(e,t){if(e!==C&&e!==V)throw new Error(`Unexpected return type for map: ${$t(e)}`);return t===1?CA[e]:NA[e]}function Ep(e,t){if(!Xc(e,t))throw new Error(`Programming error: expected one of ${t.map(ne)} but found ${e} instead.`)}var zt=class{constructor(){this.exportPenalty=0;this._dependencies=[],this._dummyDependencies=[],this._updateSymbols=[],this._substitutionSymbols=[],this._scope={definitions:[],dependencies:[],substitutionDependencies:[],scopes:[]},this._exports=[]}setInputSpan(t){this._inputSpan=t}getInputString(){return this._inputSpan===void 0?\"\":Sr(this._inputSpan)}getInputSpan(){return this._inputSpan}shouldExportAns(){return!1}getAnsVariable(){return this.shouldExportAns()&&this.userData&&this.userData.hasOwnProperty(\"index\")?[\"ans_\"+this.userData.index]:[]}addDependency(t){this._dependencies.indexOf(t)===-1&&this._dependencies.push(t),this._scope.dependencies.indexOf(t)===-1&&this._scope.dependencies.push(t)}addDependencies(t){for(var r=0;r<t.length;r++)this.addDependency(t[r])}addDummyDependency(t){this._dependencies.indexOf(t)===-1&&this._dependencies.push(t),this._dummyDependencies.indexOf(t)===-1&&this._dummyDependencies.push(t)}addDummyDependencies(t){for(var r=0;r<t.length;r++)this.addDummyDependency(t[r])}addUpdateSymbol(t){this._dependencies.indexOf(t)===-1&&this._dependencies.push(t),this._updateSymbols.indexOf(t)===-1&&this._updateSymbols.push(t)}addSubstitutionSymbol(t){this._dummyDependencies.indexOf(t)===-1&&this._dummyDependencies.push(t),this._substitutionSymbols.indexOf(t)===-1&&this._substitutionSymbols.push(t)}addSubstitutionDependencies(t){for(var r=0;r<t.length;r++){var n=t[r];if(this._dependencies.indexOf(n)===-1)throw new Error(\"Programming error: substitution dependency \"+n+\" must also be registered as a regular dependency\");this._scope.substitutionDependencies.indexOf(n)===-1&&this._scope.substitutionDependencies.push(n)}}mergeDependencies(...t){for(var r=0;r<t.length;r++){var n=t[r],i;for(i=0;i<n._dependencies.length;i++)this._dependencies.indexOf(n._dependencies[i])===-1&&this._dependencies.push(n._dependencies[i]);for(i=0;i<n._updateSymbols.length;i++)this._updateSymbols.indexOf(n._updateSymbols[i])===-1&&this._updateSymbols.push(n._updateSymbols[i]);for(i=0;i<n._substitutionSymbols.length;i++)this._substitutionSymbols.indexOf(n._substitutionSymbols[i])===-1&&this._substitutionSymbols.push(n._substitutionSymbols[i]);for(i=0;i<n._scope.dependencies.length;i++)this._scope.dependencies.indexOf(n._scope.dependencies[i])===-1&&this._scope.dependencies.push(n._scope.dependencies[i]);for(i=0;i<n._scope.substitutionDependencies.length;i++)this._scope.substitutionDependencies.indexOf(n._scope.substitutionDependencies[i])===-1&&this._scope.substitutionDependencies.push(n._scope.substitutionDependencies[i]);this.addDummyDependencies(n.getDummyDependencies()),Array.prototype.push.apply(this._scope.scopes,n._scope.scopes)}}mergeDependenciesInScope(t,r,n,i){this.addDummyDependencies(r);var s=n.getScope(),o={kind:t,definitions:r,dependencies:s.dependencies,substitutionDependencies:s.substitutionDependencies,scopes:s.scopes,functionDefinitionSymbol:i==null?void 0:i.functionDefinitionSymbol};this._scope.scopes.push(o);for(var a=0;a<n._dependencies.length;a++)this._dependencies.indexOf(n._dependencies[a])===-1&&this._dependencies.push(n._dependencies[a]);for(a=0;a<n._updateSymbols.length;a++)this._updateSymbols.indexOf(n._updateSymbols[a])===-1&&this._updateSymbols.push(n._updateSymbols[a]);for(a=0;a<n._substitutionSymbols.length;a++)this._substitutionSymbols.indexOf(n._substitutionSymbols[a])===-1&&this._substitutionSymbols.push(n._substitutionSymbols[a]);this.addDummyDependencies(n.getDummyDependencies())}getDependencies(){return this._dependencies}graphmodeDependencies(t,r){return this.getDependencies()}getDummyDependencies(){return this._dummyDependencies}getUpdateSymbols(){return this._updateSymbols}getSubstitutionSymbols(){return this._substitutionSymbols}getScope(){return this._scope}dependsOn(t){return this._dependencies.indexOf(t)>-1}getExports(t){var r=this._exports||[];if(this.userData&&\"id\"in this.userData){var n=this.userData.id;r=r.concat([\"idref_\"+n])}return t.ansEnabled()&&(r=r.concat(this.getAnsVariable())),r}getLegalExports(t){return this.getExports(t).filter(function(r){return!t.assignmentForbidden(r)})}exportsSymbol(t){return this._exports.indexOf(t)>-1}exportTo(t,r,n){for(var i=this.getLegalExports(t),s=0;s<i.length;s++){var o=i[s];if(n[o])return;n[o]=r.blocksExport?r:this}}getOperator(){return this.operator||\"=\"}isInequality(){return!1}isShadeBetween(){return!1}getAllIds(){return this.userData?[this.userData.id]:[]}getEvaluationInfo(){return!1}shouldPromoteToSlider(t){return!1}getSliderVariables(t,r,n){var i=t.sliderVariables(n!=null?n:r.getDependencies());return r.valueType===C||r.valueType===xt||r.valueType===V||r.valueType===tn?t.is3dPolicy()?i.includes(\"t\")&&!i.includes(\"u\")&&!i.includes(\"v\")?i.filter(s=>s!=\"t\"):!i.includes(\"t\")&&(i.includes(\"u\")||i.includes(\"v\"))?i.filter(s=>s!=\"u\"&&s!=\"v\"):i:i.filter(function(s){return!t.validParametricVariable(s)}):i}getCompiledDerivative(){var t=this.getDependencies(),n=this.takeDerivative(t[0]||\"x\");return n.getCompiledFunction()}asValue(){}boundDomain(t){return Xr()}getCursorContext(){}polynomialOrder(t){}getPolynomialCoefficients(t){}asTypedValue(){}substitute(t){}getExpressionType(t,r){}tableInfo(t,r){}analyzeFourFunction(t,r,n){}analyzeScientific(t,r,n){}analyzeSingleExpressionScientific(t,r,n){}getGraphMode(t,r){}};var Q=class extends zt{constructor(t,r){if(!Array.isArray(t))throw new TypeError(\"Argument to expression constructor must be an Array.\");super(),this.args=t,(!r||!r.skipRegisterDependencies)&&this.registerDependencies()}shouldExportAns(){return!0}registerDependencies(){for(var t=0;t<this.args.length;t++)this.mergeDependencies(this.args[t])}copyWithArgs(t){throw new Error(`Programming Error: copyWithArgs not implemented for ${this.constructor.name}`)}};function fa(e,t=1e6){if(e===1/0)return{n:1/0,d:1};if(e===-1/0)return{n:-1/0,d:1};if(!isFinite(e))return{n:NaN,d:1};let r,n=0,i=1,s=1,o=0,a,u;for(;r=Math.floor(e),a=r*i+n,u=r*o+s,!(u>t||(n=i,s=o,i=a,o=u,e===r));)e=1/(e-r);return{n:i,d:o}}function yM(e,t,r){if(e=Zc(e),r>0){let n=Zc(t);return e<n&&(e+=2*Math.PI),(e-n)/r}else{let n=Zc(t+r);return e<n&&(e+=2*Math.PI),1+(e-n)/r}}function Sd(e,t,r){e=Zc(e);let n=Zc(t),i=Zc(t+r);if(r<0){let s=n;n=i,i=s}return n<i?n<=e&&e<=i:n<=e||e<=i}function Zc(e){let t=2*Math.PI;return(e%t+t)%t}function gH(e,t){if(!(isNaN(e)||isNaN(t)))return e>=0?Math.atan(t/e):Math.atan(t/e)+Math.PI}var ls=Math.hypot;function da(e,t){return e>0==t>0?e+.5*(t-e):.5*(e+t)}function _A(e,t,r,n,i,s){return e*n+t*i+r*s}function Ls(e,t,r,n,i,s,o,a,u){let c=ls(o-n,a-i,u-s);return c===0?0:_A((e-n)/c,(t-i)/c,(r-s)/c,(o-n)/c,(a-i)/c,(u-s)/c)}function LA(e,t,r,n,i,s){let o=Ls(e,t,0,r,n,0,i,s,0);return o<=0?[r,n]:o>=1?[i,s]:[r+o*(i-r),n+o*(s-n)]}function wA(e,t,r,n,i,s,o,a,u){let c=Ls(e,t,r,n,i,s,o,a,u);return c<=0?[n,i,s]:c>=1?[o,a,u]:[n+c*(o-n),i+c*(a-i),s+c*(u-s)]}function bH(e,t,r,n,i,s,o,a){let u=Ls(e,t,0,r,n,0,i,s,0);return u<=0&&!o?[r,n]:u>=1&&!a?[i,s]:[r+u*(i-r),n+u*(s-n)]}function gM(e,t,r,n,i,s){let o=LA(e,t,r,n,i,s);return ls(e-o[0],t-o[1])}function hM(e,t,r,n,i,s,o,a,u){let c=wA(e,t,r,n,i,s,o,a,u);return ls(e-c[0],t-c[1],r-c[2])}function xH(e,t,r,n,i,s,o){var a=Math.atan2(t-n,e-r);if(Sd(a,s,o-s))return[i*Math.cos(a)+r,i*Math.sin(a)+n]}function wi(e,t,r=1){if(e===t)return!0;if(!isFinite(e)||!isFinite(t))return!1;if(r>50)throw new Error(\"Within \"+(52-r)+\" bits isn't really approximate any more\");let n=Math.max(Math.max(Math.abs(e),Math.abs(t)),1),i=r===1?.5:Math.pow(.5,r);return n===n+i*Math.abs(t-e)}function PH(e){return Math.round(e-.5)+.5}function $u(e,t){if(isNaN(e)||isNaN(t))return NaN;if(e=Math.round(e),t=Math.round(t),e<0&&(e=-e),t<0&&(t=-t),t>e){let n=t;t=e,e=n}if(t===0)return e;let r=e%t;for(;r>0;)e=t,t=r,r=e%t;return t}function Yu(e,t){if(!isFinite(e)&&t===0)return NaN;if(e>=0||t===Math.floor(t))return Math.pow(e,t);let r=fa(t,100);return wi(r.n/r.d,t,2)&&r.d%2===1?(r.n%2===0?1:-1)*Math.pow(-e,t):NaN}function Wc(e,t){return{n:e,d:t}}function Tr(e){return typeof e==\"object\"&&typeof e.n==\"number\"&&typeof e.d==\"number\"}var Mp=Math.pow(2,53)-1;function Xu(e){let t=e.match(/^(-)?(\\d*)?(?:\\.(\\d*))?$/);if(!t)return NaN;let r=t[1],n=t[2],i=t[3];if(!n&&!i)return NaN;let s=!!r;if(i){let o=i.replace(/0+$/,\"\"),a=o.length,u=Math.pow(10,a),c=parseInt(n||\"0\",10)*u+parseInt(o||\"0\",10);return c>Mp||u>Mp?parseFloat(e):Re(s?-c:c,u)}else{let o=parseInt(n,10);return o>Mp?parseFloat(e):Re(s?-o:o,1)}}function Y(e){return Tr(e)?e.n/e.d:+e}function bi(e){return Tr(e)?!1:isNaN(e)}function Re(e,t){if(!isFinite(e)||!isFinite(t)||t===0||Math.floor(e)!==e||Math.floor(t)!==t||Math.abs(e)>Mp||Math.abs(t)>Mp)return e/t;t<0&&(e=-e,t=-t);let r=$u(e,t);return Wc(e/r,t/r)}function xi(e){return Tr(e)?Wc(-e.n,e.d):-e}function bM(e){return Tr(e)?Wc(Math.abs(e.n),Math.abs(e.d)):Math.abs(e)}function vp(e){return Tr(e)?e.n===0?e.d/e.n:Wc(e.n<0?-e.d:e.d,Math.abs(e.n)):1/e}function ps(e,t){if(!Tr(e)||!Tr(t))return Y(e)+Y(t);var r=$u(e.d,t.d);return Re(e.n*(t.d/r)+t.n*(e.d/r),e.d/r*t.d)}function fs(e,t){if(!Tr(e)||!Tr(t))return Y(e)*Y(t);var r=$u(e.n,t.d),n=$u(t.n,e.d);return Re(e.n/r*(t.n/n),e.d/n*(t.d/r))}function Ki(e,t){return ps(e,xi(t))}function es(e,t){return!Tr(e)||!Tr(t)?Y(e)/Y(t):fs(e,vp(t))}function VA(e,t){let r=e,n=t;if(t.n<0&&(n=xi(t),r=vp(e)),!Tr(r)||!Tr(n))return Yu(Y(e),Y(t));if(e=r,t=n,t.d===1)return Re(Math.pow(e.n,t.n),Math.pow(e.d,t.n));let i=e.n<0;if(i&&t.d%2!==1)return NaN;let o=(i?-1:1)*Math.round(Math.pow(Math.abs(e.n),1/t.d)),a=Math.round(Math.pow(Math.abs(e.d),1/t.d));return Math.pow(o,t.d)!==e.n||Math.pow(a,t.d)!==e.d?Yu(Y(e),Y(t)):Re(Math.pow(o,t.n),Math.pow(a,t.n))}function Ch(e,t){if(!Tr(e)||!Tr(t))return Yu(Y(e),Y(t));let r=VA(e,t);return Tr(r)?r:Yu(Y(e),Y(t))}function xM(e){if(!Tr(e))return Math.sqrt(e);let t=Math.round(Math.sqrt(e.n)),r=Math.round(Math.sqrt(e.d));return t*t!==e.n||r*r!==e.d?Math.sqrt(Y(e)):Re(t,r)}function Od(e,t){return Ch(e,vp(t))}function PM(e,t){if(!Tr(e)||!Tr(t)){let r=Y(e),n=Y(t);return r-n*Math.floor(r/n)}return Ki(e,fs(t,Wc(Math.floor(Y(es(e,t))),1)))}function TM(e){let t=Wc(0,1);for(let r of e)t=ps(t,r);return t}var jt=class extends Q{constructor(r){super([]);this.isConstant=!0;typeof r==\"number\"&&(r=Re(r,1)),this._constantValue=r}asValue(){let r=this._constantValue;return typeof r==\"boolean\"?r:Y(r)}asCompilerValue(){return this._constantValue}scalarExprString(){return this.asValue()>0?String(this.asValue()):\"(\"+String(this.asValue())+\")\"}getEvaluationInfo(){return[{val:this.asValue()}]}isNaN(){let r=this.asValue();return typeof r==\"number\"&&isNaN(r)}};var ya={};wo(ya,{canDisplayAsFraction:()=>jM,formatSymbol:()=>j,geoParentToLatex:()=>M_,identifierToHTML:()=>v_,identifierToLatex:()=>fn,latexToIdentifier:()=>Bo,numericLabel:()=>Bd,point:()=>b_,removeSpaces:()=>D_,roundDecimal:()=>I_,trimLatex:()=>Go,truncatedHTMLLabel:()=>E_,truncatedLatexLabel:()=>zh,truncatedPlainmathLabel:()=>Gh,value:()=>Vh});var Rd=typeof self==\"object\"&&self.self===self&&self||typeof global==\"object\"&&global.global===global&&global||Function(\"return this\")()||{},Ad=Array.prototype,_h=Object.prototype,IM=typeof Symbol!=\"undefined\"?Symbol.prototype:null,MH=Ad.push,OM=Ad.slice,Cd=_h.toString,BA=_h.hasOwnProperty,GA=Array.isArray,EM=Object.keys,MM=Object.create,RM=Rd.isNaN,zA=Rd.isFinite,Nh=function(){};function Pn(e){if(e instanceof Pn)return e;if(!(this instanceof Pn))return new Pn(e);this._wrapped=e}var vH=Pn.VERSION=\"1.10.2\";function _d(e,t,r){if(t===void 0)return e;switch(r==null?3:r){case 1:return function(n){return e.call(t,n)};case 3:return function(n,i,s){return e.call(t,n,i,s)};case 4:return function(n,i,s,o){return e.call(t,n,i,s,o)}}return function(){return e.apply(t,arguments)}}function CM(e,t,r){return e==null?m_:ma(e)?_d(e,t,r):el(e)&&!Kc(e)?y_(e):HM(e)}Pn.iteratee=NM;function NM(e,t){return CM(e,t,1/0)}function ao(e,t,r){return Pn.iteratee!==NM?Pn.iteratee(e,t):CM(e,t,r)}function ds(e,t){return t=t==null?e.length-1:+t,function(){for(var r=Math.max(arguments.length-t,0),n=Array(r),i=0;i<r;i++)n[i]=arguments[i+t];switch(t){case 0:return e.call(this,n);case 1:return e.call(this,arguments[0],n);case 2:return e.call(this,arguments[0],arguments[1],n)}var s=Array(t+1);for(i=0;i<t;i++)s[i]=arguments[i];return s[t]=n,e.apply(this,s)}}function kA(e){if(!el(e))return{};if(MM)return MM(e);Nh.prototype=e;var t=new Nh;return Nh.prototype=null,t}function AM(e){return function(t){return t==null?void 0:t[e]}}function Jc(e,t){return e!=null&&BA.call(e,t)}function _M(e,t){for(var r=t.length,n=0;n<r;n++){if(e==null)return;e=e[t[n]]}return r?e:void 0}var HA=Math.pow(2,53)-1,qa=AM(\"length\");function ms(e){var t=qa(e);return typeof t==\"number\"&&t>=0&&t<=HA}function Qc(e,t,r){t=_d(t,r);var n,i;if(ms(e))for(n=0,i=e.length;n<i;n++)t(e[n],n,e);else{var s=Pi(e);for(n=0,i=s.length;n<i;n++)t(e[s[n]],s[n],e)}return e}function Ld(e,t,r){t=ao(t,r);for(var n=!ms(e)&&Pi(e),i=(n||e).length,s=Array(i),o=0;o<i;o++){var a=n?n[o]:o;s[o]=t(e[a],a,e)}return s}function LM(e){var t=function(r,n,i,s){var o=!ms(r)&&Pi(r),a=(o||r).length,u=e>0?0:a-1;for(s||(i=r[o?o[u]:u],u+=e);u>=0&&u<a;u+=e){var c=o?o[u]:u;i=n(i,r[c],c,r)}return i};return function(r,n,i,s){var o=arguments.length>=3;return t(r,_d(n,s,4),i,o)}}var DH=LM(1),SH=LM(-1);function UA(e,t,r){var n=[];return t=ao(t,r),Qc(e,function(i,s,o){t(i,s,o)&&n.push(i)}),n}function OH(e,t,r){t=ao(t,r);for(var n=!ms(e)&&Pi(e),i=(n||e).length,s=0;s<i;s++){var o=n?n[s]:s;if(!t(e[o],o,e))return!1}return!0}function RH(e,t,r){t=ao(t,r);for(var n=!ms(e)&&Pi(e),i=(n||e).length,s=0;s<i;s++){var o=n?n[s]:s;if(t(e[o],o,e))return!0}return!1}function jc(e,t,r,n){return ms(e)||(e=Dp(e)),(typeof r!=\"number\"||n)&&(r=0),jA(e,t,r)>=0}var CH=ds(function(e,t,r){var n,i;return ma(t)?i=t:Kc(t)&&(n=t.slice(0,-1),t=t[t.length-1]),Ld(e,function(s){var o=i;if(!o){if(n&&n.length&&(s=_M(s,n)),s==null)return;o=s[t]}return o==null?o:o.apply(s,r)})});function wM(e,t){return Ld(e,HM(t))}function qA(e,t,r){var n=-1/0,i=-1/0,s,o;if(t==null||typeof t==\"number\"&&typeof e[0]!=\"object\"&&e!=null){e=ms(e)?e:Dp(e);for(var a=0,u=e.length;a<u;a++)s=e[a],s!=null&&s>n&&(n=s)}else t=ao(t,r),Qc(e,function(c,l,p){o=t(c,l,p),(o>i||o===-1/0&&n===-1/0)&&(n=c,i=o)});return n}function NH(e,t,r){var n=1/0,i=1/0,s,o;if(t==null||typeof t==\"number\"&&typeof e[0]!=\"object\"&&e!=null){e=ms(e)?e:Dp(e);for(var a=0,u=e.length;a<u;a++)s=e[a],s!=null&&s<n&&(n=s)}else t=ao(t,r),Qc(e,function(c,l,p){o=t(c,l,p),(o<i||o===1/0&&n===1/0)&&(n=c,i=o)});return n}function AH(e){return $A(e,1/0)}function $A(e,t,r){if(t==null||r)return ms(e)||(e=Dp(e)),e[DM(e.length-1)];var n=ms(e)?s_(e):Dp(e),i=qa(n);t=Math.max(Math.min(t,i),0);for(var s=i-1,o=0;o<t;o++){var a=DM(o,s),u=n[o];n[o]=n[a],n[a]=u}return n.slice(0,t)}function _H(e,t,r){var n=0;return t=ao(t,r),wM(Ld(e,function(i,s,o){return{value:i,index:n++,criteria:t(i,s,o)}}).sort(function(i,s){var o=i.criteria,a=s.criteria;if(o!==a){if(o>a||o===void 0)return 1;if(o<a||a===void 0)return-1}return i.index-s.index}),\"value\")}function wd(e,t){return function(r,n,i){var s=t?[[],[]]:{};return n=ao(n,i),Qc(r,function(o,a){var u=n(o,a,r);e(s,o,u)}),s}}var LH=wd(function(e,t,r){Jc(e,r)?e[r].push(t):e[r]=[t]}),wH=wd(function(e,t,r){e[r]=t}),FH=wd(function(e,t,r){Jc(e,r)?e[r]++:e[r]=1});function VH(e){return e==null?0:ms(e)?e.length:Pi(e).length}var BH=wd(function(e,t,r){e[r?0:1].push(t)},!0);function Zu(e,t,r,n){n=n||[];for(var i=n.length,s=0,o=qa(e);s<o;s++){var a=e[s];if(ms(a)&&(Kc(a)||Nd(a)))if(t)for(var u=0,c=a.length;u<c;)n[i++]=a[u++];else Zu(a,t,r,n),i=n.length;else r||(n[i++]=a)}return n}function GH(e,t){return Zu(e,t,!1)}var zH=ds(function(e,t){return Lh(e,t)});function Sp(e,t,r,n){d_(t)||(n=r,r=t,t=!1),r!=null&&(r=ao(r,n));for(var i=[],s=[],o=0,a=qa(e);o<a;o++){var u=e[o],c=r?r(u,o,e):u;t&&!r?((!o||s!==c)&&i.push(u),s=c):r?jc(s,c)||(s.push(c),i.push(u)):jc(i,u)||i.push(u)}return i}var kH=ds(function(e){return Sp(Zu(e,!0,!0))});var Lh=ds(function(e,t){return t=Zu(t,!0,!0),UA(e,function(r){return!jc(t,r)})});function YA(e){for(var t=e&&qA(e,qa).length||0,r=Array(t),n=0;n<t;n++)r[n]=wM(e,n);return r}var HH=ds(YA);function FM(e){return function(t,r,n){r=ao(r,n);for(var i=qa(t),s=e>0?0:i-1;s>=0&&s<i;s+=e)if(r(t[s],s,t))return s;return-1}}var XA=FM(1),ZA=FM(-1);function WA(e,t,r,n){r=ao(r,n,1);for(var i=r(t),s=0,o=qa(e);s<o;){var a=Math.floor((s+o)/2);r(e[a])<i?s=a+1:o=a}return s}function VM(e,t,r){return function(n,i,s){var o=0,a=qa(n);if(typeof s==\"number\")e>0?o=s>=0?s:Math.max(s+a,o):a=s>=0?Math.min(s+1,a):s+a+1;else if(r&&s&&a)return s=r(n,i),n[s]===i?s:-1;if(i!==i)return s=t(OM.call(n,o,a),f_),s>=0?s+o:-1;for(s=e>0?o:a-1;s>=0&&s<a;s+=e)if(n[s]===i)return s;return-1}}var jA=VM(1,XA,WA),UH=VM(-1,ZA);function qH(e,t){if(t==null||t<1)return[];for(var r=[],n=0,i=e.length;n<i;)r.push(OM.call(e,n,n+=t));return r}function BM(e,t,r,n,i){if(!(n instanceof t))return e.apply(r,i);var s=kA(e.prototype),o=e.apply(s,i);return el(o)?o:s}var JA=ds(function(e,t,r){if(!ma(e))throw new TypeError(\"Bind must be called on a function\");var n=ds(function(i){return BM(e,n,t,this,r.concat(i))});return n}),Fd=ds(function(e,t){var r=Fd.placeholder,n=function(){for(var i=0,s=t.length,o=Array(s),a=0;a<s;a++)o[a]=t[a]===r?arguments[i++]:t[a];for(;i<arguments.length;)o.push(arguments[i++]);return BM(e,n,this,this,o)};return n});Fd.placeholder=Pn;var $H=ds(function(e,t){t=Zu(t,!1,!1);var r=t.length;if(r<1)throw new Error(\"bindAll must be passed function names\");for(;r--;){var n=t[r];e[n]=JA(e[n],e)}});var GM=ds(function(e,t,r){return setTimeout(function(){return e.apply(null,r)},t)}),YH=Fd(GM,Pn,1);function XH(e,t,r){var n,i,s,o,a=0;r||(r={});var u=function(){a=r.leading===!1?0:SM(),n=null,o=e.apply(i,s),n||(i=s=null)},c=function(){var l=SM();!a&&r.leading===!1&&(a=l);var p=t-(l-a);return i=this,s=arguments,p<=0||p>t?(n&&(clearTimeout(n),n=null),a=l,o=e.apply(i,s),n||(i=s=null)):!n&&r.trailing!==!1&&(n=setTimeout(u,p)),o};return c.cancel=function(){clearTimeout(n),a=0,n=i=s=null},c}function ZH(e,t,r){var n,i,s=function(a,u){n=null,u&&(i=e.apply(a,u))},o=ds(function(a){if(n&&clearTimeout(n),r){var u=!n;n=setTimeout(s,t),u&&(i=e.apply(this,a))}else n=GM(s,t,this,a);return i});return o.cancel=function(){clearTimeout(n),n=null},o}function QA(e){return function(){return!e.apply(this,arguments)}}function KA(e,t){var r;return function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=null),r}}var WH=Fd(KA,2),zM=!{toString:null}.propertyIsEnumerable(\"toString\"),vM=[\"valueOf\",\"isPrototypeOf\",\"toString\",\"propertyIsEnumerable\",\"hasOwnProperty\",\"toLocaleString\"];function kM(e,t){var r=vM.length,n=e.constructor,i=ma(n)&&n.prototype||_h,s=\"constructor\";for(Jc(e,s)&&!jc(t,s)&&t.push(s);r--;)s=vM[r],s in e&&e[s]!==i[s]&&!jc(t,s)&&t.push(s)}function Pi(e){if(!el(e))return[];if(EM)return EM(e);var t=[];for(var r in e)Jc(e,r)&&t.push(r);return zM&&kM(e,t),t}function wh(e){if(!el(e))return[];var t=[];for(var r in e)t.push(r);return zM&&kM(e,t),t}function Dp(e){for(var t=Pi(e),r=t.length,n=Array(r),i=0;i<r;i++)n[i]=e[t[i]];return n}function e_(e){for(var t={},r=Pi(e),n=0,i=r.length;n<i;n++)t[e[r[n]]]=r[n];return t}function Fh(e,t){return function(r){var n=arguments.length;if(t&&(r=Object(r)),n<2||r==null)return r;for(var i=1;i<n;i++)for(var s=arguments[i],o=e(s),a=o.length,u=0;u<a;u++){var c=o[u];(!t||r[c]===void 0)&&(r[c]=s[c])}return r}}var t_=Fh(wh),r_=Fh(Pi);function n_(e,t,r){return t in r}var i_=ds(function(e,t){var r={},n=t[0];if(e==null)return r;ma(n)?(t.length>1&&(n=_d(n,t[1])),t=wh(e)):(n=n_,t=Zu(t,!1,!1),e=Object(e));for(var i=0,s=t.length;i<s;i++){var o=t[i],a=e[o];n(a,o,e)&&(r[o]=a)}return r}),jH=ds(function(e,t){var r=t[0],n;return ma(r)?(r=QA(r),t.length>1&&(n=t[1])):(t=Ld(Zu(t,!1,!1),String),r=function(i,s){return!jc(t,s)}),i_(e,r,n)}),JH=Fh(wh,!0);function s_(e){return el(e)?Kc(e)?e.slice():t_({},e):e}function o_(e,t){var r=Pi(t),n=r.length;if(e==null)return!n;for(var i=Object(e),s=0;s<n;s++){var o=r[s];if(t[o]!==i[o]||!(o in i))return!1}return!0}function Ah(e,t,r,n){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var i=typeof e;return i!==\"function\"&&i!==\"object\"&&typeof t!=\"object\"?!1:a_(e,t,r,n)}function a_(e,t,r,n){e instanceof Pn&&(e=e._wrapped),t instanceof Pn&&(t=t._wrapped);var i=Cd.call(e);if(i!==Cd.call(t))return!1;switch(i){case\"[object RegExp]\":case\"[object String]\":return\"\"+e==\"\"+t;case\"[object Number]\":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case\"[object Date]\":case\"[object Boolean]\":return+e==+t;case\"[object Symbol]\":return IM.valueOf.call(e)===IM.valueOf.call(t)}var s=i===\"[object Array]\";if(!s){if(typeof e!=\"object\"||typeof t!=\"object\")return!1;var o=e.constructor,a=t.constructor;if(o!==a&&!(ma(o)&&o instanceof o&&ma(a)&&a instanceof a)&&\"constructor\"in e&&\"constructor\"in t)return!1}r=r||[],n=n||[];for(var u=r.length;u--;)if(r[u]===e)return n[u]===t;if(r.push(e),n.push(t),s){if(u=e.length,u!==t.length)return!1;for(;u--;)if(!Ah(e[u],t[u],r,n))return!1}else{var c=Pi(e),l;if(u=c.length,Pi(t).length!==u)return!1;for(;u--;)if(l=c[u],!(Jc(t,l)&&Ah(e[l],t[l],r,n)))return!1}return r.pop(),n.pop(),!0}function Vo(e,t){return Ah(e,t)}function QH(e){return e==null?!0:ms(e)&&(Kc(e)||u_(e)||Nd(e))?e.length===0:Pi(e).length===0}function ys(e){return function(t){return Cd.call(t)===\"[object \"+e+\"]\"}}var Kc=GA||ys(\"Array\");function el(e){var t=typeof e;return t===\"function\"||t===\"object\"&&!!e}var Nd=ys(\"Arguments\"),ma=ys(\"Function\"),u_=ys(\"String\"),c_=ys(\"Number\"),KH=ys(\"Date\"),eU=ys(\"RegExp\"),tU=ys(\"Error\"),l_=ys(\"Symbol\"),rU=ys(\"Map\"),nU=ys(\"WeakMap\"),iU=ys(\"Set\"),sU=ys(\"WeakSet\");(function(){Nd(arguments)||(Nd=function(e){return Jc(e,\"callee\")})})();var p_=Rd.document&&Rd.document.childNodes;typeof/./!=\"function\"&&typeof Int8Array!=\"object\"&&typeof p_!=\"function\"&&(ma=function(e){return typeof e==\"function\"||!1});function oU(e){return!l_(e)&&zA(e)&&!RM(parseFloat(e))}function f_(e){return c_(e)&&RM(e)}function d_(e){return e===!0||e===!1||Cd.call(e)===\"[object Boolean]\"}function m_(e){return e}function HM(e){return Kc(e)?function(t){return _M(t,e)}:AM(e)}function y_(e){return e=r_({},e),function(t){return o_(t,e)}}function DM(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}var SM=Date.now||function(){return new Date().getTime()},UM={\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#x27;\",\"`\":\"&#x60;\"},g_=e_(UM);function qM(e){var t=function(s){return e[s]},r=\"(?:\"+Pi(e).join(\"|\")+\")\",n=RegExp(r),i=RegExp(r,\"g\");return function(s){return s=s==null?\"\":\"\"+s,n.test(s)?s.replace(i,t):s}}var $M=qM(UM),aU=qM(g_);var h_=0;function uU(e){var t=++h_+\"\";return e?e+t:t}var cU=Pn.templateSettings={evaluate:/<%([\\s\\S]+?)%>/g,interpolate:/<%=([\\s\\S]+?)%>/g,escape:/<%-([\\s\\S]+?)%>/g};function YM(e,t){return e._chain?Pn(t).chain():t}Qc([\"pop\",\"push\",\"reverse\",\"shift\",\"sort\",\"splice\",\"unshift\"],function(e){var t=Ad[e];Pn.prototype[e]=function(){var r=this._wrapped;return t.apply(r,arguments),(e===\"shift\"||e===\"splice\")&&r.length===0&&delete r[0],YM(this,r)}});Qc([\"concat\",\"join\",\"slice\"],function(e){var t=Ad[e];Pn.prototype[e]=function(){return YM(this,t.apply(this._wrapped,arguments))}});Pn.prototype.value=function(){return this._wrapped};Pn.prototype.valueOf=Pn.prototype.toJSON=Pn.prototype.value;Pn.prototype.toString=function(){return String(this._wrapped)};function Vh(e,t=e,r=!1){if(isNaN(e)||!isFinite(e))return{string:\"undefined\",latex:\"undefined\",value:e};if(e===0)return{string:\"0\",latex:\"0\",value:e};Math.abs(e)>Math.abs(t)&&(t=e);let n=fa(e/Math.PI,24),i,s,o,a,u,c;if(XM(t)&&wi(n.n/n.d*Math.PI,e,3))return n.n===0?(i=\"0\",a=\"0\"):n.n===1?(i=\"\\u03C0\",a=\"\\\\pi\"):n.n===-1?(i=\"-\\u03C0\",a=\"-\\\\pi\"):(i=n.n.toString()+\"\\u03C0\",a=n.n.toString()+\"\\\\pi\"),n.d===1?(s=\"\",u=\"\"):(s=\"/\"+n.d.toString(),u=n.d.toString()),o=i+s,u===\"\"?c=a:a[0]===\"-\"?c=`-\\\\frac{${a.slice(1)}}{${u}}`:c=`\\\\frac{${a}}{${u}}`,{string:o,latex:c,value:n.n/n.d*Math.PI};if(!r&&XM(t)||T_(t))return o=P_(ZM(e.toFixed(Vd(t)))),{string:o,latex:o,value:parseFloat(o)};{let p=Bh(e.toExponential(Vd(t/e))).split(\"e\"),f=p[0]===\"1\"&&r?\"10\":p[0]+\"\\xD710\",m=p[1].replace(\"+\",\"\");return o=Bh(e.toExponential(Vd(t/e))).replace(\"+\",\"\"),c=`${p[0]}\\\\times10^{${m}}`,{string:o,latex:c,mantissa:f,superscript:m,value:parseFloat(o)}}}function b_(e,t,r,n){let i=Vh(e,t),s=Vh(n(i.value),r);return[i,s]}var x_=/\\.?0+$/;function ZM(e){return e.indexOf(\".\")===-1?e:e.replace(x_,\"\")}function Bh(e){let t=/\\.?0+e/;return e.replace(t,\"e\")}function P_(e){return e===\"-0\"?\"0\":e}function XM(e){return e=Math.abs(e),1e-4<e&&e<1e7}function T_(e){return e=Math.abs(e),.001<e&&e<1e4}function Vd(e){return e=Math.abs(e),e=Math.max(e,1e-16),Math.max(3,Math.floor(4.5-Math.log(e)/Math.LN10))}function I_(e){return Math.abs(e)>=1e-20?parseFloat(e.toFixed(Vd(e))):e}function WM(e){return 1e6/Math.sqrt(Math.abs(e))}function jM(e){let t=WM(e);if(t<1||t>1e12)return!1;let{n:r,d:n}=fa(e,t);return n===1?!1:e===e+Math.pow(2,-3)*Math.abs(r/n-e)}function Bd(e,t){if(t=t||{},isNaN(e)||!isFinite(e))return{type:\"undefined\"};if(e===0||t.zeroCutoff&&Math.abs(e)<t.zeroCutoff)return{type:\"decimal\",value:\"0\"};let r=t.smallCutoff||.001,n=t.bigCutoff||1e6,i=t.digits||10,o=Bh(e.toExponential(i-2)).match(/([\\d\\.\\-]+)e\\+?([\\d\\-]+)/);if(!o)return{type:\"undefined\"};let a=parseInt(o[2],10)>=i;if(jM(e)&&t.displayAsFraction){let c=fa(e,WM(e));return{type:\"fraction\",numerator:c.n.toString(),denominator:c.d.toString()}}else{if(Math.abs(e)>n||Math.abs(e)<r||a)return{type:\"scientific\",mantissa:o[1],exponent:o[2]};{let c=ZM(e.toPrecision(i));return e!==Number(c)&&t.addEllipses&&(c+=\"...\"),{type:\"decimal\",value:c}}}}function E_(e,t){let r=Bd(e,t);switch(r.type){case\"undefined\":return\"undefined\";case\"decimal\":return r.value;case\"scientific\":return r.mantissa+\"<span class='dcg-cross'>\\xD7</span>10<sup>\"+r.exponent+\"</sup>\";case\"fraction\":return r.denominator===\"1\"?r.numerator:`${r.numerator}/${r.denominator}`;default:return r}}function Gh(e,t){let r=Bd(e,t);switch(r.type){case\"undefined\":return\"undefined\";case\"decimal\":return r.value;case\"scientific\":return r.mantissa+\" * 10^\"+r.exponent;case\"fraction\":return r.denominator===\"1\"?r.numerator:`${r.numerator}/${r.denominator}`;default:return r}}function zh(e,t){let r=Bd(e,t);switch(r.type){case\"undefined\":return\"undefined\";case\"decimal\":return r.value;case\"scientific\":return r.mantissa+\"\\\\times10^{\"+r.exponent+\"}\";case\"fraction\":return r.denominator===\"1\"?r.numerator:r.numerator[0]===\"-\"?`-\\\\frac{${r.numerator.slice(1)}}{${r.denominator}}`:`\\\\frac{${r.numerator}}{${r.denominator}}`;default:return r}}function j(e){e=e.replace(\"\\\\\",\"\");let t={alpha:\"\\u03B1\",beta:\"\\u03B2\",gamma:\"\\u03B3\",delta:\"\\u03B4\",epsilon:\"\\u03F5\",varepsilon:\"\\u03B5\",zeta:\"\\u03B6\",eta:\"\\u03B7\",theta:\"\\u03B8\",vartheta:\"\\u03D1\",iota:\"\\u03B9\",kappa:\"\\u03BA\",varkappa:\"\\u03F0\",lambda:\"\\u03BB\",mu:\"\\u03BC\",xi:\"\\u03BE\",pi:\"\\u03C0\",varpi:\"\\u03D6\",rho:\"\\u03C1\",varrho:\"\\u03F1\",sigma:\"\\u03C3\",varsigma:\"\\u03C2\",tau:\"\\u03C4\",phi:\"\\u03D5\",varphi:\"\\u03C6\",chi:\"\\u03C7\",psi:\"\\u03C8\",omega:\"\\u03C9\",Gamma:\"\\u0393\",Delta:\"\\u0394\",Theta:\"\\u0398\",Lambda:\"\\u039B\",Xi:\"\\u039E\",Pi:\"\\u03A0\",Sigma:\"\\u03A3\",Phi:\"\\u03A6\",Psi:\"\\u03A8\",Omega:\"\\u03A9\",div:\"\\xF7\",cdot:\"\\u22C5\",times:\"\\xD7\",lt:\"<\",gt:\">\",le:\"\\u2264\",ge:\"\\u2265\",sim:\"\\u223C\",ldots:\"\\u2026\",prime:\"\\u2032\",approx:\"\\u2248\",to:\"\\u2192\",\"->\":\"\\u2192\"};return t.hasOwnProperty(e)?t[e]:e}function M_(e){if(!e)return\"\";let t=fn(e[0]);return e[1]!==void 0&&(t+=\"\\\\left[\"+e[1]+\"\\\\right]\"),t}function fn(e){let t=e.match(/^\\$(\\d+)$/);if(t)return`\\\\token{${t[1]}}`;let r=e.split(\"_\"),n=\"\";return r[0].length>1&&(n+=\"\\\\\"),n+=r[0],r[1]&&(n+=\"_{\"+r[1]+\"}\"),n}function v_(e){if(!e)return\"\";let t=e.split(\"_\");t[0]=j(t[0]);let r=t.map($M);return r[1]&&(r[1]=\"<sub>\"+r[1]+\"</sub>\"),r.join(\"\")}function Bo(e){let t=e.match(/\\\\token\\{(\\d+)\\}/);return t?`$${t[1]}`:(e=e.replace(/\\\\operatorname\\{(.*)\\}/,\"$1\"),e.replace(/[{}\\\\]/g,\"\"))}function Go(e){return e.replace(/^(\\\\ |\\s|\\\\space(?![a-zA-Z]))+/,\"\").replace(/(\\\\ |\\s|\\\\space(?![a-zA-Z]))+$/,\"\")}function D_(e){return e.replace(/\\\\ |\\\\space(?![a-zA-Z])/g,\"\")}var Fe=class extends Q{constructor(t){super([]),this._symbol=Bo(t),this._errorSymbol=this._symbol,this.addDependency(this._symbol)}setInputSpan(t){super.setInputSpan(t),this._errorSymbol=Bo(this.getInputString())}getInputSpan(){return this._inputSpan===void 0?gi(this._symbol,0,this._symbol.length):this._inputSpan}};function S_(e){switch(e){case\"default\":case\"trig\":case\"inverseTrig\":case\"trig2\":case\"never-broadcast\":return[T];case\"reducer\":return[le];case\"doubleReducer\":return[le,le];case\"parameterizedReducer\":return[le,T];case\"color\":return[T,T,T]}}function O_(e){switch(e){case\"default\":case\"trig\":case\"inverseTrig\":case\"trig2\":case\"doubleReducer\":case\"color\":case\"never-broadcast\":return!1;case\"reducer\":case\"parameterizedReducer\":return!0}}function R_(e,t,r){return e===\"reducer\"?1/0:t+r}function _(e,t,r){var m,g,y,d,h;r===void 0&&(r={});let n=(m=r.tag)!=null?m:\"default\",i=(g=r.argumentTypes)!=null?g:S_(n),s=r.defaultArguments?r.defaultArguments.length:0,o=i.length-s,a=R_(n,o,s),u=(y=r.allowDotCall)!=null?y:O_(n),c=(d=r.noPeel)!=null?d:!1,{defaultArguments:l,minArityExampleArgs:p,maxArityExampleArgs:f}=r;return{module:e,symbol:t,argumentTypes:i,defaultArguments:l,returnType:(h=r.returnType)!=null?h:T,tag:n,minArity:o,maxArity:a,allowDotCall:u,noPeel:c,minArityExampleArgs:p,maxArityExampleArgs:f}}function qh(e){if(!Tr(e))throw new Error(\"Programming Error: numeric constants should be rational\");return{type:1,valueType:T,value:e}}var Wu=qh(Re(0,1)),ju=qh(Re(1,1)),zd=qh(Re(1,2));function $a(e){let t;return e in gr&&(t=gr[e].tag),t===\"trig\"||t===\"trig2\"||t===\"inverseTrig\"?!0:e===\"angle\"||e===\"angles\"||e===\"directedangle\"||e===\"directedangles\"||e===\"rotate\"}var gr={sin:_(\"BuiltIn\",\"sin\",{tag:\"trig\"}),cos:_(\"BuiltIn\",\"cos\",{tag:\"trig\"}),tan:_(\"BuiltIn\",\"tan\",{tag:\"trig\"}),cot:_(\"BuiltIn\",\"cot\",{tag:\"trig\"}),sec:_(\"BuiltIn\",\"sec\",{tag:\"trig\"}),csc:_(\"BuiltIn\",\"csc\",{tag:\"trig\"}),arcsin:_(\"Math\",\"asin\",{tag:\"inverseTrig\"}),arccos:_(\"Math\",\"acos\",{tag:\"inverseTrig\"}),arctan:_(\"Math\",\"atan2\",{argumentTypes:[T,T],defaultArguments:[ju],tag:\"inverseTrig\"}),arccot:_(\"BuiltIn\",\"acot\",{tag:\"inverseTrig\"}),arcsec:_(\"BuiltIn\",\"asec\",{tag:\"inverseTrig\"}),arccsc:_(\"BuiltIn\",\"acsc\",{tag:\"inverseTrig\"}),sinh:_(\"BuiltIn\",\"sinh\"),cosh:_(\"BuiltIn\",\"cosh\"),tanh:_(\"BuiltIn\",\"tanh\"),coth:_(\"BuiltIn\",\"coth\"),sech:_(\"BuiltIn\",\"sech\"),csch:_(\"BuiltIn\",\"csch\"),arcsinh:_(\"BuiltIn\",\"asinh\"),arccosh:_(\"BuiltIn\",\"acosh\"),arctanh:_(\"BuiltIn\",\"atanh\"),arccoth:_(\"BuiltIn\",\"acoth\"),arcsech:_(\"BuiltIn\",\"asech\"),arccsch:_(\"BuiltIn\",\"acsch\"),sqrt:_(\"Math\",\"sqrt\"),rtxsqpone:_(\"BuiltIn\",\"sqrtxsqp1\"),rtxsqmone:_(\"BuiltIn\",\"sqrtxsqm1\"),nthroot:_(\"BuiltIn\",\"nthroot\",{argumentTypes:[T,T]}),hypot:_(\"BuiltIn\",\"hypot\",{argumentTypes:[T,T]}),log:_(\"BuiltIn\",\"common_log\"),logbase:_(\"BuiltIn\",\"log_base\",{argumentTypes:[T,T]}),ln:_(\"BuiltIn\",\"log\"),exp:_(\"Math\",\"exp\"),floor:_(\"Math\",\"floor\"),ceil:_(\"Math\",\"ceil\"),round:_(\"Math\",\"round\"),abs:_(\"Math\",\"abs\"),sign:_(\"BuiltIn\",\"sign\"),mod:_(\"BuiltIn\",\"mod\",{argumentTypes:[T,T]}),nCr:_(\"BuiltIn\",\"nCr\",{argumentTypes:[T,T]}),nPr:_(\"BuiltIn\",\"nPr\",{argumentTypes:[T,T]}),factorial:_(\"BuiltIn\",\"factorial\"),polyGamma:_(\"BuiltIn\",\"polyGamma\",{argumentTypes:[T,T]}),lcm:_(\"BuiltIn\",\"listLCM\",{tag:\"reducer\"}),gcd:_(\"BuiltIn\",\"listGCD\",{tag:\"reducer\"}),distance:_(\"BuiltIn\",\"distance\",{argumentTypes:[C,C]}),polygon:_(\"BuiltIn\",\"polygon\",{tag:\"reducer\",argumentTypes:[xt],returnType:Be}),area:_(\"BuiltIn\",\"polygonArea\",{argumentTypes:[Be]}),perimeter:_(\"BuiltIn\",\"polygonPerimeter\",{argumentTypes:[Be]}),pointDet:_(\"BuiltIn\",\"pointDet\",{argumentTypes:[C,C]}),pointDot:_(\"BuiltIn\",\"pointDot\",{argumentTypes:[C,C]}),pointPerp:_(\"BuiltIn\",\"pointPerp\",{argumentTypes:[C],returnType:C}),segment:_(\"BuiltIn\",\"segment\",{argumentTypes:[C,C],returnType:Se}),line:_(\"BuiltIn\",\"line\",{argumentTypes:[C,C],returnType:be}),ray:_(\"BuiltIn\",\"ray\",{argumentTypes:[C,C],returnType:_e}),vector:_(\"BuiltIn\",\"vector\",{argumentTypes:[C,C],returnType:Me}),vectorThreeD:_(\"BuiltIn\",\"vectorThreeD\",{argumentTypes:[V,V],returnType:Ce}),mathVector:_(\"BuiltIn\",\"mathVector\",{argumentTypes:[C,C],returnType:Me}),mathVectorThreeD:_(\"BuiltIn\",\"mathVectorThreeD\",{argumentTypes:[V,V],returnType:Ce}),vectorDisplacementAsPoint:_(\"BuiltIn\",\"vectorDisplacementAsPoint\",{argumentTypes:[Me],returnType:C}),vectorThreeDDisplacementAsPoint:_(\"BuiltIn\",\"vectorThreeDDisplacementAsPoint\",{argumentTypes:[Ce],returnType:V}),basePointFromVector:_(\"BuiltIn\",\"basePointFromVector\",{argumentTypes:[Me],returnType:C}),basePointFromVectorThreeD:_(\"BuiltIn\",\"basePointFromVectorThreeD\",{argumentTypes:[Ce],returnType:V}),circle:_(\"BuiltIn\",\"circle\",{argumentTypes:[C,T],returnType:he}),center:_(\"BuiltIn\",\"center\",{argumentTypes:[he],returnType:C,allowDotCall:!0}),radius:_(\"BuiltIn\",\"radius\",{argumentTypes:[he],returnType:T,allowDotCall:!0}),arc:_(\"BuiltIn\",\"arc\",{argumentTypes:[C,C,C],returnType:fe}),arcCenter:_(\"BuiltIn\",\"arcCenter\",{argumentTypes:[fe],returnType:C}),arcOmega:_(\"BuiltIn\",\"arcOmega\",{argumentTypes:[fe],returnType:T}),undirectedAngleMarker:_(\"BuiltIn\",\"undirectedAngleMarker\",{argumentTypes:[Ae],returnType:Ge}),directedAngleMarker:_(\"BuiltIn\",\"directedAngleMarker\",{argumentTypes:[C,T,T,T],returnType:Ae}),directedCoterminalAngle:_(\"BuiltIn\",\"directedCoterminalAngle\",{argumentTypes:[Ae],returnType:Ae}),undirectedCoterminalAngle:_(\"BuiltIn\",\"undirectedCoterminalAngle\",{argumentTypes:[Ge],returnType:Ge}),supplement:_(\"BuiltIn\",\"supplementAngle\",{argumentTypes:[Ae],returnType:Ae}),directedAngleMarkerRawDelta:_(\"BuiltIn\",\"angleMarkerRawDelta\",{argumentTypes:[Ae],returnType:T}),undirectedAngleMarkerRawDelta:_(\"BuiltIn\",\"angleMarkerRawDelta\",{argumentTypes:[Ge],returnType:T}),directedAngleMarkerMultiplier:_(\"BuiltIn\",\"angleMarkerMultiplier\",{argumentTypes:[Ae],returnType:T}),undirectedAngleMarkerMultiplier:_(\"BuiltIn\",\"angleMarkerMultiplier\",{argumentTypes:[Ge],returnType:T}),polygonInteriorUndirectedAngles:_(\"BuiltIn\",\"polygonInteriorUndirectedAngles\",{argumentTypes:[Be,T],returnType:mr,allowDotCall:!0,tag:\"never-broadcast\"}),polygonInteriorDirectedAngles:_(\"BuiltIn\",\"polygonInteriorDirectedAngles\",{argumentTypes:[Be,T],returnType:yr,allowDotCall:!0,tag:\"never-broadcast\"}),vertices:_(\"BuiltIn\",\"vertices\",{argumentTypes:[Be],returnType:xt,allowDotCall:!0,tag:\"never-broadcast\"}),segments:_(\"BuiltIn\",\"polygonEdges\",{argumentTypes:[Be],returnType:xr,allowDotCall:!0,tag:\"never-broadcast\"}),scaleTangentSegment:_(\"BuiltIn\",\"scaleTangentSegment\",{argumentTypes:[Se,T],returnType:Se}),scaleTangentLine:_(\"BuiltIn\",\"scaleTangentLine\",{argumentTypes:[be,T],returnType:be}),scaleTangentRay:_(\"BuiltIn\",\"scaleTangentRay\",{argumentTypes:[_e,T],returnType:_e}),scaleTangentCircle:_(\"BuiltIn\",\"scaleTangentCircle\",{argumentTypes:[he,T],returnType:he}),scaleTangentArc:_(\"BuiltIn\",\"scaleTangentArc\",{argumentTypes:[fe,T],returnType:he}),scaleTangentDirectedAngleMarker:_(\"BuiltIn\",\"scaleTangentAngle\",{argumentTypes:[Ae,T],returnType:Ae}),scaleTangentUndirectedAngleMarker:_(\"BuiltIn\",\"scaleTangentAngle\",{argumentTypes:[Ge,T],returnType:Ge}),addTangentSegment:_(\"BuiltIn\",\"addTangentSegment\",{argumentTypes:[Se,Se],returnType:Se}),addTangentSegmentThreeD:_(\"BuiltIn\",\"addTangentSegmentThreeD\",{argumentTypes:[Rt,Rt],returnType:Rt}),addTangentLine:_(\"BuiltIn\",\"addTangentLine\",{argumentTypes:[be,be],returnType:be}),addTangentRay:_(\"BuiltIn\",\"addTangentRay\",{argumentTypes:[_e,_e],returnType:_e}),addTangentCircle:_(\"BuiltIn\",\"addTangentCircle\",{argumentTypes:[he,he],returnType:he}),addTangentArc:_(\"BuiltIn\",\"addTangentArc\",{argumentTypes:[fe,fe],returnType:fe}),addTangentDirectedAngleMarker:_(\"BuiltIn\",\"addTangentAngle\",{argumentTypes:[Ae,Ae],returnType:Ae}),addTangentUndirectedAngleMarker:_(\"BuiltIn\",\"addTangentAngle\",{argumentTypes:[Ge,Ge],returnType:Ge}),segmentGlider:_(\"BuiltIn\",\"segmentGlider\",{argumentTypes:[Se,T],returnType:C}),segmentThreeDGlider:_(\"BuiltIn\",\"segmentThreeDGlider\",{argumentTypes:[Rt,T],returnType:V}),lineGlider:_(\"BuiltIn\",\"lineGlider\",{argumentTypes:[be,T],returnType:C}),rayGlider:_(\"BuiltIn\",\"rayGlider\",{argumentTypes:[_e,T],returnType:C}),circleGlider:_(\"BuiltIn\",\"circleGlider\",{argumentTypes:[he,T],returnType:C}),arcGlider:_(\"BuiltIn\",\"arcGlider\",{argumentTypes:[fe,T],returnType:C}),polygonGlider:_(\"BuiltIn\",\"polygonGlider\",{argumentTypes:[Be,T],returnType:C}),chooseNonIncidentPoint:_(\"BuiltIn\",\"chooseNonIncidentPoint\",{argumentTypes:[C,C,C],returnType:C}),circleCircleIntersection:_(\"BuiltIn\",\"circleCircleIntersection\",{argumentTypes:[he,he,T],returnType:C}),circleArcIntersection:_(\"BuiltIn\",\"circleArcIntersection\",{argumentTypes:[he,fe,T],returnType:C}),circleLineIntersection:_(\"BuiltIn\",\"circleLineIntersection\",{argumentTypes:[he,be,T],returnType:C}),arcCircleIntersection:_(\"BuiltIn\",\"arcCircleIntersection\",{argumentTypes:[fe,he,T],returnType:C}),arcArcIntersection:_(\"BuiltIn\",\"arcArcIntersection\",{argumentTypes:[fe,fe,T],returnType:C}),arcLineIntersection:_(\"BuiltIn\",\"arcLineIntersection\",{argumentTypes:[fe,be,T],returnType:C}),lineCircleIntersection:_(\"BuiltIn\",\"lineCircleIntersection\",{argumentTypes:[be,he,T],returnType:C}),lineArcIntersection:_(\"BuiltIn\",\"lineArcIntersection\",{argumentTypes:[be,fe,T],returnType:C}),lineLineIntersection:_(\"BuiltIn\",\"lineLineIntersection\",{argumentTypes:[be,be,T],returnType:C}),lineFromSegment:_(\"BuiltIn\",\"identity\",{argumentTypes:[Se],returnType:be}),lineFromRay:_(\"BuiltIn\",\"identity\",{argumentTypes:[_e],returnType:be}),parallel:_(\"BuiltIn\",\"parallel\",{argumentTypes:[be,C],returnType:be}),perpendicular:_(\"BuiltIn\",\"perpendicular\",{argumentTypes:[be,C],returnType:be}),translation:_(\"BuiltIn\",\"translation\",{argumentTypes:[C],returnType:Ue}),dilation:_(\"BuiltIn\",\"dilation\",{argumentTypes:[C,T],returnType:Ue}),rotation:_(\"BuiltIn\",\"rotation\",{tag:\"trig2\",argumentTypes:[C,T],returnType:Ue}),reflection:_(\"BuiltIn\",\"reflection\",{argumentTypes:[be],returnType:Ue}),compose:_(\"BuiltIn\",\"composeTransformation\",{argumentTypes:[Ue,Ue],returnType:Ue}),inverse:_(\"BuiltIn\",\"invertTransformation\",{argumentTypes:[Ue],returnType:Ue}),transformPoint:_(\"BuiltIn\",\"transformPoint\",{argumentTypes:[Ue,C],returnType:C}),transformSegment:_(\"BuiltIn\",\"transformSegment\",{argumentTypes:[Ue,Se],returnType:Se}),transformLine:_(\"BuiltIn\",\"transformLine\",{argumentTypes:[Ue,be],returnType:be}),transformRay:_(\"BuiltIn\",\"transformRay\",{argumentTypes:[Ue,_e],returnType:_e}),transformVector:_(\"BuiltIn\",\"transformVector\",{argumentTypes:[Ue,Me],returnType:Me}),transformCircle:_(\"BuiltIn\",\"transformCircle\",{argumentTypes:[Ue,he],returnType:he}),transformArc:_(\"BuiltIn\",\"transformArc\",{argumentTypes:[Ue,fe],returnType:fe}),transformPolygon:_(\"BuiltIn\",\"transformPolygon\",{argumentTypes:[Ue,Be],returnType:Be}),transformAngleMarker:_(\"BuiltIn\",\"transformAngleMarker\",{argumentTypes:[Ue,Ge],returnType:Ge}),transformDirectedAngleMarker:_(\"BuiltIn\",\"transformAngleMarker\",{argumentTypes:[Ue,Ae],returnType:Ae}),distanceThreeD:_(\"BuiltIn\",\"distanceThreeD\",{argumentTypes:[V,V]}),segmentThreeD:_(\"BuiltIn\",\"segmentThreeD\",{argumentTypes:[V,V],returnType:Rt}),triangle:_(\"BuiltIn\",\"triangle\",{argumentTypes:[V,V,V],returnType:Pr}),sphere:_(\"BuiltIn\",\"sphere\",{argumentTypes:[V,T],returnType:Rr,minArityExampleArgs:\"((0,0,0), 1)\",maxArityExampleArgs:\"((0,0,0), 1)\"}),mean:_(\"BuiltIn\",\"mean\",{tag:\"reducer\"}),total:_(\"BuiltIn\",\"total\",{tag:\"reducer\"}),stdev:_(\"BuiltIn\",\"stdev\",{tag:\"reducer\"}),stdevp:_(\"BuiltIn\",\"stdevp\",{tag:\"reducer\"}),mad:_(\"BuiltIn\",\"mad\",{tag:\"reducer\"}),count:_(\"BuiltIn\",\"listLength\",{tag:\"reducer\",argumentTypes:[or],noPeel:!0}),min:_(\"BuiltIn\",\"listMin\",{tag:\"reducer\"}),max:_(\"BuiltIn\",\"listMax\",{tag:\"reducer\"}),argmin:_(\"BuiltIn\",\"argMin\",{tag:\"reducer\",noPeel:!0}),argmax:_(\"BuiltIn\",\"argMax\",{tag:\"reducer\",noPeel:!0}),median:_(\"BuiltIn\",\"median\",{tag:\"reducer\"}),var:_(\"BuiltIn\",\"variance\",{tag:\"reducer\"}),varp:_(\"BuiltIn\",\"varp\",{tag:\"reducer\"}),cov:_(\"BuiltIn\",\"cov\",{tag:\"doubleReducer\"}),covp:_(\"BuiltIn\",\"covp\",{tag:\"doubleReducer\"}),corr:_(\"BuiltIn\",\"corr\",{tag:\"doubleReducer\"}),spearman:_(\"BuiltIn\",\"spearman\",{tag:\"doubleReducer\"}),quantile:_(\"BuiltIn\",\"quantile\",{tag:\"parameterizedReducer\"}),quartile:_(\"BuiltIn\",\"quartile\",{tag:\"parameterizedReducer\"}),upperQuantileIndex:_(\"BuiltIn\",\"upperQuantileIndex\",{tag:\"parameterizedReducer\"}),lowerQuantileIndex:_(\"BuiltIn\",\"lowerQuantileIndex\",{tag:\"parameterizedReducer\"}),quartileIndex:_(\"BuiltIn\",\"quartileIndex\",{tag:\"parameterizedReducer\"}),upperQuartileIndex:_(\"BuiltIn\",\"upperQuartileIndex\",{tag:\"parameterizedReducer\"}),lowerQuartileIndex:_(\"BuiltIn\",\"lowerQuartileIndex\",{tag:\"parameterizedReducer\"}),normalcdf:_(\"BuiltIn\",\"normalcdf\",{argumentTypes:[T,T,T,T],defaultArguments:[Wu,ju]}),normalpdf:_(\"BuiltIn\",\"normalpdf\",{argumentTypes:[T,T,T],defaultArguments:[Wu,ju]}),binomcdf:_(\"BuiltIn\",\"binomcdf\",{argumentTypes:[T,T,T,T],defaultArguments:[zd]}),binompdf:_(\"BuiltIn\",\"binompdf\",{argumentTypes:[T,T,T],defaultArguments:[zd]}),poissoncdf:_(\"BuiltIn\",\"poissoncdf\",{argumentTypes:[T,T,T]}),poissonpdf:_(\"BuiltIn\",\"poissonpdf\",{argumentTypes:[T,T,T]}),uniformcdf:_(\"BuiltIn\",\"uniformcdf\",{argumentTypes:[T,T,T,T],defaultArguments:[Wu,ju]}),uniformpdf:_(\"BuiltIn\",\"uniformpdf\",{argumentTypes:[T,T,T],defaultArguments:[Wu,ju]}),invT:_(\"BuiltIn\",\"invT\",{argumentTypes:[T,T]}),invPoisson:_(\"BuiltIn\",\"invPoisson\",{argumentTypes:[T,T]}),invBinom:_(\"BuiltIn\",\"invBinom\",{argumentTypes:[T,T,T]}),invUniform:_(\"BuiltIn\",\"invUniform\",{argumentTypes:[T,T,T]}),tpdf:_(\"BuiltIn\",\"tpdf\",{argumentTypes:[T,T]}),tcdf:_(\"BuiltIn\",\"tcdf\",{argumentTypes:[T,T,T]}),erf:_(\"BuiltIn\",\"erf\"),invNorm:_(\"BuiltIn\",\"invNorm\"),tscore:_(\"BuiltIn\",\"tscore\",{tag:\"parameterizedReducer\",defaultArguments:[Wu]}),normalSample:_(\"BuiltIn\",\"normalSample\",{argumentTypes:[et,T,T]}),uniformSample:_(\"BuiltIn\",\"uniformSample\",{argumentTypes:[et,T,T]}),tSample:_(\"BuiltIn\",\"tSample\",{argumentTypes:[et,T]}),poissonSample:_(\"BuiltIn\",\"poissonSample\",{argumentTypes:[et,T]}),binomSample:_(\"BuiltIn\",\"binomSample\",{argumentTypes:[et,T,T]}),rgb:_(\"BuiltIn\",\"rgb\",{returnType:qt,tag:\"color\"}),hsv:_(\"BuiltIn\",\"hsv\",{returnType:qt,tag:\"color\"}),tone:_(\"BuiltIn\",\"tone\",{argumentTypes:[T,T],returnType:pr,defaultArguments:[zd],minArityExampleArgs:\"(440)\",maxArityExampleArgs:\"(440, 0.5)\"}),validateRangeLength:_(\"BuiltIn\",\"validateRangeLength\",{returnType:T,argumentTypes:[le,le,T,T],tag:\"never-broadcast\",noPeel:!0}),validateSampleCount:_(\"BuiltIn\",\"validateSampleCount\",{returnType:T,argumentTypes:[T]}),select:_(\"BuiltIn\",\"select\",{argumentTypes:[or,_r],returnType:e=>e[0],tag:\"never-broadcast\",noPeel:!0}),shuffle:_(\"BuiltIn\",\"shuffle\",{argumentTypes:[et,or],returnType:e=>e[1],tag:\"never-broadcast\"}),sortPerm:_(\"BuiltIn\",\"sortPerm\",{argumentTypes:[le],returnType:le,tag:\"never-broadcast\",noPeel:!0}),elementsAt:_(\"BuiltIn\",\"elementsAt\",{argumentTypes:[or,le],returnType:e=>e[0],tag:\"never-broadcast\",noPeel:!0}),uniquePerm:_(\"BuiltIn\",\"uniquePerm\",{argumentTypes:[or],returnType:le,tag:\"never-broadcast\",noPeel:!0}),restriction:_(\"BuiltIn\",\"restriction\",{argumentTypes:[Ee],returnType:Gt}),restrictionToBoolean:_(\"BuiltIn\",\"restrictionToBoolean\",{argumentTypes:[Gt],returnType:Ee})};function qe(e,t){var m,g,y,d;let r=t==null?void 0:t.defaultArguments,n=1/0,i=0,s=(m=r==null?void 0:r.length)!=null?m:0;t!=null&&t.noBroadcast||(e=e.map(ti));for(let h of e){let b=Ha(h)-s;b<n&&(n=b);let x=Pp(h);x>i&&(i=x)}let o=(g=t==null?void 0:t.fallthroughUnlessDistribution)!=null?g:!1,a=(y=t==null?void 0:t.allowDotCall)!=null?y:!1,u=(d=t==null?void 0:t.isSeeded)!=null?d:!1,c=t==null?void 0:t.minArityExampleArgs,l=t==null?void 0:t.maxArityExampleArgs,p=t==null?void 0:t.dotMinArityExampleArgs,f=t==null?void 0:t.dotMaxArityExampleArgs;return{minArity:n,argumentTypes:e,maxArity:i,defaultArguments:r,fallthroughUnlessDistribution:o,minArityExampleArgs:c,maxArityExampleArgs:l,dotMinArityExampleArgs:p,dotMaxArityExampleArgs:f,allowDotCall:a,isSeeded:u}}function uo(){return qe([{type:\"variadic\",initial:[],rest:vt}],{})}var Gd={meta:\"union\",types:[Se,he,be,_e,fe]},kh={meta:\"union\",types:[Se,be,_e,Me]},tl={meta:\"union\",types:[C,Se,he,be,_e,Me,fe,Be,Ge,Ae,Ue]},Hh={meta:\"union\",types:[...Qi.filter(e=>e!==Lr),Dt]},co={midpoint:qe([[C,C],[V,V],[Se],[Rt]],{allowDotCall:!0}),segment:qe([[C,C],[V,V]]),vector:qe([[C,C],[V,V]]),distance:qe([[C,C],[V,V]]),glider:qe([[{meta:\"union\",types:[Se,he,be,_e,fe,Be]},T]]),circle:qe([[C,Se],[C,C],[C,T]],{}),center:qe([[he],[fe]],{allowDotCall:!0}),radius:qe([[he],[fe]],{allowDotCall:!0}),intersection:qe([[Gd,Gd]]),strictintersection:qe([[Gd,Gd]]),parallel:qe([[kh,C]]),perpendicular:qe([[kh,C]]),start:qe([[Me],[Ce]],{allowDotCall:!0}),end:qe([[Me],[Ce]],{allowDotCall:!0}),length:qe([[{meta:\"union\",types:Qi}],ti([Rt]),ti([Ce]),ti([Se]),ti([fe]),{type:\"variadic\",initial:[vt],rest:vt}],{allowDotCall:!0,noBroadcast:!0}),translate:qe([[tl,Me],[tl,C,C]]),dilate:qe([[tl,C,T]]),rotate:qe([[tl,C,T]]),reflect:qe([[tl,kh]]),apply:qe([[Ue,tl]]),points:qe([]),lines:qe([]),circles:qe([]),arcs:qe([]),polygons:qe([]),rays:qe([]),vectors:qe([]),angle:qe([[C,C,C]]),directedangle:qe([[C,C,C]]),angles:qe([[Be]],{allowDotCall:!0}),directedangles:qe([[Be]],{allowDotCall:!0}),coterminal:qe([[Ge],[Ae]]),round:qe([[T],[T,T]]),sort:qe([[le],[{meta:\"union\",types:Qi},le]],{minArityExampleArgs:\"([3,2,1])\",maxArityExampleArgs:\"([1,2,3],[3,2,1])\",dotMaxArityExampleArgs:\"([3,4])\",allowDotCall:!0}),shuffle:qe([[et,{meta:\"union\",types:Qi}],[et,{meta:\"union\",types:Qi},T]],{minArityExampleArgs:\"([1,2,3])\",maxArityExampleArgs:\"([1,2,3],2)\",dotMaxArityExampleArgs:\"(2)\",allowDotCall:!0,isSeeded:!0,noBroadcast:!0}),join:qe([{type:\"variadic\",initial:[vt,vt],rest:vt}],{minArityExampleArgs:\"([1,2],[3,4])\",dotMinArityExampleArgs:\"([3,4])\",allowDotCall:!0}),unique:qe([[{meta:\"union\",types:Qi.filter(e=>e!==Lr&&e!==or)}]],{minArityExampleArgs:\"([1,2,3])\",maxArityExampleArgs:\"([1,2,3])\",allowDotCall:!0}),normaldist:qe([[T,T]],{defaultArguments:[Wu,ju]}),tdist:qe([[T]]),binomialdist:qe([[T,T]],{defaultArguments:[zd]}),poissondist:qe([[T]]),uniformdist:qe([[T,T]],{defaultArguments:[Wu,ju]}),pdf:qe([[Dt,T]],{allowDotCall:!0}),cdf:qe([[Dt,T],[Dt,T,T]],{allowDotCall:!0}),median:qe([[Dt]],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),stdev:qe([[Dt]],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),var:qe([[Dt]],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),quantile:qe([[Dt,T]],{fallthroughUnlessDistribution:!0,allowDotCall:!0,minArityExampleArgs:\"([1,2,3], 1)\",maxArityExampleArgs:\"([1,2,3], 1)\",dotMinArityExampleArgs:\"(x)\",dotMaxArityExampleArgs:\"(x)\"}),random:qe([[et],[et,T],[et,T,T],[et,Hh],[et,Hh,T],[et,Hh,T,T]],{allowDotCall:!0,isSeeded:!0,noBroadcast:!0}),polygon:qe([{type:\"variadic\",initial:[],rest:C},[xt],[le,le],[T,le],[le,T]]),total:qe([T,C,V].map(Uh),{allowDotCall:!0}),mean:qe([[Dt],...[T,C,V].map(Uh)],{allowDotCall:!0}),histogram:uo(),dotplot:uo(),boxplot:uo(),ttest:uo(),ittest:uo(),stats:uo(),det:uo(),inv:uo(),transpose:uo(),rref:uo(),trace:uo()};function nl(e){return!!co[e]}function rl(e){return!!gr[e]}function Rp(e){let t=nl(e)?co[e]:void 0;if(!t&&!rl(e))return;let r=[];return t&&(r=[...t.argumentTypes]),rl(e)&&(!t||t.fallthroughUnlessDistribution)&&r.push(...$h(e)),r}function Uh(e){return ti({type:\"variadic\",initial:[e],rest:e})}function $h(e){let t=[],r=gr[e];switch(r.tag){case\"reducer\":{if(Array.isArray(r.argumentTypes)&&typeof r.argumentTypes[0]==\"number\"&&W(r.argumentTypes[0])){let n=r.argumentTypes[0],i=ze(n);t.push(Uh(i))}else throw new Error(`Programming error: declared argumentTypes for built-in function ${e} is not consistent with \"reducer\"`);break}case\"parameterizedReducer\":{t.push(r.argumentTypes),Array.isArray(r.argumentTypes)&&r.argumentTypes.length===2&&t.push([r.argumentTypes[0],qu(r.argumentTypes[1])]);break}case\"doubleReducer\":case\"never-broadcast\":{t.push(r.argumentTypes);break}default:{t.push(ti(r.argumentTypes));break}}return t}var lr=class extends Q{constructor(t,r){super(r,{skipRegisterDependencies:!0}),typeof t==\"string\"&&(t=new Fe(t)),this._identifier=t,this._symbol=t._symbol,this._errorSymbol=t._errorSymbol===\"logbase\"?\"log\":t._errorSymbol,this.registerDependencies()}registerDependencies(){this.addDependency(this._symbol),super.registerDependencies(),$a(this._symbol)&&this.addDependency(\"trigAngleMultiplier\")}};var ts=class extends Q{};var kd={pi:new jt(Math.PI),tau:new jt(2*Math.PI),e:new jt(Math.E),trigAngleMultiplier:new jt(Re(1,1)),infty:new jt(1/0),identityTransformation:new lr(\"translation\",[new ts([new jt(0),new jt(0)])])};var Hd=class extends zt{constructor(){super(...arguments);this.isFunction=!0}},zo,rt={};for(zo in kd)kd.hasOwnProperty(zo)&&(rt[zo]=kd[zo]);for(zo in gr)gr.hasOwnProperty(zo)&&(rt[zo]=new Hd);for(zo in co)co.hasOwnProperty(zo)&&(rt[zo]=new Hd);function N_(e){var t={};return e.additionalFunctions&&e.additionalFunctions.indexOf(\"sqrt\")!==-1&&(t.sqrt=rt.sqrt),e.width&&(t.width=e.width),e.height&&(t.height=e.height),t}var Yh={};wo(Yh,{getFrame:()=>A_});var JM=[\"pi\",\"e\",\"trigAngleMultiplier\"],QM=[\"sqrt\",\"nthroot\",\"abs\",\"ln\",\"sin\",\"cos\",\"tan\",\"log\",\"arcsin\",\"arccos\",\"arctan\",\"mean\",\"round\",\"stdev\",\"stdevp\",\"nCr\",\"nPr\",\"exp\",\"factorial\"];function KM(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(!t.hasOwnProperty(n))throw new Error(\"Programming Error: key '\"+n+`' does not exist in table. Must be one of:\n`+Object.keys(t).join(`\n`))}}KM(JM,rt);KM(QM,rt);function A_(e){var t={};return JM.forEach(function(r){t[r]=rt[r]}),QM.forEach(function(r){e.replaceRoundWithReciprocal&&r===\"round\"||(t[r]=rt[r])}),e.trigAngleMultiplier&&(t.trigAngleMultiplier=e.trigAngleMultiplier),e.width&&(t.width=e.width),e.height&&(t.height=e.height),t}var Xh={};wo(Xh,{getFrame:()=>__});var ev=[\"pi\",\"e\",\"trigAngleMultiplier\"],tv=[\"sqrt\",\"nthroot\",\"abs\",\"ln\",\"sin\",\"cos\",\"tan\",\"log\",\"arcsin\",\"arccos\",\"arctan\",\"exp\",\"factorial\"];function rv(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(!t.hasOwnProperty(n))throw new Error(\"Programming Error: key '\"+n+`' does not exist in table. Must be one of:\n`+Object.keys(t).join(`\n`))}}rv(ev,rt);rv(tv,rt);function __(e){var t={};return ev.forEach(function(r){t[r]=rt[r]}),tv.forEach(function(r){t[r]=rt[r]}),e.trigAngleMultiplier&&(t.trigAngleMultiplier=e.trigAngleMultiplier),e.width&&(t.width=e.width),e.height&&(t.height=e.height),t}var Cp={};wo(Cp,{getFrame:()=>V_});var nv={segment:!0,line:!0,ray:!0,circle:!0,arc:!0,vector:!0,glider:!0,parallel:!0,perpendicular:!0,center:!0,radius:!0,area:!0,perimeter:!0,start:!0,end:!0,angles:!0,angle:!0,directedangles:!0,directedangle:!0,coterminal:!0,supplement:!0,vertices:!0,segments:!0,intersection:!0,translate:!0,dilate:!0,rotate:!0,reflect:!0,construction:!0,points:!0,lines:!0,circles:!0,arcs:!0,polygons:!0,rays:!0};var iv={segment:!0,triangle:!0,vector:!0,start:!0,end:!0,sphere:!0};var sv=[\"csc\",\"sec\",\"cot\",\"arccsc\",\"arcsec\",\"arccot\",\"csch\",\"sech\",\"coth\",\"arccsch\",\"arcsech\",\"arccoth\",\"mad\",\"cov\",\"covp\",\"distance\",\"midpoint\"],ov=[\"histogram\",\"dotplot\",\"boxplot\"],L_=[...ov,\"polygon\"],av=[\"erf\",\"ttest\",\"tscore\",\"ittest\",\"normaldist\",\"tdist\",\"poissondist\",\"binomialdist\",\"pdf\",\"cdf\",\"random\",...ov],w_=[\"distance\",\"midpoint\"],F_=[\"det\",\"inv\",\"transpose\",\"rref\",\"trace\"],uv=Object.keys(nv).filter(function(e){return e!==\"construction\"});function Zh(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(!t.hasOwnProperty(n))throw new Error(\"Programming Error: key '\"+n+`' does not exist in table. Must be one of:\n`+Object.keys(t).join(`\n`))}}Zh(sv,rt);Zh(av,rt);Zh(uv,rt);function V_(e){var t={},r;for(r in rt){if(!rt.hasOwnProperty(r)||e.restrictedFunctions===!0&&sv.indexOf(r)!==-1&&!(e.forceEnableGeometryFunctions===!0&&w_.indexOf(r)!==-1)||e.distributions===!1&&av.indexOf(r)!==-1)continue;let n=uv.indexOf(r)!==-1,i=r in iv;if(n&&i){if(!(e.isGeometryCalculator||e.is3DCalculator))continue}else if(n){if(!e.isGeometryCalculator)continue}else if(i){if(!e.is3DCalculator)continue}else if(L_.indexOf(r)!==-1&&e.is3DCalculator)continue;F_.indexOf(r)===-1&&(t[r]=rt[r])}return e.trigAngleMultiplier&&(t.trigAngleMultiplier=e.trigAngleMultiplier),e.globalRandomSeed&&(t.globalRandomSeed=e.globalRandomSeed),e.initialEvaluation&&(t.initialEvaluation=e.initialEvaluation),e.globalEventCount&&(t.globalEventCount=e.globalEventCount),e.width&&(t.width=e.width),e.height&&(t.height=e.height),t}var sA={};wo(sA,{parse:()=>Hs,setInput:()=>iR});function cv(e){let t=function(...i){return new e(...i)};t.prototype=e.prototype;var r=Object.getOwnPropertyNames(e);for(var n of r){let i=e[n];if(typeof i==\"function\")try{t[n]=i}catch(s){}}return t}var R=class extends zt{constructor(r){super();this.isError=!0;this._msg=r,this.blocksExport=!0}evaluateOnce(r){return this._msg}getError(){return this._msg}setDependencies(r){return this.addDependencies(r),this}setActionValue(r){this.actionValue=r}allowExport(){return this.blocksExport=!1,this}setCursorContext(r){this.cursorContext=r}getCursorContext(){return this.cursorContext}};var qd=class extends jt{constructor(){super(...arguments);this.is_mixed_number=!0}};var $d=class extends Fe{};function B_(e){for(var t=1/0,r=0;r<e.length;r++)(e[r].isList||e[r].isBroadcast)&&(t=Math.min(t,e[r].length));return t}var Np=class Np extends Q{constructor(r){super(r);this.isList=!0;this.length=r.length}asValue(){for(var r=[],n=0;n<this.args.length;n++)r.push(this.args[n].asValue());return r}asCompilerValue(){for(var r=[],n=0;n<this.args.length;n++)r.push(this.args[n].asCompilerValue());return r}getEvaluationInfo(){if(this.args.every(function(r){return r.isConstant}))return[{val:this.args.map(function(r){return r.asValue()})}]}};Np.eachArgs=function(r,n){var i=B_(r);if(!isFinite(i)){n(r);return}for(var s=0;s<i;s++){for(var o=[],a=0;a<r.length;a++)o.push(r[a].isList||W(r[a].valueType)?r[a].elementAt(s):r[a]);n(o,s)}},Np.wrap=function(r){return r.isList||W(r.valueType)?r:new Np([r])};var ko=Np;var il=class extends Q{constructor(t){super(t),this.beginning=t[0],this.end=t[1]}isHalfEmpty(){return this.end&&this.end.args&&this.end.args.length===0}};var Ya=class extends Q{constructor(t){super(t),this.list=t[0],this.index=t[1]}};var Fi=class extends Q{registerDependencies(){if(super.registerDependencies(),this.args[1].type===\"Identifier\"){var t=this.args[1]._symbol;$a(t)&&this.addDependency(\"trigAngleMultiplier\")}}};var Ju=class extends Q{constructor(r){var n=r.map(function(i){return new Fe(\"\\\\idref_{\"+i+\"}\")});super(n);this.constructedObjectIds=r;this._exports.push(\"construction\")}};var Yd=class extends ts{constructor(r,n,i){super(r);this.isTypedConstant=!0;this.isMovablePoint=!0;this.moveStrategy=n,this.defaultDragMode=i,this.valueType=C}asValue(){return[+this.args[0].asValue(),+this.args[1].asValue()]}asTypedValue(){return{valueType:this.valueType,value:this.asValue()}}asCompilerValue(){return[this.args[0].asCompilerValue(),this.args[1].asCompilerValue()]}};var Qu=class extends Q{constructor(t,r){super(r),this.symbol=t}};var Xa=class extends Q{};var sl=class extends Q{};var Tn=class extends Q{};var _n={\"<\":{inclusive:!1,direction:-1},\"!=\":{inclusive:!1,direction:0},\">\":{inclusive:!1,direction:1},\"<=\":{inclusive:!0,direction:-1},\"=\":{inclusive:!0,direction:0},\">=\":{inclusive:!0,direction:1}};function Ku(e,t){switch(t){case-1:return e?\"<=\":\"<\";case 0:return e?\"=\":\"!=\";case 1:return e?\">=\":\">\";default:throw\"Programming error.  Comparators must have a direction of -1, 0, or 1\"}}var ws=class e extends Q{constructor(r,n){super(n);this.operator=r;this._difference=_n[this.operator].direction===-1?new Tn([n[1],n[0]]):new Tn([n[0],n[1]])}static create(r){class n extends e{constructor(s){super(r,s)}}return n}asComparator(){return this}isInequality(){return _n[this.operator].direction!==0}};var Ti={\"<\":ws.create(\"<\"),\">\":ws.create(\">\"),\"<=\":ws.create(\"<=\"),\">=\":ws.create(\">=\"),\"=\":ws.create(\"=\")};var dn=class extends Q{};var ir={};wo(ir,{actionMergeFreeVariable:()=>Fb,addArgumentsToDefinition:()=>Wp,addTypeError:()=>Kh,adjacentMixedNumber:()=>um,adjacentNumbers:()=>ox,andTypeError:()=>ab,ansUndefined:()=>AP,assignmentsUnsupported:()=>tf,badEqualitySlice:()=>Ho,badForInputListDependency:()=>VP,badForIntervalDependency:()=>BP,badImplicitCall:()=>am,badIntegralBoundDependency:()=>OP,badLogExponent:()=>Dx,badProductBoundDependency:()=>xP,badSampleSize:()=>CP,badSumBoundDependency:()=>bP,badSymbolContext:()=>Kp,badTrigExponent:()=>vx,badTupleDimensions:()=>sx,binaryOperatorMissingOperand:()=>Yp,blankExpression:()=>Xp,boxplotBreadthInvalid:()=>Xb,boxplotOffsetInvalid:()=>Yb,cannotAssignColor:()=>jx,cannotRedefine:()=>cl,cannotRestrict:()=>Wx,cannotRestrictWithEquality:()=>Jx,cannotSubscript:()=>Ax,cantCombineSphericalAndCylindrical:()=>gm,cdfMaxInvalid:()=>$x,cdfMaxLessThanMin:()=>Yx,cdfMinInvalid:()=>qx,cdfRequiresArguments:()=>Wb,cdfTooManyArguments:()=>jb,clickableObjectAlreadyAssigned:()=>Z_,clickableObjectAssignmentNotDefined:()=>X_,clickableObjectAssignmentNotIdentifier:()=>W_,clickableObjectInvalidExpression:()=>j_,colonMissingCondition:()=>Rx,colorArity:()=>ex,combineTypeError:()=>nm,comparatorTypeError:()=>ob,complicatedDoubleInequality:()=>Pm,complicatedPolarImplicit:()=>iP,constantUnsupported:()=>ic,cycle:()=>ym,deeplyNested:()=>zb,dependsOnDeletedGeoObject:()=>qP,derivativeMissingBody:()=>DP,derivativeTypeError:()=>vb,derivativeVariableTypeError:()=>Db,differentialWithSuperscript:()=>IP,distributionAsFunction:()=>Em,divideTypeError:()=>tb,domainMaxInvalid:()=>Hx,domainMaxLessThanMin:()=>Ux,domainMinInvalid:()=>kx,dotLHSTypeError:()=>yb,duplicateFunctionParameter:()=>Cx,duplicateUpdateRules:()=>_b,emptyParen:()=>Ix,emptyPipe:()=>Mx,emptyRadical:()=>Px,emptyRadicalIndex:()=>Tx,emptySquareBracket:()=>Ex,emptySubscript:()=>cm,emptySuperscript:()=>yx,equationRequired:()=>Tm,equationsUnsupported:()=>ga,eventHandlerTypeError:()=>zp,exponentTypeError:()=>rb,featureUnavailable:()=>nf,fractionEmpty:()=>mx,fractionMissingDenominator:()=>dx,fractionMissingNumerator:()=>fx,fractionsUnavailable:()=>Om,functionDefinitionsUnsupported:()=>rf,functionFreeVariable:()=>H_,functionNameAsParameter:()=>Nx,functionNotDefined:()=>fm,functionTypeError:()=>Vi,functionUnsupported:()=>gs,geometryLengthTypeError:()=>db,getLogInternalErrors:()=>G_,gpuLongProduct:()=>$b,gpuLongSum:()=>qb,gpuMaxListSize:()=>ul,gpuUnsupportedFunction:()=>al,gpuUnsupportedIntegral:()=>Ub,gpuVariableListLength:()=>tc,gpuVariableProduct:()=>sm,gpuVariableSum:()=>im,heterogeneousList:()=>kp,identifierAsFunction:()=>ux,identifierIsNotFunction:()=>cx,illegalBinWidth:()=>Qp,illegalDotCall:()=>Gp,implicitsDisabled:()=>nP,incorrectProductLowerBound:()=>hP,incorrectSumLowerBound:()=>gP,indexTypeError:()=>Bp,inequalitiesDisabled:()=>hm,inequalitiesUnsupported:()=>sc,integralArgumentTypeError:()=>Mb,integralLowerBoundTypeError:()=>Ib,integralMissingBody:()=>vP,integralMissingBound:()=>PP,integralMissingDifferential:()=>TP,integralUpperBoundTypeError:()=>Eb,internal:()=>ee,invalidDependentFirstTableColumn:()=>k_,invalidDoubleEquality3d:()=>oP,invalidDoubleInequality3d:()=>sP,invalidDoubleInequalityVariables:()=>bm,invalidFirstTableColumn:()=>cP,invalidFunctionName:()=>LP,invalidHalfEmptyRange:()=>dP,invalidImplicitVariables:()=>nc,invalidImplicitVariables3d:()=>tP,invalidInequalityVariables:()=>eP,invalidIntervalComprehensionArity:()=>YP,invalidIntervalComprehensionParameter:()=>yl,invalidIntervalComprehensionReturnType:()=>$P,invalidLHS:()=>Qx,invalidNestedIntervalComprehension:()=>XP,invalidOperatorName:()=>hx,invalidRegressionParameter:()=>lP,invalidSubscript:()=>gx,invalidTableEntry:()=>pl,invalidTableHeader:()=>uP,listComprehensionIncorrectInput:()=>FP,listComprehensionInputListTypeError:()=>wP,listTypeError:()=>Za,logScaleBoxPlot:()=>Gb,logScaleDotPlot:()=>Bb,logScaleHistogram:()=>Vb,logScaleTypeError:()=>Hp,logbaseUnsupported:()=>_P,malformedList:()=>ix,malformedPoint:()=>nx,matrixAddDimensions:()=>Q_,matrixAssignment:()=>J_,matrixElementTypeError:()=>nL,matrixFractionalPower:()=>tL,matrixInvalidVariable:()=>iL,matrixMultiplyDimensions:()=>eL,matrixPowerDimensions:()=>rL,matrixSubtractDimensions:()=>K_,maxListSize:()=>Up,methodRequiresList:()=>Fs,mismatchedBraces:()=>SP,mismatchedDoubleInequality:()=>xm,mixedComparatorChain:()=>ib,mixedRestrictionEquation:()=>Hb,multipleEqualityRestrictions:()=>kb,multiplyDefined:()=>ll,multiplyDefinedByTables:()=>_x,multiplyTypeError:()=>Lp,multiplyTypeError2D:()=>Fp,multiplyTypeError3D:()=>Vp,multiplyTypeErrorCross:()=>wp,negativeTypeError:()=>nb,nonArithmeticRange:()=>Jp,nonListDoubleReducer:()=>jp,nonListParameterizedReducer:()=>fP,nonSquareDeterminant:()=>U_,nonSquareInverse:()=>$_,nonSquareTrace:()=>q_,opaque:()=>_p,optimizationError:()=>pP,orTypeError:()=>ub,orderedPairAccessTypeError:()=>lb,parameterAlreadyDefined:()=>dm,pdfWrongArity:()=>Zb,percentMissingOf:()=>RP,piecewiseBranchTypeError:()=>Sb,piecewiseConditionTypeError:()=>em,piecewiseMissingCondition:()=>Sx,piecewisePartMissingCondition:()=>Ox,pointTypeError:()=>cb,pointsUnsupported:()=>ac,polygonTwoNumbersError:()=>qp,polygonUnsupportedIn3d:()=>Dm,primeWithoutParen:()=>pm,primedFunctionArity:()=>rc,productArgumentTypeError:()=>Tb,productInfiniteBoundError:()=>Kd,productLowerBoundTypeError:()=>xb,productMissingBody:()=>MP,productMissingBound:()=>yP,productUpperBoundTypeError:()=>Pb,randomArity:()=>Qb,randomFromBroadcastDistribution:()=>Kb,recursionDoesNotTerminate:()=>Ap,recursionTodo:()=>Jr,recursiveDepthExceeded:()=>Jh,regressionTypeError:()=>Cb,regressionsUnsupported:()=>oc,selfReferentialFunction:()=>Zp,setLogInternalErrors:()=>jh,shadowedIndex:()=>mm,shadowedIntegrationVariable:()=>Mm,shadowedListComprehensionInput:()=>Rm,singleVariableImplicitEquationsDisabled:()=>rP,singularInverse:()=>Y_,sliderLimitReferencesExport:()=>Fx,sliderMaxInvalid:()=>Bx,sliderMaxLessThanMin:()=>Gx,sliderMinInvalid:()=>Vx,sliderStepInvalid:()=>zx,substitutionAmbiguousComma:()=>Wa,substitutionBodyAction:()=>oL,substitutionBodyDependsOnRegression:()=>HP,substitutionDuplicateSymbol:()=>UP,substitutionFunctionLHS:()=>ml,substitutionIllegalLHS:()=>dl,substitutionInvalidAssignments:()=>of,substitutionLocalLHS:()=>af,substitutionNested:()=>Cm,substitutionTypeError:()=>sL,substitutionUnsupportedInterval:()=>Nm,subtractTypeError:()=>eb,sumArgumentTypeError:()=>bb,sumInfiniteBoundError:()=>Qd,sumLowerBoundTypeError:()=>gb,sumMissingBody:()=>EP,sumMissingBound:()=>mP,sumUpperBoundTypeError:()=>hb,superscriptWithPrime:()=>xx,tableCycleWithoutGlobalDefinition:()=>Lx,tableEntryTypeError:()=>Rb,tableHeaderTypeError:()=>Ob,tdistWrongArity:()=>Jb,threeDLengthTypeError:()=>mb,tickerMinStepNonNegativeNumber:()=>wx,tokenWithSubscript:()=>ax,tooManyArguments:()=>om,tooManyVariables:()=>ar,transformationDefinitionTypeError:()=>pb,transformationTypeError:()=>fb,ttestListTooShort:()=>fl,unaryOperatorMissingLeft:()=>lx,unaryOperatorMissingRight:()=>px,unexpectedEquality:()=>Qh,unexpectedInequality:()=>Jd,unexpectedPrime:()=>lm,unexpectedSubscript:()=>bx,unexpectedSymbol:()=>Ln,unplottableEqualityChain:()=>aP,unplottableLongInequalityChain:()=>sb,unplottablePolarFunction:()=>Kx,unrecognizedSymbol:()=>jd,updateRuleFunctionLHS:()=>tm,updateRuleIllegalLHS:()=>wb,updateRuleLocalLHS:()=>rm,updateRuleNonIdentifierLHS:()=>Ab,updateRuleTypeError:()=>Nb,updateRuleUndefinedLHS:()=>Lb,useRForCylindricalCoordinates:()=>Zx,useRhoForSphericalCoordinates:()=>Xx,variableAsFunction:()=>Im,variableLengthDistributionList:()=>sf,variableLengthProductBodyDependsOnIndex:()=>kP,variableLengthSumBodyDependsOnIndex:()=>zP,variableLengthTopLevelList:()=>GP,variableSeed:()=>NP,variableUnsupported:()=>Sm,variablesUnsupported:()=>ef,writeIntegral:()=>vm,wrongArity:()=>rs,wrongDoubleReducerArity:()=>$p,wrongParameterizedReducerArity:()=>tx,zeroArgReducer:()=>rx});var Wd=!1;function jh(e){Wd=e}function G_(){return Wd}function z_(...e){Wd&&console.error(...e)}function ee(e){if(Wd){let t=e instanceof Error?e:new Error(`${e}`);return z_(t.stack),new R(S(\"shared-calculator-error-internal-error\",{msg:t.message}))}return new R(S(\"shared-calculator-error-parse-error\"))}function Jr(e){return new R(S(\"shared-calculator-error-recursion-todo-error\",{msg:e}))}function Jh(){let e=Jr(\"Recursive depth limit exceeded\");return e.isRecursiveDepthError=!0,e}function Ap(){let e=Jr(\"Recursion does not terminate\");return e.isRecursiveDepthError=!0,e}function _p(){return new R(S(\"shared-calculator-error-parse-error\"))}function jd(e){return e=j(e),new R(S(\"shared-calculator-error-unrecognized-symbol\",{symbol:e}))}function Jd(){return new R(S(\"shared-calculator-error-unexpected-inequality\"))}function Qh(){return new R(S(\"shared-calculator-error-unexpected-equality\"))}function Ln(e){return e=j(e),new R(S(\"shared-calculator-error-unexpected-symbol\",{symbol:e}))}function Kh(e){return new R(S(\"shared-calculator-error-add-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function eb(e){return new R(S(\"shared-calculator-error-subtract-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function Lp(e){return new R(S(\"shared-calculator-error-multiply-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function wp(e){return new R(S(\"shared-calculator-error-multiply-type-error-cross\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function Fp(e){return new R(S(\"shared-calculator-error-multiply-type-error-2d\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function Vp(e){return new R(S(\"shared-calculator-error-multiply-type-error-3d\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function tb(e){return new R(S(\"shared-calculator-error-divide-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function rb(e){return new R(S(\"shared-calculator-error-exponent-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function nb(e){return new R(S(\"shared-calculator-error-negative-type-error\",{symbol:e[0]})).allowExport()}function ib(){return new R(S(\"shared-calculator-error-mixed-comparator-chain\"))}function sb(){return new R(S(\"shared-calculator-error-unplottable-long-inequality-chain\"))}function ob(e){return new R(S(\"shared-calculator-error-comparator-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function ab(e){return new R(S(\"shared-calculator-error-operator-type-error\",{symbol:\"and\",symbol1:e[0],symbol2:e[1]})).allowExport()}function ub(e){return new R(S(\"shared-calculator-error-operator-type-error\",{symbol:\"or\",symbol1:e[0],symbol2:e[1]})).allowExport()}function Za(e){return new R(S(\"shared-calculator-error-list-type-error\",{symbol1:e[0]})).allowExport()}function cb(e){return new R(S(\"shared-calculator-error-point-type-error\",{symbol1:e,symbol2:ne(C)})).allowExport()}function Bp(e){return new R(S(\"shared-calculator-error-index-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function lb(e){return new R(S(\"shared-calculator-error-ordered-pair-access-type-error\",{symbol:e[0]})).allowExport()}function Vi(e,t){switch(t.length){case 1:return new R(S(\"shared-calculator-error-function-type-error-1\",{fn:j(e),arg:t[0]})).allowExport();case 2:return new R(S(\"shared-calculator-error-function-type-error-2\",{fn:j(e),arg1:t[0],arg2:t[1]})).allowExport();default:return new R(S(\"shared-calculator-error-function-type-error-many\",{fn:j(e)})).allowExport()}}var Wh={translate:\"translation\",rotate:\"rotation\",dilate:\"dilation\",reflect:\"reflection\"};function pb(e,t,r){let n=[];if(!Array.isArray(r))return Vi(e,t);for(let s=1;s<r.length;s++){let o=r[s];typeof o==\"number\"?n.push(ne(o)):n.push(ne(o.types[0]))}let i=\"\";switch(n.length){case 1:i=S(t.length>n.length?\"shared-calculator-error-transformation-definition-expected-types-use-fewer-1\":\"shared-calculator-error-transformation-definition-expected-types-1\",{arg:n[0]});break;case 2:i=S(t.length>n.length?\"shared-calculator-error-transformation-definition-expected-types-use-fewer-2\":\"shared-calculator-error-transformation-definition-expected-types-2\",{arg1:n[0],arg2:n[1]});break}switch(t.length){case 1:return new R(S(t.length<n.length?\"shared-calculator-error-transformation-definition-type-error-use-more-1\":\"shared-calculator-error-transformation-definition-type-error-1\",{fn:j(Wh[e]),arg:t[0],expectedTypeMessage:i}));case 2:return new R(S(t.length<n.length?\"shared-calculator-error-transformation-definition-type-error-use-more-2\":\"shared-calculator-error-transformation-definition-type-error-2\",{fn:j(Wh[e]),arg1:t[0],arg2:t[1],expectedTypeMessage:i}));default:return new R(S(\"shared-calculator-error-transformation-definition-type-error-many\",{fn:j(Wh[e])}))}}function fb(e,t){switch(t.length){case 1:return new R(S(\"shared-calculator-error-transformation-type-error-1\",{fn:j(e),arg:t[0]})).allowExport();case 2:return new R(S(\"shared-calculator-error-transformation-type-error-2\",{fn:j(e),arg1:t[0],arg2:t[1]})).allowExport();default:return new R(S(\"shared-calculator-error-transformation-type-error-many\",{fn:j(e)})).allowExport()}}function db(e,t){let r=j(e),n=j(\"count\");return new R(S(\"shared-calculator-error-geometry-length-type-error\",{fn:r,alternativeFn:n,arg:t})).allowExport()}function mb(e,t){let r=j(e),n=j(\"count\");return new R(S(\"shared-calculator-error-3d-length-type-error\",{fn:r,alternativeFn:n,arg:t})).allowExport()}function Gp(e){return new R(S(\"shared-calculator-error-illegal-dot-call\",{symbol:j(e)}))}function yb(e,t){return new R(S(\"shared-calculator-error-dot-lhs-type-error\",{symbol:j(e),type:t})).allowExport()}function gb(e){return new R(S(\"shared-calculator-error-sum-lower-bound-type-error\",{symbol:e[0]})).allowExport()}function hb(e){return new R(S(\"shared-calculator-error-sum-upper-bound-type-error\",{symbol:e[0]})).allowExport()}function Qd(){return new R(S(\"shared-calculator-error-sum-infinite-bound-type-error\"))}function bb(e){return new R(S(\"shared-calculator-error-sum-argument-type-error\",{symbol:e[0]})).allowExport()}function xb(e){return new R(S(\"shared-calculator-error-product-lower-bound-type-error\",{symbol:e[0]})).allowExport()}function Pb(e){return new R(S(\"shared-calculator-error-product-upper-bound-type-error\",{symbol:e[0]})).allowExport()}function Kd(){return new R(S(\"shared-calculator-error-product-infinite-bound-type-error\"))}function Tb(e){return new R(S(\"shared-calculator-error-product-argument-type-error\",{symbol:e[0]})).allowExport()}function Ib(e){return new R(S(\"shared-calculator-error-integral-lower-bound-type-error\",{symbol:e[0]})).allowExport()}function Eb(e){return new R(S(\"shared-calculator-error-integral-upper-bound-type-error\",{symbol:e[0]})).allowExport()}function Mb(e){return new R(S(\"shared-calculator-error-integral-argument-type-error\",{symbol:e[0]})).allowExport()}function vb(e){return new R(S(\"shared-calculator-error-derivative-type-error\",{symbol:e[0]})).allowExport()}function Db(e,t){return new R(S(\"shared-calculator-error-derivative-variable-type-error\",{symbol1:j(e),symbol2:t[0]}))}function em(e){return new R(S(\"shared-calculator-error-piecewise-condition-type-error\",{symbol1:ne(Ee),symbol2:e[0]})).allowExport()}function Sb(e){return new R(S(\"shared-calculator-error-piecewise-branch-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function Ob(e){return new R(S(\"shared-calculator-error-table-header-type-error\",{symbol:e[0]}))}function Rb(e){return new R(S(\"shared-calculator-error-table-entry-type-error\",{symbol:e[0]}))}function Cb(e){return new R(S(\"shared-calculator-error-regression-type-error\",{symbol1:e[0],symbol2:e[1]}))}function Nb(e){return new R(S(\"shared-calculator-error-update-rule-type-error\",{symbol:e}))}function Ab(){return new R(S(\"shared-calculator-error-update-rule-non-identifier-lhs\",{arrow:\"\\u2192\",example:\"a\"}))}function _b(e){return new R(S(\"shared-calculator-error-duplicate-update-rules\",{symbol:j(e)}))}function Lb(e){return new R(S(\"shared-calculator-error-update-rule-undefined-lhs\",{symbol:j(e)}))}function wb(e){return new R(S(\"shared-calculator-error-update-rule-illegal-lhs\",{symbol:j(e)}))}function tm(e){return new R(S(\"shared-calculator-error-update-rule-function-lhs\",{symbol:j(e)}))}function rm(e){return new R(S(\"shared-calculator-error-update-rule-local-lhs\",{symbol:j(e)}))}function Fb(e){let t=e.filter(r=>r.scope===\"free\").map(r=>r.symbol);return new R(S(\"shared-calculator-error-action-merge-free-variable\",{symbol:j(t[0]||\"\")})).setDependencies(t).allowExport()}function zp(e){return new R(S(\"shared-calculator-error-event-handler-type-error\",{example:\"a\\u2192a+1\"}))}function kp(){return new R(S(\"shared-calculator-error-heterogeneous-list\")).allowExport()}function nm(e){return new R(S(\"shared-calculator-error-combine-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function Hp(e){return new R(S(\"shared-calculator-error-log-scale-type-error\",{symbol:e})).allowExport()}function Vb(){return new R(S(\"shared-calculator-error-log-scale-histogram\"))}function Bb(){return new R(S(\"shared-calculator-error-log-scale-dot-plot\"))}function Gb(){return new R(S(\"shared-calculator-error-log-scale-box-plot\"))}function zb(){return new R(S(\"shared-calculator-error-deeply-nested\")).allowExport()}function kb(){return new R(S(\"shared-calculator-error-3d-multiple-equality-restrictions\")).allowExport()}function Hb(){return new R(S(\"shared-calculator-error-3d-mixed-restriction-equation\")).allowExport()}function Ho(){return new R(S(\"shared-calculator-error-3d-bad-equality-slice\")).allowExport()}function tc(e){return new R(S(\"shared-calculator-error-gpu-variable-list-length\",{symbol:j(e.filter(t=>t.symbol!==\"globalRandomSeed\")[0].symbol)}))}function im(e){return new R(S(\"shared-calculator-error-gpu-variable-sum\",{symbol:j(e[0].symbol)}))}function sm(e){return new R(S(\"shared-calculator-error-gpu-variable-product\",{symbol:j(e[0].symbol)}))}function al(e){return new R(S(\"shared-calculator-error-gpu-function-unsupported\",{symbol:j(e)}))}function Ub(){return new R(S(\"shared-calculator-error-gpu-integral-unsupported\"))}function qb(){return new R(S(\"shared-calculator-error-gpu-long-sum\",{maxTermCount:1e3.toLocaleString()}))}function $b(){return new R(S(\"shared-calculator-error-gpu-long-product\",{maxTermCount:1e3.toLocaleString()}))}function ul(){return new R(S(\"shared-calculator-error-gpu-max-list-size\",{maxListSize:100 .toLocaleString()}))}function Up(){return new R(S(\"shared-calculator-error-max-list-size\",{maxListSize:1e4.toLocaleString()})).allowExport()}function qp(){return new R(S(\"shared-calculator-error-two-numbers-error\"))}function Yb(){return new R(S(\"shared-calculator-error-boxplot-offset-invalid\"))}function Xb(){return new R(S(\"shared-calculator-error-boxplot-breadth-invalid\"))}function om(e,t){return new R(S(\"shared-calculator-error-too-many-arguments\",{symbol:e,max:t}))}function Zb(){var e=S(\"shared-calculator-error-pdf-wrong-arity-recommendation\"),t=S(\"shared-calculator-error-pdf-wrong-arity\",{recommendation:e});return new R(t)}function Wb(){var e=S(\"shared-calculator-error-cdf-wrong-arity-recommendation\"),t=S(\"shared-calculator-error-cdf-wrong-arity\",{recommendation:e});return new R(t)}function jb(){var e=S(\"shared-calculator-error-cdf-too-many-arguments-recommendation\"),t=S(\"shared-calculator-error-cdf-too-many-arguments\",{recommendation:e});return new R(t)}function Jb(){return new R(S(\"shared-calculator-error-tdist-wrong-arity\"))}function Qb(){return new R(S(\"shared-calculator-error-random-arity\"))}function Kb(){return new R(S(\"shared-calculator-error-random-from-broadcast-distribution\"))}function ex(e){var t=e===\"rgb\"?[150,30,100]:[180,.5,.5],r=S(\"shared-calculator-error-color-arity-recommendation\",{recommendation:j(e)+\"(\"+t.join(\", \")+\")\"}),n=S(\"shared-calculator-error-color-arity\",{symbol:e,recommendation:r});return new R(n)}function rs(e,t,r,n){e=j(e);var i,s;if(t===1)n||(n=e+\"(x)\"),s=S(\"shared-calculator-error-wrong-arity-supplement\",{recommendation:n}),r>1?i=S(\"shared-calculator-error-wrong-arity-single-arg-too-many\",{dependency:e,supplement:s}):i=S(\"shared-calculator-error-wrong-arity-single-arg-too-few\",{dependency:e,supplement:s});else{var o=[];if(!n){for(var a=0;a<t;a++)o[a]=a+1;n=j(e)+\"(\"+o.join(\", \")+\")\"}s=S(\"shared-calculator-error-wrong-arity-supplement\",{recommendation:n}),i=S(\"shared-calculator-error-wrong-arity-many-arg\",{dependency:e,assignment_arity:t,supplement:s})}return new R(i)}function tx(e){return new R(S(\"shared-calculator-error-wrong-two-arg-arity\",{symbol:j(e),recommendation:j(e)+\"([1,2,3], 1)\"}))}function $p(e){return new R(S(\"shared-calculator-error-wrong-two-arg-arity\",{symbol:j(e),recommendation:j(e)+\"([1,2,3], [3,2,1])\"}))}function rc(){return new R(S(\"shared-calculator-error-primed-function-arity\"))}function rx(e){return new R(S(\"shared-calculator-error-zero-arg-reducer\",{symbol:j(e)}))}function nx(){return new R(S(\"shared-calculator-error-malformed-point\"))}function ix(){return new R(S(\"shared-calculator-error-malformed-list\"))}function sx(e){return new R(S(\"shared-calculator-error-bad-tuple-dimensions\",{symbol:e}))}function am(e){return e=j(e),new R(S(\"shared-calculator-error-bad-implicit-call\",{symbol:e}))}function ox(e,t){return new R(S(\"shared-calculator-error-adjacent-numbers\",{left:e,right:t}))}function um(e){return new R(S(\"shared-calculator-error-adjacent-mixed-number\",{mixedNumber:e}))}function ax(){return new R(S(\"shared-calculator-error-token-with-subscript\"))}function ux(e){return e=j(e),new R(S(\"shared-calculator-error-identifier-as-function\",{symbol:e}))}function cx(e){return e=j(e),new R(S(\"shared-calculator-error-identifier-is-not-function\",{symbol:e}))}function Yp(e){return e=j(e),e===\"%\"&&(e=\"% of\"),new R(S(\"shared-calculator-error-binary-operator-missing-operand\",{symbol:e}))}function lx(e){return e=j(e),new R(S(\"shared-calculator-error-unary-operator-missing-left\",{symbol:e}))}function px(e){return e=j(e),new R(S(\"shared-calculator-error-unary-operator-missing-right\",{symbol:e}))}function fx(){return new R(S(\"shared-calculator-error-fraction-missing-numerator\"))}function dx(){return new R(S(\"shared-calculator-error-fraction-missing-denominator\"))}function mx(){return new R(S(\"shared-calculator-error-fraction-empty\"))}function cm(){return new R(S(\"shared-calculator-error-empty-subscript\"))}function yx(){return new R(S(\"shared-calculator-error-empty-superscript\"))}function gx(e){return e=j(e),new R(S(\"shared-calculator-error-invalid-subscript\",{symbol:e}))}function hx(){return new R(S(\"shared-calculator-error-invalid-operator-name\"))}function bx(){return new R(S(\"shared-calculator-error-unexpected-subscript\"))}function xx(){return new R(S(\"shared-calculator-error-superscript-with-prime\"))}function lm(){return new R(S(\"shared-calculator-error-unexpected-prime\"))}function pm(){return new R(S(\"shared-calculator-error-prime-without-paren\"))}function Px(){return new R(S(\"shared-calculator-error-empty-radical\"))}function Tx(){return new R(S(\"shared-calculator-error-empty-radical-index\"))}function Ix(){return new R(S(\"shared-calculator-error-empty-paren\"))}function Ex(){return new R(S(\"shared-calculator-error-empty-square-bracket\"))}function Mx(){return new R(S(\"shared-calculator-error-empty-pipe\"))}function vx(e){var t=e+\"^2\",r=e+\"^-1\";return new R(S(\"shared-calculator-error-bad-trig-exponent\",{form1:t,form2:r}))}function Dx(e){var t=e+\"^2\";return new R(S(\"shared-calculator-error-bad-log-exponent\",{form:t}))}function Sx(){return new R(S(\"shared-calculator-error-piecewise-missing-condition\"))}function Ox(){return new R(S(\"shared-calculator-error-piecewise-part-missing-condition\"))}function Rx(){return new R(S(\"shared-calculator-error-colon-missing-condition\"))}function Xp(){return new R(S(\"shared-calculator-error-blank-expression\"))}function fm(e){return e=j(e),new R(S(\"shared-calculator-error-function-not-defined\",{dependency:e}))}function dm(e){return e=j(e),new R(S(\"shared-calculator-error-parameter-already-defined\",{dependency:e}))}function Cx(e){return e=j(e),new R(S(\"shared-calculator-error-duplicate-function-parameter\",{dependency:e}))}function Nx(e){return e=j(e),new R(S(\"shared-calculator-error-function-name-as-parameter\",{dependency:e}))}function cl(e,t){return e=j(e),t===void 0?new R(S(\"shared-calculator-error-cannot-redefine\",{symbol:e})):new R(S(\"shared-calculator-error-cannot-redefine-root\",{symbol:e,symbolRoot:t}))}function Ax(e){return e=j(e),new R(S(\"shared-calculator-error-cannot-subscript\",{symbol:e}))}function ll(e){return e=j(e),new R(S(\"shared-calculator-error-multiply-defined\",{dependency:e}))}function _x(e){let t=ll(e);return t.isMultiplyDefinedByTables=!0,t}function mm(e){return e=j(e),new R(S(\"shared-calculator-error-shadowed-index\",{symbol:e}))}function ym(e){e=e.map(j);var t=e.pop()||\"\";return new R(S(\"shared-calculator-error-dependency-cycle\",{symbols:e.join(\"', '\"),lastSymbol:t}))}function Lx(e){let t=ym(e);return t.isTableCycleWithoutGlobalDefinition=!0,t}function Zp(e){return new R(S(\"shared-calculator-error-self-referential-function\",{symbol:j(e)}))}function wx(){return new R(S(\"shared-calculator-error-ticker-min-step-nonnegative\"))}function Fx(e){return new R(S(\"shared-calculator-error-slider-limit-references-export\",{symbol:j(e)}))}function Vx(){return new R(S(\"shared-calculator-error-slider-min-invalid\"))}function Bx(){return new R(S(\"shared-calculator-error-slider-max-invalid\"))}function Gx(){return new R(S(\"shared-calculator-error-slider-max-less-than-min\"))}function zx(){return new R(S(\"shared-calculator-error-slider-step-invalid\"))}function kx(){return new R(S(\"shared-calculator-error-domain-min-invalid\"))}function Hx(){return new R(S(\"shared-calculator-error-domain-max-invalid\"))}function Ux(){return new R(S(\"shared-calculator-error-domain-max-less-than-min\"))}function qx(){return new R(S(\"shared-calculator-error-cdf-min-invalid\"))}function $x(){return new R(S(\"shared-calculator-error-cdf-max-invalid\"))}function Yx(){return new R(S(\"shared-calculator-error-cdf-max-less-than-min\"))}function Xx(){return new R(S(\"shared-calculator-error-use-rho-for-spherical-coordinates\"))}function Zx(){return new R(S(\"shared-calculator-error-use-r-for-cylindrical-coordinates\"))}function gm(){return new R(S(\"shared-calculator-error-cant-combine-spherical-and-cylindrical\"))}function ar(e){if(e=e.map(j),e.length===0)return new R(S(\"shared-calculator-error-too-many-variables-no-symbols\"));var t=e.pop()||\"\";return e.length>0?new R(S(\"shared-calculator-error-too-many-variables-many-symbols\",{variables:e.join(\"', '\"),lastVariable:t})):new R(S(\"shared-calculator-error-too-many-variables-one-symbol\",{variable:t}))}function Wx(e){return new R(S(\"shared-calculator-error-cannot-restrict\",{variable:j(e)}))}function jx(e){return new R(S(\"shared-calculator-error-cannot-assign-color\",{variable:j(e)}))}function Jx(e){return new R(S(\"shared-calculator-error-cannot-restrict-with-equality\",{variable:j(e)}))}function Wp(e,t,r){e=e.map(j),t=j(t),r=r.map(j);var n=t+\"(\"+r.join(\",\")+\",\"+e.join(\",\")+\")\",i=e.pop()||\"\",s={symbols:e.join(\"', '\"),lastSymbol:i,newSignature:n};return e.length?new R(S(\"shared-calculator-error-add-arguments-to-definition-many\",s)):new R(S(\"shared-calculator-error-add-arguments-to-definition-one\",s))}function Qx(e){return e=j(e),new R(S(\"shared-calculator-error-invalid-lhs\",{symbol:e}))}function Kx(){return new R(S(\"shared-calculator-error-unplottable-polar-function\"))}function eP(){return new R(S(\"shared-calculator-error-invalid-inequality-variables\"))}function nc(){return new R(S(\"shared-calculator-error-invalid-implicit-variables\"))}function tP(){return new R(S(\"shared-calculator-error-invalid-implicit-variables-3d\"))}function rP(){return new R(S(\"shared-calculator-error-single-variable-implicit-equations-disabled\"))}function nP(){return new R(S(\"shared-calculator-error-implicits-disabled\"))}function hm(){return new R(S(\"shared-calculator-error-inequalities-disabled\"))}function iP(){return new R(S(\"shared-calculator-error-complicated-polar-implicit\"))}function sP(){return new R(S(\"shared-calculator-error-invalid-double-inequality-3d\"))}function oP(){return new R(S(\"shared-calculator-error-invalid-double-equality-3d\"))}function aP(){return new R(S(\"shared-calculator-error-unplottable-chained-equality\"))}function bm(){return new R(S(\"shared-calculator-error-invalid-double-inequality-variables\"))}function xm(){return new R(S(\"shared-calculator-error-mismatched-double-inequality\",{example:\"1 < y < 2\"}))}function Pm(){return new R(S(\"shared-calculator-error-complicated-double-inequality\"))}function Tm(e){return e?(e=j(e),new R(S(\"shared-calculator-error-equation-required-symbol\",{lhs:e+\"=\"}))):new R(S(\"shared-calculator-error-equation-required\"))}function Im(e){return e=j(e),new R(S(\"shared-calculator-error-variable-as-function\",{dependency:e}))}function Em(e){return e=j(e),new R(S(\"shared-calculator-error-distribution-as-function\",{symbol:e}))}function uP(e){return new R(S(\"shared-calculator-error-invalid-table-header\",{supplement:e}))}function pl(e){return new R(S(\"shared-calculator-error-invalid-table-entry\",{supplement:e}))}function cP(){return new R(S(\"shared-calculator-error-invalid-first-table-column\",{most:\"'y', 'r',\",last:\"'\\u03B8'\"}))}function k_(){return new R(S(\"shared-calculator-error-invalid-dependent-first-table-column\"))}function lP(e){return new R(S(\"shared-calculator-error-invalid-regression-parameter\",{symbol:j(e)}))}function pP(){return new R(S(\"shared-calculator-error-optimization-error\"))}function jp(e){return new R(S(\"shared-calculator-error-non-list-double-reducer\",{symbol:j(e),recommendation:j(e)+\"([1,2,3], [3,2,1])\"})).allowExport()}function fP(e){return new R(S(\"shared-calculator-error-non-list-parameterized-reducer\",{symbol:j(e),recommendation:j(e)+\"([1,2,3], 1)\"})).allowExport()}function Fs(e){return new R(S(\"shared-calculator-error-method-requires-list\",{symbol:j(e),recommendation:j(e)+\"([1,2,3])\"})).allowExport()}function H_(e,t){return new R(S(\"shared-calculator-error-variable-function-free-variable\",{functionSymbol:e,variableSymbol:t})).allowExport()}function Jp(){return new R(S(\"shared-calculator-error-non-arithmetic-range\")).allowExport()}function dP(){return new R(S(\"shared-calculator-error-invalid-half-empty-range\"))}function mP(){return new R(S(\"shared-calculator-error-sum-missing-bound\"))}function yP(){return new R(S(\"shared-calculator-error-product-missing-bound\"))}function gP(){return new R(S(\"shared-calculator-error-incorrect-sum-lower-bound\"))}function hP(){return new R(S(\"shared-calculator-error-incorrect-product-lower-bound\"))}function bP(e){return new R(S(\"shared-calculator-error-bad-sum-bound-dependency\",{symbol:j(e)}))}function xP(e){return new R(S(\"shared-calculator-error-bad-product-bound-dependency\",{symbol:j(e)}))}function PP(){return new R(S(\"shared-calculator-error-integral-missing-bound\"))}function TP(){return new R(S(\"shared-calculator-error-integral-missing-differential\"))}function IP(){return new R(S(\"shared-calculator-error-differential-with-superscript\"))}function EP(){return new R(S(\"shared-calculator-error-sum-missing-body\"))}function MP(){return new R(S(\"shared-calculator-error-product-missing-body\"))}function vP(){return new R(S(\"shared-calculator-error-integral-missing-body\"))}function DP(){return new R(S(\"shared-calculator-error-derivative-missing-body\"))}function SP(e,t){return e=j(e),t=j(t),new R(S(\"shared-calculator-error-mismatched-braces\",{symbol1:e,symbol2:t}))}function Mm(e){return new R(S(\"shared-calculator-error-shadowed-integration-variable\",{symbol:j(e)}))}function OP(e){return new R(S(\"shared-calculator-error-bad-integral-bound-dependency\",{symbol:j(e)}))}function RP(){return new R(S(\"shared-calculator-error-percent-missing-of\"))}function Qp(e){return e=j(e),new R(S(\"shared-calculator-error-illegal-bin-width\",{symbol:e}))}function fl(e){return e=j(e),new R(S(\"shared-calculator-error-ttest-list-too-short\",{symbol:e}))}function CP(){return new R(S(\"shared-calculator-error-bad-sample-size\"))}function NP(e){return new R(S(\"shared-calculator-error-variable-seed\",{symbol:j(e[0].symbol)})).setDependencies(e.filter(t=>t.scope===\"free\").map(t=>t.symbol)).allowExport()}function Kp(e){return new R(S(\"shared-calculator-error-bad-symbol-context\",{symbol:j(e)}))}function vm(){return new R(S(\"shared-calculator-error-write-integral\",{command:\"integral\",symbol:\"\\u222B\"}))}function AP(){return new R(S(\"shared-calculator-error-ans-undefined\"))}function ef(e){return new R(S(\"shared-calculator-error-variables-unsupported\",{variable:j(e)}))}function Dm(){return new R(S(\"shared-calculator-error-polygon-unsupported-in-3d\"))}function gs(e,t=!1){return t&&e===\"polygon\"?Dm():new R(S(\"shared-calculator-error-function-unsupported\",{symbol:j(e)}))}function _P(){return new R(S(\"shared-calculator-error-logbase-unsupported\"))}function ic(e){return new R(S(\"shared-calculator-error-constant-unsupported\",{symbol:j(e)}))}function Sm(e){return new R(S(\"shared-calculator-error-variable-unsupported\",{symbol:j(e)}))}function LP(e){return new R(S(\"shared-calculator-error-variable-invalid-function-name\",{symbol:j(e)}))}function tf(){return new R(S(\"shared-calculator-error-assignments-unsupported\"))}function rf(){return new R(S(\"shared-calculator-error-function-definition-unsupported\"))}function ga(){return new R(S(\"shared-calculator-error-equations-unsupported\"))}function sc(){return new R(S(\"shared-calculator-error-inequalities-unsupported\"))}function oc(){return new R(S(\"shared-calculator-error-regressions-unsupported\"))}function ac(){return new R(S(\"shared-calculator-error-points-unsupported\"))}function nf(){return new R(S(\"shared-calculator-error-feature-unavailable\"))}function Om(){return new R(S(\"basic-calculator-error-fractions-unavailable\"))}function U_(){return new R(S(\"shared-calculator-error-non-square-determinant\"))}function q_(){return new R(S(\"shared-calculator-error-non-square-trace\"))}function $_(){return new R(S(\"shared-calculator-error-non-square-inverse\"))}function Y_(){return new R(S(\"shared-calculator-error-non-singular-inverse\"))}function X_(e){return new R(S(\"shared-calculator-error-clickable-object-assignment-not-defined\",{symbol:e}))}function Z_(e){return new R(S(\"shared-calculator-error-multiply-defined\",{dependency:e}))}function W_(){return new R(S(\"shared-calculator-error-clickable-object-assignment-not-identifier\"))}function j_(){return new R(S(\"shared-calculator-error-clickable-object-invalid-expression\"))}function J_(){return new R(S(\"shared-calculator-error-matrix-assignment\"))}function Q_(){return new R(S(\"shared-calculator-error-matrix-add-dimensions\"))}function K_(){return new R(S(\"shared-calculator-error-matrix-subtract-dimensions\"))}function eL(){return new R(S(\"shared-calculator-error-matrix-multiply-dimensions\"))}function tL(){return new R(S(\"shared-calculator-error-matrix-fractional-power\"))}function rL(){return new R(S(\"shared-calculator-error-matrix-power-dimensions\"))}function nL(e){return new R(S(\"shared-calculator-error-matrix-element-type-error\",{arg:e[0]}))}function iL(e){return new R(S(\"shared-calculator-error-matrix-invalid-variable\",{symbol:j(e)}))}function wP(e,t,r){let n=\"[1...10]\";return r&&!/[\\\\]/.test(r)&&(n=`[${r}]`),new R(S(\"shared-calculator-error-list-comprehension-input-type-error\",{identifier:e,actual:t,example:n})).allowExport()}function FP(){return new R(S(\"shared-calculator-error-incorrect-list-comprehension-input\"))}function Rm(e){return e=j(e),new R(S(\"shared-calculator-error-shadowed-list-comprehension-input\",{symbol:e}))}function VP(e){return e=j(e),new R(S(\"shared-calculator-error-bad-for-input-list-dependency\",{symbol:e}))}function BP(e){return e=j(e),new R(S(\"shared-calculator-error-bad-for-interval-dependency\",{symbol:e}))}function GP(e){let t=e.filter(r=>r.scope===\"free\").map(r=>r.symbol);return new R(S(\"shared-calculator-error-variable-length-top-level-list\",{symbol:j(t[0]||\"\")})).setDependencies(t).allowExport()}function sf(e){return new R(S(\"shared-calculator-error-variable-length-distribution-list\",{symbol:e[0].symbol})).setDependencies(e.filter(t=>t.scope===\"free\").map(t=>t.symbol))}function zP(e){return new R(S(\"shared-calculator-error-variable-length-sum-body-depends-on-index\",{symbol:e}))}function kP(e){return new R(S(\"shared-calculator-error-variable-length-product-body-depends-on-index\",{symbol:e}))}function sL(e,t){return new R(S(\"shared-calculator-error-substitution-type-error\",{actual:ne(e),expected:ne(t)}))}function of(){return new R(S(\"shared-calculator-error-substitution-invalid-assignments\"))}function af(e){return new R(S(\"shared-calculator-error-substitution-local-lhs\",{symbol:j(e)}))}function dl(e){return new R(S(\"shared-calculator-error-substitution-illegal-lhs\",{symbol:j(e)}))}function ml(e){return new R(S(\"shared-calculator-error-substitution-function-lhs\",{symbol:j(e)}))}function HP(e,t,r){return new R(S(\"shared-calculator-error-substitution-body-regression-parameter-dependency\",{globalVariable:j(e),regressionParameter:j(t),operator:r}))}function oL(){return new R(S(\"shared-calculator-error-substitution-body-action\"))}function Cm(){return new R(S(\"shared-calculator-error-substitution-nested\"))}function Wa(e){return new R(S(\"shared-calculator-error-substitution-ambiguous-comma\",{operation:e}))}function UP(e){return new R(S(\"shared-calculator-error-substitution-duplicate-assignment\",{symbol:j(e)}))}function qP(){return new R(S(\"shared-calculator-error-depends-on-deleted-geo-object\"))}function $P(e){return new R(S(\"shared-calculator-error-invalid-interval-comprehension-return-type\",{type:ne(e)}))}function YP(e,t){return new R(S(\"shared-calculator-error-bad-interval-comprehension-arity\",{type:ne(e),count:t}))}function yl(e){return new R(S(\"shared-calculator-error-invalid-interval-comprehension-invalid-bound\",{identifier:e}))}function XP(){return new R(S(\"shared-calculator-error-nested-interval-comprehension\"))}function Nm(){return new R(S(\"shared-calculator-error-substitution-unsupported-interval\"))}function aL(e,t){let r=_n[e[0]].direction===-1?new Tn([t[1],t[0]]):new Tn([t[0],t[1]]);switch(e.length){case 0:throw new Error(\"Programming Error: ComparatorChain must have at least one comparator\");case 1:return r;case 2:return new dn([new Ti[e[1]](t.slice(1)),r,new jt(NaN)]);default:return new dn([new ja(e.slice(1),t.slice(1)),r,new jt(NaN)])}}var ja=class extends Q{constructor(r,n){super(n);this.symbols=r;if(r.length<1)throw\"Programming Error: ComparatorChain must have at least one comparator.\";if(n.length!==r.length+1)throw\"Programming Error: ComparatorChain must have one more arg than symbols\";if(r.includes(\"=\")&&!r.every(i=>i===\"=\"))throw ib();this._difference=aL(r,n)}isInequality(){return!this.symbols.includes(\"=\")}};var Am=class extends zt{constructor(t){super();let[r,n,i,s,o]=t;this.args=t,this._symbol=i._symbol,this._operators=[n,s],this._expressions=[r,o];var a=Ku(_n[n].inclusive&&_n[t[3]].inclusive,_n[t[1]].direction);this._indicator=new Ti[a]([t[0],t[4]]),this.addDependency(this._symbol),this.mergeDependencies(this._expressions[0],this._expressions[1])}isInequality(){return!0}isShadeBetween(){return!0}};var Ja=class extends Q{constructor(t){super(t,{skipRegisterDependencies:!0}),this._index=t[0],this.registerDependencies()}registerDependencies(){for(let t=1;t<=3;t++)this.mergeDependenciesInScope(this.type,[this._index._symbol],this.args[t])}};var gl=class extends Ja{constructor(){super(...arguments);this.in_place_operator=\"+=\";this.starting_value=0}evaluateConstant(r){var n=1+Math.round(r[1])-Math.round(r[0]);return n<=0?this.starting_value:n*r[2]}update(r,n){return r+n}};var hl=class extends Ja{constructor(){super(...arguments);this.in_place_operator=\"*=\";this.starting_value=1}evaluateConstant(r){var n=1+Math.round(r[1])-Math.round(r[0]);return n<=0?this.starting_value:Math.pow(r[2],n)}update(r,n){return r*n}};var bl=class extends Q{constructor(t){super(t,{skipRegisterDependencies:!0}),this._differential=t[0],this.registerDependencies()}registerDependencies(){for(let t=1;t<=3;t++)this.mergeDependenciesInScope(this.type,[this._differential._symbol],this.args[t])}};var Qa=class extends Q{constructor(t){super(t),this._symbol=t[0]._symbol,this._lhs=t[0],this._rhs=t[1]}};var ha=class extends Q{constructor(r,n,i,s,o=[]){super([r,n].concat(i),{skipRegisterDependencies:!0});this.shouldCoerceToList=s;this.parameters=o;this._index=r,this._body=n,this._inputLists=i,this.registerDependencies()}registerDependencies(){var r=[];r.push(this._index._symbol);for(let n of this._inputLists){let i=n._symbol;this.addSubstitutionSymbol(i),r.push(i)}for(let n of this.parameters){let i=n.identifier._symbol;r.push(i),this.addDependency(i)}for(let n of this._inputLists)this.mergeDependenciesInScope(this.type,r,n.args[1]);for(let n of this.parameters)this.mergeDependenciesInScope(this.type,r,n.bounds[0]),this.mergeDependenciesInScope(this.type,r,n.bounds[1]);this.mergeDependenciesInScope(this.type,r,this._body)}};var Bi=class extends Q{constructor(r,n,i){super(i);this.recursiveParameter=n;this._symbol=r}};var uc=class extends lr{constructor(t,r){super(t,r),this.seed=r[0]}};var xl=class extends Q{registerDependencies(){if(super.registerDependencies(),this.args[0].type===\"Identifier\"){var t=this.args[0]._symbol;$a(t)&&this.addDependency(\"trigAngleMultiplier\")}}};var Pl=class extends Q{registerDependencies(){if(this.addDependency(\"factorial\"),super.registerDependencies(),this.args[0].type===\"Identifier\"){var t=this.args[0]._symbol;$a(t)&&this.addDependency(\"trigAngleMultiplier\")}}};var cc=class extends Q{constructor(t,r){super(r),this.order=t}};var Tl=class extends Q{};var lc=class extends Q{constructor(t,r){super(r),t instanceof Fe?this._symbol=t._symbol:this._symbol=new Fe(t)._symbol,this.addDependency(this._symbol)}};var Il=class extends Q{constructor(t){super(t,{skipRegisterDependencies:!0}),this._symbol=t[0]._symbol,this._expression=t[1],this.registerDependencies()}registerDependencies(){this.addUpdateSymbol(this._symbol),this.mergeDependencies(this._expression)}};var Uo=class extends Q{constructor(t,r){super([t].concat(r),{skipRegisterDependencies:!0}),this._body=t,this._assignments=r,this.registerDependencies()}registerDependencies(){for(var t=[],r=0;r<this._assignments.length;r++){var n=this._assignments[r],i=n._symbol;this.addSubstitutionSymbol(i),t.push(i);var s=n.args[1];this.mergeDependencies(s),this.addSubstitutionDependencies(s.getDependencies())}this.mergeDependenciesInScope(this.type,t,this._body)}};var El=class extends Q{constructor(t){super(t),this._symbol=\"histogram\"}};var Ml=class extends Q{constructor(t){super(t),this._symbol=\"dotplot\"}};var vl=class extends Q{constructor(t){super(t),this._symbol=\"boxplot\"}};var Dl=class extends Q{constructor(t){super(t),this._symbol=\"ttest\"}};var Sl=class extends Q{constructor(t){super(t),this._symbol=\"ittest\"}};var Ol=class extends Q{constructor(t){super(t),this._symbol=\"stats\"}};var Vs=class extends zt{constructor(t,r){super(),this.mergeDependencies(t,r),this._lhs=t,this._rhs=r,this._difference=new Tn([this._lhs,this._rhs])}asComparator(){return new Ti[\"=\"]([this._lhs,this._rhs])}};var lo=class extends zt{constructor(t,r){super(),t instanceof Fe?this._symbol=t._symbol:this._symbol=t,this.mergeDependencies(r),this._expression=r,this._exports=this.computeExports()}shouldExportAns(){return!0}computeExports(){for(var t=this._symbol,r=this.getDependencies(),n=0;n<r.length;n++)if(r[n]===t)return[];return[t]}isEquation(t,r){let n=this._symbol,i=n===\"x\"||n===\"y\",s=n===\"r\"||n===\"z\",o=n===\"rho\",a=r.getDependencies(),u=this.graphmodeDependencies(t,r);return o||s||i&&a.includes(\"z\")?u.includes(n):a.includes(n)}asEquation(){var t=new Vs(new Fe(this._symbol),this._expression);return t.userData=this.userData,t.metaData=this.metaData,t}shouldPromoteToSlider(t){if(!this._expression.isConstant||this._expression.is_mixed_number)return!1;let r=this._expression.asValue();return typeof r!=\"number\"||!isFinite(r)?!1:t.isValidSlider(this._symbol)}};var _m=class extends zt{constructor(t,r){super(),this._symbols=t.args.map(n=>n._symbol),this._expression=r,this._concatenatedSymbol=this._symbols.join(\"\"),this.mergeDependencies(r)}asEquation(){let t=new Vs(new ts(this._symbols.map(r=>new Fe(r))),this._expression);return t.userData=this.userData,t.metaData=this.metaData,t}};var In=class extends zt{constructor(r,n,i,s){super();this.recursionInfo=s;this.externalBaseCases=[];this.isFunction=!0;this._symbol=r._symbol,this._argSymbols=n.map(function(o){return o._symbol});for(let o of this._argSymbols)if(o===this._symbol)throw Nx(o);this._exports=[this._symbol],this._expression=i,this.mergeDependenciesInScope(this.type,[this._symbol].concat(this._argSymbols),this._expression,{functionDefinitionSymbol:this._symbol}),this.combinedDependencies=super.getDependencies()}getDependencies(){return this.combinedDependencies}setExternalBaseCases(r){this.externalBaseCases=[...r],this.combinedDependencies=[...super.getDependencies()];for(let n of r){let i=n.getRef();i&&this.combinedDependencies.push(i)}}getExternalBaseCases(){return this.externalBaseCases}getConcreteInvocationTree(r,n,i,s){if(i.length!==this._argSymbols.length)throw rs(s,this._argSymbols.length,i.length);for(var o=Object.create(n),a=0;a<this._argSymbols.length;a++)o[this._argSymbols[a]]=i[a];return this._expression.getConcreteTree(r,o)}getSliderVariables(r,n){var i=this._argSymbols;return super.getSliderVariables(r,n).filter(function(s){return i.indexOf(s)===-1})}asEquation(){var r=this._argSymbols.map(function(i){return new Fe(i)}),n=new Vs(new lr(new Fe(this._symbol),r),this._expression);return n.userData=this.userData,n.metaData=this.metaData,n}};var Lm=class extends zt{constructor(r,n){super();this.isRegression=!0;this._lhs=r,this.isLhsSimple=r instanceof Fe,this._logLhs=new lr(\"ln\",[r]),this._rhs=n,this._difference=new Tn([r,n]),this._logDifference=new Tn([new lr(\"ln\",[r]),new lr(\"ln\",[n])]),this.mergeDependencies(r,n)}exportTo(r,n,i){if(!n.isError){for(var s in n.parameters)n.parameters.hasOwnProperty(s)&&(r.assignmentForbidden(s)||(i[s]=i[s]?ll(s):n.parameters[s]));r.assignmentForbidden(n.residualVariable)||(i[n.residualVariable]=n.residuals)}}getSliderVariables(){return[]}};var wm=class extends zt{constructor(r,n){super();this.isImage=!0;this.center=r.center,this.radianAngle=r.radianAngle,this.width=r.width,this.height=r.height,this.opacity=r.opacity,this.moveStrategy=n,this.mergeDependencies(this.center,this.radianAngle,this.width,this.height,this.opacity)}};var Fm=class extends zt{constructor(t){super(),this.handler=t.handler,this.minStep=t.minStep,this.mergeDependencies(this.handler),this.mergeDependencies(this.minStep)}};var Vm=class extends lo{constructor(r,n){super(new Fe(r._symbol),r._expression);this.isSlider=!0;this.setInputSpan(r._inputSpan),this.sliderAssignment=r,this.sliderMin=n.sliderMin,this.sliderMax=n.sliderMax,this.sliderSoftMin=n.sliderSoftMin,this.sliderSoftMax=n.sliderSoftMax,this.sliderStep=n.sliderStep,this.sliderIsPlayingOnce=n.sliderIsPlayingOnce,this.sliderMin&&this.mergeDependencies(this.sliderMin),this.sliderMax&&this.mergeDependencies(this.sliderMax),this.sliderStep&&this.mergeDependencies(this.sliderStep)}shouldPromoteToSlider(r){return!1}asAssignment(){return new lo(this._symbol,this._expression)}};var pc=class extends Q{constructor(r){let n=new jt(r);super([n]);this.value=r;this._constantNode=n}asValue(){return this._constantNode.asValue()}asCompilerValue(){return this._constantNode.asCompilerValue()}};var Bm=class extends zt{constructor(r){super();this.exportPenalty=1;this.isTable=!0;this.columns=r,this.mergeDependencies.apply(this,r)}getExports(r){let n=[];for(var i=0;i<this.columns.length;i++)Array.prototype.push.apply(n,this.columns[i].getExports(r));return n}exportTo(r,n,i){for(var s=0;s<this.columns.length;s++){var o=this.columns[s].getExports(r);if(o.length){var a=o[0];r.assignmentForbidden(a)||i[a]||(n.isError?i[a]=n:this.columns[s].exportTo(r,n.columns[s],i))}}}getAllIds(){return this.columns.map(function(r){return r.header.userData.id})}};function uL(e){return e.isConstant?new jt(e.asCompilerValue()):new jt(NaN)}var fc=class extends zt{constructor(t,r){super(),this.header=t,this.values=r,this.isIndependent=!1,this.registerDependencies(),this._exports=this.computeExports()}registerDependencies(){this.mergeDependencies(this.header),this.mergeDependencies.apply(this,this.values)}computeExports(){return this.header instanceof Fe?[this.header._symbol]:[]}_exportSymbolsTo(t,r,n){if(t.length){var i=t[0];if(r.isError)n[i]=r;else try{n[i]=new ko(r.values.map(uL))}catch(s){if(s instanceof zt)n[i]=s;else throw s}}}exportTo(t,r,n){var i=this.getLegalExports(t);this._exportSymbolsTo(i,r,n)}exportToLocal(t,r,n){this._exportSymbolsTo(this.getExports(t),r,n)}};var Gm=class extends zt{constructor(t,r,n,i){super(),this._symbol=t,this._expression=r,this.otherVariableSolutionData=n,this.mergeDependencies(r),this.branchMultiplier=i}};var zm=class extends zt{constructor(t,r,n,i,s){super(),this.parameters=t,this.residuals=r,this.statistics=n,this.model=i,this.isModelValid=s.isModelValid,this.residualVariable=s.residualVariable,this.residualSuggestionId=s.residualSuggestionId,this.shouldSuggestLogMode=s.shouldSuggestLogMode,this.isLinear=s.isLinear,this.parameterWarning=s.parameterWarning,this._exports=[this.residualVariable];for(var o in t)t.hasOwnProperty(o)&&this._exports.push(o);this.mergeDependencies(i)}getCompiledFunction(){return this.model.getCompiledFunction.apply(this.model,arguments)}getCompiledDerivative(){return this.model.getCompiledDerivative.apply(this.model,arguments)}};var dc=class extends Q{constructor(r){typeof r!=\"string\"&&(r=\"\"+r);super([]);this.isString=!0;this._stringValue=r}asValue(){return this._stringValue}};var mc=class extends Q{constructor(t,r){super(r),this.seed=r[0],this.userSeed=r[1],this.tag=t}asValue(){return this.seed.asValue()+\"::\"+this.tag+this.userSeed.asValue()}};function Ka(e){return typeof e!=\"object\"||!e?!1:e.type===\"Action\"}function ur(e,t){let r=e.getInstruction(t);switch(r.type){case 1:return po(r.value);default:throw new Error(`Unexpected opcode ${r.type}.`)}}function po(e){if(Array.isArray(e))return e.map(po);switch(typeof e){case\"boolean\":case\"number\":case\"string\":return e;case\"object\":if(Ka(e)){let t={};for(let r in e.updateRules){let n=e.updateRules[r];t[r]={value:po(n.value),valueType:n.valueType}}return{type:\"Action\",updateRules:t}}else return Y(e);default:throw new Error(\"Unexpected value: \"+e)}}var eu=[Ee,Gt,T,C,V,Rt,Ce,Pr,Rr,Ke,qt,Be,Se,he,fe,be,_e,Me,Ge,Ae,Ue,pr],cL=new Set(eu);function fo(e){return cL.has(e)}function ri(e){switch(e){case T:return NaN;case C:return[NaN,NaN];case V:return[NaN,NaN,NaN];case Rt:case Ce:return[[NaN,NaN,NaN],[NaN,NaN,NaN]];case Pr:return[[NaN,NaN,NaN],[NaN,NaN,NaN],[NaN,NaN,NaN]];case Rr:return[[[NaN,NaN,NaN],[NaN,NaN,NaN],[NaN,NaN,NaN]],NaN];case qt:return[NaN,NaN,NaN];case Ke:return{type:\"Action\",updateRules:{}};case Se:case _e:case be:return[[NaN,NaN],[NaN,NaN]];case Me:return[[NaN,NaN],[NaN,NaN]];case he:return[[NaN,NaN],NaN];case fe:return[[NaN,NaN],[NaN,NaN],[NaN,NaN]];case Ee:case Gt:return!1;case Be:return[];case Ue:return[[NaN,NaN],[NaN,NaN],!1];case Ge:case Ae:return[[NaN,NaN],NaN,NaN,NaN];case pr:return[NaN,NaN];default:let t=e;throw new Error(`${t} does not have a NaN type.`)}}function lv(e,t){return Vo(ri(e),t)}function ve(e){return e.type<=4}function pv(e){return!ve(e)}function ni(e){switch(e.type){case 21:case 23:case 19:case 50:case 53:return!0;default:return!1}}function Un(e){switch(e.type){case 20:case 22:case 24:case 51:case 54:return!0;default:return!1}}function Ii(e,t){let r=[];for(let i=0;i<=e.instructionsLength();i++)r[i]=!1;let n=[t];for(;n.length;){let i=n.pop();r[i]=!0;for(let s=i;s>=0;s--){if(!r[s])continue;let o=e.getInstruction(s);if(!ve(o))for(let a of e.getDirectDependencies(o))a>s&&!r[a]&&n.push(a),r[a]=!0}}return r}function fv(e,t){let r=e.getReturnIndex(),n=new Array(r),i=new Array(r).fill(!1);for(let o=0;o<=r;o++){let a=e.getInstruction(o);ni(a)||Un(a)||a.type===48||a.type===47&&e.getInstruction(a.args[0]).type!==22||a.type===0||a.type===55?n[o]=2:n[o]=0}n[r]===0&&(n[r]=1,i[r]=!0);let s=0;for(let o=r;o>=0;o--){if(!t[o])continue;let a=e.getInstruction(o);if(a.type===54?s++:a.type===53&&s--,ve(a))continue;if(a.type===19||a.type===20||a.type===24||a.type===54||a.type===39||a.type===55)for(let c of a.args){let l=e.getInstruction(c);n[c]===0&&l.type===1&&l.valueType===T?(n[c]=1,i[c]=!0):(n[c]=2,i[c]=!1)}else{for(let c of a.args)switch(n[c]){case 0:n[c]=1,i[c]=!0;break;case 1:case 2:n[c]=2,i[c]=!1;break}s>0&&a.type===33&&(n[o]=2,i[o]=!1)}}return i}function fL(e,t){if(e.size!==t.size)return!1;for(let r of e)if(!t.has(r))return!1;return!0}var km=class{constructor(t,r,n){this.chunk=t;this.referenced=r;this.shouldInline=n;this.thunkSets=[];this.thunkStarts=[];this.thunkEnds=[];this._isThunkEnd=[];this.piecewiseReferencedCount=[];this.dependencyThunkNames=[];this.parentFunctionStart=[];let i=t.getReturnIndex();for(let a=0;a<=t.instructionsLength();a++)this.thunkSets[a]=new Set;let s=t.argNames.length,o;for(let a=s;a<=t.getReturnIndex();a++){let u=t.getInstruction(a);this.parentFunctionStart[a]=o,u.type===53?o=a:u.type===54&&(o=void 0)}this.markThunkSets(s,i,[i],\"always\"),this.markThunks(s,i)}isThunkBegin(t){return this.thunkStarts[t]===t}isThunkEnd(t){return!!this._isThunkEnd[t]}containingThunkName(t){return this.thunkStarts[t]}thunkEnd(t){return this.thunkEnds[t]}isEarlyReturningThunk(t){let r=this.parentFunctionStart[t];return this.isThunkBegin(t)&&r!==void 0}dependencyThunkNamesForPiecewiseBranch(t){return this.dependencyThunkNames[t]}wantToInlineThunk(t){let r=this.thunkSets[t];if(r!==\"always\"&&r.size===1){for(let n of r)if(this.piecewiseReferencedCount[n]!==1)return!1;return!0}return!1}printChunkWithThunkInfo(){for(let t=0;t<=this.chunk.getReturnIndex();t++){let r=this.thunkSets[t],n=r===\"always\"?\"always\":`{${[...r].sort().join(\",\")}}`;if(this.isThunkBegin(t)&&(n+=\" beginThunk\"),this.isThunkEnd(t))n+=\" endThunk\";else{let i=this.containingThunkName(t);i!==void 0&&(n+=` start:${i}`)}this.shouldInline[t]&&(n+=\"\t[inline]\"),this.chunk.comments[t]=n}return this.chunk.print(this.chunk.getReturnIndex())}markThunkSets(t,r,n,i){let{chunk:s,referenced:o,thunkSets:a,piecewiseReferencedCount:u}=this;for(let l of n)a[l]=\"always\";function c(l,p){let f=a[l];if(f!==\"always\"){if(p===\"always\"){a[l]=p;return}for(let m of p)f.add(m)}}for(let l=r;l>=t;l--){if(!o[l])continue;let p=s.getInstruction(l);if(ve(p))continue;let f=a[l];if(Un(p)){let m=p.args[0];this.markThunkSets(m+1,l-1,p.args.slice(1),f),l=m+1;continue}for(let m=0;m<p.args.length;m++){let g=p.args[m];if(g<t)c(g,i);else if(m>0&&p.type===33){let y=a[g];y!==\"always\"&&y.add(g);let d=u[g];u[g]=(d!=null?d:0)+1}else c(g,f)}}}markThunks(t,r){var a,u;let{chunk:n,thunkSets:i}=this,s,o;for(let c=t;c<=r;c=o){let l=n.getInstruction(c),p=dL(this.chunk,l),f,m;if(p){let g=c+1,y=p.innerEndIndex-1;this.markThunks(g,y),m=i[p.innerEndIndex],o=p.outerEndIndex+1,f=this.thunkDecision(s,c,this.referenced[p.innerEndIndex],l.type===21&&this.shouldInline[p.outerEndIndex],m)}else m=i[c],o=c+1,f=this.thunkDecision(s,c,this.referenced[c],this.shouldInline[c],m);if(s!==void 0&&f.shouldEndThunk&&(this.markEndThunk(c-1,s),s=void 0),f.shouldStartThunk&&m!==\"always\"){for(let g of m)(u=(a=this.dependencyThunkNames)[g])!=null||(a[g]=[]),this.dependencyThunkNames[g].push(c);s={start:c,set:m}}if(s!==void 0&&(this.thunkStarts[c]=s.start,p))for(let g=p.innerEndIndex;g<=p.outerEndIndex;g++)this.thunkStarts[g]=s.start}s!==void 0&&this.markEndThunk(r,s)}thunkDecision(t,r,n,i,s){let o=this.chunk.getInstruction(r);if(o.type===33&&(i=!1),i||!n)return{shouldEndThunk:!1,shouldStartThunk:!1};if(s===\"always\")return{shouldEndThunk:t!==void 0,shouldStartThunk:!1};let a=o.type===1||o.type===47,u=s.size>0&&!a,c=t!==void 0&&!fL(s,t.set);return{shouldEndThunk:c,shouldStartThunk:(c||t===void 0)&&u}}markEndThunk(t,r){let{referenced:n}=this;for(;t>=0&&!n[t];)t--;this._isThunkEnd[t]=!0,this.thunkEnds[r.start]=t}};function dL(e,t){if(ni(t)){let r=t.endIndex,n=e.getInstruction(r);if(n===void 0)return;if(Un(n))return{outerEndIndex:r+n.args.length-1,innerEndIndex:r}}}function ru(e,t){return uf(e,[t],0,e.instructionsLength()-1)}function uf(e,t,r,n){let i=[];for(let o=r;o<=n;o++)i[o]=!1;for(let o of t)i[o]=!0;let s=Math.min(...t);for(let o=0;o<=1;o++){let a=!1;for(let u=s+1;u<e.instructionsLength();u++){let c=e.getInstruction(u);if(ve(c)||i[u])continue;let l=!1;for(let p of e.getDirectDependencies(c))if(i[p]){l=!0;break}if(i[u]=l,l&&c.type===20&&!i[c.args[0]]){let p=c.args[0],f=c.args.length-1;for(let m=0;m<f;m++){let g=c.args[1+m],y=p+1+m;i[g]&&(i[y]=!0,a=!0)}}}if(!a)break}return i}function Hm(e){for(let t=0;t<e.argCoeffs.length;t++)if(Y(e.argCoeffs[0])!==0)return!1;return!0}var Um=Re(0,1),dv=Re(1,1);function qm(e){if(e.op===\"&&\")return{op:\"||\",values:e.values.map(qm)};if(e.op===\"||\")return{op:\"&&\",values:e.values.map(qm)};switch(e.condition){case\">0\":return{op:\"comparator\",value:ii._neg(e.value),condition:\">=0\"};case\">=0\":return{op:\"comparator\",value:ii._neg(e.value),condition:\">0\"};case\"=0\":return{op:\"comparator\",value:e.value,condition:\"!=0\"};case\"!=0\":return{op:\"comparator\",value:e.value,condition:\"=0\"}}}function ZP(e,t){let r=[];return e.op===\"&&\"?r.push(...e.values):r.push(e),t.op===\"&&\"?r.push(...t.values):r.push(t),{op:\"&&\",values:r}}var ii;(c=>{function e(l,p){if(!(l===void 0||p===void 0))return t(l,p)}c.add=e;function t(l,p){let f=[];for(let m=0;m<l.argCoeffs.length;m++)f.push(ps(l.argCoeffs[m],p.argCoeffs[m]));return{argCoeffs:f,constantCoeff:ps(l.constantCoeff,p.constantCoeff)}}c._add=t;function r(l,p){if(!(l===void 0||p===void 0))return n(l,p)}c.sub=r;function n(l,p){let f=[];for(let m=0;m<l.argCoeffs.length;m++)f.push(Ki(l.argCoeffs[m],p.argCoeffs[m]));return{argCoeffs:f,constantCoeff:Ki(l.constantCoeff,p.constantCoeff)}}c._sub=n;function i(l){if(l!==void 0)return s(l)}c.neg=i;function s(l){let p=[];for(let f=0;f<l.argCoeffs.length;f++)p.push(xi(l.argCoeffs[f]));return{argCoeffs:p,constantCoeff:xi(l.constantCoeff)}}c._neg=s;function o(l,p){if(l===void 0||p===void 0)return;let f=Hm(l),m=Hm(p);if(!f&&!m)return;m||([l,p]=[p,l]);let g=[];for(let y=0;y<l.argCoeffs.length;y++)g.push(fs(l.argCoeffs[y],p.constantCoeff));return{argCoeffs:g,constantCoeff:fs(l.constantCoeff,p.constantCoeff)}}c.mul=o;function a(l,p){if(l===void 0||p===void 0||!Hm(p))return;let m=[];for(let g=0;g<l.argCoeffs.length;g++)m.push(es(l.argCoeffs[g],p.constantCoeff));return{argCoeffs:m,constantCoeff:es(l.constantCoeff,p.constantCoeff)}}c.div=a;function u(l,p){if(!(l===void 0||p===void 0||!Hm(p)))return Y(p.constantCoeff)===0?{argCoeffs:new Array(l.argCoeffs.length).fill(Um),constantCoeff:dv}:Y(p.constantCoeff)===1?l:void 0}c.pow=u})(ii||(ii={}));var $m=class{constructor(t,r,n,i){this.chunk=t;this.coefficientTable=[];this.conditionTable=[];this.ZERO_COEFFS=new Array(r.length).fill(Um),this.mask=uf(t,r,n,i);for(let s=0;s<r.length;s++){let o=[];for(let a=0;a<r.length;a++)o.push(s===a?dv:Um);this.coefficientTable[r[s]]={argCoeffs:o,constantCoeff:Um}}}coeffs(t){let r=this.coefficientTable[t];if(r!==void 0)return r;let n,i=this.chunk.getInstruction(t);return i.type===1&&i.valueType===T?n={argCoeffs:this.ZERO_COEFFS,constantCoeff:i.value}:this.mask[t]?n=this._coeffs(t):n=void 0,this.coefficientTable[t]=n,n}_coeffs(t){let r=this.chunk.getInstruction(t);switch(r.type){case 8:{let[i,s]=r.args;return ii.add(this.coeffs(i),this.coeffs(s))}case 9:{let[i,s]=r.args;return ii.sub(this.coeffs(i),this.coeffs(s))}case 14:{let i=r.args[0];return ii.neg(this.coeffs(i))}case 10:{let[i,s]=r.args;return ii.mul(this.coeffs(i),this.coeffs(s))}case 11:{let[i,s]=r.args;return ii.div(this.coeffs(i),this.coeffs(s))}case 12:case 13:{let[i,s]=r.args;return ii.pow(this.coeffs(i),this.coeffs(s))}case 26:case 28:case 27:case 29:case 33:case 0:case 23:case 2:case 1:case 25:case 32:case 31:case 15:case 17:case 16:case 18:case 38:case 39:case 40:case 41:case 37:case 42:case 21:case 22:case 19:case 20:case 24:case 48:case 47:case 3:case 44:case 49:case 50:case 51:case 4:case 53:case 54:case 55:return;default:let n=r;throw new Error(`Unexpected opcode ${n.type}`)}}condition(t){let r=this.conditionTable[t];if(r!==void 0)return r;let n;return this.mask[t]?n=this._condition(t):n=void 0,this.conditionTable[t]=n,n}_condition(t){let r=this.chunk.getInstruction(t);switch(r.type){case 26:{let[i,s]=r.args,o=ii.sub(this.coeffs(s),this.coeffs(i));return o===void 0?void 0:{op:\"comparator\",value:o,condition:\">0\"}}case 28:{let[i,s]=r.args,o=ii.sub(this.coeffs(s),this.coeffs(i));return o===void 0?void 0:{op:\"comparator\",value:o,condition:\">=0\"}}case 27:{let[i,s]=r.args,o=ii.sub(this.coeffs(i),this.coeffs(s));return o===void 0?void 0:{op:\"comparator\",value:o,condition:\">0\"}}case 29:{let[i,s]=r.args,o=ii.sub(this.coeffs(i),this.coeffs(s));return o===void 0?void 0:{op:\"comparator\",value:o,condition:\">=0\"}}case 25:{let[i,s]=r.args,o=ii.sub(this.coeffs(i),this.coeffs(s));return o===void 0?void 0:{op:\"comparator\",value:o,condition:\"=0\"}}case 32:{let i=r.args.map(s=>this.condition(s));return i.some(s=>s===void 0)?void 0:{op:\"&&\",values:i}}case 31:{let i=r.args.map(s=>this.condition(s));return i.some(s=>s===void 0)?void 0:{op:\"||\",values:i}}case 8:case 9:case 14:case 10:case 11:case 12:case 13:case 33:case 0:case 23:case 2:case 1:case 15:case 17:case 16:case 18:case 38:case 39:case 40:case 41:case 37:case 42:case 21:case 22:case 19:case 20:case 24:case 48:case 47:case 3:case 44:case 49:case 50:case 51:case 4:case 53:case 54:case 55:return;default:let n=r;throw new Error(`Unexpected opcode ${n.type}`)}}};function mv(e,t,r,n){let i=e.getInstruction(r.args[0]);if(i.recursionGroup.length>1)return[];let s=i.endIndex,o=e.getInstruction(s),a=new $m(e,n,t,s),u=[];for(let l=1;l<o.args.length;l++)u[o.args[l]]={op:\"&&\",values:[]};for(let l=s-1;l>t;l--){let p=u[l];if(p===void 0)continue;let f=e.getInstruction(l);if(!ve(f))if(f.type===33){u[f.args[0]]=p;let m=a.condition(f.args[0]);m!==void 0&&(u[f.args[1]]=ZP(p,m),u[f.args[2]]=ZP(p,qm(m)))}else for(let m of f.args)u[m]=p}let c=[];e:for(let l=s-1;l>=t;l--){let p=e.getInstruction(l);if(p.type!==55)continue;let f=e.getInstruction(p.args[0]);if(l>f.endIndex)continue;let m=p.args.slice(1);if(m.length!==f.signature.argTypes.length)throw new Error(\"Programming error: Non-matching arg length\");let g=u[l];if(g!==void 0){if(g.op===\"&&\"&&g.values.length===0)throw new Error(\"Programming error: Recursive call unconditionally executed\");for(let y=0;y<m.length;y++){if(e.getInstruction(m[y]).valueType!==T)continue e;let d=a.coeffs(m[y]);if(d===void 0||!mL(d,y)||Y(d.argCoeffs[y])<-1)continue e}c[l]=g}}return c}function mL(e,t){for(let r=0;r<e.argCoeffs.length;r++)if(r!==t&&Y(e.argCoeffs[r])!==0)return!1;return!0}function yv(e,t){if(t.recursionGroup.length>1)return!1;let r=t.endIndex,n=e.getInstruction(r);if(n.type!==54)throw new Error(\"Programming Error: end of BeginFunction is not EndFunction\");let[i,...s]=n.args;if(s.length!==1)return!1;let o=e.getInstruction(i);if(o.type!==53)throw new Error(\"Programming Error: start of EndFunction is not BeginFunction\");let a=o.args[0],u={};u[s[0]]=!0;for(let c=r-1;c>=i;c--){let l=e.getInstruction(c);switch(l.type){case 55:if(l.args[0]!==a)throw new Error(\"recursionGroup.length == 1 contradicted\");if(!u[c])return!1;break;case 33:u[c]&&(u[l.args[1]]=!0,u[l.args[2]]=!0);break;default:break}}return!0}function _t(e){return`_${e}`}function cf(e){return`_${e}_thunk_computed`}function lf(e){return`_${e}_thunk_function`}var Rl=class{constructor(t,r){this.chunk=t;this.glsl=r;this.inlinedSource=[];this.inlinedThunks=[];this.isTailFunction=[];let n=t.getReturnIndex();this.referenced=Ii(t,n),this._shouldInline=fv(t,this.referenced),!this.glsl&&t.computeNeedsThunking()&&(this.thunks=new km(t,this.referenced,this._shouldInline));for(let i=0;i<=n;i++){let s=t.getInstruction(i);s.type===4&&(this.isTailFunction[i]=yv(t,s),s.recursionGroup=s.recursionGroup.filter(o=>this.referenced[o]))}}isThunkBegin(t){return!!this.thunks&&this.thunks.isThunkBegin(t)}isThunkEnd(t){return!!this.thunks&&this.thunks.isThunkEnd(t)}isEarlyReturningThunk(t){return!!this.thunks&&this.thunks.isEarlyReturningThunk(t)&&this.inlinedThunks[t]===void 0}thunkName(t){var r;return(r=this.thunks)==null?void 0:r.containingThunkName(t)}thunkEnd(t){return this.thunks.thunkEnd(t)}shouldInline(t){return this._shouldInline[t]}inlineSource(t,r){this.inlinedSource[t]=r}wantToInlineThunk(t){return!!this.thunks&&this.thunks.wantToInlineThunk(t)}inlineThunk(t,r){this.inlinedThunks[t]=r}referenceArg(t){let r=this.inlinedSource[t];return r!==void 0?r:_t(t)}referencePiecewiseBranch(t){var o;let r=this.referenceArg(t),n=(o=this.thunks)==null?void 0:o.dependencyThunkNamesForPiecewiseBranch(t);if(!n||n.length===0)return{expression:r,rawExpression:r,thunkDependencies:[]};let i=[],s=\"\";for(let a of n){let u=this.inlinedThunks[a];if(u!==void 0)s&&(s+=\",\"),s+=u;else{let c=cf(a),l=lf(a),p=`${c}||${l}()`;s&&(s+=\",\"),s+=`${p}`}i.push(a)}return{expression:\"(\"+s+\",\"+r+\")\",rawExpression:r,thunkDependencies:i}}enterFunction(t,r){let n=this.chunk.getInstruction(t.args[0]),i=[];for(let o=0;o<n.signature.argTypes.length;o++)i.push(r+o+1);let s=mv(this.chunk,r,t,i);this.recursiveFunctionInfo={begin:r,argBlockvars:i,reachConditions:s,returnType:t.valueType}}exitFunction(){this.recursiveFunctionInfo=void 0}};function hv(e,t,r){let n=\"\",i=(e.instructionsLength()-1).toString().length,s=0,o=!1,a=Ii(e,t);for(let u=0;u<e.instructionsLength();u++){let c=e.getInstruction(u),l=r.comments[u]||\"\";if(Un(c)&&(s-=1),!a[u]&&!r.printUnreferencedInstructions||c.type===0)o||(n+=`${gv(u,i)}: ${jP(2*s)}...\n`),o=!0;else{o=!1;let p=`${gv(u,i)}: ${jP(2*s)}${yc(e,u)}`;l&&(p+=\" \".repeat(Math.max(0,36-p.length)),p+=`\t# ${l}`),n+=p+`\n`}ni(c)&&(s+=1)}return n}function yc(e,t){let r=e.getInstruction(t);switch(r.type){case 0:return wn(r.type);case 2:return`${wn(r.type)} ${$t(r.valueType)} ${e.argNames[t]}`;case 3:return`${wn(r.type)} ${$t(r.valueType)}`;case 1:return`${wn(r.type)} ${$t(r.valueType)} ${WP(r.value)}`;case 37:case 42:return`${wn(r.type)} ${$t(r.valueType)} ${r.symbol} ${r.args.join(\" \")}`;case 44:return`${wn(r.type)} ${$t(r.valueType)} ${r.tag} ${r.args.join(\" \")}`;case 48:return`${wn(r.type)} ${$t(r.valueType)} ${r.args.join(\" \")}`;case 17:case 18:return`${wn(r.type)} ${$t(r.valueType)} (${r.index}) ${r.args.join(\" \")}`;case 50:return`${wn(r.type)} ${$t(r.valueType)} ${r.args.join(\" \")} (${r.callData.parameterSymbols.join(\",\")})`;case 4:{let{parameterSymbols:i,argTypes:s}=r.signature,o=i.map((a,u)=>`${a}:${$t(s[u])}`).join(\", \");return`${wn(r.type)} ${$t(r.valueType)} ${r.symbol}(${o})`}case 8:case 9:case 10:case 11:case 13:case 12:case 14:case 15:case 16:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 32:case 31:case 33:case 38:case 39:case 40:case 41:case 47:case 49:case 51:case 53:case 54:case 55:return`${wn(r.type)} ${$t(r.valueType)} ${r.args.join(\" \")}`;default:let n=r;throw new Error(`Unexpected opcode ${n.type}`)}}function wn(e){switch(e){case 0:return\"Noop\";case 1:return\"Constant\";case 8:return\"Add\";case 9:return\"Subtract\";case 10:return\"Multiply\";case 11:return\"Divide\";case 12:return\"Exponent\";case 13:return\"RawExponent\";case 14:return\"Negative\";case 15:return\"OrderedPair\";case 17:return\"OrderedPairAccess\";case 16:return\"OrderedTriple\";case 18:return\"OrderedTripleAccess\";case 19:return\"BeginLoop\";case 20:return\"EndLoop\";case 21:return\"BeginIntegral\";case 22:return\"EndIntegral\";case 23:return\"BeginBroadcast\";case 24:return\"EndBroadcast\";case 25:return\"Equal\";case 26:return\"Less\";case 27:return\"Greater\";case 28:return\"LessEqual\";case 29:return\"GreaterEqual\";case 31:return\"Or\";case 32:return\"And\";case 33:return\"Piecewise\";case 38:return\"List\";case 39:return\"ListAccess\";case 40:return\"DeferredListAccess\";case 41:return\"InboundsListAccess\";case 37:return\"NativeFunction\";case 42:return\"Distribution\";case 2:return\"LoadArg\";case 47:return\"BlockVar\";case 48:return\"BroadcastResult\";case 3:return\"SymbolicVar\";case 44:return\"ExtendSeed\";case 49:return\"Action\";case 50:return\"BeginMap\";case 51:return\"EndMap\";case 4:return\"FunctionHeader\";case 53:return\"BeginFunction\";case 54:return\"EndFunction\";case 55:return\"FunctionCall\";default:let t=e;throw new Error(`Unexpected opcode ${t.type}`)}}function WP(e){if(Array.isArray(e))return`[${e.map(WP).join(\",\")}]`;switch(typeof e){case\"string\":return e;case\"boolean\":case\"number\":return e.toString();case\"object\":if(Ka(e)){let t=[];for(let r in e.updateRules)t.push(`\"${r}\": ${WP(e.updateRules[r].value)}`);return`{${t.join(\", \")}}`}else return`${e.n}/${e.d}`;default:throw new Error(\"Unexpected value: \"+e)}}function gv(e,t){let r=e.toString();return jP(t-r.length)+r}function jP(e){let t=\"\";for(let r=0;r<e;r++)t+=\" \";return t}function xv(e,t,r,n){let i=t.reachConditions[r];if(i!==void 0)return Pv(e,t,n,i)}function Pv(e,t,r,n){let i=t.argBlockvars;if(n.op===\"||\"||n.op===\"&&\"){let s=[];for(let o of n.values){let a=Pv(e,t,r,o);if(a===void 0)return;s.push(a)}return s.length===0?n.op===\"&&\"?\"true\":\"false\":`(${s.join(n.op)})`}switch(n.condition){case\">0\":case\">=0\":{let o=`(${bv(e,n.value,i)}${n.condition})`,a=JP(e,n.value,i,r);return`(${o}&&${a})`}case\"!=0\":{let s=bv(e,n.value,i),o=`(${s}>0)`,a=JP(e,n.value,i,r),u=`(${s}<0)`,c=JP(e,ii._neg(n.value),i,r);return`((${o}&&${a})||(${u}&&${c}))`}case\"=0\":return}}function JP(e,t,r,n){let i=[];for(let s=0;s<r.length;s++){let o=Y(t.argCoeffs[s]),a=e.referenceArg(r[s]),u=e.referenceArg(n[s]);o>0?i.push(`${u}>=${a}`):o<0&&i.push(`${u}<=${a}`)}return i.length===0?!0:`(${i.join(\"&&\")})`}function bv(e,t,r){let n=\"\";for(let i=0;i<r.length;i++){let s=e.printValue(t.argCoeffs[i],T),o=e.referenceArg(r[i]);n+=`${s}*${o}+`}return n+=e.printValue(t.constantCoeff,T),`(${n})`}var er;(n=>(n.Noop=0,n.Inline=1,n.Block=2))(er||(er={}));function pf(e){switch(e.type){case er.Noop:return\"\";case er.Inline:return e.source+`;\n`;case er.Block:return e.source}}function Tv(e,t,r){if(e.enterFunction(t,r),e.glsl)throw ee(\"GLSL function not implemented\");let{chunk:n,referenced:i}=e,s=t.args[0],o=n.getInstruction(s),a=o.signature.parameterSymbols,u=\"\";for(let c=0;c<a.length;c++){let l=r+c+1;i[l]&&(u+=`${_t(l)}=${a[c]};\n`)}return e.isTailFunction[s]?{type:er.Noop,nextIdx:o.endIndex+1}:{type:er.Block,source:yL(e,t,r,u),nextIdx:r+1}}function yL(e,t,r,n){let{chunk:i}=e,s=t.args[0],o=i.getInstruction(s),a=o.recursionGroup.indexOf(s),u=o.signature.parameterSymbols,c=u.join(\",\"),l=`{ fn: ${a}, args: [${c}]}`,p=`${_t(r)}_inner`,f=`${_t(r)}_cache`,m=`${_t(r)}_key`,g=`${_t(r)}_computationMetrics`;return`\n    const ${m}=${u.length===1&&o.signature.argTypes[0]===T?\"({fn, args}) => `${fn}:${args[0]}`\":\"({fn, args}) => `${fn}:${JSON.stringify(args)}`\"};\n\n    const ${p}=((${f}, ${c}) => {\n      ${df(e,r+1,o.endIndex-1)}\n      const ${g} = {depth: 0, count: 0};\n      const cache = ${f};\n      const key = ${m}(${l});\n      ${n}\n    `}function Iv(e,t,r){let n=r+1,i=t.args[0],o=e.chunk.getInstruction(i).args[0];if(e.isTailFunction[o])throw ee(\"Unexpected tail recursive function\");let a=gL(e,t,r),{referenced:u}=e;return u[r]&&(a+=`${_t(r)}=${e.referenceArg(t.args[0])};\n`),e.exitFunction(),{type:er.Block,source:a,nextIdx:n}}function gL(e,t,r){let n=`${_t(r)}_out`,i=t.args[0],s=e.chunk.getInstruction(i),o=`${_t(i)}_computationMetrics`,a=s.valueType;return`\n${o}.count++;\n${o}.depth++;\nlet ${n};\nif ((${o}.depth > BuiltIn.RECURSIVE_DEPTH_LIMIT) || (${o}.count > BuiltIn.RECURSIVE_COMPUTATION_LIMIT)) {\n  ${n}=BuiltIn.handleRecursiveDepthError(__meta, ${a}, ErrorMsg.recursiveDepthExceeded());\n} else {\n  ${n}=${e.referenceArg(t.args[1])};\n}\ncache.set(key, [${n},${o}]);\n});\n`}function Ev(e,t,r){let n=r+1,{chunk:i}=e,s=t.args[0],o=i.getInstruction(s),u=i.getInstruction(o.endIndex).args[0],c=`${_t(u)}_key`,l=t.args.slice(1).map(h=>e.referenceArg(h)),p=`${_t(r)}_args`,f=_t(r),m=`${f}_computationMetrics`,g=`${f}_cacheEntry`,y=i.getInstruction(u),d=i.getInstruction(y.args[0]);if(t.isRecursiveCall){let h=e.recursiveFunctionInfo;if(!h)throw ee(\"Expected recursive function info\");let b=\"\",x=xv(e,h,r,t.args.slice(1));if(e.isTailFunction[s]){let D=y.valueType;x&&(b=`\nif (${x}) {\n            return BuiltIn.handleRecursiveDepthError(__meta, ${D}, ErrorMsg.recursionDoesNotTerminate());;\n          }`);let O=d.signature.parameterSymbols,N=b+`\n`;N+=\"looping=true\";for(let A=0;A<O.length;A++){let L=u+A+1,$=`${_t(L)}_next`;N+=`,\n${$}=${l[A]}`}return b?{type:er.Block,source:N+`;\n`,nextIdx:n}:{type:er.Inline,source:N,nextIdx:n}}x&&(b=`\nif (${x}) {\n          return BuiltIn.SYMBOL_DIVERGES;\n        }`);let P=`${_t(h.begin)}_computationMetrics`,M=`{ fn: ${d.recursionGroup.indexOf(s)}, args: ${p} }`,I=`\n      const ${p} = ([${l.join(\",\")}]);\n      ${b}\n      const ${g} = cache.get(${c}(${M}));\n      if (${g} === undefined) {\n        return { stackFrame: ${M} };\n      }\n      ${f} = ${g}[0];\n      const ${m} = ${g}[1];\n      if (${m}.count > ${P}.count) {\n        ${P}.count = ${m}.count;\n      }\n      if (${m}.depth > ${P}.depth) {\n        ${P}.depth = ${m}.depth;\n      }\n    `;return{type:er.Block,source:I,nextIdx:n}}else{let h=d.recursionGroup.indexOf(s),b=[];for(let E of d.recursionGroup){let{endIndex:M}=i.getInstruction(E),D=i.getInstruction(M).args[0],O=`${_t(D)}_inner`;b.push(O)}if(e.isTailFunction[s])return hL(e,t,r);let x=`{ fn: ${h}, args: [${l.join(\",\")}] }`,P=`${f}=BuiltIn.executeRecursiveFunction(\n      __meta,\n      [${b.join(\", \")}],\n      ${y.valueType},\n      ${x},\n      ${c}(${x})\n    )`;return{type:er.Inline,source:P,nextIdx:n}}}function hL(e,t,r){let n=t.args[0],i=e.chunk.getInstruction(n),s=e.chunk.getInstruction(i.endIndex),o=s.args[0],a=e.chunk.getInstruction(o),u=a.valueType,c=\"\",l=\"\";if(e.isTailFunction[n])for(let y=1;y<t.args.length;y++){let d=o+y;if(!e.referenced[d])continue;let h=_t(d),b=`${h}_next`;c+=`let ${b};${h}=${e.referenceArg(t.args[y])};\n`,l+=`${h}=${b};\n`}else throw ee(\"Expected tail recursive function\");let p=_t(r),f=`${_t(r)}_computationMetrics`;e.enterFunction(a,o);let m=\"\";for(let y=o+1;y<i.endIndex;){if(!e.referenced[y]){y=y+1;continue}let d=e.chunk.getInstruction(y),h=ff(e,d,y);m+=pf(h),y=h.nextIdx}e.exitFunction();let g=`${p}=(() => {\n    ${df(e,o+1,i.endIndex-1)}\n\n    const ${f} = {depth: 0, count: 0};\n\n    let looping = true;\n    ${c}\n    while (looping) {\n      looping = false;\n\n      ${m}\n\n      ${f}.count++;\n      ${f}.depth++;\n      if ((${f}.depth > BuiltIn.RECURSIVE_DEPTH_LIMIT) || (${f}.count > BuiltIn.RECURSIVE_COMPUTATION_LIMIT)) {\n        return BuiltIn.handleRecursiveDepthError(__meta, ${u}, ErrorMsg.recursiveDepthExceeded());\n      };\n\n      ${l}\n    }\n\n    return ${e.referenceArg(s.args[1])}\n  })()`;return{type:er.Inline,source:g,nextIdx:r+1}}function Ym(e){let{chunk:t}=e,r=df(e,t.argNames.length,t.instructionsLength()-1),n=0;for(;n<t.instructionsLength();){let i=t.getInstruction(n),s=ff(e,i,n);r+=pf(s),n=s.nextIdx}return r+=`return ${e.referenceArg(t.getReturnIndex())};`,r}function bL(e,t){let{chunk:r}=e,n=[],i=e.thunkName(t),s=e.thunkEnd(i),o=cf(i),a=lf(i),u=\"\",c=!1,l=!1;e.wantToInlineThunk(i)||(l=!0);let p=t;for(;p<=s;){let f=r.getInstruction(p),m=p===t?Mv(e,f,p):ff(e,f,p);switch(m.type){case er.Noop:break;case er.Inline:c&&(u+=`,\n`),u+=m.source,c=!0;break;case er.Block:c&&(u+=`;\n`),c=!1,u+=m.source,l=!0;break}n.push(u),p=m.nextIdx}if(u===\"\"&&(u=\"0\",l=!1),l){let f=`${o}=false;${a}=()=>{\n${o}=true;\n\n      ${u}${c?\";\":\"\"}\n    };\n`;return{type:er.Block,source:f,nextIdx:p}}else return e.inlineThunk(i,u),{type:er.Noop,nextIdx:p}}function ff(e,t,r){return e.isThunkBegin(r)?bL(e,r):Mv(e,t,r)}function Mv(e,t,r){let n=r+1;if(!e.referenced[r])return{type:er.Noop,nextIdx:n};switch(t.type){case 0:case 47:case 48:case 22:case 49:case 4:return{type:er.Noop,nextIdx:n};case 21:if(e.glsl)throw Ub();return PL(e,t,r);case 2:return e.inlineSource(r,e.chunk.argNames[r]),{type:er.Noop,nextIdx:n};case 23:return{type:er.Block,source:TL(e,t,r),nextIdx:n};case 24:return{type:er.Block,source:IL(e,t,r),nextIdx:n};case 19:return{type:er.Block,source:EL(e,t,r),nextIdx:n};case 20:return{type:er.Block,source:ML(e,t,r),nextIdx:n};case 50:return{type:er.Block,source:vL(e,t,r),nextIdx:n};case 51:return{type:er.Block,source:DL(e,t,r),nextIdx:n};case 53:return Tv(e,t,r);case 54:return Iv(e,t,r);case 33:{let i=e.referenceArg(t.args[0]),s=e.referencePiecewiseBranch(t.args[1]),o=e.referencePiecewiseBranch(t.args[2]);if(!(s.thunkDependencies.some(p=>e.isEarlyReturningThunk(p))||o.thunkDependencies.some(p=>e.isEarlyReturningThunk(p)))){let p=e.emitTernary(i,s.expression,o.expression,t);return e.shouldInline(r)?(e.inlineSource(r,`(${p})`),{type:er.Noop,nextIdx:n}):{type:er.Inline,source:`${_t(r)}=${p}`,nextIdx:n}}let u=_t(r),c=p=>{if(p.length===0)return\"\";let f=\"\";for(let m of p){let g=e.inlinedThunks[m];if(g!==void 0){let y=`(${g},void 0)`;f!==\"\"?f=`(${f}||${y})`:f=y}else{let y=cf(m),d=lf(m);f!==\"\"&&(f+=\"||\"),f+=`(${y} ? undefined : ${d}())`}}return f=\"const earlyReturn =\"+f,f+=`;\nif (earlyReturn !== undefined) return earlyReturn;\n`,f},l=`if (${i}) {\n          ${c(s.thunkDependencies)}${u} = ${s.rawExpression};\n        } else {\n          ${c(o.thunkDependencies)}${u} = ${o.rawExpression};\n        }`;return{type:er.Block,source:l,nextIdx:n}}case 55:return Ev(e,t,r);default:{let i=SL(e,t);return e.shouldInline(r)?(e.inlineSource(r,`(${i})`),{type:er.Noop,nextIdx:n}):{type:er.Inline,source:`${_t(r)}=${i}`,nextIdx:n}}}}function xL(e,t,r){let{endIndex:n}=t,{referenced:i,chunk:s}=e,o=`function(${_t(r)}) {\n`;for(r=r+1,o+=df(e,r,n-1);r<n;){if(!i[r]){r=r+1;continue}let u=s.getInstruction(r),c=ff(e,u,r);o+=pf(c),r=c.nextIdx}let a=s.getInstruction(n);return o+=`return ${e.referenceArg(a.args[1])};\n}`,o}function PL(e,t,r){let n=\"BuiltIn.quad(\";n+=xL(e,t,r),n+=`,${e.referenceArg(t.args[0])},${e.referenceArg(t.args[1])})`;let{endIndex:i}=t,s=i+1;return e.shouldInline(s)?(e.inlineSource(s,n),{type:er.Noop,nextIdx:t.endIndex}):{type:er.Inline,source:`${_t(i+1)}=${n}`,nextIdx:t.endIndex}}function df(e,t,r){let{chunk:n,referenced:i}=e,s=\"\",o=!1;for(let a=t;a<=r;a++){if(!e.glsl&&e.isThunkBegin(a)){let c=e.thunkName(a);s+=`${o?\",\":\"var \"}${cf(c)}`,s+=`,${lf(c)}`,o=!0}let u=n.getInstruction(a);if(!(u.type===0||u.type===24||u.type===20||!i[a])){if(u.type===21){let{endIndex:c}=u;a=c,e.shouldInline(c+1)&&a++;continue}if(!e.shouldInline(a)&&(s+=e.emitVarDeclaration(a,o),o=!0,u.type===53)){let{endIndex:c}=u;a=c-1;continue}}}return o&&(s+=`;\n`),s}function TL(e,t,r){let{glsl:n,chunk:i,referenced:s}=e,o=_t(r),a=i.getInstruction(t.endIndex),u=e.referenceArg(t.args[0]),c=\"\";for(let p=1;p<a.args.length;p++){let f=t.endIndex+p;if(!s[f]||i.getInstruction(f).type!==48)continue;let g=_t(f);n||(c+=`${g}=[];\n`)}return n||(c+=`if(${u}>${1e4}) throw ErrorMsg.maxListSize();\n`),c+=`for(${o}=1${n?\".0\":\"\"};${o}<=${u};${o}++){\n`,c}function IL(e,t,r){let{glsl:n,chunk:i,referenced:s}=e,o=\"\";for(let a=1;a<t.args.length;a++){let u=r+a;if(u>=i.instructionsLength()||!s[u]||i.getInstruction(u).type!==48)continue;let c=_t(r+a),l=e.referenceArg(t.args[a]);if(n){let p=e.referenceArg(t.args[0]);o+=`${c}[int(${p})-1]=${l};\n`}else o+=`${c}.push(${l});\n`}return o+=`}\n`,o}function EL(e,t,r){let{chunk:n,referenced:i}=e,s=_t(r);e.beforeBeginLoop(t);let o=`${e.referenceArg(t.args[0])}`,a=`${e.referenceArg(t.args[1])}`,u=`if(${o}>${a}){\n`;for(let c=2;c<t.args.length;c++){let l=t.endIndex+c-1;if(l>=n.instructionsLength()||!i[l]||n.getInstruction(l).type!==47)continue;let p=_t(l);u+=`${p}=${e.referenceArg(t.args[c])};\n`}u+=e.checkFiniteBounds(t,o,a),u+=`}else{\n`;for(let c=2;c<t.args.length;c++){let l=r+c-1;if(!i[l]||n.getInstruction(l).type!==47)continue;let p=_t(l);u+=`${p}=${e.referenceArg(t.args[c])};\n`}return u+=`${s}=${o};\n`,u+=\"while (true) {\",u}function ML(e,t,r){let{chunk:n,referenced:i}=e,s=n.getInstruction(t.args[0]),o=`${e.referenceArg(s.args[1])}`,a=_t(t.args[0]),u=`${a}++;`;u+=`if (${a}<=${o}) {\n`;let c={};for(let l=1;l<t.args.length;l++){let p=t.args[0]+l;if(!i[p]||n.getInstruction(p).type!==47)continue;let f=_t(p),m=e.referenceArg(t.args[l]);c[f]=m}for(let l in c){let p=c[l];c[p]&&(u+=`const _next_${l}=${p};\n`,c[l]=`_next_${l}`)}for(let l in c){let p=c[l];u+=`${l}=${p};\n`}u+=`} else {\n`;for(let l=1;l<t.args.length;l++){let p=r+l;if(p>=n.instructionsLength()||!i[p]||n.getInstruction(p).type!==47)continue;let f=_t(p);u+=`${f}=${e.referenceArg(t.args[l])};\n`}return u+=`break;\n`,u+=`}\n}\n`,u+=`}\n`,u}function vL(e,t,r){let{glsl:n}=e;if(n)throw ee(\"GLSL map not implemented yet\");let i=_t(t.endIndex+1),s=[];for(let a=0;a<t.callData.parameterSymbols.length;a++){let u=_t(r+a+1);s.push(u)}let o=s.join(\",\");return`${i}=(${o}) => {\n`}function DL(e,t,r){let n=`return ${e.referenceArg(t.args[1])}`;return n+=`}\n`,n}function SL(e,t){switch(t.type){case 1:return e.emitConstant(t);case 8:case 9:case 10:case 11:case 12:case 13:case 25:case 26:case 27:case 28:case 29:case 31:case 32:return e.emitBinary(t,e.referenceArg(t.args[0]),e.referenceArg(t.args[1]));case 14:{let n=e.referenceArg(t.args[0]);return e.emitNeg(n)}case 15:return e.emitVec2(e.referenceArg(t.args[0]),e.referenceArg(t.args[1]));case 16:return e.emitVec3(e.referenceArg(t.args[0]),e.referenceArg(t.args[1]),e.referenceArg(t.args[2]));case 17:case 18:return e.emitVecAccess(e.referenceArg(t.args[0]),t.index);case 38:return e.emitList(t.args.map(n=>e.referenceArg(n)),t);case 40:case 42:case 3:throw new Error(`Programming Error: expect ${wn(t.type)} to be removed before emitting code.`);case 39:{let n=t.valueType;return e.emitListAccess(e.referenceArg(t.args[0]),e.referenceArg(t.args[1]),e.printValue(ri(n),n),t)}case 41:return e.emitInboundsListAccess(e.referenceArg(t.args[0]),e.referenceArg(t.args[1]));case 37:return e.emitNativeFunction(t.args.map(n=>e.referenceArg(n)),t);case 44:return e.emitExtendSeed(e.referenceArg(t.args[0]),e.referenceArg(t.args[1]),t.tag);case 2:case 0:case 21:case 22:case 19:case 20:case 23:case 24:case 47:case 48:case 49:case 50:case 51:case 53:case 54:case 33:case 55:case 4:throw new Error(`Unexpected opcode ${t.type}`);default:let r=t;throw new Error(`Unexpected opcode ${r.type}`)}}function Xm(e){let t=new QP(e),r=Ym(t);return t.finish(r)}var QP=class extends Rl{constructor(r){super(r,!1);this.constants=[]}finish(r){return{source:r,constants:this.constants}}printValue(r){return vv(r)}beforeBeginLoop(){}checkFiniteBounds(r,n,i){let s=r.callData.type===\"recursive-function\",o=`}else if(!isFinite(${i}-${n})){\n`;for(let a=2;a<r.args.length;a++){let u=r.endIndex+a-1;if(u>=this.chunk.instructionsLength()||!this.referenced[u])continue;let c=this.chunk.getInstruction(u);if(c.type!==47)continue;let l=_t(u);fo(c.valueType)?(s&&(o+=\"__meta.recursiveDepthError = ErrorMsg.recursionDoesNotTerminate();\"),o+=`${l}=${this.printValue(ri(c.valueType))};\n`):s?o+=`throw ErrorMsg.recursionDoesNotTerminate();\n`:o+=`throw new Error('Cannot set ${l} of type ${$t(c.valueType)} to NaN value');\n`}return o}emitConstant(r){return r.valueType===T||r.valueType===Ee||r.valueType===C||r.valueType===V?this.printValue(r.value):(this.constants.push(po(r.value)),`_C[${this.constants.length-1}]`)}emitNeg(r){return`-${r}`}emitTernary(r,n,i){return`${r}?${n}:${i}`}emitVec2(r,n){return`[${r},${n}]`}emitVec3(r,n,i){return`[${r},${n},${i}]`}emitVecAccess(r,n){return`${r}[${n-1}]`}emitBinary(r,n,i){switch(r.type){case 8:return`${n}+${i}`;case 9:return`${n}-${i}`;case 10:return`${n}*${i}`;case 11:return`${n}/${i}`;case 12:return`BuiltIn.pow(${n},${i})`;case 13:return`Math.pow(${n},${i})`;case 25:return`${n}===${i}`;case 26:return`${n}<${i}`;case 28:return`${n}<=${i}`;case 27:return`${n}>${i}`;case 29:return`${n}>=${i}`;case 31:return`${n}||${i}`;case 32:return`${n}&&${i}`;default:throw new Error(\"Programming Error: invalid binary opcode.\")}}emitList(r){return`[${r.join(\",\")}]`}emitListAccess(r,n,i){let s=`${r}.length`,o=`Math.floor(${n})`;return`(${o}>=1&&${o}<=${s})?${r}[${o}-1]:${i}`}emitInboundsListAccess(r,n){return`${r}[${n}-1]`}emitNativeFunction(r,n){let i=gr[n.symbol];return`${i.module}.${i.symbol}(${r.join(\",\")})`}emitExtendSeed(r,n,i){return`${r}+'::${i}'+${n}`}emitVarDeclaration(r,n){let i=n?\",\":\"var \";return i+=_t(r),i}emitFunctionCall(r,n,i,s){return`${r}(${n}, ${i}, ${s.join(\",\")})`}};function vv(e){if(Array.isArray(e))return`[${e.map(vv).join(\",\")}]`;switch(typeof e){case\"boolean\":case\"number\":return e.toString();case\"string\":return`${JSON.stringify(e)}`;case\"object\":if(Ka(e))throw new Error(\"Action values cannot be compiled\");return Y(e).toString();default:throw new Error(\"Unexpected value: \"+e)}}var ho={};wo(ho,{LruCache:()=>Vl,RECURSIVE_COMPUTATION_LIMIT:()=>CD,RECURSIVE_DEPTH_LIMIT:()=>Rf,SYMBOL_DIVERGES:()=>RD,acosh:()=>vD,acot:()=>yw,acoth:()=>Ew,acsc:()=>gw,acsch:()=>Iw,addTangentAngle:()=>UF,addTangentArc:()=>HF,addTangentCircle:()=>kF,addTangentLine:()=>GF,addTangentRay:()=>zF,addTangentSegment:()=>$T,addTangentSegmentThreeD:()=>BF,angleMarkerMultiplier:()=>RF,angleMarkerRawDelta:()=>OF,arc:()=>DF,arcArcIntersection:()=>JF,arcCenter:()=>Ul,arcCircleIntersection:()=>jF,arcGlider:()=>o1,arcLineIntersection:()=>l1,arcOmega:()=>ql,argMax:()=>jw,argMin:()=>Ww,asec:()=>hw,asech:()=>Tw,asinh:()=>DD,atanh:()=>SD,basePointFromVector:()=>bF,basePointFromVectorThreeD:()=>TF,bernoulliTable:()=>_D,binomSample:()=>Fw,binomcdf:()=>Bw,binompdf:()=>Py,center:()=>MF,chooseNonIncidentPoint:()=>XF,circle:()=>EF,circleArcIntersection:()=>WF,circleCircleIntersection:()=>Sf,circleGlider:()=>$F,circleLineIntersection:()=>WT,clamp:()=>on,common_log:()=>lw,composeTransformation:()=>lV,corr:()=>Iy,cos:()=>hr,cosh:()=>ID,cot:()=>mw,cotDerivative:()=>LD,coth:()=>Pw,cov:()=>Qw,covp:()=>JD,csc:()=>dw,csch:()=>xw,dilation:()=>aV,directedAngleMarker:()=>i1,directedCoterminalAngle:()=>s1,distance:()=>zl,distanceThreeD:()=>rF,elementsAt:()=>TV,erf:()=>kw,erfcx:()=>Ia,executeRecursiveFunction:()=>ew,expm1:()=>JL,factorial:()=>Zo,frequency:()=>MV,gcd:()=>RT,getArcDetails:()=>Ey,getRecursiveDepthLimit:()=>KL,handleRecursiveDepthError:()=>ET,hsv:()=>nF,hypot:()=>go,identity:()=>IF,invBinom:()=>HD,invNorm:()=>wT,invPoisson:()=>kD,invT:()=>UD,invUniform:()=>Uw,invertTransformation:()=>pV,isDegenerateArc:()=>UT,itscore:()=>$D,ittest:()=>VT,lcm:()=>AD,line:()=>yF,lineArcIntersection:()=>c1,lineCircleIntersection:()=>ZT,lineGlider:()=>YT,lineLineIntersection:()=>u1,listGCD:()=>nw,listLCM:()=>iw,listLength:()=>qw,listMax:()=>XD,listMin:()=>YD,log:()=>cw,log1p:()=>Of,log_base:()=>FD,lowerQuantileIndex:()=>Yw,lowerQuartileIndex:()=>Zw,mad:()=>Jw,mathVector:()=>t1,mathVectorThreeD:()=>r1,md5Spyable:()=>TD,mean:()=>jo,median:()=>WD,mod:()=>ND,nCr:()=>uu,nPr:()=>ly,normalSample:()=>Lw,normalcdf:()=>Aw,normalpdf:()=>NT,nthroot:()=>pw,parallel:()=>tV,perpendicular:()=>rV,pointDet:()=>d1,pointDot:()=>nV,pointPerp:()=>iV,poissonSample:()=>Vw,poissoncdf:()=>Gw,poissonpdf:()=>Gl,polyGamma:()=>wD,polygon:()=>iF,polygonArea:()=>kT,polygonEdges:()=>cF,polygonGlider:()=>YF,polygonInteriorDirectedAngles:()=>mF,polygonInteriorUndirectedAngles:()=>dF,polygonPerimeter:()=>lF,pow:()=>OD,quad:()=>tF,quantile:()=>ZD,quartile:()=>Ic,quartileIndex:()=>Ty,radius:()=>vF,random:()=>AT,randomPerm:()=>_T,rank:()=>vT,ray:()=>gF,rayGlider:()=>DT,reflection:()=>cV,restriction:()=>SV,restrictionToBoolean:()=>OV,rgb:()=>QD,rotation:()=>uV,scaleTangentAngle:()=>VF,scaleTangentArc:()=>FF,scaleTangentCircle:()=>wF,scaleTangentLine:()=>_F,scaleTangentRay:()=>LF,scaleTangentSegment:()=>qT,sec:()=>fw,sech:()=>bw,segment:()=>HT,segmentGlider:()=>XT,segmentThreeD:()=>sF,segmentThreeDGlider:()=>qF,select:()=>PV,shuffle:()=>_w,sign:()=>OT,sin:()=>tr,sinh:()=>ED,sortPerm:()=>Ec,spearman:()=>Kw,sphere:()=>aF,sqrtxsqm1:()=>rw,sqrtxsqp1:()=>tw,stats:()=>BT,stdev:()=>py,stdevp:()=>eF,supplementAngle:()=>NF,tSample:()=>ww,tan:()=>BD,tanh:()=>MD,tcdf:()=>uy,testingOnlySetRecursiveDepthLimit:()=>CT,toFraction:()=>QL,tone:()=>EV,total:()=>vw,tpdf:()=>xy,transformAngleMarker:()=>xV,transformArc:()=>hV,transformCircle:()=>gV,transformLine:()=>dV,transformPoint:()=>Wo,transformPolygon:()=>bV,transformRay:()=>mV,transformSegment:()=>My,transformVector:()=>yV,transformation:()=>sV,translation:()=>oV,triangle:()=>oF,tscore:()=>qD,ttest:()=>FT,undirectedAngleMarker:()=>SF,undirectedCoterminalAngle:()=>CF,uniformSample:()=>cu,uniformcdf:()=>zw,uniformpdf:()=>LT,uniquePerm:()=>IV,upperQuantileIndex:()=>$w,upperQuartileIndex:()=>Xw,validateRangeLength:()=>GT,validateSampleCount:()=>zT,variance:()=>jD,varp:()=>Cf,vector:()=>e1,vectorDisplacementAsPoint:()=>hF,vectorThreeD:()=>xF,vectorThreeDDisplacementAsPoint:()=>PF,vertices:()=>uF,volume:()=>vV});var Dv=function(){\"use strict\";function e(y,d){var h=(y&65535)+(d&65535),b=(y>>16)+(d>>16)+(h>>16);return b<<16|h&65535}function t(y,d){return y<<d|y>>>32-d}function r(y,d,h,b,x,P){return e(t(e(e(d,y),e(b,P)),x),h)}function n(y,d,h,b,x,P,E){return r(d&h|~d&b,y,d,x,P,E)}function i(y,d,h,b,x,P,E){return r(d&b|h&~b,y,d,x,P,E)}function s(y,d,h,b,x,P,E){return r(d^h^b,y,d,x,P,E)}function o(y,d,h,b,x,P,E){return r(h^(d|~b),y,d,x,P,E)}function a(y,d){y[d>>5]|=128<<d%32,y[(d+64>>>9<<4)+14]=d;var h,b,x,P,E,M=1732584193,I=-271733879,D=-1732584194,O=271733878;for(h=0;h<y.length;h+=16)b=M,x=I,P=D,E=O,M=n(M,I,D,O,y[h],7,-680876936),O=n(O,M,I,D,y[h+1],12,-389564586),D=n(D,O,M,I,y[h+2],17,606105819),I=n(I,D,O,M,y[h+3],22,-1044525330),M=n(M,I,D,O,y[h+4],7,-176418897),O=n(O,M,I,D,y[h+5],12,1200080426),D=n(D,O,M,I,y[h+6],17,-1473231341),I=n(I,D,O,M,y[h+7],22,-45705983),M=n(M,I,D,O,y[h+8],7,1770035416),O=n(O,M,I,D,y[h+9],12,-1958414417),D=n(D,O,M,I,y[h+10],17,-42063),I=n(I,D,O,M,y[h+11],22,-1990404162),M=n(M,I,D,O,y[h+12],7,1804603682),O=n(O,M,I,D,y[h+13],12,-40341101),D=n(D,O,M,I,y[h+14],17,-1502002290),I=n(I,D,O,M,y[h+15],22,1236535329),M=i(M,I,D,O,y[h+1],5,-165796510),O=i(O,M,I,D,y[h+6],9,-1069501632),D=i(D,O,M,I,y[h+11],14,643717713),I=i(I,D,O,M,y[h],20,-373897302),M=i(M,I,D,O,y[h+5],5,-701558691),O=i(O,M,I,D,y[h+10],9,38016083),D=i(D,O,M,I,y[h+15],14,-660478335),I=i(I,D,O,M,y[h+4],20,-405537848),M=i(M,I,D,O,y[h+9],5,568446438),O=i(O,M,I,D,y[h+14],9,-1019803690),D=i(D,O,M,I,y[h+3],14,-187363961),I=i(I,D,O,M,y[h+8],20,1163531501),M=i(M,I,D,O,y[h+13],5,-1444681467),O=i(O,M,I,D,y[h+2],9,-51403784),D=i(D,O,M,I,y[h+7],14,1735328473),I=i(I,D,O,M,y[h+12],20,-1926607734),M=s(M,I,D,O,y[h+5],4,-378558),O=s(O,M,I,D,y[h+8],11,-2022574463),D=s(D,O,M,I,y[h+11],16,1839030562),I=s(I,D,O,M,y[h+14],23,-35309556),M=s(M,I,D,O,y[h+1],4,-1530992060),O=s(O,M,I,D,y[h+4],11,1272893353),D=s(D,O,M,I,y[h+7],16,-155497632),I=s(I,D,O,M,y[h+10],23,-1094730640),M=s(M,I,D,O,y[h+13],4,681279174),O=s(O,M,I,D,y[h],11,-358537222),D=s(D,O,M,I,y[h+3],16,-722521979),I=s(I,D,O,M,y[h+6],23,76029189),M=s(M,I,D,O,y[h+9],4,-640364487),O=s(O,M,I,D,y[h+12],11,-421815835),D=s(D,O,M,I,y[h+15],16,530742520),I=s(I,D,O,M,y[h+2],23,-995338651),M=o(M,I,D,O,y[h],6,-198630844),O=o(O,M,I,D,y[h+7],10,1126891415),D=o(D,O,M,I,y[h+14],15,-1416354905),I=o(I,D,O,M,y[h+5],21,-57434055),M=o(M,I,D,O,y[h+12],6,1700485571),O=o(O,M,I,D,y[h+3],10,-1894986606),D=o(D,O,M,I,y[h+10],15,-1051523),I=o(I,D,O,M,y[h+1],21,-2054922799),M=o(M,I,D,O,y[h+8],6,1873313359),O=o(O,M,I,D,y[h+15],10,-30611744),D=o(D,O,M,I,y[h+6],15,-1560198380),I=o(I,D,O,M,y[h+13],21,1309151649),M=o(M,I,D,O,y[h+4],6,-145523070),O=o(O,M,I,D,y[h+11],10,-1120210379),D=o(D,O,M,I,y[h+2],15,718787259),I=o(I,D,O,M,y[h+9],21,-343485551),M=e(M,b),I=e(I,x),D=e(D,P),O=e(O,E);return[M,I,D,O]}function u(y){var d,h=\"\",b=y.length*32;for(d=0;d<b;d+=8)h+=String.fromCharCode(y[d>>5]>>>d%32&255);return h}function c(y){var d,h=[];for(h[(y.length>>2)-1]=void 0,d=0;d<h.length;d+=1)h[d]=0;var b=y.length*8;for(d=0;d<b;d+=8)h[d>>5]|=(y.charCodeAt(d/8)&255)<<d%32;return h}function l(y){return u(a(c(y),y.length*8))}function p(y){var d=\"0123456789abcdef\",h=\"\",b,x;for(x=0;x<y.length;x+=1)b=y.charCodeAt(x),h+=d.charAt(b>>>4&15)+d.charAt(b&15);return h}function f(y){return unescape(encodeURIComponent(y))}function m(y){return l(f(y))}function g(y){return p(m(y))}return g}();function ba(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function nu(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function $o(){}var iu=.7,bc=1/iu,Cl=\"\\\\s*([+-]?\\\\d+)\\\\s*\",mf=\"\\\\s*([+-]?(?:\\\\d*\\\\.)?\\\\d+(?:[eE][+-]?\\\\d+)?)\\\\s*\",qo=\"\\\\s*([+-]?(?:\\\\d*\\\\.)?\\\\d+(?:[eE][+-]?\\\\d+)?)%\\\\s*\",OL=/^#([0-9a-f]{3,8})$/,RL=new RegExp(`^rgb\\\\(${Cl},${Cl},${Cl}\\\\)$`),CL=new RegExp(`^rgb\\\\(${qo},${qo},${qo}\\\\)$`),NL=new RegExp(`^rgba\\\\(${Cl},${Cl},${Cl},${mf}\\\\)$`),AL=new RegExp(`^rgba\\\\(${qo},${qo},${qo},${mf}\\\\)$`),_L=new RegExp(`^hsl\\\\(${mf},${qo},${qo}\\\\)$`),LL=new RegExp(`^hsla\\\\(${mf},${qo},${qo},${mf}\\\\)$`),Sv={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ba($o,yf,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Ov,formatHex:Ov,formatHex8:wL,formatHsl:FL,formatRgb:Rv,toString:Rv});function Ov(){return this.rgb().formatHex()}function wL(){return this.rgb().formatHex8()}function FL(){return wv(this).formatHsl()}function Rv(){return this.rgb().formatRgb()}function yf(e){var t,r;return e=(e+\"\").trim().toLowerCase(),(t=OL.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?Cv(t):r===3?new En(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Zm(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Zm(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=RL.exec(e))?new En(t[1],t[2],t[3],1):(t=CL.exec(e))?new En(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=NL.exec(e))?Zm(t[1],t[2],t[3],t[4]):(t=AL.exec(e))?Zm(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=_L.exec(e))?_v(t[1],t[2]/100,t[3]/100,1):(t=LL.exec(e))?_v(t[1],t[2]/100,t[3]/100,t[4]):Sv.hasOwnProperty(e)?Cv(Sv[e]):e===\"transparent\"?new En(NaN,NaN,NaN,0):null}function Cv(e){return new En(e>>16&255,e>>8&255,e&255,1)}function Zm(e,t,r,n){return n<=0&&(e=t=r=NaN),new En(e,t,r,n)}function gf(e){return e instanceof $o||(e=yf(e)),e?(e=e.rgb(),new En(e.r,e.g,e.b,e.opacity)):new En}function xc(e,t,r,n){return arguments.length===1?gf(e):new En(e,t,r,n==null?1:n)}function En(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}ba(En,xc,nu($o,{brighter(e){return e=e==null?bc:Math.pow(bc,e),new En(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?iu:Math.pow(iu,e),new En(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new En(hc(this.r),hc(this.g),hc(this.b),jm(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Nv,formatHex:Nv,formatHex8:VL,formatRgb:Av,toString:Av}));function Nv(){return`#${gc(this.r)}${gc(this.g)}${gc(this.b)}`}function VL(){return`#${gc(this.r)}${gc(this.g)}${gc(this.b)}${gc((isNaN(this.opacity)?1:this.opacity)*255)}`}function Av(){let e=jm(this.opacity);return`${e===1?\"rgb(\":\"rgba(\"}${hc(this.r)}, ${hc(this.g)}, ${hc(this.b)}${e===1?\")\":`, ${e})`}`}function jm(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function hc(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function gc(e){return e=hc(e),(e<16?\"0\":\"\")+e.toString(16)}function _v(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new mo(e,t,r,n)}function wv(e){if(e instanceof mo)return new mo(e.h,e.s,e.l,e.opacity);if(e instanceof $o||(e=yf(e)),!e)return new mo;if(e instanceof mo)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),s=Math.max(t,r,n),o=NaN,a=s-i,u=(s+i)/2;return a?(t===s?o=(r-n)/a+(r<n)*6:r===s?o=(n-t)/a+2:o=(t-r)/a+4,a/=u<.5?s+i:2-s-i,o*=60):a=u>0&&u<1?0:o,new mo(o,a,u,e.opacity)}function Jm(e,t,r,n){return arguments.length===1?wv(e):new mo(e,t,r,n==null?1:n)}function mo(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}ba(mo,Jm,nu($o,{brighter(e){return e=e==null?bc:Math.pow(bc,e),new mo(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?iu:Math.pow(iu,e),new mo(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new En(KP(e>=240?e-240:e+120,i,n),KP(e,i,n),KP(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new mo(Lv(this.h),Wm(this.s),Wm(this.l),jm(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=jm(this.opacity);return`${e===1?\"hsl(\":\"hsla(\"}${Lv(this.h)}, ${Wm(this.s)*100}%, ${Wm(this.l)*100}%${e===1?\")\":`, ${e})`}`}}));function Lv(e){return e=(e||0)%360,e<0?e+360:e}function Wm(e){return Math.max(0,Math.min(1,e||0))}function KP(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}var Qm=Math.PI/180,Km=180/Math.PI;var ey=18,Fv=.96422,Vv=1,Bv=.82521,Gv=4/29,Nl=6/29,zv=3*Nl*Nl,BL=Nl*Nl*Nl;function kv(e){if(e instanceof Yo)return new Yo(e.l,e.a,e.b,e.opacity);if(e instanceof xa)return Uv(e);e instanceof En||(e=gf(e));var t=nT(e.r),r=nT(e.g),n=nT(e.b),i=eT((.2225045*t+.7168786*r+.0606169*n)/Vv),s,o;return t===r&&r===n?s=o=i:(s=eT((.4360747*t+.3850649*r+.1430804*n)/Fv),o=eT((.0139322*t+.0971045*r+.7141733*n)/Bv)),new Yo(116*i-16,500*(s-i),200*(i-o),e.opacity)}function iT(e,t,r,n){return arguments.length===1?kv(e):new Yo(e,t,r,n==null?1:n)}function Yo(e,t,r,n){this.l=+e,this.a=+t,this.b=+r,this.opacity=+n}ba(Yo,iT,nu($o,{brighter(e){return new Yo(this.l+ey*(e==null?1:e),this.a,this.b,this.opacity)},darker(e){return new Yo(this.l-ey*(e==null?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,r=isNaN(this.b)?e:e-this.b/200;return t=Fv*tT(t),e=Vv*tT(e),r=Bv*tT(r),new En(rT(3.1338561*t-1.6168667*e-.4906146*r),rT(-.9787684*t+1.9161415*e+.033454*r),rT(.0719453*t-.2289914*e+1.4052427*r),this.opacity)}}));function eT(e){return e>BL?Math.pow(e,1/3):e/zv+Gv}function tT(e){return e>Nl?e*e*e:zv*(e-Gv)}function rT(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function nT(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function GL(e){if(e instanceof xa)return new xa(e.h,e.c,e.l,e.opacity);if(e instanceof Yo||(e=kv(e)),e.a===0&&e.b===0)return new xa(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Km;return new xa(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function Hv(e,t,r,n){return arguments.length===1?GL(e):new xa(e,t,r,n==null?1:n)}function xa(e,t,r,n){this.h=+e,this.c=+t,this.l=+r,this.opacity=+n}function Uv(e){if(isNaN(e.h))return new Yo(e.l,0,0,e.opacity);var t=e.h*Qm;return new Yo(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}ba(xa,Hv,nu($o,{brighter(e){return new xa(this.h,this.c,this.l+ey*(e==null?1:e),this.opacity)},darker(e){return new xa(this.h,this.c,this.l-ey*(e==null?1:e),this.opacity)},rgb(){return Uv(this).rgb()}}));var Xv=-.14861,sT=1.78277,oT=-.29227,ty=-.90649,hf=1.97294,qv=hf*ty,$v=hf*sT,Yv=sT*oT-ty*Xv;function zL(e){if(e instanceof Pc)return new Pc(e.h,e.s,e.l,e.opacity);e instanceof En||(e=gf(e));var t=e.r/255,r=e.g/255,n=e.b/255,i=(Yv*n+qv*t-$v*r)/(Yv+qv-$v),s=n-i,o=(hf*(r-i)-oT*s)/ty,a=Math.sqrt(o*o+s*s)/(hf*i*(1-i)),u=a?Math.atan2(o,s)*Km-120:NaN;return new Pc(u<0?u+360:u,a,i,e.opacity)}function aT(e,t,r,n){return arguments.length===1?zL(e):new Pc(e,t,r,n==null?1:n)}function Pc(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}ba(Pc,aT,nu($o,{brighter(e){return e=e==null?bc:Math.pow(bc,e),new Pc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?iu:Math.pow(iu,e),new Pc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*Qm,t=+this.l,r=isNaN(this.s)?0:this.s*t*(1-t),n=Math.cos(e),i=Math.sin(e);return new En(255*(t+r*(Xv*n+sT*i)),255*(t+r*(oT*n+ty*i)),255*(t+r*(hf*n)),this.opacity)}}));function hs(e,t,r){return e>0==t>0?r===1?t:e+r*(t-e):e*(1-r)+t*r}function Qr(e,t,r){return[hs(e[0],t[0],r),hs(e[1],t[1],r)]}function bs(e,t,r){return[hs(e[0],t[0],r),hs(e[1],t[1],r),hs(e[2],t[2],r)]}function bf(e,t){return[e[0]+t[0],e[1]+t[1]]}function Zv(e,t){return[e[0]-t[0],e[1]-t[1]]}function uT(e,t){return[e[0]-t[0],e[1]-t[1],e[2]-t[2]]}function cT(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Pa(e,t){return Al(uT(e,t))}function ry(e,t,r){return[hs(e[0],t[0],r[0]),hs(e[1],t[1],r[1])]}function Wv(e,t){return[e[0]*t,e[1]*t]}function Al(e){let[t,r,n]=e;return t*t+r*r+n*n}function _l(e,t){let r=e[1]*t[2]-e[2]*t[1],n=e[2]*t[0]-e[0]*t[2],i=e[0]*t[1]-e[1]*t[0],s=Math.sqrt(r*r+n*n+i*i);return[r/s,n/s,i/s]}function Ll(e,t,r){e=Math.fround(e),t=Math.fround(t),r=Math.fround(r);let n=Math.fround(e*e+t*t+r*r);return isFinite(n)&&n!=0}function Xo([e,t,r]){return isFinite(e)&&isFinite(t)&&isFinite(r)}function ns(e,t){let r;e>t&&(r=e,e=t,t=r);let n=e>0,i=t>0,s=Math.abs(e)>.01,o=Math.abs(t)>.01;if(s||o)return da(e,t);if(e===0)return t*Math.abs(t);if(t===0)return e*Math.abs(e);if(n!==i)return 0;let a=n?Math.sqrt(e*t):-Math.sqrt(e*t);return a>=e&&t>=a?a:da(e,t)}function mT(e,t,r,n,i){if(!(isNaN(t)||isNaN(n)||t<0==n<0))for(;;){let s=ns(e,r),o=i(s);if(!isFinite(o))return;if(s===e||s===r)return Math.abs(t)<=Math.abs(n)?[e,t]:[r,n];if(o===0)return Pf(e,t,s,o,r,n,i);t<0!=o<0?(r=s,n=o):(e=s,t=o)}}function sD(e,t,r,n,i){if(!(lT(t)||lT(n))&&pT(t,n))for(;;){let s=ns(e,r),o=i(s);if(lT(o))return;if(s===e||s===r)return s;if(pT(t,o))r=s,n=o;else if(pT(o,n))e=s,t=o;else return}}function lT(e){for(let t of e)if(isNaN(t))return!0;return!1}function pT(e,t){for(let r=0;r<e.length;r++)if(!kL(e[r],t[r]))return!1;return!0}function kL(e,t){return e<=0&&t>=0||e>=0&&t<=0}function Pf(e,t,r,n,i,s,o){let a;if(!isFinite(n))return;isFinite(t)||(a=si(e,t,r,n,o),a!==void 0&&(e=a,t=o(e))),isFinite(s)||(a=si(r,n,i,s,o),a!==void 0&&(i=a,s=o(a)));let u,c;t===n?u=[e,t]:u=jv(e,t,r,n,o,n),s===n?c=[i,s]:c=jv(r,n,i,s,o,n);let l;return u&&c&&(l=ns(u[0],c[0])),l!==void 0?[l,o(l)]:void 0}function si(e,t,r,n,i){if(isFinite(t)!==isFinite(n))for(;;){let s=ns(e,r),o=i(s);if(s===e||s===r)return isFinite(t)?e:r;isFinite(o)!==isFinite(t)?(r=s,n=o):(e=s,t=o)}}function ny(e,t,r,n,i){if(Xo(t)!==Xo(n))for(;;){let s=ns(e,r),o=i(s);if(s===e||s===r)return Xo(t)?e:r;Xo(o)!==Xo(t)?(r=s,n=o):(e=s,t=o)}}function jv(e,t,r,n,i,s){if(t===s!=(n===s))for(;;){let o=ns(e,r),a=i(o);if(o===e||o===r)return t===s?[e,t]:[r,n];a===s!=(t===s)?(r=o,n=a):(e=o,t=a)}}function oD(e,t,r,n,i,s,o){if(e<r&&r<i&&isFinite(t)&&isFinite(n)&&isFinite(s)&&t!==n&&n!==s&&n>t==n>s)for(;;){let a=ns(e,r),u=o(a),c=ns(r,i),l=o(c);if(!isFinite(u)||!isFinite(l))return;if(a===e||a===r||c===r||c===i)return u>n==n>t?[a,u]:l>n==n>t?[c,l]:[r,n];if(u===n||l===n)return Pf(e,t,r,n,i,s,o);n>t&&u>t&&u>n||n<t&&u<t&&u<n?(i=r,s=n,r=a,n=u):n>t&&l>n&&l>s||n<t&&l<n&&l<s?(e=r,t=n,r=c,n=l):(e=a,t=u,i=c,s=l)}}function xs([e,t],[r,n]){return(r-e)*(r-e)+(n-t)*(n-t)}function Jv(e,t,r,n,i,s){let o=s(e),a=s(t),u=s(r),c=xs(o,n),l=xs(a,n),p=xs(u,n);if(!(t<=e||r<=t)&&!(!isFinite(c)||!isFinite(l)||!isFinite(p))&&!(l>=c||l>=p))for(;;){if(Math.abs(u[0]-o[0])<i&&Math.abs(u[1]-o[1])<i)return[e,r];let f=ns(e,t),m=s(f),g=xs(m,n),y=ns(t,r),d=s(y),h=xs(d,n);if(!isFinite(g)||!isFinite(h))return;if(f===e||f===t||y===t||y===r)return g<l&&g<h?[f,f]:h<g&&h<l?[y,y]:[t,t];if((g===l||h===l)&&(t=.5*(f+t),a=s(t),l=xs(a,n),g===l||h===l))return[e,r];g<l&&g<h?([r,t]=[t,f],[u,a]=[a,m],[p,l]=[l,g]):h<g&&h<l?([e,t]=[t,y],[o,a]=[a,d],[c,l]=[l,h]):([e,r]=[f,y],[o,u]=[m,d],[c,p]=[g,h])}}function Qv(e,t,r){return t===void 0&&(t=-1/0),r===void 0&&(r=1/0),Math.min(r,Math.max(t,e))}function fT(e,t,r,n,i,s){let o;if(n!==void 0&&i!==void 0){let p=.5*(n+i);o=r+.01*(r<p?i-n:n-i)}else o=Math.abs(r)>1?r*1.00001:r+1e-5;let a=e(r),u=e(o),c=xs(a,t),l=xs(u,t);if(!(!isFinite(c)||!isFinite(l))){if(c===l)return[r,o];for(l>c&&([r,o]=[o,r],[a,u]=[u,a],[c,l]=[l,c]);isFinite(r)&&isFinite(o)&&r!==o;){if(i!==void 0&&o>i)return[i,i];if(n!==void 0&&o<n)return[n,n];let p=r+3*(o-r),f=e(p),m=xs(f,t);if(!isFinite(m))return[r,o];if(m===l)return[r,o];if(m>l){let g=o>r?Jv(r,o,p,t,s,e):Jv(p,o,r,t,s,e);return g&&[Qv(g[0],n,i),Qv(g[1],n,i)]}[r,c,o,l]=[o,l,p,m]}return[r,o]}}function Kv(e,t,r,n){return r?n?Math.min(xs(e(n[0]),t),xs(e(n[1]),t))<Math.min(xs(e(r[0]),t),xs(e(r[1]),t)):!1:!0}function iY(e,t,r,n,i,s){let o=fT(e,t,r,n,i,s);if(n!==void 0){let a=fT(e,t,n,n,i,s);Kv(e,t,o,a)&&(o=a)}if(i!==void 0){let a=fT(e,t,i,n,i,s);Kv(e,t,o,a)&&(o=a)}return o}function eD(e,t,r,n,i,s,o,a){let u=Math.abs(n-t),c=Math.abs(s-n),l=Math.abs(a-s);return u>c&&u>l?[e,r]:l>c&&l>u?[i,o]:[r,i]}function wl(e,t,r,n,i,s,o,a=0){if(!((r-e)*(i-r)<=0)&&!(!isFinite(e)||!isFinite(r)||!isFinite(i))&&!(!isFinite(t)||!isFinite(s))){if(!isFinite(n)){let u=si(e,t,r,n,o),c=si(r,n,i,s,o);return u===void 0||c===void 0?void 0:[u,c]}if(!(Math.abs(n-((i-r)*t+(r-e)*s)/(i-e))<a))for(;;){let u=ns(e,r),c=o(u),l=ns(r,i),p=o(l),f=Math.abs(c-da(t,n)),m=Math.abs(n-da(c,p)),g=Math.abs(p-da(n,s));if(f<=a&&m<=a&&g<=a)return;if(!isFinite(c)){let y=si(e,t,u,c,o),d=si(u,c,i,s,o);return y===void 0||d===void 0?void 0:[y,d]}if(!isFinite(p)){let y=si(e,t,l,p,o),d=si(l,p,i,s,o);return y===void 0||d===void 0?void 0:[y,d]}if((u===e||u===r)&&(l===r||l===i))return Math.abs(n-t)>Math.abs(s-n)?[e,r]:[r,i];if(u===e||u===r)return eD(e,t,r,n,l,p,i,s);if(l===r||l===i)return eD(e,t,u,c,r,n,i,s);f>g&&f>=m?(i=r,s=n,r=u,n=c):g>f&&g>=m?(e=r,t=n,r=l,n=p):(e=u,t=c,i=l,s=p)}}}var Ta=(Math.sqrt(5)-1)/2;function xf(e,t){return e>0==t>0?e+Ta*(t-e):(1-Ta)*e+Ta*t}function su(e,t){let r;e>t&&(r=e,e=t,t=r);let n=e>0,i=t>0,s=Math.abs(e)>.01,o=Math.abs(t)>.01;if(s||o)return xf(e,t);if(e===0)return t*Math.abs(t);if(t===0)return e*Math.abs(e);if(n!==i)return 0;let a=n?Math.sqrt(e*t):-Math.sqrt(e*t);return a>=e&&t>=a?a:xf(e,t)}function aD(e,t,r,n,i,s){if(!isFinite(e)||!isFinite(r)||!isFinite(t)||!isFinite(n))return;e>r&&([e,t,r,n]=[r,n,e,t]);let o=su(e,r),a=i(o);if(Math.abs(a-xf(t,n))<=s)return;let u=su(e,o),c=i(u);for(;;){let l=Math.abs(c-xf(t,a)),p=Math.abs(a-xf(n,c));if(l<=s&&p<=s)return;if(l>p){if(r=o,n=a,o=u,a=c,u=su(e,o),c=i(u),u===e||u===o)return rD(e,t,o,a,r,n);if(!isFinite(c))return tD(e,t,u,c,r,n,i)}else{if(e=u,t=c,u=o,c=a,o=su(r,o),a=i(o),o===r||o===u)return rD(e,t,u,c,r,n);if(!isFinite(a))return tD(e,t,o,a,r,n,i)}}}function tD(e,t,r,n,i,s,o){let a=si(e,t,r,n,o),u=si(r,n,i,s,o);if(!(a===void 0||u===void 0))return[a,u]}function rD(e,t,r,n,i,s){return Math.abs(n-t)>Math.abs(s-n)?[e,r]:[r,i]}function dT(e,t,r){let n=e[0]*(1-Ta)+t[0]*Ta-r[0],i=e[1]*(1-Ta)+t[1]*Ta-r[1],s=e[2]*(1-Ta)+t[2]*Ta-r[2];return n*n+i*i+s*s}function iy(e,t,r,n,i,s,o,a){if(!isFinite(e)||!isFinite(r)||!Xo(t)||!Xo(n))return;e>r&&([e,t,r,n]=[r,n,e,t]);let u=su(e,r),c=i(u),l=s*s;if(dT(t,n,c)<=l)return;let p=su(e,u),f=i(p);for(;;){let m=dT(t,c,f),g=dT(n,f,c);if(m<=l&&g<=l)return r-e<a?p:void 0;if(m>g){if(r=u,n=c,u=p,c=f,p=su(e,u),f=i(p),p===e||u-p<=o)return iD(e,t,u,c,r,n);if(!Xo(f))return nD(e,t,p,f,r,n,i)}else{if(e=p,t=f,p=u,f=c,u=su(r,u),c=i(u),u===r||u-p<=o)return iD(e,t,p,f,r,n);if(!Xo(c))return nD(e,t,u,c,r,n,i)}}}function nD(e,t,r,n,i,s,o){let a=ny(e,t,r,n,o),u=ny(r,n,i,s,o);if(!(a===void 0||u===void 0))return[a,u]}function iD(e,t,r,n,i,s){return Pa(n,t)>Pa(s,n)?[e,r]:[r,i]}var UL=wl,sy=si,qL=3.154019550531224,uD=Math.pow(2,-13),ou=uD*uD,cD=ou*ou,yT=ou,hT=32,yo=[],au=[];function $L(e,t){for(var r=hT;r>0;r--){var n=qL/hT*r,i=Math.sinh(n),s=Math.cosh(Math.PI/2*i),o=1/(Math.exp(Math.PI/2*i)*s),a=Math.cosh(n)/(s*s);e.push(o),t.push(a)}}$L(yo,au);var fD=0;for(oy=0;oy<au.length;oy++)fD+=au[oy];var oy,ay=1/(1+2*fD);function Ei(e,t,r){return .5*(t*(2-r)+e*r)}function YL(e,t,r){var n=.5*(t+r),i=UL(t,e(t),n,e(n),r,e(r),e);return i?.5*(i[0]+i[1]):n}function Tf(e,t,r,n,i){return{x1:e,x2:t,value:r,error:n,minerror:i}}function lD(e,t,r){var n=Math.abs(e(Ei(t,r,ou))),i=Math.abs(e(Ei(t,r,2*ou))),s=Math.abs(e(Ei(t,r,4*ou)));return n<ou||i<ou?!1:n>1.95*i&&i>1.95*s}function gT(e,t,r){var n=Ei(r,t,yo[0]),i=Ei(t,r,yo[0]),s=e(n),o=e(i),a=Ei(t,r,1),u=e(a),c,l;if(isFinite(u)&&!isFinite(s)){if(c=sy(n,s,a,u,e),Math.abs((c-t)/(r-t))>yT)return Tf(t,r,NaN,NaN,NaN);t=c,s=e(t)}if(isFinite(u)&&!isFinite(o)){if(l=sy(a,u,i,o,e),Math.abs((l-r)/(r-t))>yT)return Tf(t,r,NaN,NaN,NaN);r=l,o=e(r)}if(isFinite(s)&&isFinite(o)&&!isFinite(u)){if(c=sy(n,s,a,u,e),l=sy(a,u,i,o,e),Math.abs((l-c)/(r-t))>yT)return Tf(t,r,NaN,NaN,NaN);u=.5*(c+l)}if(lD(e,t,r)||lD(e,r,t))return Tf(t,r,NaN,NaN,NaN);for(var p=u,f=0,m=0,g=0,y=0,d=0,h=0,b=0;b<hT;b+=4)d=e(Ei(t,r,yo[b])),h=e(Ei(r,t,yo[b])),y=Math.max(y,Math.abs(d),Math.abs(h)),f+=au[b]*(d+h),d=e(Ei(t,r,yo[b+1])),h=e(Ei(r,t,yo[b+1])),y=Math.max(y,Math.abs(d),Math.abs(h)),g+=au[b+1]*(d+h),d=e(Ei(t,r,yo[b+2])),h=e(Ei(r,t,yo[b+2])),y=Math.max(y,Math.abs(d),Math.abs(h)),m+=au[b+2]*(d+h),d=e(Ei(t,r,yo[b+3])),h=e(Ei(r,t,yo[b+3])),y=Math.max(y,Math.abs(d),Math.abs(h)),g+=au[b+3]*(d+h);var x=p+f,P=x+m,E=P+g,M=Math.abs(m-x),I=Math.abs(g-P),D=ay*(r-t)*E,O=ay*Math.abs(r-t)*y*au[0],N;return M===0?N=ay*Math.abs(r-t)*I:N=ay*Math.abs(r-t)*I*(I/M)*(I/M),N=Math.max(N,O),Tf(t,r,D,N,O)}function pD(e){for(var t=-1/0,r=-1/0,n=-1,i=0,s=0;s<e.length;s++){var o=e[s];i+=o.value,o.error>t&&(t=o.error,n=s),o.minerror>r&&(r=o.minerror)}return{maxerror:t,maxminerror:r,maxindex:n,totalvalue:i}}function If(e,t,r,n=32){if(isNaN(t)||isNaN(r))return NaN;var i=1;if(t>r){var s=t;t=r,r=s,i=-1}if(t===1/0&&r===1/0)return NaN;if(t===-1/0&&r===-1/0)return NaN;if(t===-1/0&&r===1/0)return i*If(function(f){return e(f/((1+f)*(1-f)))*(1+f*f)/((1+f)*(1+f)*(1-f)*(1-f))},-1,1,n);if(t===-1/0)return i*If(function(f){return-e(r-f/(1-f))/((1-f)*(1-f))},1,0,n);if(r===1/0)return i*If(function(f){return e(t+f/(1-f))/((1-f)*(1-f))},0,1,n);for(var o=[gT(e,t,r)],a=pD(o),u=1;u<n&&!(Math.abs(a.maxerror/a.totalvalue)<=32*cD||a.maxerror<=32*cD||a.maxerror<=32*a.maxminerror||!isFinite(a.maxerror)||!isFinite(a.maxminerror));u++){var c=o[o.length-1];o[o.length-1]=o[a.maxindex],o[a.maxindex]=c;var l=o.pop(),p=YL(e,Ei(l.x2,l.x1,.125),Ei(l.x1,l.x2,.125));o.push(gT(e,l.x1,p)),o.push(gT(e,p,l.x2)),a=pD(o)}return!isFinite(a.maxerror)||!isFinite(a.maxminerror)?NaN:Math.abs(a.totalvalue)<=10*a.maxminerror?0:i*a.totalvalue}var Ef=class{constructor(t){this.comparator=t;this._data=[]}size(){return this._data.length}queue(t){let r=this._data.length;for(this._data.push(t);r>0;){let n=r-1>>>1;if(this.comparator(this._data[r],this._data[n])<0){let i=this._data[n];this._data[n]=this._data[r],this._data[r]=i,r=n}else break}}dequeue(){let t=this._data[0],r=this._data.pop();if(this._data.length>0&&r!==void 0){this._data[0]=r;let n=0,i=this._data.length-1;for(;;){let s=(n<<1)+1,o=s+1,a=n;if(s<=i&&this.comparator(this._data[s],this._data[a])<0&&(a=s),o<=i&&this.comparator(this._data[o],this._data[a])<0&&(a=o),a!==n){let u=this._data[a];this._data[a]=this._data[n],this._data[n]=u,n=a}else break}}return t}peek(){return this._data[0]}clear(){this._data.length=0}};function ZL(e,t){let r=e.start[1]-e.end[1],n=e.end[0]-e.start[0],i=t.start[1]-t.end[1],s=t.end[0]-t.start[0],o=r*e.end[0]+n*e.end[1],a=i*t.end[0]+s*t.end[1],u=r*s-i*n;if(u!==0)return(r*a-i*o)/u}function WL(e,t,r){if(r.xSlope>=t.xSlope)return;if(t.scanlineX===r.scanlineX)return e;let n=t.start[1]>t.end[1]?t.start:t.end,i=r.start[1]>r.end[1]?r.start:r.end,s=n[1];if(i[1]<n[1]){if(s=i[1],bT(s,t)<i[0])return}else if(n[1]<i[1]){let a=bT(s,r);if(n[0]<a)return}else if(n[0]<i[0])return;let o=ZL(t,r);if(o!==void 0)return Math.max(Math.min(o,s),e)}function bT(e,t){let r=t.end[0],n=t.start[0],i=t.end[1],s=t.start[1];if(i===e)return r;if(s===e)return n;{let o=(e-i)/(s-i),a=(1-o)*r+o*n;if(r<n){if(a<=r)return r;if(n<=a)return n}else{if(a<=n)return n;if(r<=a)return r}return a}}function xT(e){let t=0,r=0,n=!1,i=0;for(let{scanlineX:s,isClockwise:o}of e)o?i+=1:i-=1,i!==0&&!n?(n=!0,r=s):i===0&&n&&(n=!1,t+=s-r);return t}var Mf=class{constructor(t){this.scanlineY=-1/0;let r=1;this.activeEdges=[],this.events=new Ef(function(n,i){return n.y-i.y}),this.scanlineY=-1/0,this.polygonLength=t.length-1;for(let n=t.length-1;n>=1;n--){let i=t[n],s=t[n-1],o={id:r++,index:n-1,end:i,start:s,scanlineX:0,xSlope:1/0,isClockwise:s[1]>i[1],skipIntersectionWith:{}};s[1]>i[1]?(this.events.queue({type:\"+\",y:i[1],edge:o}),this.events.queue({type:\"-\",y:s[1],edge:o}),o.xSlope=(s[0]-i[0])/(s[1]-i[1]),o.scanlineX=i[0]):i[1]>s[1]?(this.events.queue({type:\"+\",y:s[1],edge:o}),this.events.queue({type:\"-\",y:i[1],edge:o}),o.xSlope=(i[0]-s[0])/(i[1]-s[1]),o.scanlineX=s[0]):this.events.queue({type:\"h\",y:s[1],edge:o})}}nextScanline(){var s;let t,r=this.events.peek();if(!r)return;if(r.y<=this.scanlineY)throw new Error(\"Programming error: expected next event to begin a new scanline\");this.scanlineY=r.y,this.updateActiveEdgeScanlineIntersections();let n=xT(this.activeEdges),i=[];for(;t=this.events.dequeue();)if(t.type===\"x\"?this.swapActiveEdges(t):t.type===\"+\"?this.insertActiveEdge(t):t.type===\"-\"&&this.removeActiveEdge(t),i.push(t),((s=this.events.peek())==null?void 0:s.y)!==this.scanlineY)return{y:this.scanlineY,activeEdges:this.activeEdges,lengthBeforeProcessingEvents:n,events:i}}updateActiveEdgeScanlineIntersections(){let t=-1/0;for(let r of this.activeEdges){let n=bT(this.scanlineY,r);n<t?n=t:t=n,r.scanlineX=n}}insertActiveEdge(t){let r=this.activeEdges,n=t.edge,i=t.y,{xSlope:s,scanlineX:o}=n;for(var a=0;a<r.length;a++){let u=r[a];if(o<u.scanlineX||o===u.scanlineX&&s<=u.xSlope)break}r.splice(a,0,n),this.checkIntersection(i,r[a-1],n),this.checkIntersection(i,n,r[a+1])}checkIntersection(t,r,n){if(!r||!n||r.index===(n.index+1)%this.polygonLength||n.index===(r.index+1)%this.polygonLength)return;if(r.id<n.id){if(r.skipIntersectionWith[n.id])return}else if(n.skipIntersectionWith[r.id])return;let i=WL(t,r,n);if(i===void 0)return;r.id<n.id?r.skipIntersectionWith[n.id]=!0:n.skipIntersectionWith[r.id]=!0;let s={type:\"x\",y:i,edge1:r,edge2:n};this.events.queue(s)}removeActiveEdge(t){let r=this.activeEdges,n=t.edge,i=t.y,s=r.indexOf(n);r.splice(s,1),this.checkIntersection(i,r[s-1],r[s])}swapActiveEdges(t){let r=this.activeEdges,n=t.edge1,i=t.edge2,s=t.y,o=r.indexOf(n),a=o+1;o===-1||r[a]!==i?n.id<i.id?delete n.skipIntersectionWith[i.id]:delete i.skipIntersectionWith[n.id]:(r[o]=i,r[a]=n,this.checkIntersection(s,r[o-1],i),this.checkIntersection(s,n,r[a+1]))}static debugEvent(t){let r=`y=${t.y} `;return r+=t.type===\"x\"?`[x ${t.edge1.index}/${t.edge2.index}]`:`[${t.type} ${t.edge.index}] (${t.edge.end})-(${t.edge.start})`,r}debugState(){return`y=${this.scanlineY}\n${this.activeEdges.map(t=>`[${t.index}] ${t.scanlineX}`)}`}};function jL(e){let t=e.slice(0,2),r=e.slice(-2);return t[0]!==r[0]||t[1]!==r[1]?[...e,...t]:e}function cY(e,t){if(!e)return!1;let r=jL(e),[n,i]=t,s=0;for(var o=r.length-1;o>=3;o-=2){let a=r[o-3],u=r[o-2],c=r[o-1],l=r[o];u>i!=l>i&&n<(c-a)*(i-u)/(l-u)+a&&(u>l?s+=1:u<l&&(s-=1))}return s!==0}function mD(e){if(e.length<4||e[0][0]!==e[e.length-1][0]||e[0][1]!==e[e.length-1][1])return 0;let t=new Mf(e),r,n=0,i;for(;i=t.nextScanline();){let s=i.lengthBeforeProcessingEvents;r&&(n+=.5*(i.y-r.y)*(s+r.length)),r={y:i.y,length:xT(i.activeEdges)}}return n}function yD(e){if(!e.length)return[];if(e[0][0]!==e[e.length-1][0]||e[0][1]!==e[e.length-1][1])throw new Error(\"Programming error: expected last point to be a duplicate of the first point.\");for(let f=0;f<e.length-1;f++)if(e[f][0]===e[f+1][0]&&e[f][1]===e[f+1][1])throw new Error(`Programming error: unexpected duplicate point at ${f+1}`);let t=new Mf(e),r=e.slice(0,-1).map(()=>0),n;for(;n=t.nextScanline();)for(let f of n.events){let m={};if(f.type===\"h\"){let g=f.edge;m[g.index]={xMin:Math.min(g.end[0],g.start[0]),xMax:Math.max(g.end[0],g.start[0]),dx:g.end[0]-g.start[0]}}else if(f.type===\"x\"){let g=f.edge1,y=f.edge2,d=dD([g.start,g.end],[y.start,y.end]),h=d>0?-1:d<0?1:0;r[g.index]+=h,r[y.index]-=h}for(let g of n.activeEdges){let y=g.end[1]-g.start[1];for(let d in m){let{xMin:h,xMax:b,dx:x}=m[d];if(h<g.scanlineX&&g.scanlineX<b){let P=x*y,E=P>0?-1:P<0?1:0;r[d]+=E,r[g.index]-=E}}}}let i=e.slice(0,-1).map(()=>0),s=e[0][1],o=0;for(let f=1;f<e.length;f++)e[f][1]<s&&(s=e[f][1],o=f);let a=e.length-1,u=o>0?o-1:a-1,c=(o+1)%a,p=dD([e[u],e[o]],[e[o],e[c]])>0?1:0;i[o]=p>0?-1:1;for(let f=0;f<a-1;f++){let m=(o+f)%a;p+=r[m],i[(m+1)%a]=p>0?-1:1}return i}function dD(e,t){let r=e[1][0]-e[0][0],n=e[1][1]-e[0][1],i=t[1][0]-t[0][0],s=t[1][1]-t[0][1];return r*s-n*i}var TD={spy:Dv},{cosh:ID,sinh:ED,tanh:MD,acosh:vD,asinh:DD,atanh:SD,expm1:JL,log1p:Of,sign:OT,hypot:go}=Math,QL=fa,RT=$u,OD=Yu,RD=Symbol(\"DIVERGES\"),yy=class yy{constructor(t=yy.defaultLimit,r){this.limit=t;this.computeSize=r;this.currentSize=0;this.cache=new Map}get(t){let r=this.cache.get(t);return r&&(this.cache.delete(t),this.cache.set(t,r)),r==null?void 0:r.value}set(t,r){let n=this.computeSize?this.computeSize(r):1;if(this.currentSize+n>=this.limit){let i=this.cache.keys().next().value;this.cache.delete(i)}this.cache.set(t,{size:n,value:r})}};yy.defaultLimit=1e5;var Vl=yy,Rf=1e4,CD=Rf*2;function KL(){return Rf}function CT(e){Rf=e}function ET(e,t,r){if(fo(t))return e.recursiveDepthError=r,ri(t);throw r}function ew(e,t,r,n,i){let s=e.recursiveFunctionCache||new Vl,o=[];o.push(n);let a=0;for(;o.length>0;){if(o.length>Rf||a++>CD)return ET(e,r,Jh());let{fn:u,args:c}=o.pop(),l=t[u](s,...c);if(l!==void 0){if(l===RD)return ET(e,r,Ap());o.push({fn:u,args:c}),o.push(l.stackFrame)}}return s.get(i)[0]}var tw=function(e){let t=e*e;return 1+t===1?1:1+t===t?Math.abs(e):Math.sqrt(t+1)},rw=function(e){let t=e*e;return t<1?NaN:t-1===t?Math.abs(e):Math.sqrt(t-1)};function on(e,t,r){return Math.max(t,Math.min(r,e))}function ND(e,t){let r=e%t;return e*t<0&&r!==0?r+t:r}function AD(e,t){e=Math.round(e),t=Math.round(t);let r=RT(e,t);return Math.abs(e/r*t)}function nw(e){if(e.length===0)return NaN;let t=e[0];for(let r=1;r<e.length;r++)t=RT(t,e[r]);return t}function iw(e){if(e.length===0)return NaN;let t=e[0];for(let r=1;r<e.length;r++)t=AD(t,e[r]);return t}function uu(e,t){if(isNaN(e))return e;if(isNaN(t))return t;if(!isFinite(e)&&!isFinite(t))return NaN;if(t===0||e===t)return 1;if(e===0)return Ps(t);let r=isFinite(e)&&e===Math.round(e),n=isFinite(t)&&t===Math.round(t);if(e<0&&t<0&&e-t<0)return r&&n?0:Ps(e-t)*Ps(t)/(Ps(e)*uu(-e,-t));if(e<0&&t>0&&e-t<0)return r&&n?Math.pow(-1,t)*uu(t-e-1,t):Ps(e-t)/Ps(e)*uu(-(e-t),t);if(e<0&&t<0&&e-t>0)return r&&n?Math.pow(-1,e-t)*uu(-t-1,e-t):Ps(t)/Ps(e)*uu(-t,-e);if(e>0&&t<0&&e-t>0){let a=Math.abs(e)>Math.abs(t)?-t:e;return Ps(t)/uu(e-t,a)}if(e>0&&t>0&&e-t<0)return Ps(e-t)/uu(t,e);if(e<0||t<0||e-t<0||e<15&&t<15&&e-t<15)return ly(e,t)/Zo(t);let i=is(e)-is(t)-is(e-t)-(e-t)*Of(-t/e),s=Math.sqrt(e/(2*Math.PI*t*(e-t)))*Math.pow(e/t,t)*Math.exp(i);return r&&n&&e>0&&t>0&&e-t>0?Math.round(s):s}function ly(e,t){if(isNaN(e))return e;if(isNaN(t))return t;if(!isFinite(e)&&!isFinite(t))return NaN;if(t===0)return 1;if(e===0)return 1/Zo(-t);if(e===t)return Zo(e);let r=isFinite(e)&&e===Math.round(e),n=isFinite(t)&&t===Math.round(t);if(e<0&&e-t<0)return r&&n?Math.pow(-1,t)*ly(t-e-1,t):Ps(e-t)/Ps(e)*ly(-(e-t),t);if(e<0||e-t<0||e<15&&e-t<15)return Zo(e)/Zo(e-t);let i=is(e)-is(e-t)-(e-t)*Of(-t/e),s=Math.sqrt(e/(e-t))*gy(e,t)*Math.exp(i);return r&&n&&e>0&&t>0&&e-t>0?Math.round(s):s}function Zo(e){if(e===-1/0)return NaN;let t=Math.round(e)===e;if(e<0)return t?1/0:1/(Ps(e)*gD(-e));let r=gD(e);return t?Math.round(r):r}function gD(e){return e>171?1/0:e<14?sw(e):uw(e)}function sw(e){let t=4.077131788261185,r=7.024675027156382,n=6.657107767450176,i=3.766266976716022,s=1.2792371666711133,o=.24304596436338005,a=.020049769312165774,u=4.154347453162709,c=7.270007565107539,l=6.97805297331391,p=3.989651532924167,f=1.367176195613119,m=.26175627691546965,g=.021742722739397567,y=1+e*(t+e*(r+e*(n+e*(i+e*(s+e*(o+e*a)))))),d=1+e*(u+e*(c+e*(l+e*(p+e*(f+e*(m+e*g)))))),h=e+1,b=1-(h-e);return gy(h,e)*Math.sqrt(h+(2*e+1)*b)*(y/d)}var ow=Math.pow(2,27)+1;function aw(e){let t=ow*e;return t-(t-e)}var PT=.3678794428706169,TT=-16991745912462731e-25;function gy(e,t){let r=aw(e),n=e-r,i=e*(PT+TT);if(i===0)return Math.pow(e/Math.E,t);let s=r*PT-i+r*TT+n*PT+n*TT;return Math.pow(i,t)*(1+t*(s/i))}function uw(e){return gy(e,e)*Math.sqrt(2*Math.PI*e)*Math.exp(GD(e))}var _D=[1/6,-1/30,1/42,-1/30,5/66,-691/2730,7/6,-3617/510,43867/798,-174611/330,854513/138,-236364091/2730,8553103/6,-23749461029/870];function LD(e,t){if(e!==Math.floor(e))return NaN;if(e<0)return NaN;if(e===0)return 1/BD(t);let r=tr(t);if(e===1)return-1/(r*r);let n=hr(t);if(e===2)return 2*n/(r*r*r);let i=[0,2],s=[];for(let a=3;a<=e;a++){s=[];for(let u=0;u<a;u++){let c=0,l=0;u>0&&(c=(a-u+1)*i[u-1]),u+2<a&&(l=(u+1)*i[u+1]),s.push(-(c+l))}i=s}let o=0;for(let a=e-1;a>=0;a--)o=s[a]+n*o;return o/Math.pow(r,e+1)}function wD(e,t){if(e<0)return NaN;if(e!==Math.floor(e))return NaN;let r=e%2===0?-1:1;if(t<0)return-r*wD(e,1-t)-Math.pow(Math.PI,e+1)*LD(e,Math.PI*t);let n=Zo(e),i=0,s=Math.pow(t,-(e+1));for(;t<10;)i+=s,t++,s=Math.pow(t,-(e+1));i+=e===0?-Math.log(t):s*t/e,i+=.5*s;let o=_D,a=e+1,u=2,c=s*t*a/u,l=1/(t*t);for(let p=1;p<=14;p++)c*=l,i+=c*o[p-1],a++,u++,c*=a/u,a++,u++,c*=a/u;return n*r*i}function cw(e){let t=Math.log(e);return Math.exp(Math.round(t))===e?Math.round(t):t}function FD(e,t){if(t===0)return NaN;let r;return t===Math.E?r=Math.log(e):t===2&&Math.log2?r=Math.log2(e):t===10&&Math.log10?r=Math.log10(e):r=Math.log(e)/Math.log(t),Math.pow(t,Math.round(r))===e?Math.round(r):r}function lw(e){return FD(e,10)}function pw(e,t){return OD(e,1/t)}var VD=1/Math.PI;function hy(e){return e>1e12?!1:Math.round(VD*e)*Math.PI===e}function by(e){if(e>1e12)return!1;let t=Math.round(2*VD*e);return t%2===1&&t*Math.PI===2*e}function tr(e){return hy(Math.abs(e))?0:Math.sin(e)}function hr(e){return by(Math.abs(e))?0:Math.cos(e)}function BD(e){let t=Math.abs(e);return hy(t)?0:by(t)?1/0:Math.tan(e)}function fw(e){return by(Math.abs(e))?1/0:1/Math.cos(e)}function dw(e){return hy(Math.abs(e))?1/0:1/Math.sin(e)}function mw(e){let t=Math.abs(e);return hy(t)?1/0:by(t)?0:1/Math.tan(e)}function yw(e){return e>0?Math.atan(1/e):Math.PI/2-Math.atan(e)}function gw(e){return Math.asin(1/e)}function hw(e){return Math.acos(1/e)}function bw(e){return 1/ID(e)}function xw(e){return 1/ED(e)}function Pw(e){return 1/MD(e)}function Tw(e){return vD(1/e)}function Iw(e){return DD(1/e)}function Ew(e){return SD(1/e)}function Mw(e){if(e===0||isNaN(e))return e;if(!isFinite(e))return NaN;if(e===Math.floor(e))return e>0?0:-0;let t=Math.round(2*e),r=-.5*t+e,n=t&2?-1:1,i=t&1?Math.cos(Math.PI*r):Math.sin(Math.PI*r);return n*i}function Ps(e){return e===1/0||e===-1/0?0:e===0?1:Mw(e)/(Math.PI*e)}function jo(e){let t=0;for(let r=0;r<e.length;r++)t+=e[r];return t/e.length}function vw(e){let t=0;for(let r=0;r<e.length;r++)t+=e[r];return t}function MT(e){return e>50?Math.exp(.5*((1-e)*Of(-1/(e-1))-1)+is(.5*(e-1))-is(.5*(e-2)))*Math.sqrt((1-1/e)/(2*Math.PI)):e/(e+1)*Zo((e+1)/2)/(Zo(e/2)*Math.sqrt(e*Math.PI))}function Bl(e,t,r=e-t){if(Math.abs(r)<.1*(e+t)){let n=r/(e+t),i=r*r/(e+t),s=2*e*n;for(let o=1;o<10;o++){s*=n*n;let a=i+s/(2*o+1);if(a==i)return a;i=a}}return e*Math.log(e/t)+t-e}var Dw=[0,.08106146679532726,.0413406959554093,.02767792568499834,.020790672103765093,.016644691189821193,.013876128823070748,.01189670994589177,.010411265261972096,.009255462182712733,.00833056343336287,.007573675487951841,.00694284010720953,.006408994188004207,.0059513701127588475,.005554733551962801];function is(e){return e>15?GD(e):e<0?NaN:e===Math.floor(e)?Dw[e]:Math.log(Zo(e)/(gy(e,e)*Math.sqrt(2*Math.PI*e)))}function GD(e){let t=.08333333333333333,r=.002777777777777778,n=.0007936507936507937,i=.0005952380952380953,s=.0008417508417508417,o=e*e;return(t-(r-(n-(i-s/o)/o)/o)/o)/e}function xy(e,t){return t<=0?NaN:MT(t)*Math.pow(1+e*e/t,-((t+1)/2))}function Tc(e,t){if(t>0)return 1-Tc(e,-t);if(t===-1/0)return 0;if(t===0)return .5;if(e>=40&&t>-1)return .5+MT(e)*Sw(e,t);if(t/e<-1e3){let n=t*t;return MT(e)*Math.pow(e,.5*(e-1))*Math.pow(Math.abs(t),-e)*(1-e*e*(e+1)*(1/(2+e)+e*(e+3)/(4*(4+e)*n))/(2*n))}let r=Math.sqrt(t*t+e);return Ow((t+r)/(2*r),e/2,e/2)}function Sw(e,t){let r=t*t/e,n=t,i=n;for(let s=1;s<=15;s++)n*=-(2*s-1)/(2*s+1)*(.5*(e+1)+s-1)/s*r,i+=n;return i}function uy(e,t,r){return r<=0?NaN:e===-1/0?Tc(r,t):e>0&&t>0?Tc(r,-e)-Tc(r,-t):Tc(r,t)-Tc(r,e)}function Ow(e,t,r){if(e<0||e>1)throw new RangeError(\"First argument must be between 0 and 1.\");if(t===1&&r===1)return e;if(e===0)return 0;if(e===1)return 1;if(t===0)return 1;if(r===0)return 0;{let n=is(t+r)-is(t)-is(r)-Bl(t,(t+r)*e)-Bl(r,(t+r)*(1-e),(t+r)*e-t),i=Math.exp(n)*Math.sqrt(t*r/(2*Math.PI*(t+r)));return e<(t+1)/(t+r+2)?i*hD(e,t,r)/t:1-i*hD(1-e,r,t)/r}}function hD(e,t,r){let n=Math.pow(2,-52),i=1e-300,s=t+r,o=t+1,a=t-1,u=1,c=1-s*e/o;Math.abs(c)<i&&(c=i),c=1/c;let l=c;for(let p=1;p<=100;p++){let f=2*p,m=p*(r-p)*e/((a+f)*(t+f));c=1+m*c,Math.abs(c)<i&&(c=i),u=1+m/u,Math.abs(u)<i&&(u=i),c=1/c,l*=c*u,m=-(t+p)*(s+p)*e/((t+f)*(o+f)),c=1+m*c,Math.abs(c)<i&&(c=i),u=1+m/u,Math.abs(u)<i&&(u=i),c=1/c;let g=c*u;if(l*=g,Math.abs(g-1)<=n)return l}return l}function Rw(e,t){let r=Math.pow(2,-52),n=1e-300,i=1,s=e,o=i/s,a=i/n,u=1/s,c=2,l=0,p=s,f=-(e-1),m=0;do f-=1,p+=1,u=u*f*t+p,u===0&&(u=n),a=p+f*t/a,a===0&&(a=n),u=1/u,l=a*u,o=o*l,m+=1,p+=1,u=u*m*t+p,u===0&&(u=n),a=p+m*t/a,a===0&&(a=n),u=1/u,l=a*u,o*=l,c+=2;while(c<100&&Math.abs(l-1)>r);return o}function Cw(e,t){let r=Math.pow(2,-52),n=1e-300,i=1,s=t+1-e,o=i/s,a=i/n,u=1/s,c=2,l=0,p=s;do{let f=-(c-1)*(c-e-1);p+=2,u=u*f+p,u===0&&(u=n),a=p+f/a,a===0&&(a=n),u=1/u,l=a*u,o*=l,c+=1}while(c<100&&Math.abs(l-1)>r);return o}function Nw(e,t){let r=t/e,n=OT(t-e)*Math.sqrt(2*Bl(1,r)),i=[1,-.3333333333333333,.08333333333333333,-.014814814814814815,.0011574074074074073,.0003527336860670194,-.0001787551440329218,3919263178522438e-20,-2185448510679992e-21,-185406221071516e-20,8296711340953087e-22,-17665952736826078e-23,6707853543401498e-24,10261809784240309e-24,-4382036018453353e-24,914769958223679e-24,-25514193994946248e-27,-5830772132550426e-26,24361948020667415e-27,-50276692801141755e-28,11004392031956135e-29,3371763262400985e-28,-1392388722418162e-28,28534893807047445e-30,-5139111834242572e-31,-19752288294349442e-31,8099521156704561e-31],s=i.length-2,o=0,a=0,u=0,c=0;for(;s>=0;s--)u=(s+2)*o/e+i[s+1],c=n*c+u,o=a,a=u;if(c=e/(e+o)*c,t<e){let l=Math.exp(-.5*e*n*n)*(.5*Ia(-n*Math.sqrt(e/2))-c/Math.sqrt(2*Math.PI*e));return isFinite(l)?1-l:1}else{let l=Math.exp(-.5*e*n*n)*(.5*Ia(n*Math.sqrt(e/2))+c/Math.sqrt(2*Math.PI*e));return isFinite(l)?l:0}}function bD(e,t,r){return(e-t)/(Math.SQRT2*Math.abs(r))}function vf(e){return e<0?.5*Math.exp(-e*e)*Ia(-e):1-.5*Math.exp(-e*e)*Ia(e)}function Aw(e,t,r,n){let i=bD(t,r,n);if(e===-1/0)return vf(i);let s=bD(e,r,n);return s>0&&i>0?vf(-s)-vf(-i):vf(i)-vf(s)}function NT(e,t,r){return 1/Math.sqrt(2*Math.PI*r*r)*Math.exp(-(e-t)*(e-t)/(2*r*r))}function AT(e){let t=TD.spy(e),r=parseInt(t.slice(0,8),16)&2097151,n=parseInt(t.slice(8,16),16);return(r*4294967296+n)/9007199254740992}function zD(e,t){for(let r=t.length-1;r>0;r--){let n=e+\"::sc\"+r,i=Math.floor(AT(n)*(r+1)),s=t[r];t[r]=t[i],t[i]=s}}function _w(e,t){let r=t.slice();return zD(e,r),r}function _T(e,t){let r=[];for(let n=0;n<t;n++)r.push(n);return zD(e,r),r}function cu(e,t,r){return AT(e)*(r-t)+t}function Lw(e,t,r){let n=0,i,s,o,a;do i=e+\"::sc\"+n,n+=1,s=cu(i,0,1)*2-1,i=e+\"::sc\"+n,n+=1,o=cu(i,0,1)*2-1,a=s*s+o*o;while(a>=1||a===0);let u=Math.sqrt(-2*Math.log(a)/a);return t+r*s*u}function ww(e,t){if(t<=0)return NaN;let r=0,n,i,s,o;do n=e+\"::sc\"+r,r+=1,i=cu(n,0,1)*2-1,n=e+\"::sc\"+r,r+=1,s=cu(n,0,1)*2-1,o=i*i+s*s;while(o>1);let a=i*i/o,u=t*(Math.pow(o,-2/t)-1);return n=e+\"::sc\"+r,r+=1,(cu(n,0,1)<.5?-1:1)*Math.sqrt(a*u)}function Fw(e,t,r){return t=on(Math.round(t),0,1/0),t===1/0?NaN:(r=on(r,0,1),HD(cu(e,0,1),t,r))}function Vw(e,t){return t<0?NaN:kD(cu(e,0,1),t)}function cy(e,t,r){return e>=t?1:e<0?0:e<Math.floor((t+1)*r)?xD(e,t,r):1-xD(t-e-1,t,1-r)}function xD(e,t,r){let n=(1-r)/r,i=Py(e,t,r),s=i;for(;e>0&&(i*=e/(t-e+1)*n,s+i!==s);e--)s+=i;return s}function Bw(e,t,r,n){return r=on(Math.round(r),0,1/0),r===1/0?NaN:(n=on(n,0,1),t<0?0:(e=Math.ceil(e),t=Math.floor(t),e===-1/0?cy(t,r,n):cy(t,r,n)-cy(e-1,r,n)))}function Py(e,t,r){if(e=Math.round(e),t=on(Math.round(t),0,1/0),t===1/0)return NaN;if(r=on(r,0,1),e<0||e>t)return 0;if(r===0)return e===0?1:0;if(r===1)return e===t?1:0;if(e===0)return Math.exp(t*Of(-r));if(e===t)return Math.pow(r,t);let n=is(t)-is(e)-is(t-e)-Bl(e,t*r)-Bl(t-e,t*(1-r),t*r-e);return Math.exp(n)*Math.sqrt(t/(2*Math.PI*e*(t-e)))}function Gl(e,t){return t<0?NaN:(e=Math.round(e),e<0?0:t===0?e===0?1:0:e===0?Math.exp(-t):Math.exp(-is(e)-Bl(e,t))/Math.sqrt(2*Math.PI*e))}function Df(e,t){if(isNaN(e)||isNaN(t))return NaN;if(e===1/0)return 1;if(e=Math.floor(e),e<0)return 0;if(t===0)return 1;if(e+1>12&&2.35*(e+1)>t&&.3*(e+1)<t)return Nw(e+1,t);if(e+1>=t){let r=Rw(e+1,t);return isFinite(r)?1-t*Gl(e,t)*r:1}else{let r=Cw(e+1,t);return isFinite(r)?t*Gl(e,t)*r:0}}function Gw(e,t,r){return r<0?NaN:(e=Math.ceil(e),t=Math.floor(t),t<0?0:e===-1/0?Df(t,r):Df(t,r)-Df(e-1,r))}function LT(e,t,r){return r<=t?NaN:e<t||e>r?0:1/(r-t)}function PD(e,t,r){return r<=t?NaN:e<t?0:e>r?1:(e-t)/(r-t)}function zw(e,t,r,n){return PD(t,r,n)-PD(e,r,n)}function kw(e){let t=-e*e;return t<-750?e>=0?1:-1:e>=.065?1-Math.exp(t)*Ia(e):e<=-.065?Math.exp(t)*Ia(-e)-1:e*(1.1283791670955126+t*(.37612638903183754+t*(.11283791670955126+t*(.026866170645131252+t*.005223977625442188))))}function Ia(e){let t=.9999999999999999,r=2.224574423459406,n=2.444115549920689,i=1.7057986861852539,s=.8257463703357973,o=.28647031042892007,a=.07124513844341643,u=.012296749268608364,c=.001347817214557592,l=7263959403471071e-20,p=1,f=3.352953590554884,m=5.227518529742423,g=5.003720878235473,y=3.266590890998987,d=1.5255421920765353,h=.5185887413188858,b=.12747319185915415,x=.02185979575963238,P=.0023889438122503674,E=.00012875032817508128;if(e<0)return e<-6.1?2*Math.exp(e*e):2*Math.exp(e*e)-Ia(-e);if(e>50){let M=.5641895835477563,I=e*e;return e>5e7?M/e:M*(I*(I+4.5)+2)/(e*(I*(I+5)+3.75))}else{let M=t+e*(r+e*(n+e*(i+e*(s+e*(o+e*(a+e*(u+e*(c+e*l)))))))),I=p+e*(f+e*(m+e*(g+e*(y+e*(d+e*(h+e*(b+e*(x+e*(P+e*E)))))))));return M/I}}function wT(e){let t=-39.6968302866538,r=220.946098424521,n=-275.928510446969,i=138.357751867269,s=-30.6647980661472,o=2.50662827745924,a=-54.4760987982241,u=161.585836858041,c=-155.698979859887,l=66.8013118877197,p=-13.2806815528857,f=-.00778489400243029,m=-.322396458041136,g=-2.40075827716184,y=-2.54973253934373,d=4.37466414146497,h=2.93816398269878,b=.00778469570904146,x=.32246712907004,P=2.445134137143,E=3.75440866190742,M=.02425,I,D,O;return e>.5?-wT(1-e):e===.5?0:e<0?NaN:e===0?-1/0:(e<M?(I=Math.sqrt(-2*Math.log(e)),O=(((((f*I+m)*I+g)*I+y)*I+d)*I+h)/((((b*I+x)*I+P)*I+E)*I+1)):(I=e-.5,D=I*I,O=(((((t*D+r)*D+n)*D+i)*D+s)*D+o)*I/(((((a*D+u)*D+c)*D+l)*D+p)*D+1)),O-Math.sqrt(2*Math.PI)*(.5*Ia(-O/Math.SQRT2)-Math.exp(.5*O*O)*e))}function kD(e,t){if(t<0||e<0||e>1)return NaN;if(t===0||e===0)return 0;if(e===1)return 1/0;let r=-1,n=Math.ceil(t);for(;Df(n,t)<e;)n=2*n;let i=Math.floor(r+(n-r)/2);for(;r<i&&i<n;)Df(i,t)<e?r=i:n=i,i=Math.floor(r+(n-r)/2);return n}function HD(e,t,r){if(t!==Math.round(t))return NaN;if(r<0||r>1)return NaN;if(e<0||e>1)return NaN;if(e===0)return 0;if(e===1)return t;if(t===0)return 0;if(r===1)return t;if(r===0)return 0;let n=-1,i=t,s=Math.floor(n+(i-n)/2);for(;n<s&&s<i;)cy(s,t,r)<e?n=s:i=s,s=Math.floor(n+(i-n)/2);return i}function UD(e,t){if(isNaN(t)||t<=0||e<0||e>1)return NaN;if(e===0)return-1/0;if(e===1)return 1/0;if(t===1||t===2||t===4)return IT(t,e);let r,n;if(e===.5)return 0;if(e>.5)r=t>1?wT(e):IT(1,e),n=t>1?IT(1,e):Math.pow(xy(0,t)*Math.pow(t,(t-1)/2)/(1-e),1/t);else return-UD(1-e,t);return Hw(t,e,r,n)}function IT(e,t){let r=4*t*(1-t);switch(e){case 1:return Math.tan(Math.PI*(t-.5));case 2:return 2*(t-.5)*Math.sqrt(2/r);case 4:let n=Math.cos(Math.acos(Math.sqrt(r))/3)/Math.sqrt(r);return OT(t-.5)*2*Math.sqrt(n-1);default:throw new Error(\"_invTSimple() must be called with 1, 2, or 4 df.\")}}function Hw(e,t,r,n){if(!isFinite(r)||!isFinite(n))return NaN;let i=r,s=n;for(;;){let o=ns(i,s),a=Tc(e,o);if(o===i||o===s)return a>t?i:s;a<t?i=o:s=o}}function Uw(e,t,r){return e<0||e>1||r<=t?NaN:e===0?t:e===1?r:t+e*(r-t)}function qD(e,t){let r=py(e);return(jo(e)-t)*Math.sqrt(e.length)/r}function $D(e,t){let r=e.length,n=jo(e),i=py(e),s=t.length,o=jo(t),a=py(t),u=Math.sqrt(((r-1)*i*i+(s-1)*a*a)/(r+s-2));return(n-o)/(u*Math.sqrt(1/r+1/s))}function Fl(e,t,r){return r<0?uy(-1/0,e,t):r>0?uy(-1/0,-e,t):2*uy(-1/0,-Math.abs(e),t)}function FT(e,t){arguments.length===1&&(t=0);let r=qD(e,t),n=e.length-1;return{lessThan:Fl(r,n,-1),greaterThan:Fl(r,n,1),notEqual:Fl(r,n,0)}}function VT(e,t){let r=$D(e,t),n=e.length+t.length-2;return{lessThan:Fl(r,n,-1),greaterThan:Fl(r,n,1),notEqual:Fl(r,n,0)}}function BT(e){return{min:YD(e),q1:Ic(e,1),median:WD(e),q3:Ic(e,3),max:XD(e)}}function qw(e){return e.length}function YD(e){if(e.length<1)return NaN;let t=e[0];if(isNaN(t))return NaN;for(let r=1;r<e.length;r++){if(isNaN(e[r]))return NaN;e[r]<t&&(t=e[r])}return t}function XD(e){if(e.length<1)return NaN;let t=e[0];if(isNaN(t))return NaN;for(let r=1;r<e.length;r++){if(isNaN(e[r]))return NaN;e[r]>=t&&(t=e[r])}return t}function ZD(e,t){if(!isFinite(t)||t<0||t>1)return NaN;if(e.some(isNaN))return NaN;if(e.length===0)return NaN;let r=e.length,n=Ec(e),i=t*(r-1);return Math.floor(i)===i?e[n[i]]:(Math.ceil(i)-i)*e[n[Math.floor(i)]]+(i-Math.floor(i))*e[n[Math.ceil(i)]]}function Ic(e,t){if(!isFinite(t)||t<0||t>4)return NaN;if(e.some(isNaN))return NaN;let r=Ec(e),n=Ty(e,t),i=Math.floor(n),s=Math.ceil(n);return(e[r[i]]+e[r[s]])/2}function Ec(e){let t=e.length,r=[];for(let n=0;n<t;n++)r.push(n);return r.sort(function(n,i){return Y(Ki(e[n],e[i]))}),r}function Ty(e,t){t=Math.round(t);let r=e.length,n=r%2===1,i;return r===1?0:(t===0&&(i=0),t===2&&(i=(r-1)/2),t===4&&(i=r-1),t===1&&(i=n?(r+1)/4-1:(r+2)/4-1),t===3&&(i=n?(3*r+3)/4-1:(3*r+2)/4-1),i===void 0?NaN:i)}function $w(e,t){return Ec(e)[Math.ceil(t*(e.length-1))]+1}function Yw(e,t){return Ec(e)[Math.floor(t*(e.length-1))]+1}function Xw(e,t){return Ec(e)[Math.ceil(Ty(e,t))]+1}function Zw(e,t){return Ec(e)[Math.floor(Ty(e,t))]+1}function WD(e){return ZD(e,.5)}function Ww(e){if(e.length<1)return 0;let t=e[0];if(isNaN(t))return 0;let r=0;for(let n=1;n<e.length;n++){if(isNaN(e[n]))return 0;e[n]<t&&(r=n,t=e[n])}return r+1}function jw(e){if(e.length<1)return 0;let t=e[0];if(isNaN(t))return 0;let r=0;for(let n=1;n<e.length;n++)if(e[n]>=t){if(isNaN(e[n]))return 0;r=n,t=e[n]}return r+1}function Cf(e){let t=jo(e),r=0;for(let n=0;n<e.length;n++){let i=e[n]-t;r+=i*i}return r/e.length}function Jw(e){let t=jo(e),r=0;for(let n=0;n<e.length;n++)r+=Math.abs(e[n]-t);return r/e.length}function jD(e){let t=e.length;return Cf(e)*t/(t-1)}function JD(e,t){let r=Math.min(e.length,t.length);e.length!==r&&(e=e.slice(0,r)),t.length!==r&&(t=t.slice(0,r));let n=jo(e),i=jo(t),s=0;for(let o=0;o<r;o++)s+=(e[o]-n)*(t[o]-i);return s/r}function Qw(e,t){let r=Math.min(e.length,t.length);return JD(e,t)*r/(r-1)}function Iy(e,t){let r=Math.min(e.length,t.length);e.length!==r&&(e=e.slice(0,r)),t.length!==r&&(t=t.slice(0,r));let n=jo(e),i=jo(t),s=0,o=0,a=0;for(let u=0;u<r;u++){let c=e[u]-n,l=t[u]-i;s+=c*c,o+=l*l,a+=c*l}return a/Math.sqrt(s*o)}function GT(e,t,r,n){let i=e[0];for(let o=2;o<e.length;o++){let a=Y(es(Ki(e[o],i),r));if(!wi(a,o,10))return 0}let s=Y(n);for(let o=0;o<t.length-1;o++){let a=Y(es(Ki(t[o],i),r));if(!wi(a,s-t.length+o,10))return 0}return!isFinite(s)||s<e.length||s<t.length?0:s}function zT(e){return e<0||!isFinite(e)?0:e}function vT(e){let t=e.length;if(t===0)return[];let r=[],n=[];for(let a=0;a<t;a++)n.push([e[a],a]);n.sort(function(a,u){let c=a[0],l=u[0];return c===1/0&&l===1/0||c===-1/0&&l===-1/0?0:c-l});let i=0,s=1,o=1;for(;i<t;){let a=i;for(;a<t-1&&n[a][0]===n[a+1][0];)a+=1;o=a-i+1;let u;for(a=0;a<o;a++)u=n[i+a][1],r[u]=isNaN(e[u])?NaN:s+.5*(o-1);s+=o,i+=o}return r}function Kw(e,t){let r=Math.min(e.length,t.length);return e.length!==r&&(e=e.slice(0,r)),t.length!==r&&(t=t.slice(0,r)),Iy(vT(e),vT(t))}function py(e){return Math.sqrt(jD(e))}function eF(e){return Math.sqrt(Cf(e))}var tF=If;function zl(e,t){return go(t[0]-e[0],t[1]-e[1])}function rF(e,t){return go(t[0]-e[0],go(t[1]-e[1],t[2]-e[2]))}function QD(e,t,r){return[on(Math.round(e),0,255),on(Math.round(t),0,255),on(Math.round(r),0,255)]}function nF(e,t,r){isFinite(e)||(e=0),t=on(t,0,1),r=on(r,0,1);let n=r*(1-t/2);n===0||n===1?t=0:t=(r-n)/Math.min(n,1-n);let{r:i,g:s,b:o}=Jm(e,t,n).rgb();return QD(i,s,o)}function iF(e){return e}function sF(e,t){return[e,t]}function oF(e,t,r){return[e,t,r]}function aF(e,t){return[e,t]}function uF(e){return e}function cF(e){let t=[];if(e.length===0)return[];for(let r=0;r<e.length-1;r++)t.push([e[r],e[r+1]]);return t.push([e[e.length-1],e[0]]),t}function kT(e){if(e.length==0)return 0;let t=[...e,e[0]];return mD(t)}function lF(e){let t=0;for(let r=0;r<e.length-1;r++){let[n,i]=e[r],[s,o]=e[r+1];t+=ls(s-n,o-i)}if(e.length>1){let[r,n]=e[e.length-1],[i,s]=e[0];t+=ls(i-r,s-n)}return t}function pF(e){let t=!1;for(let r=0;r<e.length;r++){let n=(r+1)%e.length;e[r][0]===e[n][0]&&e[r][1]===e[n][1]&&(t=!0)}return t?e.filter((r,n)=>{let i=e[n===0?e.length-1:n-1];return r[0]!==i[0]||r[1]!==i[1]}):e}function fF(e){let[t,r,n,i]=e;return[t,n>=0?r:r+n,n>=0?n:-n,i]}function KD(e,t,r){if(e.length===0)return[];e=pF(e);let n=yD([...e,e[0]]),i=[];for(let s=0;s<e.length;s++){let o=e[s>0?s-1:e.length-1],a=e[s],u=e[s<e.length-1?s+1:0],c=n[s]===1,l=AF(o,a,u,c?\"counterclockwise\":\"clockwise\",r);i.push(t?l:fF(l))}return i}function dF(e,t){return KD(e,!1,t)}function mF(e,t){return KD(e,!0,t)}function HT(e,t){return[e,t]}var yF=HT,gF=HT;function e1(e,t){let r=[t[0]-e[0],t[1]-e[1]],n=[e[0],e[1]];return t1(r,n)}function t1(e,t){return[e,t]}function hF(e){return e[0]}function bF(e){return e[1]}function xF(e,t){let r=[t[0]-e[0],t[1]-e[1],t[2]-e[2]],n=[e[0],e[1],e[2]];return r1(r,n)}function r1(e,t){return[e,t]}function PF(e){return e[0]}function TF(e){return e[1]}function IF(e){return e}function EF(e,t){return[e,t]}function MF(e){return e[0]}function vF(e){return e[1]}function DF(e,t,r){return[e,t,r]}function Ul([e,t,r]){let[n,i]=e,[s,o]=t,[a,u]=r,c=s*s+o*o,l=(n*n+i*i-c)/2,p=(c-a*a-u*u)/2,f=(n-s)*(o-u)-(s-a)*(i-o);f=1/f;let m=(l*(o-u)-p*(i-o))*f,g=((n-s)*p-(s-a)*l)*f;return[m,g]}function ql(e){let[[t,r],[n,i],[s,o]]=e,a=n-t,u=i-r,c=s-n,l=o-i;return 2*Math.atan2(a*l-c*u,a*c+u*l)}function UT(e){let t=Math.abs(ql(e));return t<1e-9||t>2*Math.PI-1e-9}function n1(e){return Math.abs(e)===Math.PI?Math.PI:ND(e+Math.PI,2*Math.PI)-Math.PI}function i1(e,t,r,n){return[e,n1(t),r,n]}function SF([e,t,r,n]){return[e,t,r,n]}function OF(e){return e[2]}function RF(e){return e[3]}function s1(e){let[t,r,n,i]=e,s=Math.PI*2,o=n===0?s:n>0?n-s:n+s;return[t,r,o,i]}function CF(e){let[t,r,n,i]=s1(e);return[t,r,n,i]}function NF(e){let[t,r,n,i]=e,s=n>=0?Math.PI-n:-Math.PI-n;return[t,n1(r+n),s,i]}function AF(e,t,r,n,i){let s=e[0]-t[0],o=e[1]-t[1],a=r[0]-t[0],u=r[1]-t[1],c=Math.atan2(o,s),l=Math.atan2(s*u-o*a,s*a+o*u),p=2*Math.PI;return n===\"clockwise\"?l-=l<0?0:p:n===\"counterclockwise\"&&(l+=l<0?p:0),i1(t,c,l,i)}function qT(e,t){let[[r,n],[i,s]]=e;return[[t*r,t*n],[t*i,t*s]]}var _F=qT,LF=qT;function wF(e,t){let[[r,n],i]=e;return[[t*r,t*n],t*i]}function FF(e,t){let[[r,n],[i,s],[o,a]]=e;return[[t*r,t*n],[t*i,t*s],[t*o,t*a]]}function VF(e,t){let[[r,n],i,s,o]=e;return[[t*r,t*n],t*i,t*s,o]}function $T(e,t){let[[r,n],[i,s]]=e,[[o,a],[u,c]]=t;return[[r+o,n+a],[i+u,s+c]]}function BF(e,t){let[[r,n,i],[s,o,a]]=e,[[u,c,l],[p,f,m]]=t;return[[r+u,n+c,i+l],[s+p,o+f,a+m]]}var GF=$T,zF=$T;function kF(e,t){let[[r,n],i]=e,[[s,o],a]=t;return[[r+s,n+o],i+a]}function HF(e,t){let[[r,n],[i,s],[o,a]]=e,[[u,c],[l,p],[f,m]]=t;return[[r+u,n+c],[i+l,s+p],[o+f,a+m]]}function UF(e,t){let[[r,n],i,s,o]=e,[[a,u],c,l]=t;return[[r+a,n+u],i+c,s+l,o]}function YT(e,t){let[[r,n],[i,s]]=e;return[(1-t)*r+t*i,(1-t)*n+t*s]}function XT(e,t){return YT(e,on(t,0,1))}function qF(e,t){t=on(t,0,1);let[[r,n,i],[s,o,a]]=e;return[(1-t)*r+t*s,(1-t)*n+t*o,(1-t)*i+t*a]}function DT(e,t){return YT(e,on(t,0,1/0))}function $F(e,t){let[[r,n],i]=e,s=Math.min(1,Math.max(0,t));return[r+i*Math.cos(2*Math.PI*s),n+i*Math.sin(2*Math.PI*s)]}function o1(e,t){let r=Ey(e);if(!r)return[NaN,NaN];if(r.type===\"segment\")return XT([e[0],e[2]],t);if(r.type===\"rays\")return t<=0?DT([r.start1,r.end1],-t):t>=1?DT([r.start2,r.end2],t-1):[NaN,NaN];t=Math.min(1,Math.max(0,t));let n=Ul(e),i=ql(e),s=Math.atan2(e[0][1]-n[1],e[0][0]-n[0]),o=zl(n,e[0]),a=s+t*i;return[n[0]+o*Math.cos(a),n[1]+o*Math.sin(a)]}function YF(e,t){if(isNaN(t))return[NaN,NaN];if(t<0||t>=e.length)return e[0];let r=Math.floor(t);return XT([e[r],e[(r+1)%e.length]],t-r)}function Ey(e){let[t,r,n]=e,[[i,s],[o,a],[u,c]]=[t,r,n];if(isNaN(i)||isNaN(s)||isNaN(o)||isNaN(a)||isNaN(u)||isNaN(c))return;let l=Ul([t,r,n]),p=zl(l,t);if(isFinite(p)&&!UT([t,r,n])){let f=Math.atan2(t[1]-l[1],t[0]-l[0]),m=f+ql([t,r,n]);return{type:\"arc\",center:l,radius:p,startAngle:f,endAngle:m}}else{let f=Ls(o,a,0,i,s,0,u,c,0);return f<0||f>1?{type:\"rays\",start1:[i,s],end1:[i+(i-u),s+(s-c)],start2:[u,c],end2:[u+(u-i),c+(c-s)]}:{type:\"segment\",start:[i,s],end:[u,c]}}}function XF(e,t,r){let i=zl(e,t);if(i>1e-9)return t;let s=zl(e,r);return s>1e-9?r:isNaN(i)&&isNaN(s)?[NaN,NaN]:e}function Sf(e,t){let[[r,n],i]=e,[[s,o],a]=t,u=go(s-r,o-n),c=i+a,l=i-a,p=u*u,f=Math.sqrt((u+c)*(-u+c)*(u-l)*(u+l))/4,m=i*i,g=a*a;return[(s+r)/2+(s-r)*(m-g)/(2*p)+-2*(o-n)*f/p,(o+n)/2+(o-n)*(m-g)/(2*p)+2*(s-r)*f/p]}function a1(e,t,r){let[[n,i],s]=e,[[o,a],[u,c]]=t,l=o-n,p=u-n,f=a-i,m=c-i,g=p-l,y=m-f,d=g*g+y*y,h=l*m-p*f,b=s*s*d-h*h;if(b<0)return[NaN,NaN];let x=Math.sqrt(b);return x<0?[NaN,NaN]:[n+(h*y+r*g*x)/d,i+(-h*g+r*y*x)/d]}function ZF(e,t){let[[r,n],[i,s]]=e,[[o,a],[u,c]]=t,l=s-n,p=r-i,f=c-a,m=o-u,g=l*r+p*n,y=f*o+m*a,d=l*m-f*p;return d===0?[NaN,NaN]:[(m*g-p*y)/d,(l*y-f*g)/d]}function ZT(e,t,r=0){let n=a1(t,e,-1);return Hl(n,e,r,!0)?n:[NaN,NaN]}function WT(e,t,r=0){let n=a1(e,t,1);return Hl(n,t,r,!1)?n:[NaN,NaN]}function u1(e,t,r=0){let n=ZF(e,t);return!Hl(n,e,r,!0)||!Hl(n,t,r,!1)?[NaN,NaN]:n}function WF(e,t,r=0){let n=p1(t,e,r,-1);return kl(n,t,r,!1)?n:[NaN,NaN]}function c1(e,t,r=0){let n=f1(t,e,r,-1);return!Hl(n,e,r,!0)||!kl(n,t,r,!1)?[NaN,NaN]:n}function jF(e,t,r=0){let n=p1(e,t,r,1);return kl(n,e,r,!0)?n:[NaN,NaN]}function l1(e,t,r=0){let n=f1(e,t,r,1);return!kl(n,e,r,!0)||!Hl(n,t,r,!1)?[NaN,NaN]:n}function JF(e,t,r=0){let n=QF(e,t,r);return!kl(n,e,r,!0)||!kl(n,t,r,!1)?[NaN,NaN]:n}function QF(e,t,r){let n=dy(e);if(my(n))return c1(n,t,r);let i=dy(t);return my(i)?l1(e,i,r):jT(()=>Sf(n,i),()=>Sf(i,n),s=>JT(-1,fy(e,s),fy(t,s)))}function p1(e,t,r,n){let i=dy(e);return my(i)?n>0?WT(t,i,r):ZT(i,t,r):jT(()=>Sf(i,t),()=>Sf(t,i),s=>JT(n,fy(e,s),KF(t,s)))}function f1(e,t,r,n){let i=dy(e);return my(i)?u1(i,t,r):jT(()=>WT(i,t,r),()=>ZT(t,i,r),s=>JT(n,fy(e,s),eV(t)))}function jT(e,t,r){let n=e();if(r(n))return n;let i=t();return r(i)?i:[NaN,NaN]}function JT(e,t,r){return e*d1(t,r)>0}function fy(e,[t,r]){let[n,i]=Ul(e);return ql(e)>0?[i-r,t-n]:[r-i,n-t]}function KF([[e,t]],[r,n]){return[t-n,r-e]}function eV([[e,t],[r,n]]){return[r-e,n-t]}function dy(e){let t=Ul(e),r=zl(t,o1(e,0));return isFinite(r)&&!UT(e)?[t,r]:[e[0],e[2]]}function my(e){return Array.isArray(e[1])}function kl([e,t],r,n,i){let[s,o]=Ul(r);return(i?(n&3)===0:(n&12)===0)||Sd(Math.atan2(t-o,e-s),Math.atan2(r[0][1]-o,r[0][0]-s),ql(r))}function Hl([e,t],[[r,n],[i,s]],o,a){let u=Ls(e,t,0,r,n,0,i,s,0),[c,l]=a?[(o&1)===0,(o&2)===0]:[(o&4)===0,(o&8)===0];return!isNaN(u)&&(u>=0||c)&&(u<=1||l)}function tV(e,t){let[[r,n],[i,s]]=e,[o,a]=t;return[[o,a],[o+(i-r),a+(s-n)]]}function rV(e,t){let[[r,n],[i,s]]=e,[o,a]=t;return[[o,a],[o+(s-n),a-(i-r)]]}function d1(e,t){let[r,n]=e,[i,s]=t;return r*s-i*n}function nV(e,t){let[r,n]=e,[i,s]=t;return r*i+n*s}function iV(e){let[t,r]=e;return[-r,t]}function sV(e,t,r){return[e,t,r]}function oV(e){return[[1,0],e,!1]}function aV(e,t){let[r,n]=e;return[[t,0],[(1-t)*r,(1-t)*n],!1]}function uV(e,t){let[r,n]=e,i=Math.cos(t),s=Math.sin(t);return[[i,s],[r*(1-i)+n*s,n*(1-i)-r*s],!1]}function cV(e){let[[t,r],[n,i]]=e,s=n-t,o=i-r,a=s*s+o*o;return[[(s*s-o*o)/a,2*s*o/a],[(1-(s*s-o*o)/a)*t-2*s*o/a*r,(1+(s*s-o*o)/a)*r-2*s*o/a*t],!0]}function lV(e,t){let[[r,n],[i,s],o]=e,[[a,u],[c,l],p]=t;return o&&(u=-u,l=-l,p=!p),[[a*r-u*n,a*n+u*r],[i+r*c-n*l,s+r*l+n*c],p]}function pV(e){let[[t,r],[n,i],s]=e,o=t*t+r*r,a=t/o,u=-r/o,c=-(t/o*n+r/o*i),l=-(t/o*i-r/o*n);return s&&(u=-u,l=-l),[[a,u],[c,l],s]}function Wo(e,t){let[[r,n],[i,s],o]=e,[a,u]=t;return o&&(u=-u),[r*a-n*u+i,r*u+n*a+s]}function fV(e,t){let[r,n,i]=e;return i?-t:t}function My(e,t){let[r,n]=t;return[Wo(e,r),Wo(e,n)]}var dV=My,mV=My;function yV(e,t){let[r,n]=t,i=[n,[n[0]+r[0],n[1]+r[1]]],s=My(e,i);return e1(s[0],s[1])}function gV(e,t){let[r,n]=t,[[i,s]]=e;return[Wo(e,r),go(i,s)*n]}function hV(e,t){let[r,n,i]=t;return[Wo(e,r),Wo(e,n),Wo(e,i)]}function bV(e,t){let r=[];for(let n of t)r.push(Wo(e,n));return r}function xV(e,t){let[r,n,i]=t,s=Wo(e,r),[o,a,u]=e,[c,l]=Wo([o,[0,0],u],[Math.cos(n),Math.sin(n)]),p=Math.atan2(l,c),f=fV(e,i);return[s,p,f,t[3]]}function PV(e,t){let r=[];for(let n=0;n<Math.min(e.length,t.length);n++)t[n]&&r.push(e[n]);return r}function TV(e,t){let r=[];for(let n of t)r.push(e[n]);return r}function IV(e){let t=[],r={};for(let n=0;n<e.length;n++){let i=e[n],s=ST(i);r.hasOwnProperty(s)||(r[s]=!0,t.push(n))}return t}function EV(e,t){return[e,t]}function MV(e){return e[0]}function vV(e){return e[1]}function ST(e){if(Array.isArray(e))return`[${e.map(ST).join(\",\")}]`;switch(typeof e){case\"string\":return e;case\"boolean\":case\"number\":return e.toString();case\"object\":if(DV(e)){let r=[];for(let n in e.updateRules)r.push(`\"${n}\": ${ST(e.updateRules[n].value)}`);return`{${r.join(\",\")}}`}else return Y(e).toString();default:return e}}function DV(e){return typeof e!=\"object\"||!e?!1:e.type===\"Action\"}function SV(e){return e}function OV(e){return e}function qn(e){if(!bo(e))throw new Error(\"Programming error: expected an array but found \"+typeof e)}function bo(e){return Array.isArray(e)}function m1(e){if(bo(e))for(let{compiled:t}of e)t&&QT(t)}function TY(e){if(bo(e))for(let{compiled:t}of e)t&&RV(t)}function QT(e){delete e.fn}function RV(e){e.fn=Nf(e.args,e.source,e.constants,e.executionMetadata)}function Nf(e,t,r,n){let s=`var fn = (function(${e.join(\",\")}){\"use strict\"; ${t}});\nfn.__meta = __meta;\nreturn fn;\n`;return new Function(\"BuiltIn\",\"ErrorMsg\",\"_C\",\"__meta\",s)(ho,ir,r,n)}function ht(e){return e.type===1}function y1(e){if(!ht(e))throw new Error(`Programming error: expected constant instruction but found ${wn(e.type)} instead.`)}function g1(e){let t=e.getInstruction(e.getReturnIndex());if(t.type!==47)throw new Error(`Expected BlockVar, got ${t.type}`);let r=e.getInstruction(t.args[0]);if(r.type!==51)throw new Error(`Expected EndMap, got ${r.type}`);let n=W(t.valueType)?ze(t.valueType):t.valueType,i=e.getInstruction(r.args[0]);if(i.type!==50)throw new Error(`Expected BeginMap, got ${i.type}`);let s=[];for(let p of i.args){let f=e.getInstruction(p);if(!ht(f)||f.valueType!==T)throw ee(\"Programming error: interval bounds must be constant numbers\");s.push(Y(f.value))}let o,a;n===Wr||n===jr?(o=[\"t\"],a={type:\"1d\",min:s[0],max:s[1]}):(o=[\"u\",\"v\"],a={type:\"2d\",uMin:s[0],uMax:s[1],vMin:s[2],vMax:s[3]});let u=Xm(e),c=`\n  const mapFn = (function() {\n    \"use strict\";\n    ${u.source}\n  })();\n  return mapFn(${o.join(\",\")});\n`,l={};return{args:o,source:c,constants:u.constants,executionMetadata:l,fn:Nf(o,c,u.constants,l),domain:a}}function oi(e,t){let r=[],n=[];for(let i=0;i<t;i++)n.push(!1);n.push(!0);for(let i=t;i>=0;i--){if(!n[i])continue;let s=e.getInstruction(i);if(s.type===2)r.push({symbol:e.argNames[i],scope:\"free\"});else if(ni(s))switch(s.type){case 21:r.push({symbol:s.callData.indexSymbol,scope:\"integral\"});break;case 19:r.push({symbol:s.callData.indexSymbol,scope:s.callData.type});break;case 23:if(s.listComprehensionCallData)for(let a of s.listComprehensionCallData.inputListSymbols)r.push({symbol:a,scope:\"comprehension\"});break;case 50:for(let a of s.callData.parameterSymbols)r.push({symbol:a,scope:\"map\"});break;case 53:{let a=e.getInstruction(s.args[0]);for(let u of a.signature.parameterSymbols)r.push({symbol:u,scope:\"recursive-function\"});break}default:let o=s;throw new Error(`Programming Error: unexpected loop instruction ${o.type}`)}else s.type===3&&s.symbol&&r.push({symbol:s.symbol,scope:\"symbolic-var\"});if(!ve(s))for(let o of e.getDirectDependencies(s))n[o]=!0}return r.reverse()}function h1(e){if(e.isConstant())return;let t=[];for(let s=0;s<e.getReturnIndex();s++)e.getInstruction(s).type===44&&t.push(s);if(t.length===0)return;let r=Ii(e,e.getReturnIndex()),n=[];for(let s=0;s<e.argNames.length;s++)r[s]&&n.push(s);let i=uf(e,n,0,e.getReturnIndex());for(let s of t)if(r[s]&&i[s])throw NP(oi(e,s))}function CV(e){for(var t=0;t<this.length;t++)e(this.elementAt(t),t)}function NV(e){for(var t=[],r=0;r<this.length;r++)t.push(e(this.elementAt(r),r));return t}var dr=class e extends zt{constructor(r){super();this.isError=!1;this.eachElement=CV;this.mapElements=NV;if(r.getError())throw new Error(\"Programming error: IRExpression should not be constructed with an error chunk\");if(this._chunk=r,this.valueType=r.getReturnType(),this.addDependencies(r.getLiveArgNames()),this.isList=W(this.valueType),this.isList&&(this.length=this._chunk.getConstantListLength(),this.length===void 0))throw GP(r.getListLengthDependencies());h1(r);var n=r.isConstant();this.isConstant=n&&(this.valueType===T||this.valueType===Ee),this.isTypedConstant=n,this.isEmptyAction=n&&this.valueType===Ke&&Object.keys(r.asValue().updateRules).length===0}shouldExportAns(){return!0}getCompiledFunction(r){return pa(this.valueType)?g1(this._chunk):this._chunk.getCompiledFunction(r)}getRestrictedFunctionForGLSL(r,n){return this._chunk.getRestrictedFunctionForGLSL(r,n)}polynomialOrder(r){return this._chunk.polynomialOrder(r,{allowRestriction:!0,allowClosedBlockReferences:!1})}getPolynomialCoefficients(r){for(var n=this._chunk.getPolynomialCoefficients(r),i=n.chunk,s=n.coefficients,o=[],a=0;a<s.length;a++){var u=i.copy();u.setReturnIndex(s[a]),u.fuseBroadcast(),o.push(new e(u))}return o}takeDerivative(r){var n=this._chunk.copy().takeDerivative(r).fuseBroadcast();return new e(n)}gradient(r){var n=this._chunk.copy().gradient(r).fuseBroadcast();return new e(n)}toImplicitBool(){let r=this._chunk.copy();return r.GreaterEqual([r.getReturnIndex(),r.Constant(0)]),r.fuseBroadcast(),new e(r)}interpretWithParameters(r){let n,i=this._chunk.argNames;if(r.length===i.length)n=r;else{n=[];let s=this.getDependencies();for(let o=0,a=0;o<i.length;o++)s[a]===i[o]?(n.push(r[a]),a+=1):n.push(void 0)}return this._chunk.interpretWithParameters(n)}substituteConstantArguments(r){return new e(this._chunk.substituteConstantArguments(r))}boundDomain(r){return this._chunk.boundDomain(r)}asValue(){if(this._chunk.isConstant())return this._chunk.asValue();if(this.isList){for(var r=[],n=po(ri(ze(this.valueType))),i=0;i<this.length;i++)r.push(n);return r}else return po(ri(this.valueType))}asTypedValue(){return{valueType:this.valueType,value:this.asValue()}}asCompilerValue(){return this._chunk.asCompilerValue()}isNaN(){return typeof this.asValue()==\"number\"&&isNaN(this.asValue())}getEvaluationInfo(){return this._chunk.isConstant()&&this.getDependencies().length===0&&(ce(this.valueType,T)||ce(this.valueType,Ee))?[{val:this.asValue()}]:!1}findLinearSubset(r){return this._chunk.findLinearSubset(r)}deriveRegressionRestrictions(){var r=this._chunk.deriveRegressionRestrictions();return r===this._chunk?this:new e(r)}getCursorContext(){return this._chunk.getCursorContext()}};var lu=class extends Q{};var $l=class extends Q{};var pu=class extends Q{};var Yl=class extends Q{};var Xl=class extends Q{};var fu=class extends Q{};var Zl=class extends Q{};var Wl=class extends Q{};var jl=class extends Q{};var vy=class extends fu{};var Ts=class e extends Q{constructor(r,n,i,s){super([i]);this.specifiedArg=n;this.rhs=i;this.originalNode=s;if(this._symbol=r,this.userData=s.userData,this.metaData=s.metaData,this._inputSpan=s._inputSpan,n.valid)this.ref=`_base_case_${r}_${n.argIndex}_${n.argValue}`,this._exports=[this.ref];else{let o=this._exports.find(a=>a.indexOf(\"idref\")!==-1);o&&(this.ref=o)}}static fromEquation(r,n){let i=n._lhs;if(!(i instanceof lr))return;let s=r[i._symbol];if(!s||!(s instanceof In))return;if(i.args.length!==s._argSymbols.length)return new e(s._symbol,{valid:!1,error:Jr(`Function '${j(s._symbol)}' requires ${s._argSymbols.length} arguments.`)},n._rhs,n);let o;for(let a=0;a<i.args.length;a++){let u=i.args[a];if(u instanceof jt){if(o){o={valid:!1,error:Jr(\"A base case must specify the value for exactly one parameter.\")};break}o={valid:!0,argIndex:a,argValue:u.asValue()}}else if(u instanceof Fe){if(u._symbol!==s._argSymbols[a]){o={valid:!1,error:Jr(`Parameter mismatch in base case definition: expected '${j(s._argSymbols[a])}' but found '${j(u._symbol)}' instead.`)};break}}else{o={valid:!1,error:Jr(\"Each argument to a base case must be a plain number or a parameter name.\")};break}}if(o)return new e(s._symbol,o,n._rhs,n)}getRef(){return this.ref}asAssignment(){if(this.specifiedArg.valid){if(!this.ref)throw new Error(\"Programming error: expected ref to be set.\");let r=new lo(this.ref,this.rhs);return r.userData=this.userData,r.metaData=this.metaData,r._inputSpan=this._inputSpan,r}else return this.specifiedArg.error}};function pe(e,t){let r=cv(e);return r.prototype.type=t,r}var AV={Base:pe(zt,\"Base\"),Expression:pe(Q,\"Expression\"),Error:pe(R,\"Error\"),Constant:pe(jt,\"Constant\"),MixedNumber:pe(qd,\"MixedNumber\"),Identifier:pe(Fe,\"Identifier\"),Ans:pe($d,\"Ans\"),List:pe(ko,\"List\"),Range:pe(il,\"Range\"),ListAccess:pe(Ya,\"ListAccess\"),DotAccess:pe(Fi,\"DotAccess\"),Construction:pe(Ju,\"Construction\"),ParenSeq:pe(ts,\"ParenSeq\"),MovablePoint:pe(Yd,\"MovablePoint\"),NamedCoordinateAccess:pe(Qu,\"NamedCoordinateAccess\"),BareSeq:pe(Xa,\"BareSeq\"),Norm:pe(sl,\"Norm\"),BaseComparator:pe(ws,\"BaseComparator\"),ComparatorChain:pe(ja,\"ComparatorChain\"),DoubleInequality:pe(Am,\"DoubleInequality\"),RepeatedOperator:pe(Ja,\"RepeatedOperator\"),Sum:pe(gl,\"Sum\"),Product:pe(hl,\"Product\"),Integral:pe(bl,\"Integral\"),AssignmentExpression:pe(Qa,\"AssignmentExpression\"),ListComprehension:pe(ha,\"ListComprehension\"),FunctionCall:pe(lr,\"FunctionCall\"),RecursiveFunctionCall:pe(Bi,\"RecursiveFunctionCall\"),RecursiveFunctionBaseCase:pe(Ts,\"RecursiveFunctionBaseCase\"),SeededFunctionCall:pe(uc,\"SeededFunctionCall\"),FunctionExponent:pe(xl,\"FunctionExponent\"),FunctionFactorial:pe(Pl,\"FunctionFactorial\"),Prime:pe(cc,\"Prime\"),Piecewise:pe(dn,\"Piecewise\"),Restriction:pe(Tl,\"Restriction\"),Derivative:pe(lc,\"Derivative\"),UpdateRule:pe(Il,\"UpdateRule\"),Substitution:pe(Uo,\"Substitution\"),Histogram:pe(El,\"Histogram\"),DotPlot:pe(Ml,\"DotPlot\"),BoxPlot:pe(vl,\"BoxPlot\"),TTest:pe(Dl,\"TTest\"),IndependentTTest:pe(Sl,\"IndependentTTest\"),Stats:pe(Ol,\"Stats\"),Assignment:pe(lo,\"Assignment\"),CoordinateEquation:pe(_m,\"CoordinateEquation\"),FunctionDefinition:pe(In,\"FunctionDefinition\"),Equation:pe(Vs,\"Equation\"),Regression:pe(Lm,\"Regression\"),Image:pe(wm,\"Image\"),Ticker:pe(Fm,\"Ticker\"),Slider:pe(Vm,\"Slider\"),RegressionParameter:pe(pc,\"RegressionParameter\"),Table:pe(Bm,\"Table\"),TableColumn:pe(fc,\"TableColumn\"),SolvedEquation:pe(Gm,\"SolvedEquation\"),OptimizedRegression:pe(zm,\"OptimizedRegression\"),Seed:pe(dc,\"Seed\"),ExtendSeed:pe(mc,\"ExtendSeed\"),IRExpression:pe(dr,\"IRExpression\"),Add:pe(lu,\"Add\"),Subtract:pe(Tn,\"Subtract\"),Multiply:pe($l,\"Multiply\"),DotMultiply:pe(pu,\"DotMultiply\"),CrossMultiply:pe(Yl,\"CrossMultiply\"),Divide:pe(Xl,\"Divide\"),Exponent:pe(fu,\"Exponent\"),Negative:pe(Zl,\"Negative\"),Or:pe(Wl,\"Or\"),PercentOf:pe(jl,\"PercentOf\"),RawExponent:pe(vy,\"RawExponent\"),Comparator:{\"<\":pe(Ti[\"<\"],\"Comparator['<']\"),\">\":pe(Ti[\">\"],\"Comparator['>']\"),\"<=\":pe(Ti[\"<=\"],\"Comparator['<=']\"),\">=\":pe(Ti[\">=\"],\"Comparator['>=']\"),\"=\":pe(Ti[\"=\"],\"Comparator['=']\")}},v=AV;var mn={xmin:-5,xmax:5,ymin:-5,ymax:5,zmin:-5,zmax:5};function eI(e,t){let r=Math.round(1e6*e)/1e6;return Math.abs(r-e)<t?r:e}function zX(e){let t=!0,r=!0,n=!0;return e.hardMin!==void 0&&e.target<e.hardMin&&(t=!1),e.hardMax!==void 0&&e.target>e.hardMax&&(r=!1),e.step&&Dy({target:e.target,step:e.step,hardMin:t?e.hardMin:void 0,hardMax:r?e.hardMax:void 0})!==e.target&&(n=!1),{min:t,max:r,step:n}}function Dy(e){let{target:t,hardMin:r,hardMax:n,step:i}=e,s=1e-10;if(r!==void 0&&n!==void 0&&(s=Math.min(s,Math.abs(n-r)/1e3)),i&&(s=Math.min(s,i/10)),r!==void 0&&(r=eI(r,s)),n!==void 0&&(n=eI(n,s)),e.forceSliderToMax&&n!==void 0&&(t=n),r>n||t<=r)return r;if(t>=n)return n;if(i){let u=r!==void 0?r:0;var o=Math.round((t-u)/i);t=i*o+u}let a=eI(t,s);return(i||r===a||n===a)&&(t=a),t<=r?r:t>=n?n:t}function b1(e){let{storedMax:t,sliderValue:r,hardMin:n,step:i}=e,s=e.is3d?mn.xmax:10;if(t>s&&(s=t),r>s&&(s=r),n>s&&(s=n),i){let o=Dy({target:s,hardMin:n,hardMax:void 0,step:i});o>=s?s=o:s=o+i}return s}var rI=v.Constant,LV=v.Identifier;v.Base.prototype.tryGetConcreteTree=function(e,t,r={}){var n;try{n=this.getConcreteTree(e,t,r)}catch(i){i instanceof v.Base?n=i:n=ee(i)}return n};v.Base.prototype.getConcreteTree=function(e,t,r={}){var i;var n=this.buildIRExpression(e,t,{selection:(i=this.parseOptions)==null?void 0:i.selection,coerceToNumber:r.coerceToNumber});if(n.isError)throw n;return n};v.DoubleInequality.prototype.getConcreteTree=function(e,t){return new this.constructor([new v.Piecewise([this._indicator,this._expressions[0],new rI(NaN)]).getConcreteTree(e,t),this._operators[0],new LV(this._symbol),this._operators[1],new v.Piecewise([this._indicator,this._expressions[1],new rI(NaN)]).getConcreteTree(e,t)])};v.Error.prototype.getConcreteTree=function(e,t){return this};function Af(e,t){return e.isError?e:t.indexOf(e.valueType)===-1?_p():e}v.Image.prototype.getConcreteTree=function(e,t){var r=this.center.tryGetConcreteTree(e,t),n=this.radianAngle.tryGetConcreteTree(e,t),i=this.width.tryGetConcreteTree(e,t),s=this.height.tryGetConcreteTree(e,t),o=this.opacity.tryGetConcreteTree(e,t),a=[C,xt,Xe],u=[T,le,Xe];return r=Af(r,a),n=Af(n,u),i=Af(i,u),s=Af(s,u),o=Af(o,u),new v.Image({center:r,radianAngle:n,width:i,height:s,opacity:o},this.moveStrategy)};v.Ticker.prototype.getConcreteTree=function(e,t){var r=this.handler.tryGetConcreteTree(e,t);!r.isError&&r.valueType!==Ke&&(r=zp(ne(r.valueType)));var n=r.getDependencies().filter(function(i){return!(e.graphingEnabled()&&e.validActionVariable(i))});return n.length&&(r=ar(e.sliderVariables(n)).setDependencies(n)),new v.Ticker({handler:r,minStep:this.minStep.tryGetConcreteTree(e,t)})};function tI(e,t,r){if(!t){r.valids[e]=!0;return}var n=t.getDependencies();if(t.isError)r.errors[e]=!0;else if(n.length>0){r.errors[e]=!0;for(var i=0;i<n.length;i++)n[i]===r.exportedSymbol?r.errors.cycle=!0:r.missingVars.push(n[i])}else r.values[e]=+t.asValue();r.valids[e]=isFinite(r.values[e]),r.valids[e]||(r.values[e]=void 0)}function Sy(e){return e&&e.valueType===le&&e.length===1&&e.args?e.args[0]:e}v.Slider.prototype.getConcreteTree=function(e,t){var r=this._expression.getConcreteTree(e,t),n=Sy(this.sliderMin&&this.sliderMin.tryGetConcreteTree(e,t)),i=Sy(this.sliderMax&&this.sliderMax.tryGetConcreteTree(e,t)),s=Sy(this.sliderStep&&this.sliderStep.tryGetConcreteTree(e,t)),o={exportedSymbol:this._symbol,errors:{},values:{},valids:{},missingVars:[],errMsg:void 0};if(tI(\"min\",n,o),tI(\"max\",i,o),tI(\"step\",s,o),s&&o.valids.step&&(o.values.step===0?delete o.values.step:o.values.step=Math.abs(o.values.step)),o.errors.cycle?r=Fx(o.exportedSymbol):(o.errors.min||!o.valids.min?o.errMsg=Vx():o.errors.max||!o.valids.max?o.errMsg=Bx():(o.errors.step||!o.valids.step)&&(o.errMsg=zx()),o.values.min>o.values.max&&(o.valids.min=!1,o.valids.max=!1,o.errMsg||(o.errMsg=Gx()))),r.isConstant){var a=t.initialEvaluation&&t.initialEvaluation.asValue(),u=a&&this.sliderIsPlayingOnce,c=o.values.max,l=+r.asValue(),p=o.values.min,f=o.values.step;if(u&&!isFinite(c)){var m=Sy(this.sliderSoftMax&&this.sliderSoftMax.tryGetConcreteTree(e,t));m&&(c=b1({storedMax:+m.asValue(),sliderValue:l,step:f,hardMin:p,is3d:e.is3dProduct()}))}var g=Dy({target:l,hardMin:p,hardMax:c,step:f,forceSliderToMax:!!u}),y=Xu(g.toString()),d=isFinite(Y(y))?y:g;r=new rI(d).getConcreteTree(e,t)}return r.sliderInfo=o,r};function x1(e,t){if(!t[this._symbol])throw gs(this._symbol);var r=this.args.map(function(i){return i.getConcreteTree(e,t)});if(r.length>0){if(r.length===1&&r.push(new v.Constant(1).getConcreteTree(e,t)),r[1].getDependencies().length)throw Qp(this._symbol).setDependencies(r[1].getDependencies());if(r[1].valueType!==T)throw Qp(this._symbol);var n=r[1].asValue();if(!isFinite(n)||n<=0)throw Qp(this._symbol)}return this.typeCheck(e,r),new this.constructor(r)}v.Histogram.prototype.getConcreteTree=x1;v.DotPlot.prototype.getConcreteTree=x1;v.BoxPlot.prototype.getConcreteTree=function(e,t){if(!t[this._symbol])throw gs(this._symbol);var r=this.args.map(function(n){return n.getConcreteTree(e,t)});return this.typeCheck(e,r),r.length===1&&(r[0].valueType===le||r[0].valueType===Xe)?new this.constructor(r):ee(\"Failed to copmile BoxPlot\")};function nI(e,t){if(!t[this._symbol])throw gs(this._symbol);var r=this.args.map(function(n){return n.getConcreteTree(e,t)});return this.typeCheck(e,r),new this.constructor(r)}v.TTest.prototype.getConcreteTree=nI;v.IndependentTTest.prototype.getConcreteTree=nI;v.Stats.prototype.getConcreteTree=nI;v.Table.prototype.getConcreteTree=function(e,t){for(var r=[],n=Object.create(t),i=0;i<this.columns.length;i++){var s=this.columns[i].getConcreteTree(e,n);s.isIndependent&&this.columns[i].exportToLocal(e,s,n),r.push(s)}return new this.constructor(r)};v.TableColumn.prototype.getConcreteTree=function(e,t){var u;var r=this.header.getConcreteTree(e,t),n,i,s=this.header instanceof v.Identifier&&!t[this.header._symbol];if(s){n=[];for(var o=0;o<this.values.length;o++){if(this.values[o].tableError()){n.push(pl(this.values[o].tableError()));continue}var a=this.values[o].tryGetConcreteTree(e,t);a.isError?n.push(a):a.tableError()?n.push(pl(a.tableError())):a.valueType===T?n.push(a):n.push(Rb([ne(a.valueType)]))}return i=new this.constructor(r,n),i.isIndependent=!0,i}else return r.isList?n=r.mapElements(function(c){return c}):n=[],!r.isError&&r.valueType!==T&&r.valueType!==le&&r.valueType!==Xe&&(r=Ob([ne((u=r.valueType)!=null?u:vt)])),i=new this.constructor(r,n),i};function _f(e,t,r){return{symbolMap:e,symbolNodeMap:t,maxIndex:r}}function Oy(e,t){return e.symbolMap[t]}function P1(e,t){return e.symbolNodeMap[t]}function Kr(e,t,r,n){e.symbolNodeMap[t]=n,e.symbolMap[t]=r,e.maxIndex=Math.max(e.maxIndex,r)}function Gi(e){return _f(Object.create(e.symbolMap),Object.create(e.symbolNodeMap),e.maxIndex)}function iI(e,t,r){let n=e.getInstruction(r);if(!ve(n)){for(let o of n.args)if(!ht(e.getInstruction(o)))return!0}if(t<r)return!ht(e.getInstruction(t));let i=[!0];for(let o=r+1;o<=t;o++)i.push(!1);let s=[t];for(;s.length;){let o=s.pop();if(i[o-r])continue;i[o-r]=!0;let a=e.getInstruction(o);if(!ve(a))for(let u of a.args){let c=e.getInstruction(u);if(u<r){let l=e.getInstruction(u);if(l.type===4)continue;if(!ht(l))return!0}else{if(e.getInstruction(u).type===50)return!0;if(c.type===3)return!0;i[u-r]||s.push(u)}}}return!1}function xo(e,t,r){let n=kr(e,t);if(n===void 0)throw new Error(`${r}\nNon-constant instruction: \"${yc(e,Nr(e,t))}\"`);return n}function kr(e,t){let r=Mc(e,t);if(!(r<0))return r}function Mc(e,t,r){var o;let n=r&&r[t];if(n)return n;let i=e.getInstruction(t),s;switch(i.type){case 38:s=i.args.length;break;case 1:s=i.value.length;break;case 48:{s=(o=i.constantLength)!=null?o:-1;break}}return s===void 0&&(r=r||{},s=wV(e,i,r)),r&&(r[t]=s),s}function wV(e,t,r){switch(t.type){case 33:{let n=Mc(e,t.args[1],r),i=Mc(e,t.args[2],r);return n===i?n:-1}case 37:switch(t.symbol){case\"elementsAt\":return Mc(e,t.args[1],r);case\"sortPerm\":return Mc(e,t.args[0],r);case\"shuffle\":return Mc(e,t.args[1],r);default:return-1}case 55:{let n=e.dereferenceFunctionHeader(t.args[0]);if(n!==void 0){let i=e.getInstruction(n);return Mc(e,i.args[1],r)}return-1}default:{if(W(t.valueType))return-1;throw new Error(`Programming Error: cannot find the list length of ${wn(t.type)} ${ne(t.valueType)}.`)}}}function Nr(e,t){let r=e.getInstruction(t);if(!W(r.valueType))throw new Error(`Programming Error: cannot find the list length of ${e.printInstruction(t)}`);switch(r.type){case 38:return e.Constant(r.args.length);case 1:return e.Constant(r.value.length);case 48:{let n=e.getInstruction(r.args[0]);return e.getInstruction(n.args[0]).args[0]}case 37:switch(r.symbol){case\"elementsAt\":return Nr(e,r.args[1]);case\"sortPerm\":return Nr(e,r.args[0]);case\"shuffle\":return Nr(e,r.args[1])}}return e.SyntheticNativeFunction(\"count\",[t])}function Lf(e,t){let r=[];for(let o of t)W(e.getInstruction(o).valueType)&&r.push(o);if(r.length===0)return;if(r.length===1)return Nr(e,r[0]);let n=[];for(let o of r)n.push(kr(e,o));let i,s=1/0;for(let o=0;o<n.length;o++){let a=r[o],u=n[o];if(u===void 0)return e.SyntheticNativeFunction(\"min\",[e.List(r.map(c=>Nr(e,c)))]);u<s&&(i=a,s=u)}return i!==void 0?Nr(e,i):e.Constant(s)}function Ry(e,t){if(W(e)){let r=ze(e);for(let n=0;n<t.length;n++)if(Mn(r,t[n]))return!0;return!1}return Mn(e,t)}function Mn(e,t){switch(e){case T:return bi(t);case Gt:return t;case C:{let[r,n]=t;return bi(r)||bi(n)}case V:{let[r,n,i]=t;return bi(r)||bi(n)||bi(i)}case qt:{let[r,n,i]=t;return bi(r)||bi(n)||bi(i)}case Be:{for(let r of t)if(Mn(C,r))return!0;return!1}case Rr:{let[r,n]=t;return Mn(V,r)||Mn(T,n)}case Pr:{let[r,n,i]=t;return Mn(V,r)||Mn(V,n)||Mn(V,i)}case Rt:case Ce:{let[r,n]=t;return Mn(V,r)||Mn(V,n)}case Se:case be:case _e:case Me:{let[r,n]=t;return Mn(C,r)||Mn(C,n)}case he:{let[r,n]=t;return Mn(C,r)||Mn(T,n)}case fe:{let[r,n,i]=t;return Mn(C,r)||Mn(C,n)||Mn(C,i)}case Ge:case Ae:{let[r,n,i]=t;return Mn(C,r)||Mn(T,n)||Mn(T,i)}case Ke:return Object.keys(t.updateRules).length===0;case Ee:case Dt:case et:case Ue:case Wr:case jr:case cn:case ln:return!1;case pr:{let[r,n]=t;return bi(r)||bi(n)}default:throw new Error(\"Type cannot contain a NaN value: \"+ne(e)+\".\")}}function sI(e,t,r){let n;return Cy(t)?n=aI(t,r):n=E1(t,r),e.ConstantOfType(t,n)}function oI(e){return Cy(e)||I1(e)}function Cy(e){switch(e){case Xe:case le:case _r:case kn:case xt:case xr:case wr:case Fr:case Br:case Gr:case Vr:case Or:case mr:case yr:case tn:case sn:case nn:case xn:case rn:case Zr:case Hn:case bn:return!0;default:return!1}}function I1(e){switch(e){case T:case Ee:case Gt:case C:case Se:case he:case fe:case _e:case Me:case be:case Be:case Ge:case Ae:case V:case Ce:case Pr:case Rr:case Rt:case qt:case pr:case Ue:case Ke:case et:return!0;default:return!1}}function aI(e,t){if(e===Xe)return[];let r=ze(e);if(!I1(r))throw new Error(`Programming error: unexpected element type ${$t(r)} for list type ${$t(e)}.`);let n=[];for(let i=0;i<t.length;i++){let s=E1(r,t[i]);n.push(s)}return n}function E1(e,t){if(e===T)return Re(t,1);if(e===C){let[r,n]=t;return[Re(r,1),Re(n,1)]}else if(e===V){let[r,n,i]=t;return[Re(r,1),Re(n,1),Re(i,1)]}else return t}function uI(e,t){return ps(e,t)}function cI(e,t){return Ki(e,t)}function lI(e,t){return fs(e,t)}function pI(e,t){return es(e,t)}function wf(e,t){return Y(e)===Math.E?Math.exp(Y(t)):Ch(e,t)}var FV=wf;function fI(e){return xi(e)}function VV(e,t){return[e,t]}function BV(e,t){return t[e-1]}function GV(e,t,r){return[e,t,r]}function zV(e,t){return t[e-1]}function dI(e,t){return Y(e)===Y(t)}function mI(e,t){return Y(e)<Y(t)}function yI(e,t){return Y(e)>Y(t)}function gI(e,t){return Y(e)<=Y(t)}function hI(e,t){return Y(e)>=Y(t)}function v1(e,t){return e||t}function D1(e,t){return e&&t}function kV(e,t,r){let n=Math.floor(Y(r))-1;return!isFinite(n)||n<0||n>=t.length?ri(e):t[n]}function bI(e,t,r){return Tr(r)&&(r=Y(r)),`${t}::${e}${r}`}function xI(e,t){switch(e){case\"mod\":return PM(t[0],t[1]);case\"abs\":return bM(t[0]);case\"sqrt\":return xM(t[0]);case\"nthroot\":return Od(t[0],t[1]);case\"total\":return TM(t[0]);case\"count\":return t[0].length;case\"validateRangeLength\":{let r=t[0],n=t[1],i=t[2],s=t[3],o=GT(r,n,i,s);if(o===0)throw Jp();return o}case\"validateSampleCount\":{let r=po(t[0]),n=zT(r);if(n===0&&r!==0)throw CP();return n}case\"select\":case\"elementsAt\":case\"uniquePerm\":case\"sortPerm\":{let r=gr[e];return ho[r.symbol].apply(null,t)}default:{let r=gr[e];return(r.module===\"Math\"?Math:ho)[r.symbol].apply(null,po(t))}}}function S1(e,t){let r=Array(t+1);return Qe(e,t,r)}function O1(e,t,r){let n=Array(t+1);for(let i=0;i<r.length;i++)n[i]=r[i];return Qe(e,t,n)}function R1(e,t,r){if(t.constantLength)return t.constantLength;let n=t.args[0],s=e.getInstruction(n).args[0],o=e.getInstruction(s);return Y(Qe(e,o.args[0],r))}function C1(e,t,r,n){let i=e.getInstruction(t),s=R1(e,i,n);if(!isFinite(r)||r<0||r>=s)return ri(ze(i.valueType));let o=i.args[0],a=t-o,u=e.getInstruction(o),c=u.args[0],l=u.args[a];n[c]=r+1;let p=Qe(e,l,n);for(let f=c;f<=o;f++)n[f]=void 0;return p}function HV(e,t,r){let n=e.getInstruction(t),i=n.args[0],s=e.getInstruction(i).args[0];if(qV(e,s+1,i-1)&&Cy(n.valueType)){let u=e.copy(),c=Jl(u);return aI(n.valueType,c)}let o=R1(e,n,r),a=[];for(let u=o-1;u>=0;u--)a[u]=C1(e,t,u,r);return a}function N1(e,t,r){let n=Qe(e,t.args[1],r),i=t.args[0],s=e.getInstruction(i);if(s.type===48)return C1(e,i,Y(n)-1,r);if(s.type===33){let o=Qe(e,s.args[0],r);return N1(e,{...t,args:[o?s.args[1]:s.args[2],t.args[1]]},r)}else{let o=Qe(e,t.args[0],r);return kV(t.valueType,o,n)}}function Qe(e,t,r){let n=r[t];if(n!==void 0)return n;let i=UV(e,t,r);return typeof i==\"number\"&&i===Math.floor(i)&&(i=Re(i,1)),r[t]=i,i}function UV(e,t,r){let n=e.getInstruction(t);switch(n.type){case 1:return n.value;case 8:return uI(Qe(e,n.args[0],r),Qe(e,n.args[1],r));case 9:return cI(Qe(e,n.args[0],r),Qe(e,n.args[1],r));case 10:return lI(Qe(e,n.args[0],r),Qe(e,n.args[1],r));case 11:return pI(Qe(e,n.args[0],r),Qe(e,n.args[1],r));case 12:return wf(Qe(e,n.args[0],r),Qe(e,n.args[1],r));case 13:return FV(Qe(e,n.args[0],r),Qe(e,n.args[1],r));case 14:return fI(Qe(e,n.args[0],r));case 15:return VV(Qe(e,n.args[0],r),Qe(e,n.args[1],r));case 16:return GV(Qe(e,n.args[0],r),Qe(e,n.args[1],r),Qe(e,n.args[2],r));case 17:return BV(n.index,Qe(e,n.args[0],r));case 18:return zV(n.index,Qe(e,n.args[0],r));case 25:return dI(Qe(e,n.args[0],r),Qe(e,n.args[1],r));case 26:return mI(Qe(e,n.args[0],r),Qe(e,n.args[1],r));case 27:return yI(Qe(e,n.args[0],r),Qe(e,n.args[1],r));case 28:return gI(Qe(e,n.args[0],r),Qe(e,n.args[1],r));case 29:return hI(Qe(e,n.args[0],r),Qe(e,n.args[1],r));case 31:return Qe(e,n.args[0],r)||Qe(e,n.args[1],r);case 32:return Qe(e,n.args[0],r)&&Qe(e,n.args[1],r);case 44:return bI(n.tag,Qe(e,n.args[0],r),Qe(e,n.args[1],r));case 33:return Qe(e,n.args[0],r)?Qe(e,n.args[1],r):Qe(e,n.args[2],r);case 37:{let s=[];for(let o of n.args)s.push(Qe(e,o,r));return xI(n.symbol,s)}case 38:{let s=[];for(let o of n.args)s.push(Qe(e,o,r));return s}case 39:case 40:case 41:return N1(e,n,r);case 48:return HV(e,t,r);case 47:{let s=n.args[0],o=t-s,u=e.getInstruction(s).args[o],c=M1(e,{endIndex:s,returnIndex:u,resultIndex:t},r);return Jl(c)}case 55:{let s=n.args[0],a=e.getInstruction(s).endIndex,c=e.getInstruction(a).args[0],l=M1(e,{endIndex:a,returnIndex:c,resultIndex:t},r);return Jl(l)}case 19:case 20:case 21:case 22:case 23:case 24:case 42:case 0:case 2:case 3:case 49:case 50:case 51:case 4:case 53:case 54:throw new Error(`Programming Error: cannot interpret opcode ${n.type}`);default:let i=n;throw new Error(`Programming Error: unexpected opcode ${i.type}`)}}function M1(e,t,r){let n=t.endIndex,i=t.returnIndex,s=t.resultIndex,o=e.getInstruction(n).args[0],a=[];a[i]=!0;let u=i;e.getInstruction(s).type===55&&(a[s]=!0,u=s);for(let m=u;m>=o;m--){if(!a[m])continue;let g=e.getInstruction(m);if(!ve(g))for(let y of g.args)y<o||y>n?Qe(e,y,r):a[y]=!0}let l=e.copy();l.truncate(o);for(let m=0;m<o;m++){let g=r[m],y=e.getInstruction(m);if(g!==void 0){let d=y.valueType;l.replaceInstructionWithConstant(m,{type:1,valueType:d,value:g})}}l.reopenAllBlocks();let p=[];for(let m=o;m<s;m++){let g=e.getInstruction(m);if(ve(g))p.push(l.copyInstruction(g));else{let y=[];for(let d of g.args)y.push(d<o?d:p[d-o]);g.type===40?p.push(l.InboundsListAccess(y)):p.push(l.copyInstructionWithArgs(g,y))}}l.Noop();let f=e.getInstruction(s);if(f.type===47)l.replaceInstructionWithBlockVarOrFunctionCall(l.getReturnIndex(),{type:47,valueType:f.valueType,args:[n<o?n:p[n-o]]});else if(f.type===55)l.replaceInstructionWithBlockVarOrFunctionCall(l.getReturnIndex(),{type:55,fnSymbol:f.fnSymbol,valueType:f.valueType,isRecursiveCall:f.isRecursiveCall,args:f.args.map(m=>m<o?m:p[m-o])});else throw new Error(`Programming error: unexpected opcode ${wn(f.type)}`);return l}function qV(e,t,r){let n=[];for(let s=0;s<=t;s++)n.push(!1);let i=[];for(let s=t+1;s<=r;s++)i.push(s);for(;i.length;){let s=i.pop();if(n[s])continue;n[s]=!0;let o=e.getInstruction(s);if(o.type===55)return!0;if(!ve(o))for(let a of o.args)n[a]||i.push(a)}return!1}function Jl(e){let t=e.getCompiledFunction();t.executionMetadata.recursiveFunctionCache=new Vl;let r=t.fn();if(t.executionMetadata.recursiveDepthError)throw t.executionMetadata.recursiveDepthError;return r}function yn(e,t){let r=e.getInstruction(t);if(r.type!==48)return t;let n=r.args[0],i=e.getInstruction(n),s=i.args[0],o=!1;for(let u=s+1;u<n;u++){let c=e.getInstruction(u);if(c.type===40&&c.args[1]===s){o=!0;break}}if(!o)return t;let a=[];for(let u=s;u<=n+i.args.length-1;u++){let c=e.getInstruction(u);if(ve(c))a.push(e.copyInstruction(c));else{let l=[];for(let p of c.args)l.push(p>=s?a[p-s]:p);c.type===40?a.push(e.InboundsListAccess(l)):a.push(e.copyInstructionWithArgs(c,l))}}return e.getReturnIndex()}function Ff(e,t,r){let n=e.getInstruction(t);if(W(n.valueType)){let i=kr(e,t);if(r=Math.floor(r),isNaN(r)||r<0||i!==void 0&&r>=i){let s=ze(n.valueType);return e.NanOfType(s)}return n.type===38?n.args[r]:n.type===1&&W(n.valueType)?e.ConstantOfType(ze(n.valueType),n.value[r]):i!==void 0?e.InboundsListAccess([t,e.Constant(r+1)]):e.ListAccess([t,e.Constant(r+1)])}else{if(n.valueType===C)return isNaN(r)||r<0||r>2?e.Constant(NaN):n.type===15?n.args[r]:n.type===1?e.Constant(n.value[r]):e.OrderedPairAccess(r+1,[t]);if(n.valueType===V)return isNaN(r)||r<0||r>3?e.Constant(NaN):n.type===16?n.args[r]:n.type===1?e.Constant(n.value[r]):e.OrderedTripleAccess(r+1,[t]);throw new Error(`Cannot access elements of ${ne(n.valueType)}`)}}function Ny(e,t,r){let n=e.getInstruction(t);if(r.length===0)return e.ConstantOfType(n.valueType,[]);if(n.type===1&&W(n.valueType)){let i=[],s=ze(n.valueType);for(let o of r){let a=Math.floor(o);isNaN(a)||a<0||a>=xo(e,t,\"Programming error: expected Constant list instruction to have constant length.\")?i.push(ri(s)):i.push(n.value[a])}return e.ConstantOfType(n.valueType,i)}else if(n.type===38){let i=[];for(let s of r){let o=Math.floor(s);if(isNaN(o)||o<0||o>=xo(e,t,\"Programming error: expected List instruction to have constant length.\")){let a=ze(n.valueType);i.push(e.NanOfType(a))}else i.push(n.args[o])}return e.List(i)}else{let i=[],s=!0,o=kr(e,t);for(let u of r){let c=Math.floor(u);i.push(e.Constant(c+1)),(isNaN(c)||c<0||o===void 0||c>=o)&&(s=!1)}let a=[t,e.List(i)];return s?e.InboundsListAccess(a):e.ListAccess(a)}}function L1(e){if(e.instructionsLength()-1!==e.getReturnIndex())throw new Error(\"Programming Error: only the final instruction in a chunk can be constant collapsed\");let t=e.getInstruction(e.getReturnIndex());if(ve(t))return e.getReturnIndex();switch(t.type){case 8:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.Constant(uI(n.value,i.value))):n.type===1&&Y(n.value)===0?(e.popInstruction(),t.args[1]):i.type===1&&Y(i.value)===0?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 9:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.Constant(cI(n.value,i.value))):n.type===1&&Y(n.value)===0?(e.popInstruction(),e.Negative([t.args[1]])):i.type===1&&Y(i.value)===0?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 10:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.Constant(lI(n.value,i.value))):n.type===1&&Y(n.value)===1?(e.popInstruction(),t.args[1]):i.type===1&&Y(i.value)===1?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 11:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.Constant(pI(n.value,i.value))):i.type===1&&Y(i.value)===1?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 12:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);if(n.type===1&&i.type===1)return e.popInstruction(),e.Constant(wf(n.value,i.value));if(n.type===1&&n.valueType===T){let s=Y(n.value);if(s===Math.E)return e.popInstruction(),e.SyntheticNativeFunction(\"exp\",[t.args[1]]);if(s>0)return e.popInstruction(),e.RawExponent(t.args)}if(i.type===1&&i.valueType===T){let s=Y(i.value);if(s===1)return e.popInstruction(),t.args[0];if(s===Math.floor(s))return e.popInstruction(),e.RawExponent(t.args);if(Tr(i.value)){let{n:o,d:a}=i.value;if(a%2===1){e.popInstruction();let u=e.RawExponent([e.SyntheticNativeFunction(\"abs\",[t.args[0]]),t.args[1]]);return o%2===0?u:e.Multiply([e.SyntheticNativeFunction(\"sign\",[t.args[0]]),u])}}}return e.getReturnIndex()}case 13:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.Constant(wf(n.value,i.value))):i.type===1&&Y(i.value)===1?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 14:{let n=e.getInstruction(t.args[0]);return n.type===1?(e.popInstruction(),e.Constant(fI(n.value))):e.getReturnIndex()}case 25:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(Ee,dI(n.value,i.value))):e.getReturnIndex()}case 26:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(Ee,mI(n.value,i.value))):e.getReturnIndex()}case 27:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(Ee,yI(n.value,i.value))):e.getReturnIndex()}case 28:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(Ee,gI(n.value,i.value))):e.getReturnIndex()}case 29:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(Ee,hI(n.value,i.value))):e.getReturnIndex()}case 31:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(Ee,v1(n.value,i.value))):n.type===1?(e.popInstruction(),n.value?t.args[0]:t.args[1]):i.type===1?(e.popInstruction(),i.value?t.args[1]:t.args[0]):e.getReturnIndex()}case 32:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(Ee,D1(n.value,i.value))):n.type===1?(e.popInstruction(),n.value?t.args[1]:t.args[0]):i.type===1?(e.popInstruction(),i.value?t.args[0]:t.args[1]):e.getReturnIndex()}case 33:{let n=e.getInstruction(t.args[0]);return n.type===1?(e.popInstruction(),n.value?t.args[1]:t.args[2]):e.getReturnIndex()}case 17:{let n=e.getInstruction(t.args[0]),i=t.index;return n.type===15?(e.popInstruction(),n.args[i-1]):n.type===1&&n.valueType===C?(e.popInstruction(),e.Constant(n.value[i-1])):e.getReturnIndex()}case 18:{let n=e.getInstruction(t.args[0]),i=t.index;return n.type===16?(e.popInstruction(),n.args[i-1]):n.type===1&&n.valueType===V?(e.popInstruction(),e.Constant(n.value[i-1])):e.getReturnIndex()}case 38:{if(A1(e,t.args)){e.popInstruction();let n=[];for(let i of t.args)n.push(e.getInstruction(i).value);return e.ConstantOfType(t.valueType,n)}return e.getReturnIndex()}case 39:case 41:{let n=t.args[0],i=e.getInstruction(n),s=e.getInstruction(t.args[1]);if(i.type===33&&s.type===1){let o=t.type===39?e.ListAccess([i.args[1],t.args[1]]):e.InboundsListAccess([i.args[1],t.args[1]]),a=t.type===39?e.ListAccess([i.args[2],t.args[1]]):e.InboundsListAccess([i.args[2],t.args[1]]);return e.Piecewise([i.args[0],o,a])}if(i.type===48){e.popInstruction();let o=i.args[0],a=n-o,u=e.getInstruction(o),c=u.args[0],l,p;if(t.type===41)l=t.args[1];else{let m=kr(e,n);if(s.type===1&&s.valueType===T&&m!==void 0){let g=Y(s.value),y=Math.floor(g);if(y<1||y>m)return e.NanOfType(t.valueType);l=g===y?t.args[1]:e.Constant(y)}else{let g=e.Constant(1),d=e.getInstruction(c).args[0],h=e.SyntheticNativeFunction(\"floor\",[t.args[1]]),b=e.GreaterEqual([h,g]),x=e.LessEqual([h,d]);l=e.Piecewise([b,e.Piecewise([x,h,d]),g]),p={one:g,lengthIndex:d,roundedIndex:h,greaterEqualIndex:b,lessEqualIndex:x}}}if(u.args[a]<c)return u.args[a];let f=[l];for(let m=c+1;m<=u.args[a];m++){let g=e.getInstruction(m);if(ve(g))f.push(e.copyInstruction(g));else{let y=[];for(let d of g.args)y.push(d>=c?f[d-c]:d);g.type===40?f.push(e.InboundsListAccess(y)):f.push(e.copyInstructionWithArgs(g,y))}}if(p){let{greaterEqualIndex:m,lessEqualIndex:g,lengthIndex:y,one:d}=p,h=ze(i.valueType),b=e.NanOfType(h),x=f[f.length-1],P=e.And([e.And([m,g]),e.GreaterEqual([y,d])]);return e.Piecewise([P,x,b])}else return f[f.length-1]}else if(s.type===1&&s.valueType===T)if(i.type===38){e.popInstruction();let o=Math.floor(Y(s.value))-1;return isNaN(o)||o<0||o>=i.args.length?e.NanOfType(t.valueType):i.args[o]}else if(i.type===1){e.popInstruction();let o=Math.floor(Y(s.value))-1;return isNaN(o)||o<0||o>=i.value.length?e.NanOfType(t.valueType):e.ConstantOfType(ze(i.valueType),i.value[o])}else return e.getReturnIndex();else return e.getReturnIndex()}case 47:{let n=e.getInstruction(t.args[0]);if(!Un(n)||iI(e,e.getReturnIndex(),n.args[0]))return e.getReturnIndex();if(oI(t.valueType)){let i=e.copy(),s=Jl(i);return e.popInstruction(),sI(e,t.valueType,s)}else throw new Error(`Constant collapsing a block with return type ${ne(t.valueType)} is not implemented.`)}case 55:{let n=e.dereferenceFunctionHeader(t.args[0]);if(!(n===void 0?void 0:e.getInstruction(n))||!A1(e,t.args.slice(1)))return e.getReturnIndex();if(oI(t.valueType)){let s=e.copy(),o=Jl(s);return e.popInstruction(),sI(e,t.valueType,o)}else throw new Error(`Constant collapsing a function call with return type ${ne(t.valueType)} is not implemented.`)}case 37:switch(t.symbol){case\"nthroot\":{let n=_1(e,t.args);if(n!==void 0)return e.Constant(Od(n[0],n[1]));{let i=e.getInstruction(t.args[1]);if(i.type===1&&i.valueType===T)return e.Exponent([t.args[0],e.Constant(vp(i.value))])}return e.getReturnIndex()}case\"count\":{let n=kr(e,t.args[0]);return n!==void 0?(e.popInstruction(),e.Constant(n)):e.getReturnIndex()}case\"select\":{let n=kr(e,t.args[0]);if(n!==void 0&&ht(e.getInstruction(t.args[1]))){e.popInstruction();let i=ur(e,t.args[1]),s=[];for(let o=0;o<Math.min(n,i.length);o++)i[o]&&s.push(o);return Ny(e,t.args[0],s)}else return e.getReturnIndex()}case\"shuffle\":{let n=t.args[0],i=t.args[1],s=kr(e,i);if(s!==void 0&&ht(e.getInstruction(n))){e.popInstruction();let o=_T(ur(e,n),s);return Ny(e,i,o)}else return e.getReturnIndex()}case\"elementsAt\":{let n=t.args[0],i=t.args[1];if(ht(e.getInstruction(i))){e.popInstruction();let s=ur(e,i);return Ny(e,n,s)}return e.getReturnIndex()}case\"restrictionToBoolean\":{let n=e.getInstruction(t.args[0]);return ht(n)?(e.popInstruction(),e.ConstantOfType(Ee,n.value)):n.type===37&&n.symbol===\"restriction\"?(e.popInstruction(),n.args[0]):e.getReturnIndex()}default:{let n=_1(e,t.args);return n===void 0?e.getReturnIndex():(e.popInstruction(),e.ConstantOfType(t.valueType,xI(t.symbol,n)))}}case 44:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return ht(n)&&ht(i)?e.ConstantOfType(et,bI(t.tag,ur(e,t.args[0]),ur(e,t.args[1]))):e.getReturnIndex()}case 15:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&n.valueType===T&&i.type===1&&i.valueType===T?e.ConstantOfType(C,[n.value,i.value]):e.getReturnIndex()}case 16:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]),s=e.getInstruction(t.args[2]);return n.type===1&&n.valueType===T&&i.type===1&&i.valueType===T&&s.type===1&&s.valueType===T?e.ConstantOfType(V,[n.value,i.value,s.value]):e.getReturnIndex()}case 48:{let n=e.getReturnIndex(),i=kr(e,n);if(i!==void 0&&i===0)return e.popInstruction(),e.ConstantOfType(t.valueType,[]);let s=t.args[0],o=e.getInstruction(s),a=o.args[0],u=n-s,c=o.args[u];if(!iI(e,c,a)){if(t.valueType===Lr){if(i==null)throw sf(oi(e,n));let f=[];for(let m=0;m<i;m++){let g=e.InboundsListAccess([n,e.Constant(m+1)]);f.push(g)}return e.List(f)}let p=S1(e,n);e.popInstruction(),e.ConstantOfType(t.valueType,p)}return n}case 49:{for(let i of t.args)if(!ht(e.getInstruction(i)))return e.getReturnIndex();e.popInstruction();let n={};for(let i=0;i<t.symbols.length;i++){let s=t.symbols[i],o=e.getInstruction(t.args[i]);if(o.type===48&&(o=e.getInstruction(yn(e,t.args[i]))),o.type!==1)throw new Error(\"Expected instruction to be constant\");let{valueType:a,value:u}=o;Ry(a,u)||(n[s]={value:u,valueType:a})}return e.ConstantOfType(Ke,{type:\"Action\",updateRules:n})}case 20:case 22:case 23:case 24:case 40:case 42:case 21:case 19:case 50:case 51:case 53:case 54:return e.getReturnIndex();default:let r=t;throw new Error(`Unexpected opcode ${r.type}`)}}function A1(e,t){for(let r of t){let n=e.getInstruction(r);if(!ht(n))return!1}return!0}function _1(e,t){let r=[];for(let n of t){let i=e.getInstruction(n);if(ht(i))r.push(i.value);else return}return r}function rr(e,t,r){switch(t){case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 17:case 18:case 21:case 19:case 23:case 50:return T;case 25:case 26:case 27:case 28:case 29:case 31:case 32:return Ee;case 33:{let i=e.getInstruction(r[1]).valueType,s=e.getInstruction(r[2]).valueType,o=la(i,s);return o===void 0?i:o}case 15:return C;case 16:return V;case 38:{if(r.length===0)return Xe;let i=e.getInstruction(r[0]).valueType;if(i!==T&&Kn(i,T)){let s=!1,o=!0;for(let a of r){let u=e.getInstruction(a).valueType;if(u===T&&(s=!0),!Kn(u,T)){o=!1;break}}s&&o&&(i=T)}return ei(i)?pn(i):or}case 39:case 40:case 41:{let i=e.getInstruction(r[0]).valueType;return W(i)?ze(i):vt}case 44:return et;case 49:return Ke;case 55:return e.getInstruction(r[0]).valueType;case 1:case 2:case 37:case 42:case 47:case 48:case 3:case 0:case 24:case 22:case 20:case 51:case 4:case 53:case 54:return vt;default:let n=t;throw new Error(`Unexpected opcode ${n}`)}}var w1={segment:!0,ray:!0,vector:!0,line:!0,circle:!0,arc:!0,polygon:!0,glider:!0,midpoint:!0,intersection:!0,strictintersection:!0,perpendicular:!0,parallel:!0,translate:!0,rotate:!0,dilate:!0,reflect:!0,apply:!0,segments:!0,vertices:!0,angle:!0,angles:!0,directedangle:!0,directedangles:!0,clockwise:!0,counterclockwise:!0,reflex:!0,start:!0,end:!0};function YV(e){return e!==void 0&&e in w1}function PI(e){return YV(e)?e===\"rotate\"||e===\"dilate\"||e===\"translate\"||e===\"reflect\"?!0:!1:!1}function Ay(e){if(e.type===\"ListAccess\"&&e.list.type===\"Identifier\"&&e.index.type===\"Constant\")return[e.list._symbol,e.index.asValue()];if(e.type===\"Identifier\")return[e._symbol,void 0]}function _y(e){let t={},r=e;if((r instanceof lo||r instanceof In)&&(t.identifier=r._symbol,r=r._expression),r instanceof Ya&&r.index instanceof jt&&(t.listAccess=r.index.asValue(),r=r.list),t.identifier&&r instanceof Fe){let n=r._symbol,i=t.listAccess;t.assignmentRhsReference=[n,i]}if(r instanceof lr){let n=r._symbol,i=r.args[0]instanceof Fe?r.args[0]._symbol:void 0;if(PI(n)&&e instanceof In&&i&&e._argSymbols.some(s=>s===i))t.tree={symbol:n,parents:r.args.slice(1).map(Ay)};else if(w1[n])t.tree={symbol:n,parents:r.args.map(Ay)};else{let s=[r._symbol,void 0];t.tree={symbol:\"apply\",parents:[s,...r.args.map(Ay)]}}}else if(r instanceof Fi){let n=r.args.map(Ay);n.length===2&&n[1]&&n[1][0]===\"segments\"?t.tree={symbol:\"segment\",parents:[n[0]]}:n.length===2&&n[1]&&n[1][0]===\"start\"?t.tree={symbol:\"start\",parents:[n[0]]}:n.length===2&&n[1]&&n[1][0]===\"end\"&&(t.tree={symbol:\"end\",parents:[n[0]]})}return t}function F1(e,t,r,n,i){var h,b,x,P;if(!nl(t)&&!rl(t)||PI(t))return;let s,o=!1,a=!1,u=0,c=[],l=[],p=n.map(E=>e.getInstruction(E).valueType),f=nl(t)?co[t]:void 0;if(f&&(o=f.isSeeded,s=void 0,c.push(...f.argumentTypes),u=(b=(h=f.defaultArguments)==null?void 0:h.length)!=null?b:0,l=Ly(c,p,u),a=f.allowDotCall),t===\"mean\"&&l.length===0&&p.length>0&&ce(p[0],Dt))c=[[Dt]],u=0,l=[],a=!0;else if(rl(t)&&l.length===0&&!(f!=null&&f.fallthroughUnlessDistribution&&p.length>0&&ce(p[0],Dt))){let E=gr[t];s=E.tag,c.push(...$h(t)),u=(P=(x=E.defaultArguments)==null?void 0:x.length)!=null?P:0,l=Ly(c,p,u),a=a||E.allowDotCall}let m=Math.min(...c.map(Ha)),g=Math.max(...c.map(Pp)),y=n,d=n;if(o&&(d=y=n.slice(1),m-=1,g-=1),i){if(!a)throw Gp(r);let E=e.getInstruction(y[0]).valueType;if(!W(E)&&E!==Rt&&E!==Ce&&E!==Dt&&E!==pr&&(E===C||!Tp(E)))throw yb(r,ne(E));r=\".\"+r,d=y.slice(1),m-=1,g-=1}if(!(l.length>0))throw XV(e,{symbol:t,errorSymbol:r,providedArgs:d,argsWithoutSeed:y,isDotCall:i,minArity:m,maxArity:g,defaultArgumentCount:u,builtInTag:s})}function XV(e,{symbol:t,errorSymbol:r,providedArgs:n,argsWithoutSeed:i,isDotCall:s,minArity:o,maxArity:a,defaultArgumentCount:u,builtInTag:c}){if(c===\"doubleReducer\"&&n.length===2){if(!W(e.getInstruction(n[0]).valueType)||!W(e.getInstruction(n[1]).valueType))throw jp(t)}else if(c===\"parameterizedReducer\"&&n.length===2&&!W(e.getInstruction(n[0]).valueType))throw fP(t);if(t===\"logbase\"&&n.length!==2)return rs(\"log\",1,n.length-1);if(t===\"random\")return Qb();if(n.length<o||n.length>a){let{dotMinArityExampleArgs:p,dotMaxArityExampleArgs:f,minArityExampleArgs:m,maxArityExampleArgs:g}=ZV(t),y,d;if(n.length<o?(d=o-u,s&&p?y=r+p:m&&(y=r+m)):(d=a,s&&f?y=r+f:g&&(y=r+g)),c===\"reducer\"&&n.length===0)return rx(r);if(c===\"doubleReducer\")return $p(r);if(c===\"parameterizedReducer\")return tx(r);if(c===\"color\")return ex(r);if(nl(t))switch(t){case\"pdf\":return s?rs(r,d,n.length,y):Zb();case\"cdf\":return s?rs(r,d,n.length,y):n.length<o?Wb():jb();case\"tdist\":return Jb();case\"length\":case\"round\":case\"midpoint\":case\"segment\":case\"vector\":case\"distance\":case\"circle\":case\"center\":case\"radius\":case\"glider\":case\"intersection\":case\"strictintersection\":case\"parallel\":case\"perpendicular\":case\"start\":case\"end\":case\"angle\":case\"directedangle\":case\"angles\":case\"directedangles\":case\"apply\":case\"translate\":case\"reflect\":case\"dilate\":case\"rotate\":case\"normaldist\":case\"poissondist\":case\"binomialdist\":case\"uniformdist\":case\"total\":case\"mean\":case\"median\":case\"stdev\":case\"var\":case\"quantile\":case\"sort\":case\"shuffle\":case\"join\":case\"unique\":case\"polygon\":case\"coterminal\":return rs(r,d,n.length,y);case\"points\":case\"lines\":case\"circles\":case\"polygons\":case\"rays\":case\"vectors\":case\"arcs\":throw Ln(r);case\"histogram\":case\"dotplot\":case\"boxplot\":case\"ttest\":case\"ittest\":case\"stats\":case\"det\":case\"inv\":case\"transpose\":case\"rref\":case\"trace\":throw ee(`Unexpected arity error for ${t}`);default:let h=t;throw new Error(`Unexpected compiler function ${h}`)}return rs(r,d,n.length,y)}if(t===\"polygon\"&&n.length===2&&e.getInstruction(n[0]).valueType===T&&e.getInstruction(n[1]).valueType===T)return qp();let l=[];for(let p=0;p<i.length;p++){let f=i[p],m=c!==void 0&&c!==\"doubleReducer\"&&c!==\"never-broadcast\"&&!(c===\"parameterizedReducer\"&&p===0)&&t!==\"polygon\",g=e.getInstruction(f).valueType;W(g)&&m&&(g=ze(g)),l.push(ne(g))}return Vi(r,l)}function ZV(e){return nl(e)?co[e]:rl(e)?gr[e]:{}}function Ly(e,t,r){return Ea(e,t).filter(n=>t.length+r>=Ha(n))}var vc=Bs([[T,T]]),WV=Bs([[{meta:\"union\",types:Qi},{meta:\"union\",types:[Ee,T]}]]),TI={Negative:Bs([[T],[C],[Me],[Ce],[V]]),Add:Bs([[T,T],[C,C],[Me,Me],[Ce,Ce],[V,V]]),Subtract:Bs([[T,T],[C,C],[Me,Me],[Ce,Ce],[V,V]]),Multiply:Bs([[T,T],[C,T],[T,C],[T,Me],[T,Ce],[Me,T],[Ce,T],[V,T],[T,V],[Gt,{meta:\"union\",types:eu}],[{meta:\"union\",types:eu},Gt]]),DotMultiply:Bs([[T,T],[C,T],[T,C],[Me,Me],[Ce,Ce],[T,Me],[Me,T],[T,Ce],[Ce,T],[V,T],[T,V],[V,V],[Gt,{meta:\"union\",types:eu}],[{meta:\"union\",types:eu},Gt]]),CrossMultiply:Bs([[T,T],[C,T],[T,C],[Me,T],[T,Me],[Ce,T],[T,Ce],[Ce,Ce],[V,V],[Gt,{meta:\"union\",types:eu}],[{meta:\"union\",types:eu},Gt]]),Divide:Bs([[T,T],[C,T],[Me,T],[Ce,T],[V,T]]),Exponent:vc,\"Comparator['=']\":vc,\"Comparator['>']\":vc,\"Comparator['<']\":vc,\"Comparator['>=']\":vc,\"Comparator['<=']\":vc,ComparatorChain:Bs([{type:\"variadic\",initial:[T,T],rest:T}]),PercentOf:vc,NamedCoordinateAccess:Bs([[C],[V]]),Norm:Bs([[T],[C],[V],[Me],[Ce]]),ListAccess:WV};function Ma(e,t){let r=[];for(let n of t)r.push(ne(e.getInstruction(n).valueType));return r}function Dc(e,t){let r=[];for(let n of t){let i=e.getInstruction(n).valueType,s=W(i)?ze(i):i;r.push(ne(s))}return r}function We(e,t,r){return ce(e.getInstruction(t).valueType,r)}function wy(e,t){return Array.isArray(e)?t>e.length-1?void 0:e[t]:t<e.initial.length?e.initial[t]:e.rest}function du(e,t,r,n){var c,l;let i=r.type;if(i===\"RecursiveFunctionCall\"||i===\"FunctionCall\"||i===\"SeededFunctionCall\"||i===\"DotAccess\"){let p,f;if(r instanceof Fi&&(r.args[1]instanceof Fe||r.args[1]instanceof lr||r.args[1]instanceof Bi))p=r.args[1]._symbol,f=(c=r.args[1]._errorSymbol)!=null?c:p;else if(r instanceof lr||r instanceof uc||r instanceof Bi)p=r._symbol,f=(l=r._errorSymbol)!=null?l:p;else return;if(p===\"polygon\"&&t.is3dPolicy())throw Dm();F1(e,p,f,n,r instanceof Fi);return}let s=EI(e,t,r,n);if(!s)return;let o=Math.min(...s.map(Ha));if(s.length>0&&n.length>=o)return;let a=n.map(p=>e.getInstruction(p).valueType),u=jV(i,a);switch(i){case\"Add\":throw Kh(u);case\"Subtract\":throw eb(u);case\"CrossMultiply\":throw t.is3dProduct()&&a.length===2&&(ce(a[0],C)&&ce(a[1],C)||ce(a[0],T)&&ce(a[1],V)||ce(a[0],V)&&ce(a[1],T))?wp(u):Lp(u);case\"DotMultiply\":throw Lp(u);case\"Multiply\":{if(t.is3dProduct()&&a.length===2){if(ce(a[0],V)&&ce(a[1],V))throw Vp(u);if(ce(a[0],C)&&ce(a[1],C))throw Fp(u)}throw Lp(u)}case\"Divide\":throw tb(u);case\"Exponent\":throw rb(u);case\"Negative\":throw nb(u);case\"Comparator['=']\":case\"Comparator['>']\":case\"Comparator['<']\":case\"Comparator['>=']\":case\"Comparator['<=']\":case\"ComparatorChain\":throw ob(u);case\"Or\":throw ub(u);case\"Piecewise\":throw ce(a[0],Ee)?Sb([ne(e.getInstruction(n[1]).valueType),ne(e.getInstruction(n[2]).valueType)]):em(u);case\"Restriction\":throw em(u);case\"List\":{V1(e,n);break}case\"ListAccess\":throw Bp(u);case\"Norm\":throw Vi(\"abs\",u);case\"ParenSeq\":{let p=a.indexOf(Ke)!==-1,f=a.some(g=>g!==Ke);if(p&&f)throw nm([ne(a[0]),ne(a[1])]);if(a.length!==2&&(!t.is3dProduct()||a.length!==3)){let g=t.is3dPolicy()?3:2;throw sx(g)}let m=a.find(g=>!ce(g,T));throw m!==void 0?cb(ne(m)):ee(\"Unexpected error type checking ParenSeq\")}case\"BareSeq\":{if(a.length<2)throw Ln(\",\");let p=a[0],f=a.find(m=>m!==p);if(f)throw nm([ne(p),ne(f)]);if(p===T)throw n.length===2?nx():ix();V1(e,n);break}case\"Ans\":case\"Constant\":case\"Assignment\":case\"RecursiveFunctionBaseCase\":case\"MixedNumber\":case\"Identifier\":case\"Construction\":case\"Range\":case\"NamedCoordinateAccess\":case\"Sum\":case\"Product\":case\"Integral\":case\"ListComprehension\":case\"FunctionExponent\":case\"FunctionFactorial\":case\"Prime\":case\"Derivative\":case\"UpdateRule\":case\"Substitution\":case\"CoordinateEquation\":case\"FunctionDefinition\":case\"Slider\":case\"RegressionParameter\":case\"Seed\":case\"ExtendSeed\":case\"PercentOf\":return;default:{let p=i;throw new Error(`Unexpected node type: ${p}`)}}}function V1(e,t){if(t.length===0)return;let r=e.getInstruction(t[0]).valueType;if(!ei(r))throw Za([ne(r)]);for(let n of t){let i=e.getInstruction(n).valueType;if(!ei(i))throw Za([ne(i)]);if(i!==r)throw kp()}}function jV(e,t){let r=n=>W(n)?ze(n):n;switch(e){case\"Add\":case\"Subtract\":case\"Multiply\":case\"Divide\":case\"Exponent\":case\"Negative\":case\"Comparator['<']\":case\"Comparator['>']\":case\"Comparator['=']\":case\"Comparator['<=']\":case\"Comparator['>=']\":case\"NamedCoordinateAccess\":return t.map(r).map(ne);case\"ComparatorChain\":{let n=t.map(r);for(let i=0;i<n.length;i++)if(!z1(n[i],T))return i===0?[ne(n[i]),ne(n[i+1])]:[ne(n[i-1]),ne(n[i])];return n.map(ne)}case\"ListAccess\":case\"Constant\":case\"MixedNumber\":case\"Identifier\":case\"Ans\":case\"List\":case\"Range\":case\"Construction\":case\"ParenSeq\":case\"BareSeq\":case\"Norm\":case\"Sum\":case\"Product\":case\"Integral\":case\"ListComprehension\":case\"FunctionExponent\":case\"FunctionFactorial\":case\"Prime\":case\"Piecewise\":case\"Restriction\":case\"Derivative\":case\"UpdateRule\":case\"Substitution\":case\"Assignment\":case\"RecursiveFunctionBaseCase\":case\"CoordinateEquation\":case\"FunctionDefinition\":case\"Slider\":case\"RegressionParameter\":case\"Seed\":case\"ExtendSeed\":case\"DotMultiply\":case\"CrossMultiply\":case\"Or\":case\"PercentOf\":return t.map(ne);default:{let n=e;throw new Error(`Unexpected node type: ${n}`)}}}function G1(e,t){let r=e.getInstruction(t);if(ve(r))return;let n=II(e,r).expectedTypes;if(r.type===49){for(let a of r.args){let u=e.getInstruction(a).valueType;if(!ce(u,T)&&!ce(u,C)&&!ce(u,V)&&!ce(u,qt)&&!ce(u,Be)&&!ce(u,Se)&&!ce(u,be)&&!ce(u,_e)&&!ce(u,Me)&&!ce(u,he)&&!ce(u,fe)&&!ce(u,Ge)&&!ce(u,pr)&&!ce(u,Ae))throw Nb(ne(u))}let o={};for(let a of r.symbols){if(o[a])throw _b(a);o[a]=!0}return}let i=[];for(let o=0;o<r.args.length;o++){let a=e.getInstruction(r.args[o]).valueType,u=wy(n,o);(u===void 0||!MI(a,u))&&i.push(r.args[o])}if(i.length===0)return;let s=Ma(e,r.args);switch(r.type){case 32:throw ab(s);case 17:case 18:throw lb(s);case 21:{let o=e.getInstruction(r.args[0]).valueType,a=e.getInstruction(r.args[1]).valueType;if(o!==T)throw Ib([ne(o)]);if(a!==T)throw Eb([ne(a)]);return}case 22:{let o=e.getInstruction(r.args[1]).valueType;throw Mb([ne(o)])}case 44:{if(e.getInstruction(r.args[0]).valueType!==et||e.getInstruction(r.args[1]).valueType!==et&&e.getInstruction(r.args[1]).valueType!==T)throw ee(`Unexpected arg types for ExtendSeed: ${Ma(e,r.args).map(o=>o.key).join(\", \")}`);return}case 31:case 15:case 16:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 25:case 26:case 27:case 28:case 29:case 38:case 39:case 40:case 41:case 37:case 42:case 33:case 48:case 47:case 23:case 24:case 19:case 20:case 50:case 51:case 53:case 54:case 55:throw ee(`Invalid argument types for opcode ${r.type}`);default:{let o=r;throw new Error(`Unexpected opcode: ${o.type}`)}}}function II(e,t,r=!1){switch(t.type){case 8:case 9:case 10:case 11:return r&&t.args.length>0&&e.getInstruction(t.args[0]).valueType===C?{expectedTypes:[C,C]}:{expectedTypes:[T,T]};case 12:case 13:case 25:case 26:case 27:case 28:case 29:return{expectedTypes:[T,T]};case 14:return{expectedTypes:[T]};case 31:return{expectedTypes:[Ee,Ee]};case 32:return{expectedTypes:[Ee,Ee]};case 33:return{expectedTypes:[Ee,t.valueType,t.valueType]};case 15:case 16:return{expectedTypes:t.args.map(()=>T)};case 17:return{expectedTypes:[C]};case 18:return{expectedTypes:[V]};case 21:return{expectedTypes:[T,T]};case 22:{let n=e.getInstruction(t.args[1]).valueType;return n===C||n===V?{expectedTypes:[T,n]}:{expectedTypes:[T,T]}}case 38:{let n=t.valueType,i=ze(n);return{expectedTypes:{type:\"variadic\",initial:[],rest:i}}}case 39:case 40:case 41:return{expectedTypes:[or,T]};case 37:{let n=t.symbol,i=gr[n],s=i.argumentTypes;if(i.tag===\"reducer\"&&!JV(e,t.args)&&Array.isArray(s)&&typeof s[0]==\"number\"&&W(s[0]))return{isReducerWithNoListArgs:!0,expectedTypes:{type:\"variadic\",initial:[],rest:ze(s[0])}};if(Array.isArray(s))return{expectedTypes:s};{let{initial:o,rest:a}=s,u=t.args.length-o.length,c=[...o];for(let l=0;l<u;l++)c.push(a);return{expectedTypes:c}}}case 44:return e.getInstruction(t.args[0]).valueType===et&&e.getInstruction(t.args[1]).valueType!==et?{expectedTypes:[et,T]}:{expectedTypes:t.args.map(n=>e.getInstruction(n).valueType)};case 47:return{expectedTypes:t.args.map(n=>e.getInstruction(n).valueType)};case 23:return{expectedTypes:[T]};case 19:return{expectedTypes:t.args.map(n=>{let i=e.getInstruction(n).valueType;return t.callData.type===\"recursive-function\"||i===Ee||t.callData.type===\"sum\"&&(i===C||i===V)?i:T})};case 50:{let n=t.callData.parameterSymbols.length,i=[];for(let s=0;s<n;s++)i.push(T,T);return{expectedTypes:i}}case 24:case 20:case 51:{let n=[T];for(let i=1;i<t.args.length;i++)n.push(e.getInstruction(t.args[i]).valueType);return{expectedTypes:n}}case 42:return{expectedTypes:t.args.map(()=>T)};case 48:case 49:return{expectedTypes:t.args.map(n=>e.getInstruction(n).valueType)};case 53:return{expectedTypes:[t.valueType]};case 54:return{expectedTypes:t.args.map(n=>e.getInstruction(n).valueType)};case 55:return{expectedTypes:t.args.map(n=>e.getInstruction(n).valueType)};default:{let n=t;throw new Error(`Unexpected opcode: ${n.type}`)}}}function EI(e,t,r,n){let i=[];for(let s of n)i.push(s===void 0?void 0:e.getInstruction(s).valueType);if(r instanceof ko){let s=n.filter(a=>a!==void 0);if(s.length===0)return;let o=rr(e,38,s);return W(o)&&o!==or?Ea([{type:\"variadic\",initial:[],rest:ze(o)}],i):[]}else if(r instanceof lr||r instanceof uc||r instanceof Fi||r instanceof Bi){let s=r instanceof Fi?r.args[1]._symbol:r._symbol;if(!s)return;let o=Rp(s);return o?Ea(o,i):void 0}else if(r instanceof dn){let[s,o,a]=n,u=o&&e.getInstruction(o),c=u==null?void 0:u.valueType,l=a&&e.getInstruction(a),p=l==null?void 0:l.valueType,f=c&&p&&la(c,p);!f&&l&&ht(l)&&l.valueType==T&&bi(l.value)&&(a=void 0,l=void 0,p=void 0);let m;if(f!==void 0)m=f;else if(c!==void 0)m=c;else if(p!==void 0)m=p;else return;return W(m)&&(m=ze(m)),Ea([ti([Ee,m,m])],[i[0],c,p])}else if(t.is3dProduct()&&r instanceof pu){let s=[...TI.DotMultiply,ti([C,C])];return Ea(s,i)}else if(r instanceof ts){let s=[{type:\"variadic\",initial:[Ke],rest:Ke},ti([T,T])];return t.is3dProduct()&&s.push(ti([T,T,T])),Ea(s,i)}else if(r instanceof Xa){let s=[{type:\"variadic\",initial:[Ke],rest:Ke}],o=n.filter(a=>a!==void 0&&e.getInstruction(a).valueType!==T);if(o.length>0){let a=rr(e,38,o);W(a)&&a!==or&&s.push({type:\"variadic\",initial:[],rest:ze(a)})}return Ea(s,i)}else if(r.type in TI&&i.some(s=>s!==void 0)){let s=TI[r.type];return s?Ea(s,i):void 0}}function Ea(e,t){let r=[];for(let n of e)Array.isArray(n)&&n.length<t.length||t.every((i,s)=>{if(i===void 0)return!0;let o=wy(n,s);return o===void 0?!1:z1(i,o)})&&r.push(n);return r}function JV(e,t){for(let r of t)if(W(e.getInstruction(r).valueType))return!0;return!1}function MI(e,t){return typeof t==\"number\"?_s(e,t):t.types.some(r=>_s(e,r))}function z1(e,t){return typeof t==\"number\"?Kn(e,t):t.types.some(r=>Kn(e,r))}function Fy(e,t){let r=new Set;for(let n of e){let i;if(Array.isArray(n)){if(t>=n.length)continue;i=B1(n[t])}else i=B1(t<n.initial.length?n.initial[t]:n.rest);for(let s of i)r.add(s)}return[...r]}function B1(e){return typeof e==\"number\"?[e]:e.types}function Bs(e){return e.map(ti)}var Gy=vI({sin:br(\"isinf(x) || isnan(x) ? NaN : dcg_isPiMultiple(abs(x)) ? 0.0 : sin(x)\"),cos:br(\"isinf(x) || isnan(x) ? NaN : dcg_isOddHalfPiMultiple(abs(x)) ? 0.0 : cos(x)\"),tan:ki($e`float a=abs(x);\n    return isinf(x) || isnan(x) ? NaN\n      : dcg_isPiMultiple(a) ? 0.0\n      : dcg_isOddHalfPiMultiple(a) ? Infinity\n      : tan(x);`),cot:ki($e`float a=abs(x);\n      return isinf(x) || isnan(x) ? NaN\n        : a < 0.03 ? 1.0/x - x/3.0\n        : dcg_isPiMultiple(a) ? Infinity\n        : dcg_isOddHalfPiMultiple(a) ? 0.0\n        : 1.0 / tan(x);`),sec:br(\"isinf(x) || isnan(x) ? NaN : dcg_isOddHalfPiMultiple(abs(x)) ? Infinity: 1.0 / cos(x)\"),csc:ki($e`float a=abs(x);\n      return isinf(x) || isnan(x) ? NaN\n        : a < 0.03 ? 1.0/x + x/6.0\n        : dcg_isPiMultiple(a) ? Infinity\n        : 1.0 / sin(x);`),arcsin:ki($e`if (isinf(x) || isnan(x)) { return NaN; }\n    if (x == 1.0) { return dcg_PI/2.0; }\n    if (x == -1.0) { return -dcg_PI/2.0; }\n    if (x > 1.0 || x < -1.0) return NaN;\n    float y0 = asin(x);\n    return y0 + (x - sin(y0)) / cos(y0);`),arccos:ki($e`if (isinf(x) || isnan(x)) { return NaN; }\n    if (x == 1.0) { return 0.0; }\n    if (x == -1.0) { return dcg_PI; }\n    if (x > 1.0 || x < -1.0) return NaN;\n    float y0 = acos(x);\n    return y0 + (cos(y0) - x) / sin(y0);`),arctan:Vy($e`isnan(x) || isnan(y) ? NaN\n      : isinf(x) && isinf(y) ?\n        (y > 0.0 ? 0.25 : 0.75) * sign(x) * dcg_PI\n      : x == 0.0 && y == 0.0 ? y\n      : atan(x, y)\n    `),arccot:br(\"isnan(x) ? NaN : dcg_PI/2.0 - atan(x)\"),arcsec:br(\"isnan(x) ? NaN : dcg_arccos(1.0/x)\"),arccsc:br(\"isnan(x) ? NaN : dcg_arcsin(1.0/x)\"),sinh:br(\"isinf(x) ? x : isnan(x) ? NaN : sinh(x)\"),cosh:br(\"isinf(x) ? Infinity : isnan(x) ? NaN : cosh(x)\"),tanh:br(\"abs(x) > 10.0 ? sign(x) : isnan(x) ? NaN : tanh(x)\"),coth:br(\"abs(x) > 10.0 ? sign(x) : isnan(x) ? NaN : x == 0.0 ? Infinity : abs(x) < 0.03 ? 1.0/x + x/3.0 : 1.0/tanh(x)\"),sech:br(\"isinf(x) ? 0.0 : isnan(x) ? NaN : 1.0/cosh(x)\"),csch:br(\"isinf(x) ? 0.0 : isnan(x) ? NaN : x == 0.0 ? Infinity : abs(x) < 0.03 ? 1.0/x - x/6.0 : 1.0/sinh(x)\"),arcsinh:ki($e`float a=abs(x);\n      return isnan(x) ? NaN : sign(x) * (\n        1.0 + x * x == 1.0\n          ? dcg_log1p(a)\n          : log(a + dcg_rtxsqpone(a))\n      );`),arccosh:br(\"x < 1.0 || isnan(x) ? NaN : log(x + dcg_rtxsqmone(x))\"),arctanh:ki($e`if (isnan(x) || abs(x) > 1.0) { return NaN; }\n      if (x == 1.0) { return Infinity; }\n      if (x == -1.0) { return -Infinity; }\n      float y0 = 0.5*(dcg_log1p(x) - dcg_log1p(-x));\n      float c = cosh(y0);\n      return y0 + (x - tanh(y0)) * c * c;`),arccoth:br(\"isnan(x) ? NaN : abs(x) >= 1.0 ? dcg_arctanh(1.0/x) : NaN\"),arcsech:br(\"isnan(x) ? NaN : 0.0 < x && x <= 1.0 ? dcg_arccosh(1.0/x) : x == 0.0 ? Infinity : NaN\"),arccsch:br(\"isinf(x) ? 0.0 : isnan(x) ? NaN : dcg_arcsinh(1.0/x)\"),sinpiSeries:ki($e`float xsq = x*x;\n    return x*(dcg_PI-xsq*(5.167708-xsq*(2.549761-xsq*0.5890122)));`),sinpi:ki($e`if (isnan(x) || isinf(x)) { return NaN; }\n    if (x==0.0) { return x; }\n    if (x == floor(x)) { return x > 0.0 ? 0.0 : -0.0; }\n    int i = int(dcg_round(2.0*x));\n    float t = -0.5 * float(i) + x;\n    float s = bool(i & 2) ? -1.0 : 1.0;\n    float y = bool(i & 1) ? cos(dcg_PI * t) : dcg_sinpiSeries(t);\n    return s*y;`),sincpi:br(\"isnan(x) ? NaN : isinf(x) ? 0.0 : x == 0.0 ? 1.0 : dcg_sinpi(x)/(dcg_PI*x);\"),sqrt:br(\"isnan(x) ? NaN : x >= 0.0 ? sqrt(x) : NaN\"),rtxsqpone:br(\"dcg_hypot(x, 1.0)\"),rtxsqmone:ki(\"float t = x*x; return isnan(x) || t < 1.0 ? NaN : t - 1.0 == t ? abs(x) : sqrt(t - 1.0);\"),nthroot:Vy(\"isnan(x) || isnan(y) ? NaN : dcg_pow(x, 1.0/y)\"),hypot:X1($e`if (isnan(x) || isnan(y)) return NaN;\n      if (isinf(x) || isinf(y)) return Infinity;\n      x = abs(x);\n      y = abs(y);\n      float m = max(x,y);\n      x /= m;\n      y /= m;\n      return m == 0.0 ? 0.0 : sqrt(x*x + y*y) * m;`),log:br(\"isnan(x) ? NaN : x > 0.0 ? log(x)*0.4342944819 : x == 0.0 ? -Infinity : NaN\"),logbase:Vy($e`isnan(x) || isnan(y) ? NaN\n      : y == 1.0 ?\n        (\n          x > 1.0 ? Infinity\n          : x == 1.0 ? NaN\n          : x < 0.0 ? NaN\n          : -Infinity\n        )\n      : y > 0.0 ?\n        (\n          x > 0.0 ? log(x)/log(y)\n          : x == 0.0 && !isinf(y) ? -Infinity\n          : NaN\n        )\n      : NaN`),ln:br(\"isnan(x) ? NaN : x > 0.0 ? log(x) : x == 0.0 ? -Infinity : NaN\"),exp:br(\"isnan(x) ? NaN : exp(x)\"),floor:br(\"isnan(x) ? NaN : floor(x)\"),ceil:br(\"isnan(x) ? NaN : ceil(x)\"),round:br(\"isinf(x) || isnan(x) ? x : floor(0.5 + x)\"),abs:br(\"isnan(x) ? NaN : abs(x)\"),sign:br(\"isnan(x) ? NaN : sign(x)\"),mod:Vy(\"isinf(x) || isinf(y) || isnan(x) || isnan(y) || y == 0.0 ? NaN : mod(x, y)\"),stirlingPrefactor:va(\"float\",\"float x, float y\",$e`if (isnan(x) || isnan(y)) { return NaN; }\n    return pow(x/exp(1.0), y);`),stirlerrSeries:ki($e`float S0 = 0.083333336;\n    float S1 = 0.0027777778;\n    float S2 = 0.0007936508;\n    float nn = x*x;\n    return (S0-(S1-S2/nn)/nn)/x;`),factorialAsymptotic:br(\"dcg_stirlingPrefactor(x,x)*sqrt(2.0*dcg_PI*x)*exp(dcg_stirlerrSeries(x))\"),factorialMinimax:ki($e`float n1 = 2.1618295;\n    float n2 = 1.5849807;\n    float n3 = 0.4026814;\n    float d1 = 2.2390451;\n    float d2 = 1.6824219;\n    float d3 = 0.43668285;\n\n    float n = 1.0 + x*(n1 + x*(n2 + x*n3));\n    float d = 1.0 + x*(d1 + x*(d2 + x*d3));\n    float xp1 = x+1.0;\n\n    return dcg_stirlingPrefactor(xp1,x)*sqrt(xp1)*(n/d);\n    `),factorialPositive:br($e`(x>33.0)?Infinity:(x>8.0)?dcg_factorialAsymptotic(x):dcg_factorialMinimax(x);`),factorial:ki($e`if (isnan(x) || (isinf(x) && x < 0.0)) { return NaN; }\n    bool isInteger = x == floor(x);\n    if (x < 0.0) {\n      if (isInteger) return Infinity;\n      return 1.0 / (dcg_sincpi(x) * dcg_factorialPositive(-x));\n    }\n    float approx = dcg_factorialPositive(x);\n    return isInteger ? dcg_round(approx) : approx;`),distance:va(\"float\",\"vec2 a, vec2 b\",$e`\n      if (any(isnan(a)) || any(isnan(b))) return NaN;\n      vec2 d = a-b;\n      return dcg_hypot(d.x, d.y);`),distanceThreeD:va(\"float\",\"vec3 a, vec3 b\",$e`\n      if (any(isnan(a)) || any(isnan(b))) return NaN;\n      vec3 d = a-b;\n      return dcg_hypot(dcg_hypot(d.x, d.y), d.z);`),hsv:va(\"vec3\",\"float h, float s, float v\",$e`if (isnan(h) || isnan(s) || isnan(v)) {discard;}\n      vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n      if (isinf(h)) h = 0.0;\n      vec3 p = abs(fract(h / 360.0 + K.xyz) * 6.0 - K.www);\n      return vec3(clamp(v, 0.0, 1.0) * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), clamp(s, 0.0, 1.0)));`),rgb:va(\"vec3\",\"float r, float g, float b\",$e`if (isnan(r) || isnan(g) || isnan(b)) {discard;}\n    return clamp(vec3(r,g,b),0.0,255.0)/255.0;`),erf:ki($e`if (isnan(x)) return NaN;\n      float t = abs(x);\n      float n = x*x;\n      float r = -n;\n      return sign(x) * (\n        r < -750.0\n          ? 1.0\n          : t >= 0.065\n          ? 1.0 - exp(r) * (\n            t > 50000000.0\n              ? r / t\n              : t > 50.0\n              ? (r * (n * (n + 4.5) + 2.0)) / (t * (n * (n + 5.0) + 3.75))\n              : ((0.9999999999999999+t*(2.224574423459406+t*(2.444115549920689+\n                t*(1.7057986861852539+t*(0.8257463703357973+\n                  t*(0.28647031042892007+t*(0.07124513844341643+\n                    t*(0.012296749268608364+t*(0.001347817214557592+\n                      0.00007263959403471071*t))))))))\n                )/(1.0+t*(3.352953590554884+t*(5.227518529742423+\n                  t*(5.003720878235473+t*(3.266590890998987+\n                    t*(1.5255421920765353+t*(0.5185887413188858+\n                      t*(0.12747319185915415+t*(0.02185979575963238+\n                        t*(0.0023889438122503674+0.00012875032817508128*t\n                ))))))))))\n              )\n          )\n          : t*(1.1283791670955126+r*(0.37612638903183754+\n              r*(0.11283791670955126+r*(0.026866170645131252+\n                0.005223977625442188*r))))\n      );`),restriction:va(\"bool\",\"bool x\",\"return x;\"),restrictionToBoolean:va(\"bool\",\"bool x\",\"return x;\")});function va(e,t,r){return{type:\"scalar\",value:`${e} dcg_[[name_here]](${t}){ ${r} }`}}function ki(e){return va(\"float\",\"float x\",e)}function br(e){return ki(`return ${e};`)}function X1(e){return va(\"float\",\"float x, float y\",e)}function Vy(e){return X1(`return ${e};`)}function zi(e,{outType:t,deps:r}={}){let n=t!=null?t:()=>\"float\";return{type:\"reducer\",value:i=>`${n(i)} dcg_[[name_here]](float[${i}] L) { ${e(i)} }`,deps:r!=null?r:[]}}function By(e,t=()=>\"float\"){return{type:\"double-reducer\",value:(r,n)=>{let i=Math.min(r,n),s=t(i),o=e(i);return`${s} dcg_[[name_here]](float[${r}] X, float[${n}] Y) { ${o} }`}}}var QV=vI({lcm:zi(e=>$e`float g = abs(dcg_round(L[0]));\n      if (isinf(g)) return Infinity;\n      if (isnan(g)) return NaN;\n      for (int i=1; i<${e}; i++) {\n        float v = abs(dcg_round(L[i]));\n        if (isinf(v)) return Infinity;\n        if (isnan(v)) return NaN;\n        g *= dcg_round(v / dcg_gcd2(g, v));\n      }\n      return g;`),gcd:zi(e=>$e`float g = abs(dcg_round(L[0]));\n      if (isnan(g)) return NaN;\n      for (int i=1; i<${e}; i++) {\n        float x = L[i];\n        if (isnan(x)) return NaN;\n        g = dcg_gcd2(g, abs(dcg_round(x)));\n      }\n      return g;`),mean:zi(e=>$e`float tot = 0.0;\n      for (int i=0; i<${e}; i++) {\n        float x = L[i];\n        if (isnan(x) || (isinf(x) && x == -tot)) return NaN;\n        tot += x;\n      }\n      return tot / ${e}.0;`),total:zi(e=>$e`float tot = 0.0;\n      for (int i=0; i<${e}; i++) {\n        float x = L[i];\n        if (isnan(x) || (isinf(x) && x == -tot)) return NaN;\n        tot += x;\n      }\n      return tot;`),stdev:zi(e=>H1(e,e-1),{deps:[\"mean\"]}),stdevp:zi(e=>H1(e,e),{deps:[\"mean\"]}),mad:zi(e=>$e`float mean = dcg_mean(L);\n      if (isnan(mean) || isinf(mean)) return NaN;\n      float tot = 0.0;\n      for (int i=0; i<${e}; i++) {\n        tot += abs(L[i] - mean);\n      }\n      return tot / ${e}.0;`,{deps:[\"mean\"]}),min:zi(e=>U1(e,\"min\")),max:zi(e=>U1(e,\"max\")),argmin:zi(e=>q1(e,\"<\")),argmax:zi(e=>q1(e,\">=\")),median:zi(e=>e%2===1?`return L[int(dcg_sortPerm(L)[${(e-1)/2}])-1];`:$e`float[${e}] perm = dcg_sortPerm(L);\n          return 0.5*(L[int(perm[${e/2}])-1]+L[int(perm[${e/2-1}])-1]);`,{deps:[\"sortPerm\"]}),varp:zi(e=>k1(e,e),{deps:[\"mean\"]}),var:zi(e=>k1(e,e-1),{deps:[\"mean\"]}),sortPerm:zi(e=>{if(e>100)throw ul();return $e`int[${e}] perm;\n        int[${e}] nextPerm;\n        for (int i=0; i<${e}; i++)\n          perm[i] = i;\n        float lastMin = -Infinity;\n        int lastIndex = -1;\n        for (int i=0; i<${e}; i++) {\n          float currMin = Infinity;\n          int currIndex = -1;\n          int j;\n          for (j=0; j<${e}; j++) {\n            float e = L[j];\n            if (\n              (e > lastMin || (e == lastMin && j > lastIndex))\n              && e < currMin\n            ) {\n              currMin = e;\n              currIndex = j;\n            }\n          }\n          perm[i] = currIndex;\n          lastMin = currMin;\n          lastIndex = currIndex;\n        }\n        float[${e}] permFloat;\n        for (int i=0; i<${e}; i++)\n          permFloat[i] = float(perm[i] + 1);\n        return permFloat;`},{outType:e=>`float[${e}]`})});function k1(e,t){return t===0?\"return NaN;\":$e`float mean = dcg_mean(L);\n    if (isnan(mean) || isinf(mean)) return NaN;\n    float tot = 0.0;\n    for (int i=0; i<${e}; i++) {\n      float delta = L[i] - mean;\n      tot += delta * delta;\n    }\n    return tot / ${t}.0;`}function H1(e,t){return t===0?\"return NaN;\":$e`float mean = dcg_mean(L);\n    if (isnan(mean) || isinf(mean)) return NaN;\n    float tot = 0.0;\n    for (int i=0; i<${e}; i++) {\n      tot = dcg_hypot(tot, L[i] - mean);\n    }\n    return tot / ${DI(Math.sqrt(t))};`}function U1(e,t){return $e`float m = L[0];\n    if (isnan(m)) return NaN;\n    for (int i=1; i<${e}; i++) {\n      float x = L[i];\n      if (isnan(x)) return NaN;\n      m = ${t}(m, x);\n    }\n    return m;`}function q1(e,t){return $e`if (isnan(L[0])) return 0.0;\n    int arg = 0;\n    float best = L[0];\n    for (int i=1; i<${e}; i++) {\n      float e = L[i];\n      if (isnan(e)) return 0.0;\n      if (e ${t} best) {\n        arg = i;\n        best = e;\n      }\n    }\n    return float(arg + 1);`}var KV=vI({elementsAt:By(e=>`float[${e}] outList;\n      for (int i=0; i<${e}; i++) {\n        float y = Y[i];\n        outList[i] = isnan(y) || isinf(y) ? NaN : X[int(y)-1];\n      }\n      return outList;`,e=>`float[${e}]`),cov:By(e=>$1(e,e-1)),covp:By(e=>$1(e,e)),corr:By(e=>$e`${Z1(e)}\n      float t1 = 0.0;\n      float t2 = 0.0;\n      float tc = 0.0;\n      for (int i=0; i<${e}; i++) {\n        float d1 = X[i] - m1;\n        float d2 = Y[i] - m2;\n        t1 = dcg_hypot(t1, d1);\n        t2 = dcg_hypot(t2, d2);\n        tc += d1 * d2;\n      }\n      return tc / (t1 * t2);`)}),e3={...Gy,...QV,...KV},zy=e3;function t3(e,t){switch(e.type){case\"scalar\":return e.value.replace(\"[[name_here]]\",t);case\"reducer\":{let r=e.value;return n=>r(n).replace(\"[[name_here]]\",t)}case\"double-reducer\":{let r=e.value;return(n,i)=>r(n,i).replace(\"[[name_here]]\",t)}}}function vI(e){for(let[t,r]of Object.entries(e))r.type!==\"omitted\"&&(r.value=t3(r,t));return e}function $1(e,t){return $e`${Z1(e)}\n    float tot = 0.0;\n    for (int i=0; i<${e}; i++) {\n      tot += (X[i] - m1) * (Y[i] - m2);\n    }\n    return tot / ${t}.0;`}function Z1(e){return $e`float m1 = 0.0;\n    for (int i=0; i<${e}; i++) {\n      float x = X[i];\n      if (isnan(x) || isinf(x)) return NaN;\n      m1 += x;\n    }\n    m1 /= ${e}.0;\n    float m2 = 0.0;\n    for (int i=0; i<${e}; i++) {\n      float y = Y[i];\n      if (isnan(y) || isinf(y)) return NaN;\n      m2 += y;\n    }\n    m2 /= ${e}.0;`}var r3=[$e`float dcg_rawpow(float x, float y) {\n    if (isnan(x) || isnan(y)) return NaN;\n    if (isinf(y)) {${\"\"}\n      float a = abs(x);\n      if (a == 1.0) return NaN;\n      if (y > 0.0) {\n        return a > 1.0 ? Infinity : 0.0;\n      } else {\n        return a < 1.0 ? Infinity : 0.0;\n      }\n    }\n    if (x > 0.0) return pow(x, y);\n    else if (x == 0.0) {\n      if (y > 0.0) return 0.0;\n      else if (y == 0.0) return 1.0;\n      else return Infinity;\n    } else {\n      float m = mod(y, 2.0);\n      if (m == 1.0) return -pow(-x, y);\n      else return pow(-x, y);\n    }\n  }`,$e`float dcg_pow(float x, float y) {\n    if (isnan(x) || isnan(y)) return NaN;\n    if (isinf(y)) {\n      float a = abs(x);\n      if (a == 1.0) return NaN;\n      if (y > 0.0) {\n        return a > 1.0 ? Infinity : 0.0;\n      } else {\n        return a < 1.0 ? Infinity : 0.0;\n      }\n    }\n    if (x > 0.0) return pow(x,y);\n    else if (x == 0.0) {\n      if (y > 0.0) return 0.0;\n      if (y == 0.0) return 1.0;\n      if (y < 0.0) return Infinity;\n    } else {\n      float m = mod(y, 2.0);\n      if (m == 0.0) return pow(-x, y);\n      else if (m == 1.0) return -pow(-x, y);\n      else {${\"\"}\n        vec2 a0 = vec2(0.0, 1.0);\n        vec2 a1 = vec2(1.0, 0.0);\n        float approx = y;\n        for (int i=0; i<12; i+=1) {\n          float whole = floor(approx);\n          vec2 a = whole * a1 + a0;\n          if (a.y > 100.0) break;\n          a0 = a1; a1 = a;\n          if (approx == whole) break;\n          approx = 1.0 / (approx - whole);\n        }${\"\"}\n        float r = a1.x / a1.y;\n        float m = max(max(abs(y), abs(r)), 1.0);\n        if (abs(mod(a1.y, 2.0) - 1.0) < 0.01 && abs((r - y)/y) < 0.00001) {\n          return (mod(a1.x, 2.0) == 0.0 ? 1.0 : -1.0) * pow(-x, y);\n        } else {\n          return NaN;\n        }\n      }\n    }\n  }`,$e`float dcg_add(float x, float y) {\n    return isnan(x) || isnan(y) ? NaN\n      : isinf(x) && isinf(y) && x != y ? NaN\n      : x + y;\n  }`,$e`float dcg_sub(float x, float y) {\n    return isnan(x) || isnan(y) ? NaN\n      : isinf(x) && isinf(y) && x != -y ? NaN\n      : x - y;\n  }`,$e`float dcg_mul(float x, float y) {\n    return isnan(x) || isnan(y) ? NaN\n      : isinf(x) && y == 0.0 ? NaN\n      : x == 0.0 && isinf(y) ? NaN\n      : x * y;\n  }`,$e`float dcg_div(float x, float y) {\n    return isnan(x) || isnan(y) ? NaN\n      : isinf(x) && isinf(y) ? NaN\n      : x == 0.0 && y == 0.0 ? NaN\n      : x / y;\n  }`,$e`float dcg_neg(float x) {\n    return isnan(x) ? NaN : -x;\n  }`,$e`bool dcg_equal(float x, float y) {\n    return isnan(x) || isnan(y) ? false : x == y;\n  }`,$e`bool dcg_less(float x, float y) {\n    return isnan(x) || isnan(y) ? false : x < y;\n  }`,$e`bool dcg_lessEqual(float x, float y) {\n    return isnan(x) || isnan(y) ? false : x <= y;\n  }`,$e`bool dcg_greater(float x, float y) {\n    return isnan(x) || isnan(y) ? false : x > y;\n  }`,$e`bool dcg_greaterEqual(float x, float y) {\n    return isnan(x) || isnan(y) ? false : x >= y;\n  }`,$e`float dcg_gcd2(float u, float v) {\n    if (isinf(u)) return v;\n    if (isinf(v)) return u;\n    for (int i=0; i<95; i++) {\n      if (v == 0.0) break;\n      u = mod(u, v);\n      if (u == 0.0) break;\n      v = mod(v, u);\n    }\n    return u+v;\n  }`,$e`float dcg_log1p(float x) {\n    return x - 0.5 * x * x == x ? x : log(1.0 + x);\n  }`,$e`bool dcg_isPiMultiple(float absx) {\n    if (absx > 1.0e5) return false;\n    return floor(0.5 + dcg_PI_INV * absx) * dcg_PI == absx;\n  }`,$e`bool dcg_isOddHalfPiMultiple(float absx) {\n    if (absx > 1.0e5) return false;\n    float n = floor(0.5 + 2.0 * dcg_PI_INV * absx);\n    return mod(n, 2.0) == 1.0 && n * dcg_PI == 2.0 * absx;\n  }`].join(`\n`),Y1=[\"round\",\"hypot\",\"rtxsqpone\",\"rtxsqmone\"],n3=Y1.map(e=>Gy[e].value).join(`\n`)+Object.keys(Gy).filter(e=>Y1.indexOf(e)===-1).map(e=>Gy[e].value).join(`\n`),a6=$e`uniform float NaN;\n    uniform float Infinity;\n    #define dcg_PI 3.141592653589793\n    #define dcg_PI_INV 0.3183098861837907\n    ${r3}\\n`+n3;function $e(e,...t){let r=e[0];for(let n=0;n<t.length;n++)r+=t[n],r+=e[n+1];return i3(r)}function i3(e){let t=e.split(`\n`);if(/^\\s/.test(t[0][0]))throw new Error(\"Programming error: Expected un-indented first line\");if(t.length<=1)return e;let r=Math.min(...t.slice(1).map(n=>n.match(/^\\s*/)[0].length));return t[0]+`\n`+t.slice(1).map(n=>n.slice(r)).join(`\n`)}function Jo(e,t){let r=new SI(e,t),n=Ym(r);return r.finish(n)}var SI=class extends Rl{constructor(r,n){super(r,!0);this.maxUniforms=n;this.glsl=!0;this.shaderUniforms=[];this.definitions={}}finish(r){return{source:r,shaderFunctions:s3(this.chunk,this.definitions),shaderUniforms:this.shaderUniforms}}printValue(r,n){if(Array.isArray(r)){if(r.length>100)throw ul();let i=W(n),s=i?ze(n):n,o=r.map(c=>this.printValue(c,s)).join(\",\"),a=ky(n),u=W1({type:a,arity:r.length});return this.definitions[u]=!0,(i?\"buildList\":a)+\"(\"+o+\")\"}switch(typeof r){case\"boolean\":return r.toString();case\"number\":return this.printFloatOrUniformGLSL(r);case\"string\":throw al(\"random\");case\"object\":if(Ka(r))throw new Error(\"Action values cannot be compiled\");return this.printFloatOrUniformGLSL(Y(r));default:throw new Error(\"Unexpected value: \"+r)}}printFloatOrUniformGLSL(r){if(this.shaderUniforms.length>=this.maxUniforms)return DI(r);{let i=\"_DCG_SC_\"+this.shaderUniforms.length;return this.shaderUniforms.push(r),i}}beforeBeginLoop(r){let n=this.chunk.getInstruction(r.args[0]),i=this.chunk.getInstruction(r.args[1]),s=r.callData.type===\"sum\";if(n.type!==1){let u=oi(this.chunk,r.args[0]);throw s?im(u):sm(u)}if(i.type!==1){let u=oi(this.chunk,r.args[1]);throw s?im(u):sm(u)}if(n.valueType!==T||i.valueType!==T)throw new Error(\"Programming error: non-number in summation bounds\");let o=Y(n.value),a=Y(i.value);if(!isFinite(a-o)||a-o>=1e3)throw s?qb():$b()}checkFiniteBounds(){return\"\"}emitConstant(r){return this.printValue(r.value,r.valueType)}emitNeg(r){return`dcg_neg(${r})`}emitTernary(r,n,i,s){return W(s.valueType)?`dcg_ternary(${r},${n},${i})`:`${r}?${n}:${i}`}emitVec2(r,n){return`vec2(${r},${n})`}emitVec3(r,n,i){return`vec3(${r},${n},${i})`}emitVecAccess(r,n){return`${r}.${n===1?\"x\":n===2?\"y\":\"z\"}`}emitBinary(r,n,i){switch(r.type){case 8:return`dcg_add(${n},${i})`;case 9:return`dcg_sub(${n},${i})`;case 10:return`dcg_mul(${n},${i})`;case 11:return`dcg_div(${n},${i})`;case 12:return`dcg_pow(${n},${i})`;case 13:return`dcg_rawpow(${n},${i})`;case 25:return`dcg_equal(${n},${i})`;case 26:return`dcg_less(${n},${i})`;case 28:return`dcg_lessEqual(${n},${i})`;case 27:return`dcg_greater(${n},${i})`;case 29:return`dcg_greaterEqual(${n},${i})`;case 31:return`${n}||${i}`;case 32:return`${n}&&${i}`;default:throw new Error(\"Programming Error: invalid binary opcode.\")}}emitList(r,n){let i=W1({type:ky(n.valueType),arity:n.args.length});return this.definitions[i]=!0,`buildList(${r.join(\",\")})`}emitListAccess(r,n,i,s){let o=kr(this.chunk,s.args[0]);if(o===void 0)throw tc(oi(this.chunk,s.args[0]));let a=`int(${n})`;return`(${a}>=1&&${a}<=${o})?${r}[${a}-1]:${i}`}emitInboundsListAccess(r,n){return`${r}[int(${n})-1]`}emitNativeFunction(r,n){if(!zy[n.symbol])throw al(n.symbol);return`dcg_${n.symbol}(${r.join(\",\")})`}emitExtendSeed(){throw al(\"random\")}emitVarDeclaration(r,n){let i=n?\";\":\"\";return i+=j1(this.chunk,r)+\" \"+_t(r),i}emitFunctionCall(){throw al(\"recursion\")}};function x6(...e){return Object.keys(Object.assign({},...e)).join(`\n`)}function W1(e){let{type:t,arity:r}=e,n=t+\"[\"+r+\"]\",i=n+\" buildList(\";for(let s=0;s<r-1;s++)i+=`${t} _${s}, `;i+=`${t} _${r-1}) {\n`,i+=n+` a;\n`;for(let s=0;s<r;s++)i+=`a[${s}] = _${s};\n`;return i+=`return a;\n}\n`,i}function s3(e,t){let r=e.argNames.length,n=e.instructionsLength()-1;for(let i=r;i<=n;i++){let s=e.getInstruction(i);if(s.type===33){if(W(s.valueType)){let o=j1(e,i),a=`${o} dcg_ternary(bool x, ${o} y, ${o} z) { if (x) return y; return z; }`;t[a]=!0}}else if(s.type===37){let o=zy[s.symbol];if((o==null?void 0:o.type)===\"reducer\"){let a=s.args[0],u=kr(e,a);if(u===void 0)throw tc(oi(e,a));for(let c of o.deps)t[zy[c].value(u)]=!0;t[o.value(u)]=!0}else if((o==null?void 0:o.type)===\"double-reducer\"){let a=s.args[0],u=s.args[1],c=kr(e,a),l=kr(e,u);if(c===void 0)throw tc(oi(e,a));if(l===void 0)throw tc(oi(e,u));t[o.value(c,l)]=!0}}}return t}function DI(e){let t=e.toString();return/^-?\\d+$/.test(t)?t+\".0\":t}function ky(e){switch(W(e)?ze(e):e){case Ee:return\"bool\";case T:return\"float\";case C:return\"vec2\";case qt:case V:return\"vec3\";default:throw new Error(\"Unexpected type: \"+$t(e))}}function j1(e,t){let r=e.getInstruction(t);if(W(r.valueType)){let n=kr(e,t);if(n===void 0)throw tc(oi(e,t));if(n>100)throw ul();return`${ky(r.valueType)}[${n}]`}else return ky(r.valueType)}function P6(e){let t={},r=\"\";if(e)for(let n=0;n<e.length;n++){let i=\"_DCG_SC_\"+n;t[i]={value:e[n]},r+=\"uniform float \"+i+`;\n`}return{uniforms:t,declarations:r}}function Gs(e,t){return e.pushLeafInstruction(t)}function Ir(e,t,r){switch(t.type){case 8:return e.Add(r);case 9:return e.Subtract(r);case 10:return e.Multiply(r);case 11:return e.Divide(r);case 12:return e.Exponent(r);case 13:return e.RawExponent(r);case 14:return e.Negative(r);case 25:return e.Equal(r);case 26:return e.Less(r);case 27:return e.Greater(r);case 28:return e.LessEqual(r);case 29:return e.GreaterEqual(r);case 31:return e.Or(r);case 32:return e.And(r);case 33:return e.Piecewise(r);case 47:return e.BlockVar(t.valueType,r);case 48:return e.BroadcastResult(t.valueType,r);case 15:return e.OrderedPair(r);case 16:return e.OrderedTriple(r);case 17:return e.OrderedPairAccess(t.index,r);case 18:return e.OrderedTripleAccess(t.index,r);case 37:return e.NativeFunction(t.symbol,t.callData,r);case 42:return e.Distribution(t.symbol,r);case 21:return e.BeginIntegral(t.callData,r);case 22:return e.EndIntegral(r);case 23:return e.BeginBroadcast(r);case 24:return e.EndBroadcast(r);case 19:return e.BeginLoop(t.callData,r);case 20:return e.EndLoop(r);case 38:return e.List(r);case 39:return e.ListAccess(r);case 40:return e.DeferredListAccess(r);case 41:return e.InboundsListAccess(r);case 44:return e.ExtendSeed(t.tag,r);case 49:return e.Action(t.symbols,r);case 50:return e.BeginMap(t.callData,r);case 51:return e.EndMap(r);case 53:return e.BeginFunction(r);case 54:return e.EndFunction(r);case 55:return e.FunctionCall(t.fnSymbol,t.isRecursiveCall,r);default:let n=t;throw new Error(`Unexpected opcode ${n.type}`)}}function J1(e){if(e.instructionsLength()-1!==e.getReturnIndex())throw new Error(\"Programming Error: only the final instruction in a chunk can be converted to broadcast\");let t=e.getInstruction(e.getReturnIndex());if(ve(t))return e.getReturnIndex();switch(t.type){case 8:case 9:case 10:case 11:case 12:case 13:case 25:case 26:case 27:case 28:case 29:case 31:case 32:case 15:case 16:case 14:case 33:case 17:case 18:return Sc(e,t);case 42:return yn(e,Sc(e,t));case 37:{let n=gr[t.symbol];switch(n.tag){case\"default\":case\"trig\":case\"trig2\":case\"inverseTrig\":case\"color\":return Sc(e,t);case\"never-broadcast\":{let i=[],s=!1;for(let o of t.args){let a=yn(e,o);a!==o?(s=!0,i.push(a)):i.push(o)}return s?e.copyInstructionWithArgs(t,i):e.getReturnIndex()}case\"reducer\":if(o3(e,t.args))if(t.args.length===1){let i=t.args[0],s=yn(e,i);return s!==i?e.copyInstructionWithArgs(t,[s]):e.getReturnIndex()}else return Sc(e,t);else return e.getReturnIndex();case\"doubleReducer\":{if(t.args.length!==2)throw new Error(\"Programming error: double reducers must have two arguments\");let i=yn(e,t.args[0]),s=yn(e,t.args[1]);return i!==t.args[0]||s!==t.args[1]?e.copyInstructionWithArgs(t,[i,s]):e.getReturnIndex()}case\"parameterizedReducer\":{if(t.args.length!==2)throw new Error(\"Programming error: double reducers must have two arguments\");let i=yn(e,t.args[0]);return i===t.args[0]?Sc(e,t,[!1,!0]):e.copyInstructionWithArgs(t,[i,t.args[1]])}default:{let i=n.tag;throw new Error(`Programming Error: unexpected tag ${i}`)}}}case 39:case 40:case 41:return Sc(e,t,[!1,!0]);case 55:{let i=e.getInstruction(t.args[0]).signature.argTypes.map(a=>!W(a)),s=[t.args[0]],o=!1;for(let a=1;a<t.args.length;a++){let u=t.args[a],c=yn(e,u);c!==u?(o=!0,s.push(c)):s.push(u)}return o?e.copyInstructionWithArgs(t,s):Sc(e,t,[!1,...i])}case 21:case 22:case 19:case 20:case 50:case 51:return e.getReturnIndex();case 38:case 47:case 23:case 24:case 48:case 44:case 49:case 53:case 54:return e.getReturnIndex();default:let r=t;throw new Error(`Unexpected opcode ${r.type}`)}}function o3(e,t){for(let r of t)if(W(e.getInstruction(r).valueType))return!0;return!1}function Sc(e,t,r){let n=t.args,i=!1,s=[];for(let m=0;m<n.length;m++){if(r&&!r[m])continue;let g=n[m],y=e.getInstruction(g).valueType;W(y)&&s.indexOf(g)===-1&&s.push(g),y===Xe&&(i=!0)}if(s.length===0)return e.getReturnIndex();if(t.type===33&&s.indexOf(t.args[0])==-1&&s.indexOf(t.args[1])>=0&&s.indexOf(t.args[2])>=0){let m=yn(e,t.args[1]),g=yn(e,t.args[2]);return m!==t.args[1]||g!==t.args[2]?Ir(e,t,[t.args[0],m,g]):e.getReturnIndex()}e.popInstruction();let o=Lf(e,s);if(o===void 0)throw new Error(\"Programming Error: expected minListLength to be defined for \"+s.length+\" lists\");let a=o;if(ht(e.getInstruction(a))&&ur(e,a)===0&&i)return e.ConstantOfType(Xe,[]);let u=e.BeginBroadcast([a]),c=[];for(let m of s)c.push(Da(e,m,u));let l=[];for(let m=0;m<n.length;m++){let g=n[m];if(r&&!r[m])l.push(g);else{let y=s.indexOf(g);l.push(y===-1?g:c[y])}}let p=e.copyInstructionWithArgs(t,l),f=e.EndBroadcast([u,p]);return e.BroadcastResult(pn(e.getInstruction(p).valueType),[f])}function Da(e,t,r){return e.getInstruction(t).type==48?e.DeferredListAccess([t,r]):e.InboundsListAccess([t,r])}function Q1(e){let t=[];t.push(\"digraph {\");for(let r=0;r<e.instructionsLength();r++)e.getInstruction(r).type!==0&&t.push(`${r} [label=\"${r}: ${yc(e,r)}\"];`);for(let r=0;r<e.instructionsLength();r++){let n=e.getInstruction(r);if(pv(n))for(let i of n.args)t.push(`${r} -> ${i};`)}return t.push(\"}\"),t.join(`\n`)}function K1(e,t,r){let n=e.argNames.indexOf(t);if(n===-1)return 0;let i=Fn(e,n,r);return nr(i,e.getReturnIndex())}function Fn(e,t,{allowRestriction:r,allowClosedBlockReferences:n}){return{chunk:e,argIndex:t,orderTable:[],mask:ru(e,t),allowRestriction:r,allowClosedBlockReferences:n}}function nr(e,t){let r=e.orderTable[t];if(r!==void 0)return r;let n=a3(e,t);return e.orderTable[t]=n,n}function a3(e,t){let{chunk:r,mask:n,argIndex:i,allowRestriction:s,allowClosedBlockReferences:o}=e;if(!o&&r.isInClosedBlock(t))return 1/0;if(t===i)return 1;let a=r.getInstruction(t);if(ni(a)||Un(a))return 1/0;switch(a.type){case 8:case 9:case 26:case 28:case 27:case 29:{let[c,l]=a.args;return Math.max(nr(e,c),nr(e,l))}case 10:{let[c,l]=a.args;return nr(e,c)+nr(e,l)}case 14:return nr(e,a.args[0]);case 11:{let[c,l]=a.args;return nr(e,l)>0?1/0:nr(e,c)}case 12:case 13:{let[c,l]=a.args,p=r.getInstruction(l);if(nr(e,c)===0&&nr(e,l)===0)return 0;if(p.type===1){let f=Y(p.value);return f===Math.round(f)&&f>0?nr(e,c)*f:1/0}else return 1/0}case 33:{if(!n[t])return 0;let c=r.getInstruction(a.args[2]);return s&&c.type===1&&isNaN(Y(c.value))?nr(e,a.args[1]):1/0}case 2:case 0:case 1:case 25:case 32:case 31:case 15:case 17:case 16:case 18:case 38:case 39:case 40:case 41:case 37:case 42:case 48:case 47:case 3:case 44:case 49:case 4:case 55:return n[t]?1/0:0;default:let u=a;throw new Error(`Unexpected opcode ${u.type}`)}}function eS(e,t){let r=e.argNames.indexOf(t),n=e.getReturnIndex(),i=zs(Fn(e,r,{allowRestriction:!0,allowClosedBlockReferences:!1}),n);if(nr(i.orderCtx,n)>2)throw new Error(\"Programming Error: cannot compute polynomial coefficients for polynomials of order greater than 2\");let s=Hr(i,n),o=!1;for(let a=0;a<e.instructionsLength();a++)e.getInstruction(a).type===33&&i.mask[a]&&(o=!0);return{chunk:i.newChunk,coefficients:s,mappedArgIndex:i.valueMap[r],mappedReturnIndex:i.valueMap[n],isRestrictedPolynomial:o}}function zs(e,t){let{chunk:r,argIndex:n}=e,i=Ii(r,t);if(r.isInClosedBlock(n))throw new Error(\"Programming Error: cannot find polynomial coefficients of an instruction in a closed block\");let s,o;n>=0&&n<r.argNames.length?(s=r.argNames.slice(),o=r.argTypes.slice(),s.splice(n,1),o.splice(n,1)):(s=r.argNames,o=r.argTypes);let a=new Qo({argNames:s,argTypes:o}),u=[];for(let m=0;m<r.instructionsLength();m++){if(!i[m])continue;let g=r.getInstruction(m);if(g.type===2)m<n||n<0?u[m]=m:m===n?u[m]=a.SymbolicVar(r.argTypes[m]):u[m]=m-1;else if(ve(g))u[m]=Gs(a,g);else{let y=[];for(let d of g.args)y.push(u[d]);u[m]=Ir(a,g,y)}}let c=[],l=a.Constant(0),p=a.Constant(1),f=a.Constant(NaN);return{chunk:r,newChunk:a,orderCtx:e,coefficientTable:c,mask:e.mask,valueMap:u,argIndex:n,zero:l,one:p,nan:f}}function Hr(e,t){let{newChunk:r,orderCtx:n,coefficientTable:i,mask:s,valueMap:o,argIndex:a,zero:u,one:c,nan:l}=e,p=i[t];if(p!==void 0)return p;let f;for(s[t]?t===a?f=[u,c]:nr(n,t)>2?f=[l]:f=u3(e,t):f=[o[t]];f.length>1;){let m=r.getInstruction(f[f.length-1]);if(m.type===1&&Y(m.value)===0)f.pop();else break}if(f.length===0)throw new Error(\"Programming Error: coefficients cannot be empty\");return i[t]=f,f}function u3(e,t){let r=e.chunk.getInstruction(t),{newChunk:n}=e;switch(r.type){case 8:{let[s,o]=r.args,a=Hr(e,s),u=Hr(e,o),c=a.length-1,l=u.length-1,p=[];for(let f=0;f<=Math.max(c,l);f++)c>=f&&l>=f?p.push(n.Add([a[f],u[f]])):p.push(c>l?a[f]:u[f]);return p}case 9:case 26:case 28:case 27:case 29:{let[s,o]=r.args;(r.type===26||r.type==28)&&([s,o]=[o,s]);let a=Hr(e,s),u=Hr(e,o),c=a.length-1,l=u.length-1,p=[];for(let f=0;f<=Math.max(c,l);f++)c>=f&&l>=f?p.push(n.Subtract([a[f],u[f]])):p.push(c>l?a[f]:n.Negative([u[f]]));return p}case 14:{let s=r.args[0],o=Hr(e,s),a=[];for(let u=0;u<o.length;u++)a.push(n.Negative([o[u]]));return a}case 10:{let[s,o]=r.args,a=Hr(e,s),u=Hr(e,o),c=a.length-1,l=u.length-1,p=[];for(let f=0;f<=c;f++)for(let m=0;m<=l;m++){if(f+m>2)continue;let g=n.Multiply([a[f],u[m]]),y=p[f+m];y===void 0?p[f+m]=g:p[f+m]=n.Add([y,g])}return p}case 11:{let[s,o]=r.args,a=Hr(e,s),u=Hr(e,o),c=[];for(let l=0;l<a.length;l++)c.push(n.Divide([a[l],u[0]]));return c}case 12:case 13:{let[s,o]=r.args,a=Hr(e,s),u=Hr(e,o);if(a.length-1===0)return[n.RawExponent([a[0],u[0]])];let l=n.getInstruction(u[0]);switch(Y(l.value)){case 0:return[n.Constant(1)];case 1:return a;case 2:return[n.Multiply([a[0],a[0]]),n.Multiply([n.Constant(2),n.Multiply([a[0],a[1]])]),n.Multiply([a[1],a[1]])]}}case 33:return Hr(e,r.args[1]);case 0:case 23:case 2:case 1:case 25:case 32:case 31:case 15:case 17:case 16:case 18:case 38:case 39:case 40:case 41:case 37:case 42:case 21:case 22:case 19:case 20:case 24:case 48:case 47:case 3:case 44:case 49:case 50:case 51:case 4:case 53:case 54:case 55:throw new Error(`Cannot find polynomial coefficients of opcode ${r.type} that depends on symbol.`);default:let i=r;throw new Error(`Unexpected opcode ${i.type}`)}}function tS(e){if(e.instructionsLength()-1!==e.getReturnIndex())throw new Error(\"Programming Error: only the final instruction in a chunk can be lifted to numbers\");let t=e.getInstruction(e.getReturnIndex());if(ve(t))return e.getReturnIndex();switch(t.type){case 8:return mu(e,t.args[0])&&mu(e,t.args[1])?(e.popInstruction(),e.OrderedPair([e.Add([e.OrderedPairAccess(1,[t.args[0]]),e.OrderedPairAccess(1,[t.args[1]])]),e.Add([e.OrderedPairAccess(2,[t.args[0]]),e.OrderedPairAccess(2,[t.args[1]])])])):yu(e,t.args[0])&&yu(e,t.args[1])?(e.popInstruction(),e.OrderedTriple([e.Add([e.OrderedTripleAccess(1,[t.args[0]]),e.OrderedTripleAccess(1,[t.args[1]])]),e.Add([e.OrderedTripleAccess(2,[t.args[0]]),e.OrderedTripleAccess(2,[t.args[1]])]),e.Add([e.OrderedTripleAccess(3,[t.args[0]]),e.OrderedTripleAccess(3,[t.args[1]])])])):Oa(e,t.args)?(e.popInstruction(),gu(e,[e.Add([ai(e,t.args[0]),ai(e,t.args[1])]),Po(e,t.args[0])])):e.getReturnIndex();case 9:return mu(e,t.args[0])&&mu(e,t.args[1])?(e.popInstruction(),e.OrderedPair([e.Subtract([e.OrderedPairAccess(1,[t.args[0]]),e.OrderedPairAccess(1,[t.args[1]])]),e.Subtract([e.OrderedPairAccess(2,[t.args[0]]),e.OrderedPairAccess(2,[t.args[1]])])])):yu(e,t.args[0])&&yu(e,t.args[1])?(e.popInstruction(),e.OrderedTriple([e.Subtract([e.OrderedTripleAccess(1,[t.args[0]]),e.OrderedTripleAccess(1,[t.args[1]])]),e.Subtract([e.OrderedTripleAccess(2,[t.args[0]]),e.OrderedTripleAccess(2,[t.args[1]])]),e.Subtract([e.OrderedTripleAccess(3,[t.args[0]]),e.OrderedTripleAccess(3,[t.args[1]])])])):Oa(e,t.args)?(e.popInstruction(),gu(e,[e.Subtract([ai(e,t.args[0]),ai(e,t.args[1])]),Po(e,t.args[0])])):e.getReturnIndex();case 14:return mu(e,t.args[0])?(e.popInstruction(),e.OrderedPair([e.Negative([e.OrderedPairAccess(1,[t.args[0]])]),e.Negative([e.OrderedPairAccess(2,[t.args[0]])])])):yu(e,t.args[0])?(e.popInstruction(),e.OrderedTriple([e.Negative([e.OrderedTripleAccess(1,[t.args[0]])]),e.Negative([e.OrderedTripleAccess(2,[t.args[0]])]),e.Negative([e.OrderedTripleAccess(3,[t.args[0]])])])):Oa(e,t.args)?(e.popInstruction(),gu(e,[e.Negative([ai(e,t.args[0])]),Po(e,t.args[0])])):e.getReturnIndex();case 10:if(Vf(e,t.args[0])&&Vf(e,t.args[1]))return e.popInstruction(),e.SyntheticNativeFunction(\"restriction\",[e.And([e.SyntheticNativeFunction(\"restrictionToBoolean\",[t.args[0]]),e.SyntheticNativeFunction(\"restrictionToBoolean\",[t.args[1]])])]);if(Vf(e,t.args[0])||Vf(e,t.args[1])){let n,i;Vf(e,t.args[0])?(n=t.args[0],i=t.args[1]):(n=t.args[1],i=t.args[0]);let s=e.getInstruction(i).valueType;return fo(s)?(e.popInstruction(),e.Piecewise([e.SyntheticNativeFunction(\"restrictionToBoolean\",[n]),i,e.NanOfType(s)])):e.getReturnIndex()}else return mu(e,t.args[0])&&Sa(e,t.args[1])?(e.popInstruction(),e.OrderedPair([e.Multiply([e.OrderedPairAccess(1,[t.args[0]]),t.args[1]]),e.Multiply([e.OrderedPairAccess(2,[t.args[0]]),t.args[1]])])):Sa(e,t.args[0])&&mu(e,t.args[1])?(e.popInstruction(),e.OrderedPair([e.Multiply([t.args[0],e.OrderedPairAccess(1,[t.args[1]])]),e.Multiply([t.args[0],e.OrderedPairAccess(2,[t.args[1]])])])):Oa(e,[t.args[0]])&&Sa(e,t.args[1])?(e.popInstruction(),gu(e,[e.Multiply([ai(e,t.args[0]),t.args[1]]),Po(e,t.args[0])])):Sa(e,t.args[0])&&Oa(e,[t.args[1]])?(e.popInstruction(),gu(e,[e.Multiply([t.args[0],ai(e,t.args[1])]),Po(e,t.args[1])])):yu(e,t.args[0])&&Sa(e,t.args[1])?(e.popInstruction(),e.OrderedTriple([e.Multiply([e.OrderedTripleAccess(1,[t.args[0]]),t.args[1]]),e.Multiply([e.OrderedTripleAccess(2,[t.args[0]]),t.args[1]]),e.Multiply([e.OrderedTripleAccess(3,[t.args[0]]),t.args[1]])])):Sa(e,t.args[0])&&yu(e,t.args[1])?(e.popInstruction(),e.OrderedTriple([e.Multiply([t.args[0],e.OrderedTripleAccess(1,[t.args[1]])]),e.Multiply([t.args[0],e.OrderedTripleAccess(2,[t.args[1]])]),e.Multiply([t.args[0],e.OrderedTripleAccess(3,[t.args[1]])])])):e.getReturnIndex();case 11:return mu(e,t.args[0])&&Sa(e,t.args[1])?(e.popInstruction(),e.OrderedPair([e.Divide([e.OrderedPairAccess(1,[t.args[0]]),t.args[1]]),e.Divide([e.OrderedPairAccess(2,[t.args[0]]),t.args[1]])])):Oa(e,[t.args[0]])&&Sa(e,t.args[1])?(e.popInstruction(),gu(e,[e.Divide([ai(e,t.args[0]),t.args[1]]),Po(e,t.args[0])])):yu(e,t.args[0])&&Sa(e,t.args[1])?(e.popInstruction(),e.OrderedTriple([e.Divide([e.OrderedTripleAccess(1,[t.args[0]]),t.args[1]]),e.Divide([e.OrderedTripleAccess(2,[t.args[0]]),t.args[1]]),e.Divide([e.OrderedTripleAccess(3,[t.args[0]]),t.args[1]])])):e.getReturnIndex();case 12:case 13:case 25:case 26:case 27:case 28:case 29:case 32:case 31:case 15:case 16:case 33:case 17:case 18:case 37:case 42:case 39:case 40:case 41:case 21:case 22:case 19:case 20:case 38:case 47:case 23:case 24:case 48:case 44:case 49:case 50:case 51:case 53:case 54:case 55:return e.getReturnIndex();default:let r=t;throw new Error(`Unexpected opcode ${r.type}`)}}function mu(e,t){return e.getInstruction(t).valueType===C}function yu(e,t){return e.getInstruction(t).valueType===V}function Sa(e,t){return e.getInstruction(t).valueType===T}function Vf(e,t){return e.getInstruction(t).valueType===Gt}function Oa(e,t){return t.every(r=>We(e,r,Me))||t.every(r=>We(e,r,Ce))}function gu(e,t){return hu(e,t,\"mathVector\",Bf(\"mathVector\",\"mathVectorThreeD\"))}function Po(e,t){return hu(e,[t],\"start\",[{match:[Me],build:()=>e.SyntheticNativeFunction(\"basePointFromVector\",[t])},{match:[Ce],build:()=>e.SyntheticNativeFunction(\"basePointFromVectorThreeD\",[t])}])}function ai(e,t){return hu(e,[t],\"displacement\",[{match:[Me],build:()=>e.SyntheticNativeFunction(\"vectorDisplacementAsPoint\",[t])},{match:[Ce],build:()=>e.SyntheticNativeFunction(\"vectorThreeDDisplacementAsPoint\",[t])}])}function Bf(e,t){return[{match:[C,C],build:(r,n)=>r.SyntheticNativeFunction(e,n)},{match:[V,V],build:(r,n)=>r.SyntheticNativeFunction(t,n)}]}var c3=[\"Sum\",\"Product\",\"Integral\",\"List\",\"Derivative\",\"Piecewise\",\"Exponent\",\"PercentOf\",\"FunctionDefinition\",\"UpdateRule\",\"Substitution\",\"ListComprehension\"],l3={isGeometryEnabled(){return!1},is3dProduct(){return!1},is3dPolicy(){return!1},isBeta3d(){return!1},areAllScalesLinear(){return!0},assignmentForbidden(e){return!0},substitutionForbidden(e){return!0},graphingEnabled(){return!1},isValidSlider(e){return!1},sliderVariables(e){return[]},ansEnabled(){return!1},disabledFeatures(){return c3},dimensionVarsEnabled(){return!1}},rS={...l3,isGeometryEnabled(){return!0},is3dProduct(){return!0},is3dPolicy(){return!0},isBeta3d(){return!0}};function nS(e){return 48<=e&&e<=57}function p3(e){return 97<=e&&e<=122}function f3(e){return 65<=e&&e<=90}function Hy(e){return p3(e)||f3(e)}function Uy(e){return e===92}function OI(e){return e===39}function iS(e){if(9<=e&&e<=13||8192<=e&&e<=8202)return!0;switch(e){case 32:case 160:case 5760:case 8232:case 8233:case 8239:case 8287:case 12288:case 65279:return!0;default:return!1}}function xu(e,t){return Qn(e.token.span,t.prevSpan)}function bu(e,t,r){return{type:e,span:t,val:r}}function d3(e,t,r,n){return{input:e,prevSpan:t,pos:r,token:n}}function sS(e){return oS(e,0,so(e,0))}function oS(e,t,r){for(;iS(e.charCodeAt(t));)t+=1;let n=g3(e,t);return d3(e,r,t,n)}function To(e){return oS(e.input,e.token.span.end,e.token.span)}function Hi(e){return e.token}function Ko(e,t){if(Hi(e).type!==t)throw`Parse Error: expected ${t}.`;return To(e)}function aS(e,t){return Hi(e).type===t}function qy(e){return e.pos>=e.input.length}var m3={\"\\\\left\":\"Left\",\"\\\\right\":\"Right\",\"\\\\sqrt\":\"Sqrt\",\"\\\\frac\":\"Frac\",\"\\\\operatorname\":\"OperatorName\",\"\\\\token\":\"Token\"},y3={\"[\":\"[\",\"]\":\"]\",\"{\":\"{\",\"}\":\"}\",\"^\":\"^\",_:\"_\"};function g3(e,t){let r=t;if(t>=e.length)return bu(\"End\",so(e,t),\"\");let n=e.charCodeAt(t);if(nS(n)){let i=gi(e,r,t+1);return bu(\"Digit\",i,e.charAt(r))}else if(Hy(n)){let i=gi(e,r,t+1);return bu(\"Letter\",i,e.charAt(r))}else if(Uy(n))if(t+=1,Hy(e.charCodeAt(t))){for(;Hy(e.charCodeAt(t));)t+=1;let i=gi(e,r,t),s=Sr(i),o=m3[s]||\"Cmd\";return bu(o,i,s)}else{t+=1;let i=gi(e,r,t),s=Sr(i);return bu(\"EscapedSymbol\",i,s)}else if(OI(n)){for(t+=1;OI(e.charCodeAt(t));)t+=1;if(e.charAt(t)===\"^\"){t+=1;let i=gi(e,r,t),s=Sr(i);return bu(\"Primes^\",i,s)}else{let i=gi(e,r,t),s=Sr(i);return bu(\"Primes\",i,s)}}else{let i=gi(e,r,t+1),s=e.charAt(r),o=y3[s]||\"Symbol\";return bu(o,i,s)}}function RI(e,t){return{type:\"Group\",span:e,args:t}}function uS(e,t,r){return{type:\"Sqrt\",span:e,optArg:t,arg:r}}function cS(e,t,r){return{type:\"Frac\",span:e,num:t,den:r}}function lS(e,t,r,n){return{type:\"SupSub\",span:e,sup:t,sub:r,nprimes:n}}function pS(e,t,r,n){return{type:\"LeftRight\",span:e,left:t,right:r,arg:n}}function fS(e,t){return{type:\"OperatorName\",span:e,arg:t}}function dS(e,t){return{type:\"TokenNode\",span:e,arg:t}}function mS(e,t){return{type:\"Symbol\",span:e,val:t}}function yS(e){switch(e){case\"Frac\":return 2;case\"^\":case\"_\":case\"Primes^\":case\"Left\":case\"Sqrt\":case\"OperatorName\":case\"Token\":return 1;default:return 0}}function gS(e){let{state:t,tree:r}=$y(sS(e),!1);if(!qy(t))throw`Parse error: unexpected ${Sr(Hi(t).span)}.`;return r}function ks(e,t){return{state:e,tree:t}}function $y(e,t){let r=e,n=[];e:for(;!qy(e);){let s=Hi(e);switch(s.type){case\"Cmd\":case\"EscapedSymbol\":case\"Letter\":case\"Digit\":case\"Symbol\":case\"[\":case\"{\":case\"^\":case\"_\":case\"Primes\":case\"Primes^\":case\"Left\":case\"Frac\":case\"Sqrt\":case\"OperatorName\":case\"Token\":case\"]\":{if(s.type===\"]\"&&t)break e;let a;if({state:e,tree:a}=hS(e),a.type===\"Group\")for(let u of a.args)n.push(u);else n.push(a);break}case\"}\":case\"Right\":case\"End\":break e;default:throw`Unexpected token type ${s.type}.`}}let i=xu(r,e);return ks(e,RI(i,n))}function hS(e){let t=Hi(e);switch(t.type){case\"Cmd\":case\"EscapedSymbol\":case\"Letter\":case\"Digit\":case\"Symbol\":return e=To(e),ks(e,t);case\"[\":case\"]\":return e=To(e),ks(e,mS(t.span,t.val));case\"{\":{e=To(e);let n;return{state:e,tree:n}=$y(e,!1),e=Ko(e,\"}\"),ks(e,n)}case\"^\":case\"_\":case\"Primes\":case\"Primes^\":return E3(e);case\"Left\":return I3(e);case\"Frac\":return T3(e);case\"Sqrt\":return P3(e);case\"OperatorName\":return b3(e);case\"Token\":return x3(e);case\"}\":case\"Right\":throw`Parse Error: unexpected ${t.val}.`;case\"End\":throw\"Parse Error: unexpected end.\";default:throw`Unexpected token type ${t.type}.`}}function b3(e){let t=e,r=Hi(e);e=Ko(e,\"OperatorName\");let n;({state:e,tree:n}=Pu(e,r));let i=xu(t,e);return ks(e,fS(i,n))}function x3(e){let t=e,r=Hi(e);e=Ko(e,\"Token\");let n;({state:e,tree:n}=Pu(e,r));let i=xu(t,e);return ks(e,dS(i,n))}function P3(e){let t=e,r=Hi(e);e=Ko(e,\"Sqrt\");let n;aS(e,\"[\")&&({state:e,tree:n}=M3(e));let i;({state:e,tree:i}=Pu(e,r));let s=xu(t,e);return ks(e,uS(s,n,i))}function T3(e){let t=e,r=Hi(e);e=Ko(e,\"Frac\");let n;({state:e,tree:n}=Pu(e,r));let i;({state:e,tree:i}=Pu(e,r));let s=xu(t,e);return ks(e,cS(s,n,i))}function I3(e){let t=e;e=Ko(e,\"Left\");let r=Hi(e);e=To(e);let n;({state:e,tree:n}=$y(e,!1)),e=Ko(e,\"Right\");let i=Hi(e);e=To(e);let s=xu(t,e);return ks(e,pS(s,r,i,n))}function E3(e){let t=e,r,n,i=0;e:for(;!qy(e);){let o=Hi(e);switch(o.type){case\"^\":if(e=To(e),r)throw\"Parse Error: double superscript.\";({state:e,tree:r}=Pu(e,o));break;case\"_\":if(e=To(e),n)throw\"Parse Error: double subscript.\";({state:e,tree:n}=Pu(e,o));break;case\"Primes\":if(e=To(e),i>0)throw\"Parse Error: double primes.\";i=o.val.length;break;case\"Primes^\":if(e=To(e),i>0)throw\"Parse Error: double primes.\";if(r)throw\"Parse Error: double superscript\";i=o.val.length-1,{state:e,tree:r}=Pu(e,o);break;default:break e}}let s=xu(t,e);return ks(e,lS(s,r,n,i))}function Pu(e,t){let r=yS(t.type),n;if(r<=0)throw new Error(\"Programming Error: greediness must be greater than 0.\");let i=yS(Hi(e).type);if(i>0&&i<=r){let s=Sr(t.span);throw`Parse Error: can't use ${Sr(Hi(e).span)} as argument of ${s}. Use {}.`}return{state:e,tree:n}=hS(e),n.type!==\"Group\"&&(n=RI(n.span,[n])),ks(e,n)}function M3(e){e=Ko(e,\"[\");let t;return{state:e,tree:t}=$y(e,!0),e=Ko(e,\"]\"),ks(e,t)}var v3={mcd:\"gcd\",gcf:\"gcd\",mcm:\"lcm\",signum:\"sign\",sgn:\"sign\",stdDevP:\"stdevp\",stddevp:\"stdevp\",stdDev:\"stdev\",stddev:\"stdev\",variance:\"var\",TTest:\"ttest\",TScore:\"tscore\",IndependentTTest:\"ittest\",iTTest:\"ittest\",inverseCdf:\"quantile\",inversecdf:\"quantile\",arsinh:\"arcsinh\",arcosh:\"arccosh\",artanh:\"arctanh\",arcsch:\"arccsch\",arsech:\"arcsech\",arcoth:\"arccoth\"};function bS(e){let t=0;for(;Uy(e.charCodeAt(t));)t+=1;return t>0&&(e=e.slice(t)),v3[e]||e}function xS(e,t,r){return{type:\"Comparator\",span:e,symbol:t,args:r}}function PS(e,t,r){if(t.length<1)throw\"Programming Error: ComparatorChain must have at least one comparator.\";if(r.length!==t.length+1)throw\"Programming Error: ComparatorChain must have one more arg than symbols\";return{type:\"ComparatorChain\",span:e,args:r,symbols:t}}function TS(e,t){return{type:\"Tilde\",span:e,args:t}}function IS(e,t){return{type:\"Pos\",span:e,args:t}}function ES(e,t){return{type:\"Neg\",span:e,args:t}}function MS(e,t){return{type:\"Add\",span:e,args:t}}function vS(e,t){return{type:\"Sub\",span:e,args:t}}function DS(e,t){return{type:\"Mul\",span:e,args:t}}function SS(e,t){return{type:\"DotMul\",span:e,args:t}}function OS(e,t){return{type:\"CrossMul\",span:e,args:t}}function RS(e,t){return{type:\"Div\",span:e,args:t}}function CS(e,t){return{type:\"Bang\",span:e,args:t}}function Gf(e,t){return{type:\"Call\",span:e,args:t}}function CI(e,t){return{type:\"ImplicitCall\",span:e,args:t}}function NS(e,t){return{type:\"Index\",span:e,args:t}}function NI(e,t){return{type:\"Paren\",span:e,args:t}}function AI(e,t){return{type:\"List\",span:e,args:t}}function AS(e,t){return{type:\"Pipes\",span:e,args:t}}function _I(e,t){return{type:\"Subscript\",span:e,args:t}}function Yy(e,t){return{type:\"Superscript\",span:e,args:t}}function zf(e,t,r){return{type:\"Prime\",span:e,nprimes:t,args:r}}function Xy(e,t){return{type:\"Seq\",span:e,args:t}}function _S(e,t){return{type:\"Sqrt\",span:e,args:t}}function LS(e,t){return{type:\"Nthroot\",span:e,args:t}}function wS(e,t){return{type:\"Frac\",span:e,args:t}}function FS(e,t){return{type:\"Derivative\",span:e,args:t}}function VS(e,t){return{type:\"Integral\",span:e,args:t}}function BS(e,t){return{type:\"EmptyIntegral\",span:e,args:t}}function GS(e,t){return{type:\"Sum\",span:e,args:t}}function zS(e,t){return{type:\"Product\",span:e,args:t}}function kS(e,t){return{type:\"Piecewise\",span:e,args:t}}function HS(e){return{type:\"EmptyPiecewise\",span:e}}function US(e){return{type:\"EmptyRangeEnd\",span:e}}function qS(e,t){return{type:\"Colon\",span:e,args:t}}function LI(e,t){return{type:\"Ellipsis\",span:e,args:t}}function $S(e,t){return{type:\"For\",span:e,args:t}}function YS(e,t){return{type:\"With\",span:e,args:t}}function XS(e,t){return{type:\"Dot\",span:e,args:t}}function ZS(e,t){return{type:\"PercentOf\",span:e,args:t}}function WS(e,t){return{type:\"RightArrow\",span:e,args:t}}function wI(e,t){return{type:\"Juxt\",span:e,args:t}}function jS(e,t){return{type:\"Letter\",span:e,val:t}}function Zy(e,t){return{type:\"Decimal\",span:e,val:t}}function Oc(e,t){return{type:\"Cmd\",span:e,val:bS(t)}}function JS(e,t){return{type:\"Alphanumeric\",span:e,val:t}}function QS(e,t,r,n){return{type:\"MixedNumber\",span:e,whole:t,num:r,den:n}}function Ur(e){if(e.type===\"Subscript\"){if(e.args[1].type!==\"Alphanumeric\")return!1;e=e.args[0]}switch(e.type){case\"Cmd\":return!0;case\"Letter\":return!0;default:return!1}}function KS(e){return e.type!==\"Superscript\"?!1:Ur(e.args[0])}function eO(e,t){if(e.type!==\"Letter\"||e.val!==\"d\"||t.type!==\"Juxt\")return!1;let[r,n]=t.args;return r.type!==\"Letter\"||r.val!==\"d\"?!1:Ur(n)}function an(e){return e.type===\"Seq\"?e.args:[e]}function Ne(e,t){return{type:\"Err\",span:e,error:t}}function FI(){return{type:\"UnexpectedParseError\"}}function tO(){return{type:\"EmptyInput\"}}function rO(){return{type:\"EmptyGroup\"}}function VI(){return{type:\"EmptySubscript\"}}function nO(){return{type:\"EmptySuperscript\"}}function BI(){return{type:\"EmptyRadical\"}}function iO(){return{type:\"EmptySquareBracket\"}}function sO(){return{type:\"EmptyPipe\"}}function oO(){return{type:\"EmptyRadicalIndex\"}}function GI(){return{type:\"UnexpectedEnd\"}}function Rc(e){return{type:\"BinaryOperatorMissingRight\",val:e}}function aO(e){return{type:\"BinaryOperatorMissingLeft\",val:e}}function zI(e){return{type:\"UnaryOperatorMissingRight\",val:e}}function kI(e){return{type:\"UnaryOperatorMissingLeft\",val:e}}function uO(e,t){return{type:\"MissingCloseDelimiter\",open:e,close:t}}function kf(e,t){return{type:\"UnexpectedCloseDelimiter\",open:e,close:t}}function cO(){return{type:\"UnexpectedDifferential\"}}function lO(e){return{type:\"UnrecognizedSymbol\",val:e}}function pO(e){return{type:\"InvalidSubscript\",val:e}}function fO(e){return{type:\"UnexpectedSubscript\",base:e}}function HI(e){return{type:\"FunctionMissingArgument\",val:e}}function dO(){return{type:\"PercentMissingOf\"}}function UI(){return{type:\"PrimeWithoutParen\"}}function mO(){return{type:\"SuperscriptWithPrime\"}}function Wy(){return{type:\"UnexpectedPrime\"}}function yO(){return{type:\"SumMissingBound\"}}function gO(){return{type:\"ProductMissingBound\"}}function qI(){return{type:\"MissingBound\"}}function hO(){return{type:\"IntegralMissingBound\"}}function bO(){return{type:\"SumMissingBody\"}}function xO(){return{type:\"ProductMissingBody\"}}function PO(){return{type:\"IntegralMissingBody\"}}function TO(){return{type:\"DerivativeMissingBody\"}}function IO(){return{type:\"IntegralMissingDifferential\"}}function EO(){return{type:\"DifferentialWithSuperscript\"}}function MO(){return{type:\"FractionMissingNumerator\"}}function vO(){return{type:\"FractionMissingDenominator\"}}function DO(){return{type:\"FractionEmpty\"}}function $I(e){return{type:\"AdjacentNumbers\",args:e}}function SO(){return{type:\"UnexpectedFor\"}}function OO(){return{type:\"TokenWithSubscript\"}}var O3={\"+\":!0,\"-\":!0,\"*\":!0,\"\\\\cdot\":!0,\"\\\\times\":!0,\"/\":!0,\"!\":!0,\"(\":!0,\")\":!0,\"\\\\{\":!0,\"\\\\}\":!0,\"(|\":!0,\"|)\":!0,\"[\":!0,\"]\":!0,\",\":!0,\"...\":!0,\":\":!0,\"=\":!0,\">\":!0,\"<\":!0,\">=\":!0,\"<=\":!0,\"->\":!0,\"~\":!0,\"%\":!0,\".\":!0,for:!0,with:!0,Letter:!0,Decimal:!0,Cmd:!0,TokenNode:!0,Differential:!0,End:!0,Trig:!0,Ln:!0,Log:!0,Int:!0,Sum:!0,Prod:!0,Err:!0};function l7(e){let t=Ra[e];if(!t)return!0;switch(t){case\"Ln\":case\"Log\":case\"for\":case\"with\":case\"Trig\":return!0;default:return!1}}var Ra={\"\\\\lt\":\"<\",\"\\\\gt\":\">\",\"\\\\le\":\"<=\",\"\\\\ge\":\">=\",\"\\\\leq\":\"<=\",\"\\\\geq\":\">=\",\"\\\\ldots\":\"...\",\"\\\\sim\":\"~\",\"\\\\to\":\"->\",\"\\\\cdot\":\"\\\\cdot\",\"\\\\times\":\"\\\\times\",\"\\\\div\":\"/\",\"\\\\ln\":\"Ln\",\"\\\\log\":\"Log\",\"\\\\int\":\"Int\",\"\\\\sum\":\"Sum\",\"\\\\prod\":\"Prod\",\"\\\\backslash\":\"Err\",\"\\\\for\":\"for\",\"\\\\with\":\"with\"},R3=[\"sin\",\"cos\",\"tan\",\"cot\",\"sec\",\"csc\"];for(let e of R3)Ra[\"\\\\\"+e]=\"Trig\",Ra[\"\\\\\"+e+\"h\"]=\"Trig\",Ra[\"\\\\arc\"+e]=\"Trig\",Ra[\"\\\\arc\"+e+\"h\"]=\"Trig\",Ra[\"\\\\ar\"+e+\"h\"]=\"Trig\";function p7(e){return e===\"\\\\log\"||e===\"\\\\prod\"||e===\"\\\\sum\"||e===\"\\\\int\"}var YI={\"+\":\"+\",\"-\":\"-\",\"*\":\"*\",\"/\":\"/\",\"!\":\"!\",\"(\":\"(\",\")\":\")\",\"[\":\"[\",\"]\":\"]\",\",\":\",\",\"...\":\"...\",\":\":\":\",\"=\":\"=\",\">=\":\">=\",\"<=\":\"<=\",\">\":\">\",\"<\":\"<\",\"~\":\"~\",\".\":\".\"},RO={\"\\\\{\":\"\\\\{\",\"\\\\}\":\"\\\\}\",\"\\\\%\":\"%\"},CO={\"|\":\"(|\",\"\\\\{\":\"\\\\{\",\"[\":\"[\",\"(\":\"(\"},NO={\"|\":\"|)\",\"\\\\}\":\"\\\\}\",\"]\":\"]\",\")\":\")\"},AO=Object.keys(O3);function _O(e,t,r,n,i,s,o,a){return{opts:e,input:t,prevSpan:r,startIndex:n,endIndex:i,token:s,mode:o,parent:a}}function Te(e,t){return Qn(e.token.span,t.prevSpan)}function qr(e,t){return Qn(e,t.prevSpan)}function ZI(e){return so(e.token.span.input,e.token.span.start)}function C3(e,t){return{type:\"Differential\",span:e,val:t}}function ui(e,t,r){return{type:e,span:t,val:r}}function Ca(e,t){let r=so(e.span.input,e.span.start);return WI(t,e,0,r,void 0,void 0)}function WI(e,t,r,n,i,s){let o=t.args;if(r>o.length&&s)return LO(s,n);r=Hf(o,r);let{token:a,endIndex:u}=wO(t,r,i);if(a.type===\"End\"&&s){let c=s.input.args[s.startIndex];if(c.type===\"LeftRight\"){let l=c.right,p=NO[l.val]||\"Err\",f=ui(p,l.span,l.val);return _O(e,t,n,r,u,f,i,s)}}else a.type===\"Int\"?i=N3(i):a.type===\"Differential\"&&(i=A3(i));return _O(e,t,n,r,u,a,i,s)}function Ve(e){let t=e.input.args[e.startIndex],r=e.token.span;return t&&t.type===\"LeftRight\"?WI(e.opts,t.arg,0,r,e.mode,e):LO(e,r)}function LO(e,t){let{input:r,endIndex:n,mode:i,parent:s}=e;return WI(e.opts,r,n+1,t,i,s)}function Vn(e){return e.token}function N3(e){return{type:\"integral\",parent:e}}function A3(e){if(!e||e.type!==\"integral\")throw new Error(\"Programming Error: expected lexer to be in integral mode.\");return e.parent}function vn(e,t){return Vn(e).type===t}function Qy(e){return e.startIndex>=e.input.args.length}function jI(e,t){return t.token.span.start>e.token.span.start}function un(e,t){return{token:t,endIndex:e}}function wO(e,t,r){let n=e.args;if(t>=n.length){let o=so(e.span.input,e.span.end);return un(t,ui(\"End\",o,\"\"))}let i=e.args[t];switch(i.type){case\"Sqrt\":case\"Frac\":case\"SupSub\":return un(t,i);case\"Letter\":{if(!r||r.type!==\"integral\"||i.val!=\"d\")return un(t,i);let{endIndex:l,token:p}=wO(e,t+1,r);if(p.type===\"Letter\"||p.type===\"Cmd\"){let f=C3(Qn(i.span,p.span),p.val);return un(l,f)}else return un(t,i)}case\"LeftRight\":{let l=i.left,p=CO[l.val]||\"Err\";var s=Qn(i.span,l.span);return un(t,ui(p,s,l.val))}case\"OperatorName\":let o=[];for(let l of i.arg.args){if(l.type!==\"Letter\")return un(t,ui(\"Err\",i.span,Sr(i.arg.span)));o.push(l.val)}let a=\"\\\\\"+o.join(\"\"),u=Ra[a]||\"Cmd\";return un(t,ui(u,i.span,a));case\"TokenNode\":{let l=\"$\";if(i.arg.args.length===0)return un(t,ui(\"Err\",i.span,Sr(i.arg.span)));for(let p of i.arg.args){if(p.type!==\"Digit\")return un(t,ui(\"Err\",i.span,Sr(i.arg.span)));l+=p.val}return un(t,ui(\"TokenNode\",i.span,l))}case\"Cmd\":{let l=Ra[i.val]||\"Cmd\";return un(t,ui(l,i.span,i.val))}case\"EscapedSymbol\":{let l=RO[i.val]||\"Err\";return un(t,ui(l,i.span,i.val))}case\"Symbol\":return _3(e,t,i);case\"Digit\":return FO(e,t);default:throw`Unexpected atom ${i.type}.`}}function _3(e,t,r){switch(r.val){case\".\":return L3(e,t);case\"-\":{let i=e.args[t+1];if(i&&jy(i,\">\")){let s=ui(\"->\",Qn(r.span,i.span),\"->\");return un(t+1,s)}break}case\"<\":{let i=e.args[t+1];if(i&&jy(i,\"=\")){let s=ui(\"<=\",Qn(r.span,i.span),\"<=\");return un(t+1,s)}break}case\">\":{let i=e.args[t+1];if(i&&jy(i,\"=\")){let s=ui(\">=\",Qn(r.span,i.span),\">=\");return un(t+1,s)}break}}let n=YI[r.val]||\"Err\";return un(t,ui(n,r.span,r.val))}function L3(e,t){let r=e.args[t];if(r.type!==\"Symbol\"||r.val!==\".\")throw new Error(\"Programming Error: expected '.'\");if(t+2<e.args.length&&Jy(e.args[t+1])&&Jy(e.args[t+2])){let s=Qn(r.span,e.args[t+2].span);return un(t+2,ui(\"...\",s,Sr(s)))}let n=Hf(e.args,t+1);if(n<e.args.length&&e.args[n].type===\"Digit\")return FO(e,t);let i=YI[r.val]||\"Err\";return un(t,ui(i,r.span,r.val))}function FO(e,t){let r=w3(e,t);if(r)return r;let n=e.args,i=e.args[t].span,s=[],o=!1,a=!1;for(;t<n.length;t++){let c=Hf(n,t);if(c>=n.length)break;let l=n[c];if(l.type===\"Digit\")t=c,o=!0,s.push(l.val);else if(!a&&Jy(l)){if(c+1<n.length&&Jy(e.args[c+1]))break;t=c,a=!0,s.push(\".\")}else break}if(!o)throw new Error(\"Programming Error: decimals must have at least one digit.\");let u=Qn(i,e.args[t-1].span);return un(t-1,ui(\"Decimal\",u,s.join(\"\")))}function w3(e,t){let r=e.args,n=r[t].span,i=[];for(;t<r.length;t++){let c=Hf(r,t);if(c>=r.length)break;let l=r[c];if(l.type!==\"Digit\")break;t=c,i.push(l.val)}if(t=Hf(r,t),t>=r.length)return;let s=r[t];if(s.type!==\"Frac\")return;let o=[],a=[];for(let c of s.num.args)if(!XI(c)){if(c.type!==\"Digit\")return;o.push(c.val)}for(let c of s.den.args)if(!XI(c)){if(c.type!==\"Digit\")return;a.push(c.val)}let u=Qn(n,s.span);return un(t,QS(u,i.join(\"\"),o.join(\"\"),a.join(\"\")))}function XI(e){switch(e.type){case\"Sqrt\":case\"Frac\":case\"SupSub\":case\"LeftRight\":case\"OperatorName\":case\"TokenNode\":case\"Symbol\":case\"Letter\":case\"Digit\":return!1;case\"Cmd\":return e.val===\"\\\\space\";case\"EscapedSymbol\":return e.val===\"\\\\ \"||e.val===\"\\\\:\"||e.val===\"\\\\,\"||e.val===\"\\\\;\";default:throw`Unexpected atom ${e.type}.`}}function Hf(e,t){for(;t<e.length&&XI(e[t]);)t+=1;return t}function Jy(e){return jy(e,\".\")}function jy(e,t){return e.type===\"Symbol\"&&e.val===t}function Ql(e){return{type:\"initial\",tokenType:e}}function Uf(e){return{type:\"l\",tokenType:e}}function qf(e){return{type:\"r\",tokenType:e}}function Xt(e){return{type:\"la\",tokenType:e}}function Kl(e){return{type:\"ra\",tokenType:e}}function VO(e,t){for(let r of AO)if(t[r]===void 0)throw new Error(`Programming Error: token ${r} must be a assigned a ${e} precedence`)}function Cc(e,t,r,n){if(t[r]!==void 0)throw new Error(`Programming Error: duplicate ${e} entry for token ${r}.`);t[r]=n}function BO(e){let t={},r={},n={};for(let a=0;a<e.length;a++){let u=e[a];for(let{type:c,tokenType:l}of u)switch(c){case\"initial\":Cc(\"initial\",t,l,a);break;case\"l\":Cc(\"left\",r,l,a);break;case\"r\":Cc(\"right\",n,l,a);break;case\"la\":Cc(\"left\",r,l,a),Cc(\"right\",n,l,a);break;case\"ra\":Cc(\"left\",r,l,a),Cc(\"right\",n,l,a-1);break}}VO(\"left\",r),VO(\"right\",n);function i(a){return n[a]}function s(a){return r[a]}function o(a){let u=t[a];return u===void 0?i(a):u}return{rightPrec:i,leftPrec:s,initialPrec:o}}var ep={},F3=[\"sin\",\"cos\",\"tan\",\"cot\",\"sec\",\"csc\",\"sinh\",\"cosh\",\"tanh\",\"coth\",\"sech\",\"csch\"];F3.forEach(function(e){ep[e]=\"arc\"+e,ep[\"arc\"+e]=e});var V3=0;function UO(e,t){return B3(e,t)}function lt(e,t){let r=[];for(let n=0;n<t.length;n++)r.push(cr(e,t[n]));return r}function B3(e,t){return e.setInput(G3(e,t),t.span)}function qO(e){if(e.type!==\"Call\")return;let[t,r]=e.args,n=an(r);if(Ur(t)&&n.every(Ur))return{base:t,args:n}}function $O(e){return qO(e)!==void 0}function YO(e){return e.type===\"Paren\"&&e.args[0].type===\"Seq\"&&e.args[0].args.every(Ur)}function KI(e){return Ur(e)||YO(e)}function G3(e,t){let r=e.nodes;switch(t.type){case\"Comparator\":if(t.symbol===\"=\"){let[n,i]=t.args,s=qO(n);if(s){let{base:o,args:a}=s;return r.FunctionDefinition(cr(e,o),lt(e,a),cr(e,i))}else if(KI(n)){let o;if(i.type===\"For\")o=e.setInput(eg(e,i,{parentIsList:!1}),i.span);else if(o=cr(e,i),YO(n))return r.CoordinateEquation(cr(e,n),o);return r.Assignment(cr(e,n),o)}return r.Equation(cr(e,n),cr(e,i))}else return ea(e,t);case\"Tilde\":{let[n,i]=lt(e,t.args);return r.Regression(n,i)}case\"ComparatorChain\":{if(!e.specializeDoubleInequalities||t.symbols.length!==2)return ea(e,t);let[n,i,s]=t.args,[o,a]=t.symbols;return!Ur(i)||t.symbols.includes(\"=\")?ea(e,t):r.DoubleInequality([cr(e,n),o,cr(e,i),a,cr(e,s)])}case\"Call\":{let[n,i]=t.args;if(n.type===\"Cmd\")switch(n.val){case\"histogram\":return r.Histogram(lt(e,an(i)));case\"dotplot\":return r.DotPlot(lt(e,an(i)));case\"boxplot\":return r.BoxPlot(lt(e,an(i)));case\"ttest\":return r.TTest(lt(e,an(i)));case\"ittest\":return r.IndependentTTest(lt(e,an(i)));case\"stats\":return r.Stats(lt(e,an(i)));default:return $f(e,t)}return $f(e,t)}case\"For\":return eg(e,t,{parentIsList:!1});default:return $f(e,t)}}function XO(e){if(e.type!==\"Paren\")return!1;let[t]=e.args;return t.type!==\"Seq\"?!1:t.args.length===2||t.args.length===3}function cr(e,t){return e.setInput($f(e,t),t.span)}function $f(e,t){let r=e.nodes;switch(t.type){case\"Pos\":return cr(e,t.args[0]);case\"Neg\":let n=-1,i=t.args[0];for(;;)if(i.type===\"Pos\"||i.type===\"Paren\"&&!XO(i))i=i.args[0];else if(i.type===\"Neg\")i=i.args[0],n*=-1;else break;switch(i.type){case\"Decimal\":{let o=kO(i);return r.Constant(n===-1?xi(o):o)}case\"MixedNumber\":{let o=HO(i);return r.MixedNumber(n===-1?xi(o):o)}default:return n===-1?r.Negative([cr(e,i)]):cr(e,i)}case\"Add\":return r.Add(lt(e,t.args));case\"Sub\":return r.Subtract(lt(e,t.args));case\"Mul\":return r.Multiply(lt(e,t.args));case\"DotMul\":return r.DotMultiply(lt(e,t.args));case\"CrossMul\":return r.CrossMultiply(lt(e,t.args));case\"Div\":return r.Divide(lt(e,t.args));case\"Bang\":{let[o]=t.args;return o.type===\"Call\"&&Ur(o.args[0])&&!Ky(o.args[0])&&an(o.args[1]).length===1?r.FunctionFactorial(lt(e,o.args)):r.FunctionCall(\"\\\\factorial\",lt(e,t.args))}case\"PercentOf\":return r.PercentOf(lt(e,t.args));case\"Call\":return GO(e,t);case\"ImplicitCall\":return $3(t),GO(e,t);case\"Dot\":{let o=t.args[1],[a,u]=lt(e,t.args);if(Ky(o)){let c=so(o.span.input,o.span.end),l=e.setInput(WO(e),c);u=e.setInput(r.SeededFunctionCall(u,[l]),o.span)}else if(o.type===\"Letter\")switch(o.val){case\"x\":case\"y\":case\"z\":return r.NamedCoordinateAccess(o.val,[a]);default:break}else if(o.type===\"Call\"){let c=o.args[0];if(c.type===\"Letter\")switch(c.val){case\"x\":case\"y\":case\"z\":return r.Multiply([e.setInput(r.NamedCoordinateAccess(c.val,[a]),Qn(t.args[0].span,c.span)),cr(e,o.args[1])])}}return r.DotAccess([a,u])}case\"Prime\":{let[o]=t.args;if(o.type===\"Call\"){let[a,u]=o.args,c=an(u).length;if(a.type===\"Cmd\"&&a.val===\"logbase\"){if(c!==2)throw rc()}else if(c!==1)throw rc();return r.Prime(t.nprimes,lt(e,t.args))}else throw o.type===\"ImplicitCall\"?pm():lm()}case\"Index\":{let[o,a]=t.args;if(a.type===\"Seq\")return r.ListAccess([cr(e,o),e.setInput(r.List(lt(e,a.args)),void 0)]);if(a.type===\"Ellipsis\"){let[u,c]=a.args;return r.ListAccess([cr(e,o),e.setInput(r.Range([e.setInput(r.List(lt(e,an(u))),void 0),e.setInput(r.List(c.type===\"EmptyRangeEnd\"?[]:lt(e,an(c))),void 0)]),void 0)])}return Yf(a)?r.ListAccess([cr(e,o),e.setInput(ea(e,a),void 0)]):r.ListAccess(lt(e,t.args))}case\"Paren\":{let[o]=t.args;if(o.type===\"Seq\"){if(o.args.length===0)throw Ix();return r.ParenSeq(lt(e,o.args))}else return cr(e,o)}case\"List\":{if(t.args.length===0)return r.List([]);let o=t.args[0];if(o.type===\"Ellipsis\"){let[a,u]=o.args;return r.Range([e.setInput(r.List(lt(e,an(a))),void 0),e.setInput(r.List(lt(e,an(u))),void 0)])}else if(o.type===\"For\")return eg(e,o,{parentIsList:!0});return r.List(lt(e,an(o)))}case\"Pipes\":{let[o]=t.args;return r.Norm([cr(e,o)])}case\"Subscript\":{let[o,a]=t.args;if(a.val.length===0)throw cm();let u;switch(o.type){case\"Letter\":u=o.val;break;case\"Cmd\":u=o.val;break;default:throw bx()}if(u===\"ans\")throw Ln(\"ans\");return r.Identifier(`${u}_${a.val}`)}case\"Superscript\":{let[o,a]=t.args;if(o.type===\"Call\"&&o.args[1].type!==\"Seq\"&&!Ky(o.args[0])&&!Y3(o))return r.FunctionExponent(lt(e,[o.args[0],o.args[1],a]));if(o.type===\"Dot\"){let u=o.args[1],[c,l]=lt(e,o.args),p=cr(e,a);if(u.type===\"Letter\")switch(u.val){case\"x\":case\"y\":case\"z\":return r.Exponent([e.setInput(r.NamedCoordinateAccess(u.val,[c]),o.span),p]);default:break}else if(u.type===\"Call\"){let f=u.args[0];if(f.type===\"Letter\")switch(f.val){case\"x\":case\"y\":case\"z\":return r.Multiply([e.setInput(r.NamedCoordinateAccess(f.val,[c]),Qn(o.args[0].span,f.span)),e.setInput(r.Exponent([cr(e,u.args[1]),p]),gi(t.span.input,u.args[0].span.end,a.span.end))]);default:break}}return r.Exponent([e.setInput(r.DotAccess([c,l]),o.span),p])}else return r.Exponent(lt(e,t.args))}case\"Sqrt\":return r.FunctionCall(\"sqrt\",lt(e,t.args));case\"Nthroot\":return r.FunctionCall(\"nthroot\",lt(e,[t.args[1],t.args[0]]));case\"Frac\":return r.Divide(lt(e,t.args));case\"Derivative\":{let o=lt(e,t.args);if(!Ur(t.args[0]))throw ee(`Expected identifier in derivative, but found ${t.args[0].type}`);return r.Derivative(o[0],[o[1]])}case\"Integral\":{let[o,a,u,c]=t.args,l=lt(e,[o,a,u,c]);return r.Integral(l)}case\"EmptyIntegral\":{let[o,a,u]=lt(e,t.args),c=e.setInput(r.Constant(Re(1,1)),void 0);return r.Integral([o,a,u,c])}case\"Sum\":{let[o,a,u]=t.args;if(a.type!==\"Comparator\"||!tp(a))throw gP();let c=lt(e,[a.args[0],a.args[1],u]),l=cr(rg(e,{prefix:\"ro\",expr:c[0]}),o);return r.Sum(c.concat(l))}case\"Product\":{let[o,a,u]=t.args;if(a.type!==\"Comparator\"||!tp(a))throw hP();let c=lt(e,[a.args[0],a.args[1],u]),l=cr(rg(e,{prefix:\"ro\",expr:c[0]}),o);return r.Product(c.concat(l))}case\"Juxt\":{if(e.writeIntegral){let[u,c]=t.args;if(c.type===\"Letter\"&&c.val===\"t\"&&u.type===\"Juxt\"&&([u,c]=u.args,c.type===\"Letter\"&&c.val===\"n\")){if(u.type===\"Juxt\"){if([u,c]=u.args,c.type===\"Letter\"&&c.val===\"i\")throw vm()}else if(u.type===\"Letter\"&&u.val===\"i\")throw vm()}}let[o,a]=t.args;if(o.type===\"MixedNumber\"&&!(Ur(a)||a.type===\"Piecewise\"||a.type===\"Call\"||a.type===\"Paren\"))throw um(tg(o));if(a.type===\"MixedNumber\")throw um(tg(a));return r.Multiply(lt(e,t.args))}case\"Letter\":return r.Identifier(t.val);case\"Cmd\":{let o=t.val;switch(o){case\"ans\":{if(e.currentIndex===void 0)throw Kp(\"ans\");return r.Ans(`ans_{${e.currentIndex-1}}`)}case\"approx\":throw jd(o);case\"dt\":{if(!e.allowDt)throw Kp(o);return r.Identifier(o)}case\"index\":{if(!e.allowIndex)throw Kp(o);return r.Identifier(o)}default:return r.Identifier(o)}}case\"With\":{if(e.isSubstitutionRHS)throw Cm();let[o,a]=t.args,u={...e,isSubstitutionRHS:!0};return r.Substitution(cr(u,o),H3(u,a))}case\"Decimal\":return r.Constant(kO(t));case\"MixedNumber\":return r.MixedNumber(HO(t));case\"Piecewise\":return q3(e,t);case\"RightArrow\":return U3(e,t);case\"Seq\":return r.BareSeq(lt(e,t.args));case\"EmptyPiecewise\":return r.Restriction([e.setInput(r.Constant(!0),so(t.span.input,t.span.start))]);case\"Comparator\":throw t.symbol===\"=\"?Ln(\"=\"):Jd();case\"ComparatorChain\":throw t.symbols.includes(\"=\")?Qh():Jd();case\"Tilde\":throw Ln(\"~\");case\"Colon\":throw Ln(\":\");case\"Ellipsis\":throw Ln(\"...\");case\"For\":return eg(e,t,{parentIsList:!1});case\"EmptyRangeEnd\":throw dP();case\"Err\":throw X3(t.error);default:throw`Unexpected surface node ${t.type}.`}}function JI(e){return ep.hasOwnProperty(e)}function ZO(e){return e===\"ln\"||e===\"log\"||e===\"logbase\"}function z3(e){return e.type===\"Decimal\"&&e.val===\"2\"}function k3(e){return e.type!==\"Neg\"?!1:(e=e.args[0],e.type===\"Decimal\"&&e.val===\"1\")}function GO(e,t){let r=e.nodes,[n,i]=t.args,s=cr(e,n),o=an(i),a=lt(e,o);if(Ky(n)){let u=so(i.span.input,i.span.start),c=e.setInput(WO(e),u);return r.SeededFunctionCall(s,[c].concat(a))}if(Ur(n))return r.FunctionCall(s,a);if(n.type===\"Superscript\"){let[u,c]=n.args;if(u.type===\"Cmd\"){let l=u.val;if(JI(l)||ZO(l)){if(z3(c))return r.Exponent([e.setInput(r.FunctionCall(l,a),void 0),cr(e,c)]);if(k3(c)&&ep[l]!==void 0)return r.FunctionCall(ep[l],a);throw JI(l)?vx(l):Dx(l===\"logbase\"?\"log\":l)}}}return r.Multiply([s,cr(e,i)])}function eg(e,t,{parentIsList:r}){let n=e.nodes,[i,s]=t.args,o=e.setInput(n.Identifier(`_comprehensionIndex_${V3++}`),void 0);if(i.type===\"For\")throw Wa(\"for\");let a=cr(rg(e,{prefix:\"li\",expr:o}),i),u=[];if(s.type===\"Seq\"){let p=!1,f=!1,m=!1;for(let g=0;g<s.args.length;g++){let y=s.args[g];tp(y)||e.allowIntervalComprehensions&&y.type===\"ComparatorChain\"?p=!0:f=!0,y.type===\"Cmd\"&&y.val===\"cursor\"&&(m=!0)}if(p&&f){let g=Wa(\"for\");throw m&&g.setCursorContext({type:\"for-assignment-lhs\",allowedTypes:[C]}),g}}let c=[];for(let p of an(s))if(e.allowIntervalComprehensions&&p.type===\"ComparatorChain\"){let f=QI(p),{min:m,identifier:g,max:y,open:d}=f;c.push({identifier:cr(e,g),bounds:[cr(e,m),cr(e,y)],open:d})}else if(p.type===\"Comparator\"&&tp(p)){let f=e.setInput(n.AssignmentExpression(lt(e,p.args)),p.span);u.push(f)}else{if(p.type===\"Comparator\")throw yl(\"a\");{let f=FP();throw p.type===\"Cmd\"&&p.val===\"cursor\"&&f.setCursorContext({type:\"for-assignment-lhs\",allowedTypes:[C]}),f}}let l=r;return n.ListComprehension(o,a,u,l,c)}function H3(e,t){let r=e.nodes;if(t.type===\"Seq\"){let s=!1,o=!1,a=!1;for(let u=0;u<t.args.length;u++){let c=t.args[u];if(c.type===\"With\")throw Wa(\"with\");if(tp(c)||zO(c))s=!0;else if(e.allowIntervalComprehensions&&c.type===\"ComparatorChain\")try{QI(c),o=!0}catch(l){a=!0}else a=!0}if((s||o)&&a)throw Wa(\"with\");if(o)throw Nm()}if(e.allowIntervalComprehensions&&t.type===\"ComparatorChain\"){let s;try{QI(t),s=!0}catch(o){s=!1}if(s)throw Nm()}if(t.type===\"With\")throw Cm();let n=an(t),i=[];for(let s of n){if(s.type!=\"Comparator\"||!tp(s)&&!zO(s))throw of();let o=e.setInput(r.AssignmentExpression(lt(e,s.args)),s.span);i.push(o)}return i}function zO(e){if(e.type!==\"Comparator\"||e.symbol!==\"=\")return!1;let t=e.args[0];if(t.type!==\"Call\")return!1;let[r,n]=t.args,i=an(n);return!!(Ur(r)&&i.every(s=>Ur(s)||s.type===\"Decimal\"))}function QI(e){if(e.symbols.length!==2)throw yl(\"a\");let[t,r,n]=e.args,[i,s]=e.symbols;if(!Ur(r))throw yl(\"a\");if(i!==\"<\"&&i!==\"<=\"||s!==\"<\"&&s!==\"<=\"||e.symbols.includes(\"=\"))throw yl(Sr(r.span));return{min:t,identifier:r,max:n,open:[i===\"<\",s===\"<\"]}}function U3(e,t){let r=e.nodes;if(!Ur(t.args[0]))throw Ab();return e=rg(e,{prefix:\"ec\",expr:e.setInput(r.Identifier(\"globalEventCount\"),void 0)}),r.UpdateRule(lt(e,t.args))}function q3(e,t){let r=e.nodes,[n]=t.args,i=an(n);if(i.length===1&&Yf(i[0])){let f=i[0];return r.Restriction([e.setInput(ea(e,f),f.span)])}if(i.length>1&&i.every(Yf)){let f=e.setInput(ea(e,i[0]),i[0].span);for(let m=1;m<i.length;m++){let g=e.setInput(ea(e,i[m]),i[m].span);f=e.setInput(r.Or([f,g]),Qn(i[0].span,i[m].span))}return r.Restriction([f])}let s,o=[];e:for(s=0;s<i.length;s++){let f=i[s];switch(f.type){case\"Colon\":{let[m,g]=f.args;if(!Yf(m))throw Rx();if(g.type===\"With\"&&g.args[1].type===\"Seq\")throw Wa(\"with\");o.push({condition:e.setInput(ea(e,m),m.span),if_expr:cr(e,g)});break}case\"Comparator\":case\"ComparatorChain\":o.push({condition:e.setInput(ea(e,f),f.span),if_expr:e.setInput(r.Constant(Re(1,1)),gi(\"1\",0,1))});break;case\"For\":throw Wa(\"for\");default:break e}}if(s===0)throw Sx();if(s<i.length-1)throw Ox();let a,u;s===i.length-1?(a=$f(e,i[s]),u=i[s]):a=r.Constant(NaN);let c=a,l=u==null?void 0:u.span,p;for(;o.length;)p=o.pop(),c=r.Piecewise([p.condition,p.if_expr,e.setInput(c,l)]),l=void 0;return c}function Yf(e){return e.type===\"Comparator\"||e.type===\"ComparatorChain\"}function ea(e,t){let r=e.nodes;switch(t.type){case\"Comparator\":return r.Comparator[t.symbol](lt(e,t.args));case\"ComparatorChain\":return r.ComparatorChain(t.symbols,lt(e,t.args));default:throw ee(`Unexpected type for condition: ${t.type}`)}}function $3(e){let[t,r]=e.args;if(t.type===\"Superscript\"&&(t=t.args[0]),t.type===\"Cmd\"&&t.val===\"logbase\"&&r.type===\"Seq\"&&r.args.length===2){if(!Io(r.args[0]))throw am(\"log\")}else if(!Io(r))throw t.type===\"Cmd\"?am(t.val):ee(`Unexpected type for args of implicit call: ${r.type}`)}function kO(e){return Xu(e.val)}function HO(e){let t=Xu(e.whole),r=Xu(e.num),n=Xu(e.den);return ps(t,es(r,n))}function Y3(e){if(e.type!==\"Call\")return!1;let t=e.args[0];for(;t.type===\"Superscript\"||t.type===\"Subscript\"||t.type===\"Prime\";)t=t.args[0];return t.type!==\"Cmd\"?!1:JI(t.val)||ZO(t.val)}function tp(e){return e.type===\"Comparator\"&&e.symbol===\"=\"&&Ur(e.args[0])}function X3(e){switch(e.type){case\"UnexpectedParseError\":case\"MissingBound\":case\"EmptyGroup\":case\"UnexpectedDifferential\":case\"UnexpectedEnd\":return ee(`Unexpected error type: ${e.type}`);case\"InvalidOperatorName\":return hx();case\"UnexpectedCloseDelimiter\":case\"MissingCloseDelimiter\":return SP(e.open,e.close);case\"UnrecognizedSymbol\":return e.val===\".\"?Ln(e.val):jd(e.val);case\"EmptyInput\":return Xp();case\"BinaryOperatorMissingRight\":case\"BinaryOperatorMissingLeft\":return Yp(e.val===\"%\"?\"% of\":e.val);case\"UnaryOperatorMissingLeft\":return lx(e.val);case\"UnaryOperatorMissingRight\":return px(e.val);case\"UnexpectedSubscript\":return Ax(e.base);case\"PercentMissingOf\":return RP();case\"SumMissingBound\":return mP();case\"ProductMissingBound\":return yP();case\"IntegralMissingBound\":return PP();case\"SumMissingBody\":return EP();case\"ProductMissingBody\":return MP();case\"IntegralMissingBody\":return vP();case\"DerivativeMissingBody\":return DP();case\"IntegralMissingDifferential\":return TP();case\"DifferentialWithSuperscript\":return IP();case\"FractionMissingNumerator\":return fx();case\"FractionMissingDenominator\":return dx();case\"FractionEmpty\":return mx();case\"EmptySuperscript\":return yx();case\"EmptySubscript\":return cm();case\"InvalidSubscript\":return gx(e.val);case\"SuperscriptWithPrime\":return xx();case\"PrimeWithoutParen\":return pm();case\"UnexpectedPrime\":return lm();case\"EmptyRadical\":return Px();case\"EmptyRadicalIndex\":return Tx();case\"EmptySquareBracket\":return Ex();case\"EmptyPipe\":return Mx();case\"FunctionMissingArgument\":return rs(e.val,1,0);case\"AdjacentNumbers\":return ox(tg(e.args[0]),tg(e.args[1]));case\"TokenWithSubscript\":return ax();case\"UnexpectedFor\":return Ln(\"for\");default:throw`Unexpected surface node ${e.type}.`}}function tg(e){switch(e.type){case\"Decimal\":return e.val;case\"MixedNumber\":return`${e.whole} ${e.num}/${e.den}`;default:let t=e;throw new Error(`Unexpected node type ${t.type}`)}}function Io(e){switch(e.type){case\"Letter\":case\"Decimal\":case\"MixedNumber\":case\"Cmd\":case\"EmptyPiecewise\":return!0;case\"Neg\":{let r=e.args[0];for(;;)if(r.type===\"Pos\"||r.type===\"Paren\"&&!XO(r))r=r.args[0];else if(r.type===\"Neg\")r=r.args[0];else break;return r.type===\"Decimal\"||r.type===\"MixedNumber\"}case\"Pos\":return Io(e.args[0]);case\"Paren\":return Io(e.args[0]);case\"Juxt\":case\"Mul\":case\"DotMul\":case\"CrossMul\":case\"Div\":return Io(e.args[0])&&Io(e.args[1]);case\"Subscript\":return Io(e.args[0]);case\"Superscript\":case\"Frac\":case\"Add\":case\"Sub\":return Io(e.args[0])&&Io(e.args[1]);case\"Piecewise\":{let[r]=e.args;return Yf(r)}case\"Call\":{let[r,n]=e.args;return Ur(r)||KS(r)?!1:Io(r)&&Io(n)}case\"Derivative\":case\"Sqrt\":case\"Nthroot\":case\"Pipes\":case\"Bang\":return!1;case\"Comparator\":case\"ComparatorChain\":case\"Tilde\":case\"ImplicitCall\":case\"Index\":case\"List\":case\"Seq\":case\"Integral\":case\"EmptyIntegral\":case\"Sum\":case\"Product\":case\"Colon\":case\"Ellipsis\":case\"For\":case\"With\":case\"Dot\":case\"PercentOf\":case\"Prime\":case\"EmptyRangeEnd\":case\"RightArrow\":return!1;default:throw`Unexpected surface node ${e.type}.`}}function Ky(e){return e.type!==\"Cmd\"?!1:e.val===\"random\"||e.val===\"shuffle\"}function WO(e){let t=e.nodes.ExtendSeed(\"\",[e.setInput(e.nodes.Identifier(\"globalRandomSeed\"),void 0),e.setInput(e.nodes.Seed(e.nextSeed()),void 0)]);if(!e.seedExtensions)return t;for(let{prefix:r,expr:n}of e.seedExtensions)t=e.nodes.ExtendSeed(r,[e.setInput(t,void 0),n]);return t}function rg(e,t){let r=e.seedExtensions||[];return{...e,seedExtensions:r.concat(t)}}var Z3=[[Ql(\"(\"),Xt(\")\"),Ql(\"\\\\{\"),Xt(\"\\\\}\"),qf(\"[\"),Xt(\"]\"),Ql(\"(|\"),Xt(\"|)\"),Xt(\"Differential\"),Xt(\"End\")],[Xt(\"for\")],[qf(\"with\")],[Kl(\"...\")],[Xt(\",\")],[Kl(\":\")],[qf(\"->\")],[Uf(\"with\")],[Xt(\"=\"),Xt(\">\"),Xt(\"<\"),Xt(\">=\"),Xt(\"<=\"),Xt(\"~\")],[Uf(\"->\")],[Xt(\"+\"),Xt(\"-\")],[Xt(\"*\"),Xt(\"\\\\cdot\"),Xt(\"\\\\times\"),Xt(\"/\"),Xt(\"Decimal\"),Xt(\"MixedNumber\"),Xt(\"Letter\"),Xt(\"Cmd\"),Xt(\"TokenNode\"),Xt(\"%\"),qf(\"(\"),Xt(\"\\\\{\"),Xt(\"(|\"),Xt(\"Frac\"),Xt(\"Sqrt\"),Xt(\"Trig\"),Xt(\"Ln\"),Xt(\"Log\"),Kl(\"Int\"),Kl(\"Sum\"),Kl(\"Prod\")],[Ql(\"+\"),Ql(\"-\")],[Xt(\"!\")],[Xt(\"SupSub\")],[Uf(\"[\"),Xt(\".\")],[Uf(\"(\")],[Xt(\"Err\")]],{leftPrec:ng,rightPrec:jO,initialPrec:eR}=BO(Z3),JO={trailingComma:!1};function tR(e,t){let r=t?{...JO,...t}:JO,n=Ca(e,r),i=W3(n);return i.type===\"Err\"&&i.error.type===\"EmptyGroup\"?Ne(i.span,tO()):i}function W3(e){return Tu(e,{isToplevel:!0})}function Tu(e,{isToplevel:t}={isToplevel:!1}){if(Qy(e))return Ne(Te(e,e),rO());let{state:r,tree:n}=en(e,0,{isToplevel:t});return n.type!==\"Err\"&&!Qy(r)?tE(r).tree:n}function B(e,t){return{state:e,tree:t}}function en(e,t,{isToplevel:r}={isToplevel:!1}){let n=e,i;if({state:n,tree:i}=j3(n),i.type===\"Err\")return B(n,i);if(!jI(e,n))throw new Error(\"Programming Error: parseInitial did not advance state.\");for(;!Qy(n);){let s;if(vn(n,\"(\")&&!K3(i)?s=jO(\"(\"):s=ng(Vn(n).type),t>=s)break;let o=n,a=J3(n,i,r)?ng(\"for\")-1:jO(Vn(n).type);if({state:n,tree:i}=Q3(n,i,a),i.type===\"Err\")return B(n,i);if(!jI(o,n))throw new Error(\"Programming Error: parseSuccessor did not advance state.\")}return B(n,i)}function ss(e){return e.type===\"UnexpectedDifferential\"||e.type===\"UnexpectedCloseDelimiter\"||e.type===\"UnexpectedEnd\"||e.type===\"BinaryOperatorMissingLeft\"}function j3(e){let t=e,r=Vn(e),n=eR(r.type),i;switch(r.type){case\"+\":{if(e=Ve(e),{state:e,tree:i}=en(e,n),i.type===\"Err\"){if(!ss(i.error))return B(e,i);let o=Te(t,e),a=Ne(o,zI(r.val));return B(e,a)}return B(e,IS(Te(t,e),[i]))}case\"-\":if(e=Ve(e),{state:e,tree:i}=en(e,n),i.type===\"Err\"){if(!ss(i.error))return B(e,i);let o=Te(t,e),a=Ne(o,zI(r.val));return B(e,a)}else return B(e,ES(Te(t,e),[i]));case\"(\":return Xf(e);case\"\\\\{\":return e=Ve(e),vn(e,\"\\\\}\")?(e=Ve(e),B(e,HS(Te(t,e)))):({state:e,tree:i}=en(e,n),{state:e,tree:i}=Zf(t,e,i,\"\\\\{\",\"\\\\}\"),i.type===\"Err\"?B(e,i):B(e,kS(Te(t,e),[i])));case\"[\":return e=Ve(e),vn(e,\"]\")?(e=Ve(e),B(e,AI(Te(t,e),[]))):({state:e,tree:i}=en(e,n),{state:e,tree:i}=Zf(t,e,i,\"[\",\"]\"),i.type===\"Err\"?B(e,i):B(e,AI(Te(t,e),[i])));case\"(|\":{if(e=Ve(e),vn(e,\"|)\")){e=Ve(e);let o=Te(t,e);return B(e,Ne(o,sO()))}return{state:e,tree:i}=en(e,n),{state:e,tree:i}=Zf(t,e,i,\"(|\",\"|)\"),i.type===\"Err\"?B(e,i):B(e,AS(Te(t,e),[i]))}case\"Frac\":{if(e.opts.disallowFrac)throw Om();e=Ve(e);let o=Tu(Ca(r.num,e.opts)),a=Tu(Ca(r.den,e.opts));if(o.type===\"Err\"&&o.error.type===\"EmptyGroup\"&&a.type===\"Err\"&&a.error.type===\"EmptyGroup\"){let u=Te(t,e),c=Ne(u,DO());return B(e,c)}if(o.type===\"Err\"&&o.error.type===\"EmptyGroup\"){let u=Te(t,e),c=Ne(u,MO());return B(e,c)}if(a.type===\"Err\"&&a.error.type===\"EmptyGroup\"){let u=Te(t,e),c=Ne(u,vO());return B(e,c)}if(o.type===\"Err\")return B(e,o);if(a.type===\"Err\")return B(e,a);if(eO(o,a)&&a.type===\"Juxt\"){let u=a.args[1],c;if({state:e,tree:c}=en(e,ng(\"*\")-1),c.type===\"Err\"){if(ss(c.error)){let l=Te(t,e);return B(e,Ne(l,TO()))}return B(e,c)}return B(e,FS(Te(t,e),[u,c]))}return B(e,wS(Te(t,e),[o,a]))}case\"Sqrt\":if(e=Ve(e),r.optArg){let o=Tu(Ca(r.optArg,e.opts));if(o.type===\"Err\")return o.error.type===\"EmptyGroup\"?B(e,Ne(o.span,oO())):B(e,o);let a=Tu(Ca(r.arg,e.opts));return a.type===\"Err\"?a.error.type===\"EmptyGroup\"?B(e,Ne(a.span,BI())):B(e,a):B(e,LS(Te(t,e),[o,a]))}else{let o=Tu(Ca(r.arg,e.opts));return o.type===\"Err\"?o.error.type===\"EmptyGroup\"?B(e,Ne(o.span,BI())):B(e,o):B(e,_S(Te(t,e),[o]))}case\"Trig\":case\"Ln\":{e=Ve(e);let o=Oc(Te(t,e),r.val),a=0,u=Vn(e);if(u.type===\"SupSub\"){if(e=Ve(e),u.sub){let p=Te(t,e),f=Ne(p,fO(o.val));return B(e,f)}let l=ig(u,e.opts);if(l){if(l.type===\"Err\")return B(e,l);o=Yy(Te(t,e),[o,l])}a=u.nprimes}let c=vn(e,\"(\");if(c){if({state:e,tree:i}=Xf(e),i.type===\"Err\")return B(e,i);i=Gf(Te(t,e),[o,i.args[0]])}else{if({state:e,tree:i}=en(e,n-1),i.type===\"Err\")return ss(i.error)?B(e,Ne(Te(t,e),HI(r.val))):B(e,i);i=CI(Te(t,e),[o,i])}if(a>0){let l=Te(t,e);if(!c){let p=Ne(l,UI());return B(e,p)}i=zf(l,a,[i])}return B(e,i)}case\"Log\":{e=Ve(e);let o=Te(t,e),a=Oc(o,r.val),u=0,c,l,p=Vn(e);if(p.type===\"SupSub\"&&(e=Ve(e),c=rR(p,e.opts),l=ig(p,e.opts),u=p.nprimes),c&&c.type===\"Err\")return B(e,c);if(l&&l.type===\"Err\")return B(e,l);let f=vn(e,\"(\");if(f){if({state:e,tree:i}=Xf(e),i.type===\"Err\")return B(e,i);i=i.args[0]}else if({state:e,tree:i}=en(e,n-1),i.type===\"Err\")return ss(i.error)?B(e,Ne(Te(t,e),HI(r.val))):B(e,i);let m=c?Oc(o,\"\\\\logbase\"):a,g=c?Xy(Te(t,e),an(i).concat(c)):i;if(l&&(m=Yy(Te(t,e),[m,l])),f?i=Gf(Te(t,e),[m,g]):i=CI(Te(t,e),[m,g]),u>0){let y=Te(t,e);if(!f){let d=Ne(y,UI());return B(e,d)}i=zf(y,u,[i])}return B(e,i)}case\"Int\":{e=Ve(e);let o=Vn(e);e=Ve(e);let a=eE(o,t,e);if(a.type===\"Err\")return a.error.type===\"MissingBound\"?B(e,Ne(a.span,hO())):B(e,a);let{sup:u,sub:c}=a,l;if(vn(e,\"Differential\"))return{state:e,tree:l}=KO(e),l.type===\"Err\"?B(e,l):B(e,BS(Te(t,e),[l,c,u]));if({state:e,tree:i}=en(e,n),i.type===\"Err\")return ss(i.error)?B(e,Ne(i.span,PO())):B(e,i);let p=i;return vn(e,\"Differential\")?({state:e,tree:l}=KO(e),l.type===\"Err\"?B(e,l):B(e,VS(Te(t,e),[l,c,u,p]))):B(e,Ne(Te(t,e),IO()))}case\"Sum\":{e=Ve(e);let o=Vn(e);e=Ve(e);let a=eE(o,t,e);if(a.type===\"Err\")return a.error.type===\"MissingBound\"?B(e,Ne(a.span,yO())):B(e,a);let{sup:u,sub:c}=a;return{state:e,tree:i}=en(e,n),i.type===\"Err\"?ss(i.error)?B(e,Ne(i.span,bO())):B(e,i):B(e,GS(Te(t,e),[i,c,u]))}case\"Prod\":{e=Ve(e);let o=Vn(e);e=Ve(e);let a=eE(o,t,e);if(a.type===\"Err\")return a.error.type===\"MissingBound\"?B(e,Ne(a.span,gO())):B(e,a);let{sup:u,sub:c}=a;return{state:e,tree:i}=en(e,n),i.type===\"Err\"?ss(i.error)?B(e,Ne(i.span,xO())):B(e,i):B(e,zS(Te(t,e),[i,c,u]))}case\"Cmd\":return e=Ve(e),i=Oc(Te(t,e),r.val),B(e,i);case\"TokenNode\":{e=Ve(e);let o=Vn(e);return o.type===\"SupSub\"&&o.sub?(e=Ve(e),B(e,Ne(Te(t,e),OO()))):(i=Oc(Te(t,e),r.val),B(e,i))}case\"Letter\":return e=Ve(e),i=jS(Te(t,e),r.val),B(e,i);case\"Decimal\":{e=Ve(e);let o=Zy(Te(t,e),r.val),a=e.token;if(a.type===\"Decimal\"||a.type===\"MixedNumber\"){let u=e;e=Ve(e);let c=Te(t,e),l=a.type===\"MixedNumber\"?a:Zy(Te(u,e),a.val);return B(e,Ne(c,$I([o,l])))}return B(e,o)}case\"MixedNumber\":{if(e.opts.disallowFrac)throw Om();e=Ve(e);let o=e.token;if(o.type===\"Decimal\"||o.type===\"MixedNumber\"){let a=e;e=Ve(e);let u=Te(t,e),c=o.type===\"MixedNumber\"?o:Zy(Te(a,e),o.val);return B(e,Ne(u,$I([r,c])))}return B(e,r)}case\"*\":case\"\\\\cdot\":case\"\\\\times\":case\"/\":case\",\":case\"=\":case\">\":case\"<\":case\">=\":case\"<=\":case\"->\":case\"~\":case\":\":case\"...\":case\"%\":case\".\":{e=Ve(e);let o=Te(t,e),a=Ne(o,aO(r.val));return B(e,a)}case\"for\":{e=Ve(e);let o=Te(t,e),a=Ne(o,SO());return B(e,a)}case\"with\":{e=Ve(e);let o=Te(t,e),a=Ne(o,FI());return B(e,a)}case\"!\":{e=Ve(e);let o=Te(t,e),a=Ne(o,kI(r.val));return B(e,a)}case\"SupSub\":{e=Ve(e);let o=\"supsub\";r.sub?o=\"subscript\":r.sup?o=\"superscript\":r.nprimes>0&&(o=\"prime\");let a=Te(t,e),u=Ne(a,kI(o));return B(e,u)}case\")\":case\"\\\\}\":case\"]\":case\"|)\":case\"Differential\":return tE(e);case\"Err\":{e=Ve(e);let o=Te(t,e),a=Ne(o,lO(r.val));return B(e,a)}case\"End\":{let o=Te(t,e),a=Ne(o,GI());return B(e,a)}default:throw`Unexpected token type ${r.type}.`}}function J3(e,t,r){return vn(e,\"=\")&&r&&($O(t)||KI(t))}function Q3(e,t,r){let n=Vn(e),i;switch(n.type){case\"+\":case\"-\":case\"*\":case\"\\\\cdot\":case\"\\\\times\":case\"/\":case\"~\":case\":\":case\".\":case\"->\":case\"for\":{if(e=Ve(e),{state:e,tree:i}=en(e,r),i.type===\"Err\")if(ss(i.error)){let o=qr(t.span,e),a=Ne(o,Rc(n.val));return B(e,a)}else return B(e,i);return B(e,QO(n.type,qr(t.span,e),[t,i]))}case\"with\":{if(e=Ve(e),{state:e,tree:i}=en(e,r),i.type===\"Err\")if(ss(i.error)){let o=qr(t.span,e),a=Ne(o,Rc(n.val));return B(e,a)}else return B(e,i);return B(e,QO(n.type,qr(t.span,e),[t,i]))}case\"%\":{e=Ve(e);let o=Vn(e);if(o.type!==\"Cmd\"||o.val!==\"of\"&&o.val!==\"\\\\of\"){let a=Ne(n.span,dO());return B(e,a)}if(e=Ve(e),{state:e,tree:i}=en(e,r),i.type===\"Err\")if(ss(i.error)){let a=qr(t.span,e),u=Ne(a,Rc(n.val));return B(e,u)}else return B(e,i);return B(e,ZS(qr(t.span,e),[t,i]))}case\"=\":case\">=\":case\"<=\":case\">\":case\"<\":{let o=[t],a=[];for(;;){let c=Vn(e).type;if(c!==\"=\"&&c!==\">=\"&&c!==\"<=\"&&c!==\">\"&&c!==\"<\")break;if(a.push(c),e=Ve(e),{state:e,tree:i}=en(e,r),i.type===\"Err\")if(ss(i.error)){let l=qr(t.span,e),p=Ne(l,Rc(n.val));return B(e,p)}else return B(e,i);o.push(i)}let u=o[o.length-1];return u.type===\"Comparator\"?(o.pop(),Array.prototype.push.apply(o,u.args),a.push(u.symbol)):u.type===\"ComparatorChain\"&&(o.pop(),Array.prototype.push.apply(o,u.args),Array.prototype.push.apply(a,u.symbols)),o.length===2?B(e,xS(qr(t.span,e),a[0],o)):B(e,PS(qr(t.span,e),a,o))}case\"!\":return e=Ve(e),B(e,CS(qr(t.span,e),[t]));case\"[\":{let o=e;if(e=Ve(e),vn(e,\"]\")){e=Ve(e);let a=Te(o,e);return B(e,Ne(a,iO()))}return{state:e,tree:i}=en(e,r),{state:e,tree:i}=Zf(o,e,i,\"[\",\"]\"),i.type===\"Err\"?B(e,i):B(e,NS(qr(t.span,e),[t,i]))}case\"Sqrt\":case\"Frac\":case\"Letter\":case\"Cmd\":case\"TokenNode\":case\"Trig\":case\"Ln\":case\"Log\":case\"Sum\":case\"Int\":case\"Prod\":case\"Decimal\":case\"MixedNumber\":case\"\\\\{\":case\"(|\":return{state:e,tree:i}=en(e,r),i.type===\"Err\"?B(e,i):B(e,wI(qr(t.span,e),[t,i]));case\"(\":if(Ur(t)){if({state:e,tree:i}=Xf(e),i.type===\"Err\")return B(e,i);let o=qr(t.span,e);return B(e,Gf(o,[t,i.args[0]]))}else if(t.type===\"Prime\"&&Ur(t.args[0])){if({state:e,tree:i}=Xf(e),i.type===\"Err\")return B(e,i);let o=qr(t.span,e);return B(e,zf(o,t.nprimes,[Gf(o,[t.args[0],i.args[0]])]))}else return{state:e,tree:i}=en(e,r),i.type===\"Err\"?B(e,i):B(e,wI(qr(t.span,e),[t,i]));case\"SupSub\":{e=Ve(e);let o=nR(n),a=ig(n,e.opts);if(o&&o.type===\"Err\")return B(e,o);if(a&&a.type===\"Err\")return B(e,a);if(o&&(t=_I(qr(t.span,e),[t,o])),a&&(t=Yy(qr(t.span,e),[t,a])),n.nprimes>0){let u=qr(t.span,e);if(!Ur(t)){let c=Ne(u,Wy());return B(e,c)}t=zf(u,n.nprimes,[t])}return B(e,t)}case\",\":{let o=[t];for(;vn(e,\",\")&&(e=Ve(e),!(vn(e,\"...\")||e.opts.trailingComma&&eB(e)));){if({state:e,tree:i}=en(e,r),i.type===\"Err\")if(ss(i.error)){let a=qr(t.span,e),u=Ne(a,Rc(n.val));return B(e,u)}else return B(e,i);o.push(i)}return B(e,Xy(qr(t.span,e),o))}case\"...\":{if(e=Ve(e),vn(e,\",\")&&(e=Ve(e)),r>=ng(Vn(e).type))return B(e,LI(qr(t.span,e),[t,US(ZI(e))]));if({state:e,tree:i}=en(e,r),i.type===\"Err\")if(ss(i.error)){let o=qr(t.span,e),a=Ne(o,Rc(n.val));return B(e,a)}else return B(e,i);return B(e,LI(qr(t.span,e),[t,i]))}case\"]\":case\")\":case\"\\\\}\":case\"|)\":case\"Differential\":return tE(e);case\"Err\":return en(e,r);case\"End\":{let o=Te(e,e),a=Ne(o,GI());return B(e,a)}default:throw`Unexpected token type ${n.type}.`}}function K3(e){return!!(Ur(e)||e.type===\"Prime\"&&Ur(e.args[0]))}function QO(e,t,r){switch(e){case\"+\":return MS(t,r);case\"-\":return vS(t,r);case\"*\":return DS(t,r);case\"\\\\cdot\":return SS(t,r);case\"\\\\times\":return OS(t,r);case\"/\":return RS(t,r);case\"~\":return TS(t,r);case\":\":return qS(t,r);case\".\":return XS(t,r);case\"->\":return WS(t,r);case\"for\":return $S(t,r);case\"with\":return YS(t,r);default:throw`Unexpected token type ${e}.`}}function rR(e,t){if(!e.sub)return;let r=e.sub,n=Tu(Ca(r,t));return n.type===\"Err\"&&n.error.type===\"EmptyGroup\"?Ne(n.span,VI()):n}function nR(e){if(!e.sub)return;let t=e.sub;if(t.args.length===0)return Ne(t.span,VI());let r=[];for(let n of t.args)if(n.type===\"Digit\"||n.type===\"Letter\")r.push(n.val);else{let i=n.span;return Ne(i,pO(Sr(i)))}return JS(t.span,r.join(\"\"))}function ig(e,t){if(!e.sup)return;let r=Tu(Ca(e.sup,t));return r.type===\"Err\"?r.error.type===\"EmptyGroup\"?Ne(r.span,nO()):r:e.nprimes>0?Ne(e.span,mO()):r}function eE(e,t,r){if(e.type!==\"SupSub\"){let s=Te(t,r);return Ne(s,qI())}if(e.nprimes>0){let s=Te(t,r);return Ne(s,Wy())}let n=rR(e,r.opts),i=ig(e,r.opts);if(!n||n.type===\"Err\"&&n.error.type===\"EmptySubscript\"||!i||i.type===\"Err\"&&i.error.type===\"EmptySuperscript\"){let s=Te(t,r);return Ne(s,qI())}return n.type===\"Err\"?n:i.type===\"Err\"?i:{type:\"Bounds\",sup:i,sub:n}}function Xf(e){let t=e,r=Vn(e),n=eR(r.type);if(vn(e,\"(\"))e=Ve(e);else throw new Error(\"Programming Error: expected '(' at start of parseParen.\");if(vn(e,\")\")){let s=Xy(ZI(e),[]);e=Ve(e);let o=Te(t,e);return B(e,NI(o,[s]))}let i;return{state:e,tree:i}=en(e,n),{state:e,tree:i}=Zf(t,e,i,\"(\",\")\"),i.type===\"Err\"?B(e,i):B(e,NI(Te(t,e),[i]))}function KO(e){let t=e,r=Vn(e);if(r.type!==\"Differential\")throw new Error(\"Programming Error: expected differential\");e=Ve(e);let n=Oc(r.span,r.val),i=Vn(e);if(i.type===\"SupSub\"){e=Ve(e);let s=Te(t,e),o=nR(i);if(o){if(o.type===\"Err\")return B(e,o);n=_I(s,[n,o])}if(i.sup)return B(e,Ne(s,EO()));if(i.nprimes>0)return B(e,Ne(s,Wy()))}return B(e,n)}function Zf(e,t,r,n,i){if(r.type===\"Err\"&&r.error.type!==\"UnexpectedEnd\")return B(t,r);if(r.type===\"Err\"||!vn(t,i)){let s=Te(e,t),o=Ne(s,uO(n,i));return B(t,o)}return t=Ve(t),B(t,r)}function tE(e){let t=e;switch(Vn(e).type){case\")\":{e=Ve(e);let n=Te(t,e);return B(e,Ne(n,kf(\"(\",\")\")))}case\"]\":{e=Ve(e);let n=Te(t,e);return B(e,Ne(n,kf(\"[\",\"]\")))}case\"\\\\}\":{e=Ve(e);let n=Te(t,e);return B(e,Ne(n,kf(\"\\\\{\",\"\\\\}\")))}case\"|)\":{e=Ve(e);let n=Te(t,e);return B(e,Ne(n,kf(\"|\",\"|\")))}case\"Differential\":{e=Ve(e);let n=Te(t,e);return B(e,Ne(n,cO()))}default:{e=Ve(e);let n=Te(t,e);return B(e,Ne(n,FI()))}}}function eB(e){return vn(e,\")\")||vn(e,\"]\")||vn(e,\"\\\\}\")}function tB(){throw nf()}function iR(e,t){return t&&!e._inputSpan&&e.setInputSpan(t),e}function Hs(e,t={}){let r=typeof e;if(r!==\"string\")throw new Error(`Type Error: parse can only be called with strings, got ${JSON.stringify(e)} of type ${r}`);let n=v;if(t.disabledFeatures){n=Object.create(n);for(let l of t.disabledFeatures){if(!n[l])throw new Error(`Programming Error: ${l} cannot be disabled because it is not a parsenode.`);n[l]=tB}}let i=t.seedPrefix===void 0?\"\":t.seedPrefix,s=0,o=()=>{let l=`${i}::vc${s}`;return s+=1,l},a={nodes:n,currentIndex:t.index,setInput:iR,nextSeed:o,allowDt:!!t.allowDt,allowIndex:!!t.allowIndex,writeIntegral:!!t.writeIntegral,allowIntervalComprehensions:!!t.allowIntervalComprehensions,specializeDoubleInequalities:!!t.specializeDoubleInequalities},u={};t.trailingComma!==void 0&&(u.trailingComma=t.trailingComma),t.disallowFrac&&(u.disallowFrac=!0);function c(l){return l.parseOptions=t,l}if(e===\"\")return c(Xp());try{let l=gS(e),p=tR(l,u),f=UO(a,p);return f.parseOptions=t,f}catch(l){let p;return l instanceof v.Error?p=l:typeof l==\"string\"?p=new v.Error(l):p=ee(l),c(p)}}function nB(e,t,r){return{chunk:e,argMap:t,start:r}}function Na(e,t,r,n){let i=nB(e,[t],r);return rp(i,n)}function rp(e,t){let{chunk:r,argMap:n,start:i}=e;if(t<i)return t;let s=n[t-i];if(s!==void 0)return s;let o=iB(e,t);e.argMap[t-i]=o;let a=r.getInstruction(t);if(ni(a))switch(a.type){case 23:case 21:case 50:break;case 19:{let c=a.args.length-2;for(let l=0;l<c;l++)rp(e,t+1+l);break}case 53:{let l=r.getInstruction(a.args[0]).signature.parameterSymbols.length;for(let p=0;p<l;p++)rp(e,t+1+p);break}default:let u=a;throw new Error(`Programming Error. Unexpected OpCode: ${u.type}`)}else if(Un(a)){let u=a.args.length-1;for(let c=0;c<u;c++)rp(e,t+1+c)}return o}function iB(e,t){let{chunk:r,start:n}=e,i=r.getInstruction(t);if(Un(i)){let a=i.args[0];for(let u=a;u<=t;u++){let c=r.getInstruction(u);if(!ve(c))for(let l of c.args)l<a&&rp(e,l)}}if(ve(i))return Gs(r,i);let s=[];for(let a of i.args)s.push(rp(e,a));let o=e.argMap[t-n];return o!==void 0?o:Ir(r,i,s)}var Bt=Symbol(\"FRAME_SENTINEL\");function Nc(e,t){return rE(e,t).freeDependencies}function rE(e,t){let r={};return t.type===\"FunctionDefinition\"&&(t=t._expression),nE(e,t,r)}function sR(e,t,r){let n=[],i=[],s=[],o=[];for(let a of t.scopes){let u=sR(e,a,r);for(let c of u.freeDependencies)n.indexOf(c)===-1&&t.definitions.indexOf(c)===-1&&n.push(c);for(let c of u.updateSymbols)i.indexOf(c)===-1&&i.push(c);for(let c of u.substitutionSymbols)s.indexOf(c)===-1&&s.push(c)}for(let a of t.dependencies){if(t.definitions.indexOf(a)!==-1)continue;let u=sB(e,a,r),c=t.substitutionDependencies.indexOf(a)!==-1;for(let l of u.freeDependencies)n.indexOf(l)===-1&&t.definitions.indexOf(l)===-1&&n.push(l),c&&o.indexOf(l)===-1&&t.definitions.indexOf(l)===-1&&o.push(l);for(let l of u.updateSymbols)i.indexOf(l)===-1&&i.push(l);for(let l of u.substitutionSymbols)s.indexOf(l)===-1&&s.push(l)}return{freeDependencies:n,updateSymbols:i,substitutionSymbols:s}}function nE(e,t,r){if(t.type===\"Slider\"||t.type===\"Assignment\")return nE(e,t._expression,r);{let{freeDependencies:n,updateSymbols:i,substitutionSymbols:s}=sR(e,t.getScope(),r),o=t.getUpdateSymbols();if(o.length>0){i=i.slice();for(let u of o)i.indexOf(u)===-1&&i.push(u)}let a=t.getSubstitutionSymbols();if(a.length>0){s=s.slice();for(let u of a)s.indexOf(u)===-1&&s.push(u)}return{freeDependencies:n,updateSymbols:i,substitutionSymbols:s}}}function sB(e,t,r){if(r[t])return r[t];if(rt[t])return r[t]={freeDependencies:[],updateSymbols:[],substitutionSymbols:[]},r[t];let n=e[t];if(n===Bt)throw new Error(\"Programming error: _getSymbolFreeDependencies called with a symbol that is defined in a local scope\");return n?(r[t]={freeDependencies:[t],updateSymbols:[],substitutionSymbols:[]},r[t]=nE(e,n,r),r[t]):(r[t]={freeDependencies:[t],updateSymbols:[],substitutionSymbols:[]},r[t])}function oR(e,t){for(var r={},n=t.getDependencies().slice();n.length;){var i=n.pop();if(!r.hasOwnProperty(i)){var s=e[i];if(s===Bt)return;r[i]=s,s&&s.getDependencies&&Array.prototype.push.apply(n,s.getDependencies())}}return oB(r)}function oB(e){let t=[];for(let r in e)t.push([r,e[r]]);return t}function aR(e,t,r){uR(e,t,r,{})}function uR(e,t,r,n){let i={};for(let s of r.definitions){if(i[s])switch(r.kind){case\"Sum\":case\"Product\":case\"Integral\":throw ee(new Error(`${r.kind} scope is not expected to define multiple symbols`));case\"FunctionDefinition\":throw Cx(s);case\"ListComprehension\":throw Rm(s);case\"Substitution\":throw UP(s);default:let o=r.kind;throw ee(new Error(`Unexpected scope kind ${o}`))}i[s]=!0}for(let s of r.definitions){let o=t[s];if(o)switch(r.kind){case\"Sum\":case\"Product\":throw mm(s);case\"Integral\":throw Mm(s);case\"FunctionDefinition\":if(s===r.functionDefinitionSymbol)break;throw dm(s);case\"ListComprehension\":{if(o!==Bt&&o.type===\"FunctionDefinition\")throw ml(s);if(e.assignmentForbidden(s))throw dl(s);break}case\"Substitution\":break;default:let a=r.kind;throw ee(new Error(`Unexpected scope kind ${a}`))}if(n[s])switch(r.kind){case\"Sum\":case\"Product\":throw mm(s);case\"Integral\":throw Mm(s);case\"FunctionDefinition\":throw dm(s);case\"ListComprehension\":throw Rm(s);case\"Substitution\":throw af(s);default:let a=r.kind;throw ee(new Error(`Unexpected scope kind ${a}`))}}n=Object.create(n);for(let s of r.definitions)n[s]=!0;for(let s of r.scopes)uR(e,t,s,n)}function np(e,t,r){let n=e.getInstruction(t);if(!ce(n.valueType,T)&&!ce(n.valueType,C)&&!ce(n.valueType,V))throw vb([ne(n.valueType)]);let i=e.getInstruction(r);if(!ce(i.valueType,T)&&i.type!==0)throw ee(`Unexpected derivative var type ${i.valueType}`);let s=e.Constant(0);if(t<r)return s;let o=e.Constant(1),a=e.Constant(NaN),u=ru(e,r),c=yB(e,t);e.derivativeMaps[r]||(e.derivativeMaps[r]={maxValidReference:e.instructionsLength()-1,map:[]});let{map:l,maxValidReference:p}=e.derivativeMaps[r];for(let d=0;d<l.length;d++){let h=l[d];h!==void 0&&h>p&&(l[d]=void 0)}let f=[],m=!1;for(let d=0;d<r;d++)f[d]=d,l[d]=s;let g=Ii(e,t);return iE({chunk:e,derivativeVarIndex:r,forwardMask:u,backwardMask:c,referenced:g,valueMap:f,derivativeMap:l,mustCopy:m,ZERO:s,ONE:o,NAN:a},r,t),e.derivativeMaps[r].maxValidReference=e.instructionsLength()-1,l[t]}function iE(e,t,r){let{chunk:n,valueMap:i,derivativeMap:s,backwardMask:o}=e;for(let a=t;a<=r;a++){let u=s[a];if(u!==void 0)if(n.getInstruction(u).type===0)s[a]=void 0;else{i[a]=sg(e,a);continue}if(!o[a]){i[a]=sg(e,a);continue}let c=n.getInstruction(a);if(ni(c)&&c.endIndex!==-1)switch(c.type){case 21:{a=aB(e,a);continue}case 19:case 23:{a=lB(e,a);continue}}i[a]=sg(e,a),s[a]=pB(e,a)}return r}function aB(e,t){let{chunk:r,forwardMask:n,valueMap:i,derivativeMap:s,ZERO:o}=e,a=r.getInstruction(t),u=a.endIndex,c=r.getInstruction(u),l=o;if(n[a.args[1]]){let p=i[a.args[1]];l=r.Add([l,r.Multiply([s[a.args[1]],Na(r,p,t,c.args[1])])])}if(n[a.args[0]]){let p=i[a.args[0]];l=r.Subtract([l,r.Multiply([s[a.args[0]],Na(r,p,t,c.args[1])])])}if(uB(r,t,n)){let p=i.slice();p[t]=Ir(r,a,[p[a.args[0]],p[a.args[1]]]),s[t]=o,iE({...e,valueMap:p,mustCopy:!0},t+1,u-1);let f=Ir(r,c,[p[c.args[0]],s[c.args[1]]]);s[u]=f,l=r.Add([l,Ir(r,r.getInstruction(u+1),[f])])}else for(let p=t;p<=u;p++)s[p]=o;if(cB(r,t,i)){let p={...e,mustCopy:!0};for(let f=t;f<=u+1;f++)i[f]=sg(p,f)}else for(let p=t;p<=u+1;p++)i[p]=p;return s[u+1]=l,u+c.args.length-1}function uB(e,t,r){let n=e.getInstruction(t),i=e.getInstruction(n.endIndex);if(i.args[1]<t+1)return r[i.args[1]];for(let s=t+1;s<=i.args[1];s++){let o=e.getInstruction(s);if(!ve(o)){for(let a of o.args)if(a<t&&r[a])return!0}}return!1}function cB(e,t,r){let n=e.getInstruction(t);for(let i=t;i<=n.endIndex;i++){let s=e.getInstruction(i);if(!ve(s)){for(let o of s.args)if(r[o]!==o)return!0}}return!1}function lB(e,t){let{chunk:r,derivativeMap:n,valueMap:i,ZERO:s}=e,o=r.getInstruction(t),a=o.endIndex,u=r.getInstruction(a),c;if(o.type===23)i[t]=Ir(r,o,[i[o.args[0]]]),n[t]=s,c=t+1;else{let p=[];p.push(i[o.args[0]],i[o.args[1]]);for(let f=2;f<o.args.length;f++)p.push(i[o.args[f]],n[o.args[f]]);i[t]=Ir(r,o,p),n[t]=s;for(let f=2;f<o.args.length;f++)i[t+f-1]=Ir(r,r.getInstruction(t+f-1),[i[t]]),n[t+f-1]=Ir(r,r.getInstruction(t+f-1),[i[t]]);c=t+o.args.length-1}iE({...e,mustCopy:!0},c,a-1);let l=[];l.push(i[u.args[0]]);for(let p=1;p<u.args.length;p++)l.push(i[u.args[p]],n[u.args[p]]);i[a]=Ir(r,u,l),n[a]=s;for(let p=1;p<u.args.length;p++)i[a+p]=Ir(r,r.getInstruction(a+p),[i[a]]),n[a+p]=Ir(r,r.getInstruction(a+p),[i[a]]);return a+u.args.length-1}function sg(e,t){let{chunk:r,valueMap:n,mustCopy:i,referenced:s}=e;if(!s[t])return t;let o=r.getInstruction(t);if(ve(o))return i?Gs(r,o):t;{let a=[],u=!1;for(let c of o.args)a.push(n[c]),n[c]!==c&&(u=!0);return u||i?Ir(r,o,a):t}}function pB(e,t){let{chunk:r,derivativeVarIndex:n,forwardMask:i,valueMap:s,derivativeMap:o,ZERO:a,ONE:u,NAN:c}=e,l=r.getInstruction(t);if(t===n)if(W(l.valueType)){let f=Nr(r,t),m=r.BeginBroadcast([f]),g=r.EndBroadcast([m,u]);return r.BroadcastResult(le,[g])}else return u;if(ni(l)||Un(l)||l.type===47||l.type===48||l.type===25||l.type===27||l.type===26||l.type===29||l.type===28||l.type===32||l.type===31||l.type===42||l.type===44||l.type===49||l.valueType===et)return a;if(!i[t]||ve(l))return l.valueType!==T?dB(r,[s[t],a]):l.type!==1||isFinite(Y(l.value))?a:c;if(l.type===38||l.type===15||l.type===16){let f=[];for(let m of l.args)f.push(o[m]);return Ir(r,l,f)}if(l.type===33)return Ir(r,l,[s[l.args[0]],o[l.args[1]],o[l.args[2]]]);let p=a;for(let f=0;f<l.args.length;f++){if(!i[l.args[f]])continue;let m=o[l.args[f]];if(m===a)continue;let g=fB(e,s[t],f,m);g!==a&&(p=p===a?g:mB(r,[g,p]))}return p}function fB(e,t,r,n){let{chunk:i,ZERO:s,ONE:o,NAN:a}=e,u=i.getInstruction(t);switch(u.type){case 8:return n;case 9:switch(r){case 0:return n;default:return i.Negative([n])}case 10:switch(r){case 0:return i.Multiply([n,u.args[1]]);default:return i.Multiply([u.args[0],n])}case 11:switch(r){case 0:return i.Divide([n,u.args[1]]);default:return i.Multiply([u.args[0],i.Divide([i.Negative([n]),i.Multiply([u.args[1],u.args[1]])])])}case 14:return i.Negative([n]);case 12:case 13:switch(r){case 0:return i.Multiply([i.Multiply([u.args[1],i.Exponent([u.args[0],i.Subtract([u.args[1],o])])]),n]);default:return i.Multiply([i.Piecewise([i.Equal([u.args[0],s]),i.Piecewise([i.GreaterEqual([u.args[1],s]),s,a]),i.Multiply([i.SyntheticNativeFunction(\"ln\",[u.args[0]]),t])]),n])}case 37:return gB(i,t,lR[u.symbol][r],n);case 39:case 40:case 41:switch(r){case 0:return Ir(i,u,[n,u.args[1]]);default:return s}case 17:case 18:return Ir(i,u,[n]);case 55:throw ee(\"Unimplemented: derivatives of recursive functions\");default:{let c=u;throw new Error(`Unimplemented derivative for opcode ${c.type}`)}}}function dB(e,t){switch(e.getInstruction(t[0]).valueType){case Se:return e.SyntheticNativeFunction(\"scaleTangentSegment\",t);case be:return e.SyntheticNativeFunction(\"scaleTangentLine\",t);case _e:return e.SyntheticNativeFunction(\"scaleTangentRay\",t);case he:return e.SyntheticNativeFunction(\"scaleTangentCircle\",t);case fe:return e.SyntheticNativeFunction(\"scaleTangentArc\",t);case Ge:return e.SyntheticNativeFunction(\"scaleTangentUndirectedAngleMarker\",t);case Ae:return e.SyntheticNativeFunction(\"scaleTangentDirectedAngleMarker\",t);default:return e.Multiply(t)}}function mB(e,t){switch(e.getInstruction(t[0]).valueType){case Se:return e.SyntheticNativeFunction(\"addTangentSegment\",t);case Rt:return e.SyntheticNativeFunction(\"addTangentSegmentThreeD\",t);case be:return e.SyntheticNativeFunction(\"addTangentLine\",t);case _e:return e.SyntheticNativeFunction(\"addTangentRay\",t);case he:return e.SyntheticNativeFunction(\"addTangentCircle\",t);case fe:return e.SyntheticNativeFunction(\"addTangentArc\",t);case Ge:return e.SyntheticNativeFunction(\"addTangentUndirectedAngleMarker\",t);case Ae:return e.SyntheticNativeFunction(\"addTangentDirectedAngleMarker\",t);default:return e.Add(t)}}function yB(e,t){let r=[];for(let n=0;n<t;n++)r.push(!1);r.push(!0);for(let n=t;n>=0;n--){if(!r[n])continue;let i=e.getInstruction(n);if(!ve(i))if(i.type===33)r[i.args[1]]=!0,r[i.args[2]]=!0;else for(let s of i.args)r[s]=!0}return r}function gB(e,t,r,n){let i=Object.create(rt),s=_f({},{},-1),a=e.getInstruction(t).args;for(let u=0;u<a.length;u++){let c=hB[u];Kr(s,c,a[u]),i[c]=Bt}return Kr(s,\"x_1\",n),i.x_1=Bt,Kr(s,\"q\",t),i.q=Bt,Ie(ci(rS,i,e,s,Wf.root,void 0,void 0),r)}var hB=[\"x\",\"y\",\"z\",\"u\"],cR={exp:[\"q*x_1\"],ln:[\"\\\\{x >= 0: x_1/x \\\\}\"],log:[\"\\\\{x >= 0: x_1/(x*\\\\ln(10)) \\\\}\"],sqrt:[\"x_1/(2*q)\"],rtxsqpone:[\"x*x_1/q\"],rtxsqmone:[\"x*x_1/q\"],sin:[\"\\\\cos(x)*x_1\"],cos:[\"-\\\\sin(x)*x_1\"],tan:[\"(1+q^2)*x_1\"],arcsin:[\"x_1/\\\\sqrt{1 - x^2}\"],arccos:[\"-x_1/\\\\sqrt{1 - x^2}\"],sinh:[\"\\\\cosh(x)*x_1\"],cosh:[\"\\\\sinh(x)*x_1\"],tanh:[\"(\\\\sech(x))^2*x_1\"],arcsinh:[\"x_1/\\\\rtxsqpone(x)\"],arccosh:[\"\\\\{ x > 0: x_1/\\\\rtxsqmone(x) \\\\}\"],arctanh:[\"\\\\{ \\\\abs(x) < 1: x_1/(1 - x^2) \\\\}\"],csc:[\"-\\\\cot(x)*q*x_1\"],sec:[\"\\\\tan(x)*q*x_1\"],cot:[\"-(1+q^2)*x_1\"],arccsc:[\"-x_1/(\\\\abs(x)*\\\\rtxsqmone(x))\"],arcsec:[\"x_1/(\\\\abs(x)*\\\\rtxsqmone(x))\"],arccot:[\"-x_1/(1+x^2)\"],csch:[\"-\\\\coth(x)*q*x_1\"],sech:[\"-\\\\tanh(x)*q*x_1\"],coth:[\"-(\\\\csch(x))^2*x_1\"],arccsch:[\"-x_1/(\\\\abs(x)*\\\\rtxsqpone(x))\"],arcsech:[\"\\\\{ x >= 0: -x_1/(x*\\\\sqrt{1 - x^2}) \\\\}\"],arccoth:[\"\\\\{ \\\\abs(x) > 1 : x_1/(1 - x^2) \\\\}\"],factorial:[\"q*\\\\polyGamma(0, x + 1)*x_1\"],floor:[\"\\\\{ q=x: 0/0, 0*x_1 \\\\}\"],ceil:[\"\\\\{ q=x: 0/0, 0*x_1 \\\\}\"],round:[\"\\\\{ \\\\abs(\\\\mod(x, 1) - 0.5) > 0: 0*x_1 \\\\}\"],abs:[\"\\\\{ x=0: 0/0, \\\\sign(x)*x_1 \\\\}\"],sign:[\"\\\\{ x=0: 0/0, 0*x_1 \\\\}\"],distance:[\"-((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y)/q\",\"((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y)/q\"],distanceThreeD:[\"-((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y+(y.z-x.z)*x_1.z)/q\",\"((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y+(y.z-x.z)*x_1.z)/q\"],segmentThreeD:[\"\\\\segmentThreeD(x_1,(0,0,0))\",\"\\\\segmentThreeD((0,0,0),x_1)\"],vectorThreeD:[\"\\\\vectorThreeD(x_1,(0,0,0))\",\"\\\\vectorThreeD((0,0,0),x_1)\"],triangle:[\"\\\\triangle(x_1,(0,0,0),(0,0,0))\",\"\\\\triangle((0,0,0),x_1,(0,0,0))\",\"\\\\triangle((0,0,0),(0,0,0),x_1)\"],sphere:[\"\\\\sphere(x_1,0)\",\"\\\\sphere((0,0,0),x_1)\"],pointDet:[\"\\\\pointDet(x_1,y)\",\"\\\\pointDet(x,x_1)\"],pointDot:[\"\\\\pointDot(x_1,y)\",\"\\\\pointDot(x,x_1)\"],pointPerp:[\"\\\\pointPerp(x_1)\"],segment:[\"\\\\segment(x_1,(0,0))\",\"\\\\segment((0,0),x_1)\"],line:[\"\\\\line(x_1,(0,0))\",\"\\\\line((0,0),x_1)\"],ray:[\"\\\\ray(x_1,(0,0))\",\"\\\\ray((0,0),x_1)\"],vector:[\"\\\\vector(x_1, (0,0))\",\"\\\\vector((0,0), x_1)\"],mathVector:[\"\\\\mathVector(x_1,(0,0))\",\"\\\\mathVector((0,0),x_1)\"],mathVectorThreeD:[\"\\\\mathVectorThreeD(x_1,(0,0,0))\",\"\\\\mathVectorThreeD((0,0,0),x_1)\"],vectorDisplacementAsPoint:[\"\\\\vectorDisplacementAsPoint(x_1)\"],vectorThreeDDisplacementAsPoint:[\"\\\\vectorThreeDDisplacementAsPoint(x_1)\"],basePointFromVector:[\"\\\\basePointFromVector(x_1)\"],basePointFromVectorThreeD:[\"\\\\basePointFromVectorThreeD(x_1)\"],circle:[\"\\\\circle(x_1,0)\",\"\\\\circle((0,0),x_1)\"],arc:[\"\\\\arc(x_1,(0,0),(0,0))\",\"\\\\arc((0,0),x_1,(0,0))\",\"\\\\arc((0,0),(0,0),x_1)\"],arcCenter:[\"(0/0,0/0)\"],arcOmega:[\"0/0\"],center:[\"\\\\center(x_1)\"],radius:[\"\\\\radius(x_1)\"],undirectedAngleMarker:[\"\\\\undirectedAngleMarker(x_1)\"],directedAngleMarker:[\"\\\\directedAngleMarker(x_1,0,0,0)\",\"\\\\directedAngleMarker((0,0),x_1,0,0)\",\"\\\\directedAngleMarker((0,0),0,x_1,0)\",\"\\\\directedAngleMarker((0,0),0,0,x_1)\"],directedCoterminalAngle:[\"\\\\directedCoterminalAngle(x_1)\"],undirectedCoterminalAngle:[\"\\\\undirectedCoterminalAngle(x_1)\"],supplement:[\"\\\\supplement(x_1)\"],directedAngleMarkerMultiplier:[\"\\\\directedAngleMarkerMultiplier(x_1)\"],undirectedAngleMarkerMultiplier:[\"\\\\undirectedAngleMarkerMultiplier(x_1)\"],directedAngleMarkerRawDelta:[\"\\\\directedAngleMarkerRawDelta(x_1)\"],undirectedAngleMarkerRawDelta:[\"\\\\undirectedAngleMarkerRawDelta(x_1)\"],polygonInteriorUndirectedAngles:[\"\\\\polygonInteriorUndirectedAngles(x_1)\"],polygonInteriorDirectedAngles:[\"\\\\polygonInteriorDirectedAngles(x_1)\"],lineFromSegment:[\"x_1\"],lineFromRay:[\"x_1\"],segmentGlider:[\"\\\\segmentGlider(x_1,y)\",\"\\\\{0<y<1:(\\\\segmentGlider(x,1)-\\\\segmentGlider(x,0))*x_1,(0,0)\\\\}\"],segmentThreeDGlider:[\"\\\\segmentThreeDGlider(x_1,y)\",\"\\\\{0<y<1:(\\\\segmentThreeDGlider(x,1)-\\\\segmentThreeDGlider(x,0))*x_1,(0,0,0)\\\\}\"],rayGlider:[\"\\\\rayGlider(x_1,y)\",\"\\\\{0<y:(\\\\rayGlider(x,1)-\\\\rayGlider(x,0))*x_1,(0,0)\\\\}\"],lineGlider:[\"\\\\lineGlider(x_1,y)\",\"(\\\\lineGlider(x,1)-\\\\lineGlider(x,0))*x_1\"],circleGlider:[\"\\\\circleGlider(x_1,y)\",\"2*\\\\pi*\\\\pointPerp(q-\\\\center(x))*x_1\"],arcGlider:[\"(0/0,0/0)\",\"(0/0,0/0)\"],polygonGlider:[\"(0/0,0/0)\",\"(0/0,0/0)\"],chooseNonIncidentPoint:[\"(0/0,0/0)\"],circleCircleIntersection:[\"(\\\\radius(x)*\\\\radius(x_1)+\\\\pointDot(\\\\center(x_1),(q-\\\\center(x))))/\\\\pointDot(\\\\pointPerp(q-\\\\center(y)),q-\\\\center(x))*\\\\pointPerp(q-\\\\center(y))\",\"(\\\\radius(y)*\\\\radius(x_1)+\\\\pointDot(\\\\center(x_1),(q-\\\\center(y))))/\\\\pointDot(\\\\pointPerp(q-\\\\center(x)),q-\\\\center(y))*\\\\pointPerp(q-\\\\center(x))\"],circleArcIntersection:[\"(0/0,0/0)\"],circleLineIntersection:[\"(\\\\radius(x)*\\\\radius(x_1)+\\\\pointDot(\\\\center(x_1),(q-\\\\center(x))))/\\\\pointDot((\\\\lineGlider(y,1)-\\\\lineGlider(y,0)),q-\\\\center(x))*(\\\\lineGlider(y,1)-\\\\lineGlider(y,0))\",\"(\\\\pointDet(\\\\lineGlider(x_1,0),\\\\lineGlider(y,1))+\\\\pointDet(\\\\lineGlider(y,0),\\\\lineGlider(x_1,1))-\\\\pointDet(q,\\\\lineGlider(x_1,1)-\\\\lineGlider(x_1,0)))/(\\\\pointDet(\\\\pointPerp(q-\\\\center(x)),\\\\lineGlider(y,1)-\\\\lineGlider(y,0)))*(\\\\pointPerp(q-\\\\center(x)))\"],arcCircleIntersection:[\"(0/0,0/0)\"],arcArcIntersection:[\"(0/0,0/0)\"],arcLineIntersection:[\"(0/0,0/0)\"],lineCircleIntersection:[\"(\\\\pointDet(\\\\lineGlider(x_1,0),\\\\lineGlider(x,1))+\\\\pointDet(\\\\lineGlider(x,0),\\\\lineGlider(x_1,1))-\\\\pointDet(q,\\\\lineGlider(x_1,1)-\\\\lineGlider(x_1,0)))/(\\\\pointDet(\\\\pointPerp(q-\\\\center(y)),\\\\lineGlider(x,1)-\\\\lineGlider(x,0)))*(\\\\pointPerp(q-\\\\center(y)))\",\"(\\\\radius(y)*\\\\radius(x_1)+\\\\pointDot(\\\\center(x_1),(q-\\\\center(y))))/\\\\pointDot((\\\\lineGlider(x,1)-\\\\lineGlider(x,0)),q-\\\\center(y))*(\\\\lineGlider(x,1)-\\\\lineGlider(x,0))\"],lineArcIntersection:[\"(0/0,0/0)\"],lineLineIntersection:[\"(\\\\pointDet(\\\\lineGlider(x_1,0),\\\\lineGlider(x,1))+\\\\pointDet(\\\\lineGlider(x,0),\\\\lineGlider(x_1,1))-\\\\pointDet(q,\\\\lineGlider(x_1,1)-\\\\lineGlider(x_1,0)))/(\\\\pointDet(\\\\lineGlider(y,1)-\\\\lineGlider(y,0),\\\\lineGlider(x,1)-\\\\lineGlider(x,0)))*(\\\\lineGlider(y,1)-\\\\lineGlider(y,0))\",\"(\\\\pointDet(\\\\lineGlider(x_1,0),\\\\lineGlider(y,1))+\\\\pointDet(\\\\lineGlider(y,0),\\\\lineGlider(x_1,1))-\\\\pointDet(q,\\\\lineGlider(x_1,1)-\\\\lineGlider(x_1,0)))/(\\\\pointDet(\\\\lineGlider(x,1)-\\\\lineGlider(x,0),\\\\lineGlider(y,1)-\\\\lineGlider(y,0)))*(\\\\lineGlider(x,1)-\\\\lineGlider(x,0))\"],parallel:[\"\\\\parallel(x_1,(0,0))\",\"\\\\parallel(\\\\line((0,0),(0,0)),x_1)\"],perpendicular:[\"\\\\perpendicular(x_1,(0,0))\",\"\\\\perpendicular(\\\\line((0,0),(0,0)),x_1)\"],scaleTangentSegment:[\"\\\\scaleTangentSegment(x_1, y)\",\"\\\\scaleTangentSegment(x, x_1)\"],scaleTangentLine:[\"\\\\scaleTangentLine(x_1, y)\",\"\\\\scaleTangentLine(x, x_1)\"],scaleTangentRay:[\"\\\\scaleTangentRay(x_1, y)\",\"\\\\scaleTangentRay(x, x_1)\"],scaleTangentCircle:[\"\\\\scaleTangentCircle(x_1, y)\",\"\\\\scaleTangentCircle(x, x_1)\"],scaleTangentArc:[\"\\\\scaleTangentArc(x_1, y)\",\"\\\\scaleTangentArc(x, x_1)\"],scaleTangentDirectedAngleMarker:[\"\\\\scaleTangentDirectedAngleMarker(x_1, y)\",\"\\\\scaleTangentDirectedAngleMarker(x, x_1)\"],scaleTangentUndirectedAngleMarker:[\"\\\\scaleTangentUndirectedAngleMarker(x_1, y)\",\"\\\\scaleTangentUndirectedAngleMarker(x, x_1)\"],addTangentSegment:[\"\\\\addTangentSegment(x_1, y)\",\"\\\\addTangentSegment(x, x_1)\"],addTangentSegmentThreeD:[\"\\\\addTangentSegmentThreeD(x_1, y)\",\"\\\\addTangentSegmentThreeD(x, x_1)\"],addTangentLine:[\"\\\\addTangentLine(x_1, y)\",\"\\\\addTangentLine(x, x_1)\"],addTangentRay:[\"\\\\addTangentRay(x_1, y)\",\"\\\\addTangentRay(x, x_1)\"],addTangentCircle:[\"\\\\addTangentCircle(x_1, y)\",\"\\\\addTangentCircle(x, x_1)\"],addTangentArc:[\"\\\\addTangentArc(x_1, y)\",\"\\\\addTangentArc(x, x_1)\"],addTangentDirectedAngleMarker:[\"\\\\addTangentDirectedAngleMarker(x_1, y)\",\"\\\\addTangentDirectedAngleMarker(x, x_1)\"],addTangentUndirectedAngleMarker:[\"\\\\addTangentUndirectedAngleMarker(x_1, y)\",\"\\\\addTangentUndirectedAngleMarker(x, x_1)\"],translation:[\"\\\\translation(x_1)\"],dilation:[\"\\\\dilation(x_1, y)\",\"\\\\dilation(x, x_1)\"],reflection:[\"\\\\reflection(x_1)\"],rotation:[\"\\\\rotation((0/0,0/0),0/0)\"],compose:[\"\\\\reflection(\\\\line((0/0,0/0),(0/0,0/0)))\",\"\\\\reflection(\\\\line((0/0,0/0),(0/0,0/0)))\"],inverse:[\"\\\\reflection(\\\\line((0/0,0/0),(0/0,0/0)))\"],transformPoint:[\"(0/0,0/0)\",\"(0/0,0/0)\"],transformSegment:[\"\\\\segment((0/0,0/0),(0/0,0/0))\",\"\\\\segment((0/0,0/0),(0/0,0/0))\"],transformVector:[\"\\\\vector((0/0,0/0),(0/0,0/0))\",\"\\\\vector((0/0,0/0),(0/0,0/0))\"],transformLine:[\"\\\\line((0/0,0/0),(0/0,0/0))\",\"\\\\line((0/0,0/0),(0/0,0/0))\"],transformRay:[\"\\\\ray((0/0,0/0),(0/0,0/0))\",\"\\\\ray((0/0,0/0),(0/0,0/0))\"],transformCircle:[\"\\\\circle((0/0,0/0),0/0)\",\"\\\\circle((0/0,0/0),0/0)\"],transformArc:[\"\\\\arc((0/0,0/0),(0/0,0/0),(0/0,0/0))\",\"\\\\arc((0/0,0/0),(0/0,0/0),(0/0,0/0))\"],transformPolygon:[\"\\\\polygon([])\",\"\\\\polygon([])\"],transformAngleMarker:[\"\\\\undirectedAngleMarker(directedAngleMarker([0/0,0/0],0/0,0/0,0/0))\",\"\\\\undirectedangleMarker(directedAngleMarker([0/0,0/0],0/0,0/0,0/0))\"],transformDirectedAngleMarker:[\"\\\\directedAngleMarker([0/0,0/0],0/0,0/0,0/0)\",\"\\\\directedangleMarker([0/0,0/0],0/0,0/0,0/0)\"],mean:[\"\\\\mean(x_1)\"],total:[\"\\\\total(x_1)\"],count:[\"0\"],var:[\"2*\\\\cov(x, x_1)\"],varp:[\"2*\\\\cov(x, x_1)*(\\\\count(x)-1)/\\\\count(x)\"],stdev:[\"\\\\cov(x, x_1)/q\"],stdevp:[\"\\\\covp(x, x_1)/q\"],mad:[\"\\\\mean(\\\\sign(x-\\\\mean(x))*(x_1 - \\\\mean(x_1)))\"],min:[\"x_1[\\\\argmin(x)]\"],max:[\"x_1[\\\\argmax(x)]\"],median:[\"0.5*(x_1[\\\\lowerQuantileIndex(x, 0.5)] + x_1[\\\\upperQuantileIndex(x, 0.5)])\"],argmin:[\"0/0\"],argmax:[\"0/0\"],gcd:[\"0/0\"],lcm:[\"0/0\"],erf:[\"\\\\frac{2x_1}{\\\\sqrt{\\\\pi }}\\\\exp(-x^2)\"],invNorm:[\"\\\\frac{x_1}{\\\\pdf(\\\\normaldist(0,1),q)}\"],logbase:[\"\\\\{x > 0: \\\\frac{x_1}{x*\\\\ln(y)} \\\\}\",\"\\\\frac{-q*x_1}{y*\\\\ln(y)}\"],nthroot:[\"x^{1/y - 1}/y*x_1\",\"-\\\\frac{q*\\\\ln(x)*x_1}{y^2}\"],hypot:[\"x_1*x/q\",\"x_1*y/q\"],polyGamma:[\"0/0\",\"\\\\polyGamma(1 + x, y)*x_1\"],mod:[\"\\\\{ q=0: 0/0, x_1 \\\\}\",\"\\\\{ \\\\mod(x/y, 1) > 0: -\\\\floor(x/y)*x_1 \\\\}\"],cov:[\"\\\\cov(x_1, y)\",\"\\\\cov(x, x_1)\"],covp:[\"\\\\covp(x_1, y)\",\"\\\\covp(x, x_1)\"],corr:[\"(\\\\cov(x_1, y) - (\\\\cov(x, y)*\\\\cov(x, x_1)/\\\\var(x)))/(\\\\stdevp(x)\\\\stdevp(y))\",\"(\\\\cov(x, x_1) - (\\\\cov(x, y)*\\\\cov(y, x_1)/\\\\var(y)))/(\\\\stdevp(x)\\\\stdevp(y))\"],spearman:[\"0/0\",\"0/0\"],quantile:[\"\\\\{ \\\\floor(y*(\\\\count(x)-1)) = y*(\\\\count(x)-1) :   x_1[\\\\upperQuantileIndex(x, y)],  (\\\\ceil(y*(\\\\count(x)-1)) - y*(\\\\count(x)-1))*x_1[\\\\lowerQuantileIndex(x, y)] +   (y*(\\\\count(x)-1) - \\\\floor(y*(\\\\count(x)-1)))*x_1[\\\\upperQuantileIndex(x, y)]\\\\}\",\"\\\\{ \\\\floor(y*(\\\\count(x)-1)) < y*(\\\\count(x)-1) :   (\\\\count(x)-1)*(x[\\\\upperQuantileIndex(x, y)] - x[\\\\lowerQuantileIndex(x, y)])*x_1\\\\}\"],quartile:[\"0.5*(x_1[\\\\lowerQuartileIndex(x, y)] + x_1[\\\\upperQuartileIndex(x, y)])\",\"0/0\"],tscore:[\"\\\\frac{\\\\sqrt{\\\\count(x)}(\\\\stdev(x)*\\\\mean(x_1)-(\\\\mean(x)-y)*\\\\frac{\\\\cov(x,x_1)}{\\\\stdev(x)})}{\\\\stdev(x)^2}\",\"-x_1*\\\\sqrt{\\\\count(x)}/\\\\stdev(x)\"],quartileIndex:[\"0/0\",\"0/0\"],upperQuartileIndex:[\"0/0\",\"0/0\"],lowerQuartileIndex:[\"0/0\",\"0/0\"],upperQuantileIndex:[\"0/0\",\"0/0\"],lowerQuantileIndex:[\"0/0\",\"0/0\"],nCr:[\"q*(\\\\polyGamma(0, 1 + x) - \\\\polyGamma(0, 1 + x - y))\",\"q*(\\\\polyGamma(0, 1 + x - y) - \\\\polyGamma(0, 1 + y))\"],nPr:[\"q*(\\\\polyGamma(0, 1 + x) - \\\\polyGamma(0, 1 + x - y))\",\"q*\\\\polyGamma(0, 1 + x - y)\"],arctan:[\"x_1*y/(y^2+x^2)\",\"-x_1*x/(y^2+x^2)\"],poissonpdf:[\"0/0\",\"x_1\\\\frac{\\\\exp(-y)(\\\\floor(x)-y)y^{(\\\\floor(x)-1)}}{(\\\\floor(x))!}\"],invPoisson:[\"0/0\",\"0/0\"],tpdf:[\"x_1*q*\\\\frac{-(y+1)*x}{y+x^2}\",\"x_1*\\\\frac{1}{2}q*(  \\\\frac{x^2-1}{y + x^2} + \\\\ln(\\\\frac{y}{y + x^2}) +   \\\\polyGamma(0, \\\\frac{1+y}{2}) - \\\\polyGamma(0, y/2))\"],invT:[\"x_1/\\\\pdf(\\\\tdist(y),q)\",\"0/0\"],tcdf:[\"-x_1*\\\\pdf(\\\\tdist(z),x)\",\"x_1*\\\\pdf(\\\\tdist(z),y)\",\"0/0\"],poissoncdf:[\"0/0\",\"0/0\",\"x_1\\\\sum _{n=\\\\max(0,\\\\floor(\\\\min(x,y)))}^{\\\\floor(\\\\max(x,y))}\\\\frac{\\\\exp(-z)(n-z)z^{(n-1)}}{n!}\"],normalpdf:[\"-x_1*\\\\frac{x-y}{z^2} q\",\"x_1*\\\\frac{x-y}{z^2} q\",\"x_1*(\\\\frac{(x-y-z)*(x-y+z)}{z^3}) q\"],binompdf:[\"0/0\",\"0/0\",\"\\\\{0<=z<=1: x_1*q*(\\\\frac{\\\\round(x)}{z}-\\\\frac{\\\\round(y)-\\\\round(x)}{1-z}), 0 \\\\}\"],invBinom:[\"0/0\",\"0/0\",\"0/0\"],uniformpdf:[\"0\",\"\\\\{y<=x: \\\\frac{x_1}{(z-y)^2}, 0\\\\}\",\"\\\\{z>=x: -\\\\frac{x_1}{(z-y)^2}, 0\\\\}\"],invUniform:[\"\\\\{y<=x<=z: x_1*(z-y), 0\\\\}\",\"\\\\{y<=x<=z: x_1*(1-x), 0\\\\}\",\"\\\\{y<=x<=z: x_1*x, 0\\\\}\"],normalcdf:[\"-x_1\\\\pdf(\\\\normaldist(z,u), x)\",\"x_1\\\\pdf(\\\\normaldist(z,u), y)\",\"-x_1*(\\\\pdf(\\\\normaldist(z,u), y) - \\\\pdf(\\\\normaldist(z,u), x))\",\"x_1*(  \\\\{\\\\abs(y)=1/0:0,\\\\frac{z-y}{u}\\\\pdf(\\\\normaldist(z,u),y)\\\\} -   \\\\{\\\\abs(x)=1/0:0,\\\\frac{z-x}{u}\\\\pdf(\\\\normaldist(z,u),x)\\\\})\"],binomcdf:[\"0/0\",\"0/0\",\"0/0\",\"\\\\{0<=u<=1: x_1*\\\\sum _{n=\\\\max(0,\\\\round(\\\\min(x,y)))}^{\\\\round(\\\\max(x,y))}(  \\\\pdf(\\\\binomialdist(z,u),n)*(\\\\frac{n}{u}-\\\\frac{\\\\round(z)-n}{1-u})), 0 \\\\}\"],uniformcdf:[\"\\\\{z>u: 0/0, -x_1\\\\pdf(\\\\uniformdist(z,u), x)\\\\}\",\"\\\\{z>u: 0/0, x_1\\\\pdf(\\\\uniformdist(z,u), y)\\\\}\",\"\\\\{z>u: 0/0, x_1*(\\\\frac{\\\\{z<x<u:u-x,0\\\\} + \\\\{z<y<u:y-u,0\\\\}}{(u-z)^2})\\\\}\",\"\\\\{z>u: 0/0, x_1*(\\\\frac{\\\\{z<x<u:x-z,0\\\\} + \\\\{z<y<u:z-y,0\\\\}}{(u-z)^2})\\\\}\"],normalSample:[\"0/0\",\"0/0\",\"0/0\"],uniformSample:[\"0/0\",\"0/0\",\"0/0\"],tSample:[\"0/0\",\"0/0\"],poissonSample:[\"0/0\",\"0/0\"],binomSample:[\"0/0\",\"0/0\",\"0/0\"],rgb:[\"0/0\",\"0/0\",\"0/0\"],hsv:[\"0/0\",\"0/0\",\"0/0\"],polygon:[\"\\\\polygon(x_1)\"],area:[\"0/0\"],perimeter:[\"0/0\"],vertices:[\"\\\\vertices(x_1)\"],segments:[\"\\\\segments(x_1)\"],validateRangeLength:[\"0\",\"0\",\"0\",\"\\\\{q \\\\ge 1: x_1, 0\\\\}\"],validateSampleCount:[\"\\\\{x<0:0,1\\\\}*x_1\"],select:[\"\\\\select(x_1, y)\",\"0*q\"],shuffle:[\"0*y\",\"\\\\shuffle(x, x_1)\"],sortPerm:[\"0*x\"],elementsAt:[\"\\\\elementsAt(x_1, y)\",\"0*q\"],uniquePerm:[\"0*q\"],tone:[\"\\\\tone(x_1,0)\",\"\\\\tone(0,x_1)\"],restriction:[\"0\"],restrictionToBoolean:[\"0\"]},lR={};for(let e in cR){let t=e,r=cR[t],n=[];for(let i=0;i<r.length;i++){let s=r[i];n.push(Hs(s,{}))}lR[t]=n}function pR(e,t){e.map.length=Math.min(e.map.length,t),e.maxValidReference=Math.min(e.maxValidReference,t-1)}function fR(e,t,r){let n=e.argNames.indexOf(t);if(n===-1){let o=e.getInstruction(r);return o.type===1?sE(o.valueType,o.value):Xr()}let i=Fn(e,n,{allowRestriction:!0,allowClosedBlockReferences:!1}),s=bB(i,r);return $n(s,r)}function bB(e,t){let{chunk:r,mask:n}=e;return{chunk:r,mask:n,orderCtx:e,domainTable:[],index:t}}function $n(e,t){let{domainTable:r}=e,n=r[t];if(n!==void 0)return n;let i=xB(e,t);return r[t]=i,i}function xB(e,t){let{chunk:r,mask:n,orderCtx:i}=e,s=r.getInstruction(t);switch(s.type){case 1:return sE(s.valueType,s.value);case 3:case 2:return s.valueType===T?Fo():Xr();case 0:return Xr();case 31:return xp($n(e,s.args[0]),$n(e,s.args[1]));case 32:case 8:case 9:case 10:return Mr($n(e,s.args[0]),$n(e,s.args[1]));case 11:{let o=Mr($n(e,s.args[0]),$n(e,s.args[1])),a=r.getInstruction(s.args[1]);return a.type===1&&a.valueType===T&&Y(a.value)!==0?o:Mr(Xr(),o)}case 14:return $n(e,s.args[0]);case 15:case 16:{let o=Fo();for(let a of s.args)o=Mr(o,$n(e,a));return o}case 12:case 13:case 47:case 48:case 17:case 18:case 42:case 21:case 22:case 23:case 24:case 19:case 20:case 39:case 40:case 41:case 44:case 50:case 51:case 54:case 55:{let o=Xr();for(let a of s.args)o=Mr(o,$n(e,a));return o}case 4:case 53:return Xr();case 49:return Xr();case 38:return s.args.length===1?$n(e,s.args[0]):Xr();case 25:return Xr();case 33:return fM($n(e,s.args[0]),$n(e,s.args[1]),$n(e,s.args[2]));case 26:case 27:case 28:case 29:{if(!n[t])return Fo();let o=Mr($n(e,s.args[0]),$n(e,s.args[1]));if(nr(i,t)>1)return Mr(Xr(),o);let a=e.coefficientCtx;a===void 0&&(a=zs(i,e.index),e.coefficientCtx=a);let u=a.newChunk,c=Hr(a,t),[l,p]=c;if(!ht(u.getInstruction(l)))return Mr(Xr(),o);let f=ur(u,l);if(isNaN(f))return ca();if(p===void 0)return s.type===28||s.type===29?f>=0?o:ca():f>0?o:ca();{let m=ur(u,p);return Mr(o,Yc(f,m))}}case 37:switch(s.symbol){case\"restriction\":case\"restrictionToBoolean\":return $n(e,s.args[0]);case\"count\":return Fo();default:{if(gr[s.symbol].noPeel)return Xr();let o=Xr();for(let a of s.args)o=Mr(o,$n(e,a));return o}}}}function sE(e,t){if(W(e))return t.length===1?sE(ze(e),t[0]):Xr();switch(e){case T:case C:case V:return Ry(e,t)?ca():Fo();case Ee:return t?Fo():ca();default:return Xr()}}function mR(e){let t=[],r=[];for(let n=0;n<e.argNames.length;n++){let i=[],s=[];for(let o=0;o<e.argNames.length;o++)i.push(e.argTypes[o]===T),s.push(n===o);r.push(s),t.push(i)}for(let n=e.argNames.length;n<=e.getReturnIndex();n++)r.push(PB(e,r,n)),t.push(TB(e,r,t,n));return t[e.getReturnIndex()]}function PB(e,t,r){let n=e.getInstruction(r),i=IB(e.argNames.length);if(ve(n))return i;for(let s of n.args){let o=t[s];for(let a=0;a<o.length;a++)i[a]=i[a]||o[a]}return i}function TB(e,t,r,n){let i=e.getInstruction(n);if(ve(i))return dR(e.argNames.length);switch(i.type){case 8:case 9:case 14:case 16:case 18:case 38:{let a=dR(e.argNames.length);for(let u=0;u<i.args.length;u++){let c=r[i.args[u]];for(let l=0;l<c.length;l++)a[l]=a[l]&&c[l]}return a}case 11:{let a=[],u=r[i.args[0]],c=t[i.args[1]];for(let l=0;l<u.length;l++)a.push(u[l]&&!c[l]);return a}case 10:{let a=r[i.args[0]].slice(),u=r[i.args[1]].slice(),c=t[i.args[0]],l=t[i.args[1]],p=0,f=0;for(let m=0;m<a.length;m++){let g=a[m]&&!l[m],y=u[m]&&!c[m];a[m]=g,u[m]=y,g&&(p+=1),y&&(f+=1)}return p>=f?a:u}case 33:{let a=t[i.args[0]],u=r[i.args[1]],c=r[i.args[2]];for(var s=[],n=0;n<a.length;n++)s.push(!a[n]&&u[n]&&c[n]);return s}case 39:case 40:case 41:{let a=r[i.args[0]],u=t[i.args[1]],c=[];for(var n=0;n<u.length;n++)c.push(a[n]&&!u[n]);return c}case 48:{let a=i.args[0],u=e.getInstruction(a),c=n-a;return r[u.args[c]]}case 15:case 17:case 12:case 13:case 26:case 28:case 27:case 29:case 25:case 32:case 31:case 37:case 42:case 21:case 22:case 19:case 20:case 23:case 24:case 47:case 44:case 49:case 50:case 51:case 53:case 54:case 55:{let a=t[n],u=[];for(let c of a)u.push(!c);return u}default:let o=i;throw new Error(`Unexpected opcode ${o.type}`)}}function IB(e){let t=[];for(let r=0;r<e;r++)t.push(!1);return t}function dR(e){let t=[];for(let r=0;r<e;r++)t.push(!0);return t}function gR(e){let t=e.getReturnIndex(),r=Ii(e,t),n=e.getInstruction(t);if(n.type!==48)return e;let i=n.args[0],s=t-i,o=e.getInstruction(i),a=o.args[0],u=o.args[s],c=[],l=[];c.push(a);let p=xo(e,e.getReturnIndex(),\"Programming error: cannot optimize regression on non-constant-length list\");l.push({min:1,max:p,length:p});let f=!1,m=!1;for(let I=a+1;I<=u;I++){if(!r[I])continue;let D=e.getInstruction(I);if(D.type===39||D.type===41||D.type===40){if(D.args[1]!==a)continue;let O=D.args[0];if(e.getInstruction(O).valueType!==le||!ht(e.getInstruction(O)))continue;let N=ur(e,O),A=vB(N);if(!isFinite(A.min)||!isFinite(A.max))continue;c.push(I),l.push(A)}else yR(D)?f=!0:(D.type===12||D.type===13)&&(m=!0)}if(c.length===0||!m&&!f)return e;let g=[],y=[];for(let I=0;I<e.argNames.length;I++)y.push(I),g.push(Fo());let d=[],h=[];for(let I=0;I<=u;I++)d.push(oE(e,y,d,I)),h.push(oE(e,c,h,I));for(let I=0;I<=u;I++){if(!r[I])continue;let D=e.getInstruction(I);if(D.type===33){let O=d[I];for(let N=0;N<O.length;N++)if(O[N])return e}else if(D.type===12||D.type===13){let O=!1,N=!1;for(let z=0;z<c.length;z++)h[D.args[0]][z]&&(O=!0),h[D.args[1]][z]&&(N=!0);if(O||!N)continue;let A=d[D.args[0]],L=0,q;for(let z=0;z<A.length;z++)A[z]&&(q=z,L+=1);if(L!==1||q===void 0)continue;let $=y[q],X=Fn(e.copy().reopenFinalBlock(),$,{allowRestriction:!1,allowClosedBlockReferences:!1});if(nr(X,D.args[0])!==1)continue;let G=zs(X,D.args[0]),[J,w]=Hr(G,D.args[0]);if(w===void 0)continue;let Z=ur(G.newChunk,w),te=ur(G.newChunk,J);g[q]=Mr(g[q],Yc(te,Z))}}if(f){let I=e.copy().reopenFinalBlock();for(let D=0;D<c.length;D++){let O=Fn(I,c[D],{allowRestriction:!1,allowClosedBlockReferences:!1}),N=zs(O,u);for(let A=a+1;A<=u;A++){if(!r[A])continue;let L=I.getInstruction(A);if(yR(L)){let q=L.args[0];if(nr(O,q)!==1)continue;let $=Hr(N,q)[1];if($===void 0)continue;let X=MB(N.newChunk,$),G,J=0;for(let De=0;De<X.length;De++)X[De]&&(G=De,J+=1);if(J!==1||G===void 0)continue;let w=Fn(N.newChunk,G,{allowRestriction:!1,allowClosedBlockReferences:!1});if(nr(w,$)!==1)continue;let Z=zs(w,$),[te,z]=Hr(Z,$);if(z===void 0||!ht(Z.newChunk.getInstruction(te))||!ht(Z.newChunk.getInstruction(z)))continue;let oe=ur(Z.newChunk,te),re=ur(Z.newChunk,z),me=(l[D].max-l[D].min)/Math.min(l[D].length-1,31),ye=Math.PI/me;if(!isFinite(ye)||ye<=0)continue;g[G]=Mr(g[G],Yc(oe,re)),g[G]=Mr(g[G],Yc(ye-oe,-re))}}}}let b=!1;for(let I of g){if(hi(I)||!ji(I))return e;(I.bounds[0]!==-1/0||I.bounds[1]!==1/0)&&(b=!0)}if(!b)return e;let x=e.copy(),P=x.Constant(1),E=x.Constant(NaN),M=t;for(let I=0;I<x.argNames.length;I++)M=EB(x,g[I],M,I,P,E);return x.fuseBroadcast(),x}function EB(e,t,r,n,i,s){if(hi(t)||!ji(t)||t.bounds[0]===-1/0&&t.bounds[1]===1/0)return r;let o=e.And([e.LessEqual([e.Constant(t.bounds[0]),n]),e.LessEqual([n,e.Constant(t.bounds[1])])]);return e.Multiply([r,e.Piecewise([o,i,s])])}function MB(e,t){let r=[];for(let i=0;i<e.argNames.length;i++)r.push(i);let n=[];for(let i=0;i<=t;i++)n.push(oE(e,r,n,i));return n[t]}function yR(e){return e.type===37&&(e.symbol===\"sin\"||e.symbol===\"cos\")}function vB(e){var t=1/0,r=-1/0,n=e.length;for(let i of e)t=Math.min(t,i),r=Math.max(r,i);return{min:t,max:r,length:n}}function oE(e,t,r,n){let i=e.getInstruction(n),s=DB(t.length);for(let o=0;o<t.length;o++)if(t[o]===n)return s[o]=!0,s;if(ve(i))return s;for(let o of i.args){let a=r[o];for(let u=0;u<a.length;u++)s[u]=s[u]||a[u]}return s}function DB(e){let t=[];for(let r=0;r<e;r++)t.push(!1);return t}function hR(e){let t=e.getReturnIndex(),r=e.getInstruction(t);if(ve(r))return t;let n=II(e,r),i=n.expectedTypes,s=aE(e,r.args,[i]);if(n.isReducerWithNoListArgs){let o=SB(e,s.didCoerce?s.args:r.args),a=pn(n.expectedTypes.rest);if(_s(o,a)){s.didCoerce?e.replaceInstructionWithNoop(t):e.popInstruction();let u=e.List(r.args);return e.copyInstructionWithArgs(r,[u])}}else s.didCoerce&&(e.replaceInstructionWithNoop(t),e.copyInstructionWithArgs(r,s.args));return e.getReturnIndex()}function aE(e,t,r){let n=!1,i=[];for(let s=0;s<t.length;s++){let o=Fy(r,s),a=t[s],u=e.getInstruction(a).valueType,c=a;o.every(l=>!_s(u,l))&&ce(o[0],T)&&(c=Iu(e,a)),c!==a&&(n=!0),i.push(c)}return n?{didCoerce:n,args:i}:{didCoerce:!1}}function uE(e,t,r){let n=e.getInstruction(r).valueType;if(_s(n,t))return r;if(ce(t,T)&&Kn(n,t)){let i=Iu(e,r);if(i!==r)return i}throw ee(`Programming Error: Tried to coerce ${$t(n)} to ${$t(t)}.`)}function Iu(e,t){let r=e.getInstruction(t);return r.valueType===Xe?t:ce(r.valueType,Ge)?xR(e,t):ce(r.valueType,Ae)?bR(e,t):ce(r.valueType,Gt)?e.Piecewise([e.SyntheticNativeFunction(\"restrictionToBoolean\",[t]),e.Constant(1),e.Constant(NaN)]):t}function SB(e,t){let r=e.getInstruction(t[0]).valueType;if(!ei(r))return or;for(let n of t)if(e.getInstruction(n).valueType!==r)return or;return pn(r)}function Us(e){var t=e;if(t&&typeof t.toJSON==\"function\"&&(t=t.toJSON()),!t||typeof t!=\"object\")return t;if(Array.isArray(t))return t.map(Us);var r={};for(var n in t)t.hasOwnProperty(n)&&(r[n]=Us(t[n]));return r}function PR(e,t){let r=[],n=[],i=[];for(let o=0;o<e.argNames.length;o++)t.hasOwnProperty(e.argNames[o])||(r.push(e.argNames[o]),n.push(e.argTypes[o]));let s=new Qo({argNames:r,argTypes:n});for(let o=0,a=0;o<e.argNames.length;o++)t.hasOwnProperty(e.argNames[o])?i[o]=s.ConstantOfType(e.argTypes[o],t[e.argNames[o]]):(i[o]=a,a+=1);for(let o=e.argNames.length;o<e.instructionsLength();o++){let a=e.getInstruction(o);if(ve(a))i.push(Gs(s,a));else{let u=[];for(let c of a.args)u.push(i[c]);i.push(Ir(s,a,u))}}return s}function Eu(e,t){if(t.type!==33)return!1;let r=e.getInstruction(t.args[2]);return r.type===1&&fo(r.valueType)&&lv(r.valueType,r.value)||Eu(e,r)&&TR(e,t.args[1])&&TR(e,r.args[1])}function cE(e,t){let r=[];for(;t.type===33;)r.push(t.args[0]),t=e.getInstruction(t.args[2]);return r}function*og(e,t){let r=e.getInstruction(t);r.type!==32?yield t:(yield*og(e,r.args[0]),yield*og(e,r.args[1]))}function IR(e,t){return e.getInstruction(t).type===25}function ER(e,t){let r=e.getInstruction(t);if(r.type!==25)return;let n=r.args[0],i=r.args[1],s=e.getInstruction(n),o=e.getInstruction(i),a=(o.type===41||o.type===40)&&ht(e.getInstruction(o.args[0]));return s.type===2&&(ht(o)||a)&&ce(o.valueType,T)?{type:\"constant\",variable:e.argNames[n],index:i}:ce(s.valueType,T)&&ce(o.valueType,T)?{type:\"implicit\",index:e.Subtract([n,i])}:void 0}function TR(e,t){let r=e.getInstruction(t);return r.type===1&&r.valueType===T&&Y(r.value)===1}var pE=class{constructor(t,r,n,i){this.openChunk=t;this.returnIndex=r;this.restrictionIndex=n;this.slices=i}getSliceVariablesOrImplicit(){return this.slices.map(t=>t.type===\"constant\"?t.variable:\"_implicit\")}getPeeledSlices(){let t=[];for(let r of this.slices)if(r.type===\"constant\"){let n=this.openChunk.getInstruction(r.index);if(ht(n)&&n.valueType===T)t.push({type:\"constant\",variable:r.variable,value:Y(n.value)});else if(!(ht(n)&&n.valueType===le))throw Ho()}else if(this.openChunk.getInstruction(r.index).valueType===T){let i=this.openChunk.copy();i.setReturnIndex(r.index),i.fuseBroadcast(),t.push({type:\"implicit\",sliceChunk:i})}else throw Ho();return t}getValueAndRestrictionChunk(){let t=this.getPeeledSlices(),r=this.openChunk.copy();r.setReturnIndex(this.returnIndex),r.fuseBroadcast();let n;return this.restrictionIndex!==void 0&&(n=this.openChunk.copy(),n.setReturnIndex(this.restrictionIndex),n.fuseBroadcast()),{valueChunk:r,restrictionChunk:n,slices:t}}getSlicesAndRestrictionChunk(){let t=this.getPeeledSlices(),r=this.openChunk.copy(),n=r.GreaterEqual([this.returnIndex,r.Constant(0)]);return this.restrictionIndex!==void 0&&(n=r.And([n,this.restrictionIndex])),r.setReturnIndex(n),r.fuseBroadcast(),{restrictionChunk:r,slices:t}}},ag=class{constructor(t,r,n){this.chunk=t;this.slices=[];this.oldIPtoNewIP=[];this.oldIPToRestriction=[];var i,s;this.produceNumbers=(i=n==null?void 0:n.produceNumbers)!=null?i:!1,this.allowSlices=(s=n==null?void 0:n.allowSlices)!=null?s:!1,this.newChunk=new Qo({argNames:t.argNames,argTypes:t.argTypes}),this.startTrue=this.produceNumbers?this.newChunk.Constant(1/0):this.newChunk.ConstantOfType(Ee,!0),this.peelable=CB(t),AB(t,this.peelable,r)}selectRestriction(){return!0}},fE=class extends ag{constructor(r,n,i){super(r,n,i);this.currSelectIndex=0;this.selectIndex=i.selectIndex}selectRestriction(){let r=this.selectIndex===this.currSelectIndex;return this.currSelectIndex++,this.produceNumbers?r:!r}};function Aa(e,t,r){let n=new ag(e,t,r);dE(n,0,e.instructionsLength()-1);let i=n.oldIPToRestriction[e.getReturnIndex()];return new pE(n.newChunk,n.oldIPtoNewIP[e.getReturnIndex()],n.startTrue===i?void 0:i,n.slices)}function*MR(e,t,r){var i,s;let n=lE(e,r,{produceNumbers:!1,selectIndex:0});if(n===void 0||n.count<=1){yield{value:t,restriction:void 0};return}for(let o=0;o<n.count;o++){let a=(i=lE(e,r,{produceNumbers:!0,selectIndex:o}))==null?void 0:i.chunk,u=o===0?n.chunk:(s=lE(e,r,{produceNumbers:!1,selectIndex:o}))==null?void 0:s.chunk;if(!a||!u)throw new Error(\"Programming Error: selectIndex gave invalid chunk.\");yield{value:a,restriction:u}}}function lE(e,t,r){let n=new fE(e,t,r);dE(n,0,e.instructionsLength()-1);let i=n.oldIPToRestriction[e.getReturnIndex()];if(n.currSelectIndex===0)return;let s=n.oldIPtoNewIP[e.getReturnIndex()],o=n.newChunk.getInstruction(s);if(o.type!==29)throw new Error(\"Programming Error: Expected GreaterEqual.\");let a=n.produceNumbers?n.newChunk.Subtract([o.args[0],o.args[1]]):s;return n.selectRestriction()&&(i=ug(n,[i,a])),n.newChunk.setReturnIndex(i),{chunk:n.newChunk,count:n.currSelectIndex}}function dE(e,t,r){let{chunk:n,newChunk:i,peelable:s,oldIPtoNewIP:o,oldIPToRestriction:a}=e;for(let u=t;u<=r;u++){let c=n.getInstruction(u);if(s[u]&&(c.type===19||c.type===23))u=RB(e,u);else if(c.type===2)o[u]=u,a[u]=e.startTrue;else if(ve(c))o[u]=i.copyInstruction(c),a[u]=e.startTrue;else if(s[u]&&Eu(n,c)){o[u]=o[c.args[1]];let l=c.args.map(p=>a[p]);for(let p of _B(e,c))e.selectRestriction()&&l.push(p);a[u]=ug(e,l)}else o[u]=i.copyInstructionWithArgs(c,c.args.map(l=>o[l])),a[u]=ug(e,c.args.map(l=>a[l]))}}function ug(e,t){let n=[...new Set(t)].filter(i=>!vR(e,i));return n.length?cg(e,n).reduce((i,s)=>e.produceNumbers?e.newChunk.SyntheticNativeFunction(\"min\",[i,s]):e.newChunk.And([i,s])):e.startTrue}function OB(e,t){let r=[...new Set(t)];return r.some(n=>!vR(e,n))?cg(e,r).reduce((n,i)=>e.produceNumbers?e.newChunk.SyntheticNativeFunction(\"max\",[n,i]):e.newChunk.Or([n,i])):e.startTrue}function cg(e,t){if(!e.produceNumbers)return t;let r=e.newChunk;return t.map(n=>{let i=r.getInstruction(n);if(i.valueType!==Ee)return n;switch(i.type){case 27:case 29:return r.Subtract([i.args[0],i.args[1]]);case 26:case 28:return r.Subtract([i.args[1],i.args[0]]);case 25:throw ee(\"convertBoolsToNums on an equality.\");case 32:return r.SyntheticNativeFunction(\"min\",cg(e,i.args));case 31:return r.SyntheticNativeFunction(\"max\",cg(e,i.args));case 1:return r.Constant(i.value?1/0:-1/0);default:throw ee(\"convertBoolsToNums on a non-opcode condition.\")}})}function vR({newChunk:e},t){let r=e.getInstruction(t);return r.type===1&&(r.valueType===T&&r.value===1/0||r.valueType===Ee&&r.value)}function RB(e,t){let{chunk:r,newChunk:n,oldIPtoNewIP:i,oldIPToRestriction:s,startTrue:o}=e,a=r.getInstruction(t),u=a.endIndex,c=r.getInstruction(u),l,p;if(a.type===23)i[t]=n.copyInstructionWithArgs(a,[i[a.args[0]]]),s[t]=o,p=t+1;else{let y=a.args.map(d=>i[d]);y.push(o),i[t]=n.copyInstructionWithArgs(a,y),s[t]=o;for(let d=2;d<a.args.length;d++){let h=t+d-1;i[h]=n.copyInstructionWithArgs(r.getInstruction(h),[i[t]]),s[h]=o}l=n.BlockVar(e.produceNumbers?T:Ee,[i[t]]),p=t+a.args.length-1}dE(e,p,u-1);let f=c.args.map(y=>i[y]),m=e.slices.filter(y=>p<=y.index&&y.index<u),g=l;if(a.type===19){if(l===void 0)throw new Error(\"Expected restrictionAccumVar to be defined\");g=ug(e,[l,s[c.args[1]]]),f.push(g)}else{f.push(s[c.args[1]]);for(let y of m)f.push(y.index)}i[u]=n.copyInstructionWithArgs(c,f),s[u]=o;for(let y=1;y<c.args.length;y++)i[u+y]=n.copyInstructionWithArgs(r.getInstruction(u+y),[i[u]]);if(a.type===23){let y=n.BroadcastResult(e.produceNumbers?le:_r,[i[u]]);for(let d of m)d.index=n.BroadcastResult(le,[i[u]]);for(let d=1;d<c.args.length;d++)s[u+d]=y}else{let y=n.BlockVar(e.produceNumbers?T:Ee,[i[u]]);l===g&&(y=o);for(let d=1;d<c.args.length;d++)s[u+d]=y}return u+c.args.length-1}function CB(e){let t=[];for(let n=0;n<e.instructionsLength();n++)t.push(!1);t[e.getReturnIndex()]=!0;let r=e.instructionsLength()-1;for(let n=r;n>=0;n--){if(!t[n])continue;let i=e.getInstruction(n);if(!ve(i))for(let s of NB(e,i))t[s]=!0}return t}function NB(e,t){switch(t.type){case 14:case 8:case 9:case 26:case 28:case 27:case 29:case 10:case 11:case 12:case 13:case 25:case 32:case 15:case 16:case 38:case 47:case 19:case 39:case 40:case 41:case 23:case 24:case 48:case 50:return t.args;case 33:return Eu(e,t)?cE(e,t).concat([t.args[1]]):[];case 37:{let n=gr[t.symbol];return n.noPeel?[]:n.tag===\"reducer\"||n.tag===\"doubleReducer\"||n.tag===\"never-broadcast\"||n.tag===\"parameterizedReducer\"?t.args.filter(i=>e.getInstruction(i).type!==48):t.args}case 20:return t.args.slice(1);case 51:return[];case 31:return[];case 17:case 18:case 42:case 21:case 22:case 44:case 49:case 53:case 54:case 55:return[];default:let r=t;throw new Error(`Unexpected opcode ${r.type}`)}}function AB(e,t,r){let n=[];for(let i=0;i<e.argNames.length;i++){let s=e.argNames[i];r.indexOf(s)<0&&n.push(i)}for(let i of n){let s=ru(e,i);for(let o=0;o<e.instructionsLength();o++)t[i]&&(t[i]=!s[o])}}function _B(e,t){let r=cE(e.chunk,t).map(n=>e.oldIPtoNewIP[n]);if(e.allowSlices&&r.length===1){let n=ER(e.newChunk,r[0]);if(n)return e.slices.push(n),[]}if(r.some(n=>IR(e.newChunk,n)))throw Ho();if(r.length===1){let n=r[0];return[...og(e.newChunk,n)]}return[OB(e,r)]}var Qo=class e{constructor(t){this.derivativeMaps={};if(this.instructions=[],this.blockMask=[],this.comments=[],t.argNames.length!==t.argTypes.length)throw new Error(\"Programming Error: length of argNames must match length of argTypes\");this.argNames=t.argNames,this.argTypes=t.argTypes;for(let r=0;r<this.argTypes.length;r++){let n=this.argTypes[r];this.LoadArg(n)}this.returnIndex=this.Constant(NaN)}computeNeedsThunking(){for(let t=this.returnIndex;t>=0;t--)if(this.instructions[t].type===55)return!0;return!1}setError(t){this.error=t}getError(){return this.error}getReturnIndex(){return this.returnIndex}setReturnIndex(t){if(!(0<=t&&t<this.instructions.length))throw new Error(`Programming Error: out of bounds return index ${t}`);this.returnIndex=t}addComments(t){for(let r in t){let n=this.comments[r]||\"\";this.comments[r]=n+t[r]}return this}instructionsLength(){return this.instructions.length}getInstruction(t){return this.instructions[t]}popInstruction(){this.truncate(this.instructions.length-1)}truncate(t){this.instructions.length=Math.min(t,this.instructions.length),this.blockMask.length=Math.min(t,this.blockMask.length),this.comments.length=Math.min(t,this.comments.length);for(let r in this.derivativeMaps)+r>=t?delete this.derivativeMaps[r]:pR(this.derivativeMaps[r],t);this.setReturnIndex(this.instructions.length-1)}dereferenceFunctionHeader(t){let r=this.getInstruction(t);return r.endIndex===-1?void 0:r.endIndex}getDirectDependencies(t){if(t.type===55){let r=t.args,n=this.dereferenceFunctionHeader(r[0]);if(n!==void 0)return r.concat(n)}return t.args}pushInstructionChecked(t){if(this.instructions.length>=32768)throw zb();this.instructions.push(t),this.setReturnIndex(this.instructions.length-1)}pushLeafInstruction(t){return this.pushInstructionChecked(t),this.getReturnIndex()}pushInstruction(t){return this.checkInstructionArguments(t),this.pushInstructionChecked(t),this.setReturnIndex(J1(this)),this.setReturnIndex(tS(this)),this.setReturnIndex(hR(this)),G1(this,this.getReturnIndex()),this.returnIndex===this.instructions.length-1&&this.setReturnIndex(L1(this)),this.getReturnIndex()}checkInstructionArguments(t){for(let r of t.args)if(this.blockMask[r])throw new Error(\"Programming Error: cannot reference an instruction in a closed block\")}markClosedBlock(t,r){for(let n=t;n<r;n++)this.blockMask[n]=!0}LoadArg(t){return this.pushLeafInstruction({type:2,valueType:t})}BlockVar(t,r){return this.pushInstruction({type:47,valueType:t,args:r})}SymbolicVar(t,r){return this.pushLeafInstruction({type:3,valueType:t,symbol:r})}BroadcastResult(t,r){let n=r[0],s=this.instructions[n].args[0],a=this.getInstruction(s).args[0],u=this.getInstruction(a);return this.pushInstruction({type:48,valueType:t,args:r,constantLength:ht(u)?ur(this,a):void 0})}Constant(t){return this.ConstantOfType(T,t)}ConstantOfType(t,r){if(typeof r==\"number\"&&(r=Re(r,1)),W(t)&&r.length>1e4)throw Up();return this.pushLeafInstruction({type:1,valueType:t,value:r})}NanOfType(t){if(t===Dt){let r=this.Constant(NaN);return this.Distribution(\"uniformdist\",[r,r])}else return this.ConstantOfType(t,ri(t))}Add(t){let r=8,n=rr(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Subtract(t){let r=9,n=rr(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Multiply(t){let r=10,n=rr(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Divide(t){let r=11,n=rr(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Exponent(t){let r=12,n=rr(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}RawExponent(t){let r=13,n=rr(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Negative(t){let r=14,n=rr(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Equal(t){let r=25,n=rr(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Less(t){let r=26,n=rr(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Greater(t){let r=27,n=rr(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}LessEqual(t){let r=28,n=rr(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}GreaterEqual(t){let r=29,n=rr(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Comparator(t,r){switch(t){case\"=\":return this.Equal(r);case\">\":return this.Greater(r);case\"<\":return this.Less(r);case\"<=\":return this.LessEqual(r);case\">=\":return this.GreaterEqual(r);default:{let n=t;throw new Error(`Unexpected comparator symbol: ${n}`)}}}Or(t){let r=31,n=rr(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}And(t){let r=32,n=rr(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Piecewise(t){let r=33,n=rr(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}OrderedPair(t){let r=15,n=rr(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}OrderedPairAccess(t,r){let n=17,i=rr(this,n,r);return this.pushInstruction({type:n,valueType:i,index:t,args:r})}OrderedTriple(t){let r=16,n=rr(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}OrderedTripleAccess(t,r){let n=18,i=rr(this,n,r);return this.pushInstruction({type:n,valueType:i,index:t,args:r})}List(t){let r=38,n=rr(this,r,t);if(t.length>1e4)throw Up();return this.pushInstruction({type:r,valueType:n,args:t})}ListAccess(t){let r=39,n=rr(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}DeferredListAccess(t){let r=40,n=rr(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}InboundsListAccess(t){let r=41,n=rr(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}NativeFunction(t,r,n){let i=37,s=gr[t].returnType,o=typeof s==\"function\"?s(n.map(a=>this.getInstruction(a).valueType)):s;return this.pushInstruction({type:i,valueType:o,args:n,symbol:t,callData:r})}SyntheticNativeFunction(t,r){let n=37,i=gr[t].returnType,s=typeof i==\"function\"?i(r.map(a=>this.getInstruction(a).valueType)):i,o={errorSymbol:t,providedArity:r.length,isDotCall:!1};return this.pushInstruction({type:n,valueType:s,args:r,symbol:t,callData:o})}Distribution(t,r){let n=42,i=Dt;return this.pushInstruction({type:n,valueType:i,args:r,symbol:t})}BeginIntegral(t,r){let n=21,i=rr(this,n,[]);return this.pushInstruction({type:n,valueType:i,args:r,endIndex:-1,callData:t})}EndIntegral(t){let r=22,n=rr(this,r,t),i=t[0],s=this.getInstruction(i);this.instructions[i]={type:s.type,valueType:s.valueType,args:s.args,endIndex:this.instructionsLength(),callData:s.callData};let o=this.pushInstruction({type:r,valueType:n,args:t});return this.markClosedBlock(i,o),o}BeginBroadcast(t,r){let n=23,i=rr(this,n,[]),s=this.getInstruction(t[0]);if(ht(s)&&ur(this,t[0])>1e4)throw Up();return this.pushInstruction({type:n,valueType:i,endIndex:-1,args:t,listComprehensionCallData:r})}EndBroadcast(t){let r=24,n=rr(this,r,t),i=t[0],s=this.getInstruction(i),o={type:s.type,valueType:s.valueType,args:s.args,endIndex:this.instructionsLength()};this.instructions[i]=o;let a=this.pushInstruction({type:r,valueType:n,args:t});return this.markClosedBlock(i,a),a}BeginLoop(t,r){let n=19,i=rr(this,n,r);return this.pushInstruction({type:n,valueType:i,args:r,endIndex:-1,callData:t})}EndLoop(t){let r=20,n=rr(this,r,t),i=t[0],s=this.getInstruction(i);this.instructions[i]={type:s.type,valueType:s.valueType,args:s.args,endIndex:this.instructionsLength(),callData:s.callData};let o=this.pushInstruction({type:r,valueType:n,args:t});return this.markClosedBlock(i,o),o}BeginMap(t,r){let n=50,i=rr(this,n,r);return this.pushInstruction({type:n,valueType:i,args:r,endIndex:-1,callData:t})}EndMap(t){let r=51,n=rr(this,r,t),i=t[0],s=this.getInstruction(i);this.instructions[i]={type:s.type,valueType:s.valueType,args:s.args,endIndex:this.instructionsLength(),callData:s.callData};let o=this.pushInstruction({type:r,valueType:n,args:t});return this.markClosedBlock(i,o),o}FunctionHeader(t,r,n){let i=4;return this.pushLeafInstruction({type:i,valueType:r,endIndex:-1,symbol:t,signature:n,recursionGroup:[]})}BeginFunction(t){let r=53,n=this.getInstruction(t[0]);return this.pushInstruction({type:r,valueType:n.valueType,endIndex:-1,args:t})}EndFunction(t){let r=54,n=t[0],i=this.getInstruction(n);this.instructions[n]={type:i.type,valueType:i.valueType,args:i.args,endIndex:this.instructionsLength()};let s=i.args[0],o=this.getInstruction(i.args[0]);this.instructions[s]={type:o.type,valueType:o.valueType,endIndex:this.instructionsLength(),symbol:o.symbol,signature:o.signature,recursionGroup:o.recursionGroup};let a=this.pushInstruction({type:r,valueType:vt,args:t});return this.markClosedBlock(n,a),a}FunctionCall(t,r,n){let i=55;return this.pushInstruction({type:i,valueType:rr(this,i,n),args:n,fnSymbol:t,isRecursiveCall:r})}ExtendSeed(t,r){let n=44,i=et;return this.pushInstruction({type:n,valueType:i,args:r,tag:t})}Noop(){let t=0,r=vt;return this.pushLeafInstruction({type:t,valueType:r})}Action(t,r){return this.pushInstruction({type:49,valueType:Ke,args:r,symbols:t})}replaceInstructionWithConstant(t,r){this.instructions[t]=r,this.blockMask[t]=void 0}replaceInstructionWithBlockVarOrFunctionCall(t,r){this.instructions[t]=r}reopenFinalBlock(){let t=this.getInstruction(this.getReturnIndex());if(t.type!==48)return this;let r=t.args[0],i=this.getInstruction(r).args[0];for(let s=i;s<r;s++)this.blockMask[s]=void 0;return this.truncate(r),this}reopenAllBlocks(){this.blockMask=[]}isInClosedBlock(t){return!!this.blockMask[t]}copy(){let t=new e({argNames:this.argNames,argTypes:this.argTypes});return t.instructions=this.instructions.slice(),t.blockMask=this.blockMask.slice(),t.comments=this.comments.slice(),t.derivativeMaps=Us(this.derivativeMaps),t.setReturnIndex(this.getReturnIndex()),t}fuseBroadcast(){return this.setReturnIndex(yn(this,this.getReturnIndex())),this}copyInstruction(t){return Gs(this,t)}copyInstructionWithArgs(t,r){return Ir(this,t,r)}replaceInstructionWithNoop(t){this.instructions[t]={type:0,valueType:vt}}getReturnType(){return this.instructions[this.getReturnIndex()].valueType}isConstant(){return ht(this.instructions[this.getReturnIndex()])}asValue(){return ur(this,this.getReturnIndex())}asCompilerValue(){let t=this.instructions[this.getReturnIndex()];switch(t.type){case 1:return t.value;default:throw new Error(`Unexpected opcode ${t.type}.`)}}getConstantListLength(){return kr(this,this.getReturnIndex())}getListLengthDependencies(){let t=this.copy(),r=Nr(t,t.getReturnIndex());return oi(t,r)}elementAt(t){let r=this.copy(),n=r.getReturnIndex();return r.setReturnIndex(Ff(r,n,t)),r}substituteConstantArguments(t){return PR(this,t)}interpretWithParameters(t){return O1(this,this.getReturnIndex(),t)}getCompiledFunction(t){let r;if(t){r=t.slice();for(let o of this.argNames)r.indexOf(o)===-1&&r.push(o)}else r=this.argNames;let{source:n,constants:i}=Xm(this),s={};return{args:r,source:n,constants:i,executionMetadata:s,fn:Nf(r,n,i,s)}}getRestrictedFunctionForGLSL(t,r){let n=Aa(this,t,{allowSlices:!0}),{restrictionChunk:i,valueChunk:s}=n.getValueAndRestrictionChunk(),o;if(i!==void 0)try{o=Jo(i,r)}catch(a){i=void 0}return o===void 0&&n.getSliceVariablesOrImplicit().length==0?{concrete:new dr(this),restriction:void 0,restrictionExpr:void 0}:{concrete:new dr(s),restriction:o,restrictionExpr:i&&new dr(i)}}polynomialOrder(t,r){return K1(this,t,r)}getPolynomialCoefficients(t){return eS(this,t)}takeDerivative(t){let r=this.argNames.indexOf(t);return r===-1?this.Constant(0):this.setReturnIndex(np(this,this.getReturnIndex(),r)),this}gradient(t){let r=[],n=this.getReturnIndex();for(let i of t){let s=this.argNames.indexOf(i);s===-1?r.push(this.Constant(0)):r.push(np(this,n,s))}return this.List(r),this}deriveRegressionRestrictions(){return gR(this)}boundDomain(t){return fR(this,t,this.getReturnIndex())}findLinearSubset(t){let r=mR(this),n=[];for(let i of t){let s=this.argNames.indexOf(i);if(s===-1)throw new Error(\"Programming Error: findLinearSubset called with a non-dependency\");n.push(r[s])}return n}isLinearIn(t){let r=this.argNames.filter(n=>t.includes(n));return r.length===0?!1:this.findLinearSubset(r).every(Boolean)}isImplicitPlane(){let t=r=>r===\"x\"||r===\"y\"||r===\"z\";return this.isLinearIn([\"x\",\"y\",\"z\"])&&this.argNames.every(t)}print(t,r=this.comments){let n;return t===void 0?(t=this.instructionsLength()-1,n={printUnreferencedInstructions:!0,comments:r}):n={printUnreferencedInstructions:!1,comments:r},hv(this,t,n)}printInstruction(t){return yc(this,t)}toDot(){return Q1(this)}getLiveArgNames(){let t=Ii(this,this.getReturnIndex()),r=[];for(let n=0;n<this.argNames.length;n++)t[n]&&r.push(this.argNames[n]);return r}getCursorContext(){return this.cursorContext}setCursorContext(t){this.cursorContext=t}};var ta={normaldist:{pdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"normalpdf\",r.concat(n.args))},cdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"normalcdf\",r.concat(n.args))},mean:function(e,t,r){return e.getInstruction(t).args[0]},median:function(e,t,r){return ta.normaldist.mean(e,t,r)},stdev:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"abs\",[n.args[1]])},var:function(e,t,r){let n=e.getInstruction(t);return e.Multiply([n.args[1],n.args[1]])},quantile:function(e,t,r){let n=e.getInstruction(t);return e.Add([e.Multiply([e.SyntheticNativeFunction(\"invNorm\",r),e.SyntheticNativeFunction(\"abs\",[n.args[1]])]),n.args[0]])},random:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"normalSample\",[r[0],n.args[0],n.args[1]])}},tdist:{pdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"tpdf\",r.concat(n.args))},cdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"tcdf\",r.concat(n.args))},mean:function(e,t,r){return e.Constant(0)},median:function(e,t,r){return e.Constant(0)},stdev:function(e,t,r){return e.SyntheticNativeFunction(\"sqrt\",[ta.tdist.var(e,t,r)])},var:function(e,t,r){let n=e.getInstruction(t),i=e.Constant(2),s=n.args[0];return e.Piecewise([e.GreaterEqual([s,i]),e.Divide([s,e.Subtract([s,i])]),e.Constant(NaN)])},quantile:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"invT\",[r[0],n.args[0]])},random:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"tSample\",[r[0],n.args[0]])}},poissondist:{pdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"poissonpdf\",r.concat(n.args))},cdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"poissoncdf\",r.concat(n.args))},mean:function(e,t,r){return e.getInstruction(t).args[0]},median:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"invPoisson\",[e.Constant(.5),n.args[0]])},stdev:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"sqrt\",[n.args[0]])},var:function(e,t,r){return ta.poissondist.mean(e,t,r)},quantile:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"invPoisson\",[r[0],n.args[0]])},random:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"poissonSample\",[r[0],n.args[0]])}},binomialdist:{pdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"binompdf\",r.concat(n.args))},cdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"binomcdf\",r.concat(n.args))},mean:function(e,t,r){let n=e.getInstruction(t);return e.Multiply([n.args[0],n.args[1]])},median:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"invBinom\",[e.Constant(.5),n.args[0],n.args[1]])},stdev:function(e,t,r){return e.SyntheticNativeFunction(\"sqrt\",[ta.binomialdist.var(e,t,r)])},var:function(e,t,r){let n=e.getInstruction(t),[i,s]=n.args;return e.Multiply([i,e.Multiply([s,e.Subtract([e.Constant(1),s])])])},quantile:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"invBinom\",[r[0],n.args[0],n.args[1]])},random:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"binomSample\",[r[0],n.args[0],n.args[1]])}},uniformdist:{pdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"uniformpdf\",r.concat(n.args))},cdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"uniformcdf\",r.concat(n.args))},mean:function(e,t,r){let n=e.getInstruction(t);return e.Divide([e.Add([n.args[0],n.args[1]]),e.Constant(2)])},median:function(e,t,r){return ta.uniformdist.mean(e,t,r)},stdev:function(e,t,r){return e.SyntheticNativeFunction(\"sqrt\",[ta.uniformdist.var(e,t,r)])},var:function(e,t,r){let n=e.getInstruction(t),i=e.Subtract([n.args[1],n.args[0]]);return e.Divide([e.Multiply([i,i]),e.Constant(12)])},quantile:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"invUniform\",[r[0],n.args[0],n.args[1]])},random:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"uniformSample\",[r[0],n.args[0],n.args[1]])}}};function DR(e,t,r){let n=r[0],i=e.Constant(0),s=e.Constant(1);if(kr(e,t)===0)return e.Constant(NaN);let a=Nr(e,t);return e.InboundsListAccess([t,e.Add([e.SyntheticNativeFunction(\"floor\",[e.Multiply([e.SyntheticNativeFunction(\"uniformSample\",[n,i,s]),a])]),s])])}function lg(e,t,r){if(t===r)return!0;if(t<r)return!1;let n=[!0];for(let s=r+1;s<=t;s++)n.push(!1);let i=[t];for(;i.length;){let s=i.pop();if(n[s-r])continue;n[s-r]=!0;let o=e.getInstruction(s);if(!ve(o))for(let a of e.getDirectDependencies(o)){if(a===r)return!0;a<r||n[a-r]||i.push(a)}}return!1}var _a;function SR(e){_a=e}function OR(){_a&&(_a.cacheHits+=1)}function RR(){_a&&(_a.cacheMisses+=1)}function CR(){_a&&(_a.cacheWrites+=1)}function NR(){_a&&(_a.cacheReads+=1)}function LR(e,t,r,n,i){let s=ce(r,he)||ce(r,fe),o=ce(i,he)||ce(i,fe);if(!s&&!o)return;let a=_R(e,t,r),u=_R(e,n,i),c=a.filter(l=>u.some(p=>mE(l,p))&&!!e.lookup(l[0]));for(let l of a)AR(e,l,n)&&c.every(p=>!mE(l,p))&&c.push(l);for(let l of u)AR(e,l,t)&&c.every(p=>!mE(l,p))&&c.push(l);if(c.length===1)return c[0]}function mE(e,t){return e[0]===t[0]&&e[1]===t[1]}function AR(e,[t,r],n){let i=e.lookup(t),s=i&&e.getGeometryTree(i);return((s==null?void 0:s.symbol)===\"glider\"||(s==null?void 0:s.symbol)===\"intersection\"||(s==null?void 0:s.symbol)===\"strictintersection\"||(s==null?void 0:s.symbol)===\"midpoint\")&&(s==null?void 0:s.parents.some(o=>o&&e.resolvesTo(o[0],n)&&(r===void 0||o[1]===void 0||o[1]===r)))}function _R(e,t,r){var s;let n=[],i=((s=e.getGeometryTree(t))==null?void 0:s.parents)||[];for(let o=0;o<i.length;o++){let a=i[o];if(ce(r,he)&&o===0||!a)continue;let u=e.lookup(a[0]);u&&e.isPointOrListOfPoints(u)&&n.push(a)}return n}function yE(e,t,r){if(!t)return;let n=gE(t,r._expression);n===\"start-to-end\"?e.setCursorContext({type:r.type===\"Assignment\"?\"assignment-rhs\":\"function-definition-body\",allowedTypes:[vt]}):n===\"empty-list\"&&e.setCursorContext({type:\"expression-arguments\",expressionType:\"List\",argIndex:0,argCount:0,isLastValidArg:!1,positionWithinArg:\"start-to-end\",allowedTypesForInsertedArg:[vt]})}function wR(e,t,r){if(t){let n=gE(t,r.args[1]);n===\"start-to-end\"?e.setCursorContext({type:\"for-assignment-rhs\",allowedTypes:[Se,he,fe,be,_e,Be,...Qi]}):n===\"empty-list\"&&e.setCursorContext({type:\"for-assignment-rhs\",allowedTypes:[vt]})}}function ip(e,t,r,n,i){let s=LB(e,t,r,n,i);s&&e.setCursorContext(s)}function gE(e,t){let r=t.getInputSpan();return r?e.start===r.start&&e.end===r.end?\"start-to-end\":e.start===e.end&&e.start===r.end?\"end\":e.start===e.end&&e.start===r.start?\"start\":e.start===e.end&&t.type===\"List\"&&t.args.length===0?\"empty-list\":\"not-aligned\":\"not-aligned\"}function hE(e,t){if(!e)return;let r=!1;t instanceof Fi&&t.args[1]instanceof lr&&(r=!0,t=t.args[1]);let n=t.args;if(n){if(n.length===0){let i=t.getInputSpan();if(!i)return;let s=Sr(i),o=-1;return t.type===\"List\"?o=s.indexOf(\"[\"):(t.type===\"FunctionCall\"||t.type===\"SeededFunctionCall\")&&(o=s.indexOf(\"(\")),o<0?void 0:e.start===i.start+o+1?{argIndex:0,positionWithinArg:\"start-to-end\",isDotCall:r}:void 0}for(let i=0;i<n.length;i++){let s=n[i],o=s.getInputSpan();if((o==null?void 0:o.input)!==e.input)continue;if(e.start<o.start)break;let a=gE(e,s);if(a!==\"not-aligned\")return{argIndex:i,positionWithinArg:a,isDotCall:r}}}}function LB(e,t,r,n,i){if(!r||!n.args)return;let s=hE(r,n);if(s===void 0)return;s.isDotCall&&(n=n.args[1]);let o=s.positionWithinArg===\"end\"?s.argIndex+1:s.argIndex;s.isDotCall&&(o+=1);let a;s.positionWithinArg===\"empty-list\"||s.positionWithinArg===\"start-to-end\"?a=[...i.slice(0,o),void 0,...i.slice(o+1)]:n instanceof dn?a=o===1?[i[0],void 0,i[1]]:[i[0],i[1],void 0]:a=[...i.slice(0,o),void 0,...i.slice(o)],a=a.map(l=>{if(!(l===void 0||e.getInstruction(l).type===2))return l});let u=EI(e,t,n,a),c=u&&Fy(u,o);if(s.positionWithinArg===\"empty-list\"){let l=c==null?void 0:c.filter(W).map(ze);return(l==null?void 0:l.length)===0?void 0:{type:\"expression-arguments\",expressionType:\"List\",argIndex:0,argCount:0,isLastValidArg:!1,positionWithinArg:\"start-to-end\",allowedTypesForInsertedArg:l!=null?l:[vt]}}else{if((c==null?void 0:c.length)===0)return;let l=!1;if(u){let m=0;for(let g of u){let y=Array.isArray(g)?g.length-1:1/0;m=Math.max(m,y)}l=s.positionWithinArg===\"end\"&&s.argIndex===m-1||s.positionWithinArg===\"start-to-end\"&&s.argIndex===m}let p=n.args.length;if(n instanceof dn&&n.args.length===3){let m=n.args[2];m instanceof jt&&m.isNaN()&&(p=2)}let f={type:\"expression-arguments\",expressionType:n.type,argIndex:s.argIndex,argCount:p,isLastValidArg:l,positionWithinArg:s.positionWithinArg,allowedTypesForInsertedArg:c!=null?c:[vt]};if(n instanceof lr&&(f.functionSymbol=n._symbol,f.isDotCall=s.isDotCall,n instanceof lr&&n._symbol===\"polygon\")){let m=n.args.filter(g=>!(g instanceof Fe&&g._symbol===\"cursor\"));if(m.length>0){let g=m[0].getInputSpan(),y=m[m.length-1].getInputSpan();f.polygonVertices=g&&y?{firstLatex:Sr(g),lastLatex:Sr(y)}:void 0}}return f}}function FR(e){return e.type===\"FunctionDefinition\"}function pg(e){return e.type===\"Identifier\"}function qs(e){return e.type===\"Table\"}function jf(e){return e.type===\"Image\"}function Eo(e){return e.type===\"Error\"}function sp(e){return e.type===\"Regression\"}function wB(e){let t=_f({},{},-1);for(let r=0;r<e.argNames.length;r++)Kr(t,e.argNames[r],r);return t}var op=class op{constructor(t,r,n,i){if(this.kind=t,this.substitutedGlobals={...r==null?void 0:r.substitutedGlobals},t&&n&&i)for(let s of i)n[s]&&n[s]!==Bt&&!this.substitutedGlobals[s]&&(this.substitutedGlobals[s]=t)}allowsRegressionParameterDependency(){if(!this.kind)return!0;for(let t in this.substitutedGlobals)return!1;return!0}getRegressionDependencyError(t){if(this.allowsRegressionParameterDependency())return;let[r,n]=Object.entries(this.substitutedGlobals)[0];return HP(r,t,n)}getKind(){return this.kind}getSubstitutedGlobals(){return this.substitutedGlobals}with(t,r){return new op(\"with\",this,t,r)}for(t,r){return new op(\"for\",this,t,r)}};op.root=new op;var Wf=op,gg=class{constructor(t,r,n){this.definitions=t;this.returnTypes=r;this.compiledBaseCases=n;this.type=\"type-inference\";this.argTypes={};this.stack=[]}registerFunctionCall(t,r){this.argTypes[t]||(this.argTypes[t]=r)}};function ci(e,t,r,n,i,s,o){return{policy:e,frame:t,chunk:r,scope:n,substitutionContext:i,recursiveFunctionContext:s,selection:o}}function Pg(e){let{policy:t,frame:r,argNames:n,argTypes:i,selection:s}=e,o=new Qo({argNames:n,argTypes:i}),a=wB(o);return ci(t,r,o,a,Wf.root,void 0,s)}function ap(e,t){let{policy:r,frame:n,argNames:i,argTypes:s,selection:o}=e,a=rE(n,t),{freeDependencies:u,updateSymbols:c}=a;if(i||(i=u),!s){s=[];for(let p=0;p<i.length;p++)s.push(T)}let l=Pg({policy:r,frame:n,argNames:i,argTypes:s,selection:o});try{aR(r,n,t.getScope()),Ie(l,t),(e.coerceToNumber||ce(l.chunk.getReturnType(),Gt))&&Iu(l.chunk,l.chunk.getReturnIndex()),e.wrapInList&&!W(l.chunk.getReturnType())&&l.chunk.List([l.chunk.getReturnIndex()]),l.chunk.fuseBroadcast(),VB(l,t,a),FB(l,t,c)}catch(p){let f=p instanceof R?p:ee(p);f.setCursorContext(l.chunk.getCursorContext()),l.chunk.setError(f)}return l.chunk}function FB(e,t,r){if(t.type===\"FunctionDefinition\")for(let i of r){if(t._argSymbols.indexOf(i)!==-1||t._symbol===i)throw rm(i);if(t._sybmol===i)throw tm(i)}let n=[];for(let i of r)e.frame[i]||n.push(i);if(n.length){let i=XR(e,n[0]).setDependencies(e.chunk.argNames.concat(n));throw e.chunk.isConstant()&&e.chunk.getReturnType()===Ke&&i.setActionValue(e.chunk.asValue()),i}}function VB(e,t,{substitutionSymbols:r}){if(t.type===\"FunctionDefinition\")for(let i of r){if(t._argSymbols.indexOf(i)!==-1||t._symbol===i)throw af(i);if(t._sybmol===i)throw ml(i)}let n=[];for(let i of r)e.frame[i]||n.push(i);if(n.length){let i=n[0];if(e.policy.substitutionForbidden(i))throw dl(i)}}function Ie(e,t){let r;if(NR(),zB(e,t))OR(),r=e.chunk.copyInstruction(t.__IRCache.instruction);else{RR();let n=e.chunk.instructionsLength();r=kB(e,t),r=BB(e,n,r),GB(e,t,r)}return e.chunk.setReturnIndex(r),r}function BB(e,t,r){let{chunk:n,scope:i}=e;if(r<=t)return r;let s=n.getInstruction(r);return ht(s)?(n.truncate(Math.max(t,i.maxIndex+1)),Gs(n,s)):r}function GB(e,t,r){let{frame:n,chunk:i}=e,s=i.getInstruction(r);if(!ht(s))return;let o=oR(n,t);o&&(CR(),t.__IRCache={keys:o,instruction:s})}function zB(e,t){let{frame:r,substitutionContext:n}=e;if(!t.__IRCache)return!1;let i=t.__IRCache.keys;for(let[s,o]of i){let a=r[s];if(a!==o||a&&a.type===\"RegressionParameter\"&&!n.allowsRegressionParameterDependency())return!1}return!0}function kB(e,t){var p,f,m,g;let{policy:r,frame:n,chunk:i,scope:s,substitutionContext:o,recursiveFunctionContext:a,selection:u}=e,c=t.type;switch(c){case\"Constant\":{let d=t._constantValue,h=typeof d==\"boolean\"?Ee:T;return i.ConstantOfType(h,d)}case\"RegressionParameter\":return i.Constant(t._constantNode._constantValue);case\"MixedNumber\":return i.Constant(t._constantValue);case\"Negative\":return i.Negative(fg(e,t,t.args));case\"Add\":return i.Add($s(e,t,t.args));case\"Subtract\":return i.Subtract($s(e,t,t.args));case\"Multiply\":{let d=$s(e,t,t.args);if(e.policy.is3dProduct()){let h=i.getInstruction(d[0]).valueType,b=i.getInstruction(d[1]).valueType;if(ce(h,V)&&ce(b,V))throw Vp([ne(h),ne(b)]);if(ce(h,C)&&ce(b,C))throw Fp([ne(h),ne(b)])}return i.Multiply(d)}case\"DotMultiply\":{let[d,h]=$s(e,t,t.args);return(f=(p=VR(e,d,h))!=null?p:Oa(i,[d,h])?VR(e,ai(i,d),ai(i,h),{forcePermitted:!0}):void 0)!=null?f:i.Multiply([d,h])}case\"CrossMultiply\":{let[d,h]=$s(e,t,t.args);if(!e.policy.is3dPolicy())return i.Multiply([d,h]);if(We(i,d,Ce)&&We(i,h,Ce))return gu(i,[BR(e,ai(i,d),ai(i,h)),Po(i,d)]);if(We(i,d,V)&&We(i,h,V))return BR(e,d,h);if(We(i,d,C)&&We(i,h,C)||We(i,d,T)&&We(i,h,V)||We(i,d,V)&&We(i,h,T)){let b=i.getInstruction(d).valueType,x=i.getInstruction(h).valueType;throw wp([ne(b),ne(x)])}else return i.Multiply([d,h])}case\"Divide\":return i.Divide($s(e,t,t.args));case\"Exponent\":return i.Exponent($s(e,t,t.args));case\"Comparator['=']\":case\"Comparator['>']\":case\"Comparator['<']\":case\"Comparator['>=']\":case\"Comparator['<=']\":return i.Comparator(t.operator,$s(e,t,t.args));case\"ComparatorChain\":{let d=La(e,t,t.args),h=i.Comparator(t.symbols[0],[d[0],d[1]]);for(let b=1;b<t.symbols.length;b++)h=i.And([h,i.Comparator(t.symbols[b],[d[b],d[b+1]])]);return h}case\"Or\":return i.Or($s(e,t,t.args));case\"PercentOf\":return i.Divide([i.Multiply($s(e,t,t.args)),i.Constant(100)]);case\"ParenSeq\":return $B(e,t);case\"BareSeq\":return YB(e,t);case\"NamedCoordinateAccess\":{let[d]=fg(e,t,t.args),h=t.symbol,b=We(i,d,V),x;switch(h){case\"x\":x=1;break;case\"y\":x=2;break;case\"z\":{if(!b)throw Ln(\".\").allowExport();x=3;break}default:{let P=h;throw new Error(`Programming Error: unexpected named coordinate: '${P}'.`)}}return b?i.OrderedTripleAccess(x,[d]):i.OrderedPairAccess(x,[d])}case\"Norm\":{let d=fg(e,t,t.args)[0];return(g=(m=xE(e,d))!=null?m:Oa(i,[d])?xE(e,ai(i,d)):void 0)!=null?g:i.SyntheticNativeFunction(\"abs\",[d])}case\"UpdateRule\":{let d=t._symbol;var l=n[d];if(l!==void 0){if(l!==Bt&&l.isError)throw l;if(l===Bt||l.type!==\"Assignment\"&&l.type!==\"Slider\")throw XR(e,d)}let h=Ie(e,t.args[1]);return i.Action([d],[h])}case\"List\":{if(t.getDependencies().length>0)return qn(t.args),i.List(La(e,t,t.args));if(t.args.length===0)return ip(i,r,u,t,[]),i.ConstantOfType(Xe,[]);{let d=i.instructionsLength(),h=[],b,x;qn(t.args);for(let E of t.args){let M=Ie(e,E),I=i.getInstruction(M);if(b===void 0){if(b=I.valueType,!ei(b))throw Za([ne(b)]);x=pn(b)}else if(I.valueType!==b){if(Kn(I.valueType,b)||Kn(b,I.valueType))return i.truncate(d),i.List(La(e,t,t.args));throw kp()}if(I.type!==1)throw new Error(\"Programming error: expected list with no dependencies to constant collapse.\");h.push(I.value),i.truncate(d)}let P=hE(e.selection,t);if(e.selection&&P!==void 0&&x!==void 0&&P.positionWithinArg!==\"empty-list\"){let E=ze(x);i.setCursorContext({type:\"expression-arguments\",expressionType:\"List\",argIndex:P.argIndex,argCount:t.args.length,isLastValidArg:!1,positionWithinArg:P.positionWithinArg,allowedTypesForInsertedArg:[E]})}return i.ConstantOfType(x,h)}}case\"ListAccess\":{let d=Ie(e,t.args[0]),h=i.getInstruction(d);if(t.args[1].type===\"Range\"&&t.args[1].args[1].length===0){if(!W(h.valueType))throw Bp([ne(h.valueType),ne(T)]);let b=Nr(i,d),x=hg(e,Ie(e,t.args[1].args[0]),i.List([b]),{stepMustBePositive:!0});return i.ListAccess([d,x])}else{let b=Ie(e,t.args[1]),x=i.getInstruction(b);if(du(i,r,t,[d,b]),x.valueType===_r)return i.SyntheticNativeFunction(\"select\",[d,b]);if(x.valueType===Ee&&W(h.valueType)){let P=i.ConstantOfType(h.valueType,[]);return i.Piecewise([b,d,P])}return i.ListAccess([d,b])}}case\"Range\":{let[d,h]=$s(e,t,t.args);return hg(e,d,h,{stepMustBePositive:!1})}case\"ListComprehension\":return ZB(e,t);case\"Piecewise\":{let d=HB(e,t,t.args),h=i.getInstruction(d[0]),b=i.getInstruction(d[1]),x=i.getInstruction(d[2]),P=_s(b.valueType,x.valueType)||_s(x.valueType,b.valueType);if(h.type===1&&h.valueType===Ee&&P){let I=d[h.value?1:2],D=i.getInstruction(I),O=b.valueType!==Xe?b.valueType:x.valueType;return D.valueType===Xe&&O!==Xe?i.ConstantOfType(O,[]):I}let E=b.valueType,M=W(E)?ze(E):E;if(!P&&ht(x)&&x.valueType===T&&bi(x.value)&&fo(M)){if(ce(b.valueType,Gt))return i.SyntheticNativeFunction(\"restriction\",[i.And([d[0],i.SyntheticNativeFunction(\"restrictionToBoolean\",[d[1]])])]);let I=i.NanOfType(M);d=[d[0],d[1],I]}return i.Piecewise(d)}case\"Restriction\":return i.SyntheticNativeFunction(\"restriction\",fg(e,t,t.args));case\"Ans\":case\"Identifier\":{let d=t._symbol,h=t._errorSymbol;if(t.type===\"Ans\"&&i.argNames.indexOf(d)!==-1)throw AP();let b=Oy(s,d),x=n[d];if(b!==void 0&&(s.symbolMap.hasOwnProperty(d)||x===void 0||x===Bt))return b;if(x===void 0){if(rt[d]){let E=e.policy.is3dPolicy();throw rt[d].isFunction?gs(h,E):ic(h)}throw new Error(`Programming Error: reached undefined symbol ${d}`)}if(x!==Bt&&Eo(x))throw x;if(x===Bt||x.isFunction)throw ux(h);if(x.type===\"RegressionParameter\"){let E=o.getRegressionDependencyError(h);if(E)throw E}let P=Ie(e,x);return Kr(s,d,P,x),P}case\"FunctionCall\":case\"SeededFunctionCall\":{qn(t.args);let d=La(e,t,t.args);return qn(d),dg(e,t._symbol,t._errorSymbol,d,t.args)}case\"Substitution\":return eG(e,t);case\"FunctionExponent\":{let d=t.args[0]._symbol,h=n[d];return h!==Bt&&(h!=null&&h.isFunction)?Ie(e,new v.Exponent([new v.FunctionCall(d,[t.args[1]]),t.args[2]])):Ie(e,new v.Multiply([t.args[0],new v.Exponent([t.args[1],t.args[2]])]))}case\"FunctionFactorial\":{let d=t.args[0]._symbol,h=n[d];return h!==Bt&&(h!=null&&h.isFunction)?Ie(e,new v.FunctionCall(\"\\\\factorial\",[new v.FunctionCall(d,[t.args[1]])])):Ie(e,new v.Multiply([t.args[0],new v.FunctionCall(\"\\\\factorial\",[t.args[1]])]))}case\"DotAccess\":{let d=t.args[0],h=t.args[1],b=n[h._symbol];if(d.type===\"Identifier\"&&d._symbol===\"construction\")return tG(e,h);if((h.type===\"Identifier\"||h.type===\"FunctionCall\")&&b!==Bt&&(b!=null&&b.isFunction)){let x=h._symbol,P=h._errorSymbol,E=h.type===\"Identifier\"?[d]:[d].concat(h.args),M=La(e,t,E);return dg(e,x,P,M,E,{dotLHSIndex:M[0]})}else if(h.type===\"SeededFunctionCall\"){let x=h._symbol,P=h._errorSymbol,E=[h.seed,d].concat(h.args.slice(1)),M=La(e,t,E);return dg(e,x,P,M,E,{dotLHSIndex:M[1]})}else throw Ln(\".\")}case\"Seed\":return i.ConstantOfType(et,t._stringValue);case\"ExtendSeed\":return i.ExtendSeed(t.tag,$s(e,t,t.args));case\"Integral\":{let d=t._differential._symbol,h=Object.create(n);h[d]=OP(d);let b=Gi(s),x=ci(r,h,i,b,o,a,u),P=Ie(x,t.args[1]),E=Ie(x,t.args[2]),M=i.getInstruction(P),I=i.getInstruction(E),D=i.SymbolicVar(T,d),O=Gi(s);Kr(O,d,D);let N=Object.create(n);N[d]=Bt;let A=Ie(ci(r,N,i,O,o,a,u),t.args[3]);if(!lg(i,A,D))return i.Multiply([A,i.Subtract([E,P])]);let L=Lf(i,[P,E,A]),q=L!==void 0?i.BeginBroadcast([L]):void 0,$=P;q!==void 0&&W(M.valueType)&&($=Da(i,P,q));let X=E;q!==void 0&&W(I.valueType)&&(X=Da(i,E,q));let G=i.getInstruction(A).valueType,J=W(G)?ze(G):G,w;if(J===C||J===V){let Z=[],te=J===C?2:3;for(let z=0;z<te;z++){let oe=i.BeginIntegral({indexSymbol:d},[$,X]),re=Na(i,oe,D,A),me=i.getInstruction(re);q!==void 0&&W(me.valueType)&&(re=Da(i,re,q)),re=J===C?i.OrderedPairAccess(z+1,[re]):i.OrderedTripleAccess(z+1,[re]);let ye=i.EndIntegral([oe,re]);Z.push(i.BlockVar(T,[ye]))}w=J===C?i.OrderedPair(Z):i.OrderedTriple(Z)}else{let Z=i.BeginIntegral({indexSymbol:d},[$,X]),te=Na(i,Z,D,A),z=i.getInstruction(te);q!==void 0&&W(z.valueType)&&(te=Da(i,te,q));let oe=i.EndIntegral([Z,te]);w=i.BlockVar(T,[oe])}if(q!==void 0){let Z=i.EndBroadcast([q,w]);return i.BroadcastResult(pn(J),[Z])}else return w}case\"Sum\":case\"Product\":{let d=t._index._symbol,h=t.type===\"Sum\",b=Object.create(n);b[d]=h?bP(d):xP(d);let x=Gi(s),P=ci(r,b,i,x,o,a,u),E=Ie(P,t.args[1]);E=Iu(P.chunk,E);let M=Ie(P,t.args[2]);if(M=Iu(P.chunk,M),!We(i,E,T)){let ae=Dc(i,[E]);throw h?gb(ae):xb(ae)}if(!We(i,M,T)){let ae=Dc(i,[M]);throw h?hb(ae):Pb(ae)}let I=i.SyntheticNativeFunction(\"round\",[E]),D=i.SyntheticNativeFunction(\"round\",[M]),O=i.getInstruction(I),N=i.getInstruction(D);if(O.type===1&&O.valueType===T&&!isFinite(Y(O.value)))throw h?Qd():Kd();if(N.type===1&&N.valueType===T&&!isFinite(Y(N.value)))throw h?Qd():Kd();let A=i.SymbolicVar(T,d),L=Gi(s);Kr(L,d,A);let q=Object.create(n);q[d]=Bt;let $=Ie(ci(r,q,i,L,o,a,u),t.args[3]),X=i.getInstruction($).valueType,G=W(X)?ze(X):X,w=(t.type===\"Sum\"?Dh:[T]).find(ae=>Kn(G,ae));if(w===void 0){let ae=Dc(i,[$]);throw h?bb(ae):Tb(ae)}if(!lg(i,$,A)){let ae=i.Add([i.Subtract([D,I]),i.Constant(1)]);ae=i.SyntheticNativeFunction(\"max\",[ae,i.Constant(0)]);let He=h?i.Multiply([$,ae]):i.Exponent([$,ae]);return i.Piecewise([i.Less([ae,i.Constant(1/0)]),He,i.NanOfType(w)])}let Z=Lf(i,[I,D,$]);if(Z!==void 0&&lg(i,Z,A))throw h?zP(d):kP(d);let te=Z!==void 0?i.BeginBroadcast([Z]):void 0,z=I;te!==void 0&&W(O.valueType)&&(z=Da(i,I,te));let oe=D;te!=null&&W(N.valueType)&&(oe=Da(i,D,te));let re=i.Constant(h?0:1),me=w===C?i.OrderedPair([re,re]):w===V?i.OrderedTriple([re,re,re]):re,ye=i.BeginLoop({type:h?\"sum\":\"product\",indexSymbol:d},[z,oe,me]),De=i.BlockVar(w,[ye]),K=Na(i,ye,A,$),H=i.getInstruction(K);te!==void 0&&W(H.valueType)&&(K=Da(i,K,te));let xe=h?i.Add([De,K]):i.Multiply([De,K]),ge=i.EndLoop([ye,xe]),se=i.BlockVar(w,[ge]);if(te!==void 0){let ae=i.EndBroadcast([te,se]);return i.BroadcastResult(pn(w),[ae])}else return se}case\"Derivative\":{let d=t._symbol,h=Ie(e,new v.Identifier(d));if(!We(i,h,T))throw Db(d,Dc(i,[h]));let b=i.getInstruction(h),x,P,E=!1;if((b.type===2||b.type===3)&&b.valueType===T)x=e,P=h;else{let O=Gi(s);P=i.SymbolicVar(b.valueType),Kr(O,d,P),E=!0;let N=Object.create(n);N[d]=Bt,x=ci(r,N,i,O,o,a,u)}let M=1;for(;t.args[0].type===\"Derivative\"&&t.args[0]._symbol===t._symbol;)M+=1,t=t.args[0];let D=yn(i,Ie(x,t.args[0]));for(let O=0;O<M;O++)D=np(i,D,P);return P===h?D:(E&&delete i.derivativeMaps[P],Na(i,h,P,D))}case\"Prime\":{let d=t.args[0],h=n[d._symbol];if(!h)throw fm(d._symbol);if(h===Bt||!h.isFunction)throw cx(d._symbol);let b=Ie(e,d.args[0]),x=i.getInstruction(b),P=!1,E;(x.type===2||x.type===3)&&x.valueType===T?E=b:(E=i.SymbolicVar(x.valueType),P=!0);let M,I;if(d._symbol===\"logbase\"){if(d.args.length!==2)throw rc();M=[E,Ie(e,d.args[1])],I=[d.args[0],d.args[1]]}else{if(d.args.length!==1)throw rc();M=[E],I=[d.args[0]]}let O=yn(i,dg(e,d._symbol,d._errorSymbol,M,I));for(let N=0;N<t.order;N++)O=np(i,O,E);return E===b?O:(P&&delete i.derivativeMaps[E],Na(i,b,E,O))}case\"Slider\":return e.chunk.Constant(t.getConcreteTree(r,n).asCompilerValue());case\"Assignment\":return yE(i,e.selection,t),Ie(e,t._expression);case\"CoordinateEquation\":return Ie(e,t._expression);case\"FunctionDefinition\":{let d=t;return yE(i,e.selection,d),d.recursionInfo?WR(e,d,d.recursionInfo):Ie(e,t._expression)}case\"RecursiveFunctionCall\":{let d=t;if(!a)throw ee(\"Expected recursiveFunctionContext to be set for recursive call\");if(a.type===\"compile-iterative\"){if(!d.recursiveParameter)throw ee(\"Expected recursiveParameter to be set for iterative recursive call\");return Ie(e,new Fe(TE(d._symbol,d.recursiveParameter.offset)))}let h=La(e,t,d.args);if(a.type===\"type-inference\"){a.registerFunctionCall(d._symbol,h.map(M=>i.getInstruction(M).valueType));let P=a.definitions[d._symbol];if(P instanceof R)throw P;let E=jR(e,a,P,h);return i.SymbolicVar(E.returnType)}let b=Oy(s,d._symbol);if(!b)throw ee(`Expected a function definition for ${b} to be in scope`);let x=i.getInstruction(b);if(x.signature.parameterSymbols.length!==h.length)throw rs(d._symbol,x.signature.parameterSymbols.length,h.length);for(let P=0;P<h.length;P++){let E=i.getInstruction(h[P]).valueType,M=x.signature.argTypes[P];if(!ce(E,M))throw Jr(`Expected argument ${P} to be ${$t(M)} but found ${$t(E)}`)}return i.FunctionCall(d._symbol,!0,[b,...h])}case\"RecursiveFunctionBaseCase\":return Ie(e,t.rhs);case\"Construction\":throw Ln(\"construction\");default:let y=c;throw new Error(`Programming error, unimplemented node type ${y}`)}}function fg(e,t,r){let n=[Ie(e,r[0])];return ip(e.chunk,e.policy,e.selection,t,n),du(e.chunk,e.policy,t,n),n}function $s(e,t,r){let n=[Ie(e,r[0]),Ie(e,r[1])];return ip(e.chunk,e.policy,e.selection,t,n),du(e.chunk,e.policy,t,n),n}function xE(e,t){let r=e.chunk;return We(r,t,V)?r.SyntheticNativeFunction(\"hypot\",[r.OrderedTripleAccess(1,[t]),r.SyntheticNativeFunction(\"hypot\",[r.OrderedTripleAccess(2,[t]),r.OrderedTripleAccess(3,[t])])]):We(r,t,C)?r.SyntheticNativeFunction(\"hypot\",[r.OrderedPairAccess(1,[t]),r.OrderedPairAccess(2,[t])]):void 0}function VR(e,t,r,{forcePermitted:n}={forcePermitted:!1}){let i=e.chunk;return(n||e.policy.is3dProduct())&&We(i,t,C)&&We(i,r,C)?i.Add([i.Multiply([i.OrderedPairAccess(1,[t]),i.OrderedPairAccess(1,[r])]),i.Multiply([i.OrderedPairAccess(2,[t]),i.OrderedPairAccess(2,[r])])]):(n||e.policy.is3dProduct())&&We(i,t,V)&&We(i,r,V)?i.Add([i.Add([i.Multiply([i.OrderedTripleAccess(1,[t]),i.OrderedTripleAccess(1,[r])]),i.Multiply([i.OrderedTripleAccess(2,[t]),i.OrderedTripleAccess(2,[r])])]),i.Multiply([i.OrderedTripleAccess(3,[t]),i.OrderedTripleAccess(3,[r])])]):void 0}function BR(e,t,r){let n=e.chunk,i=n.OrderedTripleAccess(1,[t]),s=n.OrderedTripleAccess(2,[t]),o=n.OrderedTripleAccess(3,[t]),a=n.OrderedTripleAccess(1,[r]),u=n.OrderedTripleAccess(2,[r]),c=n.OrderedTripleAccess(3,[r]);return n.OrderedTriple([n.Subtract([n.Multiply([s,c]),n.Multiply([o,u])]),n.Subtract([n.Multiply([o,a]),n.Multiply([i,c])]),n.Subtract([n.Multiply([i,u]),n.Multiply([s,a])])])}function HB(e,t,r){let n=[Ie(e,r[0]),Ie(e,r[1]),Ie(e,r[2])];return ip(e.chunk,e.policy,e.selection,t,n),du(e.chunk,e.policy,t,n),n}function La(e,t,r){let n=[];for(let i of r)n.push(Ie(e,i));return ip(e.chunk,e.policy,e.selection,t,n),du(e.chunk,e.policy,t,n),n}function dg(e,t,r,n,i,s){let{policy:o,frame:a,chunk:u,scope:c,substitutionContext:l,recursiveFunctionContext:p,selection:f}=e,m=Oy(c,t);if(m!==void 0){if(ce(u.getInstruction(m).valueType,Ue))return xg(e.chunk,[m,...n],r,!0);if(n.length>=1){let y=n.length===1?n[0]:Ie(e,new v.ParenSeq(i));return u.Multiply([m,y])}else throw u.getInstruction(m).type===2?fm(r):u.getInstruction(m).valueType===Dt?Em(r):Im(r)}let g=a[t];if(g!==Bt&&(g!=null&&g.isError))throw g;if(g===void 0||g===Bt||!g.isFunction){if(rt[t]&&rt[t].isFunction){if(t===\"logbase\"&&a.ln&&a.log)throw _P();let y=e.policy.is3dPolicy();throw gs(r,y)}if(g&&g!==Bt){let y=Ie(e,g);if(u.getInstruction(y).valueType===Dt)throw Em(r);if(ce(u.getInstruction(y).valueType,Ue))return xg(e.chunk,[y,...n],r,!0)}if(n.length>=1){let y=n.length===1?n[0]:Ie(e,new v.ParenSeq(i));return u.Multiply([Ie(e,new v.Identifier(t)),y])}throw g?Im(r):new Error(`Programming Error: reached undefined symbol ${t}`)}if(FR(g)){if(s&&s.dotLHSIndex!==void 0)throw Gp(r);if(n.length!==g._argSymbols.length)throw rs(r,g._argSymbols.length,n.length);let y=Gi(c),d=Object.create(a);for(let b=0;b<g._argSymbols.length;b++)Kr(y,g._argSymbols[b],n[b],i[b]),d[g._argSymbols[b]]=Bt;let h=ci(o,d,u,y,l,p,f);return g.recursionInfo?WR(h,g,g.recursionInfo):Ie(h,g._expression)}else{if(co.hasOwnProperty(t))return yg(e,t,r,n,i,s);if(gr.hasOwnProperty(t))return mg(e,t,r,n,s);{let y=e.policy.is3dPolicy();throw gs(r,y)}}}function UB(e,t){let r=Po(e,t),n=e.Add([r,ai(e,t)]);return e.SyntheticNativeFunction(\"segment\",[r,n])}function mg(e,t,r,n,i){let{chunk:s}=e,o=gr[t],a=!!(i&&i.dotLHSIndex!==void 0),u=n.length,{minArity:c,maxArity:l}=o;if(u>l||u<c)throw ee(\"Unexpected arity mismatch\");let p=qR(s,n,o),f={errorSymbol:r,providedArity:u,isDotCall:a};switch(o.tag){case\"default\":case\"reducer\":case\"doubleReducer\":case\"parameterizedReducer\":case\"color\":case\"never-broadcast\":return s.NativeFunction(t,f,p);case\"trig\":{let m=Ie(e,new v.Identifier(\"trigAngleMultiplier\")),g=s.Multiply([p[0],m]);return s.NativeFunction(t,f,[g])}case\"trig2\":{let m=Ie(e,new v.Identifier(\"trigAngleMultiplier\")),g=s.Multiply([p[1],m]);return s.NativeFunction(t,f,[p[0],g])}case\"inverseTrig\":{let m=Ie(e,new v.Identifier(\"trigAngleMultiplier\")),g=s.NativeFunction(t,f,p);return s.Divide([g,m])}default:{let m=o.tag;throw new Error(`Programming Error: unexpected tag ${m}`)}}}function qR(e,t,{minArity:r,defaultArguments:n}){if(!n||!(t.length-r<n.length))return t;let i=t.slice();for(;i.length-r<n.length;)i.push(e.copyInstruction(n[i.length-r]));return i}function qB(e,t,{match:r,noBroadcast:n}){let i=[n?r:ti(r)];return Ly(i,t.map(s=>e.getInstruction(s).valueType),0).length>0}function hu(e,t,r,n){let i=n.find(s=>qB(e,t,s));if(!i){if(typeof r==\"string\")throw Vi(r,Ma(e,t));return r(e,t)}return i.build(e,t)}function GR(e,t){if(t.length!==2)throw ee(\"Can only take the midpoint of two points\");let r=e.Constant(Re(1,2));return e.Multiply([r,e.Add(t)])}function yg(e,t,r,n,i,s){let{chunk:o,policy:a}=e,u=co[t];if(u.fallthroughUnlessDistribution&&u.fallthroughUnlessDistribution&&!kR(o,n))return mg(e,t,r,n,s);let{minArity:c,maxArity:l}=u,p=n.length;if(p<c||p>l)throw new Error(\"Programming Error: unexpected arity mismatch\");let f;if(t===\"cdf\")p===2?f=[n[0],o.Constant(-1/0),n[1]]:f=n;else if(t===\"random\")if(p===1||p<4&&!W(o.getInstruction(n[1]).valueType)&&o.getInstruction(n[1]).valueType!==Dt){let y=o.Distribution(\"uniformdist\",[o.Constant(0),o.Constant(1)]);f=[n[0],y].concat(n.slice(1))}else f=n;else f=qR(o,n,u);let m=Rp(t);if(m){let y=aE(o,f,m);y.didCoerce&&(f=y.args)}function g(y,d=r){return hu(o,f,d,y)}switch(t){case\"length\":if(a.isGeometryEnabled()||a.is3dPolicy()){let y=f[0],d=a.is3dPolicy()?mb:db;return g([{match:[Xe],build:()=>{throw d(r,Ma(o,f)[0])}},{match:[Rt],build:()=>{let h=o.Constant(0),b=o.Constant(1);return o.SyntheticNativeFunction(\"distanceThreeD\",[o.SyntheticNativeFunction(\"segmentThreeDGlider\",[y,h]),o.SyntheticNativeFunction(\"segmentThreeDGlider\",[y,b])])}},{match:[Se],build:()=>{let h=o.Constant(0),b=o.Constant(1);return o.SyntheticNativeFunction(\"distance\",[o.SyntheticNativeFunction(\"segmentGlider\",[y,h]),o.SyntheticNativeFunction(\"segmentGlider\",[y,b])])}},{match:[fe],build:()=>{let h=o.SyntheticNativeFunction(\"abs\",[o.SyntheticNativeFunction(\"arcOmega\",[f[0]])]),{radius:b,startPoint:x}=ZR(o,f[0]),P=o.SyntheticNativeFunction(\"arcGlider\",[f[0],o.Constant(1)]);return o.Piecewise([o.Equal([h,o.Constant(0)]),o.SyntheticNativeFunction(\"distance\",[x,P]),o.Multiply([b,h])])}},{match:[Sh],build:()=>xE(e,ai(o,y))},{match:[or],noBroadcast:!0,build:()=>{throw d(r,Ma(o,f)[0])}}])}else return o.SyntheticNativeFunction(\"count\",f);case\"round\":return g([{match:[T],build:()=>o.SyntheticNativeFunction(\"round\",f)},{match:[T,T],build:()=>{let y=o.SyntheticNativeFunction(\"round\",[f[1]]),d=o.RawExponent([o.Constant(10),y]);return o.Divide([o.SyntheticNativeFunction(\"round\",[o.Multiply([f[0],d])]),d])}}]);case\"midpoint\":return g([{match:[Se],build:()=>{let y=o.Constant(Re(1,2));return o.SyntheticNativeFunction(\"segmentGlider\",[f[0],y])}},{match:[Rt],build:()=>{let y=o.Constant(Re(1,2));return o.SyntheticNativeFunction(\"segmentThreeDGlider\",[f[0],y])}},{match:[C,C],build:GR},{match:[V,V],build:GR}]);case\"circle\":return g([{match:[C,Se],build:()=>{let y=o.Constant(0),d=o.Constant(1);return o.SyntheticNativeFunction(\"circle\",[f[0],o.SyntheticNativeFunction(\"distance\",[o.SyntheticNativeFunction(\"segmentGlider\",[f[1],y]),o.SyntheticNativeFunction(\"segmentGlider\",[f[1],d])])])}},{match:[C,C],build:()=>o.SyntheticNativeFunction(\"circle\",[f[0],o.SyntheticNativeFunction(\"distance\",f)])},{match:[C,T],build:()=>o.SyntheticNativeFunction(\"circle\",f)}]);case\"segment\":return g(Bf(\"segment\",\"segmentThreeD\"));case\"vector\":return g(Bf(\"vector\",\"vectorThreeD\"));case\"distance\":return g(Bf(\"distance\",\"distanceThreeD\"));case\"center\":case\"radius\":return g([{match:[{meta:\"union\",types:[he,fe]}],build:()=>{let y=WB(o,f[0]);return o.SyntheticNativeFunction(t,[y])}}]);case\"glider\":return $R(e.chunk,f);case\"intersection\":case\"strictintersection\":{let y=0;t===\"strictintersection\"&&((We(o,f[0],Se)||We(o,f[0],fe))&&(y+=3),(We(o,f[1],Se)||We(o,f[1],fe))&&(y+=12)),We(o,f[0],_e)&&(y+=1),We(o,f[1],_e)&&(y+=4);let d=KB(e,i,f);if(!d)return bE(o,f,y);let h=Ie(e,new v.Identifier(d[0]));return d[1]!==void 0&&(h=o.ListAccess([h,o.Constant(d[1])])),o.SyntheticNativeFunction(\"chooseNonIncidentPoint\",[h,bE(o,[f[0],f[1]],y),bE(o,[f[1],f[0]],y<<2&12|y>>2&3)])}case\"parallel\":case\"perpendicular\":return g([{match:[{meta:\"union\",types:Dd},C],build:()=>{let d=[bg(o,f[0]),f[1]];return o.SyntheticNativeFunction(t,d)}}]);case\"start\":return Po(o,f[0]);case\"end\":return o.Add([Po(o,f[0]),ai(o,f[0])]);case\"translate\":case\"reflect\":case\"rotate\":case\"dilate\":return jB(e,t,f);case\"apply\":return xg(o,f,r,!1);case\"normaldist\":case\"tdist\":case\"poissondist\":case\"binomialdist\":case\"uniformdist\":return o.Distribution(t,f);case\"pdf\":case\"cdf\":case\"median\":case\"stdev\":case\"var\":case\"quantile\":return zR(o,f,t);case\"total\":case\"mean\":return t===\"mean\"&&kR(o,n)?zR(o,f,t):g([{match:{type:\"variadic\",initial:[],rest:Xe},build:()=>mg(e,t,r,f,s)},{match:{type:\"variadic\",initial:[C],rest:C},build:()=>{let d=h=>o.SyntheticNativeFunction(t,f.map(b=>o.OrderedPairAccess(h,[b])));return o.OrderedPair([d(1),d(2)])}},{match:{type:\"variadic\",initial:[V],rest:V},build:()=>{let d=h=>o.SyntheticNativeFunction(t,f.map(b=>o.OrderedTripleAccess(h,[b])));return o.OrderedTriple([d(1),d(2),d(3)])}}],()=>mg(e,t,r,f,s));case\"random\":{let y=f[0],d=f[1],h=o.getInstruction(f[0]),b=o.getInstruction(d);if(h.valueType!==et)throw ee(`Unexpected value type for seed arg: ${h.valueType}`);if(b.valueType===Lr)throw Kb();let x;if(W(b.valueType))x=DR;else{if(b.type!==42||b.valueType!==Dt)throw ee('Expected distribution argument to \"random\"');x=ta[b.symbol][t]}if(f.length>2){let P=f[2],E=o.getInstruction(P);if(E.valueType!==T)throw ee(`Expected numSamples argument to random() to be a number but got ${E.valueType}`);if(f.length===4){if(o.getInstruction(f[3]).valueType!==T)throw ee(`Expected userSeed argument to random() to be a number but got ${E.valueType}`);y=o.ExtendSeed(\"us\",[y,f[3]])}let M=o.Constant(1),I=o.SyntheticNativeFunction(\"round\",[o.SyntheticNativeFunction(\"validateSampleCount\",[P])]),D=o.BeginBroadcast([I]);y=o.ExtendSeed(\"lc\",[y,o.Subtract([D,M])]);let O=x(o,d,[y]),N=o.EndBroadcast([D,O]);return o.BroadcastResult(pn(o.getInstruction(O).valueType),[N])}return x(o,d,[y])}case\"shuffle\":{let y=f[0],d=f[1],h=f[2];if(!W(o.getInstruction(d).valueType)||h!==void 0&&o.getInstruction(h).valueType!==T)throw ee(`Unexpected args for \"${t}\"`);return h!==void 0&&(y=o.ExtendSeed(\"us\",[y,h])),o.SyntheticNativeFunction(\"shuffle\",[y,d])}case\"sort\":return g([{match:[le],noBroadcast:!0,build:()=>PE(e,f[0],f[0])},{match:[{meta:\"union\",types:Qi},le],noBroadcast:!0,build:()=>PE(e,f[0],f[1])}]);case\"join\":{let y=[],d=!0;for(let A of f){let L=o.getInstruction(A);ht(L)||(d=!1);let q=L.valueType;if(q!==Xe)if(W(q))y.push({isList:!0,index:A,elementType:ze(q)});else if(ei(q))y.push({isList:!1,index:A,elementType:q});else throw Vi(r,Ma(o,n))}if(y.length===0)return o.ConstantOfType(Xe,[]);for(let A of y)if(A.elementType!==y[0].elementType)throw Vi(r,Ma(o,n));if(d){let A=[];for(let L of y){let q=o.getInstruction(yn(o,L.index));y1(q),L.isList?A.push(...q.value):A.push(q.value)}return o.ConstantOfType(pn(y[0].elementType),A)}let h=o.Constant(0),b=o.Constant(1),x={};for(let A of y)A.isList&&x[A.index]===void 0&&(x[A.index]=Nr(o,A.index));let P=o.SyntheticNativeFunction(\"total\",y.map(A=>A.isList?x[A.index]:b)),E=o.BeginBroadcast([P]),M=h,I=[],D=[];for(let A of y){let L=A.isList?o.ListAccess([A.index,o.Subtract([E,M])]):A.index;if(D.push(L),A!==y[y.length-1]){let q=A.isList?x[A.index]:b;M=o.Add([M,q]),I.push(o.LessEqual([E,M]))}}let O=D[D.length-1];for(let A=D.length-2;A>=0;A--)O=o.Piecewise([I[A],D[A],O]);let N=o.EndBroadcast([E,O]);return o.BroadcastResult(pn(y[0].elementType),[N])}case\"unique\":{let y=f[0],d=o.getInstruction(y);if(!W(d.valueType)||d.valueType===Lr)throw ee(`Unexpected types for ${t}`);return o.SyntheticNativeFunction(\"elementsAt\",[y,o.SyntheticNativeFunction(\"uniquePerm\",[y])])}case\"polygon\":return g([{match:[],build:()=>{let y=o.ConstantOfType(xt,[]);return o.SyntheticNativeFunction(\"polygon\",[y])}},{match:[T,T],noBroadcast:!0,build:()=>{throw qp()}},{match:[T,T],build:()=>{let y=o.OrderedPair(f);return o.SyntheticNativeFunction(\"polygon\",[y])}},{match:{type:\"variadic\",initial:[],rest:C},build:()=>o.SyntheticNativeFunction(\"polygon\",f)}]);case\"directedangle\":return HR(e,f,r);case\"angle\":return o.SyntheticNativeFunction(\"undirectedAngleMarker\",[HR(e,f,r)]);case\"angles\":return o.SyntheticNativeFunction(\"polygonInteriorUndirectedAngles\",[f[0],Ie(e,new v.Identifier(\"trigAngleMultiplier\"))]);case\"directedangles\":return o.SyntheticNativeFunction(\"polygonInteriorDirectedAngles\",[f[0],Ie(e,new v.Identifier(\"trigAngleMultiplier\"))]);case\"coterminal\":{if(We(o,f[0],Ae))return o.SyntheticNativeFunction(\"directedCoterminalAngle\",f);if(We(o,f[0],Ge))return o.SyntheticNativeFunction(\"undirectedCoterminalAngle\",f);throw ee(`Unexpected types for ${t}`)}case\"histogram\":case\"dotplot\":case\"boxplot\":case\"ttest\":case\"ittest\":case\"stats\":case\"det\":case\"inv\":case\"transpose\":case\"rref\":case\"trace\":case\"points\":case\"lines\":case\"circles\":case\"polygons\":case\"rays\":case\"arcs\":case\"vectors\":throw Ln(r);default:{let y=t;throw new Error(`Programming Error: unexpected compiler function ${y}`)}}}function $R(e,t){return hu(e,t,\"glider\",[{match:[Se,T],build:()=>e.SyntheticNativeFunction(\"segmentGlider\",t)},{match:[be,T],build:()=>e.SyntheticNativeFunction(\"lineGlider\",t)},{match:[_e,T],build:()=>e.SyntheticNativeFunction(\"rayGlider\",t)},{match:[he,T],build:()=>e.SyntheticNativeFunction(\"circleGlider\",t)},{match:[fe,T],build:()=>e.SyntheticNativeFunction(\"arcGlider\",t)},{match:[Be,T],build:()=>e.SyntheticNativeFunction(\"polygonGlider\",t)}])}function PE(e,t,r){let{chunk:n}=e;if(kr(n,r)===0)return r;let s=n.SyntheticNativeFunction(\"min\",[Nr(n,t),Nr(n,r)]);return r=n.ListAccess([r,hg(e,n.List([n.Constant(1)]),n.List([s]),{stepMustBePositive:!0})]),n.SyntheticNativeFunction(\"elementsAt\",[t,n.SyntheticNativeFunction(\"sortPerm\",[r])])}function zR(e,t,r){let n=t[0],i=e.getInstruction(n);if(!ce(i.valueType,Dt))throw ee(`Unexpected args for \"${r}\"`);let s=t.slice(1);for(let o of s)if(!ce(e.getInstruction(o).valueType,T))throw ee(`Unexpected args for \"${r}\"`);if(W(i.valueType)){let o=[],a=1/0;for(let c of t){let l=yn(e,c);o.push(l);let p=e.getInstruction(l);if(W(p.valueType)){let f=kr(e,l);if(f===void 0)throw sf(oi(e,l));a=Math.min(a,f)}}let u=[];for(let c=0;c<a;c++){let l=Ff(e,o[0],c),p=e.getInstruction(l);if(p.type!==42)throw ee(`Unexpected opcode for distribution arg: ${p.type}`);let f=[];for(let m of o.slice(1))W(e.getInstruction(m).valueType)?f.push(Ff(e,m,c)):f.push(m);u.push(ta[p.symbol][r](e,l,f))}return e.List(u)}else{if(i.type!==42)throw ee(`Unexpected opcode for distribution arg: ${i.type}`);return ta[i.symbol][r](e,n,s)}}function kR(e,t){return t.length!==0&&e.getInstruction(t[0]).valueType!==Xe&&ce(e.getInstruction(t[0]).valueType,Dt)}function $B(e,t){let{chunk:r}=e;qn(t.args);let n=La(e,t,t.args),i=!1,s=!1;for(let o=0;o<n.length;o++){let u=r.getInstruction(n[o]).valueType;i=i||u===Ke,s=s||u!==Ke}if(i&&s)throw ee(\"Unexpected mix of actions and non-actions\");if(i)return YR(e,n);if(n.length===2)return r.OrderedPair(n);if(n.length==3)return r.OrderedTriple(n);throw ee(`Unexpected tuple dimensions: ${n.length}`)}function YB(e,t){let{chunk:r}=e;qn(t.args);let n=La(e,t,t.args);if(n.length<1)throw ee(\"Empty bare sequence\");let i=r.getInstruction(n[0]).valueType;if(i===T)throw ee(\"Ambiguous bare sequence\");return i===Ke?YR(e,n):r.List(n)}function YR(e,t){let{chunk:r}=e,n=[],i=[];for(let o of t){let a=r.getInstruction(o);switch(a.type){case 49:{Array.prototype.push.apply(n,a.symbols),Array.prototype.push.apply(i,a.args);break}case 1:{let c=a.value.updateRules;for(let l in c)n.push(l),i.push(r.ConstantOfType(c[l].valueType,c[l].value));break}default:{var s=oi(r,o);throw s.length>0?Fb(s):ee(`Unexpected opcode for action: ${a.type}`)}}}return r.Action(n,i)}function XR(e,t){var r=e.frame[t];return r===Bt?rm(t):e.policy.assignmentForbidden(t)?wb(t):r&&r.type===\"FunctionDefinition\"?tm(t):Lb(t).allowExport()}function XB(e,t){switch(e.getInstruction(t).valueType){case Se:case he:case fe:return[e.Constant(0),e.Constant(1)];case be:return[e.Constant(-1/0),e.Constant(1/0)];case _e:return[e.Constant(0),e.Constant(1/0)];case Be:return[e.Constant(0),e.SyntheticNativeFunction(\"count\",[e.SyntheticNativeFunction(\"vertices\",[t])])];default:return}}function ZB(e,t){let{policy:r,frame:n,chunk:i,scope:s,selection:o}=e;if(!(t instanceof ha))throw new Error(\"Programming error: expected a ListComprehension node but got \"+t.type);let a=t._body,u=[],c=[],l=i.Constant(1),p=Object.create(n);qn(t._inputLists);for(let{_symbol:E}of t._inputLists)p[E]=VP(E);for(let E of t.parameters)p[E.identifier._symbol]=BP(E.identifier._symbol);let f=Gi(s),m=ci(r,p,i,f,e.substitutionContext,e.recursiveFunctionContext,o);for(let E=t._inputLists.length-1;E>=0;E--){let M=t._inputLists[E],I=M._symbol,D=Ie(m,M.args[1]);wR(i,o,M);let O=i.getInstruction(D);if(!W(O.valueType)){let A=XB(i,D);if(A){u.push({symbol:I,object:D,gliderBounds:A});continue}let L;if(ei(O.valueType)){let q=M.args[1].getInputSpan();q&&(L=Sr(q))}throw wP(I,ne(O.valueType),L)}let N=Nr(i,D);c.push({symbol:I,assignedList:D,lengthIndex:N}),l=i.Multiply([l,N])}let g=Object.create(n),y=Gi(s),d=[],h;if(c.length>0){let E=i.Constant(1);h=i.BeginBroadcast([l],{inputListSymbols:c.map(I=>I.symbol)}),Kr(y,t._index._symbol,h);let M=E;for(let I=c.length-1;I>=0;I--){let{symbol:D,assignedList:O,lengthIndex:N}=c[I],A;if(c.length===1)A=h;else{let L=i.SyntheticNativeFunction(\"floor\",[i.Divide([i.Subtract([h,E]),M])]);A=i.Add([i.SyntheticNativeFunction(\"mod\",[L,N]),E]),I>0&&(M=i.Multiply([M,N]))}Kr(y,D,i.ListAccess([O,A])),d.push(D)}}let b;if(t.parameters.length>0||u.length>0){let E=[],M=[];for(let I of t.parameters)E.push(I.identifier._symbol),M.push(Ie(m,I.bounds[0]),Ie(m,I.bounds[1]));for(let I of u)E.push(I.symbol),M.push(I.gliderBounds[0],I.gliderBounds[1]);b=i.BeginMap({parameterSymbols:E},M);for(let I=0;I<t.parameters.length+u.length;I++)i.BlockVar(T,[b]);for(let I=0;I<t.parameters.length;I++){let D=t.parameters[I].identifier._symbol,[O,N]=t.parameters[I].open,A=M[2*I],L=M[2*I+1],q=b+I+1,$=i.Piecewise([i.And([O?i.Greater([q,A]):i.GreaterEqual([q,A]),N?i.Less([q,L]):i.LessEqual([q,L])]),q,i.NanOfType(T)]);g[D]=Bt,Kr(y,D,$),d.push(D)}for(let I=0;I<u.length;I++){let D=u[I].symbol,O=b+t.parameters.length+I+1;g[D]=Bt,Kr(y,D,$R(i,[u[I].object,O])),d.push(D)}}for(let E of c)g[E.symbol]=Bt;let P=Ie(ci(r,g,i,y,e.substitutionContext.for(n,d),e.recursiveFunctionContext,o),a);if(b!==void 0){let E=i.EndMap([b,P]),M=i.getInstruction(P).valueType;if(pa(M))throw XP();if(!Oh(M))throw $P(M);let I=r.is3dPolicy()?2:1;if(t.parameters.length+u.length>I)throw YP(M,t.parameters.length);let D=Rh(M,t.parameters.length+u.length);P=i.BlockVar(D,[E])}if(h!==void 0){let E=i.getInstruction(P);if(!ei(E.valueType))throw Za([ne(E.valueType)]);let M=i.EndBroadcast([h,P]);P=i.BroadcastResult(pn(E.valueType),[M])}else t.shouldCoerceToList&&(P=i.List([P]));return P}function hg(e,t,r,n){let{stepMustBePositive:i}=n,{chunk:s}=e;t=Iu(s,t),r=Iu(s,r);let o=s.getInstruction(t),a=s.getInstruction(r),u=xo(s,t,\"Programming error: expected range start list to have constant length.\"),c=xo(s,r,\"Programming error: expected range start list to have constant length.\");if(o.valueType!==le||a.valueType!==le)throw Jp();let l=s.Constant(1),p=s.Constant(0),f=s.ListAccess([t,l]),m=s.ListAccess([t,s.Constant(2)]),g=s.ListAccess([r,s.Constant(c)]),y=s.Subtract([g,f]),d=u>1?s.Subtract([m,f]):s.Piecewise([s.GreaterEqual([y,p]),l,s.Constant(-1)]),h=s.Add([l,s.SyntheticNativeFunction(\"round\",[s.Divide([y,d])])]),b=s.SyntheticNativeFunction(\"validateRangeLength\",[t,r,d,h]);i&&(b=s.Piecewise([s.GreaterEqual([d,p]),b,p]));let x=s.BeginBroadcast([b]),P=s.Add([f,s.Multiply([d,s.Subtract([x,l])])]),E=s.EndBroadcast([x,P]);return s.addComments({[f]:\"start\",[m]:\"second\",[g]:\"last\",[h]:\"proposedLength\",[d]:\"step\",[P]:\"body\"}),s.BroadcastResult(pn(s.getInstruction(P).valueType),[E])}function bg(e,t){return We(e,t,Se)?e.SyntheticNativeFunction(\"lineFromSegment\",[t]):We(e,t,Me)?e.SyntheticNativeFunction(\"lineFromSegment\",[UB(e,t)]):We(e,t,_e)?e.SyntheticNativeFunction(\"lineFromRay\",[t]):t}function WB(e,t){if(We(e,t,fe)){let{center:r,radius:n}=ZR(e,t);return e.SyntheticNativeFunction(\"circle\",[r,n])}return t}function ZR(e,t){let r=e.SyntheticNativeFunction(\"arcCenter\",[t]),n=e.SyntheticNativeFunction(\"arcGlider\",[t,e.Constant(0)]),i=e.SyntheticNativeFunction(\"distance\",[r,n]);return{center:r,radius:i,startPoint:n}}function HR(e,t,r){let{chunk:n}=e;if(t.length===3&&We(n,t[0],C)&&We(n,t[1],C)&&We(n,t[2],C)){let i=t[0],s=t[1],o=t[2],a=n.Subtract([i,s]),u=n.Subtract([o,s]),c=n.OrderedPairAccess(1,[a]),l=n.OrderedPairAccess(2,[a]),p=n.OrderedPairAccess(1,[u]),f=n.OrderedPairAccess(2,[u]),m=n.SyntheticNativeFunction(\"arctan\",[l,c]),g=n.Subtract([n.Multiply([c,f]),n.Multiply([l,p])]),y=n.Add([n.Multiply([c,p]),n.Multiply([l,f])]),d=n.SyntheticNativeFunction(\"arctan\",[g,y]),h=n.SyntheticNativeFunction(\"abs\",[d]),b=n.Constant(Math.PI),x=n.Constant(Math.PI*2);d=n.Piecewise([n.Equal([h,b]),b,n.Piecewise([n.Less([h,b]),d,n.Multiply([n.Multiply([n.SyntheticNativeFunction(\"sign\",[d]),n.Constant(-1)]),n.Subtract([x,h])])])]);let P=n.SyntheticNativeFunction(\"directedAngleMarker\",[s,m,d,Ie(e,new v.Identifier(\"trigAngleMultiplier\"))]),E=n.Constant(0),M=n.And([n.Equal([g,E]),n.Equal([y,E])]);return n.Piecewise([M,n.NanOfType(Ae),P])}else throw ee(`Unexpected types for ${r}`)}function bR(e,t){return e.Divide([e.SyntheticNativeFunction(\"directedAngleMarkerRawDelta\",[t]),e.SyntheticNativeFunction(\"directedAngleMarkerMultiplier\",[t])])}function xR(e,t){return e.SyntheticNativeFunction(\"abs\",[e.Divide([e.SyntheticNativeFunction(\"undirectedAngleMarkerRawDelta\",[t]),e.SyntheticNativeFunction(\"undirectedAngleMarkerMultiplier\",[t])])])}function jB(e,t,r){let{chunk:n}=e,i=r.slice(1),s=Rp(t);if(!s)throw new Error(`Unexpected transformation type: ${t}`);let o=s.map(c=>{let l=0;for(let p=1;p<r.length;p++){let f=n.getInstruction(r[p]).valueType,m=wy(c,p);m&&MI(f,m)&&l++}return{signature:c,matchedArgsCount:l,signatureArgsCount:Array.isArray(c)?c.length-1:c.initial.length+1,providedArgsCount:r.length-1}}).sort((c,l)=>l.matchedArgsCount!==c.matchedArgsCount?l.matchedArgsCount-c.matchedArgsCount:c.signatureArgsCount-l.signatureArgsCount),a;switch(t){case\"translate\":{a=[{match:[Me],build:()=>n.SyntheticNativeFunction(\"translation\",[n.SyntheticNativeFunction(\"vectorDisplacementAsPoint\",i)])},{match:[C,C],build:()=>n.SyntheticNativeFunction(\"translation\",[n.Subtract([i[1],i[0]])])}];break}case\"reflect\":{a=[{match:[{meta:\"union\",types:Dd}],build:()=>{let c=bg(n,i[0]);return n.SyntheticNativeFunction(\"reflection\",[c])}}];break}case\"rotate\":{a=[{match:[C,T],build:()=>{let c=Ie(e,new v.Identifier(\"trigAngleMultiplier\"));return n.SyntheticNativeFunction(\"rotation\",[i[0],n.Multiply([i[1],c])])}}];break}case\"dilate\":{a=[{match:[C,T],build:()=>n.SyntheticNativeFunction(\"dilation\",i)}];break}default:{let c=t;throw new Error(`Programming error: exhaustive check failed: ${c}`)}}let u=hu(n,i,()=>{throw pb(t,Ma(n,i),o[0].signature)},a);return xg(n,[u,r[0]],t,!0)}function JB(e,t){let{match:r}=e;return{...e,match:Array.isArray(r)?[t,...r]:{...r,initial:[t,...r.initial]}}}function QB(e){return e.map(([t,r])=>({match:[t],build:(n,i)=>n.SyntheticNativeFunction(r,i)}))}function xg(e,t,r,n){let s=QB([[Ue,\"compose\"],[C,\"transformPoint\"],[Se,\"transformSegment\"],[be,\"transformLine\"],[_e,\"transformRay\"],[Me,\"transformVector\"],[he,\"transformCircle\"],[fe,\"transformArc\"],[Be,\"transformPolygon\"],[Ge,\"transformAngleMarker\"],[Ae,\"transformDirectedAngleMarker\"]]).map(a=>JB(a,Ue));function o(){throw n?fb(r,Dc(e,t.slice(1))):Vi(r,Dc(e,t))}return hu(e,t,o,s)}function bE(e,t,r){let n=bg(e,t[0]),i=bg(e,t[1]),s=[n,i,e.ConstantOfType(T,r)];if(We(e,n,he)){if(We(e,i,he))return e.SyntheticNativeFunction(\"circleCircleIntersection\",s);if(We(e,i,fe))return e.SyntheticNativeFunction(\"circleArcIntersection\",s);if(We(e,i,be))return e.SyntheticNativeFunction(\"circleLineIntersection\",s)}if(We(e,n,fe)){if(We(e,i,he))return e.SyntheticNativeFunction(\"arcCircleIntersection\",s);if(We(e,i,fe))return e.SyntheticNativeFunction(\"arcArcIntersection\",s);if(We(e,i,be))return e.SyntheticNativeFunction(\"arcLineIntersection\",s)}if(We(e,n,be)){if(We(e,i,he))return e.SyntheticNativeFunction(\"lineCircleIntersection\",s);if(We(e,i,fe))return e.SyntheticNativeFunction(\"lineArcIntersection\",s);if(We(e,i,be))return e.SyntheticNativeFunction(\"lineLineIntersection\",s)}throw ee(\"Invalid intersection types\")}function KB(e,[t,r],[n,i]){let{chunk:s,frame:o}=e,a=s.getInstruction(n).valueType,u=s.getInstruction(i).valueType,c=f=>{let m=o[f];return m&&m!==Bt?m:P1(e.scope,f)},l=pg(t)?c(t._symbol):t,p=pg(r)?c(r._symbol):r;if(!(!l||!p))return LR({getGeometryTree:f=>_y(f).tree,lookup:c,isPointOrListOfPoints:f=>{if(f.isFunction)return!1;let m=Ie(e,f);return ce(s.getInstruction(m).valueType,C)},resolvesTo:(f,m)=>o[f]===m},l,a,p,u)}function eG(e,t){let{policy:r,frame:n,chunk:i,scope:s,substitutionContext:o,recursiveFunctionContext:a,selection:u}=e,c=t._body,l=Gi(s),p=Object.create(n),f=[];for(let g=0;g<t._assignments.length;g++){let y=t._assignments[g]._lhs,d;if(y instanceof Fe)d=y._symbol;else throw of();let h=t._assignments[g].args[1],b=n[d];if(b){if(b!==Bt&&b.isError)throw b;if(b!==Bt&&b.type===\"FunctionDefinition\")throw ml(d);if(r.assignmentForbidden(d))throw dl(d)}let x=Ie(e,h);Kr(l,d,x,h),p[d]=Bt,f.push(d)}return Ie(ci(r,p,i,l,o.with(n,f),a,u),c)}var UR={points:xt,lines:Vr,segments:xr,polygons:Or,circles:wr,arcs:Fr,angles:mr,directedangles:yr,rays:Br,vectors:Gr};function tG(e,t){let{chunk:r,frame:n}=e,i=n.construction;if(i.isError)throw i;if(i.type!==\"Construction\")throw ee(`Expected construction node but found ${i.type}}`);if(!pg(t))throw ee(`Expected identifier but found ${t.type}`);let s=t._symbol;if(!(s in UR))throw Ln(\"construction\");let o=UR[s];if(i.args.length===0)return r.ConstantOfType(o,[]);let a=ze(o),u=[];for(let c of i.args)try{let l=Ie(e,c);r.getInstruction(l).valueType===a&&u.push(l)}catch(l){if(l instanceof v.Base)continue;throw l}return r.List(u)}function WR(e,t,r){return r.loopStructure?iG(e,t,r):rG(e,t,r)}function Jf(e){let t=e.args;if(e instanceof Bi)return!1;if(e instanceof dn){let s=[Jf(e.args[0])||new jt(!0)],o=Jf(e.args[1]),a=Jf(e.args[2]);return o&&s.push(o),a&&s.push(a),s.length===1?!1:(s.length===2&&s.push(s[1]),new dn(s))}let r=[],n=!1;for(let i of t){let s=Jf(i);if(s===!1){n=!0;continue}r.push(s)}return n?!1:e.copyWithArgs(r)}function rG(e,t,r){let{chunk:n,frame:i,scope:s}=e,o={},a=Object.keys(r.definitions);for(let x of a){let P=r.definitions[x];if(P instanceof R)throw P;o[x]=P}let u=t._argSymbols.map(x=>Ie(e,new Fe(x))),c={},l={},p=[];for(let x of a)for(let P of r.baseCases[x]){let E=P.getRef();if(!P.specifiedArg.valid||!E)continue;let M=Ie(e,new Fe(E));if(p.push({compiled:M,node:P}),l[x]===void 0)l[x]=P.specifiedArg.argIndex;else if(l[x]!==P.specifiedArg.argIndex)throw Jr(\"All base cases for a recursive function must specify the same parameter.\");let I=c[x];if(I===void 0)c[x]=n.getInstruction(M).valueType;else if(I!==n.getInstruction(M).valueType)throw Jr(\"Base cases must all have the same return type.\")}let f=new gg(o,c,p);jR(e,f,t,u);let m={},g={},y={},d=Gi(s),h=Object.create(i);for(let x of a){let P=f.returnTypes[x];if(P===void 0)throw Jr(`Could not infer the return type for recursive function ${x}.`);let E=f.argTypes[x];if(E===void 0)throw Jr(`Could not infer the argument types for recursive function ${x}.`);g[x]={parameterSymbols:o[x]._argSymbols,argTypes:E},m[x]=P,y[x]=n.FunctionHeader(x,P,g[x]),Kr(d,x,y[x]),h[x]=Bt}let b=[];for(let x of a)b.push(y[x]);for(let x of b)n.getInstruction(x).recursionGroup=b;for(let x of a){let P=Gi(d),E=Object.create(h),M=o[x],I=y[x],D=n.BeginFunction([I]);for(let A=0;A<M._argSymbols.length;A++){let L=M._argSymbols[A],q=n.BlockVar(g[x].argTypes[A],[D]);E[L]=Bt,Kr(P,L,q)}let O=ci(e.policy,E,n,P,e.substitutionContext,{type:\"compile-general\"},e.selection),N=JR(O,M,p,Ie(O,M._expression));if(n.getInstruction(N).valueType!==m[x])throw Jr(`Expected function to return ${$t(m[x])} but found ${$t(n.getInstruction(N).valueType)}. This is probably broadcast-related type conflict.`);N=yn(n,N),n.EndFunction([D,N])}return n.FunctionCall(t._symbol,!1,[y[t._symbol],...u])}function jR(e,t,r,n){let{chunk:i,scope:s,frame:o}=e,a=t.returnTypes[r._symbol],u=t.argTypes[r._symbol];if(a!==void 0&&u!==void 0)return{returnType:a,argTypes:u};let c=n.map(M=>i.getInstruction(M).valueType),l=`${r._symbol}:${c.join(\",\")}:${Object.keys(t.returnTypes).join(\",\")}`;if(t.stack.includes(l))throw Ap();t.stack.push(l);let p=i.instructionsLength(),f=i.getReturnIndex(),m,g=Jf(r._expression),y=t.compiledBaseCases.filter(M=>M.node._symbol===r._symbol);if(g||y.length>0){let M=Gi(s),I=Object.create(o),D=ci(e.policy,I,i,M,e.substitutionContext,t,e.selection),O=[];for(let $=0;$<r._argSymbols.length;$++){let X=r._argSymbols[$],G=i.SymbolicVar(c[$]);O.push(G),I[X]=Bt,Kr(M,X,G)}let N=JR(D,r,y,g?Ie(D,g):y[0].compiled),{someArgBroadcasts:A,inferredArgTypes:L}=nG(i,O,f,N);if(c=L,m=i.getInstruction(N).valueType,A){if(!W(m))throw Jr(`TODO: expected a list type but found ${$t(m)}`);m=ze(m)}let q=t.returnTypes[r._symbol];if(q!==void 0&&m!==q)throw Jr(\"Base cases must all have the same return type.\").allowExport();t.argTypes[r._symbol]=L,t.returnTypes[r._symbol]=m,i.truncate(p)}let d=Gi(s),h=Object.create(o),b=ci(e.policy,h,i,d,e.substitutionContext,t,e.selection);for(let M=0;M<r._argSymbols.length;M++){let I=r._argSymbols[M],D=i.SymbolicVar(c[M]);h[I]=Bt,Kr(d,I,D)}let x=Ie(b,r._expression);t.stack.pop();let P=i.getInstruction(x).valueType,E=m===void 0?P:la(m,P);if(E===void 0)throw ee(`Mismatched return types: ${m&&$t(m)} vs ${$t(P)}`);return t.returnTypes[r._symbol]=E,i.truncate(p),{returnType:E,argTypes:c}}function nG(e,t,r,n){let i=[],u=[];for(let p=0;p<n-r;p++)u.push(0);if(e.getInstruction(n).type===48){u.push(1);for(let p=n;p>=0;p--){let f=u[p-r];if(f===0)continue;let m=e.getInstruction(p);if(!ve(m)){if(m.type===24?i.push(p):m.type===23&&i.pop(),(m.type===48||m.type===24)&&(u[m.args[0]-r]|=f),m.type===39||m.type===41||m.type===40)for(let g of i){let d=e.getInstruction(g).args[0];if(m.args[1]===d){u[m.args[0]-r]|=f;break}}if(i.length>0){let g=i[i.length-1],d=e.getInstruction(g).args[0];for(let h of m.args)h>=d&&(u[h-r]|=f);m.type===33&&m.args[0]>=d&&(u[m.args[0]-r]|=2)}}}}let c=[],l=!1;for(let p=0;p<t.length;p++){let f=t[p],m=e.getInstruction(f).valueType;if(u[f-r]&2){if(!W(m))throw ee(`Expected list type but found ${$t(m)}`);l=!0,c.push(ze(m))}else c.push(m)}return{inferredArgTypes:c,someArgBroadcasts:l}}function JR(e,t,r,n){let{chunk:i}=e;for(let s of r){let{compiled:o,node:a}=s;if(s.node._symbol!==t._symbol)continue;let u=a.specifiedArg;if(!u.valid)throw ee(\"Expected valid base case\");let c=t._argSymbols[u.argIndex],l=Ie(e,new Fe(c)),p=i.Equal([l,i.Constant(u.argValue)]);n=i.Piecewise([p,o,n])}return n}function iG(e,t,r){var G,J;let{chunk:n,frame:i,scope:s}=e,{loopStructure:o}=r;if(o===void 0||o.recursiveParameterIndex===void 0)throw Jr(\"Cannot convert this recursive function to iteration.\");let a=t._argSymbols[o.recursiveParameterIndex],u={};for(let w in r.definitions){let Z=r.definitions[w];if(Z instanceof R)throw Z;u[w]=Z}let c={},l={};for(let w in r.baseCases){c[w]={},l[w]=vt;for(let Z of r.baseCases[w]){let te=Z.getRef();if(!te||!Z.specifiedArg.valid)continue;let z=Z.specifiedArg.argValue,oe=Ie(e,new Fe(te));c[w][z]={input:z,value:oe};let re=n.getInstruction(oe).valueType,me=l[w],ye=me===vt?re:la(me,re);if(ye===void 0)throw Jr(`Expected base case to be ${ne(l[w])} but found ${ne(re)}`).allowExport();l[w]=ye,n.addComments({[oe]:`${w}(${u[w]._argSymbols.map(De=>De===a?z:De).join(\",\")})`})}}for(let w of o.order){let Z=new gg(r.definitions,l,[]),te=ci(e.policy,i,n,s,e.substitutionContext,Z,e.selection),z=l[w],oe=Ie(te,u[w]._expression),re=n.getInstruction(oe).valueType,me=z===vt?re:la(z,re);if(me===void 0)throw Jr(`Expected recursive type to be ${ne(z)} (based on base cases) but found ${ne(re)}`).allowExport();l[w]=me}for(let w in r.baseCases){let Z=l[w];for(let te in c[w]){let z=c[w][te];z.value=uE(n,Z,z.value)}}let p=Gi(s),f=Object.create(i),m=Ie(e,new Fe(a)),g,y={};if(W(n.getInstruction(m).valueType)){let w=n.SyntheticNativeFunction(\"sortPerm\",[m]),Z=n.SyntheticNativeFunction(\"elementsAt\",[m,w]),te=n.SyntheticNativeFunction(\"uniquePerm\",[Z]),z=Nr(n,te),oe=n.Subtract([yg(e,\"join\",\"join\",[n.SyntheticNativeFunction(\"elementsAt\",[te,hg(e,n.List([n.Constant(1)]),n.List([n.Subtract([z,n.Constant(1)])]),{stepMustBePositive:!0})]),Nr(n,Z)],[]),te]);g={sorted:Z,permutation:w,uniqueSorted:n.SyntheticNativeFunction(\"elementsAt\",[Z,te]),uniqueSortedFrequency:oe};for(let re in l)if(ei(l[re]))y[re]=pn(l[re]);else throw Za([ne(l[re])])}let d=[];for(let w in o.previousValuesNeeded){let Z=o.previousValuesNeeded[w];if(!Z)continue;let te=[];for(let z=Z.max;z>=1;z--){let oe=o.start-z;if(!c[w][oe])throw Jr(`Expected base case for ${w} at ${oe} but found none`);d.push({fn:w,offset:z,valueType:l[w],initialValue:c[w][oe].value}),te.push(c[w][oe].value)}if(g&&w===t._symbol){let z=n.List(te),oe=n.Constant(o.start-1),re=n.SyntheticNativeFunction(\"select\",[g.uniqueSorted,n.LessEqual([g.uniqueSorted,oe])]),me=n.Subtract([re,n.Constant(o.start-te.length)]),ye=n.SyntheticNativeFunction(\"elementsAt\",[z,me]);n.addComments({[z]:\"list of base cases, in order\",[oe]:\"largest base case n value\",[re]:\"L.sort[L.sort <= largest base case]\",[me]:`inst ${re} - smallest base case n value`,[ye]:\"f(L.sort[L.sort <= largest base case])\"}),d.push({fn:w,offset:1,valueType:y[w],initialValue:ye,isList:!0})}}if(!d.some(w=>w.fn===t._symbol&&w.offset===1)){let w=l[t._symbol];d.push({fn:t._symbol,offset:1,valueType:w,initialValue:n.NanOfType(fo(w)?w:T)}),g&&d.push({fn:t._symbol,offset:1,valueType:y[t._symbol],initialValue:n.List([]),isList:!0})}let h=(J=(G=o.previousValuesNeeded[t._symbol])==null?void 0:G.max)!=null?J:0,b=n.Constant(o.start-h),x=n.Subtract([m,b]),P=n.SyntheticNativeFunction(\"floor\",[x]),E=n.And([n.GreaterEqual([x,n.Constant(0)]),n.Equal([x,P])]),M=n.Constant(o.start),I;if(g){let w=n.SyntheticNativeFunction(\"select\",[m,E]),Z=n.Equal([Nr(n,w),Nr(n,m)]);I=n.Piecewise([n.Equal([Nr(n,m),n.Constant(0)]),n.Constant(o.start-1),n.Piecewise([Z,n.SyntheticNativeFunction(\"max\",[m]),n.Constant(1/0)])])}else I=n.Piecewise([E,m,n.Constant(1/0)]);let D=n.BeginLoop({type:\"recursive-function\",indexSymbol:a},[M,I,...d.map(w=>w.initialValue)]);Kr(p,a,D),f[a]=Bt;let O={},N;for(let w of d){let Z=n.BlockVar(w.valueType,[D]);if(w.isList)N=Z;else{let oe=TE(w.fn,w.offset);Kr(p,oe,Z),f[oe]=Bt,O[w.fn]||(O[w.fn]=[]),O[w.fn][w.offset]=Z}let te=u[w.fn],z=`${w.fn}(${te._argSymbols.map(oe=>oe===a?w.isList?`f([L.sort[L.sort < ${oe}]])`:`${oe}-${w.offset}`:oe).join(\",\")})`;n.addComments({[Z]:z})}let A={},L={};for(let w of o.order){let Z=Ie(ci(e.policy,f,n,p,e.substitutionContext,{type:\"compile-iterative\",recursionInfo:r},e.selection),u[w]._expression);Z=uE(n,l[w],Z),A[w]=Z;let te=TE(w,0);if(Kr(p,te,Z),f[te]=Bt,n.addComments({[Z]:`${w}(${u[w]._argSymbols.join(\",\")})`}),N!==void 0&&g){let z=n.Add([Nr(n,N),n.Constant(1)]),oe=n.ListAccess([g.uniqueSorted,z]),re=n.Piecewise([n.Equal([oe,D]),yg(e,\"join\",\"join\",[N,Z],[]),N]);L[w]=re,n.addComments({[re]:`[...previous outputs, ${w}(${u[w]._argSymbols.join(\",\")}]`})}}let q=d.map(w=>{let Z;return w.offset===1?Z=w.isList?L[w.fn]:A[w.fn]:Z=O[w.fn][w.offset-1],yn(n,Z)}),$=n.EndLoop([D,...q]),X={};for(let w of d){if(w.offset===1){if(w.isList){X[w.fn]=n.BlockVar(y[w.fn],[$]);continue}else if(!g){X[w.fn]=n.BlockVar(l[w.fn],[$]);continue}}n.Noop()}if(g){let w=X[t._symbol],Z=n.getInstruction(w).valueType,te=n.Constant(1),z=Nr(n,w),oe=n.BeginLoop({type:\"recursive-function\",indexSymbol:\"unexpected_i\"},[te,z,n.List([])]),re=n.BlockVar(Z,[oe]),me=n.ListAccess([w,oe]),ye=n.ListAccess([g.uniqueSortedFrequency,oe]),De=n.BeginLoop({type:\"recursive-function\",indexSymbol:\"unexpected_j\"},[n.Constant(1),ye,re]),K=n.BlockVar(Z,[De]),H=yg(e,\"join\",\"join\",[K,me],[]),xe=n.EndLoop([De,H]),ge=n.BlockVar(Z,[xe]),se=n.EndLoop([oe,ge]),ae=n.BlockVar(Z,[se]);return n.addComments({[oe]:\"Outer loop (over unique sorted results)\",[re]:\"previousSorted\",[me]:\"uniqueSortedResults[i]\",[ye]:\"frequency[i]\",[De]:`Inner loop (from Constant(1) to Inst:${ye})`,[xe]:\"End of inner loop\",[se]:\"End of outer loop\"}),PE(e,ae,g.permutation)}else{let w=X[t._symbol];for(let Z of Object.values(c[t._symbol])){let te=n.Equal([m,n.Constant(Z.input)]);w=n.Piecewise([te,Z.value,w])}return w}}function TE(e,t){return`_rec_${e}_${t}`}zt.prototype.buildIRExpression=function(e,t,r){var i;var n=ap({policy:e,frame:t,wrapInList:r&&r.wrapInList,coerceToNumber:r&&r.coerceToNumber,selection:r&&r.selection},this);return e.isGeometryEnabled()&&n.argNames.some(s=>s[0]===\"$\")?qP():(i=n.getError())!=null?i:new dr(n)};R.prototype.buildIRExpression=function(e,t,r){return this};var QR=Xc;function IE(e){for(var t=[],r=0;r<e.length;r++)t.push(ne(e[r].valueType));return t}function KR(e,t){var r=t.length,n=t[0];if(r<2)throw Fs(this._symbol);if(!QR(n.valueType,[le,Xe]))throw Fs(this._symbol);if(r>2)throw om(this._symbol,2)}v.Histogram.prototype.typeCheck=KR;v.DotPlot.prototype.typeCheck=KR;v.BoxPlot.prototype.typeCheck=function(e,t){var r=t.length,n=t[0];if(r===0)throw Fs(this._symbol);if(!QR(n.valueType,[le,Xe]))throw Fs(this._symbol);if(r>1)throw Fs(this._symbol)};v.TTest.prototype.typeCheck=function(e,t){var r=this._symbol;if(t.length===0)throw Fs(r);if(t[0].valueType===Xe)throw fl(r);if(t[0].valueType!==le)throw Fs(r);if(t.length>2)throw om(r,2);if(t[0].length<2)throw fl(r);if(t[1]&&t[1].valueType!==T)throw Vi(r,IE(t))};v.IndependentTTest.prototype.typeCheck=function(e,t){var r=this._symbol;if(t.length!==2)throw $p(r);if(!W(t[0].valueType)||!W(t[1].valueType))throw jp(r);if(t[0].valueType===Xe||t[1].valueType===Xe)throw fl(\"ittest\");if(t[0].valueType!==le||t[1].valueType!==le)throw Vi(r,IE(t));if(t[0].length<2||t[1].length<2)throw fl(\"ittest\")},v.Stats.prototype.typeCheck=function(e,t){var r=t.length,n=t[0];if(r===0)throw Fs(this._symbol);if(n.valueType===Xe)throw Vi(this._symbol,IE(t));if(n.valueType!==le)throw Fs(this._symbol);if(r>1)throw Fs(this._symbol)};var Mu=function(e,t,r){r=r||0;var n=Array(r+1).join(\"  \"),i=n+\"  \";return`[\n`+i+e.map(function(s){return s.repr(t,r+1)}).join(`,\n`+i)+`\n`+n+\"]\"},gn=function(e,t){return t=t||\"\",\"\"+t+e};v.Expression.prototype.repr=function(e,t){return gn(this.type,e)+\"(\"+Mu(this.args,e,t)+\")\"};v.IRExpression.prototype.repr=function(e,t){t=t||0;var r=Array(t+1).join(\"  \"),n=r+\"  \",i=this._chunk.print().split(`\n`);return i.pop(),gn(this.type,e)+\"(`\\n\"+n+i.join(`\n`+n)+`\n`+r+\"`)\"};v.DoubleInequality.prototype.repr=function(e,t){t=t||0;var r=Array(t+1).join(\"  \"),n=r+\"  \";return gn(this.type,e)+`([\n`+n+this.args[0].repr(e,t+1)+`,\n`+n+\"'\"+this.args[1]+`',\n`+n+this.args[2].repr(e,t+1)+`,\n`+n+\"'\"+this.args[3]+`',\n`+n+this.args[4].repr(e,t+1)+`\n`+r+\"])\"};v.ComparatorChain.prototype.repr=function(e,t){return t=t||0,gn(this.type,e)+\"([\"+this.symbols.map(r=>`'${r}'`).join(\",\")+`],\n`+Mu(this.args,e,t)+\")\"};v.Identifier.prototype.repr=function(e){return gn(this.type,e)+\"('\"+this._symbol+\"')\"};v.Constant.prototype.repr=function(e){return gn(this.type,e)+\"(\"+this.asValue()+\")\"};v.ExtendSeed.prototype.repr=function(e,t){return gn(this.type,e)+\"('\"+this.tag+\"', \"+Mu(this.args,e,t)+\")\"};v.Seed.prototype.repr=function(e){return gn(this.type,e)+\"(\"+this.asValue()+\")\"};v.FunctionCall.prototype.repr=function(e,t){return gn(this.type,e)+\"('\"+this._symbol+\"', \"+Mu(this.args,e,t)+\")\"};v.RecursiveFunctionCall.prototype.repr=v.FunctionCall.prototype.repr;v.RecursiveFunctionBaseCase.prototype.repr=function(e,t){return this.originalNode.repr(e,t)};v.Assignment.prototype.repr=function(e,t){return gn(this.type,e)+\"(\"+new v.Identifier(this._symbol).repr(e,t)+\", \"+this._expression.repr(e,t)+\")\"};v.CoordinateEquation.prototype.repr=function(e,t){return this.asEquation().repr(e,t)};v.Regression.prototype.repr=v.Equation.prototype.repr=function(e,t){return gn(this.type,e)+\"(\"+this._lhs.repr(e,t)+\", \"+this._rhs.repr(e,t)+\")\"};v.FunctionDefinition.prototype.repr=function(e,t){return gn(this.type,e)+\"(\"+new v.Identifier(this._symbol).repr(e,t)+\", \"+Mu(this._argSymbols.map(function(r){return new v.Identifier(r)}),e,t)+\", \"+this._expression.repr(e,t)+\")\"};v.Error.prototype.repr=function(e,t){return gn(this.type,e)+\"('\"+this._msg+\"')\"};v.Derivative.prototype.repr=function(e,t){return gn(this.type,e)+\"('\"+this._symbol+\"', \"+Mu(this.args,e,t)+\")\"};v.SolvedEquation.prototype.repr=function(e,t){return gn(this.type,e)+\"('\"+this._symbol+\"', \"+this._expression.repr(e,t)+\")\"};v.OptimizedRegression.prototype.repr=function(e,t){return gn(this.type,e)+\"(\"+JSON.stringify(this.parameters)+\", \"+JSON.stringify(this.residuals)+\", \"+JSON.stringify(this.statistics)+\", \"+this.model.repr(e,t+1)+\", \"+JSON.stringify({isModelValid:this.isModelValid,residualVariable:this.residualVariable,residualSuggestionId:this.residualSuggestionId,shouldSuggestLogMode:this.shouldSuggestLogMode,isLinear:this.isLinear,parameterWarning:this.parameterWarning})+\")\"};v.Table.prototype.repr=function(e,t){return gn(this.type,e)+\"(\"+Mu(this.columns,e,t)+\")\"};v.TableColumn.prototype.repr=function(e,t){return gn(this.type,e)+\"(\"+this.header.repr(e,t)+\", \"+this.length+\", \"+Mu(this.values,e,t)+\")\"};v.Image.prototype.repr=function(e,t){var r=Array(t+1).join(\"  \"),n=r+\"  \";return gn(this.type,e)+`({\n`+n+\"center: \"+this.center.repr(e,t+1)+`,\n`+n+\"radianAngle: \"+this.radianAngle.repr(e,t+1)+`,\n`+n+\"width: \"+this.width.repr(e,t+1)+`,\n`+n+\"height: \"+this.height.repr(e,t+1)+`},\n`+n+\"opacity: \"+this.opacity.repr(e,t+1)+`,\n`+n+JSON.stringify(this.moveStrategy)+`\n`+r+\"})\"};v.Ticker.prototype.repr=function(e,t){var r=Array(t+1).join(\"  \"),n=r+\"  \";return gn(this.type,e)+`({\n`+n+\"handler: \"+this.handler.repr(e,t+1)+`,\n`+n+\"minStep: \"+this.minStep.repr(e,t+1)+`\n`+r+\"})\"};v.Slider.prototype.repr=function(e,t){var r=Array(t+1).join(\"  \"),n=r+\"  \";return gn(this.type,e)+`({\n`+n+\"sliderAssignment: \"+this.sliderAssignment.repr(e,t+1)+`,\n`+n+\"sliderMin: \"+(this.sliderMin&&this.sliderMin.repr(e,t+1))+`,\n`+n+\"sliderMax: \"+(this.sliderMax&&this.sliderMax.repr(e,t+1))+`,\n`+n+\"sliderStep: \"+(this.sliderStep&&this.sliderStep.repr(e,t+1))+`},\n`+r+\")\"};var Tg=function(e,t){return e.map(function(r){return r.substitute(t)})};v.Identifier.prototype.substitute=function(e){return e[this._symbol]?e[this._symbol]:this};v.FunctionCall.prototype.substitute=function(e){var t=e[this._symbol];if(t){if(t.type===\"Identifier\")return new v.FunctionCall(t,Tg(this.args,e));if(t.type===\"Constant\")return new v.Multiply([t,this.args.length===1?this.args[0].substitute(e):new v.Constant(NaN)])}return v.Expression.prototype.substitute.call(this,e)};v.RecursiveFunctionCall.prototype.substitute=v.FunctionCall.prototype.substitute;v.Constant.prototype.substitute=function(e){return this};v.Expression.prototype.substitute=function(e){return this.copyWithArgs(Tg(this.args,e))};v.Derivative.prototype.substitute=function(e){var t=e[this._symbol];if(t){if(t.type===\"Identifier\")return new v.Derivative(t,Tg(this.args,e));throw new Error(\"Cannot substitute for a derivative variable with a non-Identifier\")}return new v.Derivative(this._symbol,Tg(this.args,e))};v.Expression.prototype.simpleFunctionExpression=function(){return this};v.Assignment.prototype.simpleFunctionExpression=function(){return this._expression};v.CoordinateEquation.prototype.simpleFunctionExpression=function(){return this.asEquation().simpleFunctionExpression()};v.FunctionDefinition.prototype.simpleFunctionExpression=function(){return this._expression};v.Equation.prototype.simpleFunctionExpression=function(){return this.asComparator().simpleFunctionExpression()};function ra(e){return e>=100}function eC(e,t){switch(e){case 106:return 200;case 107:return 201;case 108:return 202;case 103:return 214;case 130:return 215;case 112:return 209;case 113:return 210;case 110:switch(t){case\"z\":return 206;case\"theta\":return 205;case\"x\":case\"y\":case\"r\":case\"_implicit\":return 211;default:return 10}case 109:switch(t){case\"r\":return 203;case\"theta\":return 204;case\"x\":case\"y\":case\"z\":case\"_implicit\":return 213;default:return 10}case 111:switch(t){case\"theta\":return 207;case\"phi\":return 208;case\"x\":case\"y\":case\"z\":case\"rho\":case\"_implicit\":return 212;default:return 10}default:return 10}}function EE(e){switch(e){case 123:case 122:case 121:case 120:case 124:case 126:case 127:return!0;default:return!1}}var Ig={normaldist:{type:\"distribution\",symbol:\"normaldist\",params:[\"mean\",\"stdev\"],defaults:[\"0\",\"1\"],discrete:!1},tdist:{type:\"distribution\",symbol:\"tdist\",params:[\"dof\"],defaults:[void 0],discrete:!1},binomialdist:{type:\"distribution\",symbol:\"binomialdist\",params:[\"trials\",\"probsuccess\"],defaults:[void 0,\"0.5\"],discrete:!0},poissondist:{type:\"distribution\",symbol:\"poissondist\",params:[\"mean\"],defaults:[void 0],discrete:!0},uniformdist:{type:\"distribution\",symbol:\"uniformdist\",params:[\"min\",\"max\"],defaults:[\"0\",\"1\"],discrete:!1}},sG={Histogram:{type:\"visualization\",symbol:\"histogram\",params:[\"data\",\"binwidth\"],defaults:[void 0,\"1\"]},DotPlot:{type:\"visualization\",symbol:\"dotplot\",params:[\"data\",\"binwidth\"],defaults:[void 0,\"1\"]},BoxPlot:{type:\"visualization\",symbol:\"boxplot\",params:[\"data\"],defaults:[void 0]}};function tC(e){let t=Hs(e,{trailingComma:!0});return wa(t)}function wa(e){let t=e,r=sG[t.type];if(!r)switch(t.type===\"Assignment\"&&(t=t._expression),t.type){case\"FunctionCall\":{r=Ig[t._symbol];break}default:return}if(!r)return;let n={},i=r.params,s=t.args;for(let o=0;o<i.length;o++){let a=s[o];n[i[o]]=a&&a.getInputString()||\"\"}return{...r,span:t.getInputSpan(),values:n}}var aG={X_OR_Y:{points:!1,lines:!0,fill:!1},SINGLE_POINT:{points:!0,lines:!1,fill:!1},POINT_LIST:{points:!0,lines:!1,fill:!1},PARAMETRIC:{points:!1,lines:!0,fill:!1},POLAR:{points:!1,lines:!0,fill:!1},IMPLICIT:{points:!1,lines:!0,fill:!1},POLYGON:{points:!1,lines:!0,fill:!0},HISTOGRAM:{points:!1,lines:!0,fill:!0},DOTPLOT:{points:!0,lines:!1,fill:!1},BOXPLOT:{points:!1,lines:!0,fill:!1},TTEST:{points:!1,lines:!1,fill:!1},STATS:{points:!1,lines:!1,fill:!1},VECTOR2D:{points:!1,lines:!0,fill:!1},POINT3D:{points:!0,lines:!1,fill:!1},POINT3D_LIST:{points:!0,lines:!1,fill:!1},CURVE3D_xyz_t:{points:!1,lines:!0,fill:!1},SLICE:{points:!1,lines:!0,fill:!1},SLICE_r\\u03B8z_at_z:{points:!1,lines:!0,fill:!1},SLICE_zr\\u03B8_at_r:{points:!1,lines:!0,fill:!1},SLICE_zr\\u03B8_at_\\u03B8:{points:!1,lines:!0,fill:!1},SLICE_zr\\u03B8_at_xyz:{points:!1,lines:!0,fill:!1},SLICE_r\\u03B8\\u03C6_at_\\u03B8:{points:!1,lines:!0,fill:!1},SLICE_r\\u03B8\\u03C6_at_\\u03C6:{points:!1,lines:!0,fill:!1},SLICE_r\\u03B8\\u03C6_at_xyz:{points:!1,lines:!0,fill:!1},SLICE_xyz_uv:{points:!1,lines:!0,fill:!1},SEGMENT3D:{points:!1,lines:!0,fill:!1},VECTOR3D:{points:!1,lines:!0,fill:!1},SPHERE3D:{points:!1,lines:!0,fill:!1},SURFACE_xyz_uv:{points:!1,lines:!0,fill:!1},SURFACE_z_r\\u03B8:{points:!1,lines:!0,fill:!1},SURFACE_r_\\u03B8z:{points:!1,lines:!0,fill:!1},SURFACE_r_\\u03B8\\u03C6:{points:!1,lines:!0,fill:!1},SURFACE_r_\\u03B8z_AMBIGUOUS:{points:!1,lines:!0,fill:!1},SURFACE:{points:!1,lines:!0,fill:!1},TRIANGLE3D:{points:!1,lines:!0,fill:!1},SURFACE_AMBIGUOUS:{points:!1,lines:!0,fill:!1},SURFACE_CONSTANT_AMBIGUOUS:{points:!1,lines:!0,fill:!1},IMPLICIT_SURFACE:{points:!1,lines:!0,fill:!1},IMPLICIT_SURFACE_AMBIGUOUS:{points:!1,lines:!0,fill:!1}};function ME(e,t,r){var i,s,o,a,u,c;if(e===void 0)return{points:!1,lines:!1,fill:!1};let n=aG[e];switch(e){case\"SINGLE_POINT\":return{points:!0,lines:!1,fill:!1};case\"POINT_LIST\":case\"POINT3D_LIST\":case\"DOTPLOT\":return{points:(i=t.points)!=null?i:n.points,lines:(s=t.lines)!=null?s:n.lines,fill:!1};case\"POINT3D\":return{points:(o=t.points)!=null?o:n.points,lines:!1,fill:!1};case\"PARAMETRIC\":case\"POLYGON\":case\"X_OR_Y\":case\"VECTOR2D\":case\"POLAR\":case\"IMPLICIT\":case\"HISTOGRAM\":case\"BOXPLOT\":case\"TTEST\":case\"STATS\":case\"CURVE3D_xyz_t\":return{points:!1,lines:(a=t.lines)!=null?a:n.lines,fill:(u=t.fill)!=null?u:n.fill};case\"TRIANGLE3D\":case\"SPHERE3D\":case\"SURFACE\":case\"SURFACE_r_\\u03B8z\":case\"SURFACE_z_r\\u03B8\":case\"SURFACE_r_\\u03B8\\u03C6\":case\"SURFACE_xyz_uv\":case\"IMPLICIT_SURFACE\":case\"SURFACE_AMBIGUOUS\":case\"SURFACE_CONSTANT_AMBIGUOUS\":case\"SURFACE_r_\\u03B8z_AMBIGUOUS\":case\"IMPLICIT_SURFACE_AMBIGUOUS\":case\"SEGMENT3D\":case\"VECTOR3D\":case\"SLICE\":case\"SLICE_r\\u03B8z_at_z\":case\"SLICE_zr\\u03B8_at_r\":case\"SLICE_zr\\u03B8_at_\\u03B8\":case\"SLICE_zr\\u03B8_at_xyz\":case\"SLICE_r\\u03B8\\u03C6_at_\\u03B8\":case\"SLICE_r\\u03B8\\u03C6_at_\\u03C6\":case\"SLICE_r\\u03B8\\u03C6_at_xyz\":case\"SLICE_xyz_uv\":return{points:!1,lines:(c=t.lines)!=null?c:n.lines,fill:!1};default:r&&r(e);let l=e;return ME(e,t)||l}}function vE(e){if(e===void 0)return!1;switch(e){case\"SINGLE_POINT\":case\"POINT_LIST\":case\"PARAMETRIC\":case\"POLYGON\":case\"X_OR_Y\":case\"VECTOR2D\":case\"POLAR\":case\"IMPLICIT\":case\"SURFACE\":case\"SURFACE_AMBIGUOUS\":case\"SURFACE_CONSTANT_AMBIGUOUS\":case\"SURFACE_r_\\u03B8z\":case\"SURFACE_r_\\u03B8z_AMBIGUOUS\":case\"SURFACE_z_r\\u03B8\":case\"SURFACE_r_\\u03B8\\u03C6\":case\"SURFACE_xyz_uv\":case\"IMPLICIT_SURFACE\":case\"IMPLICIT_SURFACE_AMBIGUOUS\":case\"CURVE3D_xyz_t\":case\"SLICE\":case\"SLICE_r\\u03B8z_at_z\":case\"SLICE_zr\\u03B8_at_r\":case\"SLICE_zr\\u03B8_at_\\u03B8\":case\"SLICE_zr\\u03B8_at_xyz\":case\"SLICE_r\\u03B8\\u03C6_at_\\u03B8\":case\"SLICE_r\\u03B8\\u03C6_at_\\u03C6\":case\"SLICE_r\\u03B8\\u03C6_at_xyz\":case\"SLICE_xyz_uv\":case\"SEGMENT3D\":case\"VECTOR3D\":case\"SPHERE3D\":case\"POINT3D\":case\"POINT3D_LIST\":case\"TRIANGLE3D\":return!0;case\"HISTOGRAM\":case\"BOXPLOT\":case\"DOTPLOT\":case\"TTEST\":case\"STATS\":return!1;default:return e}}function rC(e){return e===\"SURFACE_r_\\u03B8\\u03C6\"||e===\"SLICE_r\\u03B8\\u03C6_at_\\u03B8\"||e===\"SLICE_r\\u03B8\\u03C6_at_\\u03C6\"||e===\"SLICE_r\\u03B8\\u03C6_at_xyz\"}function nC(e){return e===\"SURFACE_z_r\\u03B8\"||e===\"SLICE_zr\\u03B8_at_r\"||e===\"SLICE_zr\\u03B8_at_\\u03B8\"||e===\"SLICE_zr\\u03B8_at_xyz\"}function iC(e){return e===\"SURFACE_r_\\u03B8z\"||e===\"SURFACE_r_\\u03B8z_AMBIGUOUS\"||e===\"SLICE_r\\u03B8z_at_z\"}function na(e){if(typeof e==\"string\")return e;if(e===void 0)return\"\";if(isNaN(e))return\"\\\\frac{0}{0}\";if(e===1/0)return\"\\\\infty\";if(e===-1/0)return\"-\\\\infty\";let t=e+\"\";return t=t.replace(/^1e\\+?([-\\d]+)/,\"10^{$1}\"),t=t.replace(/([-\\d\\.]+)e\\+?([-\\d]+)/,\"$1\\\\cdot 10^{$2}\"),t}function uG(e){let t=e+\"\";if(/\\d+\\.?\\d*e[\\+\\-]*\\d+/i.test(t)){let n=\"0\",i=String(t).toLowerCase().split(\"e\"),s=parseFloat(i[0]),o=parseInt(i[1],10),a=Math.abs(o),u=Math.abs(s).toString().split(\".\");if(o<0)t=\"0.\"+new Array(a).join(n)+u.join(\"\");else{var r=u[1];r&&(a=a-r.length),t=u.join(\"\")+new Array(a+1).join(n)}s<0&&(t=\"-\"+t)}return t}function Wj(e,t=2){var r=uG(e),n=r.indexOf(\".\");if(n===-1)return r;for(var i,s=n+1;s<r.length;s++)if(i){if(r[s]!==i)break}else if(r[s]===\"0\"||r[s]===\"9\")i=r[s];else break;return r.substr(0,Math.max(n+5,s+t))}function Er(e,t){if(W(e)){let r=[];for(let n=0;n<t.length;n++)r.push(Er(ze(e),t[n]));return`\\\\left[${r.join(\",\")}\\\\right]`}switch(e){case T:return na(t);case C:{let[s,o]=t;return`\\\\left(${na(s)},${na(o)}\\\\right)`}case V:{let[s,o,a]=t;return`\\\\left(${na(s)},${na(o)},${na(a)}\\\\right)`}case qt:return\"\\\\operatorname{rgb}\\\\left(\"+[Er(T,t[0]),Er(T,t[1]),Er(T,t[2])].join(\",\")+\"\\\\right)\";case Be:{let s=[];for(let o of t)s.push(Er(C,o));return\"\\\\operatorname{polygon}\\\\left(\"+s.join(\",\")+\"\\\\right)\"}case Se:return\"\\\\operatorname{segment}\\\\left(\"+[Er(C,t[0]),Er(C,t[1])].join(\",\")+\"\\\\right)\";case be:return\"\\\\operatorname{line}\\\\left(\"+[Er(C,t[0]),Er(C,t[1])].join(\",\")+\"\\\\right)\";case _e:return\"\\\\operatorname{ray}\\\\left(\"+[Er(C,t[0]),Er(C,t[1])].join(\",\")+\"\\\\right)\";case Me:let r=t[0],n=t[1],i=[n[0]+r[0],n[1]+r[1]];return`\\\\operatorname{vector}\\\\left(${Er(C,n)},${Er(C,i)}\\\\right)`;case he:return\"\\\\operatorname{circle}\\\\left(\"+[Er(C,t[0]),Er(T,t[1])].join(\",\")+\"\\\\right)\";case fe:return\"\\\\operatorname{arc}\\\\left(\"+[Er(C,t[0]),Er(C,t[1]),Er(C,t[2])].join(\",\")+\"\\\\right)\";case Ge:return\"\\\\operatorname{angle}\\\\left(\"+[Er(C,t[0]),Er(T,t[1]),Er(T,t[2])].join(\",\")+\"\\\\right)\";case Ae:return\"\\\\operatorname{directedangle}\\\\left(\"+[Er(C,t[0]),Er(T,t[1]),Er(T,t[2])].join(\",\")+\"\\\\right)\";case pr:return`\\\\operatorname{tone}\\\\left(${Er(T,t[0])},${Er(T,t[1])}\\\\right)`;default:throw new Error(\"Cannot serialize a value of type \"+ne(e)+\".\")}}function DE(e){let t={};for(let r in e.updateRules)t[r]=SE(e,r);return t}function SE(e,t){let{valueType:r,value:n}=e.updateRules[t];return`${fn(t)}=${Er(r,n)}`}var Is=class{constructor(t){this.xtolerance=t.xtolerance||t.tolerance||0,this.ytolerance=t.ytolerance||t.tolerance||0,this.ztolerance=t.ztolerance||t.tolerance||0,this.map=t.map,this.segments=[],this.segment=[],this.pivotPoint=void 0,this.pendingPoint=void 0}colinear(t,r,n){let i=this.map(t),s=this.map(r),o=this.map(n);var a=Ls(o[0],o[1],o[2]||0,i[0],i[1],i[2]||0,s[0],s[1],s[2]||0);if(a<1)return!1;var u=[i[0]+a*(s[0]-i[0]),i[1]+a*(s[1]-i[1]),i.length===3?i[2]+a*(s[2]-i[2]):0];return Math.abs(o[0]-u[0])<=this.xtolerance&&Math.abs(o[1]-u[1])<=this.ytolerance&&(i.length===2||Math.abs(o[2]-u[2])<=this.ztolerance)}addPoint(t){if(this.dimensions=t.length,this.xtolerance<0&&this.ytolerance<0&&(this.dimensions===2||this.ztolerance<0)){this.segment.push.apply(this.segment,t);return}if(!this.segment.length){this.segment.push.apply(this.segment,t);return}let r=this.dimensions===2?[this.segment[this.segment.length-2],this.segment[this.segment.length-1]]:[this.segment[this.segment.length-3],this.segment[this.segment.length-2],this.segment[this.segment.length-1]];if(!(t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2])){if(!this.pivotPoint||!this.pendingPoint){this.pivotPoint=t,this.pendingPoint=t;return}(!this.colinear(r,this.pivotPoint,t)||ls(r[0]-t[0],r[1]-t[1],(r[2]||0)-(t[2]||0))<ls(r[0]-this.pendingPoint[0],r[1]-this.pendingPoint[1],(r[2]||0)-(this.pendingPoint[2]||0)))&&(this.flushPending(),this.pivotPoint=t),this.pendingPoint=t}}flushPending(){this.pendingPoint&&(this.segment.push.apply(this.segment,this.pendingPoint),this.pivotPoint=void 0,this.pendingPoint=void 0)}breakSegment(){this.flushPending(),this.segment.length>(this.dimensions||2)&&this.segments.push(this.segment),this.segment=[]}getSegments(){return this.breakSegment(),this.segments}finish(){return{segments:this.getSegments(),resolved:!0}}};var oC=5,cG=Math.pow(2,14),{abs:Ys}=Math;function td(e,t){let r=lG(e,t);return{segments:r.contours.strokeSegments,fillSegments:r.contours.fillSegments,resolved:r.quadTree.resolved}}function lG(e,t){let r=Math.pow(2,-oC),n=sC(t,r),i=sC(t,2*r),s=pG(e,n,i),o=bG(s.root,e,n),a=EG(o,e,n);return{paddedDomain:n,rootDomain:i,quadTree:s,triangles:o,contours:a}}function cp(e,t,r){return{x:e,y:t,z:r}}function vu(e,t,r){return{x:e,y:t,isZero:r}}function Eg(e,t,r){return{vertices:[e,t,r],visited:!1,next:void 0}}function sC(e,t){let{mathToPixels:r}=e,n=r.interpolateX(e.xmin,e.xmax,-t),i=r.interpolateX(e.xmax,e.xmin,-t),s=r.interpolateY(e.ymin,e.ymax,-t),o=r.interpolateY(e.ymax,e.ymin,-t);return{...e,xmin:n,ymin:s,xmax:i,ymax:o}}function Qf(e,t){return{depth:e,vertices:t,children:void 0,center:void 0}}function OE(e,t,r){e.center=aC(e.vertices[0],e.vertices[1],e.vertices[2],e.vertices[3],t,r)}function pG(e,t,r){let n=fG(e,r),i=[],s=[];s.push(n);let o=1,a=!0;e:for(;s.length;){let u=i;i=s,s=u;let c;for(;c=i.pop();)if(mG(c,e,t)){if(dG(c,e,t),!c.children){a=!1;break e}if(s.push(c.children[0]),s.push(c.children[1]),s.push(c.children[2]),s.push(c.children[3]),o+=3,o>=cG){a=!1;break e}}else OE(c,e,t)}for(let u=0;u<i.length;u++)OE(i[u],e,t);for(let u=0;u<s.length;u++)OE(s[u],e,t);return{root:n,resolved:a}}function fG(e,t){let r=t.xmin,n=t.xmax,i=t.ymin,s=t.ymax;return Qf(0,[up(r,s,e),up(n,s,e),up(n,i,e),up(r,i,e)])}function dG(e,t,r){let n=e.depth+1,i=e.vertices[0],s=e.vertices[1],o=e.vertices[2],a=e.vertices[3],u=li(i,s,t,r),c=li(s,o,t,r),l=li(o,a,t,r),p=li(a,i,t,r),f=li(i,o,t,r);e.children=[Qf(n,[i,u,f,p]),Qf(n,[u,s,c,f]),Qf(n,[f,c,o,l]),Qf(n,[p,f,l,a])]}function mG(e,t,r){if(e.depth<oC)return!0;if(gG(e,r)||yG(e,r))return!1;let n=e.vertices[0],i=e.vertices[1],s=e.vertices[2],o=e.vertices[3];if(isNaN(n.z)&&isNaN(i.z)&&isNaN(s.z)&&isNaN(o.z))return!1;if(isNaN(n.z)||isNaN(i.z)||isNaN(s.z)||isNaN(o.z))return!0;let a=aC(n,i,s,o,t,r),u=sa(n,i,t,r),c=sa(i,s,t,r),l=sa(s,o,t,r),p=sa(o,n,t,r);return Su(n,u,t,r)||Su(i,u,t,r)||Su(i,c,t,r)||Su(s,c,t,r)||Su(s,l,t,r)||Su(o,l,t,r)||Su(o,p,t,r)||Su(n,p,t,r)||Du(n,u,a,t,r)||Du(u,i,a,t,r)||Du(i,c,a,t,r)||Du(c,s,a,t,r)||Du(s,l,a,t,r)||Du(l,o,a,t,r)||Du(o,p,a,t,r)||Du(p,n,a,t,r)}function Du(e,t,r,n,i){if(e.z>0==t.z>0&&t.z>0==r.z>0)return!1;let s=0;isFinite(e.z)&&(s=Math.max(s,Math.abs(e.z))),isFinite(t.z)&&(s=Math.max(s,Math.abs(t.z))),isFinite(r.z)&&(s=Math.max(s,Math.abs(r.z)));let o=32*Number.EPSILON*s,a,u,c,l;if(e.z>0==t.z>0){if(a=li(e,t,n,i),a.z>0!=e.z>0)return!0;u=ia(e,r,n,i,o),c=ia(t,r,n,i,o),l=ia(a,r,n,i,o)}else if(t.z>0==r.z>0){if(a=li(t,r,n,i),a.z>0!=t.z>0)return!0;u=ia(t,e,n,i,o),c=ia(r,e,n,i,o),l=ia(a,e,n,i,o)}else{if(a=li(r,e,n,i),a.z>0!=r.z>0)return!0;u=ia(r,t,n,i,o),c=ia(e,t,n,i,o),l=ia(a,t,n,i,o)}let{mathToPixels:p,map3d:f}=i;if(f){let g=f(l.x,l.y),y=f(u.x,u.y),d=f(c.x,c.y);var m=hM(g[0],g[1],g[2],y[0],y[1],y[2],d[0],d[1],d[2]);return m>i.tolerance}else{let[g,y]=p.mapCoordinatePair([l.x,l.y]),[d,h]=p.mapCoordinatePair([u.x,u.y]),[b,x]=p.mapCoordinatePair([c.x,c.y]);return gM(g,y,d,h,b,x)>i.tolerance}}function Su(e,t,r,n){if(isNaN(e.z)&&isNaN(t.z))return!1;if(isNaN(e.z)||isNaN(t.z))return e.z>0||t.z>0;let s=4*li(e,t,r,n).z-t.z-3*e.z,o=1e-4,a=(r((1-o)*e.x+o*t.x,(1-o)*e.y+o*t.y)-e.z)/o,u=Math.max(Math.abs(e.z),Math.abs(t.z));return Math.abs(s-a)>.125*u}function yG(e,t){let{mathToPixels:r,map3d:n,tolerance:i}=t;if(n)return!1;{let[s,o]=r.mapCoordinatePair([e.vertices[1].x,e.vertices[1].y]),[a,u]=r.mapCoordinatePair([e.vertices[0].x,e.vertices[0].y]),[c,l]=r.mapCoordinatePair([e.vertices[3].x,e.vertices[3].y]);if(Ys(s-a)<10*i||Ys(u-l)<10*i)return!0}return!1}function gG(e,t){return e.vertices[0].x<t.xmin||e.vertices[0].y>t.ymax||e.vertices[2].x>t.xmax||e.vertices[2].y<t.ymin}function lp(e,t){return e.x<t.xmin||e.x>t.xmax||e.y<t.ymin||e.y>t.ymax}function up(e,t,r){return cp(e,t,r(e,t))}function li(e,t,r,n){let{mathToPixels:i}=n;return up(i.interpolateX(e.x,t.x,.5),i.interpolateY(e.y,t.y,.5),r)}function sa(e,t,r,n){if(lp(e,n)||lp(t,n))return li(e,t,r,n);if(isNaN(e.z)||isNaN(t.z))return hG(e,t,r,n);if(e.z>0!=t.z>0)return li(e,t,r,n);let i=.01,s=r((1-i)*e.x+i*t.x,(1-i)*e.y+i*t.y)-e.z,o=t.z-r(i*e.x+(1-i)*t.x,i*e.y+(1-i)*t.y);return isNaN(s)||isNaN(o)||s>0==o>0?li(e,t,r,n):uC(cp(e.x,e.y,s),cp(t.x,t.y,o),r,n)}function aC(e,t,r,n,i,s){let o=sa(e,r,i,s);return e.z>0==r.z>0&&o.z>0!=e.z>0||(o=sa(t,n,i,s),t.z>0==n.z>0&&o.z>0!=t.z>0)?o:li(e,r,i,s)}function uC(e,t,r,n){if(isNaN(e.z))return t;if(isNaN(t.z))return e;if(!isFinite(e.z)&&!isFinite(t.z))return li(e,t,r,n);if(isFinite(e.z))if(isFinite(t.z)){let i=1-e.z/t.z,s=1-t.z/e.z;return up(e.x/i+t.x/s,e.y/i+t.y/s,r)}else return e;else return t}function ia(e,t,r,n,i){let{mathToPixels:s,map3d:o}=n,a=e.x,u=t.x,c=e.y,l=t.y,p=e.z,f=t.z;if(lp(e,n)||lp(t,n)){let m=li(e,t,r,n);return vu(m.x,m.y,!1)}if(o){let[m,g,y]=o(a,c),[d,h,b]=o(u,l);for(;Ys(m-d)>n.tolerance||Ys(g-h)>n.tolerance||Ys(y-b)>n.tolerance;){let x=.5*(a+u),P=.5*(c+l),E=r(x,P);if(E>0==p>0?(a=x,c=P,p=E):(u=x,l=P,f=E),(x===a||x===u)&&(P===c||P===l))break;[m,g,y]=o(a,c),[d,h,b]=o(u,l)}}else{let[m,g]=s.mapCoordinatePair([a,c]),[y,d]=s.mapCoordinatePair([u,l]);for(;Ys(m-y)>n.tolerance||Ys(g-d)>n.tolerance;){let h=.5*(a+u),b=.5*(c+l),x=r(h,b);x>0==p>0?(a=h,c=b,p=x):(u=h,l=b,f=x),[m,g]=s.mapCoordinatePair([a,c]),[y,d]=s.mapCoordinatePair([u,l])}}if(isNaN(p))return vu(u,l,!1);if(isNaN(f))return vu(a,c,!1);{let m=Math.abs(p),g=Math.abs(f);if(m<i&&g>100*i)return 1/m>=g?vu(a,c,!0):vu(u,l,!1);if(g<i&&m>100*i)return 1/g>=m?vu(u,l,!0):vu(a,c,!1);let y=uC(cp(a,c,p),cp(u,l,f),r,n),d=p===0||f===0||y.z===0||y.z>=p==f>=y.z&&Math.abs(y.z)<1e250;return vu(y.x,y.y,d)}}function hG(e,t,r,n){let{mathToPixels:i,map3d:s}=n;if(isNaN(e.z)===isNaN(t.z))return li(e,t,r,n);if(isNaN(e.z)){let p=e;e=t,t=p}let o=e.x,a=t.x,u=e.y,c=t.y,l=e.z;if(s){let[p,f,m]=s(o,u),[g,y,d]=s(a,c);for(;Ys(p-g)>n.tolerance||Ys(f-y)>n.tolerance||Ys(m-d)>n.tolerance||isNaN(p)||isNaN(g);){let h=.5*(o+a),b=.5*(u+c),x=r(h,b);if(isNaN(x)===isNaN(l)?(o=h,u=b,l=x):(a=h,c=b),(h===o||h===a)&&(b===u||b===c))break;[p,f,m]=s(o,u),[g,y,d]=s(a,c)}}else{let[p,f]=i.mapCoordinatePair([o,u]),[m,g]=i.mapCoordinatePair([a,c]);for(;Ys(p-m)>n.tolerance||Ys(f-g)>n.tolerance;){let y=.5*(o+a),d=.5*(u+c),h=r(y,d);isNaN(h)===isNaN(l)?(o=y,u=d,l=h):(a=y,c=d),[p,f]=i.mapCoordinatePair([o,u]),[m,g]=i.mapCoordinatePair([a,c])}}return cp(o,u,l)}function bG(e,t,r){let n={triangles:[],edgeCache:{},domain:r,fn:t};return Kf(e,n),n.triangles}function Kf(e,t){e.children&&(Kf(e.children[0],t),Kf(e.children[1],t),Kf(e.children[2],t),Kf(e.children[3],t),Ou(e.children[0],e.children[1],t),Ou(e.children[3],e.children[2],t),Ru(e.children[1],e.children[2],t),Ru(e.children[0],e.children[3],t))}function Ou(e,t,r){e.children&&t.children?(Ou(e.children[1],t.children[0],r),Ou(e.children[2],t.children[3],r)):e.children?(Ou(e.children[1],t,r),Ou(e.children[2],t,r)):t.children?(Ou(e,t.children[0],r),Ou(e,t.children[3],r)):xG(e,t,r)}function Ru(e,t,r){e.children&&t.children?(Ru(e.children[2],t.children[1],r),Ru(e.children[3],t.children[0],r)):e.children?(Ru(e.children[2],t,r),Ru(e.children[3],t,r)):t.children?(Ru(e,t.children[1],r),Ru(e,t.children[0],r)):PG(e,t,r)}function xG(e,t,r){if(!e.center||!t.center)return;let n,i;e.depth>=t.depth?(n=sa(e.vertices[1],e.vertices[2],r.fn,r.domain),i=Dg(e.vertices[1],t.center,e.vertices[2],e.center,n)):(n=sa(t.vertices[0],t.vertices[3],r.fn,r.domain),i=Dg(t.vertices[0],t.center,t.vertices[3],e.center,n)),cC(i,r.edgeCache,r.domain);for(let s=0;s<4;s++)r.triangles.push(i[s])}function PG(e,t,r){if(!e.center||!t.center)return;let n,i;e.depth>=t.depth?(n=sa(e.vertices[3],e.vertices[2],r.fn,r.domain),i=Dg(e.vertices[2],t.center,e.vertices[3],e.center,n)):(n=sa(t.vertices[1],t.vertices[0],r.fn,r.domain),i=Dg(t.vertices[1],t.center,t.vertices[0],e.center,n)),cC(i,r.edgeCache,r.domain);for(let s=0;s<4;s++)r.triangles.push(i[s])}function Dg(e,t,r,n,i){return[Eg(e,i,t),Eg(t,i,r),Eg(r,i,n),Eg(n,i,e)]}function ed(e,t,r){return e.z>0&&!lp(e,r)&&(!(t.z>0)||lp(t,r))}function Mg(e,t){return\"\"+e.x+\",\"+e.y+\",\"+t.x+\",\"+t.y}function cC(e,t,r){vg(e[0],e[1],e[2],Mg(e[1].vertices[2],e[1].vertices[0]),t,r),vg(e[1],e[2],e[3],Mg(e[2].vertices[0],e[2].vertices[2]),t,r),vg(e[2],e[3],e[0],Mg(e[3].vertices[2],e[3].vertices[0]),t,r),vg(e[3],e[0],e[1],Mg(e[0].vertices[0],e[0].vertices[2]),t,r)}function vg(e,t,r,n,i,s){let o=t.vertices[0],a=t.vertices[1],u=t.vertices[2];ed(a,u,s)&&(t.next=r),ed(o,a,s)&&(t.next=e),ed(u,o,s)&&IG(t,n,i),ed(o,u,s)&&TG(t,n,i)}function TG(e,t,r){r[t]?r[t].next=e:r[t]=e}function IG(e,t,r){r[t]?e.next=r[t]:r[t]=e}function EG(e,t,r){let{tolerance:n,mathToPixels:i,map3d:s}=r,o;if(s){let a={tolerance:n,map:u=>s(u[0],u[1])};o={fillAccumulator:new Is(a),strokeAccumulator:new Is(a),fn:t,domain:r}}else{let a={tolerance:n,map:u=>i.mapCoordinatePair(u)};o={fillAccumulator:new Is(a),strokeAccumulator:new Is(a),fn:t,domain:r}}for(let a=0;a<e.length;a++){let u=e[a];u.next&&!u.visited&&MG(u,o)}return{strokeSegments:o.strokeAccumulator.finish().segments,fillSegments:o.fillAccumulator.finish().segments}}function MG(e,t){for(;;){let r=e.vertices[0],n=e.vertices[1],i=e.vertices[2],s=0;isFinite(r.z)&&(s=Math.max(s,Math.abs(r.z))),isFinite(n.z)&&(s=Math.max(s,Math.abs(n.z))),isFinite(i.z)&&(s=Math.max(s,Math.abs(i.z)));let o=32*Number.EPSILON*s;if(RE(r,n,t,o),RE(n,i,t,o),RE(i,r,t,o),e.visited||!e.next)break;e.visited=!0,e=e.next}t.strokeAccumulator.breakSegment(),t.fillAccumulator.breakSegment()}function RE(e,t,r,n){if(ed(e,t,r.domain)){let i=ia(e,t,r.fn,r.domain,n);r.fillAccumulator.addPoint([i.x,i.y]),i.isZero?r.strokeAccumulator.addPoint([i.x,i.y]):r.strokeAccumulator.breakSegment()}}var os={pointsOfInterest:!0,plotSingleVariableImplicitEquations:!0,plotImplicits:!0,plotInequalities:!0,sliders:!0};function CE(e){return Math.abs(e)<5e-8}var rd=class extends Is{constructor(t,r,n){let{tolerance:i,mathToPixels:s}=t;super({tolerance:i,map:o=>s.mapCoordinatePair(o)}),this.fn=r,this.mappedFn=o=>s.mapY(r(o)),this.derivative=n,this.poiData={zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}},this.zeroBuffer=[],this.extremumBuffer=[]}getPOI(){return os.pointsOfInterest?(this.poiData.intercept=this.findIntercept(this.fn),this.poiData):{zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}}}addPoint(t){this.segment.length===0&&CE(t[1])&&(this.poiData.zeros.x.push(t[0]),this.poiData.zeros.y.push(t[1])),this.updateZeroBuffer(t),this.updateExtremumBuffer(t),super.addPoint(t)}updateZeroBuffer(t){let[r,n]=this.map?this.map(t):t;if(!isFinite(r)||!isFinite(n)){this.zeroBuffer.length=0;return}switch(this.zeroBuffer.length){case 0:{if(CE(t[1]))return;this.zeroBuffer.push(t);return}case 1:if(t[1]===0){this.zeroBuffer.push(t);return}else if(t[1]>0!=this.zeroBuffer[0][1]>0){let i=mT(this.zeroBuffer[0][0],this.zeroBuffer[0][1],t[0],t[1],this.fn);i&&(this.poiData.zeros.x.push(i[0]),this.poiData.zeros.y.push(i[1])),this.zeroBuffer.length=0,this.zeroBuffer.push(t);return}else{this.zeroBuffer.length=0,this.zeroBuffer.push(t);return}case 2:{if(t[1]===0)return;if(t[1]>0!=this.zeroBuffer[0][1]>0){let i=Pf(this.zeroBuffer[0][0],this.zeroBuffer[0][1],this.zeroBuffer[1][0],this.zeroBuffer[1][1],t[0],t[1],this.fn);i&&(this.poiData.zeros.x.push(i[0]),this.poiData.zeros.y.push(i[1])),this.zeroBuffer.length=0,this.zeroBuffer.push(t);return}else{this.zeroBuffer.length=0,this.zeroBuffer.push(t);return}}}}updateExtremumBuffer(t){let[r,n]=this.map?this.map(t):t;if(!isFinite(r)||!isFinite(n)){this.extremumBuffer.length=0;return}switch(this.extremumBuffer.length){case 0:{this.extremumBuffer.push(t);return}case 1:{t[1]===this.extremumBuffer[0][1]&&(this.extremumBuffer.length=0),this.extremumBuffer.push(t);return}case 2:if(t[1]===this.extremumBuffer[1][1]){this.extremumBuffer.push(t);return}else if(t[1]>this.extremumBuffer[1][1]!=this.extremumBuffer[1][1]>this.extremumBuffer[0][1]){let i=this.bisectExtremumUsingDerivative(this.extremumBuffer[0][0],this.extremumBuffer[0][1],this.extremumBuffer[1][0],this.extremumBuffer[1][1],t[0],t[1]);i&&(this.poiData.extrema.x.push(i[0]),this.poiData.extrema.y.push(i[1]),!wl(this.extremumBuffer[0][0],this.mappedFn(this.extremumBuffer[0][0]),i[0],this.mappedFn(i[0]),t[0],this.mappedFn(t[0]),this.mappedFn,this.ytolerance)&&i[0]>this.segment[this.segment.length-2]&&(this.pendingPoint=i)),this.extremumBuffer.shift(),this.extremumBuffer.push(t);return}else{this.extremumBuffer.shift(),this.extremumBuffer.push(t);return}case 3:{if(t[1]===this.extremumBuffer[1][1])return;if(t[1]>this.extremumBuffer[1][1]!=this.extremumBuffer[1][1]>this.extremumBuffer[0][1]){let i,s=.5*(this.extremumBuffer[1][0]+this.extremumBuffer[2][0]),o=this.fn(s);o===this.extremumBuffer[1][1]?i=Pf(this.extremumBuffer[0][0],this.extremumBuffer[0][1],this.extremumBuffer[1][0],this.extremumBuffer[1][1],t[0],t[1],this.fn):i=this.bisectExtremumUsingDerivative(this.extremumBuffer[1][0],this.extremumBuffer[1][1],s,o,this.extremumBuffer[2][0],this.extremumBuffer[2][1]),i&&(this.poiData.extrema.x.push(i[0]),this.poiData.extrema.y.push(i[1])),this.extremumBuffer.shift(),this.extremumBuffer.shift(),this.extremumBuffer.push(t);return}else{this.extremumBuffer.shift(),this.extremumBuffer.shift(),this.extremumBuffer.push(t);return}}}}bisectExtremumUsingDerivative(t,r,n,i,s,o){let a;if(this.derivative){let u=this.derivative(t),c=this.derivative(s);if(!isNaN(u)&&!isNaN(c)&&(i>r&&u>0&&c<0||i<r&&u<0&&c>0)){let l=mT(t,u,s,c,this.derivative);l&&(a=[l[0],this.fn(l[0])])}}return a||(a=oD(t,r,n,i,s,o,this.fn)),a}breakSegment(){this.zeroBuffer.length=0,this.extremumBuffer.length=0,this.flushPending(),this.segment.length>2&&(this.segments.push(this.segment),CE(this.segment[this.segment.length-1])&&(this.poiData.zeros.x.push(this.segment[this.segment.length-2]),this.poiData.zeros.y.push(this.segment[this.segment.length-1]))),this.segment=[]}findIntercept(t){if(!t)return{x:[],y:[]};let r=t(0);return isFinite(r)?{x:[0],y:[t(0)]}:{x:[],y:[]}}finish(){return{segments:this.getSegments(),resolved:!0,poi:this.getPOI()}}};var vG=e=>{for(var t=[],r=[],n=e.length,i=0;i<n;i++)t.push(e[i][0]),r.push(e[i][1]);return{defined:{x:t,y:r}}},Xs=vG;var{sin:DG,cos:SG}=Math,je=class e{constructor(t=0,r=0,n=0){this.x=t;this.y=r;this.z=n}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}set(t,r,n){return this.x=t,this.y=r,this.z=n,this}clone(){return new e(this.x,this.y,this.z)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}isZero(){return this.x===0&&this.y===0&&this.z===0}isFinite(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)}subVectors(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this.z=t.z-r.z,this}addVectors(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this.z=t.z+r.z,this}multiply(t){return this.x*=t,this.y*=t,this.z*=t,this}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){return this.multiply(1/this.magnitude()),this}cross(t){return this.crossVectors(this,t)}crossVectors(t,r){let n=t.x,i=t.y,s=t.z,o=r.x,a=r.y,u=r.z;return this.x=i*u-s*a,this.y=s*o-n*u,this.z=n*a-i*o,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}rotateAroundAxis(t,r){let n=OG(t,r);return new e(n[0]*this.x+n[1]*this.y+n[2]*this.z,n[3]*this.x+n[4]*this.y+n[5]*this.z,n[6]*this.x+n[7]*this.y+n[8]*this.z)}};function OG(e,t){let r=e.x,n=e.y,i=e.z,s=DG(t),o=SG(t),a=1-o;return[a*r*r+o,a*r*n+s*i,a*r*i-s*n,a*n*r-s*i,a*n*n+o,a*n*i+s*r,a*i*r+s*n,a*i*n-s*r,a*i*i+o]}var ie=class{constructor(t,r){this.min=t;this.max=r}get width(){return this.max-this.min}};function nd(e,t,r,n,i,s=100){if(isFinite(n)||([n,i]=[i,n],[t,r]=[r,t]),isFinite(i))return NE(e,t,r,n,i,s);for(;;){let o=bs(t,r,.5),a=e(...o);if(a===0)return o;if(!isFinite(a))r=o,i=a;else if(n<0==a<0)t=o,n=a;else return r=o,i=a,NE(e,t,r,n,i,s);if(s*=.5,s<1)return}}function lC(e,t,r,n,i,s=100){if(isFinite(n)||([n,i]=[i,n],[t,r]=[r,t]),!isFinite(i))for(;;){let o=bs(t,r,.5),a=e(...o);if(a===0)return{posNeg:o};if(!isFinite(a))r=o,i=a;else if(n<0==a<0)t=o,n=a;else if(n>0){r=o,i=a;break}else return{posNeg:AE(e,o,t,a,n,s),posNaN:RG(e,o,r,s)};if(s*=.5,s<1){let u=bs(t,r,.5);return n>0?{posNaN:u}:{}}}return{posNeg:NE(e,t,r,n,i,s)}}function NE(e,t,r,n,i,s){return n>0?AE(e,t,r,n,i,s):AE(e,r,t,i,n,s)}function AE(e,t,r,n,i,s){let o=n-i;for(;;){let a=bs(t,r,.5),u=e(...a);if(u<0)r=a,i=u;else if(u>0)t=a,n=u;else return u===0?a:void 0;if(s*=.5,s<1){if(n-i<.1*o)return bs(t,r,.5);if(s<1e-6)return}}}function RG(e,t,r,n){for(;;){let i=bs(t,r,.5),s=e(...i);if(!isFinite(s))r=i;else if(s>=0)t=i;else return;if(n*=.5,n<1)return bs(t,r,.5)}}function pp(e,t,r,n,i,s,o){let[a,u,c]=[new je,new je,new je],[l,p,f]=[new je,new je,new je],[m,g]=[new je,new je];for(let d=0;d<e.length/3;d++){let h=e[3*d],b=e[3*d+1],x=e[3*d+2];a.set(t[3*h],t[3*h+1],t[3*h+2]),u.set(t[3*b],t[3*b+1],t[3*b+2]),c.set(t[3*x],t[3*x+1],t[3*x+2]),l.set(r[3*h],r[3*h+1],r[3*h+2]),p.set(r[3*b],r[3*b+1],r[3*b+2]),f.set(r[3*x],r[3*x+1],r[3*x+2]),m.subVectors(c,a),g.subVectors(a,u);var y=m.cross(g).normalize();if(!(l.dot(y)>o&&p.dot(y)>o&&f.dot(y)>o)||l.dot(p)<0||l.dot(f)<0||p.dot(f)<0){let E=t.length/3;e[3*d]=E,e[3*d+1]=E+1,e[3*d+2]=E+2,t.push(a.x,a.y,a.z),t.push(u.x,u.y,u.z),t.push(c.x,c.y,c.z),r.push(y.x,y.y,y.z),r.push(y.x,y.y,y.z),r.push(y.x,y.y,y.z),n.push(n[2*h],n[2*h+1]),n.push(n[2*b],n[2*b+1]),n.push(n[2*x],n[2*x+1]);let M=i;if(i>0){for(let I=0;I<M;I++)s.push(s[M*h+I]);for(let I=0;I<M;I++)s.push(s[M*b+I]);for(let I=0;I<M;I++)s.push(s[M*x+I])}}}}var Sg=[[1,2,4,21,20,18],[0,1,3,20,19,18],[2,6,7,25,21,18],[5,6,8,25,22,18],[5,9,11,23,22,18],[0,9,10,23,19,18],[10,12,14,24,23,19],[3,12,13,24,20,19],[4,13,15,24,21,20],[15,7,16,25,24,21],[11,17,14,24,23,22],[17,8,16,25,24,22]],Dn=[0,1,0,2,0,3,1,2,2,3,0,4,0,7,3,7,4,7,0,5,1,5,4,5,1,6,2,6,5,6,3,6,6,7,4,6,0,8,1,8,2,8,3,8,4,8,5,8,6,8,7,8],fC=[[0,2,3,8],[0,1,2,8],[0,3,7,8],[0,4,7,8],[0,4,5,8],[0,1,5,8],[1,5,6,8],[1,2,6,8],[2,3,6,8],[3,6,7,8],[4,5,6,8],[4,6,7,8]],dC=[[0,0,0],[0,1,0],[1,1,0],[1,0,0],[0,0,1],[0,1,1],[1,1,1],[1,0,1],[.5,.5,.5]],_E=[[1,2,4],[4,20,21],[2,18,21],[1,18,20],[0,1,3],[3,19,20],[0,18,19],[2,6,7],[7,21,25],[6,18,25],[5,6,8],[8,22,25],[5,18,22],[5,9,11],[11,22,23],[9,18,23],[0,9,10],[10,19,23],[10,12,14],[14,23,24],[12,19,24],[3,12,13],[13,20,24],[4,13,15],[15,21,24],[15,7,16],[16,24,25],[11,17,14],[17,22,24],[17,8,16]],LE=[];for(let e=0;e<30;e++){let t=_E[e],r=new Set;for(let n of t)r.add(Dn[n*2]),r.add(Dn[n*2+1]);LE[e]=[...r]}var mC=[[0,3,2,1],[4,6,3,5],[7,2,9,8],[10,12,9,11],[13,12,15,14],[16,6,15,17],[18,17,20,19],[21,5,20,22],[23,1,22,24],[25,24,8,26],[27,14,28,19],[29,28,11,26]],CG=1<<31,NG=1<<30,pC=1<<24,Ac=1<<24,Es=1<<24,Zs=65536,Ws=256,js=1;function yC(e,t,r){return r*Zs+t*Ws+e*js}var AG={0:0*pC,1:Ws,2:js+Ws,3:js,4:Zs,5:Ws+Zs,6:js+Ws+Zs,7:js+Zs,8:8*pC};function gC(e,t){return CG+e+AG[t]}var _G={3:2*Es+Ws,4:0*Es+js,7:5*Es+js,8:2*Es+Zs,10:5*Es+Ws,11:0*Es+Zs,12:6*Es+Ws,13:5*Es+js+Ws,14:2*Es+Ws+Zs,15:9*Es+js,16:0*Es+js+Zs,17:1*Es+Zs};function id(e,t){var r;return NG+e+((r=_G[t])!=null?r:Es*t)}var LG={18:10*Ac+Ws,21:7*Ac+Ws,23:16*Ac+js,25:13*Ac+js,27:4*Ac+Zs,29:0*Ac+Zs};function wE(e,t){var r;return e+((r=LG[t])!=null?r:Ac*t)}var fp=class{constructor(t,r,n,i,s){this.PAConstructor=t;this.x=r;this.y=n;this.z=i;this.gridsize=s;this.i=0;this.j=0;this.k=0;this.cubeVertex=new Array(9);this.cubeVertexValue=new this.PAConstructor(9);if(s>250)throw new Error(\"Programming Error: resolution should be clamped well below 250.\");this.size=new je(this.x.width/s,this.y.width/s,this.z.width/s)}loopOverUnitCubes(t){let r=this.gridsize,n=r+1,i=new Og(this.x.min,this.y.min,this.z.min,this.size.x,this.size.y,this.size.z,r+1,r+1,r+1),s=new Og(this.x.min+this.size.x/2,this.y.min+this.size.y/2,this.z.min+this.size.z/2,this.size.x,this.size.y,this.size.z,r,r,r),o=i.setupArray(this.PAConstructor),a=i.setupArray(this.PAConstructor),u=s.setupArray(this.PAConstructor);this.evaluateArray(a,i,0);for(let c=0;c<r;c++){this.k=c,[o,a]=[a,o],this.evaluateArray(a,i,c+1),this.evaluateArray(u,s,c);for(let l=0;l<r;l++){this.j=l;for(let p=0;p<r;p++){this.i=p;let f=l*n+p;this.cubeVertexValue.setFrom(0,o,f),this.cubeVertexValue.setFrom(1,o,f+n),this.cubeVertexValue.setFrom(2,o,f+n+1),this.cubeVertexValue.setFrom(3,o,f+1),this.cubeVertexValue.setFrom(4,a,f),this.cubeVertexValue.setFrom(5,a,f+n),this.cubeVertexValue.setFrom(6,a,f+n+1),this.cubeVertexValue.setFrom(7,a,f+1),this.cubeVertexValue.setFrom(8,u,l*r+p),t()}}}}evaluateArray(t,r,n){let i=r.z0+n*r.dz;for(let s=0;s<r.numX;s++)for(let o=0;o<r.numY;o++){let a=r.x0+s*r.dx,u=r.y0+o*r.dy;this.setAt(t,o*r.numX+s,a,u,i)}}setVertexPositions(){for(let t=0;t<9;t++){let r=dC[t];this.cubeVertex[t]=[this.x.min+(this.i+r[0])*this.size.x,this.y.min+(this.j+r[1])*this.size.y,this.z.min+(this.k+r[2])*this.size.z]}}},Og=class{constructor(t,r,n,i,s,o,a,u,c){this.x0=t;this.y0=r;this.z0=n;this.dx=i;this.dy=s;this.dz=o;this.numX=a;this.numY=u;this.numZ=c}setupArray(t){return new t(this.numX*this.numY)}};var Rg=class{constructor(t){this.length=t;this.n=1;this.buffer=new Float64Array(t)}set(t,r){this.buffer[t]=r}get(t){return this.buffer[t]}setFrom(t,r,n){if(r.n!==this.n)throw new Error(\"Programming Error: Mismatched dimensions\");this.set(t,r.get(n))}},Cg=class{constructor(t){this.length=t;this.n=2;this.buffer=new Float64Array(t*2)}set(t,r,n){this.buffer[t*2]=r,this.buffer[t*2+1]=n}getX(t){return this.buffer[t*2]}getY(t){return this.buffer[t*2+1]}setFrom(t,r,n){if(r.n!==this.n)throw new Error(\"Programming Error: Mismatched dimensions\");this.set(t,r.getX(n),r.getY(n))}};var od=50;function _c(e){return e!==void 0&&e!==0}function wG(e){return _c(e.posNeg)||_c(e.posNaN)}var sd={};function FE(e=sd,t=sd,r=sd){return{edge0:e,edge1:t,edge2:r}}function hC(e,t,r,n,{isInequality:i}){return new VE(e,t,new ie(r.xmin,r.xmax),new ie(r.ymin,r.ymax),new ie(r.zmin,r.zmax),n,{isInequality:i}).fullLoopOverUnitCubes()}var VE=class extends fp{constructor(r,n,i,s,o,a,{isInequality:u}){super(Rg,i,s,o,a);this.f=r;this.gradient=n;this.cubeEdge=new Array(26);this.face=FE();this.cubeHasCrossing=!1;this.allNormalsFromGradient=!0;this.normalFromGradient=[];this.edgesMaybeCross=0;this.positions=[];this.uvs=[];this.normals=[];this.triangles=[];this.isInequality=u,this.sheet=Array((a+1)*(a+1)),this.strip=Array(a+1);for(let c=0;c<(a+1)*(a+1);c++)this.sheet[c]=FE();for(let c=0;c<a+1;c++)this.strip[c]=FE()}setAt(r,n,i,s,o){let a=this.f(i,s,o);r.set(n,a)}fullLoopOverUnitCubes(){this.positions=[],this.normals=[],this.triangles=[],this.loopOverUnitCubes(this.onEachCube.bind(this));let{uvs:r,positions:n,normals:i}=this;if(!this.allNormalsFromGradient)for(let s=0;s<i.length/3;s++){if(this.normalFromGradient[s])continue;let o=i[3*s],a=i[3*s+1],u=i[3*s+2],c=Math.sqrt(o*o+a*a+u*u);i[3*s]=o/c,i[3*s+1]=a/c,i[3*s+2]=u/c}return pp(this.triangles,this.positions,i,r,0,[],.7),{positions:n,normals:i,faces:this.triangles,uvs:r,resolved:!0,extraAttrs:[]}}onEachCube(){this.edgesMaybeCross=0,this.cubeHasCrossing=!1;for(let r=0;r<26;r++){let n=this.cubeVertexValue.get(Dn[r*2]),i=this.cubeVertexValue.get(Dn[r*2+1]);(n===0||i===0)&&(this.cubeHasCrossing=!0),!(n>0&&i>0||n<0&&i<0)&&(isFinite(n)||isFinite(i))&&(this.edgesMaybeCross|=1<<r)}this.edgesMaybeCross&&(this.setVertexPositions(),this.setEdges()),this.saveEdges(),this.cubeHasCrossing&&this.generateTriangles()}setEdges(){let{i:r,j:n,k:i,gridsize:s}=this,o=this.sheet[(r+0)*(s+1)+n+0],a=this.sheet[(r+1)*(s+1)+n+0],u=this.sheet[(r+0)*(s+1)+n+1],c=0;i>0&&(this.cubeEdge[0]=o.edge0,this.cubeEdge[1]=o.edge1,this.cubeEdge[2]=o.edge2,this.cubeEdge[3]=u.edge2,this.cubeEdge[4]=a.edge0,c|=31),n>0&&(this.cubeEdge[5]=this.strip[r].edge0,this.cubeEdge[6]=this.strip[r].edge1,this.cubeEdge[7]=this.strip[r+1].edge0,this.cubeEdge[8]=this.strip[r].edge2,c|=480,i==0&&(this.cubeEdge[2]=o.edge2,c|=4)),r>0&&(this.cubeEdge[9]=this.face.edge0,this.cubeEdge[10]=this.face.edge1,this.cubeEdge[11]=this.face.edge2,c|=3584,i==0&&(this.cubeEdge[0]=o.edge0,c|=1),n==0&&(this.cubeEdge[5]=this.strip[r].edge0,c|=32));for(let l=0;l<26;l++){if(~this.edgesMaybeCross>>l&1){this.cubeEdge[l]=sd;continue}if(c>>l&1){!this.cubeHasCrossing&&(this.cubeEdge[l].posNeg||this.cubeEdge[l].posNaN)&&(this.cubeHasCrossing=!0);continue}let p=this.findSurfaceCrossingEDI(Dn[l*2],Dn[l*2+1]);this.cubeEdge[l]=p,wG(p)&&(this.cubeHasCrossing=!0)}}saveEdges(){let{i:r,j:n,k:i,gridsize:s}=this;i<s-1&&(this.sheet[(r+0)*(s+1)+n+0].edge0=this.cubeEdge[11],this.sheet[(r+0)*(s+1)+n+0].edge1=this.cubeEdge[17],this.sheet[(r+0)*(s+1)+n+0].edge2=this.cubeEdge[8]),n<s-1&&(this.strip[r].edge0=this.cubeEdge[10],this.strip[r].edge1=this.cubeEdge[12],this.strip[r].edge2=this.cubeEdge[14]),r<s-1&&(this.face.edge0=this.cubeEdge[15],this.face.edge1=this.cubeEdge[13],this.face.edge2=this.cubeEdge[16]),i==0&&(this.sheet[(r+0)*(s+1)+n+1].edge2=this.cubeEdge[3],this.sheet[(r+1)*(s+1)+n+0].edge0=this.cubeEdge[4]),n==0&&(this.strip[r+1].edge0=this.cubeEdge[7]),n==s-1&&(this.sheet[r*(s+1)+s].edge2=this.cubeEdge[14]),r==s-1&&(this.sheet[(s+0)*(s+1)+n].edge0=this.cubeEdge[16],this.strip[s].edge0=this.cubeEdge[13])}findSurfaceCrossingEDI(r,n){let i=this.cubeVertexValue.get(r),s=this.cubeVertexValue.get(n);if(i===0||s===0)return sd;let o=this.cubeVertex[r],a=this.cubeVertex[n];if(this.isInequality){let{posNeg:u,posNaN:c}=lC(this.f,o,a,i,s);return{posNeg:u!==void 0?this.pushPositionWithGradient(...u):void 0,posNaN:c!==void 0?this.pushPositionNoGradient(...c):void 0}}else{let u=nd(this.f,o,a,i,s);return{posNeg:u!==void 0?this.pushPositionWithGradient(...u):void 0}}}pushPositionWithGradient(r,n,i){if(!(isFinite(r)&&isFinite(n)&&isFinite(i)))return 0;let[s,o,a]=this.computeGradient(r,n,i),u=Math.sqrt(s*s+o*o+a*a);return s/=-u,o/=-u,a/=-u,Ll(s,o,a)?(this.normalFromGradient.push(!0),this._pushPositionAndNormal(r,n,i,s,o,a)):this.pushPositionNoGradient(r,n,i)}pushPositionNoGradient(r,n,i){return isFinite(r)&&isFinite(n)&&isFinite(i)?(this.allNormalsFromGradient=!1,this.normalFromGradient.push(!1),this._pushPositionAndNormal(r,n,i,0,0,0)):0}_pushPositionAndNormal(r,n,i,s,o,a){return this.positions.push(r,n,i),this.uvs.push((r-this.x.min)/this.x.width,(n-this.y.min)/this.y.width),this.normals.push(s,o,a),this.positions.length/3}computeGradient(r,n,i){let s=NaN,o=NaN,a=NaN;if(this.gradient&&([s,o,a]=this.gradient(r,n,i),isFinite(s)&&isFinite(o)&&isFinite(a)))return[s,o,a];let u=.001*Math.min(this.size.x,this.size.y,this.size.z),c=this.f(r,n,i);if(isFinite(s)||(s=(this.f(r+u,n,i)-c)/u),isFinite(s)||(s=(c-this.f(r-u,n,i))/u),isFinite(o)||(o=(this.f(r,n+u,i)-c)/u),isFinite(o)||(o=(c-this.f(r,n-u,i))/u),isFinite(a)||(a=(this.f(r,n,i+u)-c)/u),isFinite(a)||(a=(c-this.f(r,n,i-u))/u),isFinite(s)&&isFinite(o)&&isFinite(a))return[s,o,a];let l=NaN,p=NaN,f=NaN,m=NaN,g=NaN,y=NaN,d=u/2;return(!isFinite(s)||!isFinite(o))&&(l=(this.f(r+d,n+d,i)-c)/u,isFinite(l)||(l=(c-this.f(r-d,n-d,i))/u),p=(this.f(r+d,n-d,i)-c)/u,isFinite(p)||(p=(c-this.f(r-d,n+d,i))/u),isFinite(l)&&isFinite(p)&&(isFinite(s)||(s=l+p),isFinite(o)||(o=l-p))),(!isFinite(o)||!isFinite(a))&&(f=(this.f(r,n+d,i+d)-c)/u,isFinite(f)||(f=(c-this.f(r,n-d,i-d))/u),m=(this.f(r,n+d,i-d)-c)/u,isFinite(m)||(m=(c-this.f(r,n-d,i+d))/u),isFinite(f)&&isFinite(m)&&(isFinite(o)||(o=f+m),isFinite(a)||(a=f-m))),(!isFinite(a)||!isFinite(s))&&(g=(this.f(r+d,n,i+d)-c)/u,isFinite(g)||(g=(c-this.f(r-d,n,i-d))/u),y=(this.f(r-d,n,i+d)-c)/u,isFinite(y)||(y=(c-this.f(r+d,n,i-d))/u),isFinite(g)&&isFinite(y)&&(isFinite(s)||(s=g-y),isFinite(a)||(a=g+y))),[s,o,a]}generateTriangles(){for(let r=0;r<12;r++){let n=Sg[r],i=[],s=0,o=fC[r],a=0,u=o[0],c=Math.abs(this.cubeVertexValue.get(u));c>a&&isFinite(c)&&(a=c);let l=o[1],p=Math.abs(this.cubeVertexValue.get(l));p>a&&isFinite(p)&&(a=p);let f=o[2],m=Math.abs(this.cubeVertexValue.get(f));m>a&&isFinite(m)&&(a=m);let g=o[3],y=Math.abs(this.cubeVertexValue.get(g));y>a&&isFinite(y)&&(a=y);let d=a*Number.EPSILON*32;if(c<=d){s|=35;let b=this.pushPositionWithGradient(...this.cubeVertex[u]);b!==void 0&&i.push(b)}if(p<=d){s|=21;let b=this.pushPositionWithGradient(...this.cubeVertex[l]);b!==void 0&&i.push(b)}if(m<=d){s|=14;let b=this.pushPositionWithGradient(...this.cubeVertex[f]);b!==void 0&&i.push(b)}if(y<=d){s|=56;let b=this.pushPositionWithGradient(...this.cubeVertex[g]);b!==void 0&&i.push(b)}if(i.length===4)continue;let h;for(let b=0;b<4;b++){let x=o[b];if(this.cubeVertexValue.get(x)>d){h=this.cubeVertex[x];break}}if(h===void 0&&this.isInequality)for(let b=0;b<6;b++){if(s>>b&1)continue;let{posNeg:x,posNaN:P}=this.cubeEdge[n[b]];if(_c(x)&&_c(P)){h=bs(this.positions.slice((x-1)*3,x*3),this.positions.slice((P-1)*3,P*3),.5);break}}if(h===void 0)for(let b=0;b<4;b++){let x=o[b];if(!isFinite(this.cubeVertexValue.get(x))){h=this.cubeVertex[x];break}}if(h===void 0&&s&&i.length>0){let b;for(let x=0;x<4;x++){let P=o[x];if(this.cubeVertexValue.get(P)<-d){b=this.cubeVertex[P];break}}if(b){let x=i[0],P=this.positions.slice((x-1)*3,x*3);h=bs(b,P,2)}}if(h!==void 0){if(this.isInequality){let b=[],x=[],P=!1;for(let E=0;E<6;E++){if(s>>E&1)continue;let{posNeg:M,posNaN:I}=this.cubeEdge[n[E]],D=_c(M),O=_c(I);D&&b.push(M),O&&x.push(I),D&&O&&(P=!0)}if(P){b.push(...i),this.pushTriangleFromCorners(x,h),this.pushTriangleFromCorners(b,h);continue}}for(let b=0;b<6;b++){if(s>>b&1)continue;let{posNeg:x,posNaN:P}=this.cubeEdge[n[b]],E=x||P;_c(E)&&i.push(E)}this.pushTriangleFromCorners(i,h)}}}pushTriangleFromCorners(r,n){if(r.length>=3){let i=r[0]-1,s=r[1]-1,o=r[2]-1;this.pushTriangle(i,s,o,n)}if(r.length==4){let i=r[0]-1,s=r[2]-1,o=r[3]-1;this.pushTriangle(i,s,o,n)}}pushTriangle(r,n,i,s){this.allNormalsFromGradient||this.fixBadNormals(r,n,i,s),this.checkWindingOrder(r,n,i)&&([n,i]=[i,n]),this.triangles.push(r,n,i)}fixBadNormals(r,n,i,s){let o=!this.normalFromGradient[r],a=!this.normalFromGradient[n],u=!this.normalFromGradient[i];if(!(o||a||u))return;let c=this.positions,l=this.normals,p=new je(c[3*r],c[3*r+1],c[3*r+2]),f=new je(c[3*n],c[3*n+1],c[3*n+2]),m=new je(c[3*i],c[3*i+1],c[3*i+2]),g=new je().subVectors(m,p),y=new je().subVectors(p,f);var d=g.cross(y);let h=new je().subVectors(p,new je(...s));d.dot(h)<0&&d.multiply(-1),d.isFinite()&&(o&&(l[3*r+0]+=d.x,l[3*r+1]+=d.y,l[3*r+2]+=d.z),a&&(l[3*n+0]+=d.x,l[3*n+1]+=d.y,l[3*n+2]+=d.z),u&&(l[3*i+0]+=d.x,l[3*i+1]+=d.y,l[3*i+2]+=d.z))}checkWindingOrder(r,n,i){let s=this.positions,o=this.normals,a=s[3*i]-s[3*r],u=s[3*i+1]-s[3*r+1],c=s[3*i+2]-s[3*r+2],l=s[3*r]-s[3*n],p=s[3*r+1]-s[3*n+1],f=s[3*r+2]-s[3*n+2],m=u*f-c*p,g=c*l-a*f,y=a*p-u*l,d=o[3*r],h=o[3*r+1],b=o[3*r+2];return m*d+g*h+y*b<0}};function Ag(e){let{triangles:t,normalDirHints:r}=e.triangulate(),{extraAttrCount:n}=e,i=e.getVertexCount(),s=new Array(i),o=new Array(i*3),a=[],u=!1,c=new Array(i*3),l=new Array(i*2),p=new Array(i*n),f=[],m=0;function g(d){let h=e.getVertex(d);if(!h)return null;let b=r[d],x=b?e.hintedNormal(d,b):e.getNormal(d);x?(c[3*m]=x[0],c[3*m+1]=x[1],c[3*m+2]=x[2]):(a[m]=!0,u=!0,c[3*m]=0,c[3*m+1]=0,c[3*m+2]=0),o[3*m]=h[0],o[3*m+1]=h[1],o[3*m+2]=h[2];let P=e.getUV(d);if(l[2*m]=P[0],l[2*m+1]=P[1],n>0)for(let E=0;E<n;E++)p[n*m+E]=e.getExtraAttr(d,E);return m++}function y(d){let h=s[d];return h===void 0?s[d]=g(d):h}for(let d=0;d<t.length;d+=3){let h=t[d],b=t[d+1],x=t[d+2],P=y(h),E=y(b),M=y(x);if(P===null||E===null||M===null)continue;f.push(P,E,M);let I=a[P],D=a[E],O=a[M];if(I||D||O){let N=o,A=c,L=new je(N[3*P],N[3*P+1],N[3*P+2]),q=new je(N[3*E],N[3*E+1],N[3*E+2]),$=new je(N[3*M],N[3*M+1],N[3*M+2]),X=new je().subVectors($,L),G=new je().subVectors(L,q),J=X.cross(G);if(!J.isFinite())continue;I&&(A[3*P+0]+=J.x,A[3*P+1]+=J.y,A[3*P+2]+=J.z),D&&(A[3*E+0]+=J.x,A[3*E+1]+=J.y,A[3*E+2]+=J.z),O&&(A[3*M+0]+=J.x,A[3*M+1]+=J.y,A[3*M+2]+=J.z)}}if(o.length=m*3,c.length=m*3,l.length=m*2,u)for(let d=0;d<m;d++){if(!a[d])continue;let h=c[3*d],b=c[3*d+1],x=c[3*d+2],P=Math.sqrt(h*h+b*b+x*x);c[3*d]=h/P,c[3*d+1]=b/P,c[3*d+2]=x/P}return pp(f,o,c,l,n,p,0),{positions:o,normals:c,faces:f,uvs:l,resolved:!0,extraAttrs:p}}var zE=class{constructor({resolution:t,uRange:r,vRange:n,du:i,dv:s,extraAttrCount:o}){this.normalDirHints=[];this.isVertexAtCreaseCache=[];this.triangles=[];this.edgeVertices=new Map;this.edgeNormalVertices=new Map;this.finiteVertices=new Map;this.resolution=t,this.uRange=r,this.vRange=n,this.du=i,this.dv=s,this.extraAttrCount=o,this.duSquared=i*i,this.dvSquared=s*s}addVertex(t){return this.normalDirHints.push(void 0),this.isVertexAtCreaseCache.push(void 0),this._addVertex(t)}jumpAlongEdge(t,r){let n=0;if(t>r){let u=t;t=r,r=u,n=1}let i=r*r+t,s=this.edgeVertices.get(i);if(s===null)return;if(s!==void 0)return[s[n],s[1-n]];let o=this.findJumpBetweenTwoSamples(t,r);if(o===void 0){this.edgeVertices.set(i,null);return}let a=[this.addVertex(o[0]),this.addVertex(o[1])];return this.edgeVertices.set(i,a),[a[n],a[1-n]]}edgeNormalFeature(t,r){let n=0;if(t>r){let u=t;t=r,r=u,n=1}let i=r*r+t,s=this.edgeNormalVertices.get(i);if(s!==void 0)return this.flipEdgeNormalFeature(s,n);let o=this.findCreaseBetweenTwoSamples(t,r),a=o===null?null:o.type===\"high-curvature\"?{type:\"high-curvature\",pos:this.addVertex(o.pos)}:{type:\"crease\",left:this.addVertex(o.left),right:this.addVertex(o.right)};return this.edgeNormalVertices.set(i,a),this.flipEdgeNormalFeature(a,n)}flipEdgeNormalFeature(t,r){return(t==null?void 0:t.type)===\"crease\"?{type:\"crease\",left:r===0?t.left:t.right,right:r===0?t.right:t.left}:t}findCreaseBetweenTwoSamples(t,r){let s=this.getUV(t),o=this.getUV(r),a=this.getNormal(t),u=this.getNormal(r),c=b=>{var P;let x=Qr(s,o,b);return(P=this.fn(x).normal)!=null?P:[NaN,NaN,NaN]};if(!a||!u)return null;let l=o[0]-s[0],p=o[1]-s[1],f=this.du,m=this.dv,g=(Math.abs(f*l)+Math.abs(m*p))/(l*l+p*p),y=iy(0,a,1,u,c,.01,2*g,.9);if(y===void 0)return null;if(typeof y==\"number\")return y<g||y>1-g?null:{type:\"high-curvature\",pos:this.fn(Qr(s,o,y))};let d=y[0],h=y[1];return d<g||h>1-g?null:(d-=g,h+=g,d<=1e-8&&(d=1e-8),h>=1-1e-8&&(h=1-1e-8),{type:\"crease\",left:this.fn(Qr(s,o,d)),right:this.fn(Qr(s,o,h))})}isVertexAtCrease(t){let r=this.isVertexAtCreaseCache[t];if(r!==void 0)return r;let n=this._isVertexAtCrease(t);return this.isVertexAtCreaseCache[t]=n,n}finiteAlongEdge(t,r){if(t>r){let a=t;t=r,r=a}let n=r*r+t,i=this.finiteVertices.get(n);if(i!==void 0)return i;let s=this.findFiniteBetweenTwoSamples(t,r);if(s===void 0)return;let o=this.addVertex(s);return this.finiteVertices.set(n,o),o}pushTriangle(t,r,n){this.isDegenerate(t,r,n)||this.triangles.push(t,r,n)}getTriangles(){return this.triangles}},FG=1e-4,VG=.99,mp=.9999;function BE(e,t){return!e||!t?!0:e[0]*t[0]+e[1]*t[1]+e[2]*t[2]<VG}var kE=class extends zE{hintVec(t,r){let n=this.getUV(t),i=this.getUV(r);return Wv(Zv(i,n),FG)}hintNormal1(t,r,n){let i=this.hintVec(t,r),s=this.hintVec(t,n);this.normalDirHints[t]=[i,s]}hintNormals2(t,r){let n=this.hintVec(t,r),i=GE(n);this.normalDirHints[t]=[Ng(n),i],this.normalDirHints[r]=[i,Ng(i)]}hintNormals2Finite(t,r){let n=this.hintVec(t,r),i=Ng(n);this.normalDirHints[t]=this.normalDirHints[r]=[i,GE(i)]}hintNormalFirstBad(t,r){let n=this.hintVec(t,r);this.normalDirHints[t]=[Ng(n),GE(n)]}hintNormalSecondBad(t,r){let n=this.hintVec(r,t);this.normalDirHints[r]=[GG(n),BG(n)]}},HE=class extends kE{oneJump(t,r,n,i){let s=i[0],o=i[1];this.pushTriangle(s,n,t),this.pushTriangle(o,r,n),this.hintNormalFirstBad(s,n),this.hintNormalSecondBad(n,o)}oneJumpOneExtra(t,r,n,i,s){let o=i[0],a=i[1];this.pushTriangle(o,n,t),this.pushTriangle(o,s,n),this.pushTriangle(a,r,s),this.hintNormalFirstBad(o,n),this.hintNormalSecondBad(n,a)}oneJumpOneExtra2(t,r,n,i,s){let o=i[0],a=i[1];this.pushTriangle(a,r,n),this.pushTriangle(a,n,s),this.pushTriangle(o,s,t),this.hintNormalFirstBad(o,n),this.hintNormalSecondBad(n,a)}oneJumpTwoExtra(t,r,n,i,s,o){let a=i[0],u=i[1];this.pushTriangle(a,o,t),this.pushTriangle(a,s,o),this.pushTriangle(s,n,o),this.pushTriangle(u,r,s)}twoJumps(t,r,n,i,s){let o=i[0],a=i[1],u=s[0],c=s[1];this.pushTriangle(o,n,t),this.pushTriangle(o,c,n),this.pushTriangle(a,r,u),this.hintNormals2(o,c),this.hintNormals2(u,a)}twoJumpsOneExtraPoint(t,r,n,i,s,o){let a=i[0],u=i[1],c=s[0],l=s[1];this.pushTriangle(a,o,t),this.pushTriangle(a,l,o),this.pushTriangle(l,n,o),this.pushTriangle(u,r,c),this.hintNormals2(a,l),this.hintNormals2(c,u)}oneExtraPoint(t,r,n,i){this.pushTriangle(i,n,t),this.pushTriangle(i,r,n)}oneExtraPointOneVertexCrease(t,r,n,i){let s=this.copyVertex(n);this.pushTriangle(i,s,t),this.pushTriangle(i,r,s),this.hintNormal1(s,t,r)}twoExtraPoints(t,r,n,i,s){this.pushTriangle(i,n,t),this.pushTriangle(i,s,n),this.pushTriangle(i,r,s)}threeExtraPoints(t,r,n,i,s,o){this.pushTriangle(i,o,t),this.pushTriangle(i,s,o),this.pushTriangle(i,r,s),this.pushTriangle(s,n,o)}oneEdgeJumpOneVertexCrease(t,r,n,i){let s=i[0],o=i[1],a=this.copyVertex(n),u=this.copyVertex(n);this.pushTriangle(s,a,t),this.pushTriangle(o,r,u),this.hintNormals2(u,o),this.hintNormals2(s,a)}threeVertexCrease(t,r,n){let i=this.copyVertex(t),s=this.copyVertex(r),o=this.copyVertex(n);this.pushTriangle(i,s,o),this.hintNormals2(i,s),this.hintNormalFirstBad(o,i)}twoVertexCrease(t,r,n){let i=this.copyVertex(t),s=this.copyVertex(r);this.pushTriangle(i,s,n),this.hintNormals2(i,s)}oneVertexCrease(t,r,n){let i=this.copyVertex(t);this.pushTriangle(i,r,n),this.hintNormal1(i,r,n)}pushTrianglesBasedOnJumps(t,r,n){let i=this.jumpAlongEdge(t,r),s=this.jumpAlongEdge(r,n),o=this.jumpAlongEdge(n,t);if(i&&s&&o){let d=this.getUV(t),h=this.getUV(r),b=this.getUV(n),x=this.addVertex(this.fn(Qr(d,Qr(h,b,.5),1e-4))),P=this.addVertex(this.fn(Qr(h,Qr(b,d,.5),1e-4))),E=this.addVertex(this.fn(Qr(b,Qr(d,h,.5),1e-4))),M=this.jumpAlongEdge(x,P),I=this.jumpAlongEdge(P,E),D=this.jumpAlongEdge(E,x);if(M&&I&&D)return;t=x,r=P,n=E,i=M,s=I,o=D}let a=this.getNormal(t),u=this.getNormal(r),c=this.getNormal(n),l=this.isVertexAtCrease(t),p=this.isVertexAtCrease(r),f=this.isVertexAtCrease(n),m,g,y;if(!l&&!p&&!i&&BE(a,u)){let d=this.edgeNormalFeature(t,r);d!==null&&(d.type===\"high-curvature\"?m=d.pos:i=[d.left,d.right])}if(!p&&!f&&!s&&BE(u,c)){let d=this.edgeNormalFeature(r,n);d!==null&&(d.type===\"high-curvature\"?g=d.pos:s=[d.left,d.right])}if(!f&&!l&&!o&&BE(c,a)){let d=this.edgeNormalFeature(n,t);d!==null&&(d.type===\"high-curvature\"?y=d.pos:o=[d.left,d.right])}i&&s?y?this.twoJumpsOneExtraPoint(t,r,n,i,s,y):this.twoJumps(t,r,n,i,s):s&&o?m?this.twoJumpsOneExtraPoint(r,n,t,s,o,m):this.twoJumps(r,n,t,s,o):o&&i?g?this.twoJumpsOneExtraPoint(n,t,r,o,i,g):this.twoJumps(n,t,r,o,i):i?f?this.oneEdgeJumpOneVertexCrease(t,r,n,i):g&&y?this.oneJumpTwoExtra(t,r,n,i,g,y):g?this.oneJumpOneExtra(t,r,n,i,g):y?this.oneJumpOneExtra2(t,r,n,i,y):this.oneJump(t,r,n,i):s?l?this.oneEdgeJumpOneVertexCrease(r,n,t,s):y&&m?this.oneJumpTwoExtra(r,n,t,s,y,m):y?this.oneJumpOneExtra(r,n,t,s,y):m?this.oneJumpOneExtra2(r,n,t,s,m):this.oneJump(r,n,t,s):o?p?this.oneEdgeJumpOneVertexCrease(n,t,r,o):m&&g?this.oneJumpTwoExtra(n,t,r,o,m,g):m?this.oneJumpOneExtra(n,t,r,o,m):g?this.oneJumpOneExtra2(n,t,r,o,g):this.oneJump(n,t,r,o):l&&p&&f?this.threeVertexCrease(t,r,n):l&&p?this.twoVertexCrease(t,r,n):p&&f?this.twoVertexCrease(r,n,t):f&&l?this.twoVertexCrease(n,t,r):l?g?this.oneExtraPointOneVertexCrease(r,n,t,g):this.oneVertexCrease(t,r,n):p?y?this.oneExtraPointOneVertexCrease(n,t,r,y):this.oneVertexCrease(r,n,t):f?m?this.oneExtraPointOneVertexCrease(t,r,n,m):this.oneVertexCrease(n,t,r):m&&g&&y?this.threeExtraPoints(t,r,n,m,g,y):m&&g?this.twoExtraPoints(t,r,n,m,g):g&&y?this.twoExtraPoints(r,n,t,g,y):y&&m?this.twoExtraPoints(n,t,r,y,m):m?this.oneExtraPoint(t,r,n,m):g?this.oneExtraPoint(r,n,t,g):y?this.oneExtraPoint(n,t,r,y):this.pushTriangle(t,r,n)}oneNonFinite(t,r,n){let i=this.finiteAlongEdge(r,n),s=this.finiteAlongEdge(t,n);s!==void 0&&i!==void 0&&(this.pushTrianglesBasedOnJumps(i,t,r),this.pushTrianglesBasedOnJumps(i,s,t),this.hintNormals2Finite(i,s))}twoNonFinite(t,r,n){let i=this.finiteAlongEdge(t,r),s=this.finiteAlongEdge(t,n);i!==void 0&&s!==void 0&&(this.pushTrianglesBasedOnJumps(t,i,s),this.hintNormals2Finite(i,s))}pushTriangles(t,r,n){let i=this.allowVertex(t),s=this.allowVertex(r),o=this.allowVertex(n);i&&s&&o?this.pushTrianglesBasedOnJumps(t,r,n):i&&s?this.oneNonFinite(t,r,n):s&&o?this.oneNonFinite(r,n,t):o&&i?this.oneNonFinite(n,t,r):i?this.twoNonFinite(t,r,n):s?this.twoNonFinite(r,n,t):o&&this.twoNonFinite(n,t,r)}},dp=class extends HE{triangulate(){let t=this.resolution,{uRange:r,vRange:n,fn:i}=this,s=[r.min,n.min],o=[r.max,n.max],a=t-1,u=new Array(t*t);u[0]=this.addVertex(i(s));for(let c=1;c<=a;c++)u[c]=this.addVertex(i(ry(s,o,[c/a,0]))),u[t*c]=this.addVertex(i(ry(s,o,[0,c/a])));for(let c=1;c<=a;c++)for(let l=1;l<=a;l++){let p=u[(l-1)*t+(c-1)],f=u[l*t+(c-1)],m=u[(l-1)*t+c],g=this.addVertex(i(ry(s,o,[c/a,l/a])));u[l*t+c]=g,(c+l)%2===0?(this.pushTriangles(p,g,f),this.pushTriangles(p,m,g)):(this.pushTriangles(p,m,f),this.pushTriangles(m,g,f))}return{triangles:this.getTriangles(),normalDirHints:this.normalDirHints}}};function BG(e){let t=e[0]*Math.SQRT1_2,r=e[1]*Math.SQRT1_2;return[t+r,r-t]}function Ng(e){let t=e[0]*Math.SQRT1_2,r=e[1]*Math.SQRT1_2;return[t-r,t+r]}function GG(e){return[e[1],-e[0]]}function GE(e){return[-e[1],e[0]]}var bC=80;var UE=class extends dp{constructor(r,n,i,s,o,a){let u=i.width/1e8,c=s.width/1e8;super({resolution:o,uRange:i,vRange:s,du:u,dv:c,extraAttrCount:a});this.vertices=[];this.fn=r=>{let n=this._fn(r),i=this.tangentInForced(r,[this.du,0],n),s=this.tangentInForced(r,[0,this.dv],n),o=_l(i,s);return{uv:r,f:n,normal:o,dfEast:i,dfNorth:s}};this._fn=l=>r(l[0],l[1]),this.xmin=n.xmin*6-n.xmax*5,this.xmax=n.xmax*6-n.xmin*5,this.ymin=n.ymin*6-n.ymax*5,this.ymax=n.ymax*6-n.ymin*5,this.zmin=n.zmin*6-n.zmax*5,this.zmax=n.zmax*6-n.zmin*5,this.distThresh=((n.xmax-n.xmin)*1e-6)**2}getVertexCount(){return this.vertices.length}getUV(r){return this.vertices[r].uv}getNormal(r){return this.vertices[r].normal}_addVertex(r){return this.vertices.push(r)-1}copyVertex(r){return this.addVertex(this.vertices[r])}getF(r){return this.vertices[r].f}getDfNorth(r){return this.vertices[r].dfNorth}getDfEast(r){return this.vertices[r].dfEast}insidePaddedDomain(r){return this.zmin<=r[2]&&r[2]<=this.zmax&&this.ymin<=r[1]&&r[1]<=this.ymax&&this.xmin<=r[0]&&r[0]<=this.xmax}tangentInForced(r,n,i){let s=bf(r,n);return uT(this._fn(s),i)}_isVertexAtCrease(r){let n=this.getUV(r),i=this.getDfEast(r),s=this.getDfNorth(r),o=this.getF(r),a=this.tangentInForced(n,[-this.du,0],o);if(cT(a,i)/Math.sqrt(Al(a)*Al(i))>-mp)return!0;let c=this.tangentInForced(n,[0,-this.dv],o);return cT(s,c)/Math.sqrt(Al(s)*Al(c))>-mp}hintedNormal(r,n){let i=this.getUV(r),s=this.getF(r),o=_l(this.tangentInForced(i,n[0],s),this.tangentInForced(i,n[1],s));return Ll(...o)?o:this.getNormal(r)}getVertex(r){if(this.allowVertex(r))return this.getF(r)}getExtraAttr(r,n){return this.vertices[r].f[3+n]}findJumpBetweenTwoSamples(r,n){let i=this.getUV(r),s=this.getF(r),o=0,a=this.getUV(n),u=this.getF(n),c=1,l=m=>this._fn(Qr(i,a,m));if(!isFinite(s[0])||!isFinite(s[1])||!isFinite(s[2])||!isFinite(u[0])||!isFinite(u[1])||!isFinite(u[2]))return;let f=iy(o,s,c,u,l,(this.xmax-this.xmin)*1e-6,0,0);if(f)return[this.fn(Qr(i,a,hs(f[0],0,1e-5))),this.fn(Qr(i,a,hs(f[1],1,1e-5)))]}clip(r){return this.insidePaddedDomain(r)?r:[NaN,NaN,NaN]}findFiniteBetweenTwoSamples(r,n){let i=this.getUV(r),s=this.getF(r),o=this.getUV(n),a=this.getF(n),u=l=>this.clip(this._fn(Qr(i,o,l))),c=ny(0,this.clip(s),1,this.clip(a),u);if(c!==void 0)return this.fn(Qr(i,o,c))}allowVertex(r){return this.insidePaddedDomain(this.getF(r))}isDegenerate(r,n,i){let s=this.getF(r),o=this.getF(n);if(Pa(s,o)<this.distThresh)return!0;let a=this.getF(i);return Pa(o,a)<this.distThresh||Pa(s,a)<this.distThresh}};function Lc(e,t,r,n,i,s){let o=new UE(e,t,r,n,i,s);return Ag(o)}var{floor:zG}=Math;function qE(e){let t=[];for(let r of e)t.push(...r),t.push(NaN,NaN,NaN);return t}function wc(e,t,r,n){(r===void 0||isNaN(r))&&(r=YE(t.min,t.max)),r=on(zG(r),2,2e3);let{xmin:i,xmax:s,ymin:o,ymax:a,zmin:u,zmax:c}=n.viewport;u!=null||(u=mn.zmin),c!=null||(c=mn.zmax);let l=Lg(e,{min:t.min,max:t.max,nInitialSamples:r,xtolerance:(s-i)/1e3,ytolerance:(a-o)/1e3,ztolerance:(c-u)/1e3,map:p=>p});return qE(l.segments)}function _g(e,t,r,n){let i=n.degreeMode?Math.PI/180:1;return wc(s=>{let o=e(s),a=o[0],u=o[1],c=o[2];return[a*hr(u*i),a*tr(u*i),c]},t,r,n)}function $E(e,t,r,n){let i=n.degreeMode?Math.PI/180:1;return wc(s=>{let o=e(s),a=o[0],u=o[1],c=o[2];return[a*tr(c*i)*hr(u*i),a*tr(c*i)*tr(u*i),a*hr(c*i)]},t,r,n)}function XE(e,t){return{type:\"linear\",s:e,t}}function xC(e,t){return{type:\"logarithmic\",s:e,t}}function PC(e,t){return{type:\"exponential\",s:e,t}}function ZE(){return XE(1,0)}function kG([e,t],[r,n]){let i=(n-r)/(t-e),s=(r+n)/2-i*(t+e)/2;return XE(i,s)}function HG([e,t],[r,n]){let i=(n-r)/(Math.log(t)-Math.log(e)),s=(Math.log(t)*r-Math.log(e)*n)/(Math.log(t)-Math.log(e));return xC(i,s)}function UG([e,t],[r,n]){let i=(Math.log(n)-Math.log(r))/(t-e),s=(t*Math.log(r)-e*Math.log(n))/(t-e);return PC(i,s)}function WE(e,t,r){switch(e){case\"linear\":return kG(t,r);case\"logarithmic\":return HG(t,r);case\"exponential\":return UG(t,r);default:{let n=e;throw new Error(\"Unexpected scale type: \"+n)}}}function jE({type:e,s:t,t:r},n){switch(e){case\"linear\":return t*n+r;case\"logarithmic\":return t*Math.log(n)+r;case\"exponential\":return Math.exp(t*n+r);default:let i=e;throw new Error(\"Unexpected scale type: \"+i)}}function JE(e,t,r,n){switch(e){case\"linear\":return qG(t,r,n);case\"logarithmic\":return Math.pow(t,1-n)*Math.pow(r,n);case\"exponential\":return n===0?t:n===1?r:Math.log((1-n)*Math.exp(t)+n*Math.exp(r));default:let i=e;throw new Error(\"Unexpected scale type: \"+i)}}function qG(e,t,r){return(1-r)*e+r*t}function QE({type:e,s:t,t:r}){switch(e){case\"linear\":return XE(1/t,-r/t);case\"logarithmic\":return PC(1/t,-r/t);case\"exponential\":return xC(1/t,-r/t);default:let n=e;throw new Error(\"Unexpected scale type: \"+n)}}function KE(e){switch(e){case\"linear\":return\"linear\";case\"logarithmic\":return\"exponential\";case\"exponential\":return\"logarithmic\";default:let t=e;throw new Error(\"Unexpected scale type: \"+t)}}function wg({width:e,height:t}){return{left:0,right:e,top:0,bottom:t}}function Fg({xmin:e,xmax:t,ymin:r,ymax:n}){return{left:e,right:t,bottom:r,top:n}}var Cu=class e{constructor(t,r){this.xScale=t,this.yScale=r}static fromRects(t,r,{xAxisScale:n,yAxisScale:i}){return new e(WE(n,[t.left,t.right],[r.left,r.right]),WE(i,[t.bottom,t.top],[r.bottom,r.top]))}static fromRectsInverse(t,r,{xAxisScale:n,yAxisScale:i}){return e.fromRects(r,t,{xAxisScale:KE(n),yAxisScale:KE(i)})}inverse(){return new e(QE(this.xScale),QE(this.yScale))}mapX(t){return jE(this.xScale,t)}mapY(t){return jE(this.yScale,t)}mapPoint({x:t,y:r}){return{x:this.mapX(t),y:this.mapY(r)}}mapCoordinatePair([t,r]){return[this.mapX(t),this.mapY(r)]}mapRect({top:t,bottom:r,left:n,right:i}){return{left:this.mapX(n),right:this.mapX(i),bottom:this.mapY(r),top:this.mapY(t)}}interpolateX(t,r,n){return JE(this.xScale.type,t,r,n)}interpolateY(t,r,n){return JE(this.yScale.type,t,r,n)}dangerouslyGetXScaleFactor(){if(this.xScale.type!==\"linear\")throw new Error(`Cannot get scale factor a '${this.xScale.type}' scale`);return this.xScale.s}dangerouslyGetYScaleFactor(){if(this.yScale.type!==\"linear\")throw new Error(`Cannot get scale factor a '${this.yScale.type}' scale`);return this.yScale.s}};var e0=class extends dp{constructor(r,n,i,s,o,a=[0,1,2]){let u=n.width/1e8,c=i.width/1e8;super({resolution:o,uRange:n,vRange:i,du:u,dv:c,extraAttrCount:0});this.vertices=[];this.fn=r=>{let n=this._fn(r),i=this.tangentInForcedDf(r,[this.du,0],n),s=this.tangentInForcedDf(r,[0,this.dv],n),o=_l([this.du,0,i],[0,this.dv,s]);return{uv:r,f:n,normal:[o[this.perm0],o[this.perm1],o[this.perm2]],dfEast:i,dfNorth:s}};this._fn=l=>r(l[0],l[1]),this.paddedOutputDomain=new ie(s.min-5*s.width,s.max+5*s.width),this.jumpTolerance=s.width/1e3,this.perm0=a[0],this.perm1=a[1],this.perm2=a[2]}getVertexCount(){return this.vertices.length}getUV(r){return this.vertices[r].uv}getNormal(r){return this.vertices[r].normal}_addVertex(r){return this.vertices.push(r)-1}copyVertex(r){return this.addVertex(this.vertices[r])}getF(r){return this.vertices[r].f}getDfNorth(r){return this.vertices[r].dfNorth}getDfEast(r){return this.vertices[r].dfEast}tangentInForcedDf(r,n,i){let s=bf(r,n);return this._fn(s)-i}tangentInForced(r,n,i){let s=bf(r,n);return[n[0],n[1],this._fn(s)-i]}getExtraAttr(){throw new Error(\"Unexpected getExtraAttr call in explicit-surface.ts\")}_isVertexAtCrease(r){let n=this.getUV(r),i=this.getDfEast(r),s=this.getDfNorth(r),o=this.getF(r),a=this.tangentInForcedDf(n,[-this.du,0],o);if((-this.duSquared+a*i)/Math.sqrt((this.duSquared+a*a)*(this.duSquared+i*i))>-mp)return!0;let l=this.tangentInForcedDf(n,[0,-this.dv],o);return(-this.dvSquared+s*l)/Math.sqrt((this.dvSquared+s*s)*(this.dvSquared+l*l))>-mp}hintedNormal(r,n){let i=this.getUV(r),s=this.getF(r),o=_l(this.tangentInForced(i,n[0],s),this.tangentInForced(i,n[1],s));return Ll(...o)?[o[this.perm0],o[this.perm1],o[this.perm2]]:this.getNormal(r)}getVertex(r){if(!this.allowVertex(r))return;let n=this.getF(r),i=this.getUV(r);return[this.perm0===2?n:i[this.perm0],this.perm1===2?n:i[this.perm1],this.perm2===2?n:i[this.perm2]]}findJumpBetweenTwoSamples(r,n){let i=this.getUV(r),s=this.getF(r),o=0,a=this.getUV(n),u=this.getF(n),c=1,l=f=>this._fn(Qr(i,a,f));if(!isFinite(s)||!isFinite(u))return;let p=aD(o,s,c,u,l,this.jumpTolerance);if(p)return[this.fn(Qr(i,a,hs(p[0],0,1e-5))),this.fn(Qr(i,a,hs(p[1],1,1e-5)))]}findFiniteBetweenTwoSamples(r,n){let i=this.getUV(r),s=this.getF(r),o=this.getUV(n),a=this.getF(n),u=p=>{let f=this._fn(p);return f<this.paddedOutputDomain.min||f>this.paddedOutputDomain.max?NaN:f},c=p=>u(Qr(i,o,p)),l=si(0,this.paddedOutputDomain.min<s&&s<this.paddedOutputDomain.max?s:NaN,1,this.paddedOutputDomain.min<a&&a<this.paddedOutputDomain.max?a:NaN,c);if(l!==void 0)return this.fn(Qr(i,o,l))}allowVertex(r){let n=this.getF(r);return this.paddedOutputDomain.min<n&&n<this.paddedOutputDomain.max}isDegenerate(r,n,i){let s=this.getUV(r),o=this.getUV(n),a=this.getUV(i),u=this.uRange.width*1e-6,c=this.vRange.width*1e-6;return Math.abs(s[0]-o[0])<u&&Math.abs(s[1]-o[1])<c||Math.abs(o[0]-a[0])<u&&Math.abs(o[1]-a[1])<c||Math.abs(a[0]-s[0])<u&&Math.abs(a[1]-s[1])<c}};function Vg(e,t,r,n,i,s=[0,1,2]){let o=new e0(e,t,r,n,i,s);return Ag(o)}function vC(e,t,r,n){let i=YG(e,t,r,n);return qE(i)}function YG(e,t,r,n){return new i0(e,t,new ie(r.xmin,r.xmax),new ie(r.ymin,r.ymax),new ie(r.zmin,r.zmax),n).run()}var XG={},i0=class extends fp{constructor(r,n,i,s,o,a){super(Cg,i,s,o,a);this.f=r;this.g=n;this.vertexFGZs={};this.vertexZeroF={};this.vertexZeroG={};this.threshF=0;this.threshG=0;this.cubeID=0;this.edgesMaybeCrossF=0;this.edgesMaybeCrossG=0;this.tetEdgeCrossings=new Array(26);this.edgeFGZs=new Array(26);this.edgeCrossings=new Map;this.allFGZs=new Map}setAt(r,n,i,s,o){let a=this.f(i,s,o),u=this.g(i,s,o);r.set(n,a,u)}run(){return this.loopOverUnitCubes(this.onEachCube.bind(this)),this.traceCurves()}onEachCube(){this.cubeID=yC(this.i,this.j,this.k),this.pruneEdges(),this.edgesMaybeCrossF&&this.edgesMaybeCrossG&&(this.setVertexPositions(),this.setVertexZeros(),this.setEdgeCrossings(),this.insertCurveSegmentsFromCube())}pruneEdges(){this.edgesMaybeCrossF=0,this.edgesMaybeCrossG=0;for(let r=0;r<26;r++){let n=Dn[r*2],i=Dn[r*2+1],s=this.cubeVertexValue.getX(n),o=this.cubeVertexValue.getY(n),a=this.cubeVertexValue.getX(i),u=this.cubeVertexValue.getY(i);!(s>0&&a>0||s<0&&a<0)&&(isFinite(s)||isFinite(a))&&(this.edgesMaybeCrossF|=1<<r),!(o>0&&u>0||o<0&&u<0)&&(isFinite(o)||isFinite(u))&&(this.edgesMaybeCrossG|=1<<r)}}setVertexZeros(){let r=0,n=0;for(let o=0;o<9;o++){let a=this.cubeVertexValue.getX(o),u=this.cubeVertexValue.getY(o),c=Math.abs(a),l=Math.abs(u);c>r&&isFinite(c)&&(r=c),l>n&&isFinite(c)&&(n=l)}let i=this.threshF=r*Number.EPSILON*32,s=this.threshG=n*Number.EPSILON*32;for(let o=0;o<9;o++){let a=this.cubeVertexValue.getX(o),u=this.cubeVertexValue.getY(o),c=Math.abs(a),l=Math.abs(u);if(this.vertexZeroF[o]=c<=i,this.vertexZeroG[o]=l<=s,c<=i&&l<=s){let p=this.cubeVertex[o],f=this.createFGZ(gC(this.cubeID,o),p);this.vertexFGZs[o]=f}else this.vertexFGZs[o]=void 0}}getEdgeCrossings(r){let n=this.edgesMaybeCrossF>>r&1,i=this.edgesMaybeCrossG>>r&1;if(!n&&!i)return XG;let s=id(this.cubeID,r),o=this.edgeCrossings.get(s);if(o!==void 0)return o;let a=this.getEdgeCrossingsUncached(r,n,i);return this.edgeCrossings.set(s,a),a}getEdgeCrossingsUncached(r,n,i){let s=Dn[r*2],o=Dn[r*2+1],a=this.cubeVertexValue.getX(s),u=this.cubeVertexValue.getY(s),c=this.cubeVertexValue.getX(o),l=this.cubeVertexValue.getY(o),p=this.cubeVertex[s],f=this.cubeVertex[o],m=!n||a===0||c===0?void 0:nd(this.f,p,f,a,c),g=!i||u===0||l===0?void 0:nd(this.g,p,f,u,l),y=this.threshF;!m&&g&&Math.abs(a)<=y&&Math.abs(c)<=y&&Math.abs(this.f(g[0],g[1],g[2]))<=y&&(m=g);let d=this.threshG;return!g&&m&&Math.abs(u)<=d&&Math.abs(l)<=d&&Math.abs(this.g(m[0],m[1],m[2]))<=d&&(g=m),{f:m,g}}getTriangleCrossing(r){let n=wE(this.cubeID,r),i=this.allFGZs.get(n);if(i!==void 0)return i;let s=this.getTriangleCrossingUncached(r);return this.allFGZs.set(n,s),s}createFGZ(r,n){let i=this.allFGZs.get(r);if(i)return i;let s={id:r,pos:n,connections:[],visited:!1};return this.allFGZs.set(r,s),s}getTriangleCrossingUncached(r){let n=[],i=[],s=LE[r];for(let a=0;a<3;a++){let u=s[a];if(this.vertexFGZs[u])return null;this.vertexZeroF[u]&&n.push(this.cubeVertex[u]),this.vertexZeroG[u]&&i.push(this.cubeVertex[u])}let o=_E[r];for(let a=0;a<3;a++){let u=o[a],c=this.tetEdgeCrossings[u];if(this.edgeFGZs[u]||!c)continue;let l=c.f,p=c.g,f=Dn[2*u],m=Dn[2*u+1];l&&!this.vertexZeroF[f]&&!this.vertexZeroF[m]&&n.push(l),p&&!this.vertexZeroG[f]&&!this.vertexZeroG[m]&&i.push(p)}if(n.length===2&&i.length===2){let a=ZG(n[0],n[1],i[0],i[1]);return a?{id:wE(this.cubeID,r),pos:a,connections:[],visited:!1}:null}else return null}setEdgeCrossings(){for(let r=0;r<26;r++){let n=this.getEdgeCrossings(r),i=n.f,s=n.g,o=Dn[r*2],a=Dn[r*2+1];if(this.vertexFGZs[o]||this.vertexFGZs[a])this.tetEdgeCrossings[r]=void 0,this.edgeFGZs[r]=void 0;else if(i&&this.vertexZeroG[o]&&this.vertexZeroG[a]){let u=this.createFGZ(id(this.cubeID,r),i);this.edgeFGZs[r]=u,this.tetEdgeCrossings[r]=void 0}else if(s&&this.vertexZeroF[o]&&this.vertexZeroF[a]){let u=this.createFGZ(id(this.cubeID,r),s);this.edgeFGZs[r]=u,this.tetEdgeCrossings[r]=void 0}else if(i&&s&&Pa(i,s)<1e-8){let u=this.createFGZ(id(this.cubeID,r),i);this.edgeFGZs[r]=u,this.tetEdgeCrossings[r]=void 0}else this.edgeFGZs[r]=void 0,this.tetEdgeCrossings[r]=n}}insertCurveSegmentsFromCube(){for(let r=0;r<12;r++)this.insertCurveSegmentsFromTetrahedron(r)}insertCurveSegmentsFromTetrahedron(r){let n=[],i=mC[r];for(let l=0;l<4;l++){let p=this.getTriangleCrossing(i[l]);p&&n.push(p)}let s=[],o=Sg[r];for(let l=0;l<6;l++){let p=this.edgeFGZs[o[l]];p&&s.push(p)}let a=[],u=[Dn[o[0]*2],Dn[o[0]*2+1],Dn[o[3]*2],Dn[o[3]*2+1]];for(let l of u){let p=this.vertexFGZs[l];p&&a.push(p)}let c=[...a,...s,...n];switch(c.length){case 0:case 1:break;case 2:this.connectCrossings(c[0],c[1]);break;case 3:n.length===2&&this.connectCrossings(n[0],n[1]);break;case 4:n.length===4&&(this.connectCrossings(n[0],n[1]),this.connectCrossings(n[2],n[3]));break;default:throw new Error(\"Programming error: 5 is impossible.\")}}connectCrossings(r,n){r.connections.some(i=>i.id===n.id)||n.connections.some(i=>i.id===r.id)||r.connections.length>=2||n.connections.length>=2||(r.connections.push(n),n.connections.push(r))}traceCurves(){let r={xtolerance:this.size.x*.1,ytolerance:this.size.y*.1,ztolerance:this.size.z*.1,map:i=>i},n=new Is(r);for(let i of this.allFGZs.values())i&&!i.visited&&i.connections.length===1&&this.traceCurve(n,i);for(let i of this.allFGZs.values())i&&!i.visited&&this.traceCurve(n,i);return n.finish().segments}traceCurve(r,n){let i=n;for(;;){r.addPoint(n.pos),n.visited=!0;let s;for(let o of n.connections)o.visited||(s=o);if(!s)break;n=s}i.connections.length===2&&r.addPoint(i.pos),r.breakSegment()}},[Bg,TC,t0]=[new je,new je,new je],IC=new je,[r0,n0,EC]=[new je,new je,new je],[Gg,MC,zg]=[new je,new je,new je];function ZG(e,t,r,n){Bg.set(e[0],e[1],e[2]),TC.set(t[0],t[1],t[2]),t0.set(r[0],r[1],r[2]),IC.set(n[0],n[1],n[2]),r0.subVectors(TC,Bg),n0.subVectors(IC,t0),EC.subVectors(t0,Bg),Gg.crossVectors(r0,n0),MC.crossVectors(EC,n0);let i=Gg.dot(MC)/Gg.dot(Gg);return 0<=i&&i<=1?(zg.addVectors(Bg,r0.multiply(i)),[zg.x,zg.y,zg.z]):null}function kg(e,t,r,n){let i=[],s=[],o=[],a=[],{xmin:u,xmax:c,ymin:l,ymax:p,zmin:f,zmax:m}=r,g,y,d;switch(n){case\"z\":g={xmin:u,xmax:c,ymin:l,ymax:p},y=(P,E)=>[P[E],P[E+1],f,P[E],P[E+1],m],d=(P,E)=>e(P,E,0);break;case\"y\":g={xmin:u,xmax:c,ymin:f,ymax:m},y=(P,E)=>[P[E],l,P[E+1],P[E],p,P[E+1]],d=(P,E)=>e(P,0,E);break;case\"x\":g={xmin:f,xmax:m,ymin:l,ymax:p},y=(P,E)=>[u,P[E+1],P[E],c,P[E+1],P[E]],d=(P,E)=>e(0,E,P);break}let h=wg({width:500,height:500}),b={...g,mathToPixels:Cu.fromRects(Fg(g),h,{xAxisScale:\"linear\",yAxisScale:\"linear\"}),tolerance:Js},x=td(d,b);for(let P of x.segments)for(let E=0;E<P.length/2;E++){let[M,I,D,O,N,A]=y(P,2*E);if(i.push(M,I,D,O,N,A),o.push(M,I,O,N),t){let L=t(M,I,D),q=t(O,N,A);s.push(L[0],L[1],L[2]),s.push(q[0],q[1],q[2])}else s.push(0,0,0),s.push(0,0,0);if(E>0){let L=i.length/3-4;a.push(L,L+1,L+2),a.push(L+2,L+1,L+3)}}return pp(a,i,s,o,0,[],.7),{positions:i,normals:s,faces:a,uvs:o,resolved:x.resolved,extraAttrs:[]}}var{floor:DC}=Math,SC=1e4,Hg=5,OC=(e,t,r)=>({x:e,y:t,z:r}),RC=(e,t,r)=>({x:r,y:e,z:t}),CC=(e,t,r)=>({x:e,y:r,z:t}),Ug=class{constructor(){this.xmin=mn.xmin;this.xmax=mn.xmax;this.ymin=mn.ymin;this.ymax=mn.ymax;this.zmin=mn.zmin;this.zmax=mn.zmax}},WG=0;function di(){return\"result_\"+WG++}function jG(){return{zeros:{x:[],y:[]},extrema:{x:[],y:[]},intercept:{x:[],y:[]}}}function wC(e){return{graphMode:15,error:e,segments:[]}}function o0(e,t){let r=e[0]+t.min*e[1],n=e[0]+t.max*e[1],i={zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}};if(!isFinite(r)||!isFinite(n))return{segments:[],poi:i,resolved:!0};let s=[[t.min,r,t.max,n]],o=-e[0]/e[1];return!isNaN(o)&&o>=t.min&&o<=t.max&&(i.zeros.x.push(o),i.zeros.y.push(0)),0>=t.min&&0<=t.max&&(i.intercept.x.push(0),i.intercept.y.push(e[0])),{segments:s,poi:i,resolved:!0}}function JG(e,t){let r=o0(e[0],t),n=o0(e[1],t);return r.segments.length&&n.segments.length&&r.segments[0].length===4&&n.segments[0].length===4?{segments:[[r.segments[0][1],n.segments[0][1],r.segments[0][3],n.segments[0][3]]],resolved:!0}:{segments:[],resolved:!0}}function QG(e,t){let r=e(t);return{segments:[[...r,...r]],resolved:!0}}function NC(e,t,r){let{mappedFn:n,jumpTolerance:i,screen:s}=r,[o,a]=e,[u,c]=t,l=da(o,u),p=n(l),f=s.height;if(!(a<0&&c<0&&(a>=p||c>=p))&&!(a>f&&c>f&&(a<=p||c<=p)))return wl(o,a,l,p,u,c,n,i)}var s0=(e,t,r)=>{let{fn:n,mappedFn:i,jumpTolerance:s,accumulator:o}=r;if(!isFinite(s)||s<=0)return;let a=NC(e,t,r);if(!a)return;let u=(t[0]-e[0])/10,c=[-u,u],l;for(let p=0;p<c.length;p++){let f=e[0]+c[p],m=i(f);isFinite(m)||([f,m]=e,f=e[0],m=e[1]);let g=t[0]+c[p],y=i(g);if(isFinite(y)?l=g:[g,y]=t,NC([f,m],[g,y],r)){let[d,h]=a;o.addPoint([d,n(d)]),o.breakSegment(),o.addPoint([h,n(h)]);return}}return l},a0=class{constructor(t,r,n){let i=s=>r.mathToPixels.mapY(t(s));this.derivative=n,this.accumulator=new rd(r,t,n),this.fn=t,this.mathToPixels=r.mathToPixels,this.mappedFn=i,this.jumpTolerance=r.tolerance||0,this.screen=r.screen}};function AC(e,t,r,n){let i=r,s=e(i),o=t.mapY(s);return n>0&&!isFinite(o)&&(i=r+n,s=e(i),o=t.mapY(s)),n>0&&!isFinite(o)&&(i=r-n,s=e(i),o=t.mapY(s)),[i,s,o]}function c0(e,t,r){let n=new a0(e,t,r),{mathToPixels:i,mappedFn:s}=n,o=t.nInitialSamples,[a,u,c]=AC(e,i,t.min,0);isFinite(c)&&n.accumulator.addPoint([a,u]);for(var l=1;l<o;l++){let p=i.interpolateX(t.min,t.max,l/(o-1)),f=l===o-1?0:Math.abs(a-p)/10,[m,g,y]=AC(e,i,p,f);if(isFinite(y)&&isFinite(c)){let d=s0([a,c],[m,y],n);d!==void 0&&(m=d,g=e(m),y=i.mapY(g)),n.accumulator.addPoint([m,g])}else if(isFinite(y)&&!isFinite(c)){let d=si(a,c,m,y,s);if(d!==void 0){d!==m&&n.accumulator.addPoint([d,e(d)]);let h=s0([d,s(d)],[m,y],n);h!==void 0&&(m=h,g=e(m),y=i.mapY(g)),n.accumulator.addPoint([m,g])}}else if(!isFinite(y)&&isFinite(c)){let d=si(a,c,m,y,s);if(d!==void 0){let h=s0([a,c],[d,s(d)],n);h!==void 0&&(d=h),d!==a&&n.accumulator.addPoint([d,e(d)]),n.accumulator.breakSegment()}}a=m,u=g,c=y}return n.accumulator.finish()}function KG(e){let{fn:t,min:r,max:n}=e,i=Math.floor(r),s=Math.ceil(n),o=!0;s-i+1>SC&&(s=i+(SC-1),o=!1);let a=[];for(let u=i;u<=s;u++){let c=t(u);!isFinite(u)||!isFinite(c)||a.push([u,c])}return{segments:a,resolved:o}}function e2(e,t,r,n){let i=t.min,s=t.max-t.min,o=t.rtoleranceMath,a=Math.floor(s/(Math.PI/r)),u,c,l;function p(f,m){let g=m%2===0?1:-1;if(!n&&g===-1)return!1;let y=m*(Math.PI/r),d=[i,i+1,i+2,i+3],h=!1;for(let b=0,x=d.length;b<x;b++){let P=f(d[b]),E=f(d[b]+y);if(isFinite(P)&&isFinite(E)&&(h=!0),isFinite(P)!==isFinite(E)||Math.abs(P-g*E)>o)return!1}return!!h}for(u=1;u<=a;u++)if(p(e,u)){for(l=u,c=2;c*u<=a;c++)p(e,c*u)||(l=void 0);if(l)break}return l?l*(Math.PI/r):null}function FC(e){return[e[1]*Math.cos(e[0]),e[1]*Math.sin(e[0])]}function Lg(e,t){if(t.max<t.min)return{segments:[],resolved:!0};if(t.parameterTransform){let p=t.parameterTransform,f=e;e=m=>f(p(m))}let{xtolerance:r,ytolerance:n,ztolerance:i,map:s}=t,o=new Is({xtolerance:r,ytolerance:n,ztolerance:i,map:s}),a=10,u=t.min,c=e(u);isFinite(c[0])&&isFinite(c[1])&&o.addPoint(c);let l=t.nInitialSamples;for(let p=1;p<l;p++){let f=p/(l-1),m=(1-f)*t.min+f*t.max,g=e(m);ad(e,u,c,m,g,a,o,t.screen),u=m,c=g}return o.finish()}function t2(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function ad(e,t,r,n,i,s,o,a){if(n===t)return;let{xtolerance:u,ytolerance:c,ztolerance:l,map:p}=o,f=da(t,n),m=e(f),g=p(r),y=p(i),d=p(m),h=isFinite(g[0])&&isFinite(g[1])&&(g.length===2||isFinite(g[2])),b=isFinite(y[0])&&isFinite(y[1])&&(y.length===2||isFinite(y[2])),x=isFinite(d[0])&&isFinite(d[1])&&(d.length===2||isFinite(d[2]));if(s===0||f===t||f===n){o.breakSegment(),b&&o.addPoint(i);return}if(!(!h&&!b)){if(h!==b){let P=t,E=n,M=r,I=i;for(;t!==f&&f!==n;)x==h?(t=f,r=m,g=d,h=x):(n=f,i=m,y=d,b=x),f=t+(n-t)/2,m=e(f),d=p(m),x=isFinite(d[0])&&isFinite(d[1])&&(d.length===2||isFinite(d[2]));h?(ad(e,P,M,t,r,s-1,o,a),o.breakSegment()):(o.breakSegment(),o.addPoint(i),ad(e,n,i,E,I,s-1,o,a));return}if(h&&x&&b){let P=t2(g,y),E=Ls(d[0],d[1],d[2]||0,g[0],g[1],g[2]||0,y[0],y[1],y[2]||0),M=E>.2&&E<.8&&Math.abs(d[0]-(g[0]+E*(y[0]-g[0])))<=u&&Math.abs(d[1]-(g[1]+E*(y[1]-g[1])))<=c&&(g.length===2||Math.abs(d[2]-(g[2]+E*(y[2]-g[2])))<=l);if(P||M||a&&r2(g,d,y,a)){o.addPoint(i);return}}ad(e,t,r,f,m,s-1,o,a),ad(e,f,m,n,i,s-1,o,a)}}function r2(e,t,r,{width:n,height:i}){return e[0]<0&&r[0]<0&&(e[0]>=t[0]||r[0]>=t[0])||e[0]>n&&r[0]>n&&(e[0]<=t[0]||r[0]<=t[0])||e[1]<0&&r[1]<0&&(e[1]>=t[1]||r[1]>=t[1])||e[1]>i&&r[1]>i&&(e[1]<=t[1]||r[1]<=t[1])}function n2(){return Zi({positions:[],normals:[],faces:[],uvs:[],resolved:!0,extraAttrs:[]})}function l0(e,t,r,n,i,{isInequality:s}){let o=e.fn,a;return t&&!t.includes(\"z\")?a=kg(o,r,n,\"z\"):t&&!t.includes(\"x\")?a=kg(o,r,n,\"x\"):t&&!t.includes(\"y\")?a=kg(o,r,n,\"y\"):a=hC(o,r,n,i,{isInequality:s}),Zi(a)}function _C(e,t,r,n,i){let s=Lc(e,t,r,n,i,0);return Zi(s)}function i2(e,t,r,n,i,s){let o=s?Math.PI/180:1,a=e.fn,u=Lc((c,l)=>{let[p,f,m]=a(c,l);return[p*hr(f*o),p*tr(f*o),m,p,f]},t,r,n,i,2);return Zi(u)}function s2(e,t,r,n,i,s){let o=s?Math.PI/180:1,a=e.fn,u=Lc((c,l)=>{let[p,f,m]=a(c,l);return[p*tr(m*o)*hr(f*o),p*tr(m*o)*tr(f*o),p*hr(m*o),p,f,m]},t,r,n,i,3);return Zi(u)}function o2(e,t,r){let n=e.fn,i=Vg((s,o)=>n(s,o),new ie(t.xmin,t.xmax),new ie(t.ymin,t.ymax),new ie(t.zmin,t.zmax),r);return Zi(i)}function a2(e,t,r){let n=e.fn,i=Vg((s,o)=>n(s,o),new ie(t.ymin,t.ymax),new ie(t.zmin,t.zmax),new ie(t.xmin,t.xmax),r,[2,0,1]);return Zi(i)}function u2(e,t,r){let n=e.fn,i=Vg((s,o)=>n(o,s),new ie(t.zmin,t.zmax),new ie(t.xmin,t.xmax),new ie(t.ymin,t.ymax),r,[1,2,0]);return Zi(i)}function c2(e,t,r,n,i,s){let o=s?Math.PI/180:1,a=e.fn,u=Lc((c,l)=>[c*hr(l*o),c*tr(l*o),a(c,l)],t,r,n,i,0);return Zi(u)}function l2(e,t,r,n,i,s){let o=s?Math.PI/180:1,a=e.fn,u=Lc((c,l)=>{let p=a(c,l);return[p*hr(c*o),p*tr(c*o),l,p]},t,r,n,i,1);return Zi(u)}function p2(e,t,r,n,i,s){let o=s?Math.PI/180:1,a=e.fn,u=Lc((c,l)=>{let p=a(c,l);return[p*tr(l*o)*hr(c*o),p*tr(l*o)*tr(c*o),p*hr(l*o),p]},t,r,n,i,1);return Zi(u)}function Zi(e){let{positions:t,normals:r,faces:n,uvs:i,extraAttrs:s,resolved:o}=e;return{guid:di(),positions:new Float32Array(t),normals:new Float32Array(r),faces:new Uint32Array(n),uvs:new Float32Array(i),resolved:o,extraAttrs:new Float32Array(s)}}function LC(e){for(let t of e)if(t!==0)return!1;return!0}function VC(e,t){let{min:r,max:n,mathToPixels:i,nInitialSamples:s}=t,o=i.interpolateX(r,n,0),a=e(o),u=LC(a),c=!1,l=[];for(var p=1;p<s;p++){let f=i.interpolateX(r,n,p/(s-1)),m=e(f),g=LC(m);if(u){o=f,a=m,g||(u=!1);continue}if(g){c?(u=!0,c=!1):c=!0;continue}let y=sD(o,a,f,m,e);y!==void 0&&l.push(y),o=f,a=m}return l}function BC(e){if(!e)return!1;let t=e.viewport.xmin,r=e.viewport.xmax,n=e.viewport.ymin,i=e.viewport.ymax;return!(!isFinite(t)||!isFinite(r)||r<=t||!isFinite(n)||!isFinite(i)||i<=n||!isFinite(e.screen.width)||e.screen.width<=0||!isFinite(e.screen.height)||e.screen.height<=0)}function YE(e,t){let r=t-e;return 1+Math.ceil(r/(r/1e3))}var Js=.001,Nu=new Cu(ZE(),ZE());function yp(e,t,r){var q,$,X,G,J,w,Z,te,z;let{viewport:n,screen:i,xAxisScale:s,yAxisScale:o,degreeMode:a}=e,u=a?Math.PI/180:1,c=e.viewport.xmin,l=e.viewport.xmax,p=e.viewport.ymin,f=e.viewport.ymax,m=(q=e.viewport.zmin)!=null?q:mn.zmin,g=($=e.viewport.zmax)!=null?$:mn.zmax,y=((X=t.domain)==null?void 0:X.type)===\"2d\",{uMin:d,uMax:h,vMin:b,vMax:x}=((G=t.domain)==null?void 0:G.type)===\"2d\"?t.domain:{uMin:0,uMax:1,vMin:0,vMax:1};var P=t.lineWidth;if(t.willConvertTo3D||P>3){let oe=t.willConvertTo3D?200:e.screen.width;var E=P*(l-c)/oe;let re=t.willConvertTo3D?200:e.screen.height;var M=P*(f-p)/re;c-=E,l+=E,p-=M,f+=M}let D=1/4,O=t.domainBound,N,A=Cu.fromRects(Fg(n),wg(i),{xAxisScale:s,yAxisScale:o}),L={xmin:c,xmax:l,ymin:p,ymax:f,zmin:m,zmax:g};switch(t.graphMode){case 1:switch(N=Mr(Ji([p,f]),O),N.type){case\"empty\":return!1;case\"interval\":p=N.bounds[0],f=N.bounds[1]}let oe=Math.max(Hg,1+Math.ceil(Math.abs(A.mapY(f)-A.mapY(p))/D)),re=new Cu(A.yScale,A.xScale);return{min:p,max:f,tolerance:D,nInitialSamples:oe,mathToPixels:re,screen:{width:i.height,height:i.width}};case 2:{switch(N=Mr(Ji([c,l]),O),N.type){case\"empty\":return!1;case\"interval\":c=N.bounds[0],l=N.bounds[1]}let me=Math.max(Hg,1+Math.ceil(Math.abs(A.mapX(l)-A.mapX(c))/D));return{min:c,max:l,tolerance:D,nInitialSamples:me,mathToPixels:A,screen:i}}case 6:{let me=e.degreeMode?Math.PI/180:1;if(((J=t.domain)==null?void 0:J.type)!==\"1d\")throw new Error(\"Expected polar graph to have domain\");let{min:ye,max:De}=t.domain;switch(N=Mr(Ji([ye,De]),O),N.type){case\"empty\":return!1;case\"interval\":ye=N.bounds[0],De=N.bounds[1]}let K=Math.max(Hg,1+Math.min(Math.ceil(me*Math.abs(De-ye)/(2*Math.PI)*1e3),12e3)),H=Math.abs(A.mapX(l)-A.mapX(c)),xe=Math.abs(A.mapY(f)-A.mapY(p)),ge=Math.hypot(H,xe),ae=Math.hypot(l-c,f-p)/ge,He={min:ye,max:De,screen:i,nInitialSamples:K,xtolerance:D,ytolerance:D,rtoleranceMath:ae,map:([Pe,ue])=>A.mapCoordinatePair(FC([Pe,ue]))};if(!t.domain.isExplicit){let Pe=e2(r,He,me,t.operator===\"=\");Pe&&(He.max=He.min+Pe,He.nInitialSamples=Math.max(Hg,1+Math.min(Math.ceil(me*Math.abs(He.max-He.min)/(2*Math.PI)*1e3),12e3)))}return He}case 5:case 100:case 101:case 102:{let me={min:0,max:1},{min:ye,max:De}=((w=t.domain)==null?void 0:w.type)===\"1d\"?t.domain:me;switch(N=Mr(Ji([ye,De]),O),N.type){case\"empty\":return!1;case\"interval\":ye=N.bounds[0],De=N.bounds[1]}let K;return(!isFinite(ye)||!isFinite(De))&&(K=GC,ye=qg(ye),De=qg(De)),{min:ye,max:De,screen:i,nInitialSamples:YE(ye,De),xtolerance:D,ytolerance:D,ztolerance:D,parameterTransform:K,map:([H,xe])=>A.mapCoordinatePair([H,xe])}}case 8:return{xmin:c,xmax:l,ymin:p,ymax:f,mathToPixels:A,tolerance:D};case 106:return{...L,u:new ie(c,l),v:new ie(p,f)};case 120:case 122:case 107:return{...L,u:new ie(p,f),v:new ie(m,g)};case 121:case 123:case 108:return{...L,u:new ie(c,l),v:new ie(m,g)};case 109:return{...L,u:new ie(d,y?h:mn.xmax),v:new ie(b,y?x:2*Math.PI)};case 124:case 110:{let{min:me,max:ye}=((Z=t.domain)==null?void 0:Z.type)===\"1d\"?t.domain:{min:0,max:2*Math.PI};return{...L,u:new ie(me,ye),v:new ie(m,g)}}case 211:{let{min:me,max:ye}=((te=t.domain)==null?void 0:te.type)===\"1d\"?t.domain:{min:0,max:2*Math.PI/u};return{...{xmin:me,xmax:ye,ymin:m,ymax:g},u:new ie(me,ye),v:new ie(m,g),mathToPixels:Nu,tolerance:Js}}case 212:{let me=y?h:2*Math.PI/u,ye=y?x:Math.PI/u;return{...{xmin:d,xmax:me,ymin:b,ymax:ye},u:new ie(d,me),v:new ie(b,ye),mathToPixels:Nu,tolerance:Js}}case 215:case 214:return{...{xmin:d,xmax:h,ymin:b,ymax:x},u:new ie(d,h),v:new ie(b,b),mathToPixels:Nu,tolerance:Js};case 213:{let me=y?h:mn.xmax,ye=y?x:2*Math.PI/u;return{...{xmin:d,xmax:me,ymin:b,ymax:ye},u:new ie(d,me),v:new ie(b,ye),mathToPixels:Nu,tolerance:Js}}case 111:return{...L,u:new ie(d,y?h:2*Math.PI/u),v:new ie(b,y?x:Math.PI/u)};case 117:case 118:case 119:case 129:case 130:case 103:case 104:case 105:case 112:case 126:case 113:case 127:case 210:case 114:case 115:case 116:return{...L,u:new ie(d,h),v:new ie(b,x)};case 200:case 201:case 202:case 206:case 205:case 203:case 204:case 207:case 208:{if(t.graphMode===200&&(t.slice_coordinate===\"z\"||t.slice_coordinate===\"_implicit\"))return{xmin:c,xmax:l,ymin:p,ymax:f,mathToPixels:A,tolerance:Js};if(t.graphMode===201&&(t.slice_coordinate===\"x\"||t.slice_coordinate===\"_implicit\"))return{...{xmin:p,xmax:f,ymin:m,ymax:g},mathToPixels:Nu,tolerance:Js};if(t.graphMode===202&&(t.slice_coordinate===\"y\"||t.slice_coordinate===\"_implicit\"))return{...{xmin:c,xmax:l,ymin:m,ymax:g},mathToPixels:Nu,tolerance:Js};let{min:me,max:ye}=((z=t.domain)==null?void 0:z.type)===\"1d\"?t.domain:{min:0,max:2*Math.PI};return{x:new ie(c,l),y:new ie(p,f),z:new ie(m,g),t:new ie(me,ye),u:new ie(d,h),v:new ie(b,x)}}case 209:return t.slice_coordinate===\"z\"?{xmin:c,xmax:l,ymin:p,ymax:f,mathToPixels:A,tolerance:Js}:t.slice_coordinate===\"x\"?{...{xmin:p,xmax:f,ymin:m,ymax:g},mathToPixels:Nu,tolerance:Js}:t.slice_coordinate===\"y\"?{...{xmin:c,xmax:l,ymin:m,ymax:g},mathToPixels:Nu,tolerance:Js}:t.slice_coordinate===\"_implicit\"?{...L,u:new ie(c,l),v:new ie(p,f)}:!1;default:return!1}}function GC(e){return Math.sinh(10*e)/(1-e*e)}function qg(e){if(e===1/0)return 1;if(e===-1/0)return-1;let t=Math.asinh(e);return 2*t/(10+Math.sqrt(100+4*t*t))}function $g(e){let{viewState:t,graphInfo:r,compiled:n,maxOverride:i,showPoint:s}=e,o=n.fn,a=yp(t,r,o),u;if(!a)u={segments:[],resolved:!0};else{let{min:p,max:f}=a;u=KG({fn:o,min:Math.max(p,0),max:i!==void 0?Math.min(i,f):f})}let{points:c,droppedIndices:l}=ud(u.segments);return{segments:[c],droppedIndices:l,graphMode:3,color:r.color,style:r.pointStyle,poi:Xs(u.segments),resolved:u.resolved,showPoint:s}}function f2(e){switch(e){case 120:case 122:return 107;case 121:case 123:return 108;case 124:return 110;case 126:return 112;case 127:return 113;default:return e}}function zC(e,t,r){let n=r?Math.PI/180:1;switch(e){case 114:return t;case 115:{let[i,s,o]=t;return[i*hr(s*n),i*tr(s*n),o]}case 116:{let[i,s,o]=t;return[i*tr(o*n)*hr(s*n),i*tr(o*n)*tr(s*n),i*hr(o*n)]}default:return[0,0,0]}}function Fa(e){var y,d,h,b,x,P,E,M,I;let{viewState:t,graphInfo:r,compiled:n,derivative:i}=e,s=n.fn,{degreeMode:o}=t,a=o?Math.PI/180:1,u=yp(t,r,s),c,l,p,f=f2(r.graphMode),m=t.xAxisScale===\"linear\"&&t.yAxisScale===\"linear\";if(!u)c={segments:[],resolved:!0};else{switch(f){case 1:case 2:let D=i?i.fn:void 0;c=r.isLinear&&m&&bo(r.linearCoefficients)?o0(r.linearCoefficients,u):c0(s,u,D);break;case 6:c=Lg($=>[$,s($)],u);break;case 8:c=td(s,u);break;case 5:u.max===u.min?c=QG(s,u.min):c=r.isLinear&&m&&bo(r.linearCoefficients)?JG(r.linearCoefficients,u):Lg(s,u);break;case 100:case 101:case 102:let O=n.fn,{min:N,max:A}=((y=r.domain)==null?void 0:y.type)===\"1d\"?r.domain:{min:0,max:1};if(!isFinite(N)||!isFinite(A)){N=qg(N),A=qg(A);let $=O;O=X=>$(GC(X))}let L=new ie(N,A),q=[];switch(f){case 100:q=wc(O,L,r.resolution,t);break;case 101:q=_g(O,L,r.resolution,t);break;case 102:q=$E(O,L,r.resolution,t);break}return{graphMode:100,guid:di(),points:q,color:r.color,thickness:r.lineWidth};case 112:case 113:case 130:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:{let $=u,{u:X,v:G}=$,J=f===112||f===113,w=r.graphMode===122||r.graphMode===123,Z=J?od:w?2:bC,{resolution:te}=r,z=te===void 0||isNaN(te)?Z:on(DC(te),2,100),oe=Ji([X.min,X.max]).type!==\"empty\"&&Ji([G.min,G.max]).type!==\"empty\",re;switch(oe&&f){case 103:{let De=n.fn;re=_C(De,$,X,G,z);break}case 130:{re=_C((K,H)=>{let[xe,ge]=n.fn(K,H);return[xe,ge,0]},$,X,G,z);break}case 104:re=i2(n,$,X,G,z,o);break;case 105:re=s2(n,$,X,G,z,o);break;case 106:re=o2(n,$,z);break;case 107:re=a2(n,$,z);break;case 108:re=u2(n,$,z);break;case 109:re=c2(n,$,X,G,z,o);break;case 110:re=l2(n,$,X,G,z,o);break;case 111:re=p2(n,$,X,G,z,o);break;case 112:case 113:re=l0(n,e.dependencies,e.gradient,u,z,{isInequality:(d=e.isImplicit3dInequality)!=null?d:!1});break;case!1:re=n2();break}let me=r.graphMode===113||r.graphMode===127;return{meshData:re,resolved:re.resolved,color:r.color,fillOpacity:me?1:(h=r.fillOpacity)!=null?h:1,uvRange:[X,G],uvArgs:(b=us[r.graphMode])!=null?b:[],extraMeshArgs:(x=Fc[r.graphMode])!=null?x:[],graphMode:f,compiled:n,restrictionShader:e.restrictionShader3d}}case 200:case 201:case 202:case 211:case 206:case 205:case 203:case 204:case 213:case 207:case 208:case 212:case 214:case 215:case 209:{let $=(K,H,xe)=>{let ge=(Ed,Md)=>{let $c=xe(Ed,Md);return isNaN($c[0])||isNaN($c[1])||isNaN($c[2])?NaN:K(Ed,Md)},se=t.viewport,{xmin:ae,xmax:He,ymin:Pe,ymax:ue,zmin:pt,zmax:Lo}=se,ka=(ae+He)/2,Hu=(Pe+ue)/2,qc=(pt+Lo)/2,Td=He-ae,Id=ue-Pe,Th=Lo-pt,aM=td(ge,{...H,map3d:(Ed,Md)=>{let[$c,uM,cM]=xe(Ed,Md);return isNaN($c)||isNaN(uM)||isNaN(cM)?[NaN,NaN,NaN]:[($c-ka)/Td,(uM-Hu)/Id,(cM-qc)/Th]}});return{segments:aM.segments,resolved:aM.resolved,graphMode:8,color:r.color,lineWidth:r.lineWidth,lineOpacity:r.lineOpacity,listIndex:r.listIndex,operator:r.operator,compiled:n,poi:{}}},X=n.fn,G=(P=r.slice_value)!=null?P:0,J=(E=r.slice_coordinate)!=null?E:\"\",w=u,Z,te,z,oe=!0,re=(K,H)=>{let ge=$(K,u,(Pe,ue)=>{let{x:pt,y:Lo,z:ka}=H(Pe,ue,K(Pe,ue));return[pt,Lo,ka]}),se=r.lineWidth,ae=Zg(ge,t,se,G),He=ae.points;for(let Pe=0;Pe<He.length/3;Pe++){let ue=He[3*Pe],pt=He[3*Pe+1],Lo=He[3*Pe+2],{x:ka,y:Hu,z:qc}=H(ue,pt,Lo);He[3*Pe]=ka,He[3*Pe+1]=Hu,He[3*Pe+2]=qc}return ae},me=(K,H)=>{let xe=[];for(let ae=0;ae<K.segments.length;ae++){let He=K.segments[ae];for(let Pe=0;Pe<He.length/2;Pe++){let ue=He[2*Pe],pt=He[2*Pe+1];xe.push(H(ue,pt))}ae<K.segments.length-1&&xe.push([NaN,NaN,0])}let ge=r.lineWidth,se=t.viewport;return Wg(xe,se,ge)},ye=u,De=(K,H)=>{var ge;let xe=$(K,ye,H);return oe=(ge=xe.resolved)!=null?ge:!0,me(xe,H)};switch(f){case 200:{if(J===\"z\")return re((H,xe)=>X(H,xe)-G,OC);if(J===\"_implicit\"){let H=r.slice_function.fn;z=De((se,ae)=>H(se,ae,X(se,ae)),(se,ae)=>[se,ae,X(se,ae)]);break}let K=J===\"x\";Z=K?w.y:w.x,te=K?H=>[G,H,X(G,H)]:H=>[H,G,X(H,G)],z=wc(te,Z,r.resolution,t);break}case 201:{if(J===\"x\")return re((H,xe)=>X(H,xe)-G,RC);if(J===\"_implicit\"){let H=r.slice_function.fn;z=De((se,ae)=>H(X(se,ae),se,ae),(se,ae)=>[X(se,ae),se,ae]);break}let K=J===\"y\";Z=K?w.z:w.y,te=K?H=>[X(G,H),G,H]:H=>[X(H,G),H,G],z=wc(te,Z,r.resolution,t);break}case 202:{if(J===\"y\")return re((H,xe)=>X(H,xe)-G,CC);if(J===\"_implicit\"){let H=r.slice_function.fn;z=De((se,ae)=>H(se,X(se,ae),ae),(se,ae)=>[se,X(se,ae),ae]);break}let K=J===\"x\";Z=K?w.z:w.x,te=K?H=>[G,X(G,H),H]:H=>[H,X(H,G),G],z=wc(te,Z,r.resolution,t);break}case 209:{let K=n.fn;if(J===\"x\")return re((H,xe)=>K(G,H,xe),RC);if(J===\"y\")return re((H,xe)=>K(H,G,xe),CC);if(J===\"z\")return re((H,xe)=>K(H,xe,G),OC);if(J===\"_implicit\"){let{resolution:H}=r,xe=H===void 0||isNaN(H)?od:on(DC(H),2,100);z=vC(n.fn,r.slice_function.fn,u,xe);break}else throw new Error(\"Programming Error: unexpected slice coordinate\")}case 206:case 205:{let K=J===\"z\";Z=K?w.t:w.z,te=K?H=>[X(H,G),H,G]:H=>[X(G,H),G,H],z=_g(te,Z,r.resolution,t);break}case 211:{let K=n.fn,H;switch(J){case\"x\":H=(Pe,ue)=>K(Pe,ue)*hr(Pe*a)-G;break;case\"y\":H=(Pe,ue)=>K(Pe,ue)*tr(Pe*a)-G;break;case\"r\":H=(Pe,ue)=>K(Pe,ue)-G;break;case\"_implicit\":let He=r.slice_function.fn;H=(Pe,ue)=>He(K(Pe,ue)*hr(Pe*a),K(Pe,ue)*tr(Pe*a),ue,K(Pe,ue),Pe);break;default:throw new Error(\"Programming Error: bad slice\")}let xe=J===\"x\",ge=J===\"y\",se=(He,Pe)=>[xe?G:K(He,Pe)*hr(He*a),ge?G:K(He,Pe)*tr(He*a),Pe],ae=$(H,ye,se);z=me(ae,se),oe=(M=ae.resolved)!=null?M:!0;break}case 213:{let K=J===\"x\",H=J===\"y\",xe=J===\"z\",ge=n.fn,se;switch(J){case\"x\":se=(ue,pt)=>ue*hr(pt*a)-G;break;case\"y\":se=(ue,pt)=>ue*tr(pt*a)-G;break;case\"z\":se=(ue,pt)=>ge(ue,pt)-G;break;case\"_implicit\":let Pe=r.slice_function.fn;se=(ue,pt)=>Pe(ue*hr(pt*a),ue*tr(pt*a),ge(ue,pt),ue,pt);break;default:throw new Error(\"Programming Error: bad slice\")}let ae=(Pe,ue)=>[K?G:Pe*hr(ue*a),H?G:Pe*tr(ue*a),xe?G:ge(Pe,ue)],He=$(se,ye,ae);z=me(He,ae);break}case 212:{let K=J===\"x\",H=J===\"y\",xe=J===\"z\",ge=n.fn,se;switch(J){case\"x\":se=(ue,pt)=>ge(ue,pt)*tr(pt*a)*hr(ue*a)-G;break;case\"y\":se=(ue,pt)=>ge(ue,pt)*tr(pt*a)*tr(ue*a)-G;break;case\"z\":se=(ue,pt)=>ge(ue,pt)*hr(pt*a)-G;break;case\"rho\":se=(ue,pt)=>ge(ue,pt)-G;break;case\"_implicit\":let Pe=r.slice_function.fn;se=(ue,pt)=>Pe(ge(ue,pt)*tr(pt*a)*tr(ue*a),ge(ue,pt)*tr(pt*a)*hr(ue*a),ge(ue,pt)*hr(pt*a),ge(ue,pt),ue,pt);break;default:throw new Error(\"Programming Error: bad slice\")}let ae=(Pe,ue)=>[K?G:ge(Pe,ue)*tr(ue*a)*hr(Pe*a),H?G:ge(Pe,ue)*tr(ue*a)*tr(Pe*a),xe?G:ge(Pe,ue)*hr(ue*a)],He=$(se,ye,ae);z=me(He,ae),oe=(I=He.resolved)!=null?I:!0;break}case 215:case 214:{let K=f===214?n.fn:(xe,ge)=>{let[se,ae]=n.fn(xe,ge);return[se,ae,0]},H;switch(J){case\"x\":H=(ge,se)=>K(ge,se)[0]-G;break;case\"y\":H=(ge,se)=>K(ge,se)[1]-G;break;case\"z\":H=(ge,se)=>K(ge,se)[2]-G;break;case\"u\":H=(ge,se)=>ge-G;break;case\"v\":H=(ge,se)=>se-G;break;case\"_implicit\":let xe=r.slice_function.fn;H=(ge,se)=>{let[ae,He,Pe]=K(ge,se);return xe(ae,He,Pe,ge,se)};break;default:throw new Error(\"Programming Error: bad slice\")}z=De(H,K);break}case 203:case 204:{let K=J===\"r\";Z=K?w.v:w.u,te=K?H=>[G,H,X(G,H)]:H=>[H,G,X(H,G)],z=_g(te,Z,r.resolution,t);break}case 207:case 208:{let K=J===\"theta\";Z=K?w.v:w.u,te=K?H=>[X(G,H),G,H]:H=>[X(H,G),H,G],z=$E(te,Z,r.resolution,t);break}}return{graphMode:100,guid:di(),points:z,resolved:oe,color:r.color,thickness:r.lineWidth}}default:throw new Error(\"Programming Error: unexpected graphmode \"+f)}p=c.poi}if((!p||p.zeros.x.length+p.extrema.x.length+p.intercept.x.length>250)&&(p=jG()),f===1)for(let D in p){if(!p.hasOwnProperty(D))continue;let O=D;l=p[O].y,p[O].y=p[O].x,p[O].x=l}let g={segments:c.segments,resolved:c.resolved,graphMode:f,color:r.color,style:r.lineStyle,lineWidth:r.lineWidth,lineOpacity:r.lineOpacity,listIndex:r.listIndex,operator:r.operator,poi:p,compiled:n};if(f===6){let D=u;g.sampledDomain={min:D.min,max:D.max}}return c.fillSegments&&(g.fillSegments=c.fillSegments),g}function d2(e,t,r){let n,i,s,o,a=[],u=null;switch(r){case 6:u=FC;break;case 1:u=function(c){return[c[1],c[0]]};break}for(n=0;n<e.length;n++)for(o=e[n],i=0;i<o.length;i+=2)s=[o[i],o[i+1]],u&&(s=u(s)),a.push(s[0],s[1]);for(n=t.length-1;n>=0;n--)for(o=t[n],i=o.length-2;i>=0;i-=2)s=[o[i],o[i+1]],u&&(s=u(s)),a.push(s[0],s[1]);return a}function Yg(e,t,r){let n=l=>l[l.length-2],i=[],s=0,o=0,a=[],u=[],c=-1/0;for(;;){for(;o<e.length&&!(e[o].length>=2);)o+=1;for(;s<t.length&&!(t[s].length>=2);)s+=1;(o>=e.length||e[o][0]>c)&&(s>=t.length||t[s][0]>c)&&(a.length>0&&u.length>0&&i.push(d2(a,u,r)),a=[],u=[],c=Math.max(c,o<e.length?n(e[o]):1/0),c=Math.max(c,s<t.length?n(t[s]):1/0));let l=!1;if(o<e.length&&e[o][0]<=c&&(c=Math.max(c,n(e[o])),a.push(e[o]),o+=1,l=!0),s<t.length&&t[s][0]<=c&&(c=Math.max(c,n(t[s])),u.push(t[s]),s+=1,l=!0),!l)break}return i}function ud(e){let t=[],r={};for(let n=0;n<e.length;n++){let i=e[n],[s,o]=i;!isNaN(s)&&!isNaN(o)?t.push(i):r[n]=!0}return{points:t,droppedIndices:r}}var us={[8]:[\"x\",\"y\"],[106]:[\"x\",\"y\"],[120]:[\"y\",\"z\"],[122]:[\"y\",\"z\"],[107]:[\"y\",\"z\"],[121]:[\"x\",\"z\"],[123]:[\"x\",\"z\"],[108]:[\"x\",\"z\"],[109]:[\"r\",\"theta\"],[124]:[\"theta\",\"z\"],[110]:[\"theta\",\"z\"],[111]:[\"theta\",\"phi\"],[130]:[\"u\",\"v\"],[103]:[\"u\",\"v\"],[104]:[\"u\",\"v\"],[105]:[\"u\",\"v\"],[126]:[\"x\",\"y\"],[112]:[\"x\",\"y\",\"z\"],[113]:[\"x\",\"y\",\"z\"],[127]:[\"x\",\"y\"],[201]:[\"y\",\"z\"],[202]:[\"x\",\"z\"],[200]:[\"x\",\"y\"],[206]:[\"theta\",\"z\"],[205]:[\"theta\",\"z\"],[211]:[\"theta\",\"z\"],[203]:[\"r\",\"theta\"],[204]:[\"r\",\"theta\"],[213]:[\"r\",\"theta\"],[207]:[\"theta\",\"phi\"],[208]:[\"theta\",\"phi\"],[212]:[\"theta\",\"phi\"],[214]:[\"u\",\"v\"],[215]:[\"u\",\"v\"],[209]:[\"x\",\"y\",\"z\"],[210]:[\"x\",\"y\",\"z\"]},Fc={[110]:[\"r\"],[111]:[\"rho\"],[104]:[\"r\",\"theta\"],[105]:[\"rho\",\"theta\",\"phi\"]};function m2(e){return!e||e[0].type===\"none\"&&e[1].type===\"none\"?\"NONE\":e[1].type===\"none\"?\"X\":e[0].type===\"none\"?\"Y\":\"XY\"}function kC(e,t){var r=m2(t);switch(e){case\"NONE\":return\"NONE\";case\"AUTO\":return r;case\"XY\":return r;case\"X\":return r===\"X\"||r===\"XY\"?\"X\":\"NONE\";case\"Y\":return r===\"Y\"||r===\"XY\"?\"Y\":\"NONE\";default:return\"NONE\"}}var y2=(e,t)=>{let r=e.segments[0],n=t.segments[0],i=[[...r,...n]];return{...e,segments:i}};function g2(e){let{viewState:t,graphInfo:r,compiled:n,derivative:i,bounds:s}=e,o=Us(r),a=Mr(r.domainBound,Ji(s));if(!hi(a))return o.domainBound=a,o.lineStyle=\"SOLID\",Fa({graphInfo:o,viewState:t,compiled:n,derivative:i})}function Au(e){let{viewState:t,graphInfo:r,compiled:n,bounds:i,included:s,showPoint:o}=e,a=Us(r),u=Mr(r.domainBound,Ji(i));if(!hi(u))return a.domainBound=u,a.pointStyle=s?\"POINT\":\"OPEN\",$g({graphInfo:a,viewState:t,compiled:n,showPoint:o,maxOverride:void 0})}function qC(e){let{viewState:t,graphInfo:r,compiled:n,bounds:i,maxOverride:s,showPoint:o}=e,[a,u]=i,c=[],l;a=Math.ceil(a),u=Math.floor(u);let p=s!==void 0?s:1/0;if(a===-1/0&&u>=p)l=Au({bounds:[a,p],included:!0,viewState:t,graphInfo:r,compiled:n,showPoint:o}),c.push(l);else if(a===-1/0&&u<1/0)l=Au({bounds:[a,u],included:!0,viewState:t,graphInfo:r,compiled:n,showPoint:o}),c.push(l),c.push(Au({bounds:[u+1,p],included:!1,viewState:t,graphInfo:r,compiled:n,showPoint:o}));else if(a>-1/0&&u>=p)l=Au({bounds:[a,p],included:!0,viewState:t,graphInfo:r,compiled:n,showPoint:o}),c.push(Au({bounds:[-1/0,a-1],included:!1,viewState:t,graphInfo:r,compiled:n,showPoint:o})),c.push(l);else{l=Au({bounds:[a,u],included:!0,viewState:t,graphInfo:r,compiled:n,showPoint:o});let f=Au({bounds:[-1/0,a-1],included:!1,viewState:t,graphInfo:r,compiled:n,showPoint:o}),m=Au({bounds:[u+1,p],included:!1,viewState:t,graphInfo:r,compiled:n,showPoint:o});c.push(l);let g;f&&m&&(g=y2(f,m),c.push(g))}return{cdfTopBranch:l,topBranches:c}}var $C=e=>{let{viewState:t,graphInfo:r,compiled:n,derivative:i,bounds:s}=e,[o,a]=s,u=g2({bounds:[o,a],viewState:t,graphInfo:r,compiled:n,derivative:i}),c=[Fa({viewState:t,graphInfo:r,compiled:n,derivative:i})];return{cdfTopBranch:u,topBranches:c}};function AK(e){switch(e){case\"LOOP_FORWARD\":return\"dcg-icon-arrow-one-way\";case\"LOOP_FORWARD_REVERSE\":return\"dcg-icon-arrow-two-way\";case\"PLAY_ONCE\":return\"dcg-icon-arrow-once\";case\"PLAY_INDEFINITELY\":return\"dcg-icon-arrow-infinite\"}}function cd(e,t){let r={};for(let n in t)t.hasOwnProperty(n)&&(Vo(e[n],t[n])||(r[n]=t[n]));return r}function jg(e,t){let r,n={};for(let i in t)t.hasOwnProperty(i)&&(Vo(e[i],t[i])||(n[i]=t[i],r=n));return r}function FK(e,t){t||(t={});let r={};for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(r[n]=Us(e[n]));for(let n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);return r}function BK({from:e,to:t,props:r}){for(var n in r)r[n]&&e.hasOwnProperty(n)&&(t[n]=Us(e[n]))}function GK(e,t){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])}function XC(e,t){let r={};for(var n in t)t.hasOwnProperty(n)&&(r[n]=e[n]);return r}function zK(e){let t={};for(let r in e)e.hasOwnProperty(r)&&(t[r]=!0);return t}var h2=(n=>(n.NONE=\"NONE\",n.POSITIVE=\"POSITIVE\",n.BOTH=\"BOTH\",n))(h2||{});var ZC={collapsed:!1,hidden:!1,secret:!1,readonly:!1,title:\"\"};function UK(e){return{...ZC,...e}}function qK(e){return cd(ZC,e)}var WC=\"**dcg_geo_folder**\";var f0={show:!1,min:\"\",max:\"\"},d0={breadth:\"\",axisOffset:\"\",alignedAxis:\"x\",showBoxplotOutliers:!0,binAlignment:\"center\",dotplotXMode:\"exact\",histogramMode:\"\"},m0={enabled:!1,latex:\"\"};var jC=4e3,Jg={polarDomain:{min:\"\",max:\"\"},parametricDomain:{min:\"\",max:\"\"},parametricDomain3Du:{min:\"\",max:\"\"},parametricDomain3Dv:{min:\"\",max:\"\"},parametricDomain3Dr:{min:\"\",max:\"\"},parametricDomain3Dphi:{min:\"\",max:\"\"},cdf:f0,colorLatex:\"\",description:\"\",fillOpacity:\"\",lineOpacity:\"\",pointOpacity:\"\",pointSize:\"\",movablePointSize:\"\",lineWidth:\"\",resolution:\"\",labelAngle:\"\",vizProps:d0,clickableInfo:m0},JC={folderId:\"\",latex:\"\",color:\"\",showLabel:!1,showAngleLabel:!0,label:\"\",hidden:!1,secret:!1,readonly:!1,disableGraphInteractions:!1,dragMode:\"AUTO\",labelSize:\"\",labelOrientation:\"default\",suppressTextOutline:!1,interactiveLabel:!1,editableLabelMode:\"NONE\",residualVariable:\"\",isLogModeRegression:!1,pointStyle:\"POINT\",lineStyle:\"SOLID\",arrowMode:\"DEFAULT\",regressionParameters:{},displayEvaluationAsFraction:!1,slider:{},strictIntersection:!1,extendTo3D:!1,...Jg,points:void 0,lines:void 0,fill:void 0},QC={hardMin:!1,hardMax:!1,animationPeriod:jC,loopMode:\"LOOP_FORWARD_REVERSE\",playDirection:1,isPlaying:!1,min:\"-10\",max:\"10\",step:\"\"},KC={hardMin:!1,hardMax:!1,animationPeriod:jC,loopMode:\"LOOP_FORWARD_REVERSE\",playDirection:1,isPlaying:!1,min:`${mn.xmin}`,max:`${mn.xmax}`,step:\"\"};function nee(e,t){return{...JC,...e,slider:{...t.is3d?KC:QC,...e.slider},cdf:{...f0,...e.cdf},vizProps:{...d0,...e.vizProps},clickableInfo:{...m0,...e.clickableInfo}}}function iee(e,t){var r=cd(JC,{...e,slider:cd(t.is3d?KC:QC,e.slider)}),n=jg(f0,e.cdf);n===void 0?delete r.cdf:r.cdf=n;var i=jg(d0,e.vizProps);i===void 0?delete r.vizProps:r.vizProps=i;var s=jg(m0,e.clickableInfo);return s===void 0?delete r.clickableInfo:r.clickableInfo=s,r}function b2(e){return XC(e,Jg)}function see(e,t){for(var r in Jg)if(Jg.hasOwnProperty(r)&&e[r]!==t[r])return!1;return!0}function oee(e){return{type:\"statement\",id:e.id,latex:e.latex,label:e.label,color:e.color,fill:e.fill,points:e.points,lines:e.lines,extendTo3D:e.extendTo3D,pointStyle:e.pointStyle,lineStyle:e.lineStyle,arrowMode:e.arrowMode,dragMode:e.dragMode,labelSize:e.labelSize,labelOrientation:e.labelOrientation,suppressTextOutline:e.suppressTextOutline,interactiveLabel:e.interactiveLabel,editableLabelMode:e.editableLabelMode,residualVariable:e.residualVariable,regressionParameters:e.regressionParameters,isLogModeRegression:e.isLogModeRegression,showLabel:e.showLabel,showAngleLabel:e.showAngleLabel,shouldGraph:e.hidden,slider:{min:e.slider.hardMin?e.slider.min:\"\",max:e.slider.hardMax?e.slider.max:\"\",softMin:e.slider.hardMin?\"\":e.slider.min,softMax:e.slider.hardMax?\"\":e.slider.max,step:e.slider.step,isPlayingOnce:e.slider.isPlaying&&e.slider.loopMode===\"PLAY_ONCE\"},strictIntersection:e.strictIntersection,isInConstructionsFolder:e.folderId===WC,...b2(e)}}var M2={};wo(M2,{LinearToSRGB:()=>I2,SRGBToLinear:()=>Qg,colorString:()=>rN,colors:()=>Vc,colors3d:()=>E2,convertColorStringToLinearRGB:()=>g0,getDisplayColor:()=>aa,invertColor:()=>P2,isValidHexColor:()=>Kg,mutateOpacity:()=>T2,normalizeColor:()=>y0,parseHex:()=>nN,shadeColor:()=>x2});function y0(e){return Kg(e)?(e.match(/^#([A-Fa-f0-9]{3})$/g)&&(e=\"#\"+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),e.toLowerCase()):e}function Kg(e){return typeof e==\"string\"&&(e.match(/^#([A-Fa-f0-9]{3})$/g)||e.match(/^#([A-Fa-f0-9]{6})$/g))}function x2(e,t){if(e=y0(e),!Kg(e))return e;t>1&&(t=1),t<-1&&(t=-1);var r=parseInt(e.slice(1),16),n=t<0?0:255,i=t<0?t*-1:t,s=r>>16,o=r>>8&255,a=r&255;return rN(Math.round((n-s)*i)+s,Math.round((n-o)*i)+o,Math.round((n-a)*i)+a)}function rN(e,t,r){return\"#\"+(16777216+Math.round(e)*65536+Math.round(t)*256+Math.round(r)).toString(16).slice(1)}function P2(e){if(e=y0(e),!Kg(e))return e;let t=\"0123456789abcdef\";return\"#\"+e.slice(1).split(\"\").map(r=>t[15-t.indexOf(r)]).join(\"\")}function nN(e){if(e=e.replace(/#/,\"\"),e.length===3)var t=parseInt(e.slice(0,1)+e.slice(0,1),16),r=parseInt(e.slice(1,2)+e.slice(1,2),16),n=parseInt(e.slice(2,3)+e.slice(2,3),16);else if(e.length===6)var t=parseInt(e.slice(0,2),16),r=parseInt(e.slice(2,4),16),n=parseInt(e.slice(4,6),16);else var t=0,r=0,n=0;return{r:t,g:r,b:n}}function T2(e,t){let r=/(rgba\\([\\d]+\\,\\ ?[\\d]+\\,\\ ?[\\d]+\\,\\ ?)[\\d.]+(\\))/;return e.match(r)?e.replace(r,`$1${t}$2`):e}function aa(e,t){if(t&&t.colorLatexValue){var r=t.colorLatexValue;return Array.isArray(r)?r[0]:r}return e.color}function Qg(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function I2(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}function g0(e){let t=nN(e);return[Qg(t.r/255),Qg(t.g/255),Qg(t.b/255)]}var Vc={RED:\"#c74440\",BLUE:\"#2d70b3\",GREEN:\"#388c46\",PURPLE:\"#6042a6\",ORANGE:\"#fa7e19\",BLACK:\"#000000\",GRAY:\"#aaaaaa\",FOCUS_OUTLINE:\"#6a93d2\"},E2={RED:Vc.RED,BLUE:Vc.BLUE,GREEN:Vc.GREEN,ORANGE:Vc.ORANGE,PURPLE:Vc.PURPLE,GRAY:Vc.GRAY};function h0(e,t){let r;switch(t){case\"solvedEquation\":r=2;break;case\"baseComparator\":r=4;break;default:r=1;break}return Math.floor(e/r)}function cee(e){return 2*v2(e*.5)}function v2(e){return e<=8?3*e:e>=16?2*e:e+16}function sN(e){let t=[];for(let n=0;n<e.instructionsLength();n++)t.push(!1);let r=[];t[e.getReturnIndex()]=!0;for(let n=e.instructionsLength()-1;n>=0;n--){if(!t[n])continue;let i=e.getInstruction(n);if(i.type===2&&r.push(e.argNames[n]),ve(i))continue;let s=Eu(e,i)?[i.args[1]]:i.args;for(let o of s)t[o]=!0}return r}var gp=class{constructor({enableGeometry:t,enable3d:r,beta3d:n,scales:i}){this._isGeometry=!1;this._is3dProduct=!1;this._isBeta3d=!1;this._isGeometry=t,this._is3dProduct=r,this._isBeta3d=n,this._scales=i}isGeometryEnabled(){return this._isGeometry}is3dProduct(){return this._is3dProduct}is3dPolicy(){return!1}isBeta3d(){return this._isBeta3d}areAllScalesLinear(){return this._scales?this._scales.xAxisScale===\"linear\"&&this._scales.yAxisScale===\"linear\":!0}assignmentForbidden(t){return t===\"x\"||t===\"y\"||t===\"theta\"||this.substitutionForbidden(t)}substitutionForbidden(t){return t===\"index\"||t===\"dt\"||t.slice(0,3)===\"tmp\"||rt.hasOwnProperty(t)}isValidSlider(t){return t===\"x\"||t===\"y\"?!0:!(t.slice(0,3)===\"ans\"||t.slice(0,6)===\"idref_\"||this.assignmentForbidden(t))}sliderVariables(t){return t.indexOf(\"theta\")!==-1&&(t=t.filter(function(r){return r!==\"r\"})),t.filter(r=>!(this.assignmentForbidden(r)||r.slice(0,3)===\"ans\"||r.slice(0,6)===\"idref_\"||r[0]===\"_\"||this.isGeometryEnabled()&&r[0]===\"$\"))}tooManySliderVariables(t,r,n){return n?t.length>=1:t.length>=2&&r.length>=1}graphingEnabled(){return!0}ansEnabled(){return!1}dimensionVarsEnabled(){return!0}validRegressionParameter(t){return t!==\"x\"&&t!==\"y\"}validLHS(t){return t!==\"theta\"&&t.slice(0,6)!==\"idref_\"}unplottablePolarFunction(t,r){return t!==\"theta\"?!1:r.indexOf(\"r\")!==-1}validDoubleInequalitySymbol(t){return t===\"x\"||t===\"y\"}validDoubleInequalityVariables(t){return t.length>2?!1:t.every(this.validDoubleInequalitySymbol)}validExpressionVariables(t){return t.length===1&&t[0]===\"x\"}validSolvedVariable(t){return t===\"x\"||t===\"y\"||t===\"r\"}validImplicitVariables(t){switch(t.length){case 0:return!0;case 1:return t[0]===\"x\"||t[0]===\"y\"||t[0]===\"r\";case 2:return t[0]===\"x\"&&t[1]===\"y\"||t[0]===\"y\"&&t[1]===\"x\"||t[0]===\"r\"&&t[1]===\"theta\"||t[0]===\"theta\"&&t[1]===\"r\";default:return!1}}graphableListVariables(t,r){return t===\"x\"||t===\"y\"||t===\"r\"||r===\"x\"||r===\"y\"}validParametricVariable(t){return t===\"t\"}validParametricVariables(t){return t.length===1&&this.validParametricVariable(t[0])}validInequalityVariables(t){switch(t.length){case 1:return t[0]===\"x\"||t[0]===\"y\"||t[0]===\"r\";case 2:return this.validImplicitVariables(t);default:return!1}}validFirstColumnVariable(t){return t!==\"y\"&&t!==\"r\"&&t!==\"theta\"&&!t.match(/y_(\\d+)/)}validActionVariable(t){return t===\"dt\"||t===\"index\"}validCoordinateEquationSymbol(t){return!1}complicatedPolarImplicit(t,r){return t===\"theta\"||t===\"r\"&&r!==1}graphMode(t,r,n){if(r.length===0)return t===\"x\"?1:t===\"r\"?6:t===\"y\"?2:10;let i=r[0];return i===\"y\"?1:t===\"x\"?1:t===\"r\"&&i===\"theta\"?6:2}functionDefinitionGraphMode(t,r){return this.graphMode(t,r)}tableableAsConstant(t){return!(t===\"x\"||t===\"r\"||t===\"theta\")}implicitIndependent(t){return\"x\"}implicitDependency(t){return t.length!==1?\"y\":t[0]===\"y\"?\"x\":t[0]===\"theta\"?\"r\":\"y\"}disabledFeatures(){return[]}};function Bc(){return new gp({enableGeometry:!1,enable3d:!0,beta3d:!1,scales:{xAxisScale:\"linear\",yAxisScale:\"linear\"}})}var eh=class{constructor(t){this._isBeta3d=!1;this._isBeta3d=t}isGeometryEnabled(){return!1}is3dProduct(){return!0}is3dPolicy(){return!0}isBeta3d(){return this._isBeta3d}areAllScalesLinear(){return!0}graphingEnabled(){return!0}ansEnabled(){return!1}dimensionVarsEnabled(){return!1}substitutionForbidden(t){return Bc().substitutionForbidden(t)}validInequalityVariables(t){return this.validImplicitVariables(t)}validFirstColumnVariable(t){return Bc().validFirstColumnVariable(t)}validActionVariable(t){return Bc().validActionVariable(t)}tableableAsConstant(t){return Bc().tableableAsConstant(t)}implicitIndependent(t){return Bc().implicitIndependent(t)}validRegressionParameter(t){return Bc().validRegressionParameter(t)}assignmentForbidden(t){return t===\"x\"||t===\"y\"||t===\"z\"||t===\"r\"||t===\"rho\"||t===\"theta\"||t===\"phi\"||this.substitutionForbidden(t)}sliderVariables(t){return t.filter(r=>!(this.assignmentForbidden(r)||r.slice(0,3)===\"ans\"||r.slice(0,6)===\"idref_\"||r[0]===\"_\"))}tooManySliderVariables(t,r,n){return n?this.isBeta3d()?r.length>=1:t.length>=1:r.length>=1}isValidSlider(t){return!(t.slice(0,3)===\"ans\"||t.slice(0,6)===\"idref_\"||this.assignmentForbidden(t))}validLHS(t){return t!==\"phi\"&&Bc().validLHS(t)}unplottablePolarFunction(t,r){return!1}complicatedPolarImplicit(t,r){return!1}validDoubleInequalitySymbol(t){return ld(t)}validDoubleInequalityVariables(t){return t.every(ld)}validExpressionVariables(t){return t.length===2&&t.every(r=>r==\"x\"||r==\"y\")}validSolvedVariable(t){return ld(t)||t===\"r\"||t===\"rho\"}validImplicitVariables(t){return t.every(ld)}graphableListVariables(t,r){return t===\"x\"||t===\"y\"||t===\"z\"||t===\"r\"||t===\"rho\"||r===\"x\"||r===\"y\"}validParametricVariable(t){return t===\"t\"||t===\"u\"||t===\"v\"}validParametricVariables(t){return t.length===1&&this.validParametricVariable(t[0])||t.length===2&&t.every(pd)}validCoordinateEquationSymbol(t){return this.isBeta3d()?t===\"rhothetaphi\"||t===\"rthetaz\":!1}functionDefinitionGraphMode(t,r){if(r.length===1)switch(r[0]){case\"x\":return 121;case\"y\":return 120;default:return 10}else if(r.length===2&&r.every(n=>n==\"x\"||n==\"y\"))return 106;return 10}graphMode(t,r,n){if(n!=null||(n=r),r.length===0)switch(t){case\"z\":return n.some(i=>i===\"r\"||i===\"theta\")?109:106;case\"y\":return n.includes(\"z\")?108:123;case\"x\":return n.includes(\"z\")?107:122;case\"r\":return n.indexOf(\"r\")>-1?10:oN(n);case\"rho\":return 111;case\"rthetaz\":return this.isBeta3d()?115:10;case\"rhothetaphi\":return this.isBeta3d()?116:10;default:return 10}switch(t){case\"z\":return r.every(i=>i==\"x\"||i==\"y\")?106:r.every(i=>i==\"r\"||i==\"theta\")?109:10;case\"y\":return r.every(i=>i==\"x\")?n.some(i=>i===\"z\")?108:121:r.every(i=>i==\"x\"||i==\"z\")?108:10;case\"x\":return r.every(i=>i==\"y\")?n.some(i=>i===\"z\")?107:120:r.every(i=>i==\"y\"||i==\"z\")?107:10;case\"r\":return r.every(i=>i==\"theta\")?oN(n):r.every(i=>i==\"theta\"||i==\"z\")?110:10;case\"rho\":return r.every(i=>i==\"theta\"||i==\"phi\")?111:10;case\"rthetaz\":return this.isBeta3d()?r.length===1&&r[0]===\"t\"?101:r.every(pd)?104:10:10;case\"rhothetaphi\":return this.isBeta3d()?r.length===1&&r[0]===\"t\"?102:r.every(pd)?105:10:10;default:return 10}}implicitDependency(t){if(t.length!==2)return\"z\";let r=t[0]<t[1]?t[0]+t[1]:t[1]+t[0];return r===\"xy\"?\"z\":r===\"xz\"?\"y\":r===\"yz\"?\"x\":\"z\"}disabledFeatures(){return[]}},ld=e=>e===\"x\"||e===\"y\"||e===\"z\",pd=e=>e===\"u\"||e===\"v\";function oN(e){return e.some(r=>ld(r)||r===\"r\")?110:124}v.Base.prototype.getGraphMode=function(e,t){return 10};v.Base.prototype.graphmodeDependencies=As;function As(e,t){let r=t.getDependencies();if(e.is3dProduct()&&t instanceof dr){let n=new Set(sN(t._chunk));return r.filter(i=>n.has(i))}else return r}function D2(e,t){var r;return e&&e.hasOwnProperty(\"dragMode\")?e.dragMode===\"AUTO\"?r=t.defaultDragMode:r=e.dragMode:r=t.defaultDragMode,kC(r,t.moveStrategy)}function aN(e,t){let r=e.is3dPolicy();if(t.isMovablePoint&&!r&&D2(this.userData,t)!==\"NONE\")return 4;var n=As(e,t);switch(t.valueType){case tn:case V:if(r){if(n.length===0)return 114;if(e.validParametricVariables(n))return n.length==1?100:Va(103,t)}return 10;case C:case xt:return n.length===0?3:r&&e.validParametricVariables(n)?n.length===1?5:n.every(pd)?Va(130,t):10:e.validParametricVariables(n)?5:10;case T:case le:return!e.is3dPolicy()&&n.length===1?2:r&&n.length===2&&n.indexOf(\"x\")>-1&&n.indexOf(\"y\")>-1?Va(106,t):10}if(n.length>0)return 10;switch(t.valueType){case Wr:case Rn:return 5;case jr:case Cn:return r?100:10;case cn:case Nn:return r?Va(130,t):10;case ln:case An:return r?Va(103,t):10;case Rt:case rn:return r?119:10;case Ce:case sn:return r?129:10;case Pr:case nn:return r?117:10;case Rr:case xn:return r?118:10;case Be:case Or:return 16;case he:case wr:return 20;case fe:case Fr:return 21;case Se:case xr:return 17;case be:case Vr:return 18;case _e:case Br:return 19;case Me:case Gr:return this instanceof Fe&&this.getDependencies().length===1?10:24;case Ge:case mr:case Ae:case yr:return 23;default:return 10}}v.Expression.prototype.getGraphMode=aN;function uN(e,t){var r=t._expression.getDependencies();if(r.length>1)return 10;if(t._expression.isList&&t._expression.length===0)return 10;var n=t._symbol;let i=t.getDependencies();return e.graphMode(n,r,i)}v.Equation.prototype.getGraphMode=v.BaseComparator.prototype.getGraphMode=v.ComparatorChain.prototype.getGraphMode=function(e,t){if(t.isError)return 10;var r=As(e,t);let n=t.getDependencies();if(e.is3dPolicy()){let i=10,s=this.type===\"Equation\"||this.type===\"ComparatorChain\"&&this.symbols.includes(\"=\");return r.length>0&&(n.includes(\"z\")?i=s?112:113:i=s?126:127),Va(i,t)}return t.isConstant?10:t instanceof v.SolvedEquation?uN(e,t):r.length===1||r.length===2?8:10};function T0(e){var t;return e===106||e===200||e===107||e===201||e===108||e===202?[\"x\",\"y\",\"z\",\"_implicit\"]:e===110||e===211?[\"x\",\"y\",\"z\",\"r\",\"theta\",\"_implicit\"]:e===111||e===212?[\"x\",\"y\",\"z\",\"rho\",\"theta\",\"phi\",\"_implicit\"]:e===109||e===213?[\"x\",\"y\",\"z\",\"r\",\"theta\",\"_implicit\"]:e===103||e===214||e===130||e===215?[\"x\",\"y\",\"z\",\"u\",\"v\",\"_implicit\"]:e===113||e===210||e===112||e===209?[\"x\",\"y\",\"z\",\"_implicit\"]:(t=us[e])!=null?t:[]}function Va(e,t){let r=T0(e),n=t._chunk;try{let s=Aa(n,r,{allowSlices:!0}).getSliceVariablesOrImplicit();if(s.length!==1)return e;let o=s[0];return r.indexOf(o)<0?10:eC(e,o)}catch(i){return 10}}v.DoubleInequality.prototype.getGraphMode=function(e,t){let r=t.getDependencies();return e.graphMode(t._symbol,[],r)};v.Assignment.prototype.getGraphMode=function(e,t){if(t instanceof v.SolvedEquation)return uN(e,t);if(this.isEquation(e,t))return this.asEquation().getGraphMode(e,t);let r=As(e,t),n=this._symbol,i=t.getDependencies();switch(t.valueType){case T:case le:case Xe:switch(r.length){case 0:{let o=e.graphMode(n,[],i);return e.is3dPolicy()?Va(o,t):o}case 1:if(t.valueType===le&&!e.graphableListVariables(n,r[0]))return 10;if(this.isSlider)return 10;let s=e.graphMode(n,r,i);return e.is3dPolicy()?Va(s,t):s;default:return e.is3dPolicy()?Va(e.graphMode(n,r,i),t):10}case V:if(e.assignmentForbidden(n)||r.length>0&&!e.validParametricVariables(r))return 10;switch(r.length){case 0:return 114;case 1:return 100;case 2:return 103;default:return 10}default:return aN.call(this,e,t)}};v.CoordinateEquation.prototype.getGraphMode=function(e,t){var r=As(e,t);let n=this._concatenatedSymbol;if(t.valueType!==V)return 10;if(r.length>0&&!e.validParametricVariables(r))return 10;switch(r.length){case 0:switch(n){case\"rhothetaphi\":return 116;case\"rthetaz\":return 115;default:return 10}case 1:switch(n){case\"rhothetaphi\":return 102;case\"rthetaz\":return 101;default:return 10}case 2:switch(n){case\"rhothetaphi\":return 105;case\"rthetaz\":return 104;default:return 10}default:return 10}};v.FunctionDefinition.prototype.getGraphMode=function(e,t){let r=e.is3dPolicy();if(this._argSymbols.length!==1&&!r)return 10;if(this.recursionInfo)return 10;var n=e.functionDefinitionGraphMode(this._symbol,this._argSymbols),i=As(e,t);switch(t.valueType){case T:case le:if(r)return n;switch(i.length){case 0:return n;case 1:return i[0]!==this._argSymbols[0]?10:n;default:return 10}break;default:return 10}};v.Regression.prototype.getGraphMode=function(e,t){return this.isLhsSimple?t.isModelValid?t.model.getDependencies().length!==1?10:2:10:10};function I0(e,t){return t.isError?10:11}v.Histogram.prototype.getGraphMode=I0;v.DotPlot.prototype.getGraphMode=I0;v.BoxPlot.prototype.getGraphMode=I0;v.Image.prototype.getGraphMode=function(e,t){return this.userData.showPoints?this.center.isError||this.radianAngle.isError||this.width.isError||this.height.isError||this.opacity.isError?10:3:10};function cN(e){let t=0,r=0,n=[],i=Ii(e,e.getReturnIndex());for(let s=0;s<e.instructionsLength();s++){if(!i[s])continue;let o=e.getInstruction(s);o.type===25?n[s]=1:o.type===31||o.type===32?n[s]=n[o.args[0]]+n[o.args[1]]:n[s]=0,Eu(e,o)&&(t+=1,r+=n[o.args[0]])}return{numRestrictions:t,numEqualityRestrictions:r}}function kc(e,t,r){try{return S2(e,t,r)}catch(n){return n instanceof R?n:ee(n)}}function S2(e,t,r){var l,p;if(!e.is3dProduct()||r.isError)return r;if(!(r instanceof dr))return ee(\"Expected peel error to be checked on an IRExpression\");function n(f,m){let g=m.filter(y=>f.indexOf(y)<0);if(g.length)return Wx(g[0]).allowExport().setDependencies(g)}function i(){let f=rh(o),m=O2(e,r);return n(f,m)}function s(){let f=lN(o),m=R2(e,r,o);return n(f,m)}let o=t.getGraphMode(e,r),a=r._chunk,{numRestrictions:u,numEqualityRestrictions:c}=cN(a);if(c!==0)if(c===1){if(u!==c&&!t.isInequality())return Hb();let g=Aa(a,[],{allowSlices:!0}).getSliceVariablesOrImplicit();if(g.length!==1)return Ho();let y=T0(o),d=g[0];if(y.indexOf(d)<0)return d===\"_implicit\"?Ho().allowExport():Jx(d).allowExport().setDependencies([d])}else return kb();return(p=(l=i())!=null?l:s())!=null?p:r}function O2(e,t){let r=As(e,t);return t.getDependencies().filter(i=>r.indexOf(i)<0)}function R2(e,t,r){let n=As(e,t),i=new Set;if(t instanceof dr){let o=t.getRestrictedFunctionForGLSL(rh(r),_u).concrete;for(let a of o.getDependencies())n.indexOf(a)>-1||i.add(a)}return[...i]}function rh(e){var r;if(!ra(e))return[];let t=C2(e)?[\"x\",\"y\",\"z\"]:[];return e===211&&t.push(\"r\"),e===212&&t.push(\"rho\"),t.push(...(r=Fc[e])!=null?r:[]),t.push(...lN(e).filter(n=>t.indexOf(n)<0)),t}function C2(e){return N2(e)||e==200||e==201||e==202||e==211||e==212||e==213||e==214||e==215}function N2(e){if(!ra(e))return!1;switch(e){case 106:case 107:case 108:case 110:case 111:case 109:case 122:case 123:case 112:case 113:case 127:case 130:case 103:case 104:case 105:case 210:return!0;case 124:case 120:case 121:case 126:case 114:case 115:case 116:case 117:case 118:case 119:case 129:case 128:case 100:case 101:case 102:case 200:case 201:case 202:case 206:case 205:case 211:case 203:case 204:case 213:case 207:case 208:case 212:case 214:case 215:case 209:return!1;default:return!1}}function lN(e){var t;return ra(e)?(t=us[e])!=null?t:[]:[]}function pN(e=void 0){let{xmin:t,xmax:r,ymin:n,ymax:i,zmin:s,zmax:o}=e!=null?e:new Ug,a=[t,n,o,t,i,o,r,i,o,r,n,o,t,n,s,t,i,s,r,i,s,r,n,s,t,n,s,t,n,o,t,i,o,t,i,s,r,n,s,r,n,o,r,i,o,r,i,s,r,n,s,r,n,o,t,n,o,t,n,s,r,i,s,r,i,o,t,i,o,t,i,s],u=[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0],c=[0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,0,0,1,0,1,1,0,1,0,1,1,1,1,1,0,1,0,0,0,0,0,1,1,1,1,0,1,0,1],l=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23];return{positions:new Float32Array(a),normals:new Float32Array(u),faces:new Uint16Array(l),uvs:new Float32Array(c)}}function fN(e,t){let{mappedArgIndex:r,mappedReturnIndex:n,solutionIndex:i}=t,s=[],o=ru(e,r),a=_2(e,o,n),u=i,c=e.NanOfType(e.getReturnType());for(let l=0;l<=n;l++){let p=e.getInstruction(l);if(l===r){s.push(i);continue}if(!o[l]&&!e.isInClosedBlock(l)){s.push(l);continue}if(ve(p))s.push(e.copyInstruction(p));else{let f=A2(s,p.args);s.push(e.copyInstructionWithArgs(p,f)),p.type===33&&a[l]&&(u=e.Piecewise([f[0],u,c]))}}return u}function A2(e,t){let r=[];for(let n of t)r.push(e[n]);return r}function _2(e,t,r){let n=[];for(let i=0;i<r;i++)n.push(!1);n[r]=t[r];for(let i=r;i>=0;i--){if(!n[i]||!t[i])continue;let s=e.getInstruction(i);if(s.type===33)n[s.args[1]]=!0;else if(!ve(s))for(let o of s.args)n[o]=!0}return n}function dN(e,t){try{return L2(e,t)}catch(r){return r instanceof v.Base?r:ee(r)}}function E0(e,t){try{let r=new dr(t),n=Nc({},r),i=[];for(let o=0;o<n.length;o++)i.push(T);let s=Pg({policy:e,frame:{},argNames:n,argTypes:i,selection:void 0});return s.chunk=t,t.fuseBroadcast(),mN({policy:e,ctx:s,isInequality:!1,allowSolvingIn3D:!0},t)}catch(r){return r instanceof v.Base?r:ee(r)}}function L2({policy:e,frame:t},r){let n=Nc(t,r),i=[];for(let m=0;m<n.length;m++)i.push(T);let s=Pg({policy:e,frame:t,argNames:n,argTypes:i,selection:void 0}),{chunk:o}=s,a=Ie(s,r.args[0]),u=Ie(s,r.args[1]),c=r.getOperator(),l=c!==\"=\";switch(du(o,e,r,[a,u]),c){case\"<\":o.Less([a,u]);break;case\">\":o.Greater([a,u]);break;case\"<=\":o.LessEqual([a,u]);break;case\">=\":o.GreaterEqual([a,u]);break;case\"=\":o.Equal([a,u]);break}if(o.fuseBroadcast(),o.isConstant())return new dr(o);let f=o.getInstruction(a).type!==2||Nc(t,r.args[1]).indexOf(o.argNames[a])!==-1;if(!os.plotImplicits&&f)throw nP();return _n[c].direction===-1?o.Subtract([u,a]):o.Subtract([a,u]),o.fuseBroadcast(),mN({policy:e,ctx:s,isInequality:l,allowSolvingIn3D:!1},o)}function mN({policy:e,ctx:t,isInequality:r,allowSolvingIn3D:n},i){let s=i.getLiveArgNames();if(s.length===0)throw ee(`Unexpected: non-constant node with dependencies: ${s}`);if(s.length===1&&!r&&!os.plotSingleVariableImplicitEquations)return rP();let o=m=>m===\"x\"||m===\"y\"||m===\"z\";if(e.is3dPolicy()?!s.every(o):s.length>2)return ar(e.sliderVariables(s)).setDependencies(s);if(r&&!e.validInequalityVariables(s))return eP().setDependencies(s);let{localFrames:a,effectiveOrder:u,variableOfInterest:c}=w2(t,r);if(e.complicatedPolarImplicit(c,u))return iP().setDependencies(s);if(!e.validImplicitVariables(s))return nc();if(e.is3dPolicy()&&n&&u!==1)return Ho();if(u>2||e.is3dPolicy()&&!n)return new dr(i);let l=[],p=[],f=1;for(let m=0;m<a.length;m++){let g=a[m],y=F2(g,r);f=y.length;for(let h of y){let b=g.chunk.copy();if(b.setReturnIndex(h),g.isRestrictedPolynomial){let{mappedArgIndex:x,mappedReturnIndex:P}=g;b.setReturnIndex(fN(b,{mappedArgIndex:x,mappedReturnIndex:P,solutionIndex:b.getReturnIndex()}))}b.fuseBroadcast(),l.push(new dr(b))}let d=!1;for(let h of g.coefficients){let b=g.chunk.getInstruction(h);b.type===1&&b.value!==0&&(d=!0)}if(i.argNames.length!==2||d)p.push(void 0);else{let h=g.chunk.copy(),b=g.coefficients.slice();h.List(b);let x=W(i.getReturnType())?i.elementAt(m):i.copy(),E=x.argNames.indexOf(c)===0?1:0,M=x.getReturnIndex();x.Add([E,x.Multiply([x.Constant(0),M])]),p.push({coefficients:h,restriction:x})}}return new v.SolvedEquation(c,new v.List(l),p,f)}function w2(e,t){let r=e.chunk,n=e.policy,i=r.argNames,s=W(r.getReturnType()),o=[];e:for(let a=0;a<i.length;a++){let u=i[a],c=i.length>1&&!n.validSolvedVariable(u);o[a]={localFrames:[],effectiveOrder:0,variableOfInterest:u};let l=!t;if(c){o[a].effectiveOrder=1/0;continue}let p=s?r.getConstantListLength():1;if(p==null)throw new Error(\"Programming error: cannot solve a variable-length list expression\");for(let f=0;f<p;f++){let m=s?r.elementAt(f):r;if(m.polynomialOrder(u,{allowRestriction:l,allowClosedBlockReferences:!1})>2){o[a].effectiveOrder=1/0;continue e}let y=m.getPolynomialCoefficients(u);o[a].localFrames.push(y),o[a].effectiveOrder=Math.max(o[a].effectiveOrder,y.coefficients.length-1)}}if(i.length===1)return o[0];if(i.length===2&&!i.includes(\"z\"))return i[0]===\"y\"&&(o=[o[1],o[0]]),o[0].effectiveOrder===0?o[1]:o[1].effectiveOrder===0?o[0]:o[o[0].effectiveOrder<o[1].effectiveOrder?0:1];{let a=o.filter(c=>c.effectiveOrder===1);if(a.length>0)return a[0];let u=o.filter(c=>c.effectiveOrder===2);return u.length>0?u[0]:o[0]}}function F2(e,t){return t?B2(e):V2(e)}function V2({chunk:e,coefficients:t}){let[r,n,i]=t,s=e.Constant(Re(0,1)),o=e.Constant(NaN);if(i===void 0){n===void 0&&(n=s);let a=e.Negative([e.Divide([r,n])]),u=e.Equal([n,s]);return[e.Piecewise([u,o,a])]}else{let a=e.Constant(Re(2,1)),u=e.Multiply([a,i]),c=e.Negative([n]),l=e.Subtract([e.Multiply([n,n]),e.Multiply([a,e.Multiply([u,r])])]),p=e.Equal([i,s]),f=e.getInstruction(l);if(f.type===1&&Y(f.value)===0)return[e.Piecewise([p,o,e.Divide([c,u])])];{let m=e.SyntheticNativeFunction(\"sqrt\",[l]),g=e.Less([n,s]),y=e.Greater([n,s]),d=e.Divide([e.Add([c,m]),u]),h=e.Divide([e.Subtract([c,m]),u]),b=e.Negative([e.Divide([r,n])]);return[e.Piecewise([p,e.Piecewise([g,b,o]),h]),e.Piecewise([p,e.Piecewise([y,b,o]),d])]}}}function B2({chunk:e,coefficients:t}){let[r,n,i]=t,s=e.Constant(Re(0,1));i===void 0&&(i=s),n===void 0&&(n=s),r===void 0&&(r=s);let o=e.Constant(Re(2,1)),a=e.Constant(NaN),u=e.Constant(Re(1e305,1)),c=e.Negative([u]),l=e.Multiply([o,i]),p=e.Negative([n]),f=e.Subtract([e.Multiply([n,n]),e.Multiply([o,e.Multiply([l,r])])]),m=e.SyntheticNativeFunction(\"sqrt\",[f]),g=e.Divide([e.Add([p,m]),l]),y=e.Divide([e.Subtract([p,m]),l]),d=e.Negative([e.Divide([r,n])]),h=e.Equal([i,s]),b=e.Greater([i,s]),x=e.Equal([n,s]),P=e.Greater([n,s]),E=e.Less([n,s]),M=e.Greater([r,s]),I=e.Less([f,s]);return[e.Piecewise([h,e.Piecewise([E,d,a]),e.Piecewise([b,y,a])]),e.Piecewise([h,e.Piecewise([x,e.Piecewise([M,c,a]),a]),e.Piecewise([b,e.Piecewise([I,c,a]),g])]),e.Piecewise([h,e.Piecewise([x,e.Piecewise([M,u,a]),a]),e.Piecewise([b,e.Piecewise([I,u,a]),y])]),e.Piecewise([h,e.Piecewise([P,d,a]),e.Piecewise([b,g,a])])]}var{abs:Lu,min:M0,max:v0}=Math;function D0(e,t){let{xmin:r,xmax:n,ymin:i,ymax:s,zmin:o,zmax:a}=t,u=[[r,i,a],[r,s,a],[n,s,a],[n,i,a],[r,i,o],[r,s,o],[n,s,o],[n,i,o]],c=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[1,5],[2,6],[3,7]],l=[];for(let[D,O]of c){let N=u[D],A=u[O],L=e(...N),q=e(...A),$=L/(L-q);0<=$&&$<=1&&l.push(bs(N,A,$))}if(l.length<3)return;let p=M0(...l.map(D=>D[0])),f=v0(...l.map(D=>D[0])),m=M0(...l.map(D=>D[1])),g=v0(...l.map(D=>D[1])),y=M0(...l.map(D=>D[2])),d=v0(...l.map(D=>D[2])),h=e(r,i,o),b=(e(n,i,o)-h)/(n-r),x=(e(r,s,o)-h)/(s-i),P=(e(r,i,a)-h)/(a-o),E,M,I;return Lu(P)>=Lu(b)&&Lu(P)>=Lu(x)?(E=(D,O)=>[D,O,o-(h+b*(D-r)+x*(O-i))/P],M=new ie(p,f),I=new ie(m,g)):Lu(x)>=Lu(P)&&Lu(x)>=Lu(b)?(E=(D,O)=>[D,i-(h+b*(D-r)+P*(O-o))/x,O],M=new ie(p,f),I=new ie(y,d)):(E=(D,O)=>[r-(h+x*(D-i)+P*(O-o))/b,D,O],M=new ie(m,g),I=new ie(y,d)),{explicitPlane:E,u:M,v:I}}function nh(e,t){let r=[],n=[],i=[],s=[],o=D0(e,t);if(o){let{explicitPlane:a,u,v:c}=o;r.push(...a(u.min,c.min),...a(u.max,c.min),...a(u.min,c.max),...a(u.max,c.max));let l=new je(r[0],r[1],r[2]),p=new je(r[3],r[4],r[5]),f=new je(r[6],r[7],r[8]),m=new je().subVectors(f,l),g=new je().subVectors(l,p),y=m.cross(g).normalize();n.push(y.x,y.y,y.z,y.x,y.y,y.z,y.x,y.y,y.z,y.x,y.y,y.z),i.push(0,0,0,1,1,0,1,1),s.push(0,1,2,3,2,1)}return{positions:r,normals:n,faces:s,uvs:i,resolved:!0,extraAttrs:[]}}var z2=!1,_u=256,oh=v.List;function hn(){return{}}function Hc(e,t,r){let n=1/0;for(let s of t){let o=e[s];Array.isArray(o)&&o.length<n&&(n=o.length)}let i=1;return r===\"solvedEquation\"?i=2:r===\"baseComparator\"&&(i=4),i*n}function Ba(e,t,r){return Array.isArray(e)?e[h0(t,r)]:e}function k2(e,t){var r=t.viewport.xmax-t.viewport.xmin,n=t.viewport.ymax-t.viewport.ymin;let i=ls(r,n),s=ls(30,30),o=Math.round(2-Math.log(i/s)/Math.LN10);if(o<=0)return Math.round(e)+\"\";{let a=Math.pow(10,o);return Math.round(e*a)/a+\"\"}}function H2(e,t){var r=t.viewport.xmax-t.viewport.xmin,n=t.viewport.ymax-t.viewport.ymin;let i=r*n,s=30*30,o=Math.round(2-Math.log(i/s)/Math.LN10);if(o<=0)return Math.round(e)+\"\";{let a=Math.pow(10,o);return Math.round(e*a)/a+\"\"}}function U2(e,t){return t.degreeMode?Math.round(e/(Math.PI/180)*10)/10+\"\\xB0\":Math.round(e*100)/100+\"\"}function wu(e,t,r){let n=h0(t,r),i=e.userData.lineStyle,s=Ba(e.metaData.computedLineWidth,t,r),o=Ba(e.metaData.computedLineOpacity,t,r),a=Ba(e.metaData.computedFillOpacity,t,r),u=e.metaData.colorLatexValue?Ba(e.metaData.colorLatexValue,t,r):e.userData.color,c=Ba(e.metaData.computedResolution,t,r);return{listIndex:n,style:i,lineWidth:s,lineOpacity:o,fillOpacity:a,color:u,resolution:c}}v.Base.prototype._graph=q2;function q2(e,t,r,n,i,s){var m,g,y;if(t instanceof v.SolvedEquation){let d=this._graph(e,t._expression,r,n,i,t.branchMultiplier===2?\"solvedEquation\":void 0),h=vN(this,t,r,e);return h&&(d||(d=[]),Array.prototype.push.apply(d,h)),d}function o(d){let h=d.editableLabelMode;return h===\"TEXT\"||h===\"MATH\"}function a(d,h){return\"colorLatex\"in d&&Q2(d.colorLatex)?d.colorLatex:h}let u=t.getExpressionType(n.graphMode,t.valueType),c=ME(u,{points:this.userData.points,lines:this.userData.lines,fill:this.userData.fill}),l={lineOpacity:\"computedLineOpacity\",lineWidth:\"computedLineWidth\",color:\"colorLatexValue\",fillOpacity:\"fillOpacity\",resolution:\"resolution\"},p=(d,h)=>{let b=Hc(this.metaData,Object.keys(d).map(P=>l[P]),s),x=[];return oh.wrap(t).eachElement((P,E)=>{if(E>=b)return;let M=this.getGraphInfo(e,P);M.graphMode=n.graphMode;let I=wu(this,E,s);M.listIndex=I.listIndex,M.style=I.style,\"lineWidth\"in d&&(M.lineWidth=I.lineWidth),\"lineOpacity\"in d&&(M.lineOpacity=I.lineOpacity),\"fillOpacity\"in d&&(M.fillOpacity=I.fillOpacity),\"color\"in d&&(M.color=a(this.userData,I.color)),\"resolution\"in d&&(M.resolution=I.resolution),x.push(...h(P,M))}),x},f=n.graphMode;switch(f){case 4:{let{points:b,droppedIndices:x}=ud([t.asValue()]),P=this.userData.shouldGraph&&c.points,E=this.userData.showLabel&&!P;return P?[{segments:[b],graphMode:f,droppedIndices:x,color:aa(this.userData,this.metaData),style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,pointOpacity:this.metaData.computedPointOpacity,pointSize:this.metaData.computedMovablePointSize,suppressTextOutline:this.userData.suppressTextOutline,editableLabel:o(this.userData),labels:this.computedLabels||[],poi:Xs(b),movablePointInfo:[]}]:E?[{segments:[b],graphMode:3,color:aa(this.userData,this.metaData),style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,nakedLabel:!0,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,pointOpacity:this.metaData.computedPointOpacity,suppressTextOutline:this.userData.suppressTextOutline,editableLabel:o(this.userData),labels:this.computedLabels||[],poi:Xs(b),showPoint:!1}]:[]}case 3:{let b=[],x=this.userData.shouldGraph&&c.points,P=this.userData.shouldGraph&&c.lines,E=[\"colorLatexValue\"];x&&E.push(\"computedPointOpacity\",\"computedPointSize\"),(this.userData.showLabel||x)&&E.push(\"computedLabelSize\",\"computedLabelAngle\");let M=Hc(this.metaData,E,s),I=oh.wrap(t).asValue();qn(I),I.length>M&&(I.length=M);let D=this.userData.showLabel&&!x&&!P,O=ud(I);if(this.userData.showLabel||x){let N={segments:[O.points],graphMode:f,droppedIndices:O.droppedIndices,color:this.metaData.colorLatexValue||this.userData.color,style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,showPoint:x,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,pointSize:this.metaData.computedPointSize,pointOpacity:this.metaData.computedPointOpacity,suppressTextOutline:this.userData.suppressTextOutline,interactiveLabel:!!this.userData.interactiveLabel,editableLabel:o(this.userData),nakedLabel:D,labels:this.computedLabels||[],poi:Xs(I)};e.is3dPolicy()?b.push(...W2(N)):b.push(N)}if(P){let N=this.metaData.computedLineWidth,A={segments:PN(I),graphMode:5,color:aa(this.userData,this.metaData),style:this.userData.lineStyle,lineWidth:N,lineOpacity:this.metaData.computedLineOpacity,poi:hn()};b.push(gN(e,A,r,N))}return b}case 114:case 115:case 116:{let b=[],x=this.userData.shouldGraph&&c.points,P=this.userData.shouldGraph&&c.lines,E=[\"colorLatexValue\"];x&&E.push(\"computedPointOpacity\",\"computedPointSize\");let M=oh.wrap(t).asValue();qn(M);let{degreeMode:I}=r,D=M.map(A=>zC(f,A,I)),O=Hc(this.metaData,E,s),N=Math.min(D.length,O);if(x)for(let A=0;A<N;A++){let{color:L,fillOpacity:q}=wu(this,A,s),$=Ba(this.metaData.computedPointSize,A,s);b.push({graphMode:114,position:D[A],radius:.02*$,guid:di(),color:L,fillOpacity:q})}if(P){let A=Ba(this.metaData.computedLineWidth,0,s),{color:L}=wu(this,0,s);b.push({graphMode:100,points:Wg(D,r.viewport,A),thickness:A,guid:di(),color:L})}return b}case 117:{let b=this.metaData.colorLatexValue?!Array.isArray(this.metaData.colorLatexValue):!0,x=this.metaData.computedFillOpacity,P=[],E=[],M=[],I=[],D=[],[O,N,A]=[new je,new je,new je],[L,q,$]=[new je,new je,new je],X=(J,w,Z,te,z,oe,re,me,ye)=>{if(L.set(J,w,Z),q.set(te,z,oe),$.set(re,me,ye),!L.isFinite()||!q.isFinite()||!$.isFinite())return;let De=P.length/3;P.push(L.x,L.y,L.z,q.x,q.y,q.z,$.x,$.y,$.z),O.subVectors(L,$),N.subVectors(q,L),A.crossVectors(O,N),E.push(A.x,A.y,A.z,A.x,A.y,A.z,A.x,A.y,A.z),M.push(De,De+1,De+2),I.push(0,0,0,1,1,0)},G=()=>{let J={guid:di(),resolved:!0,positions:new Float32Array(P),normals:new Float32Array(E),faces:new Uint32Array(M),uvs:new Float32Array(I),extraAttrs:new Float32Array([])};return D.length&&(J.colors=new Float32Array(D)),J};if(t.valueType===nn&&!Array.isArray(x)){let J=this.metaData.computedFillOpacity,w=\"\";if(b){let Z=(m=this.metaData.colorLatexValue)!=null?m:this.userData.color;w=a(this.userData,Z)}return p({color:!0},(Z,te)=>{if(Z.valueType===Pr){let[[z,oe,re],[me,ye,De],[K,H,xe]]=Z.asValue();if(X(z,oe,re,me,ye,De,K,H,xe),!b){let[ge,se,ae]=g0(te.color);D.push(ge,se,ae,ge,se,ae,ge,se,ae)}}return[]}),[{meshData:G(),color:w,fillOpacity:J!=null?J:1,graphMode:117}]}return p({color:!0,fillOpacity:!0},(J,w)=>{var H;let[[Z,te,z],[oe,re,me],[ye,De,K]]=J.asValue();return P=[],E=[],M=[],I=[],X(Z,te,z,oe,re,me,ye,De,K),[{meshData:G(),color:a(this.userData,w.color),fillOpacity:(H=w.fillOpacity)!=null?H:1,graphMode:117}]})}case 119:{let b=this.metaData.colorLatexValue?!Array.isArray(this.metaData.colorLatexValue):!0;if(t.valueType===rn&&b&&!Array.isArray(this.metaData.computedLineWidth)){let x=(g=this.metaData.colorLatexValue)!=null?g:this.userData.color,P=this.metaData.computedLineWidth,E=[];return p({color:!0},M=>{if(M.valueType===Rt){let[[I,D,O],[N,A,L]]=M.asValue();E.push(I,D,O,N,A,L,NaN,NaN,NaN)}return[]}),[{graphMode:119,guid:di(),points:E,color:x,thickness:P!=null?P:1}]}return p({color:!0,lineWidth:!0},(x,P)=>{let{lineWidth:E,color:M}=P,I=x.asValue(),[[D,O,N],[A,L,q]]=I;return TN(D,O,N,A,L,q)?[]:[{graphMode:119,guid:di(),points:[D,O,N,A,L,q],color:M,thickness:E}]})}case 129:let d=this.metaData.colorLatexValue?!Array.isArray(this.metaData.colorLatexValue):!0;if(t.valueType===sn&&d&&!Array.isArray(this.metaData.computedLineWidth)){let b=(y=this.metaData.colorLatexValue)!=null?y:this.userData.color,x=this.metaData.computedLineWidth,P=[];return p({color:!0},E=>{if(E.valueType===Ce){let[[M,I,D],[O,N,A]]=E.asValue();P.push(O,N,A,M+O,I+N,D+A)}return[]}),[{graphMode:129,guid:di(),points:P,color:b,thickness:x!=null?x:1}]}return p({color:!0,lineWidth:!0},(b,x)=>{let{lineWidth:P,color:E}=x,M=b.asValue(),[[I,D,O],[N,A,L]]=M;return TN(I,D,O,N,A,L)?[]:[{graphMode:129,guid:di(),points:[N,A,L,I+N,D+A,O+L],color:E,thickness:P}]});case 118:return p({color:!0,resolution:!0,fillOpacity:!0},(b,x)=>{let{color:P,fillOpacity:E}=x,M=b.asValue(),[[I,D,O],N]=M,A=Math.abs(N);return isNaN(I)||isNaN(D)||isNaN(O)||isNaN(N)?[]:[{graphMode:118,position:[I,D,O],radius:[A,A,A],guid:di(),color:P,fillOpacity:E!=null?E:1}]});case 5:case 100:case 101:case 102:{let b=this.userData,x=this.metaData,P=[],E=p({color:!0,lineOpacity:!0,lineWidth:!0,resolution:!0},(I,D)=>{var N;let O=I.getDependencies();if(O.length===0&&!pa(I.valueType)){let{points:A,droppedIndices:L}=ud([I.asValue()]);return[{segments:[A],graphMode:3,droppedIndices:L,color:aa(b,x),style:b.lineStyle,showPoint:!1,poi:Xs(A)}]}else{let A=I.getCompiledFunction(O);D.domain=(N=A.domain)!=null?N:{type:\"1d\",min:this.metaData.evaluatedDomainMin,max:this.metaData.evaluatedDomainMax};let L=Fa({viewState:r,graphInfo:D,compiled:A});return[gN(e,L,r,D.lineWidth)]}}),M=[];for(let I of E)I&&M.push(I);if(c.fill)if(M.forEach((I,D)=>{let{color:O,fillOpacity:N,listIndex:A}=wu(this,D,s);P.push({segments:I.segments,color:O,fillOpacity:N,listIndex:A,graphMode:7,poi:hn()})}),c.lines)M=M.concat(P);else return P;return M}case 20:return p({lineOpacity:!0,lineWidth:!0,color:!0},(b,x)=>{let[[P,E],M]=b.asValue();return isNaN(P)||isNaN(E)||isNaN(M)?[]:[{segments:[[P,E,M]],resolved:!0,graphMode:x.graphMode,color:x.color,style:x.lineStyle,lineWidth:x.lineWidth,lineOpacity:x.lineOpacity,listIndex:x.listIndex,operator:x.operator,poi:hn()}]});case 21:return p({color:!0,lineWidth:!0,lineOpacity:!0},(b,x)=>{let P=Ey(b.asValue());if(!P)return[];let E=[];return P.type===\"arc\"?E.push({graphMode:f,segments:[[P.center[0],P.center[1],P.radius,P.startAngle,P.endAngle]],color:x.color,style:x.lineStyle,lineWidth:x.lineWidth,lineOpacity:x.lineOpacity,listIndex:x.listIndex,operator:n.operator,poi:hn()}):P.type===\"rays\"?E.push({graphMode:19,segments:[[P.start1[0],P.start1[1],P.end1[0],P.end1[1]]],color:x.color,style:x.lineStyle,lineWidth:x.lineWidth,lineOpacity:x.lineOpacity,listIndex:x.listIndex,operator:n.operator,poi:hn()},{graphMode:19,segments:[[P.start2[0],P.start2[1],P.end2[0],P.end2[1]]],color:x.color,style:x.lineStyle,lineWidth:x.lineWidth,lineOpacity:x.lineOpacity,listIndex:x.listIndex,operator:n.operator,poi:hn()}):E.push({graphMode:17,segments:[[P.start[0],P.start[1],P.end[0],P.end[1]]],color:x.color,style:x.lineStyle,lineWidth:x.lineWidth,lineOpacity:x.lineOpacity,listIndex:x.listIndex,operator:n.operator,poi:hn()}),[...E,...bN(E,i)]});case 17:case 18:case 19:return p({color:!0,lineWidth:!0,lineOpacity:!0},(b,x)=>{let[[P,E],[M,I]]=b.asValue();if(isNaN(P)||isNaN(E)||isNaN(M)||isNaN(I))return[];let D=[],O={segments:[[P,E,M,I]],resolved:!0,graphMode:x.graphMode,color:x.color,style:x.lineStyle,arrowMode:x.arrowMode,lineWidth:x.lineWidth,lineOpacity:x.lineOpacity,listIndex:x.listIndex,operator:n.operator,poi:hn()};if(D.push(hN(e,O,r)),D.push(...bN([O],i)),this.userData.showLabel&&n.graphMode===17){let N=x.listIndex,A=this.computedLabels&&this.computedLabels[N||0];D.push({graphMode:22,objectType:17,segments:[[P,E,M,I]],color:x.color,listIndex:N,showLabel:!0,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,labels:A?[A]:[k2(ls(M-P,I-E),r)]})}return D});case 24:return p({lineOpacity:!0,lineWidth:!0,color:!0},(b,x)=>{let[P,E]=b.asValue(),[[M,I],[D,O]]=[E,[E[0]+P[0],E[1]+P[1]]];if(isNaN(D)||isNaN(O)||isNaN(M)||isNaN(I))return[];let N={segments:[[M,I,D,O]],resolved:!0,graphMode:x.graphMode,color:x.color,style:x.lineStyle,arrowMode:x.arrowMode,lineWidth:x.lineWidth,lineOpacity:x.lineOpacity,listIndex:x.listIndex,operator:n.operator,poi:hn()};return[hN(e,N,r)]});case 23:return p({lineOpacity:!0,lineWidth:!0,color:!0},(b,x)=>{let{value:P,valueType:E}=b.asTypedValue(),[[M,I],D,O]=P;if(isNaN(M)||isNaN(I)||isNaN(D)||isNaN(O))return[];let N=x.listIndex,A=E===Ae,L=A?O:Math.abs(O),q=[];if(q.push({graphMode:23,segments:[[M,I,D,O,A?1:0]],color:x.color,style:x.lineStyle,lineWidth:x.lineWidth,lineOpacity:x.lineOpacity,listIndex:N,operator:n.operator,poi:hn()}),this.userData.showAngleLabel){let $=this.computedLabels&&this.computedLabels[N||0];q.push({graphMode:22,objectType:23,segments:[[M,I,D,O]],color:x.color,listIndex:N,showLabel:!0,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,labels:$?[$]:[U2(L,r)]})}return q});case 1:case 2:case 8:case 112:case 126:case 113:case 127:case 6:case 130:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 120:case 121:case 122:case 123:case 124:{let b=t.valueType===T;return p({lineOpacity:!0,lineWidth:!0,resolution:!0,fillOpacity:!0,color:!0},(x,P)=>{var G,J,w,Z,te,z,oe,re,me,ye,De;(n.graphMode===6||n.graphMode===110||n.graphMode===124)&&(P.domain={type:\"1d\",min:this.metaData.evaluatedDomainMin,max:this.metaData.evaluatedDomainMax,isExplicit:this.metaData.isExplicitDomain});let E=(G=us[n.graphMode])!=null?G:[],M=x.getCompiledFunction(E);(n.graphMode==130||n.graphMode==103||n.graphMode==104||n.graphMode==105||n.graphMode==111||n.graphMode==109)&&(P.domain=(J=M.domain)!=null?J:{type:\"2d\",uMin:this.metaData.evaluatedDomain3DMin1,uMax:this.metaData.evaluatedDomain3DMax1,vMin:this.metaData.evaluatedDomain3DMin2,vMax:this.metaData.evaluatedDomain3DMax2});let I=[],D;try{D=x.getCompiledDerivative()}catch(K){}let O=X2(this,x,M,r,P,D,b);if(O)return O;let N=EE(P.graphMode),A=(w=this.userData.extendTo3D)!=null?w:!1,L=N&&!A,q=!e.is3dPolicy()||L,$=(Z=this.userData.lines)!=null?Z:q,X=(te=this.userData.lines)!=null?te:!L;if(P.graphMode===127&&!A&&((z=this.userData.lines)==null||z)){let K=(oe=us[P.graphMode])!=null?oe:[],H=x._chunk.copy();H.GreaterEqual([H.getReturnIndex(),H.Constant(0)]);let xe=x.getCompiledFunction(K),ge=0,se=r.viewport,{xmin:ae,xmax:He,ymin:Pe,ymax:ue}=se,pt=new ie(ae,He),Lo=new ie(Pe,ue),Hu=nh((Id,Th,Ih)=>Ih-ge,se);return[{meshData:Zi(Hu),color:P.color,fillOpacity:(re=P.fillOpacity)!=null?re:1,uvRange:[pt,Lo],uvArgs:(me=us[P.graphMode])!=null?me:[],extraMeshArgs:(ye=Fc[P.graphMode])!=null?ye:[],graphMode:106,compiled:xe,restrictionShader:Jo(H,_u)}]}if(N&&(this.userData.lines===!0?($=L,X=!L):this.userData.lines===!1&&($=!1,X=!1)),X&&ra(P.graphMode)){let K=rh(P.graphMode);if(P.graphMode===113||P.graphMode===127){let{positions:H,normals:xe,faces:ge,uvs:se}=pN(),ae={guid:di(),isDomainCube:!0,resolved:!0,positions:H,normals:xe,faces:ge,uvs:se,extraAttrs:new Float32Array([])},He=x.toImplicitBool();I.push({meshData:ae,graphMode:113,color:P.color,fillOpacity:1,uvRange:[new ie(0,1),new ie(0,1)],uvArgs:[],extraMeshArgs:[],compiled:M,restrictionShader:Jo(He._chunk,_u)});let Pe=MR(He._chunk,x._chunk,K);for(let ue of Pe){let pt=yN(P,{concrete:new dr(ue.value),restriction:ue.restriction&&Jo(ue.restriction,_u)},r);I.push(pt)}}else{let H=x.getRestrictedFunctionForGLSL(K,_u),xe=yN(P,H,r);I.push(xe)}}if($&&$2(this,P),!ra(P.graphMode)){let K=Fa({viewState:r,graphInfo:P,compiled:M,derivative:D}),H=DN(wa(this),x);if(H&&(K.boundingBox=H),e.is3dPolicy()&&$&&R0(K.graphMode)){let xe=(De=P.lineWidth)!=null?De:1;I.push(Zg(K,r,xe))}else if(K.fillSegments){let{fillSegments:xe,...ge}=K;$||(ge.lineWidth=0),I.push(ge)}else $||(K.lineWidth=0),($||!ra(n.graphMode))&&I.push(K);P.graphMode===8&&P.operator!==\"=\"&&I.push({graphMode:7,segments:K.fillSegments,poi:hn(),listIndex:P.listIndex,color:P.color,fillOpacity:P.fillOpacity})}return I})}case 200:case 201:case 202:case 206:case 205:case 211:case 203:case 204:case 213:case 207:case 208:case 212:case 214:case 215:case 209:return p({color:!0,lineWidth:!0,lineOpacity:!0,resolution:!0},(b,x)=>{var G;switch(f){case 206:case 211:x.domain={type:\"1d\",min:this.metaData.evaluatedDomainMin,max:this.metaData.evaluatedDomainMax,isExplicit:this.metaData.isExplicitDomain};break;case 203:case 204:case 213:case 207:case 208:case 212:case 214:case 215:x.domain={type:\"2d\",uMin:this.metaData.evaluatedDomain3DMin1,uMax:this.metaData.evaluatedDomain3DMax1,vMin:this.metaData.evaluatedDomain3DMin2,vMax:this.metaData.evaluatedDomain3DMax2};break}let P=(G=us[f])!=null?G:[],E={allowSlices:!0},M=Aa(b._chunk,P,E),{valueChunk:I,slices:D}=M.getValueAndRestrictionChunk(),O=I.getCompiledFunction(P),N=D[0],A=N.type===\"implicit\",L=A?NaN:N.value,q=A?\"_implicit\":N.variable,$,X=J=>Fa({viewState:r,graphInfo:{...x,slice_coordinate:q,slice_value:L,slice_function:J},compiled:O});if(A){let J=[\"x\",\"y\",\"z\"],w=[\"x\",\"y\",\"z\",\"r\",\"theta\"],Z=[\"x\",\"y\",\"z\",\"rho\",\"theta\",\"phi\"],te=[\"x\",\"y\",\"z\",\"u\",\"v\"],z=N.sliceChunk;switch(f){case 200:case 201:case 202:$=z.getCompiledFunction(J);break;case 211:case 213:$=z.getCompiledFunction(w);break;case 212:$=z.getCompiledFunction(Z);break;case 215:case 214:$=z.getCompiledFunction(te);break;case 209:{let oe=(ye,De)=>{let K=De.getCompiledFunction(J),H=ye._symbol,xe=ye._expression.args,ge=[];for(let se of xe){if(!(se instanceof dr))throw ee(\"Programming Error: bad type\");if(H===\"x\")O=se._chunk.getCompiledFunction([\"y\",\"z\"]),x.graphMode=201;else if(H===\"y\")O=se._chunk.getCompiledFunction([\"x\",\"z\"]),x.graphMode=202;else if(H===\"z\")O=se._chunk.getCompiledFunction([\"x\",\"y\"]),x.graphMode=200;else throw ee(\"Programming Error: bad lhs\");ge.push(X(K))}return ge},re=(ye,De)=>{let K=r.viewport,H=De.getCompiledFunction(J),xe=ye.getCompiledFunction(J).fn,ge=D0(xe,K);if(ge){let{explicitPlane:se,u:ae,v:He}=ge;return x.graphMode=214,O={args:[\"u\",\"v\"],source:\"\",constants:[],fn:se,executionMetadata:{}},x.domain={type:\"2d\",uMin:ae.min,uMax:ae.max,vMin:He.min,vMax:He.max},[X(H)]}else return[]};if(z.isImplicitPlane())return re(z,I);if(I.isImplicitPlane())return re(I,z);let me=E0(e,I);return me instanceof v.SolvedEquation&&!me.isError?oe(me,z):(me=E0(e,z),me instanceof v.SolvedEquation&&!me.isError?oe(me,I):[X(z.getCompiledFunction(J))])}}}return[X($)]});case 210:return p({color:!0,fillOpacity:!0,resolution:!0},(b,x)=>{var ye,De,K,H,xe,ge,se,ae;let P=(ye=us[f])!=null?ye:[],E={allowSlices:!0},M=Aa(b._chunk,P,E),{restrictionChunk:I,slices:D}=M.getSlicesAndRestrictionChunk(),O=I.getCompiledFunction(P);if(D[0].type===\"implicit\"){let He=D[0].sliceChunk,Pe;try{Pe=He.copy().gradient([\"x\",\"y\",\"z\"]).getCompiledFunction([\"x\",\"y\",\"z\"]).fn}catch(Ih){}let ue=(De=x.resolution)!=null?De:NaN;isNaN(ue)&&(ue=od),ue=on(ue,0,100);let pt=l0(He.getCompiledFunction(P),void 0,Pe,r.viewport,ue,{isInequality:!1}),{xmin:Lo,xmax:ka,ymin:Hu,ymax:qc}=r.viewport,Td=new ie(Lo,ka),Id=new ie(Hu,qc);return[{meshData:pt,color:x.color,fillOpacity:(K=x.fillOpacity)!=null?K:1,uvRange:[Td,Id],uvArgs:(H=us[x.graphMode])!=null?H:[],extraMeshArgs:(xe=Fc[x.graphMode])!=null?xe:[],graphMode:f,compiled:O,restrictionShader:Jo(I,_u)}]}let N=D[0].value,A=D[0].variable,L=r.viewport,{xmin:q,xmax:$,ymin:X,ymax:G,zmin:J,zmax:w}=L,Z,te,z;switch(A){case\"x\":Z=new ie(X,G),te=new ie(J,w),z=(He,Pe,ue)=>He-N;break;case\"y\":Z=new ie(q,$),te=new ie(J,w),z=(He,Pe,ue)=>Pe-N;break;case\"z\":Z=new ie(q,$),te=new ie(X,G),z=(He,Pe,ue)=>ue-N;break;default:return[]}let oe=nh(z,L);return[{meshData:Zi(oe),color:x.color,fillOpacity:(ge=x.fillOpacity)!=null?ge:1,uvRange:[Z,te],uvArgs:(se=us[x.graphMode])!=null?se:[],extraMeshArgs:(ae=Fc[x.graphMode])!=null?ae:[],graphMode:f,compiled:O,restrictionShader:Jo(I,_u)}]});case 16:{let b=[],x=this.userData.lines===void 0?!0:this.userData.lines,P=this.userData.fill===void 0?!0:this.userData.fill;if(!P&&!x)return b;let E=Hc(this.metaData,[\"computedLineOpacity\",\"computedLineWidth\",\"colorLatexValue\",\"fillOpacity\"],s),M=t.asValue();W(t.valueType)||(M=[M]);for(let I=0;I<M.length;I++){if(I>E-1)continue;let D=M[I];if(!D.length)continue;let O=this.getGraphInfo(e,t),{listIndex:N,lineWidth:A,lineOpacity:L,fillOpacity:q,color:$}=wu(this,I,s);this.userData.shouldOmitLastPolygonSegment||(D=[...D,D[0]]),qn(D);let X=PN(D);if(X.length&&(P&&b.push({segments:X,graphMode:7,poi:hn(),color:$,fillOpacity:q,style:O.style,listIndex:N}),x&&b.push({segments:X,graphMode:5,poi:hn(),color:$,style:this.userData.lineStyle,lineWidth:A,lineOpacity:L,listIndex:N}),z2&&this.userData.showLabel)){let G=this.computedLabels&&this.computedLabels[N||0];b.push({graphMode:22,objectType:16,segments:X,color:$,listIndex:N,showLabel:!0,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,labels:G?[G]:[H2(kT(D),r)]})}}return b}case 7:case 11:case 10:case 15:case 22:case 128:return!1;default:let h=f;throw new Error(`Unexpected graphMode: ${h}`)}}function yN(e,t,r){var c,l,p;let n=(c=us[e.graphMode])!=null?c:[],i=t.concrete.getCompiledFunction(n),s,o,a=!1;if(e.graphMode===112||e.graphMode===126||e.graphMode===113){e.operator!==\"=\"&&(a=!0);try{s=t.concrete.gradient([\"x\",\"y\",\"z\"])._chunk,o=s.getCompiledFunction([\"x\",\"y\",\"z\"]).fn}catch(f){}}if(e.graphMode===112&&o&&s){let f=Y2(i.fn,o,s,r.viewport);if(f)return{graphMode:118,position:f.center,radius:f.radii,guid:di(),color:e.color,restrictionShader:t.restriction,fillOpacity:(l=e.fillOpacity)!=null?l:1}}let u=e.graphMode;if((u===112||u===113||u===127||u===106||u===107||u===108)&&t.concrete._chunk.isLinearIn([\"x\",\"y\",\"z\"])){let f=r.viewport,m,g,y;switch(u){case 106:m=(b,x,P)=>P-i.fn(b,x),g=new ie(f.xmin,f.xmax),y=new ie(f.ymin,f.ymax);break;case 107:m=(b,x,P)=>b-i.fn(x,P),g=new ie(f.ymin,f.ymax),y=new ie(f.zmin,f.zmax);break;case 108:m=(b,x,P)=>x-i.fn(b,P),g=new ie(f.xmin,f.xmax),y=new ie(f.zmin,f.zmax);break;case 112:case 113:case 127:m=i.fn,g=new ie(f.xmin,f.xmax),y=new ie(f.ymin,f.ymax);break}let d=Zi(nh(m,f)),h=u===113||u===127;return u===127&&(u=113),{meshData:d,color:e.color,fillOpacity:h?1:(p=e.fillOpacity)!=null?p:1,uvRange:[g,y],uvArgs:[],extraMeshArgs:[],graphMode:u,compiled:i,restrictionShader:t.restriction}}return Fa({viewState:r,graphInfo:e,compiled:i,restrictionShader3d:t.restriction,isImplicit3dInequality:a,gradient:o,dependencies:t.concrete._dependencies})}function $2(e,t){var n,i,s;if(EE(t.graphMode))switch(t.graphMode){case 121:case 123:{t.graphMode=2,t.willConvertTo3D=!0,(n=t.lineWidth)!=null||(t.lineWidth=1);break}case 120:case 122:{t.graphMode=1,t.willConvertTo3D=!0,(i=t.lineWidth)!=null||(t.lineWidth=1);break}case 124:let{min:o,max:a}=((s=t.domain)==null?void 0:s.type)===\"1d\"?t.domain:{min:0,max:2*Math.PI};t.graphMode=6,t.domain={type:\"1d\",min:o,max:a,isExplicit:e.metaData.isExplicitDomain};break;case 126:t.graphMode=8;break}}function Y2(e,t,r,n){if(n.zmin===void 0||n.zmax===void 0)return;let i=r.argNames.indexOf(\"x\"),s=r.argNames.indexOf(\"y\"),o=r.argNames.indexOf(\"z\");if(i===-1||s===-1||o===-1)return;let a=r.getInstruction(r.getReturnIndex());if(a.type!==38||a.args.length!==3)return;let[u,c,l]=a.args,p=Fn(r,i,{allowRestriction:!1,allowClosedBlockReferences:!1}),f=Fn(r,s,{allowRestriction:!1,allowClosedBlockReferences:!1}),m=Fn(r,o,{allowRestriction:!1,allowClosedBlockReferences:!1});if(nr(p,u)!==1||nr(f,c)!==1||nr(m,l)!==1||nr(f,u)!==0||nr(m,u)!==0||nr(p,c)!==0||nr(m,c)!==0||nr(p,l)!==0||nr(f,l)!==0)return;let{xmin:g,ymin:y,zmin:d,xmax:h,ymax:b,zmax:x}=n,P=t(g,y,d),E=t(h,b,x),M=.5*(E[0]-P[0])/(h-g),I=.5*(E[1]-P[1])/(b-y),D=.5*(E[2]-P[2])/(x-d),O=(g*E[0]-h*P[0])/(E[0]-P[0]),N=(y*E[1]-b*P[1])/(E[1]-P[1]),A=(d*E[2]-x*P[2])/(E[2]-P[2]),L=-e(O,N,A),q=Math.sqrt(L/M),$=Math.sqrt(L/I),X=Math.sqrt(L/D);if(!(!isFinite(O)||!isFinite(N)||!isFinite(A)||!isFinite(q)||!isFinite($)||!isFinite(X)||q===0||$===0||X===0))return{center:[O,N,A],radii:[q,$,X]}}function X2(e,t,r,n,i,s,o){let a=e.metaData.evaluatedCDFMin,u=e.metaData.evaluatedCDFMax,c=wa(e),l=DN(c,t),p=c&&c.discrete;if(a!==void 0&&u!==void 0&&!isNaN(a)&&!isNaN(u)&&o){let f=[];if(p){let m={viewState:n,graphInfo:i,compiled:r,bounds:[a,u],maxOverride:xN(c,t),showPoint:e.userData.shouldGraph},g=qC(m),y=g.cdfTopBranch,d=g.topBranches;if(d.forEach(function(h){!h||!l||(h.boundingBox=l)}),d.every(h=>h!==void 0)&&(f=d,y&&y.segments[0].length)){let h=[];y.segments[0].forEach(function(b){!isNaN(b[0])&&!isNaN(b[1])&&h.push([b[0],0,b[0],b[1]])}),f.push({graphMode:5,segments:h,boundingBox:l,poi:hn(),color:i.color})}}else{let g=$C({viewState:n,graphInfo:i,compiled:r,derivative:s,bounds:[a,u]}),y=g.cdfTopBranch,d=g.topBranches;if(d.forEach(function(h){!h||!l||(h.boundingBox=l)}),f=d,y&&y.segments.length){let h,b;for(let x=0;x<y.segments.length;x++){let P=y.segments[x];if(P.length>=4){h=P[0];break}}for(let x=y.segments.length-1;x>=0;x--){let P=y.segments[x];if(P.length>=4){b=P[P.length-2];break}}if(h!==void 0&&b!==void 0&&isFinite(h)&&isFinite(b)){let x=Yg(y.segments,[[h,0,b,0]],y.graphMode);f.push({graphMode:7,segments:x,poi:hn(),color:i.color})}}}return f}else if(p){let f=$g({viewState:n,graphInfo:i,compiled:r,showPoint:e.userData.shouldGraph,maxOverride:xN(c,t)});return l&&(f.boundingBox=l),[f]}else return}function IN(e){return Z2(e)||R0(e)||EN(e)}function Z2(e){return e===3}function S0(e,t){let r=t!=null?t:{};if(!Array.isArray(e))return()=>e;let n=Object.keys(r).length===0?e:e.filter((i,s)=>!r[s]);return i=>n[i]}function W2(e){var s,o;let t=e.droppedIndices,r=S0((s=e.pointSize)!=null?s:1,t),n=S0(e.color,t),i=S0((o=e.pointOpacity)!=null?o:1,t);return e.segments[0].map(([a,u],c)=>({graphMode:114,position:[a,u,0],radius:.02*r(c),guid:di(),color:n(c),fillOpacity:i(c)}))}function gN(e,t,r,n){return e.is3dPolicy()&&R0(t.graphMode)?Zg(t,r,n!=null?n:1):t}function R0(e){switch(e){case 1:case 2:case 6:case 8:case 5:return!0;default:return!1}}function Zg(e,t,r,n=0){var o;let i=MN(e,t,n),s=Wg(i,t.viewport,r);return{graphMode:128,guid:di(),points:s,resolved:e.resolved,color:e.color,thickness:(o=e.lineWidth)!=null?o:1}}function hN(e,t,r){return e.is3dPolicy()&&EN(t.graphMode)?j2(t,r):t}function EN(e){switch(e){case 17:case 24:return!0;default:return!1}}function j2(e,t){var n;let r=MN(e,t);return{graphMode:e.graphMode===17?119:e.graphMode===24?129:128,guid:di(),points:J2(r),color:e.color,thickness:(n=e.lineWidth)!=null?n:1}}function J2(e){let t=[];for(let[r,n,i]of e)t.push(r,n,i);return t}function MN(e,t,r=0){function n(s,o){if(e.graphMode===1)return[o,s];if(e.graphMode===6){let a=t.degreeMode?s*Math.PI/180:s;return[o*Math.cos(a),o*Math.sin(a)]}else return[s,o]}let i=[];for(let s=0;s<e.segments.length;s++){let o=e.segments[s];for(let a=0;a<o.length/2;a++){let[u,c]=n(o[2*a],o[2*a+1]);i.push([u,c,r])}s<e.segments.length-1&&i.push([NaN,NaN,0])}return i}function Wg(e,t,r){if(t.zmin===void 0||t.zmax===void 0)return[];let{xmin:n,xmax:i,ymin:s,ymax:o,zmin:a,zmax:u}=t,c=i-n,l=o-s,p=u-a,f=r/200,m=[],g=1e-4;for(let h=0;h<e.length;h++){let b=e[h];if(isFinite(b[0])&&isFinite(b[1])&&isFinite(b[2])){let x=m[m.length-1];x!==void 0&&Math.abs(b[0]-x[0])<g*c&&Math.abs(b[1]-x[1])<g*l&&Math.abs(b[2]-x[2])<g*p||m.push(b)}else m.push(void 0)}let y=[],d=m.length;for(let h=0;h<d;h++){let b=m[h];if(!b){y.push(NaN,NaN,NaN);continue}let[x,P,E]=b,M=m[h-1],I=m[h+1];if(M&&I){let[D,O,N]=M,[A,L,q]=I,$=(x-D)/c,X=(A-x)/c,G=(P-O)/l,J=(L-P)/l,w=(E-N)/p,Z=(q-E)/p,te=go($,G,w),z=go(X,J,Z);if((X*$+J*G+Z*w)/(te*z)<.7&&te>f&&z>f){let re=.5*(f/te),me=.5*(f/z),ye=no(D,x,1-re),De=no(O,P,1-re),K=no(N,E,1-re),H=no(x,A,me),xe=no(P,L,me),ge=no(E,q,me);y.push(ye,De,K),y.push(no(ye,x,.5),no(De,P,.5),no(K,E,.5)),y.push(x,P,E),y.push(no(x,H,.5),no(P,xe,.5),no(E,ge,.5)),y.push(H,xe,ge)}else y.push(x,P,E)}else y.push(x,P,E)}return y}function no(e,t,r){return(1-r)*e+r*t}function Q2(e){return e.startsWith(\"shader:\")}function sh(e,t,r){return{resolved:!0,graphMode:t,segments:r,operator:e.operator,poi:hn(),color:e.color,style:\"DASHED\",lineWidth:1,lineOpacity:.5,isIntersectionExtension:!0}}function bN(e,t){var n,i;if(!t)return[];let r=[];for(let s of e)if(s.graphMode===17){let o=t[(n=s.listIndex)!=null?n:0];if(!o)continue;let a=0,u,c=1,l,[p,f,m,g]=s.segments[0];for(let y=0;y<o.length;y++){let[d,h]=o[y],b=Ls(d,h,0,p,f,0,m,g,0);b<a&&(a=b,u=y),s.graphMode===17&&b>c&&(c=b,l=y)}u!==void 0&&r.push(sh(s,17,[[p,f,o[u][0],o[u][1]]])),l!==void 0&&r.push(sh(s,17,[[m,g,o[l][0],o[l][1]]]))}else if(s.graphMode===21){let o=t[(i=s.listIndex)!=null?i:0];if(!o)continue;let[a,u,c,l,p]=s.segments[0],f=p-l+(p<l?1:-1)*2*Math.PI,m=[];for(let g of o){let[y,d]=g,h=Math.atan2(d-u,y-a),b=yM(h,l,f);0<b&&b<1&&m.push(b)}if(m.length){m.push(0,1),m.sort();let g=0,y=0;for(let b=0;b<m.length-1;b++){let x=m[b+1]-m[b];(g===void 0||x>g)&&(g=x,y=b)}let d=m[y],h=m[y+1];d>0&&r.push(sh(s,21,[[a,u,c,l,l+d*f]])),h<1&&r.push(sh(s,21,[[a,u,c,p,p-(1-h)*f]]))}}return r}function K2(){throw new Error(\"Programming error: this function is not expected to be called\")}function vN(e,t,r,n){let i=[];for(let s=0;s<t.otherVariableSolutionData.length;s++){let o=t.otherVariableSolutionData[s];if(!o)continue;let{coefficients:a,restriction:u}=o,c=a.argNames[0];if(c!==\"x\"&&c!==\"y\")continue;let l=a.getCompiledFunction().fn,p,f;c===\"y\"?(p=1,f=2):(p=2,f=1);let m=void 0,{listIndex:g,style:y,lineWidth:d,lineOpacity:h,color:b}=wu(e,s,m),x=yp(r,{graphMode:p,domainBound:Xr(),lineWidth:d,operator:\"=\"},K2);if(!x)continue;let P=VC(l,x);for(let E of P){let M=new dr(u.substituteConstantArguments({[c]:E})),I=e.getGraphInfo(n,M);I={...I,graphMode:f,lineWidth:d};let O=e._graph(n,M,r,I,void 0,t.branchMultiplier===2?\"solvedEquation\":void 0);if(bo(O))for(let N of O)i.push({...N,listIndex:g,style:y,lineWidth:d,lineOpacity:h,color:b})}}return i.length>0?i:!1}v.Base.prototype.tryGraph=function(e,t,r,n){var i;try{let s=this.graph(e,t,r,n);if(Array.isArray(s))for(let o of s)\"compiled\"in o&&((i=o.compiled)!=null&&i.executionMetadata.recursiveDepthError)&&(o.hasRecursiveDepthError=!0);return s}catch(s){let o=s instanceof v.Error?s.getError():ee(s).getError();return[wC(o)]}};v.Base.prototype.graph=function(e,t,r,n){let i=this.getGraphInfo(e,t);return this._graph(e,t,r,i,n)};v.BaseComparator.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t),i=n.graphMode,s=\"baseComparator\",o=this.userData.lines===void 0?!0:this.userData.lines;if(i===8||i===112||i===113||i===127||i===210)return this._graph(e,t,r,n);if(i===10||!(t instanceof v.SolvedEquation))return!1;let a=this.getOperator(),u=[],c=[],l=!0;t._expression.eachElement(function(d){u.push(d.getCompiledFunction());try{c.push(d.getCompiledDerivative())}catch(h){l=!1}}),l||(c=void 0);let p=[],f=[-1,0,0,1],m=Hc(this.metaData,[\"computedLineWidth\",\"computedLineOpacity\",\"computedFillOpacity\",\"colorLatexValue\"],s),g=Math.min(u.length,m);for(let d=0;d<g;d++){let h=this.getGraphInfo(e,t._expression.args[d]);h.graphMode=i;let{listIndex:b,style:x,color:P,lineWidth:E,lineOpacity:M,fillOpacity:I}=wu(this,d,s);h.listIndex=b,h.style=x,h.color=P,n.graphMode===6&&(h.domain={type:\"1d\",min:this.metaData.evaluatedDomainMin,max:this.metaData.evaluatedDomainMax,isExplicit:this.metaData.isExplicitDomain});let D=Fa({viewState:r,graphInfo:h,compiled:u[d],derivative:c?c[d]:void 0});D.lineWidth=E,D.lineOpacity=M,D.fillOpacity=I,D.operator=Ku(_n[a].inclusive,f[d%4]),o||(D.lineWidth=0),p.push(D)}for(let d=0;d<g;d+=4){let h=Yg(p[d+1].segments,p[d+2].segments,i);p.push({graphMode:7,listIndex:p[d].listIndex,segments:h,poi:hn(),fillOpacity:p[d].fillOpacity,color:p[d].color})}let y=vN(this,t,r,e);if(y){for(let d of y)d.operator=Ku(_n[a].inclusive,0);Array.prototype.push.apply(p,y)}return p};v.DoubleInequality.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t);if(n.graphMode===10)return!1;let i=[],s=Ku(_n[this._operators[0]].inclusive,0),o=Ku(_n[this._operators[1]].inclusive,0),a=this.userData,u=this.metaData,c=a.lines===void 0?!0:a.lines,l=[\"colorLatexValue\",\"computedFillOpacity\"];c&&l.push(\"computedLineWidth\",\"computedLineOpacity\");let p=Hc(u,l),f=t._expressions;return qn(f),oh.eachArgs(f,(m,g)=>{let y=g;if(y>=p)return;m[0].userData=m[1].userData=a,m[0].metaData=m[1].metaData=u;let d=void 0,{color:h,lineWidth:b,lineOpacity:x,fillOpacity:P}=wu(this,y,d),E=this._graph(e,m[0],r,n)[0];E.listIndex=y,E.operator=s,E.color=h,E.lineWidth=b,E.lineOpacity=x,i.push(E);let M=this._graph(e,m[1],r,n)[0];M.listIndex=y,M.operator=o,M.color=h,M.lineWidth=b,M.lineOpacity=x,i.push(M);let I=E.segments,D=M.segments;qn(I),qn(D);let O=Yg(I,D,E.graphMode);c||(E.lineWidth=0,M.lineWidth=0),i.push({graphMode:7,listIndex:E.listIndex,segments:O,lineOpacity:x,fillOpacity:P,poi:hn(),color:h})}),i};v.Regression.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t);return this._graph(e,t.model,r,n)};function C0(e,t){let r=1/0,n=-1/0,i=1/0,s=-1/0;for(let a of t)for(var o=0;o<a.length;o+=2){let u=a[o],c=a[o+1];u<r&&(r=u),u>n&&(n=u),c<i&&(i=c),c>s&&(s=c)}if(isFinite(r)&&isFinite(i))return{type:e,xmin:r,ymin:i,xmax:n,ymax:s}}function DN(e,t){if(!e||!(t instanceof dr))return;let r=t._chunk,n=r.getInstruction(r.getReturnIndex());if(n.type!==37)return;let i=e.discrete?\"discreteDistribution\":\"continuousDistribution\";if(e.symbol===\"binomialdist\"&&n.symbol===\"binompdf\"){let s=ur(r,n.args[1]),o=ur(r,n.args[2]),a=Py(o*s,s,o);return{type:i,xmin:0,xmax:s,ymin:0,ymax:a}}if(e.symbol===\"poissondist\"&&n.symbol===\"poissonpdf\"){let s=ur(r,n.args[1]),o=Math.max(Gl(Math.floor(s),s),Gl(Math.ceil(s),s));return{type:i,xmin:0,xmax:2.5*s,ymin:0,ymax:o}}if(e.symbol===\"normaldist\"&&n.symbol===\"normalpdf\"){let s=ur(r,n.args[1]),o=ur(r,n.args[2]),a=NT(s,s,o);return{type:i,xmin:s-2*Math.abs(o),xmax:s+2*Math.abs(o),ymin:0,ymax:a}}if(e.symbol===\"uniformdist\"&&n.symbol===\"uniformpdf\"){let s=ur(r,n.args[1]),o=ur(r,n.args[2]),a=(s+o)/2,u=o-s,c=LT(a,s,o);return{type:i,xmin:s-u/3,xmax:o+u/3,ymin:0,ymax:c}}if(e.symbol===\"tdist\"&&n.symbol===\"tpdf\"){let s=ur(r,n.args[1]),o=xy(0,s);return{type:i,xmin:-3,xmax:3,ymin:0,ymax:o}}}function xN(e,t){if(e===void 0||e.symbol!==\"binomialdist\"||!(t instanceof dr))return;let r=t._chunk,n=r.getInstruction(r.getReturnIndex());if(n.type===37&&n.symbol===\"binompdf\")return ur(r,n.args[1])}function SN(e,t,r){let n={};r-=.5*t;for(var i=e.length-1;i>=0;i--){let s=e[i],o=Math.floor((s-r)/t);n[o]?n[o].data.push(s):n[o]={id:o,data:[s],min:o*t+r,max:o*t+r+t,center:o*t+r+t/2}}return n}v.Histogram.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t),i=t.args[0].asValue(),s=t.args[1].asValue(),o=this.userData.vizProps&&this.userData.vizProps.binAlignment===\"left\"?s/2:0;qn(i);let a=SN(i,s,o),u=1;this.userData.vizProps&&this.userData.vizProps.histogramMode===\"density\"?u=1/(i.length*s):this.userData.vizProps&&this.userData.vizProps.histogramMode===\"relative\"&&(u=1/i.length);let c=[],l=[];for(let f in a){let m=a[f],g=m.data.length;l.push([m.min,0*u,m.min,g*u,m.max,g*u,m.max,0*u]);let y=0;a[m.id+1]&&(y=a[m.id+1].data.length);let d=[m.min,0*u,m.min,g*u,m.max,g*u];y<g&&d.push(m.max,y*u),c.push(d)}let p=C0(\"histogram\",l);return p&&s&&(p.binWidth=s),[{segments:l,graphMode:7,boundingBox:p,poi:hn(),color:n.color,fillOpacity:.4},{segments:c,graphMode:2,poi:{zeros:{x:[],y:[]},extrema:{x:[],y:[]},intercept:{x:[],y:[]}},color:n.color}]};v.DotPlot.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t),i=t.args[1].asValue(),s=this.userData.vizProps&&this.userData.vizProps.binAlignment===\"left\"?i/2:0,o=t.args[0].asValue();qn(o);let a=SN(o,i,s),u=!1,c,l=[];for(let h in a){let b=a[h];for(var p=b.data.length-1;p>=0;p--)b.center!==b.data[p]&&(u=!0)}if(this.userData.vizProps&&this.userData.vizProps.dotplotXMode===\"exact\")for(let h in a){c=a[h].data,c.reverse();for(let x=0;x<c.length;x++)l.push([c[x],x+1])}else for(let h in a){let b=a[h];c=b.data;for(let x=0;x<c.length;x++)l.push([b.center,x+1])}let f=C0(\"dotplot\",l);f&&i&&(f.ymin=0,f.xmin-=.5*i,f.xmax+=.5*i,f.binWidth=i);let{computedPointOpacity:m,computedPointSize:g}=this.metaData,y=Ba(m,0),d=this.userData.pointSize?Ba(g,0):14;return[{segments:[l],graphMode:3,boundingBox:f,poi:Xs(l),color:n.color,style:this.userData.pointStyle,pointSize:d,pointOpacity:y,showPoint:!0,needsDotplotXMode:u}]};v.BoxPlot.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t),i=this.metaData.evaluatedAxisOffset,s=this.metaData.evaluatedBreadth,o=t.args[0].asValue();if(qn(o),isNaN(s)||isNaN(i))return!1;let a=Math.min.apply(null,o),u=Math.max.apply(null,o),c=Ic(o,1),l=Ic(o,2),p=Ic(o,3),f=i,m=f-s/2,g=f+s/2,y=s/10,d=[];if(this.userData.vizProps.showBoxplotOutliers){let P=p-c,E=c-1.5*P,M=p+1.5*P;a=1/0,u=-1/0,o.forEach(function(I){E<=I&&I<a&&(a=I),u<I&&I<=M&&(u=I),(I<E||I>M)&&d.push([I,f])})}let h=[[c,m,p,m,p,g,c,g,c,m],[l,m,l,g],[c,f,a,f],[p,f,u,f],[a,f-y,a,f+y],[u,f-y,u,f+y]];if(this.userData.vizProps&&this.userData.vizProps.alignedAxis===\"y\"){for(let P of h)for(var b=0;b<P.length;b+=2){let E=P[b];P[b]=P[b+1],P[b+1]=E}for(let P of d){let E=P[0];P[0]=P[1],P[1]=E}}let x=[{segments:h,graphMode:5,boundingBox:C0(\"boxplot\",h.concat(d)),poi:hn(),color:n.color}];return d.length&&x.push({segments:[d],graphMode:3,color:n.color,style:\"OPEN\",showPoint:!0,poi:Xs(d)}),x};function ez(e){return Array.prototype.concat.apply([],e)}v.Table.prototype.isValueDraggable=function(e,t,r){if(!e.columns[t].isIndependent)return!1;let i=this.columns[t].values,s=i&&i[r];return!!(s&&isFinite(s.asValue())&&s.getDependencies().length===0)};v.Table.prototype.graph=function(e,t,r){let n={};if(t.columns[0].isError)return n;let s=t.columns[0].values;for(let o=1;o<this.columns.length;o++){let a=t.columns[o];if(a.isError)continue;let u=this.columns[o].header.userData,c=this.columns[o].header.metaData;if(u.hidden)continue;let l=Hc(c,[\"colorLatexValue\",\"computedPointSize\",\"computedPointOpacity\"]),p=u.dragMode,f=p===\"X\"||p===\"XY\",m=p===\"Y\"||p===\"XY\",g=!!u.points,y=!!u.lines,d=[],h=[],b=[],x=[],P=[],E=[],M=1/0,I=-1/0,D=1/0,O=-1/0,N={};for(let L=0;L<s.length;L++){let q=s[L],$=a.values[L];if(!q||!$||!isFinite(q.asValue())||!isFinite($.asValue())){N[L]=!0,y&&(E.length>1&&P.push(E),E=[]);continue}let X=q.asValue(),G=$.asValue();if(g){if(L>=l)continue;let J=f&&this.isValueDraggable(t,0,L),w=m&&this.isValueDraggable(t,o,L);J||w?(b.push([X,G]),x.push({index:L,dragX:J,dragY:w})):h.push([X,G])}y&&E.push([X,G]),X<M&&(M=X),X>I&&(I=X),G<D&&(D=G),G>O&&(O=G)}let A={type:\"table\",xmin:M,xmax:I,ymin:D,ymax:O};b.length&&d.push({graphMode:4,segments:[b],color:c.colorLatexValue||u.color,tableId:u.tableId,poi:Xs(b),movablePointInfo:x,boundingBox:A,pointOpacity:c.computedPointOpacity,pointSize:c.computedMovablePointSize}),h.length&&d.push({segments:[h],droppedIndices:N,graphMode:3,showPoint:!0,poi:Xs(h),color:c.colorLatexValue||u.color,pointSize:c.computedPointSize,pointOpacity:c.computedPointOpacity,style:u.pointStyle,tableId:u.tableId,boundingBox:A}),(P.length||E.length)&&(P.push(E),d.push({segments:P.map(ez),graphMode:5,poi:hn(),color:aa(u,c),style:u.lineStyle,lineWidth:Array.isArray(c.computedLineWidth)?c.computedLineWidth[0]:c.computedLineWidth,lineOpacity:Array.isArray(c.computedLineOpacity)?c.computedLineOpacity[0]:c.computedLineOpacity,tableId:u.tableId,boundingBox:A})),d.length&&(n[u.id]=d)}return n};function tz(e,t,r){return e?t===0&&r===0?e[2].type!==\"none\"||e[3].type!==\"none\":t!==0&&r!==0?e[0].type!==\"none\"&&e[1].type!==\"none\":t!==0?e[0].type!==\"none\":r!==0?e[1].type!==\"none\":!1:!1}v.Image.prototype.graph=function(e,t,r){let n=[];if(t.center.valueType!==C||t.center.getDependencies().length!==0||!t.radianAngle.isConstant||!t.width.isConstant||!t.height.isConstant||!t.opacity.isConstant)return n;let i=[],s=[],o=t.width.asValue()/2,a=t.height.asValue()/2,u=t.radianAngle.asValue();for(var c=-1;c<=1;c++)for(var l=-1;l<=1;l++){let[p,f]=t.center.asValue(),m=[p+c*o*Math.cos(u)+l*a*Math.sin(u),f-c*o*Math.sin(u)+l*a*Math.cos(u)];tz(t.moveStrategy,c,l)&&(i.push(m),s.push([c,l]))}return n.push({segments:[i],scaleFactors:[s],graphMode:4,color:aa(this.userData,this.metaData),style:this.userData.style,poi:Xs(i),movablePointInfo:[],pointOpacity:1}),n};function PN(e){let t=[],r=[];for(let[n,i]of e)!isNaN(n)&&!isNaN(i)?t.push(n,i):(t.length>=4&&r.push(t),t=[]);return t.length>=4&&r.push(t),r}function TN(...e){return e.some(t=>isNaN(t))}function rz(e){return e.isError?e.getError():e.asValue()===void 0?\"\":+e.asValue()}function nz(e,t,r){let n=[];for(var i=0;i<t.columns.length;i++){let s=r.columns[i],o=s.isError?[]:s.values.map(rz),a={dependent:!s.isIndependent,discrete:!!s.isIndependent,values:o};s.isError&&(a.error=s.getError()),n.push(a)}return{column_data:n}}function iz(e,t,r){let n={variables:[],errorMap:{},dimensions:{}};if(e.areAllScalesLinear()||(n.errorMap.scale=!0),r.center.isError&&(n.errorMap.center=!0),r.radianAngle.isError&&(n.errorMap.angle=!0),r.width.isError&&(n.errorMap.width=!0),r.height.isError&&(n.errorMap.height=!0),r.opacity.isError&&(n.errorMap.opacity=!0),Object.keys(n.errorMap).length>0)return n.variables=t.getSliderVariables(e,r),n;n.dimensions.x=[],n.dimensions.y=[],n.dimensions.radianAngle=[],n.dimensions.width=[],n.dimensions.height=[],n.dimensions.opacity=[];let i=[r.center,r.radianAngle,r.width,r.height,r.opacity];return i.some(o=>o&&o.valueType&&W(o.valueType))&&(n.is_concrete_list=!0),v.List.eachArgs(i,function(o){let a=o[0].asValue(),u=+o[1].asValue(),c=Math.atan2(Math.sin(u),Math.cos(u));n.dimensions.x.push(+a[0]),n.dimensions.y.push(+a[1]),n.dimensions.radianAngle.push(c),n.dimensions.width.push(+o[2].asValue()),n.dimensions.height.push(+o[3].asValue()),n.dimensions.opacity.push(Math.max(0,Math.min(1,+o[4].asValue())))}),(e.graphingEnabled()?t.getGraphMode(e,r):10)!==10&&(n.is_graphable=!0),r.moveStrategy&&(n.move_strategy=r.moveStrategy),t.center&&(t.center.type===\"Identifier\"?(n.center_reference_id=t.center.referencedStatementId,n.center_reference_symbol=t.center._symbol):t.center.type===\"ParenSeq\"&&r.center.valueType===C&&(n.center_is_point_literal=!0)),n}function sz(e,t,r){let n=r.handler,i=r.minStep,s={},o={};for(let p of n.getDependencies())e.validActionVariable(p)||(s[p]=!0);for(let p of i.getDependencies())o[p]=!0;let a;if(Eo(i))a={status:\"error\",error:i.getError()};else{let p=i.asValue();typeof p==\"number\"&&!isNaN(p)&&p>=0?a={status:\"valid\",value:p}:a={status:\"error\",error:wx().getError()}}let u=Object.keys(s);u.length>0&&(n=ar(u).setDependencies(n.getDependencies()));let c;n.isError&&!_0(e,n)?c={status:\"error\",error:n.getError()}:n.isEmptyAction?c={status:\"empty\"}:c={status:\"maybe-valid\"};let l={handler:c,minStep:a,variables:[]};return Bu(l,e,{...s,...o}),l}function oz(){return{operator:\"=\",variables:[]}}function ON(e,t,r,n){var c;if(qs(r))return nz(e,r,n);if(jf(r))return iz(e,r,n);let i=oz();if(r instanceof v.Ticker)return e.graphingEnabled()?sz(e,r,n):(i.error=ee(\"Ticker without graphing\").getError(),i);if(e.is3dProduct()){let l=e,p=r.getGraphMode(l,n);if((p===100||p===101||p===102||p===5)&&n.getDependencies().length===1){let f=n.getDependencies()[0];(f===\"u\"||f===\"v\"||f===\"t\")&&(i.internal_domain_dependency=f)}}if((c=r.parseOptions)!=null&&c.selection){let l=n.getCursorContext();if(l)i.cursor_context={...l,selection:r.parseOptions.selection};else if(Eo(n)){let p=uz(e,t,r);p&&(i.cursor_context={...p,selection:r.parseOptions.selection})}}if(r instanceof In&&r.recursionInfo&&(i.recursion={type:r.recursionInfo.loopStructure?\"iterative\":\"general\"}),n.isError&&!(r instanceof v.FunctionDefinition&&!n.blocksExport)){i.error=n.getError(),i.variables=r.getSliderVariables(e,n),i.is_single_identifier=r instanceof v.Identifier,n.actionValue&&(i.action_value=DE(n.actionValue));let l=N0(e,t,r,n);return Object.keys(l).length>0&&(i.geometry=N0(e,t,r,n)),i}if(n.valueType===qt&&n.getDependencies().length===0){let l=n.asValue();i.rgb_value=xc(l[0],l[1],l[2]).formatHex()}n.valueType===Ke&&n.getDependencies().length===0&&(i.action_value=DE(n.asValue())),n.moveStrategy&&(i.move_strategy=n.moveStrategy,i.default_drag_mode=n.defaultDragMode),r.isInequality()&&(i.is_inequality=!0),i.operator=r.getOperator(),n instanceof v.SolvedEquation?n._expression.asValue()!==!0&&n._expression.asValue()!==!1&&(i.assignment=n._symbol):r instanceof v.Assignment&&(r._symbol.startsWith(\"_\")||(i.assignment=r._symbol)),r instanceof v.FunctionDefinition&&(i.function_definition=r._symbol);let s=e.graphingEnabled()?r.getGraphMode(e,n):10;if(e.graphingEnabled()&&e.is3dPolicy()&&!ra(s)&&!IN(s)&&(s=10),s!==10){i.is_graphable=!0,i.expression_type=r.getExpressionType(s,n.valueType),e.is3dPolicy()&&(i.expression_type===\"SINGLE_POINT\"?i.expression_type=\"POINT3D\":i.expression_type===\"POINT_LIST\"&&(i.expression_type=\"POINT3D_LIST\")),n.valueType&&pa(n.valueType)&&(i.map_type=n.valueType),n.isShadeBetween()&&(i.is_shade_between=!0);let l=r.tableInfo(e,n);l&&(i.is_tableable=!0,i.table_info=l)}if(n.valueType!==void 0&&W(n.valueType)&&(i.is_concrete_list=!0,n.valueType===Zr&&n.getDependencies().length===0)){let l=n.asValue();l&&(i.rgb_value=l.map(p=>xc(p[0],p[1],p[2]).formatHex()))}if(i.variables=i.is_graphable?[]:r.getSliderVariables(e,n),i.is_single_identifier=r instanceof v.Identifier,n.isTypedConstant){let l=n.asTypedValue();i.typed_constant_value=l,(l.valueType===T||l.valueType===Ee)&&(i.constant_value=l.value),az(l.valueType)&&(i.geometry=N0(e,t,r,n))}let o=n.getEvaluationInfo();if(o&&i.operator===\"=\"&&!r.isConstant&&!r.isFunction&&n.valueType!==Ee&&n.valueType!==_r&&!(r instanceof v.Equation)&&!(r instanceof v.ComparatorChain)&&(i.is_evaluable=!0,i.zero_values=o),n instanceof v.OptimizedRegression){let l=n,p={};for(var a in l.parameters)l.parameters.hasOwnProperty(a)&&(p[fn(a)]=+l.parameters[a].asValue());i.is_regression=!0,i.regression={parameters:p,residualVariable:fn(l.residualVariable),residualSuggestionId:l.residualSuggestionId,shouldSuggestLogMode:l.shouldSuggestLogMode,isLinear:l.isLinear,statistics:l.statistics,parameterWarning:l.parameterWarning}}let u=wa(r);return u&&u.discrete&&(i.is_discrete_distribution=!0),i}function az(e){switch(e){case C:case xt:case be:case Vr:case Se:case xr:case _e:case Br:case Me:case Gr:case he:case wr:case fe:case Fr:case Be:case Or:case Ge:case mr:case Ae:case yr:case Ue:case bn:return!0;default:return!1}}function N0(e,t,r,n){let i={};n.valueType!==void 0&&(i.valueType=n.valueType),i.valueType&&ce(i.valueType,C)&&e.graphingEnabled()&&r.getGraphMode(e,n)===4&&(i.isMovablePoint=!0);let{identifier:s,listAccess:o,assignmentRhsReference:a,tree:u}=_y(r);if(s&&(i.identifier=s),o&&(i.listAccess=o),a&&(i.assignmentRhsReference=a),u&&(i.call=u,n.valueType&&ce(n.valueType,Ue)&&r instanceof In)){let l=r._expression;i.transformation_preview_info={type:u.symbol,args:l.args.slice(1).map(p=>p.tryGetConcreteTree(e,t).asTypedValue())}}let c=n.moveStrategy&&n.moveStrategy[0];return c&&\"initialValue\"in c&&c.initialValue!==void 0&&(i.gliderParameter=c.initialValue),i}function uz(e,t,r){let n=r.parseOptions;if(!(n!=null&&n.selection))return;let{start:i,end:s,input:o}=n.selection;if(o.trim()===\"\")return{type:\"empty\",allowedTypes:[vt]};let a=\"\\\\cursor\",u=o.slice(0,i)+a+\" \"+o.slice(s),c={input:u,start:i,end:i+a.length},l=Hs(u,{...r.parseOptions,selection:c});return l.isError?l.getCursorContext():ap({policy:e,frame:t,selection:c},l).getCursorContext()}function Bu(e,t,r){let n=e.variables;if(n&&n.length){let i={};for(let s of n)i[s]=!0;for(let s in r)i[s]=!0;r=i}e.variables=t.sliderVariables(Object.keys(r))}function _0(e,t){if(t.blocksExport)return!1;let r=t.getDependencies();if(r.length===0)return!1;for(let n of r)if(!e.validActionVariable(n))return!1;return!0}var U=class{constructor(t,r,n,i){this.policy=t,this.rawTree=n,this.concreteTree=i,this.evaluationState=ON(t,r,n,i)}exportTo(t,r){this.rawTree.exportTo(t,this.concreteTree,r)}graph(t,r){return this.rawTree.tryGraph(this.policy,this.concreteTree,t,r)}getGraphMode(){return this.policy.graphingEnabled()?this.rawTree.getGraphMode(this.policy,this.concreteTree):10}getGraphInfo(){return this.rawTree.getGraphInfo(this.policy,this.concreteTree)}shouldIntersect(){if(!this.evaluationState.is_graphable||!this.rawTree.userData.shouldGraph||!os.pointsOfInterest)return!1;var t=this.getGraphMode();return t===1||t===2}};var F=function(){};F.version=\"1.2.6\";F._myIndexOf=function(t){var r=this.length,n;for(n=0;n<r;++n)if(this[n]===t)return n;return-1};F.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:F._myIndexOf;F.precision=4;F.largeArray=50;F.compile=function(){var e=Array.prototype.slice.call(arguments),t=e.pop();return t=\"return function (\"+e.join(\",\")+\") {\"+t+\"}\",new Function([\"numeric\"],t)(F)};F._dim=function(t){for(var r=[];typeof t==\"object\";)r.push(t.length),t=t[0];return r};F.dim=function(t){var r,n;return typeof t==\"object\"?(r=t[0],typeof r==\"object\"?(n=r[0],typeof n==\"object\"?F._dim(t):[t.length,r.length]):[t.length]):[]};F.mapreduce=function(t,r){return F.compile(\"x\",\"accum\",\"_s\",\"_k\",'if(typeof accum === \"undefined\") accum = '+r+`;\nif(typeof x === \"number\") { var xi = x; `+t+`; return accum; }\nif(typeof _s === \"undefined\") _s = numeric.dim(x);\nif(typeof _k === \"undefined\") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    `+t+`;\n    xi = x[i-1];\n    `+t+`;\n}\nif(i === 0) {\n    xi = x[i];\n    `+t+`\n}\nreturn accum;`)};F.mapreduce2=function(t,r){return F.compile(\"x\",`var n = x.length;\nvar i,xi;\n`+r+`\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    `+t+`\n}\nreturn accum;`)};F.rep=function(t,r,n){typeof n==\"undefined\"&&(n=0);var i=t[n],s=Array(i),o;if(n===t.length-1){for(o=i-2;o>=0;o-=2)s[o+1]=r,s[o]=r;return o===-1&&(s[0]=r),s}for(o=i-1;o>=0;o--)s[o]=F.rep(t,r,n+1);return s};F.dotMMsmall=function(t,r){var n,i,s,o,a,u,c,l,p,f,m,g,y,d;for(o=t.length,a=r.length,u=r[0].length,c=Array(o),n=o-1;n>=0;n--){for(l=Array(u),p=t[n],s=u-1;s>=0;s--){for(f=p[a-1]*r[a-1][s],i=a-2;i>=1;i-=2)m=i-1,f+=p[i]*r[i][s]+p[m]*r[m][s];i===0&&(f+=p[0]*r[0][s]),l[s]=f}c[n]=l}return c};F._getCol=function(t,r,n){var i=t.length,s;for(s=i-1;s>0;--s)n[s]=t[s][r],--s,n[s]=t[s][r];s===0&&(n[0]=t[0][r])};F.dotMMbig=function(t,r){var n=F._getCol,i=r.length,s=Array(i),o=t.length,a=r[0].length,u=new Array(o),c,l=F.dotVV,p,f,m,g;for(--i,--o,p=o;p!==-1;--p)u[p]=Array(a);for(--a,p=a;p!==-1;--p)for(n(r,p,s),f=o;f!==-1;--f)g=0,c=t[f],u[f][p]=l(c,s);return u};F.dotMV=function(t,r){var n=t.length,i=r.length,s,o=Array(n),a=F.dotVV;for(s=n-1;s>=0;s--)o[s]=a(t[s],r);return o};F.dotVM=function(t,r){var n,i,s,o,a,u,c,l,p,f,m,g,y,d,h,b,x,P,E;for(o=t.length,a=r[0].length,c=Array(a),s=a-1;s>=0;s--){for(f=t[o-1]*r[o-1][s],i=o-2;i>=1;i-=2)m=i-1,f+=t[i]*r[i][s]+t[m]*r[m][s];i===0&&(f+=t[0]*r[0][s]),c[s]=f}return c};F.dotVV=function(t,r){var n,i=t.length,s,o=t[i-1]*r[i-1];for(n=i-2;n>=1;n-=2)s=n-1,o+=t[n]*r[n]+t[s]*r[s];return n===0&&(o+=t[0]*r[0]),o};F.dot=function(t,r){var n=F.dim;switch(n(t).length*1e3+n(r).length){case 2002:return r.length<10?F.dotMMsmall(t,r):F.dotMMbig(t,r);case 2001:return F.dotMV(t,r);case 1002:return F.dotVM(t,r);case 1001:return F.dotVV(t,r);case 1e3:return F.mulVS(t,r);case 1:return F.mulSV(t,r);case 0:return t*r;default:throw new Error(\"numeric.dot only works on vectors and matrices\")}};F.diag=function(t){var r,n,i,s=t.length,o=Array(s),a;for(r=s-1;r>=0;r--){for(a=Array(s),n=r+2,i=s-1;i>=n;i-=2)a[i]=0,a[i-1]=0;for(i>r&&(a[i]=0),a[r]=t[r],i=r-1;i>=1;i-=2)a[i]=0,a[i-1]=0;i===0&&(a[0]=0),o[r]=a}return o};F.getDiag=function(e){var t=Math.min(e.length,e[0].length),r,n=Array(t);for(r=t-1;r>=1;--r)n[r]=e[r][r],--r,n[r]=e[r][r];return r===0&&(n[0]=e[0][0]),n};F.identity=function(t){return F.diag(F.rep([t],1))};F.pointwise=function(t,r,n){typeof n==\"undefined\"&&(n=\"\");var i=[],s,o=/\\[i\\]$/,a,u=\"\",c=!1;for(s=0;s<t.length;s++)o.test(t[s])?(a=t[s].substring(0,t[s].length-3),u=a):a=t[s],a===\"ret\"&&(c=!0),i.push(a);return i[t.length]=\"_s\",i[t.length+1]=\"_k\",i[t.length+2]='if(typeof _s === \"undefined\") _s = numeric.dim('+u+`);\nif(typeof _k === \"undefined\") _k = 0;\nvar _n = _s[_k];\nvar i`+(c?\"\":\", ret = Array(_n)\")+`;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee(`+t.join(\",\")+`,_s,_k+1);\n    return ret;\n}\n`+n+`\nfor(i=_n-1;i!==-1;--i) {\n    `+r+`\n}\nreturn ret;`,F.compile.apply(null,i)};F.pointwise2=function(t,r,n){typeof n==\"undefined\"&&(n=\"\");var i=[],s,o=/\\[i\\]$/,a,u=\"\",c=!1;for(s=0;s<t.length;s++)o.test(t[s])?(a=t[s].substring(0,t[s].length-3),u=a):a=t[s],a===\"ret\"&&(c=!0),i.push(a);return i[t.length]=\"var _n = \"+u+`.length;\nvar i`+(c?\"\":\", ret = Array(_n)\")+`;\n`+n+`\nfor(i=_n-1;i!==-1;--i) {\n`+r+`\n}\nreturn ret;`,F.compile.apply(null,i)};F._biforeach=function e(t,r,n,i,s){if(i===n.length-1){s(t,r);return}var o,a=n[i];for(o=a-1;o>=0;o--)e(typeof t==\"object\"?t[o]:t,typeof r==\"object\"?r[o]:r,n,i+1,s)};F._biforeach2=function e(t,r,n,i,s){if(i===n.length-1)return s(t,r);var o,a=n[i],u=Array(a);for(o=a-1;o>=0;--o)u[o]=e(typeof t==\"object\"?t[o]:t,typeof r==\"object\"?r[o]:r,n,i+1,s);return u};F._foreach=function e(t,r,n,i){if(n===r.length-1){i(t);return}var s,o=r[n];for(s=o-1;s>=0;s--)e(t[s],r,n+1,i)};F._foreach2=function e(t,r,n,i){if(n===r.length-1)return i(t);var s,o=r[n],a=Array(o);for(s=o-1;s>=0;s--)a[s]=e(t[s],r,n+1,i);return a};F.ops2={add:\"+\",sub:\"-\",mul:\"*\",div:\"/\",mod:\"%\",and:\"&&\",or:\"||\",eq:\"===\",neq:\"!==\",lt:\"<\",gt:\">\",leq:\"<=\",geq:\">=\",band:\"&\",bor:\"|\",bxor:\"^\",lshift:\"<<\",rshift:\">>\",rrshift:\">>>\"};F.opseq={addeq:\"+=\",subeq:\"-=\",muleq:\"*=\",diveq:\"/=\",modeq:\"%=\",lshifteq:\"<<=\",rshifteq:\">>=\",rrshifteq:\">>>=\",bandeq:\"&=\",boreq:\"|=\",bxoreq:\"^=\"};F.mathfuns=[\"abs\",\"acos\",\"asin\",\"atan\",\"ceil\",\"cos\",\"exp\",\"floor\",\"log\",\"round\",\"sin\",\"sqrt\",\"tan\",\"isNaN\",\"isFinite\"];F.mathfuns2=[\"atan2\",\"pow\",\"max\",\"min\"];F.ops1={neg:\"-\",not:\"!\",bnot:\"~\",clone:\"\"};F.mapreducers={any:[\"if(xi) return true;\",\"var accum = false;\"],all:[\"if(!xi) return false;\",\"var accum = true;\"],sum:[\"accum += xi;\",\"var accum = 0;\"],prod:[\"accum *= xi;\",\"var accum = 1;\"],norm2Squared:[\"accum += xi*xi;\",\"var accum = 0;\"],norminf:[\"accum = max(accum,abs(xi));\",\"var accum = 0, max = Math.max, abs = Math.abs;\"],norm1:[\"accum += abs(xi);\",\"var accum = 0, abs = Math.abs;\"],sup:[\"accum = max(accum,xi);\",\"var accum = -Infinity, max = Math.max;\"],inf:[\"accum = min(accum,xi);\",\"var accum = Infinity, min = Math.min;\"]};(function(){var e,t;for(e=0;e<F.mathfuns2.length;++e)t=F.mathfuns2[e],F.ops2[t]=t;for(e in F.ops2)if(F.ops2.hasOwnProperty(e)){t=F.ops2[e];var r,n,i=\"\";F.myIndexOf.call(F.mathfuns2,e)!==-1?(i=\"var \"+t+\" = Math.\"+t+`;\n`,r=function(s,o,a){return s+\" = \"+t+\"(\"+o+\",\"+a+\")\"},n=function(s,o){return s+\" = \"+t+\"(\"+s+\",\"+o+\")\"}):(r=function(s,o,a){return s+\" = \"+o+\" \"+t+\" \"+a},F.opseq.hasOwnProperty(e+\"eq\")?n=function(s,o){return s+\" \"+t+\"= \"+o}:n=function(s,o){return s+\" = \"+s+\" \"+t+\" \"+o}),F[e+\"VV\"]=F.pointwise2([\"x[i]\",\"y[i]\"],r(\"ret[i]\",\"x[i]\",\"y[i]\"),i),F[e+\"SV\"]=F.pointwise2([\"x\",\"y[i]\"],r(\"ret[i]\",\"x\",\"y[i]\"),i),F[e+\"VS\"]=F.pointwise2([\"x[i]\",\"y\"],r(\"ret[i]\",\"x[i]\",\"y\"),i),F[e]=F.compile(`var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric.`+e+\"VV, VS = numeric.\"+e+\"VS, SV = numeric.\"+e+`SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === \"object\") {\n      if(typeof y === \"object\") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === \"object\") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else `+n(\"x\",\"y\")+`\n}\nreturn x;\n`),F[t]=F[e],F[e+\"eqV\"]=F.pointwise2([\"ret[i]\",\"x[i]\"],n(\"ret[i]\",\"x[i]\"),i),F[e+\"eqS\"]=F.pointwise2([\"ret[i]\",\"x\"],n(\"ret[i]\",\"x\"),i),F[e+\"eq\"]=F.compile(`var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric.`+e+\"eqV, S = numeric.\"+e+`eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === \"object\") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n`)}for(e=0;e<F.mathfuns2.length;++e)t=F.mathfuns2[e],delete F.ops2[t];for(e=0;e<F.mathfuns.length;++e)t=F.mathfuns[e],F.ops1[t]=t;for(e in F.ops1)F.ops1.hasOwnProperty(e)&&(i=\"\",t=F.ops1[e],F.myIndexOf.call(F.mathfuns,e)!==-1&&Math.hasOwnProperty(t)&&(i=\"var \"+t+\" = Math.\"+t+`;\n`),F[e+\"eqV\"]=F.pointwise2([\"ret[i]\"],\"ret[i] = \"+t+\"(ret[i]);\",i),F[e+\"eq\"]=F.compile(\"x\",'if(typeof x !== \"object\") return '+t+`x\nvar i;\nvar V = numeric.`+e+`eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n`),F[e+\"V\"]=F.pointwise2([\"x[i]\"],\"ret[i] = \"+t+\"(x[i]);\",i),F[e]=F.compile(\"x\",'if(typeof x !== \"object\") return '+t+`(x)\nvar i;\nvar V = numeric.`+e+`V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n`));for(e=0;e<F.mathfuns.length;++e)t=F.mathfuns[e],delete F.ops1[t];for(e in F.mapreducers)F.mapreducers.hasOwnProperty(e)&&(t=F.mapreducers[e],F[e+\"V\"]=F.mapreduce2(t[0],t[1]),F[e]=F.compile(\"x\",\"s\",\"k\",t[1]+`if(typeof x !== \"object\") {    xi = x;\n`+t[0]+`\n    return accum;\n}if(typeof s === \"undefined\") s = numeric.dim(x);\nif(typeof k === \"undefined\") k = 0;\nif(k === s.length-1) return numeric.`+e+`V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n`+t[0]+`\n}\nreturn accum;\n`))})();F.inv=function(y){var r=F.dim(y),n=Math.abs,i=r[0],s=r[1],o=F.clone(y),a,u,c=F.identity(i),l,p,f,m,g,y;for(m=0;m<s;++m){var d=-1,h=-1;for(f=m;f!==i;++f)g=n(o[f][m]),g>h&&(d=f,h=g);for(u=o[d],o[d]=o[m],o[m]=u,p=c[d],c[d]=c[m],c[m]=p,y=u[m],g=m;g!==s;++g)u[g]/=y;for(g=s-1;g!==-1;--g)p[g]/=y;for(f=i-1;f!==-1;--f)if(f!==m){for(a=o[f],l=c[f],y=a[m],g=m+1;g!==s;++g)a[g]-=u[g]*y;for(g=s-1;g>0;--g)l[g]-=p[g]*y,--g,l[g]-=p[g]*y;g===0&&(l[0]-=p[0]*y)}}return c};F.det=function(t){var r=F.dim(t);if(r.length!==2||r[0]!==r[1])throw new Error(\"numeric: det() only works on square matrices\");var n=r[0],i=1,s,o,a,u=F.clone(t),c,l,p,f,m,g,y;for(o=0;o<n-1;o++){for(a=o,s=o+1;s<n;s++)Math.abs(u[s][o])>Math.abs(u[a][o])&&(a=s);for(a!==o&&(f=u[a],u[a]=u[o],u[o]=f,i*=-1),c=u[o],s=o+1;s<n;s++){for(l=u[s],p=l[o]/c[o],a=o+1;a<n-1;a+=2)m=a+1,l[a]-=c[a]*p,l[m]-=c[m]*p;a!==n&&(l[a]-=c[a]*p)}if(c[o]===0)return 0;i*=c[o]}return i*u[o][o]};F.transpose=function(t){var r,n,i=t.length,s=t[0].length,o=Array(s),a,u,c;for(n=0;n<s;n++)o[n]=Array(i);for(r=i-1;r>=1;r-=2){for(u=t[r],a=t[r-1],n=s-1;n>=1;--n)c=o[n],c[r]=u[n],c[r-1]=a[n],--n,c=o[n],c[r]=u[n],c[r-1]=a[n];n===0&&(c=o[0],c[r]=u[0],c[r-1]=a[0])}if(r===0){for(a=t[0],n=s-1;n>=1;--n)o[n][0]=a[n],--n,o[n][0]=a[n];n===0&&(o[0][0]=a[0])}return o};F.negtranspose=function(t){var r,n,i=t.length,s=t[0].length,o=Array(s),a,u,c;for(n=0;n<s;n++)o[n]=Array(i);for(r=i-1;r>=1;r-=2){for(u=t[r],a=t[r-1],n=s-1;n>=1;--n)c=o[n],c[r]=-u[n],c[r-1]=-a[n],--n,c=o[n],c[r]=-u[n],c[r-1]=-a[n];n===0&&(c=o[0],c[r]=-u[0],c[r-1]=-a[0])}if(r===0){for(a=t[0],n=s-1;n>=1;--n)o[n][0]=-a[n],--n,o[n][0]=-a[n];n===0&&(o[0][0]=-a[0])}return o};F.norm2=function(t){return Math.sqrt(F.norm2Squared(t))};F.linspace=function(t,r,n){if(typeof n==\"undefined\"&&(n=Math.max(Math.round(r-t)+1,1)),n<2)return n===1?[t]:[];var i,s=Array(n);for(n--,i=n;i>=0;i--)s[i]=(i*r+(n-i)*t)/n;return s};F.getBlock=function(t,r,n){var i=F.dim(t);function s(o,a){var u,c=r[a],l=n[a]-c,p=Array(l);if(a===i.length-1){for(u=l;u>=0;u--)p[u]=o[u+c];return p}for(u=l;u>=0;u--)p[u]=s(o[u+c],a+1);return p}return s(t,0)};F.setBlock=function(t,r,n,i){var s=F.dim(t);function o(a,u,c){var l,p=r[c],f=n[c]-p;if(c===s.length-1)for(l=f;l>=0;l--)a[l+p]=u[l];for(l=f;l>=0;l--)o(a[l+p],u[l],c+1)}return o(t,i,0),t};F.getRange=function(t,r,n){var i=r.length,s=n.length,o,a,u=Array(i),c,l;for(o=i-1;o!==-1;--o)for(u[o]=Array(s),c=u[o],l=t[r[o]],a=s-1;a!==-1;--a)c[a]=l[n[a]];return u};F.blockMatrix=function(t){var r=F.dim(t);if(r.length<4)return F.blockMatrix([t]);var n=r[0],i=r[1],s,o,a,u,c;for(s=0,o=0,a=0;a<n;++a)s+=t[a][0].length;for(u=0;u<i;++u)o+=t[0][u][0].length;var l=Array(s);for(a=0;a<s;++a)l[a]=Array(o);var p=0,f,m,g,y,d;for(a=0;a<n;++a){for(f=o,u=i-1;u!==-1;--u)for(c=t[a][u],f-=c[0].length,g=c.length-1;g!==-1;--g)for(d=c[g],m=l[p+g],y=d.length-1;y!==-1;--y)m[f+y]=d[y];p+=t[a][0].length}return l};F.tensor=function(t,r){if(typeof t==\"number\"||typeof r==\"number\")return F.mul(t,r);var n=F.dim(t),i=F.dim(r);if(n.length!==1||i.length!==1)throw new Error(\"numeric: tensor product is only defined for vectors\");var s=n[0],o=i[0],a=Array(s),u,c,l,p;for(c=s-1;c>=0;c--){for(u=Array(o),p=t[c],l=o-1;l>=3;--l)u[l]=p*r[l],--l,u[l]=p*r[l],--l,u[l]=p*r[l],--l,u[l]=p*r[l];for(;l>=0;)u[l]=p*r[l],--l;a[c]=u}return a};F.epsilon=2220446049250313e-31;F.LU=function(e,t){t=t||!1;var r=Math.abs,n,i,s,o,a,u,c,l,p,f=e.length,m=f-1,g=new Array(f);for(t||(e=F.clone(e)),s=0;s<f;++s){for(c=s,u=e[s],p=r(u[s]),i=s+1;i<f;++i)o=r(e[i][s]),p<o&&(p=o,c=i);for(g[s]=c,c!=s&&(e[s]=e[c],e[c]=u,u=e[s]),a=u[s],n=s+1;n<f;++n)e[n][s]/=a;for(n=s+1;n<f;++n){for(l=e[n],i=s+1;i<m;++i)l[i]-=l[s]*u[i],++i,l[i]-=l[s]*u[i];i===m&&(l[i]-=l[s]*u[i])}}return{LU:e,P:g}};F.LUsolve=function(t,r){var n,i,s=t.LU,o=s.length,a=F.clone(r),u=t.P,c,l,p,f;for(n=o-1;n!==-1;--n)a[n]=r[n];for(n=0;n<o;++n)for(c=u[n],u[n]!==n&&(f=a[n],a[n]=a[c],a[c]=f),l=s[n],i=0;i<n;++i)a[n]-=a[i]*l[i];for(n=o-1;n>=0;--n){for(l=s[n],i=n+1;i<o;++i)a[n]-=a[i]*l[i];a[n]/=l[n]}return a};F.solve=function(t,r,n){return F.LUsolve(F.LU(t,n),r)};var Dr=F;function cz(e,t){let r=e.length,n=t.length,i=0,s=0;for(let a=n-r;a<n;a++)i+=e[a+r-n]*t[a],s+=e[a+r-n]*e[a+r-n];let o=i/s;for(let a=n-r;a<n;a++)t[a]=2*o*e[a+r-n]-t[a]}function lz(e,t,r){let n=e.length,i=t.length,s=0,o=0;for(let u=i-n;u<i;u++)s+=e[u+n-i]*t[u][r],o+=e[u+n-i]*e[u+n-i];let a=s/o;for(let u=i-n;u<i;u++)t[u][r]=2*a*e[u+n-i]-t[u][r]}function pz(e,t,r,n){let i=Array(e.length-t);if(i.length===1)return i[0]=1,i;if(n===0){i[0]=1;for(let o=1;o<i.length;o++)i[o]=0;return i}let s=e[t][r]<0?-1:1;i[0]=e[t][r]+s*Math.sqrt(n);for(let o=t+1;o<e.length;o++)i[o-t]=e[o][r];return i}function fz(e,t,r){let n=0;for(;t<e.length;t++)n+=e[t][r]*e[t][r];return n}function ah(e,t){if(!t||!t.mutateInput){let s=e;e=Array(e.length);for(let o=0;o<s.length;o++)e[o]=s[o].slice()}let r=Math.min(e.length,e[0].length),n=Array(r),i=[];for(let s=0;s<r;s++){let o=-1/0,a=s;for(let c=s;c<e[s].length;c++){let l=fz(e,s,c);l>o&&(o=l,a=c)}if(n[s]=a,a!==s)for(let c=0;c<e.length;c++){let l=e[c][a];e[c][a]=e[c][s],e[c][s]=l}let u=pz(e,s,s,o);for(let c=s;c<e[s].length;c++)lz(u,e,c);i.push(u)}return{reflectors:i,r:e,p:n}}function RN(e,t,r){let{reflectors:n,r:i,p:s}=e,o=t.slice();for(let c=0;c<n.length;c++)cz(n[c],o);for(let c=n.length;c<i[0].length;c++)o[c]=0;o.length=i[0].length;let a=Math.pow(2,-52),u=r.regularize?a*Math.abs(i[0][0])*Math.max(i.length,i[0].length):0;for(let c=n.length-1;c>=0;c--){let l=i[c];if(Math.abs(l[c])<=u)o[c]=0;else{for(let p=c+1;p<n.length;p++)o[c]-=o[p]*l[p];o[c]/=l[c]}}for(let c=s.length-1;c>=0;c--)if(s[c]!==c){let l=o[c];o[c]=o[s[c]],o[s[c]]=l}return o}function dz(e,t,r){let n=Array(e.r[0].length);for(let s=0;s<n.length;s++)n[s]=Array(t[0].length);let i=Array(t.length);for(let s=0;s<t[0].length;s++){for(let a=0;a<t.length;a++)i[a]=t[a][s];let o=RN(e,i,r);for(let a=0;a<o.length;a++)n[a][s]=o[a]}return n}function Uc(e,t,r){return Array.isArray(t[0])?dz(e,t,r):RN(e,t,r)}function mz(e){let t=e.r,r=Math.min(t.length,t[0].length),n=t[0][0],i=t[r-1][r-1];return n===0?1/0:Math.abs(n/i)}function CN(e){let t=Math.pow(2,-52);return Math.max(e.r.length,e.r[0].length)*t*mz(e)<1}var yz=Math.pow(2,-52);function ch(e){for(let t of e)for(let r of t)if(!Tr(r))return!1;return!0}function gz(e){let t=[];for(let r of e)t.push(r.slice());return t}function AN(e){let{numRows:t,numCols:r}=uh(e),n=[];for(let i=0;i<r;i++)n.push([]);for(let i=0;i<t;i++)for(let s=0;s<r;s++)n[s].push(e[i][s]);return n}function uh(e){let t=e.length,r=t>0?e[0].length:0;return{numRows:t,numCols:r}}function hz(){throw new Error(\"Matrix dimension mismatch\")}function L0(e,t){let r=uh(e),n=uh(t);r.numCols!==n.numRows&&hz();let i=[];for(let s=0;s<r.numRows;s++){let o=[];for(let a=0;a<n.numCols;a++){let u=Re(0,1);for(let c=0;c<e[s].length;c++)u=ps(u,fs(e[s][c],t[c][a]));o.push(u)}i.push(o)}return i}function _N(e){let t=gz(e);return xz(t),t}function bz(e){let t=0;for(let r of e)for(let n of r){let i=Math.abs(Y(n));if(!isFinite(i))return NaN;i>t&&(t=i)}return t}function NN(e){for(let t=0;t<e.length;t++)for(let r=0;r<e[t].length;r++)e[t][r]=NaN}function xz(e){let{numRows:t,numCols:r}=uh(e),n=bz(e);if(!isFinite(n))return NN(e),{determinant:NaN,rank:0};let i=Math.max(t,r)*n*yz,s=Re(1,1),o=0,a=0;for(;o<t&&a<r;){let u=o,c=Math.abs(Y(e[o][a]));for(let p=o+1;p<t;p++){let f=Math.abs(Y(e[p][a]));(!isFinite(f)||f>c)&&(c=f,u=p)}if(!isFinite(c))return NN(e),{determinant:NaN,rank:0};if(c===0){s=Re(0,1),a+=1;continue}if(!Tr(e[u][a])&&c<i){for(let p=o;p<t;p++)e[o][p]=0;s=0,a+=1;continue}if(u!==o){s=xi(s);let p=e[o];e[o]=e[u],e[u]=p}for(let p=0;p<t;p++){if(p===o)continue;let f=es(e[p][a],e[o][a]);e[p][a]=Re(0,1);for(let m=a+1;m<r;m++)e[p][m]=Ki(e[p][m],fs(f,e[o][m]))}let l=e[o][a];s=fs(s,l),e[o][a]=Re(1,1);for(let p=a+1;p<r;p++)e[o][p]=es(e[o][p],l);o+=1,a+=1}return{rank:o,determinant:o===t&&o===r?s:Re(0,1)}}function ph(e,t){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function zu(e,t){let r=Gu(e,t),n=0;for(let i of r){let s=i;n+=s*s}return n/r.length}function Gu(e,t){return e.apply(void 0,t)}function lh(e,t){let r=[];for(let n of e){let i=n.apply(void 0,t);r.push(i)}return r}function LN(e,t){let r=[];for(let n=0;n<e.length;n++)t[n]&&r.push(e[n]);return r}function w0(e,t,r){let n=[];for(let i=0,s=0;i<e.length;i++){let o=0;r[i]&&(o=t[s],s+=1),n.push(e[i]+o)}return n}function B0(e,t){let r=t.solution.map(u=>Math.abs(u)<1e-6?0:u),n=t.solution.map(()=>0),i=zu(e,r),s=Gu(e,r),o=Gu(e,n),a=0;for(let u=0;u<s.length;u++){let c=o[u]*1e-15;a+=Math.abs(s[u]*c)+c*c}return a/=s.length,isFinite(a)||(a=0),isFinite(t.MSE)&&!isFinite(i)?t:i<=t.MSE+a?{solution:r,MSE:i}:t}function G0(e,t){if(!ch(t)||!ch([e]))return;let r=AN(t),n=L0([e],r)[0],i=L0(t,r);for(let c=0;c<n.length;c++)i[c].push(xi(n[c]));let s=_N(i);if(!ch(s))return;let o=[],a=n.length,u=0;for(let c of s)for(;u<a;)if(Y(c[u])===1){o.push(c[c.length-1]),u++;break}else o.push(Re(0,1)),u++;for(;u<a;)o.push(Re(0,1)),u++;return o}function z0(e,t){let r=ph(0,t.length),n=lh(t,r),i=ah(Dr.transpose(n),{mutateInput:!0});for(var s=0;s<2;s++){let c=Gu(e,r),l=Dr.neg(Uc(i,c,{regularize:!1}));r=Dr.add(r,l)}let o=zu(e,r);if(CN(i))return{solution:r,MSE:o};let a=ph(0,t.length);for(var s=0;s<2;s++){let l=Gu(e,a),p=Dr.neg(Uc(i,l,{regularize:!0}));a=Dr.add(a,p)}let u=zu(e,a);return .999*u<=o?{solution:a,MSE:u}:{solution:r,MSE:o}}function F0(e,t,r,n){let i=n.maxIterations,s=n.linearSubset||ph(!1,r.length),o=Dr.not(s),a=LN(t,s),u=LN(t,o),c=2,l=.1,p=r,f=0,m=.001,g;if(Dr.any(s)){let h=Dr.transpose(lh(a,p)),b=ah(h);g={Jv:h,F:b};let x=Gu(e,p),P=Dr.neg(Uc(b,x,{regularize:!0}));p=w0(p,P,s)}let y=!1,d=zu(e,p);for(;f<i&&!y&&isFinite(d);){let h=Gu(e,p),b=lh(u,p),x=Dr.transpose(b),P,E;if(g){let{F:D,Jv:O}=g;P=Dr.dot(b,Dr.sub(h,Dr.dot(O,Uc(D,h,{regularize:!0})))),E=Dr.dot(b,Dr.sub(x,Dr.dot(O,Uc(D,x,{regularize:!0}))))}else P=Dr.dot(b,h),E=Dr.dot(b,x);let M=p,I=!1;for(;f<i&&!y&&!I;){f+=1;let D=Dr.add(E,Dr.diag(ph(m,u.length))),O=Dr.neg(Dr.solve(D,P,!0));M=w0(p,O,o),y=Dr.all(Dr.eq(M,p));let N;if(g){let L=Dr.transpose(lh(a,M)),q=ah(L);N={Jv:L,F:q};let $=Gu(e,M),X=Dr.neg(Uc(q,$,{regularize:!0}));M=w0(M,X,s)}let A=zu(e,M);I=A<d,I?(p=M,d=A,g=N,m*=l):(m=Math.max(m,1e-64),m*=c)}}return{solution:p,MSE:d}}var V0=[18.9,.105,.0113,.089,4.414,.373,.06,.149,1.84,9.26,5,.7,.2,1.13,2.61,1,.007,30,120,1500,4e-4,7.23,-1,-.0081,-.03,-28.6,-1.71,-.4,-6.94,-.777,-500],Tz=function(e){let t=e*503%V0.length;return V0[t]},Iz=function(e){let t=[];for(let r=0;r<V0.length;r++){let n=[];for(let i=0;i<e;i++)r===0&&e!==1?n[i]=0:r===1&&e!==1?n[i]=1:n[i]=Tz(r*e+i);t.push(n)}return t},wN=function(e,t,r,n,i){let s=[];for(let a of r)s.push({soln:F0(e,t,a,i),initialGuess:a});s.sort(function(a,u){return isNaN(a.soln.MSE)?1:isNaN(u.soln.MSE)?-1:a.soln.MSE-u.soln.MSE});let o=[];for(let a=0;a<n;a++)o.push(s[a].initialGuess);return o};function Ez(e,t,r,n){if(!t||hi(t))return e;let i=t.bounds;return i[0]===-1/0&&i[1]===1/0?e:i[0]===-1/0?i[1]-Math.exp(-e):i[1]===1/0?i[0]+Math.exp(e):r/(n-1)*i[1]+(n-1-r)/(n-1)*i[0]}var FN=[3,5,7,11,13,17,19];function Mz(e,t){let r=[];for(let i=0;i<e.length;i++){let s=e[i],o=[];for(let a=0;a<s.length;a++){var n=FN[a%FN.length]*i%e.length;o.push(Ez(s[a],t[a],n,e.length))}r.push(o)}return r}function VN(e,t,r){r||(r={});let{linearSubset:n,bounds:i,preferredInitialGuess:s}=r,o=Iz(t.length);i&&(o=Mz(o,i));let a=wN(e,t,o,5,{maxIterations:3,linearSubset:n}),u=wN(e,t,a,1,{maxIterations:60,linearSubset:n}),c=F0(e,t,u[0],{maxIterations:250,linearSubset:n});if(!s)return c;let l=F0(e,t,s,{maxIterations:100,linearSubset:n});return isFinite(l.MSE)&&(l.MSE<c.MSE||wi(l.MSE,c.MSE,8))?l:c}function k0(e){return{chunk:e,isLazy:!0}}function BN(e){return e.slice()}function dh(e){if(!e.isLazy)return e;let t=e.chunk.copy();return t.reopenFinalBlock(),{chunk:t,forwardParameterMap:BN,reverseParameterMap:BN,isLazy:!1,valueMap:Cz(e.chunk.instructionsLength()),replacementMask:bp(e.chunk.argNames.length)}}function GN(e){let{chunk:t,forwardParameterMap:r,reverseParameterMap:n,isLazy:i,valueMap:s,replacementMask:o,didShiftScale:a}=e;return{chunk:t.copy(),forwardParameterMap:r,reverseParameterMap:n,isLazy:i,valueMap:s.slice(),replacementMask:o.slice(),didShiftScale:a}}function vz(e){var t=1/0,r=-1/0,n=e.length;for(let i of e)t=Math.min(t,i),r=Math.max(r,i);return{min:t,max:r,length:n}}function HN(e){let t=e.getInstruction(e.getReturnIndex());if(t.type!==48)return;let r=t.args[0],n=e.getReturnIndex()-r,i=e.getInstruction(r);if(i.args.length!==2)return;let s=i.args[0],o=i.args[n],a=[],u=[];a.push(s),u.push({min:1,max:xo(e,e.getReturnIndex(),\"Programming error: cannot optimize regression on non-constant-length list\"),length:xo(e,e.getReturnIndex(),\"Programming error: cannot optimize regression on non-constant-length list\")});let c=!1,l=!1;for(let d=s+1;d<=o;d++){let h=e.getInstruction(d);if(h.type===39||h.type===41||h.type===40){if(h.args[1]!==s)continue;let b=h.args[0];if(e.getInstruction(b).valueType!==le||!ht(e.getInstruction(b)))continue;let x=ur(e,b),P=vz(x);if(!isFinite(P.min)||!isFinite(P.max))continue;a.push(d),u.push(P)}else if(h.type===37)h.symbol===\"exp\"?l=!0:kN(h)&&(c=!0);else if(h.type===12||h.type===13)l=!0;else if(ni(h)||Un(h))return}if(a.length===0||!l&&!c)return;let p=[];for(let d=0;d<=o;d++){let h=a.indexOf(d);if(h!==-1){let b=bp(a.length);b[h]=!0,p.push(b)}else p.push(fh(e,p,a.length,d))}let f=[];for(let d=0;d<=e.getReturnIndex();d++)if(e.getInstruction(d).type===2){let b=bp(e.argNames.length);b[d]=!0,f.push(b)}else f.push(fh(e,f,e.argNames.length,d));let m={listAccessDependencyTable:p,listAccesses:a,listStatisticsTable:u},g;for(let d=s+1;d<=e.getReturnIndex();d++){let h=e.getInstruction(d);switch(h.type){case 37:{if(h.symbol===\"exp\"){let X=h.args[0],G=H0(m,X);if(G===void 0){Ga(e,f,g,d);break}let{listStatistics:J,listAccessIndex:w}=G,Z=md(k0(e),d,X,w,J);Z?g=[Z]:Ga(e,f,g,d)}break}case 12:case 13:{let[X,G]=h.args,J=H0(m,G);if(J===void 0||zN(m,X)){Ga(e,f,g,d);break}let{listStatistics:w,listAccessIndex:Z}=J,te=Sz(k0(e),d,Z,w);te?g=[te]:Ga(e,f,g,d);break}case 10:if(g&&g.length>1){Ga(e,f,g,d);break}let b=g&&g.length>0?g[0]:k0(e),[x,P]=h.args,E=b.isLazy?x:b.valueMap[x],M=b.isLazy?P:b.valueMap[P],I=b.chunk.getInstruction(E),D=b.chunk.getInstruction(M),O,N,A;if(I.type===37)O=x,A=I,N=P;else if(D.type===37)O=P,A=D,N=x;else{Ga(e,f,g,d);break}let L=H0(m,O);if(L===void 0||zN(m,N)){Ga(e,f,g,d);break}let{listAccessIndex:q,listStatistics:$}=L;if(A.symbol===\"exp\"){let X=Oz(b,d,N,O,q,$);if(X){g=X;break}}else if(kN(A)){let X=Dz(b,d,N,O,q);if(X){g=[X];break}}Ga(e,f,g,d);break;default:{Ga(e,f,g,d);break}}}if(g===void 0||g.length===0)return;let y=[];for(let d of g)y.push({chunk:d.chunk,forwardParameterMap:d.forwardParameterMap,reverseParameterMap:d.reverseParameterMap});return y}function Ga(e,t,r,n){if(r===void 0)return;let i=e.getInstruction(n);if(ve(i))for(let s of r)s.valueMap[n]=n;else for(let s of r){let{chunk:o,valueMap:a}=s,u=[],c=0;for(let l of i.args){if(a[l]!==l){if(c+=1,c>1){r.length=0;return}}else{let p=t[l];for(let f=0;f<p.length;f++)if(p[f]&&s.replacementMask[f]){r.length=0;return}}u.push(a[l])}a[n]=c>0?Ir(o,i,u):n}}function H0(e,t){let{listAccessDependencyTable:r,listAccesses:n,listStatisticsTable:i}=e,s,o=r[t];for(let a=0;a<o.length;a++)if(o[a]){if(s)return;s={listAccessIndex:n[a],listStatistics:i[a]}}return s}function zN(e,t){let{listAccessDependencyTable:r}=e,n=r[t];for(let i of n)if(i)return!0;return!1}function U0(e,t){let r=[];for(let s=0;s<=t;s++)if(e.getInstruction(s).type===2){let a=bp(e.argNames.length);a[s]=!0,r.push(a)}else r.push(fh(e,r,e.argNames.length,s));let n,i=r[t];for(let s=0;s<i.length;s++)if(i[s]){if(n!==void 0)return;n=s}return n}function Dz(e,t,r,n,i){let s=e.chunk,o=U0(s,r);if(o===void 0)return;let a=q0(e,r,o);if(a===void 0)return;let u=s.getInstruction(n),c=u.args[0];if(a=UN(a,c,i),a===void 0)return;let{chunk:l,valueMap:p}=a,f=l.getInstruction(p[c]);if(f.type!==8)return;let m=f.args[1],g=l.getInstruction(f.args[0]);if(g.type!==10)return;let[y,d]=g.args,h=o,b=m,x=y,P=d,E=l.Multiply([x,P]),M=l.SyntheticNativeFunction(\"cos\",[E]),I=l.SyntheticNativeFunction(\"sin\",[E]),D=u.symbol===\"sin\"?l.Add([l.Multiply([h,I]),l.Multiply([b,M])]):l.Subtract([l.Multiply([h,M]),l.Multiply([b,I])]);p[t]=D;function O(L){let q=a.forwardParameterMap(L),$=q[o],X=q[m],G=$*Math.cos(X),J=$*Math.sin(X);return q[o]=G,q[m]=J,q}function N(L){let q=L.slice(),$=L[o],X=L[m],G=go($,X),J=Math.atan2(X,$);return q[o]=G,q[m]=J,a.reverseParameterMap(q)}let A=a.replacementMask.slice();return A[o]=!0,A[y]=!0,A[m]=!0,{chunk:l,forwardParameterMap:O,reverseParameterMap:N,valueMap:p,replacementMask:A,isLazy:!1}}function Sz(e,t,r,n){let i=e.chunk,s=i.getInstruction(t),[o,a]=s.args,u=i.getInstruction(o);if(u.type===1&&u.valueType===T&&Y(u.value)>0){let b=dh(e),{chunk:x,valueMap:P}=b,E=x.Multiply([x.SyntheticNativeFunction(\"ln\",[P[o]]),P[a]]);return P[a]=E,P[t]=x.SyntheticNativeFunction(\"exp\",[E]),md(b,t,a,r,n)||b}let c=U0(i,o);if(c===void 0)return;let l=q0(e,o,c);if(l===void 0)return;let{chunk:p,valueMap:f}=l,m=p.Multiply([f[o],f[a]]);f[a]=m,f[t]=p.SyntheticNativeFunction(\"exp\",[m]);function g(b){let x=l.forwardParameterMap(b),P=x[c],E=Math.log(P);return x[c]=E,x}function y(b){let x=b.slice(),P=x[c],E=Math.exp(P);return x[c]=E,l.reverseParameterMap(x)}let d=l.replacementMask.slice();d[c]=!0;let h={chunk:p,forwardParameterMap:g,reverseParameterMap:y,isLazy:!1,valueMap:f,replacementMask:d};return md(h,t,a,r,n)||h}function Oz(e,t,r,n,i,s){if(!e.isLazy&&e.didShiftScale)return;let o=e.isLazy?e:GN(e),a=e.chunk,u=U0(a,r);if(u===void 0)return;let c=q0(e,r,u);if(c===void 0)return;let{chunk:l,valueMap:p}=c,f=l.getInstruction(p[n]).args[0],m=l.Add([f,p[r]]);p[r]=m,p[t]=l.SyntheticNativeFunction(\"exp\",[m]);function g(M){let I=c.forwardParameterMap(M),D=I[u],O=Math.log(D);return I[u]=O,I}function y(M){let I=M.slice(),D=I[u],O=Math.exp(D);return I[u]=O,c.reverseParameterMap(I)}function d(M){let I=c.forwardParameterMap(M),D=I[u],O=Math.log(-D);return I[u]=O,I}function h(M){let I=M.slice(),D=I[u],O=-Math.exp(D);return I[u]=O,c.reverseParameterMap(I)}let b=c.replacementMask.slice();b[u]=!0;let x=dh(o);x.valueMap[t]=x.chunk.Multiply([x.valueMap[r],x.valueMap[n]]);let P={chunk:l,forwardParameterMap:g,reverseParameterMap:y,isLazy:!1,valueMap:p,replacementMask:b},E=GN(P);return E.forwardParameterMap=d,E.reverseParameterMap=h,P=md(P,t,r,i,s)||P,E=md(E,t,r,i,s)||E,E.valueMap[t]=E.chunk.Negative([E.valueMap[t]]),[x,P,E]}function md(e,t,r,n,i){let s=Rz(e,r,n,i);if(s!==void 0)return s.valueMap[t]=s.chunk.SyntheticNativeFunction(\"exp\",[s.valueMap[r]]),s}function Rz(e,t,r,n){let i=UN(e,t,r);if(i===void 0)return;let{chunk:s,valueMap:o}=i,a=s.getInstruction(o[t]);if(a.type!==8)return;let u=a.args[1],c=s.getInstruction(a.args[0]);if(c.type!==10)return;let[l,p]=c.args,{min:f,max:m}=n,g=m-f,y=.5*(m+f),d=s.Divide([s.Subtract([p,s.Constant(y)]),s.Constant(g)]),h=s.Add([s.Multiply([l,d]),u]);o[t]=h;function b(P){let E=i.forwardParameterMap(P),M=E[l],I=E[u],D=M*g,O=I+y*M;return E[l]=D,E[u]=O,E}function x(P){let E=P.slice(),M=P[l],I=P[u],D=M/g,O=I-D*y;return E[l]=D,E[u]=O,i.reverseParameterMap(E)}return{chunk:s,forwardParameterMap:b,reverseParameterMap:x,isLazy:!1,valueMap:o,replacementMask:i.replacementMask,didShiftScale:!0}}function q0(e,t,r){let n=e.chunk,i=Fn(n,r,{allowRestriction:!1,allowClosedBlockReferences:!1});if(nr(i,t)!==1)return;let s=zs(i,t),[o,a]=Hr(s,t);if(a===void 0)return;let u=s.newChunk.getInstruction(o);if(u.type!==1||u.valueType!==T)return;let c=s.newChunk.getInstruction(a);if(c.type!==1||c.valueType!==T)return;let l=dh(e),{chunk:p,valueMap:f}=l,m=Y(u.value),g=Y(c.value);f[t]=r;function y(b){let x=l.forwardParameterMap(b),P=x[r],E=m+g*P;return x[r]=E,x}function d(b){let x=b.slice(),E=(x[r]-m)/g;return x[r]=E,l.reverseParameterMap(x)}let h=l.replacementMask.slice();return h[r]=!0,{chunk:p,forwardParameterMap:y,reverseParameterMap:d,isLazy:!1,valueMap:f,replacementMask:h}}function UN(e,t,r){let n=e.chunk,i=e.isLazy?t:e.valueMap[t],s=Fn(n,r,{allowRestriction:!1,allowClosedBlockReferences:!0});if(nr(s,i)!==1)return;e.isLazy&&(s=Fn(n.copy().reopenFinalBlock(),r,{allowRestriction:!1,allowClosedBlockReferences:!1}));let o=zs(s,i),[a,u]=Hr(o,i);if(u===void 0)return;let c=o.newChunk,l=Math.max(u,a),p=[];for(let z=0;z<=l;z++)if(c.getInstruction(z).type===2){let re=bp(c.argNames.length);re[z]=!0,p.push(re)}else p.push(fh(c,p,c.argNames.length,z));let f,m;for(let z=0;z<n.argNames.length;z++)if(p[u][z])if(f===void 0)f=z;else return;else if(p[a][z])if(m===void 0)m=z;else return;if(f===void 0||m===void 0)return;let g=Fn(c,f,{allowRestriction:!1,allowClosedBlockReferences:!1});if(nr(g,u)!==1)return;let y=Fn(c,m,{allowRestriction:!1,allowClosedBlockReferences:!1});if(nr(y,a)!==1)return;let d=zs(g,u),h=zs(y,a),[b,x]=Hr(d,u),P=d.newChunk.getInstruction(b);if(P.type!==1||P.valueType!==T)return;let E=d.newChunk.getInstruction(x);if(E.type!==1||E.valueType!==T)return;let M=dh(e),{chunk:I,valueMap:D}=M,O=I.Add([I.Multiply([f,r]),m]);D[t]=O;let N=c.copy();N.List([u,a]);let A=N.getCompiledFunction().fn;function L(z){let oe=M.forwardParameterMap(z),[re,me]=A.apply(null,oe);return oe[f]=re,oe[m]=me,oe}let q=Y(P.value),$=Y(E.value),[X,G]=Hr(h,a),J=h.newChunk.copy();J.List([X,G]);let w=J.getCompiledFunction().fn;function Z(z){let oe=z.slice(),re=z[f],me=z[m],ye=(re-q)/$,De=z.slice();De[f]=ye,De.splice(m,1);let[K,H]=w.apply(null,De),xe=(me-K)/H;return oe[f]=ye,oe[m]=xe,M.reverseParameterMap(oe)}let te=M.replacementMask.slice();return te[f]=!0,te[m]=!0,{chunk:I,forwardParameterMap:L,reverseParameterMap:Z,isLazy:!1,valueMap:D,replacementMask:te}}function fh(e,t,r,n){let i=e.getInstruction(n),s=bp(r);if(ve(i))return s;for(let o of i.args){let a=t[o];for(let u=0;u<a.length;u++)s[u]=s[u]||a[u]}return s}function bp(e){let t=[];for(let r=0;r<e;r++)t.push(!1);return t}function Cz(e){let t=[];for(let r=0;r<e;r++)t.push(r);return t}function kN(e){return e.type===37&&(e.symbol===\"sin\"||e.symbol===\"cos\")}function bt(e,t){switch(e){case T:case Ee:return new v.Constant(t);case et:return new v.Seed(t);case C:return new v.ParenSeq([bt(T,t[0]),bt(T,t[1])]);case V:return new v.ParenSeq([bt(T,t[0]),bt(T,t[1]),bt(T,t[2])]);case Rt:return new v.FunctionCall(\"segment\",[bt(V,t[0]),bt(V,t[1])]);case Ce:return new v.FunctionCall(\"vector\",[bt(V,t[0]),bt(V,t[1])]);case Pr:return new v.FunctionCall(\"triangle\",[bt(V,t[0]),bt(V,t[1]),bt(V,t[2])]);case Rr:return new v.FunctionCall(\"sphere\",[bt(V,t[0]),bt(T,t[1])]);case qt:return new v.FunctionCall(\"rgb\",[bt(T,t[0]),bt(T,t[1]),bt(T,t[2])]);case Be:return new v.FunctionCall(\"polygon\",[bt(xt,t)]);case Se:return new v.FunctionCall(\"segment\",[bt(C,t[0]),bt(C,t[1])]);case be:return new v.FunctionCall(\"line\",[bt(C,t[0]),bt(C,t[1])]);case _e:return new v.FunctionCall(\"ray\",[bt(C,t[0]),bt(C,t[1])]);case Me:return new v.FunctionCall(\"mathVector\",[bt(C,t[0]),bt(C,t[1])]);case he:return new v.FunctionCall(\"circle\",[bt(C,t[0]),bt(T,t[1])]);case fe:return new v.FunctionCall(\"arc\",[bt(C,t[0]),bt(C,t[1]),bt(C,t[2])]);case Ge:return new v.FunctionCall(\"angle\",[bt(C,t[0]),bt(T,t[1]),bt(T,t[2])]);case Ae:return new v.FunctionCall(\"directedangle\",[bt(C,t[0]),bt(T,t[1]),bt(T,t[2])]);case Xe:case le:case _r:case xt:case Zr:case Or:case xr:case Vr:case Br:case Gr:case mr:case yr:case wr:case Fr:case tn:case rn:case sn:case nn:case xn:case Hn:{let n=[],i=ze(e);for(let s of t)n.push(bt(i,s));return new v.List(n)}case vt:case Dt:case or:case Lr:case Ke:case Ue:case bn:case oo:case Wr:case jr:case cn:case ln:case Rn:case Cn:case Nn:case An:case Gt:case kn:throw new Error(`Programming error: cannot create parse node from valueType: ${$t(e)}`);case pr:return new v.FunctionCall(\"tone\",[bt(T,t[0]),bt(T,t[1])]);default:let r=e;throw new Error(`Programming error: unexpected valueType: ${$t(r)}`)}}function jN(e,t){try{return Nz(e,t)}catch(r){return r instanceof v.Error?r:ee(r)}}function Nz(e,t){let{policy:r,frame:n,exportFrame:i,lastExportFrame:s,priorAnalysis:o}=e,a=t._lhs.buildIRExpression(r,n,{coerceToNumber:!0}),u=t._rhs.buildIRExpression(r,n,{coerceToNumber:!0});if(a.isError)throw a;if(u.isError)throw u;if(a.valueType!==T&&a.valueType!==le||u.valueType!==T&&u.valueType!==le)throw Cb([ne(a.valueType),ne(u.valueType)]);let c=t._difference.buildIRExpression(r,n,{wrapInList:!0,coerceToNumber:!0});if(c.isError)throw c;for(let E of c.getDependencies())if(!r.validRegressionParameter(E))throw lP(E);let l=_z(c.getDependencies(),t.userData.regressionParameters,s),{parameters:p,residuals:f,isLinear:m,parameterWarning:g}=WN(l,c),y={policy:r,frame:n},d=qN(y,t,p),h=Fz(t,a,d),b;if(t.userData.isLogModeRegression&&(h===mi.LOGLIN||h===mi.LOGLOG)){let E=t._logDifference.buildIRExpression(r,n,{wrapInList:!0,coerceToNumber:!0});if(E.isError)throw E;let M=t._logLhs.buildIRExpression(r,n,{wrapInList:!0,coerceToNumber:!0});if(M.isError)throw M;({parameters:p,isLinear:m,parameterWarning:g}=WN(l,E)),d=qN(y,t,p),f=ZN(y,t._difference,p);let I=ZN(y,t._logDifference,p);b=XN(t,M,d,I,t.userData.isLogModeRegression,h)}else b=XN(t,a,d,f,t.userData.isLogModeRegression,h);let x=Az(t,i),P=wz(t,x,o,r);return t.userData.residualVariable=fn(x),new v.OptimizedRegression(p,bt(le,f),b,d.substituted,{isModelValid:d.isValid,residualVariable:x,residualSuggestionId:P,shouldSuggestLogMode:h!==mi.NONE,isLinear:m,parameterWarning:g})}function Az(e,t){if(e.userData&&e.userData.residualVariable){let s=Bo(e.userData.residualVariable);if(!t[s])return s}let r=e.getDependencies().filter(s=>s[0]!==\"_\"),n;for(let s of r){let o=s.match(/_(.*)/);if(o&&(n=\"e_\"+o[1],!t[n]))return n}let i=1;for(;;){if(n=\"e_\"+i,!t[n])return n;i++}}function qN({policy:e,frame:t},r,n){let i=r._rhs.getDependencies(),s,o;for(let p of i){if(n.hasOwnProperty(p))continue;let f=t[p];if(!f||(f.type===\"Assignment\"&&(f=f._expression),!f.buildIRExpression))continue;let m=f.buildIRExpression(e,t,{coerceToNumber:!0});if(!m.isError&&m.valueType===le){if(s!==void 0){s=void 0,o=void 0;break}m.getDependencies().length===0&&(s=p,o=m)}}let a=Object.create(t);s!==void 0&&(a[s]=void 0);let u=r._rhs.buildIRExpression(e,a,{coerceToNumber:!0}),c=Object.create(a);for(let p in n)c[p]=n[p];let l=r._rhs.buildIRExpression(e,c,{coerceToNumber:!0});return o?{node:u,substituted:l,listNode:o,isValid:!0}:{node:u,substituted:l,listNode:o,isValid:!1}}function _z(e,t,r){let n=[];t||(t={}),r||(r={});for(let i of e){let s=fn(i);r[i]&&isFinite(r[i].asValue())?n.push(+r[i].asValue()):t.hasOwnProperty(s)&&isFinite(+t[s])?n.push(+t[s]):n.push(1)}return n}function $N(e,t){let r=t.getDependencies(),n=t.getCompiledFunction(r).fn;if(r.length){let i=t.findLinearSubset(r),s=i.every(a=>a),o=[];for(let a of r)o.push(t.takeDerivative(a).getCompiledFunction(r).fn);if(s){let a=r.map(()=>Re(0,1)),u=t.interpretWithParameters(a),c=[];for(let m of r)c.push(t.takeDerivative(m).interpretWithParameters(a));let l=G0(u,c);if(l){let m=t.interpretWithParameters(l);return{solution:l,residuals:m,MSE:Y0(m),isLinear:s}}let{solution:p,MSE:f}=B0(n,z0(n,o));return{solution:p,residuals:n.apply(void 0,p),MSE:f,isLinear:s}}else{let a=[];for(let p of r)a.push(t.boundDomain(p));let u={linearSubset:i,bounds:a,preferredInitialGuess:e},{solution:c,MSE:l}=B0(n,VN(n,o,u));return{solution:c,residuals:n.apply(void 0,c),MSE:l,isLinear:s}}}else return{solution:[],residuals:t.interpretWithParameters([]),MSE:zu(n,[]),isLinear:!0}}function YN(e,t){let r={},n=t.getDependencies();for(let i=0;i<n.length;i++){let s=new v.RegressionParameter(e[i]);r[n[i]]=s}return r}function XN(e,t,r,n,i,s){let o=Y0(n);if(!isFinite(o))throw pP();if(t.getDependencies().length>0)return{RMSE:Math.sqrt(o)};let a=W(t.valueType)?Cf(t.asValue()):0;if(t.getDependencies().length||!isFinite(a)||a<=0||!e.isLhsSimple)return{RMSE:Math.sqrt(o)};{let u=1-o/a;if(r.isValid){let c=[],l=[],p=i&&(s===mi.LINLOG||s===mi.LOGLOG);v.List.eachArgs([r.listNode,t],function(m){let g=m[0].isConstant?m[0].asCompilerValue():NaN,y=m[1].isConstant?m[1].asCompilerValue():NaN;c.push(p?Math.log(Y(g)):g),l.push(y)});let f=Iy(c.map(m=>Y(m)),l.map(m=>Y(m)));if(wi(Lz(c,l).MSE,o,8))return{r:f,rsquared:f*f}}return{Rsquared:u}}}function Lz(e,t){let r=t,n=[e.map(a=>xi(a)),e.map(()=>Re(-1,1))],i=G0(r,n);if(i){let[a,u]=i,c=[];for(let l=0;l<t.length;l++)c.push(Ki(t[l],ps(fs(a,e[l]),u)));return{solution:i,MSE:Y0(c)}}function s(a,u){let c=[];for(let l=0;l<e.length;l++)c.push(Y(t[l])-(a*Y(e[l])+u));return c}return z0(s,[function(){return e.map(function(a){return-Y(a)})},function(){return e.map(function(){return-1})}])}function wz(e,t,r,n){let i=e._rhs.getDependencies(),s;for(let o in r){if(!r.hasOwnProperty(o))continue;let a=r[o].concreteTree;if(!qs(a)||!a.columns[0])continue;let u=r[o].rawTree.columns;if(!u||!u.length)continue;let c=u[0].getExports(n);if(c.length===1&&i.indexOf(c[0])!==-1){for(let l=1;l<u.length;l++)if(u[l].getDependencies().indexOf(t)!==-1)return;s=s||o}}return s||void 0}function $0(e,t){let r=e.length,n=e[0],i=t[0],s=e[r-1],o=t[r-1];if(!isFinite(n)||!isFinite(s)||!isFinite(i)||!isFinite(o)||o-i===0)return!1;let a=s-n;if(a===0)return!1;for(let u=1;u<r-1;u++){let c=e[u],l=t[u],p=(o*(c-n)+i*(s-c))/a;if(!wi(l,p,5))return!1}return!0}var mi={NONE:0,LOGLIN:1,LOGLOG:2,LINLOG:3};function Fz(e,t,r){if(!e.isLhsSimple||!r.isValid)return mi.NONE;let n=r.substituted;if(n.isError||n.valueType!==T)return mi.NONE;let i=n.getDependencies();if(i.length!==1||isFinite(r.node.polynomialOrder(i[0])))return mi.NONE;let s=n.getCompiledFunction(i).fn,o=r.listNode;if(n.valueType!==T)return mi.NONE;let a=o.mapElements(f=>+f.asValue());if(a.length<3)return mi.NONE;a.sort(function(f,m){return f-m});let u=a.map(s),c=u.map(Math.log),l=a.map(Math.log),p=!0;return v.List.wrap(t).eachElement(f=>{isFinite(Math.log(+f.asValue()))||(p=!1)}),$0(a,c)&&p?mi.LOGLIN:$0(l,c)&&p?mi.LOGLOG:$0(l,u)?mi.LINLOG:mi.NONE}function ZN({policy:e,frame:t},r,n){let i=Object.create(t);for(let a in n)n.hasOwnProperty(a)&&(i[a]=n[a]);let s=ap({policy:e,frame:i,wrapInList:!0},r),o=s.getError();if(o)throw o;return s.asCompilerValue()}function Y0(e){let t=0;for(let r of e){let n=Y(r);t+=n*n}return t/e.length}function WN(e,t){let r,n,i=t._chunk;if(i&&(n=HN(i)),!n||n.length===0)return t=t.deriveRegressionRestrictions(),r=$N(e,t),{parameters:YN(r.solution,t),residuals:r.residuals,isLinear:r.isLinear,parameterWarning:!1};let s=t.getDependencies(),o=t.getCompiledFunction(s).fn,a=1/0,u={},c,l=!1;for(let p of n){let f=new dr(p.chunk);if(f=f.deriveRegressionRestrictions(),r=$N(p.forwardParameterMap(e),f),r.MSE<a){let m=p.reverseParameterMap(r.solution.map(y=>Y(y))),g=zu(o,m);if(u&&(!isFinite(g)||g>=a)){isFinite(g)||(l=!0);continue}a=r.MSE,u=YN(m,t),c=o.apply(void 0,m)}}return{parameters:u,residuals:c,isLinear:!1,parameterWarning:l}}v.Base.prototype.analyze=function(e,t){return jn(this)?Jn(e,t,this):new U(e,t,this,this.tryGetConcreteTree(e,t))};function mh(e,t,r,n){if(n.isError)return new U(e,t,r,n);if(!e.areAllScalesLinear()&&!Ip(n.valueType)){let u=Hp(ne(n.valueType));return u.setCursorContext(n.getCursorContext()),new U(e,t,r,u)}var i=As(e,n),s=n.getDependencies();let o;switch(n.valueType){case Dt:case Lr:case Xe:{o=n;break}case qt:case Zr:case Se:case xr:case he:case wr:case fe:case Fr:case be:case Vr:case _e:case Br:case Me:case Gr:case Ge:case mr:case Ae:case yr:case Ue:case bn:case Ke:case Be:case Or:case Rt:case rn:case Ce:case sn:case Pr:case nn:case Rr:case xn:case pr:case Hn:i.length?o=ar(r.getSliderVariables(e,n)).setDependencies(i):o=n;break;case C:case V:case xt:case tn:if(i.length)if(e.validParametricVariables(i))o=n;else{var a=r.getSliderVariables(e,n);o=ar(a).setDependencies(a)}else o=n;break;case Wr:case cn:case jr:case ln:case Rn:case Nn:case Cn:case An:{i.length===0?o=n:o=ar(r.getSliderVariables(e,n)).setDependencies(i);break}case T:case le:i.length===0?o=n:i.length<=(e.is3dPolicy()?2:1)?e.is3dPolicy()&&s.length>i.length&&!e.validImplicitVariables(s)?o=ar(r.getSliderVariables(e,n)).setDependencies(s):e.validExpressionVariables(i)?o=n:o=Tm(e.implicitDependency(i)).setDependencies(i):e.validImplicitVariables(i)?o=Tm().setDependencies(i):o=ar(r.getSliderVariables(e,n)).setDependencies(s);break;default:o=ee(`Programming error: unexpected value type ${n.valueType}`)}return Eo(o)&&o.setCursorContext(n.getCursorContext()),o=kc(e,r,o),new U(e,t,r,o)}function JN(e){return new v.FunctionCall(\"pdf\",[e,new v.Identifier(\"x\")])}v.Identifier.prototype.analyze=function(e,t){let r=this.tryGetConcreteTree(e,t,{coerceToNumber:!0}),n=mh(e,t,this,r);return jn(this)&&!Z0(n)?Jn(e,t,this):n};v.FunctionCall.prototype.analyze=function(e,t,r){var n;Ig[this._symbol]&&Nc(t,this).length===0&&!e.is3dPolicy()?n=JN(this).tryGetConcreteTree(e,t):n=this.tryGetConcreteTree(e,t);var i=mh(e,t,this,n);if(jn(this)&&!Z0(i))return Jn(e,t,this);var s=this.getMoveStrategy(e,t,n,r,this.userData);if(s){var o=this.getDefaultDragMode(s),a=n.asCompilerValue(),u=[new v.Constant(a[0]),new v.Constant(a[1])];return new U(e,t,this,new v.MovablePoint(u,s,o))}return i};v.Expression.prototype.analyze=function(e,t){var r=mh(e,t,this,this.tryGetConcreteTree(e,t));return jn(this)&&!Z0(r)?Jn(e,t,this):r};v.FunctionDefinition.prototype.analyze=Vz;function Vz(e,t){if(jn(this))return Jn(e,t,this);if(rt[this._symbol])return this.asEquation().analyze(e,t);var r=this._symbol.split(\"_\")[0];if(rt[r]&&rt[r].isFunction)return new U(e,t,this,cl(this._symbol,r));let n=this.tryGetConcreteTree(e,t);if(n instanceof v.Error&&!n.blocksExport&&this._argSymbols.length===1){let u=Object.create(t);u[this._argSymbols[0]]=new Fe(\"identityTransformation\");let c=this._expression.tryGetConcreteTree(e,u);if(!(c instanceof v.Error))return new U(e,t,this,c)}if(n.isError)return new U(e,t,this,n);var i=this._argSymbols,s=n.getDependencies();if(s.indexOf(this._symbol)!==-1)return new U(e,t,this,Zp(this._symbol));var o=s.filter(function(u){return i.indexOf(u)===-1});if(e.unplottablePolarFunction(this._symbol,s))return new U(e,t,this,Kx());if(e.is3dPolicy()&&e.assignmentForbidden(this._symbol))return new U(e,t,this,LP(this._symbol));if(o.some(function(u){return e.assignmentForbidden(u)}))return new U(e,t,this,Wp(o,this._symbol,i).setDependencies(s));if(o.length){var a=this.getSliderVariables(e,n);return new U(e,t,this,ar(a).setDependencies(a))}return!e.areAllScalesLinear()&&!Ip(n.valueType)?new U(e,t,this,Hp(ne(n.valueType))):(n=kc(e,this,n),new U(e,t,this,n))}v.Assignment.prototype.analyze=function(e,t,r){if(jn(this))return Jn(e,t,this);var n=this._symbol;if(!e.validLHS(n))return new U(e,t,this,Qx(n));if(rt[n])return this.asEquation().analyze(e,t);var i;if(this._expression instanceof v.FunctionCall&&Ig[this._expression._symbol]&&Nc(t,this).length===0&&!e.is3dPolicy())i=JN(this._expression).tryGetConcreteTree(e,t);else{var s=Object.create(t);s[n]=e.validSolvedVariable(n)?void 0:nc(),i=this.tryGetConcreteTree(e,s)}if(i.isError)return new U(e,t,this,i);if(!e.areAllScalesLinear()&&!Ip(i.valueType))return new U(e,t,this,Hp(ne(i.valueType)));if(this.isEquation(e,i))return this.asEquation().analyze(e,t);let o=i.valueType===qt||i.valueType===Zr;if(e.assignmentForbidden(n)&&o){let g=jx(n).allowExport().setDependencies([n]);return new U(e,t,this,g)}let a=i.getDependencies(),u=As(e,i),c=u.includes(\"x\")||u.includes(\"y\"),l=u.includes(\"r\")||u.includes(\"theta\");if(n===\"r\"&&a.includes(\"phi\")){let g=u.includes(\"z\")?gm():Xx();return new U(e,t,this,g)}if(n===\"rho\"&&u.includes(\"z\")){let g=a.includes(\"phi\")?gm():Zx();return new U(e,t,this,g)}let p=this.getSliderVariables(e,i,a);if(e.tooManySliderVariables(a,p,o)||c&&l){let g=ar(p).allowExport().setDependencies(p);return new U(e,t,this,g)}var f=this.getMoveStrategy(e,t,i,r,this.userData);if(f){var m=this.getDefaultDragMode(f);return i=new v.MovablePoint([i.elementAt(0),i.elementAt(1)],f,m),new U(e,t,this,i)}return i=kc(e,this,i),new U(e,t,this,i)};v.RecursiveFunctionBaseCase.prototype.analyze=function(e,t,r){return this.specifiedArg.valid?this.asAssignment().analyze(e,t,r):new U(e,t,this,this.specifiedArg.error)};v.CoordinateEquation.prototype.analyze=function(e,t){if(!e.validCoordinateEquationSymbol(this._concatenatedSymbol))return this.asEquation().analyze(e,t);if(jn(this))return Jn(e,t,this);let r=this.tryGetConcreteTree(e,t);return r=kc(e,this,r),new U(e,t,this,r)};v.Regression.prototype.analyze=function(e,t,r,n,i){if(jn(this))return Jn(e,t,this);var s={policy:e,frame:t,exportFrame:r,lastExportFrame:n,priorAnalysis:i};return new U(e,t,this,jN(s,this))};function X0(e,t){var r=this.tryGetConcreteTree(e,t),n=r.getDependencies();return n.length?new U(e,t,this,ar(this.getSliderVariables(e,r)).setDependencies(n)):new U(e,t,this,this.tryGetConcreteTree(e,t))}v.Histogram.prototype.analyze=function(e,t){return jn(this)?Jn(e,t,this):e.areAllScalesLinear()?X0.call(this,e,t):new U(e,t,this,Vb())};v.DotPlot.prototype.analyze=function(e,t){return jn(this)?Jn(e,t,this):e.areAllScalesLinear()?X0.call(this,e,t):new U(e,t,this,Bb())};v.BoxPlot.prototype.analyze=function(e,t){return jn(this)?Jn(e,t,this):e.areAllScalesLinear()?X0.call(this,e,t):new U(e,t,this,Gb())};function QN(e){return function(t,r){if(jn(this))return Jn(t,r,this);var n=this.tryGetConcreteTree(t,r),i=n.getDependencies();if(i.length)return new U(t,r,this,ar(this.getSliderVariables(t,n)).setDependencies(i));var s=new U(t,r,this,this.tryGetConcreteTree(t,r));if(!n.isError){s.evaluationState.expression_type=\"TTEST\";var o=n.args.map(function(a){return a.asValue()});s.evaluationState.ttest_results=e.apply(null,o)}return s}}v.TTest.prototype.analyze=QN(FT);v.IndependentTTest.prototype.analyze=QN(VT);v.Stats.prototype.analyze=function(e,t){if(jn(this))return Jn(e,t,this);var r=this.tryGetConcreteTree(e,t),n=r.getDependencies();if(n.length)return new U(e,t,this,ar(this.getSliderVariables(e,r)).setDependencies(n));var i=new U(e,t,this,this.tryGetConcreteTree(e,t));if(!r.isError){i.evaluationState.expression_type=\"STATS\";var s=r.args.map(function(o){return o.asValue()});i.evaluationState.stats_results=BT.apply(null,s)}return i};v.Equation.prototype.analyze=v.BaseComparator.prototype.analyze=function(e,t){if(jn(this))return Jn(e,t,this);var r=this.getOperator()!==\"=\";if(r&&!os.plotInequalities)return new U(e,t,this,hm());var n=dN({policy:e,frame:t},this.asComparator());if(n.isError)return new U(e,t,this,n);let i=As(e,n);if(n instanceof v.SolvedEquation&&i.length){var s=i.concat(n._symbol);if(!e.validImplicitVariables(s))return new U(e,t,this,nc().setDependencies(s))}return this.getGraphMode(e,n)===8&&!e.validImplicitVariables(i)?new U(e,t,this,nc().setDependencies(i)):(n=kc(e,this,n),new U(e,t,this,n))};v.DoubleInequality.prototype.analyze=function(e,t){if(jn(this))return Jn(e,t,this);if(!os.plotInequalities)return new U(e,t,this,hm());var r=this.tryGetConcreteTree(e,t);if(r.isError)return new U(e,t,this,r);var n=r.getDependencies();return _n[this._operators[0]].direction!==_n[this._operators[1]].direction?new U(e,t,this,xm()):e.validDoubleInequalitySymbol(r._symbol)?e.validDoubleInequalityVariables(n)?n.length>2?new U(e,t,this,ar(this.getSliderVariables(e,r)).setDependencies(n)):r._expressions[0].getDependencies().indexOf(r._symbol)!==-1||r._expressions[1].getDependencies().indexOf(r._symbol)!==-1?new U(e,t,this,Pm().setDependencies(n)):new U(e,t,this,r):new U(e,t,this,bm().setDependencies(n)):new U(e,t,this,bm().setDependencies(n))};v.ComparatorChain.prototype.analyze=function(e,t){if(jn(this))return Jn(e,t,this);var r=this.tryGetConcreteTree(e,t);if(r.isError)return new U(e,t,this,r);var n=r.getDependencies();if(n.length)if(e.is3dPolicy()){if(!e.validImplicitVariables(n))return new U(e,t,this,(this.symbols.includes(\"=\")?tP():sP()).setDependencies(n));if(!(this.symbols.every(s=>s===\"<\"||s===\"<=\")||this.symbols.every(s=>s===\">\"||s===\">=\")||this.symbols.every(s=>s===\"=\")))return new U(e,t,this,xm().setDependencies(n));if(this.symbols.includes(\"=\")&&!n.includes(\"z\"))return new U(e,t,this,oP().setDependencies(n));let i=this._difference.tryGetConcreteTree(e,t);return i=kc(e,this,i),new U(e,t,this,i)}else return this.symbols.includes(\"=\")?new U(e,t,this,aP()):this.symbols.length>2?new U(e,t,this,sb()):e.validDoubleInequalityVariables(n)?new U(e,t,this,Pm()):new U(e,t,this,ar(this.getSliderVariables(e,r)).setDependencies(n));return new U(e,t,this,r)};v.ParenSeq.prototype.analyze=function(e,t,r){if(jn(this))return Jn(e,t,this);var n=this.tryGetConcreteTree(e,t);if(n.isError)return new U(e,t,this,n);var i=this.getMoveStrategy(e,t,n,r,this.userData);if(i){var s=this.getDefaultDragMode(i),o=n.asCompilerValue(),a=[new v.Constant(o[0]),new v.Constant(o[1])];return new U(e,t,this,new v.MovablePoint(a,i,s))}return mh(e,t,this,n)};function Bz(e,t){return e.filter(function(r){return!t[r]})}function Gz(e){for(var t={},r=0;r<e.length;r++){var n=e[r];if(n instanceof fc&&n.header instanceof v.Identifier){var i=n.header._symbol;t[i]===void 0&&(t[i]=0),t[i]+=1}}return t}v.Table.prototype.analyze=function(e,t){var r=Object.create(t),n=[],i=Gz(this.columns),s;for(s=0;s<this.columns.length;s++){var o=this.columns[s];if(o instanceof fc&&o.header instanceof v.Identifier){var a=o.header._symbol,u=r[a],c=i[a]>1;u&&u.isError&&(u.isTableCycleWithoutGlobalDefinition||u.isMultiplyDefinedByTables&&!c)&&(r[a]=void 0)}var l=o.analyze(e,r);if(s===0&&l.concreteTree.isIndependent){var p=l.concreteTree.getDependencies()[0];e.validFirstColumnVariable(p)||(l=new U(e,t,o,cP()))}if(l.concreteTree.isIndependent)l.rawTree.exportToLocal(e,l.concreteTree,r);else if(!l.concreteTree.isError){var f=l.concreteTree.header.getDependencies(),m=Bz(f,r);m.length&&(l=new U(e,t,o,ar(m).setDependencies(m)))}n.push(l.concreteTree)}var g=1;for(s=0;s<n.length;s++)n[s].isError||(g=Math.max(n[s].values.length,g));for(s=0;s<n.length;s++)if(!n[s].isError&&n[s].header.isConstant){for(var y=[],d=0;d<g;d++)y.push(n[s].header);n[s]=new v.TableColumn(n[s].header,y)}var h=new v.Table(n),b=new U(e,t,this,h);return b.evaluationState.is_graphable=!0,b};v.TableColumn.prototype.analyze=function(e,t){var r=this.header.tableError();if(r)return new U(e,t,this,uP(r));var n=this.tryGetConcreteTree(e,t);if(n.isError)return new U(e,t,this,n);if(n.header.isError)return new U(e,t,this,n.header);if(n.values.isError)return new U(e,t,this,n.values);for(var i=0;i<n.values.length;i++)if(!n.values[i].isError){var s=this.values[i]&&this.values[i].tableError();if(s){n.values[i]=pl(s);continue}var o=n.values[i].getDependencies();o.length&&(n.values[i]=ar(o).setDependencies(o))}return new U(e,t,this,n)};v.Image.prototype.analyze=function(e,t,r){var n=this.tryGetConcreteTree(e,t);if(n.radianAngle.isError||n.center.isError||n.width.isError||n.height.isError||n.opacity.isError)return new U(e,t,this,n);var i=n.center.getDependencies(),s=n.radianAngle.getDependencies(),o=n.width.getDependencies(),a=n.height.getDependencies(),u=n.opacity.getDependencies();return i.length||s.length||o.length||a.length||u.length?new U(e,t,this,new v.Image({center:i.length?ar(s).setDependencies(i):n.center,radianAngle:s.length?ar(s).setDependencies(s):n.radianAngle,width:o.length?ar(o).setDependencies(o):n.width,height:a.length?ar(a).setDependencies(a):n.height,opacity:u.length?ar(u).setDependencies(u):n.opacity})):(n.moveStrategy=this.getMoveStrategy(e,t,n,r,this.userData),new U(e,t,this,n))};v.Slider.prototype.analyze=function(e,t){if(jn(this))return Jn(e,t,this);var r=this.tryGetConcreteTree(e,t),n=r.sliderInfo,i;if(n.missingVars.length){var s=Sp(n.missingVars);i=new U(e,t,this,ar(e.sliderVariables(s)).setDependencies(s).allowExport())}else i=new U(e,t,this,r);var o=i.evaluationState;if(os.sliders){o.assignment=n.exportedSymbol,o.slider_min_number=n.values.min,o.slider_max_number=n.values.max,o.slider_step_number=n.values.step,o.slider_min_valid=n.valids.min,o.slider_max_valid=n.valids.max,o.slider_step_valid=n.valids.step;var a=o.slider_min_valid&&o.slider_max_valid&&o.slider_step_valid;o.is_slider=!0,o.raw_slider_latex=this.getInputString(),o.is_slidable=a,o.is_animatable=o.is_slidable&&!o.is_graphable,n.errMsg&&(o.error=n.errMsg.getError())}return delete o.is_evaluable,delete o.zero_values,i};function jn(e){return\"latex\"in e.userData&&Go(e.userData.latex).slice(-1)===\"=\"}function Jn(e,t,r){return new U(e,t,r,Yp(\"=\"))}function Z0(e){return e.concreteTree.isConstant&&e.concreteTree.valueType===T}v.Base.prototype.analyzeFourFunction=function(e,t){var r=this.tryGetConcreteTree(e,t);return r.isError?new U(e,t,this,r):new U(e,t,this,ee(`Unexpected node type ${this.type}`))};v.Expression.prototype.analyzeFourFunction=function(e,t){var r=this.tryGetConcreteTree(e,t);if(r.isError)return new U(e,t,this,r);var n=r.getDependencies();if(n.length>0){var i=n[0],s,o=rt[i];return o?s=o.isFunction?gs(i):ic(i):s=ef(i),new U(e,t,this,s)}return new U(e,t,this,r)};v.Assignment.prototype.analyzeFourFunction=function(e,t){return new U(e,t,this,tf())};v.FunctionDefinition.prototype.analyzeFourFunction=function(e,t){return new U(e,t,this,rf())};v.Equation.prototype.analyzeFourFunction=function(e,t){return new U(e,t,this,ga())};function W0(e,t){return new U(e,t,this,sc())}v.DoubleInequality.prototype.analyzeFourFunction=W0;v.ComparatorChain.prototype.analyzeFourFunction=W0;v.BaseComparator.prototype.analyzeFourFunction=W0;v.Regression.prototype.analyzeFourFunction=function(e,t){return new U(e,t,this,oc())};v.ParenSeq.prototype.analyzeFourFunction=function(e,t){return new U(e,t,this,ac())};v.Base.prototype.analyzeScientific=function(e,t){var r=this.tryGetConcreteTree(e,t);return r.isError?new U(e,t,this,r):new U(e,t,this,ee(`Unexpected node type ${this.type}`))};v.Expression.prototype.analyzeScientific=function(e,t){var r=this.tryGetConcreteTree(e,t);if(r.isError)return new U(e,t,this,r);var n=r.getDependencies();return n.length>0?new U(e,t,this,ar(n)):new U(e,t,this,r)};v.Assignment.prototype.analyzeScientific=function(e,t){var r=this._symbol;if(rt[r])return new U(e,t,this,cl(r));var n=Object.create(t);n[r]=ga();var i=this.tryGetConcreteTree(e,n);if(i.isError)return new U(e,t,this,i);var s=i.getDependencies();return this.isEquation(e,i)?new U(e,t,this,ga()):s.length>0?new U(e,t,this,ar(s)):new U(e,t,this,i)};v.FunctionDefinition.prototype.analyzeScientific=function(e,t){if(rt[this._symbol])return new U(e,t,this,cl(this._symbol));var r=this.tryGetConcreteTree(e,t);if(r.isError)return new U(e,t,this,r);var n=this._argSymbols,i=r.getDependencies();if(i.indexOf(this._symbol)!==-1)return new U(e,t,this,Zp(this._symbol));var s=i.filter(function(o){return n.indexOf(o)===-1});return s.length?new U(e,t,this,Wp(s,this._symbol,n)):new U(e,t,this,r)};v.Equation.prototype.analyzeScientific=function(e,t){return new U(e,t,this,ga())};function j0(e,t){return new U(e,t,this,sc())}v.DoubleInequality.prototype.analyzeScientific=j0;v.ComparatorChain.prototype.analyzeScientific=j0;v.BaseComparator.prototype.analyzeScientific=j0;v.Regression.prototype.analyzeScientific=function(e,t){return new U(e,t,this,oc())};v.ParenSeq.prototype.analyzeScientific=function(e,t){return new U(e,t,this,ac())};v.Base.prototype.analyzeSingleExpressionScientific=function(e,t){var r=this.tryGetConcreteTree(e,t);return r.isError?new U(e,t,this,r):new U(e,t,this,ee(`Unexpected node type ${this.type}`))};v.Expression.prototype.analyzeSingleExpressionScientific=function(e,t){var r=this.tryGetConcreteTree(e,t);if(r.isError)return new U(e,t,this,r);var n=r.getDependencies();if(n.length>0){var i=n[0],s,o=rt[i];return o?s=o.isFunction?gs(i):ic(i):s=ef(i),new U(e,t,this,s)}return new U(e,t,this,r)};v.Assignment.prototype.analyzeSingleExpressionScientific=function(e,t){return new U(e,t,this,tf())};v.FunctionDefinition.prototype.analyzeSingleExpressionScientific=function(e,t){return new U(e,t,this,rf())};v.Equation.prototype.analyzeSingleExpressionScientific=function(e,t){return new U(e,t,this,ga())};function J0(e,t){return new U(e,t,this,sc())}v.DoubleInequality.prototype.analyzeSingleExpressionScientific=J0;v.ComparatorChain.prototype.analyzeSingleExpressionScientific=J0;v.BaseComparator.prototype.analyzeSingleExpressionScientific=J0;v.Regression.prototype.analyzeSingleExpressionScientific=function(e,t){return new U(e,t,this,oc())};v.ParenSeq.prototype.analyzeSingleExpressionScientific=function(e,t){return new U(e,t,this,ac())};v.Base.prototype.getGraphInfo=function(e,t){var r=t.getDependencies(),n,i;switch(r.length){case 0:n=KN(t),i=t.boundDomain(\"x\");break;case 1:i=t.boundDomain(r[0]),ji(i)&&!hi(i)&&(n=KN(t));break;default:i=Xr();break}return{graphMode:this.getGraphMode(e,t),color:aa(this.userData,this.metaData),pointStyle:this.userData.pointStyle,lineStyle:this.userData.lineStyle,arrowMode:this.userData.arrowMode,operator:this.getOperator(),isLinear:!!n,linearCoefficients:n,domainBound:i}};function KN(e){switch(e.valueType){case T:return Q0(e);case C:{var t=Q0(e.elementAt(0)),r=Q0(e.elementAt(1));return!t||!r?void 0:[t,r]}default:return}}function Q0(e){var t=e.getDependencies();switch(t.length){case 0:return[+e.asValue(),0];case 1:if(e.polynomialOrder(t[0])>1)return;var r=e.getPolynomialCoefficients(t[0]);return[r[0]?+r[0].asValue():0,r[1]?+r[1].asValue():0];default:return}}var eA=new v.Constant(Re(0,1));v.Base.prototype.getMoveStrategy=function(){};v.Assignment.prototype.getMoveStrategy=function(e,t,r,n,i){return this._expression.getMoveStrategy(e,t,r,n,i)};function zz(e){return{type:\"updateSliderNonlinear\",id:e.id,initialValue:e.initialValue,min:e.min,max:e.max,compiled:e.compiled,movesOn:e.movesOn,hasLinearComponent:e.hasLinearComponent}}function kz(e){return{type:\"updateGliderParameter\",span:e.span,movesOn:e.movesOn}}function Hz(e){return{type:\"updateSliderForGlider\",id:e.sliderId,movesOn:e.movesOn,min:e.min,max:e.max}}function tA(e,t,r,n,i,s){var o=t.getDependencies();for(let d of o)if(i[d])return;for(var a=o.length-1;a>=0;a--){var u=o[a];if(!s[u]){var c=n[u];if(c!==void 0){var l=r[u];if(l.order===1){var p=l.tree,f=p.getPolynomialCoefficients(u),m=f[1]||eA,g=f[0]||eA;if(!(!g.isConstant||!m.isConstant)&&!(!isFinite(g.asValue())||!isFinite(m.asValue()))&&m.asValue()!==0){var y=[-g.asValue()/m.asValue(),1/m.asValue()];return{symbol:u,id:c,coefficients:y}}}}}}}function Uz(e,t){for(var r in t){var n=t[r].evaluationState,i=n.assignment;if(i===e)return r}}function qz(e){for(var t={},r=0;r<e.length;r++)t[e[r]]=!0;return t}function K0(e,t){var r=qz(e),n={};for(var i in t){var s=t[i].evaluationState.assignment;t[i].evaluationState.is_slidable&&r[s]&&(n[s]=i)}return n}function rA(e,t,r,n){for(var i=[],s=0;s<r.length;s++){var o=r[s],a={};i.push(a);for(var u=0;u<n.length;u++){var c=n[u],l=Object.create(t);l[c]=void 0;var p=o.tryGetConcreteTree(e,l);if(p.isError){a[c]={tree:p,order:1/0};continue}else a[c]={tree:p,order:p.polynomialOrder(c)}}}return i}function nA(e,t,r){for(var n=0;n<e.length;n++){var i=e[n];t[i].order!==0&&(r[i]=!0)}}v.ParenSeq.prototype.getMoveStrategy=function(e,t,r,n,i){if(r.valueType!==C||r.getDependencies().length!==0)return;for(var s=this.getDependencies(),o=K0(s,n),a=Object.keys(o),u=this.args,c=rA(e,t,u,a),l=[],p={},f={},m=0;m<2;m++){var g=u[m];let I=g.getInputSpan();if(g.isConstant){l[m]=I?{type:\"updateCoordinate\",inputSpan:I}:{type:\"none\"};continue}var y=tA(e,g,c[m],o,p,f);y&&(l[m]={type:\"updateSlider\",id:y.id,coefficients:y.coefficients},p[y.symbol]=!0,nA(a,c[m],f)),l[m]||(l[m]={type:\"none\"})}let[d,h]=l,b;if(d.type===\"none\"&&h.type===\"none\"&&a.length===1&&(b=a[0]),!b)return d.type!==\"none\"||h.type!==\"none\"?l:void 0;var x=o[b],P;try{var E=Object.create(t);E[b]=void 0,P=this.getConcreteTree(e,E).getCompiledFunction()}catch(I){return}QT(P);var M=n[x].evaluationState;return[zz({id:x,initialValue:M.constant_value,min:M.slider_min_number,max:M.slider_max_number,compiled:P,hasLinearComponent:d.type===\"updateSlider\"||h.type===\"updateSlider\"}),{type:\"none\"}]};v.FunctionCall.prototype.getMoveStrategy=function(e,t,r,n,i){if(this._symbol===\"glider\"&&!(!r.isTypedConstant||r.valueType!==C)){var s,o,a;switch(this.args[1].type){case\"Constant\":{var u=this.args[1].asValue();if(typeof u!=\"number\"||(s=this.args[0].getConcreteTree(e,t),!s.isTypedConstant))return;a=s.asTypedValue();let g=this.args[1].getInputSpan();return[g?kz({span:g,movesOn:a}):{type:\"none\"},{type:\"none\"}]}case\"Identifier\":{var c=this.args[1]._symbol,l=K0([c],n),p=l[c];if(p===void 0)return;var f=n[p].evaluationState,m=Object.create(t);return m[c]=void 0,s=this.args[0].getConcreteTree(e,m),s.isTypedConstant?(a=s.asTypedValue(),o={min:f.slider_min_number,max:f.slider_max_number},[Hz({min:o.min,max:o.max,movesOn:a,sliderId:p}),{type:\"none\"}]):void 0}default:return}}};v.Image.prototype.getMoveStrategy=function(e,t,r,n,i){if(!(r.center.valueType!==C||r.center.getDependencies().length!==0||!r.width.isConstant||!r.height.isConstant||!r.radianAngle.isConstant||!r.opacity.isConstant)){var s=this.getDependencies(),o=K0(s,n),a=Object.keys(o),u=[this.width,this.height];this.center.type===\"ParenSeq\"?u.push(this.center.args[0],this.center.args[1]):this.center.type===\"Identifier\"&&(this.center.referencedStatementId=Uz(this.center._symbol,n));for(var c={},l={},p=rA(e,t,u,a),f=[],m=[2,3,0,1],g=0;g<m.length;g++){var y=m[g],d=u[y];if(!d){f[y]={type:\"none\"};continue}if(d.isConstant){let b=d.getInputSpan();f[y]=b?{type:\"updateCoordinate\",inputSpan:b}:{type:\"none\"};continue}var h=tA(e,d,p[y],o,c,l);h&&(f[y]={type:\"updateSlider\",id:h.id,coefficients:h.coefficients},c[h.symbol]=!0,nA(a,p[y],l)),f[y]||(f[y]={type:\"none\"})}if(!(f[0].type===\"none\"&&f[1].type===\"none\"&&f[2].type===\"none\"&&f[3].type===\"none\"))return f}};v.Base.prototype.getDefaultDragMode=function(e){return\"NONE\"};v.Assignment.prototype.getDefaultDragMode=function(e){return e[0].type!==\"none\"&&e[1].type!==\"none\"?\"XY\":e[0].type!==\"none\"?\"X\":e[1].type!==\"none\"?\"Y\":\"NONE\"};v.ParenSeq.prototype.getDefaultDragMode=function(e){return e[0].type===\"updateSlider\"&&e[1].type===\"updateSlider\"?\"XY\":e[0].type===\"updateSlider\"?\"X\":e[1].type===\"updateSlider\"?\"Y\":e[0].type===\"updateSliderNonlinear\"&&e[0].hasLinearComponent?\"X\":\"NONE\"};v.FunctionCall.prototype.getDefaultDragMode=function(e){return this._symbol!==\"glider\"?\"NONE\":v.Assignment.prototype.getDefaultDragMode.call(this,e)};var $z=v.List;v.Base.prototype.tableInfo=function(e,t){return!1};v.Identifier.prototype.tableInfo=function(e,t){return e.validFirstColumnVariable(this._symbol)?{independent_variable:this._symbol,dependent_column:this.getInputString(),by_reference:!1}:!1};v.Expression.prototype.tableInfo=function(e,t){var r=t.getDependencies();if(wa(this))return!1;switch(t.valueType){case C:case xt:if(r.length!==0||t.isMovablePoint&&(t.moveStrategy[0].type===\"updateSlider\"||t.moveStrategy[1].type===\"updateSlider\"))return!1;var n=$z.wrap(t).asValue();return{independent_variable:\"x\",dependent_column:\"y\",by_reference:!1,values:n};case T:if(r.length!==1)return!1;var i=r[0];return e.validFirstColumnVariable(i)?{independent_variable:i,dependent_column:this.getInputString(),by_reference:!1}:!1;default:return!1}};v.Assignment.prototype.tableInfo=function(e,t){if(t instanceof v.SolvedEquation||!this.getInputString().length||wa(this)||Tp(t.valueType))return!1;let r=t.getDependencies();if(r.length>1)return!1;let n;if(r.length===0){if(!e.tableableAsConstant(this._symbol))return!1;n=e.implicitIndependent(this._symbol)}else n=r[0];if(!e.validFirstColumnVariable(n))return!1;let i=e.assignmentForbidden(this._symbol)?Go(this.getInputString().replace(/[^=]*=/,\"\")):Go(this.getInputString().split(\"=\")[0]);return{independent_variable:n,dependent_column:i,by_reference:!e.assignmentForbidden(this._symbol)}};v.FunctionDefinition.prototype.tableInfo=function(e,t){if(this._argSymbols.length!==1||!this.getInputString().length)return!1;var r=t.getDependencies();if(r.length>1)return!1;var n=this._argSymbols[0];if(!e.validFirstColumnVariable(n))return!1;var i=e.assignmentForbidden(this._symbol),s=i?Go(this.getInputString().replace(/[^=]*=/,\"\")):Go(this.getInputString().split(\"=\")[0]);return{independent_variable:n,dependent_column:s,by_reference:!i}};v.BaseComparator.prototype.tableInfo=function(e,t){return!1};v.ComparatorChain.prototype.tableInfo=function(e,t){return!1};v.DoubleInequality.prototype.tableInfo=function(e,t){return!1};v.Equation.prototype.tableInfo=function(e,t){return!1};v.Base.prototype.tableError=function(){return this.isInequality()?S(\"shared-calculator-error-table-inequality-supplement\"):!(this instanceof v.Expression)&&!(this instanceof v.IRExpression)?S(\"shared-calculator-error-table-generic-supplement\"):!1};v.List.prototype.tableError=function(){return S(\"shared-calculator-error-table-list-supplement\")};v.Equation.prototype.tableError=v.Assignment.prototype.tableError=function(){return S(\"shared-calculator-error-table-equation-supplement\")};v.ComparatorChain.prototype.tableError=function(){return this.symbols.includes(\"=\")?S(\"shared-calculator-error-table-equation-supplement\"):S(\"shared-calculator-error-table-inequality-supplement\")};v.FunctionDefinition.prototype.tableError=function(){return S(\"shared-calculator-error-table-function-definition-supplement\")};v.Regression.prototype.tableError=function(){return S(\"shared-calculator-error-table-regression-supplement\")};v.List.prototype.elementAt=function(e){return e=Math.floor(e),e>=0&&e<this.args.length?this.args[e]:new v.Constant(NaN)};v.List.prototype.eachElement=function(t){for(var r=0;r<this.length;r++)t(this.elementAt(r),r)};v.List.prototype.mapElements=function(t){for(var r=[],n=0;n<this.length;n++)r.push(t(this.elementAt(n),n));return r};v.IRExpression.prototype.elementAt=function(e){var t=this._chunk.elementAt(e);return new dr(t)};v.ParenSeq.prototype.elementAt=function(e){return e<0||e>this.args.length-1?new v.Constant(NaN):this.args[e]};function Yz(){return fn(this._symbol)+\" \"}v.Identifier.prototype.printLatex=Yz;v.Constant.prototype.printLatex=function(){return na(this.asValue())};v.Ticker.prototype.printLatex=function(){return\"\\\\ticker\\\\left(\"+this.args.map(yi).join(\", \")+\"\\\\right)\"};v.Negative.prototype.printLatex=function(){return\"-\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\"};v.Add.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)+\\\\left(\"+this.args[1].printLatex()+\"\\\\right)\"};v.PercentOf.prototype.printLatex=function(){return this.args[0].printLatex()+\" \\\\% \\\\operatorname{of} \"+this.args[1].printLatex()};v.Subtract.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)-\\\\left(\"+this.args[1].printLatex()+\"\\\\right)\"};v.Multiply.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)*\\\\left(\"+this.args[1].printLatex()+\"\\\\right)\"};v.DotMultiply.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\\\\cdot\\\\left(\"+this.args[1].printLatex()+\"\\\\right)\"};v.CrossMultiply.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\\\\times\\\\left(\"+this.args[1].printLatex()+\"\\\\right)\"};v.Divide.prototype.printLatex=function(){return\"\\\\frac{\"+this.args[0].printLatex()+\"}{\"+this.args[1].printLatex()+\"}\"};v.Exponent.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)^{\"+this.args[1].printLatex()+\"}\"};v.Assignment.prototype.printLatex=function(){return fn(this._symbol)+\"=\"+this._expression.printLatex()};v.CoordinateEquation.prototype.printLatex=function(){return\"\\\\left(\"+this._symbols.map(e=>fn(e)).join(\",\")+\"\\\\right)=\"+this._expression.printLatex()};v.Equation.prototype.printLatex=function(){return this._lhs.printLatex()+\"=\"+this._rhs.printLatex()};function yh(e){switch(e){case\">\":return\">\";case\"<\":return\"<\";case\">=\":return\"\\\\ge \";case\"<=\":return\"\\\\le \";case\"=\":return\"=\"}return\"\"}v.BaseComparator.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\"+yh(this.operator)+\"\\\\left(\"+this.args[1].printLatex()+\"\\\\right)\"};v.ComparatorChain.prototype.printLatex=function(){let e=\"\";for(let t=0;t<this.symbols.length;t++)e+=`\\\\left(${this.args[t].printLatex()}\\\\right)${yh(this.symbols[t])}`;return e+=`\\\\left(${this.args[this.args.length-1].printLatex()}\\\\right)`,e};v.DoubleInequality.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\"+yh(this.args[1])+this.args[2].printLatex()+yh(this.args[3])+\"\\\\left(\"+this.args[4].printLatex()+\"\\\\right)\"};v.Or.prototype.printLatex=function(){return this.args[0].printLatex()+\",\"+this.args[1].printLatex()};function yi(e){return e.printLatex()}function iA(){switch(this._symbol){case\"sqrt\":return\"\\\\sqrt{\"+this.args[0].printLatex()+\"}\";case\"nthroot\":return\"\\\\sqrt[\"+this.args[1].printLatex()+\"]{\"+this.args[0].printLatex()+\"}\";case\"logbase\":return\"\\\\log_{\"+this.args[1].printLatex()+\"}\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\";default:return fn(this._symbol)+\"\\\\left(\"+this.args.map(yi).join(\", \")+\"\\\\right)\"}}v.FunctionCall.prototype.printLatex=iA;v.RecursiveFunctionCall.prototype.printLatex=iA;v.RecursiveFunctionBaseCase.prototype.printLatex=function(){return this.originalNode.printLatex()};v.SeededFunctionCall.prototype.printLatex=function(){return fn(this._symbol)+\"\\\\left(\"+this.args.slice(1).map(yi).join(\", \")+\"\\\\right)\"};v.DotAccess.prototype.printLatex=function(){return\"(\"+this.args[0].printLatex()+\").(\"+this.args[1].printLatex()+\")\"};v.Prime.prototype.printLatex=function(){switch(this.args[0]._symbol){case\"logbase\":return\"\\\\log_{\"+this.args[0].args[1].printLatex()+\"}\"+Array(this.order+1).join(\"'\")+\"\\\\left(\"+this.args[0].args[0].printLatex()+\"\\\\right)\";default:return fn(this.args[0]._symbol)+Array(this.order+1).join(\"'\")+\"\\\\left(\"+this.args[0].args.map(yi).join(\", \")+\"\\\\right)\"}};v.List.prototype.printLatex=function(){return\"\\\\left[\"+this.args.map(yi).join(\", \")+\"\\\\right]\"};v.Range.prototype.printLatex=function(){return\"\\\\left[\"+this.args[0].args.map(yi).join(\", \")+\" ... \"+this.args[1].args.map(yi).join(\", \")+\"\\\\right]\"};v.UpdateRule.prototype.printLatex=function(){return this.args[0].printLatex()+\"\\\\to(\"+this.args[1].printLatex()+\")\"};v.ListAccess.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\\\\left[\"+this.args[1].printLatex()+\"\\\\right]\"};v.ParenSeq.prototype.printLatex=function(){return\"\\\\left(\"+this.args.map(yi).join(\", \")+\"\\\\right)\"};v.BareSeq.prototype.printLatex=function(){return this.args.map(yi).join(\", \")};v.NamedCoordinateAccess.prototype.printLatex=function(){return\"\\\\left(\\\\left(\"+this.args[0].printLatex()+\"\\\\right).\"+this.symbol+\"\\\\right)\"};v.Norm.prototype.printLatex=function(){return\"\\\\left|\"+this.args[0].printLatex()+\"\\\\right|\"};v.Sum.prototype.printLatex=function(){return\"\\\\sum_{\"+this.args[0].printLatex()+\"=\"+this.args[1].printLatex()+\"}^{\"+this.args[2].printLatex()+\"}\\\\left(\"+this.args[3].printLatex()+\"\\\\right)\"};v.Product.prototype.printLatex=function(){return\"\\\\prod_{\"+this.args[0].printLatex()+\"=\"+this.args[1].printLatex()+\"}^{\"+this.args[2].printLatex()+\"}\\\\left(\"+this.args[3].printLatex()+\"\\\\right)\"};v.Integral.prototype.printLatex=function(){return\"\\\\int_{\"+this.args[1].printLatex()+\"}^{\"+this.args[2].printLatex()+\"}\\\\left(\"+this.args[3].printLatex()+\"\\\\right)d\"+this.args[0].printLatex()};v.FunctionExponent.prototype.printLatex=function(){return this.args[0].printLatex()+\"\\\\left(\"+this.args[1].printLatex()+\"\\\\right)^{\"+this.args[2].printLatex()+\"}\"};v.FunctionFactorial.prototype.printLatex=function(){return this.args[0].printLatex()+\"\\\\left(\"+this.args[1].printLatex()+\"\\\\right)!\"};function eM(e){return e.isConstant&&e.asValue()===!0}function Xz(e){return e.isConstant&&e.isNaN()}v.Piecewise.prototype.printLatex=function(){var e=this;if(eM(e.args[0]))return e.args[1].printLatex();for(var t=[\"\\\\left\\\\{\"];;){if(eM(e.args[0])){t.push(e.args[1].printLatex());break}if(t.push(e.args[0].printLatex(),\": \"),Xz(e.args[2])){t.push(e.args[1].printLatex());break}if(t.push(e.args[1].printLatex(),\", \"),!(e.args[2]instanceof v.Piecewise)){t.push(e.args[2].printLatex());break}e=e.args[2]}return t.push(\"\\\\right\\\\}\"),t.join(\"\")};v.Restriction.prototype.printLatex=function(){return eM(this.args[0])?\"\\\\left\\\\{\\\\right\\\\}\":\"\\\\left\\\\{\"+this.args[0].printLatex()+\"\\\\right\\\\}\"};v.FunctionDefinition.prototype.printLatex=function(){return fn(this._symbol)+\"\\\\left(\"+this._argSymbols.map(fn).join(\", \")+\"\\\\right) = \"+this._expression.printLatex()};v.Derivative.prototype.printLatex=function(){return\"\\\\frac{d}{d\"+fn(this._symbol)+\"}\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\"};v.Regression.prototype.printLatex=function(){return\"\\\\left(\"+this._lhs.printLatex()+\"\\\\right)\\\\sim\\\\left(\"+this._rhs.printLatex()+\"\\\\right)\"};v.Histogram.prototype.printLatex=function(){return\"\\\\histogram\\\\left(\"+this.args.map(yi).join(\", \")+\"\\\\right)\"};v.DotPlot.prototype.printLatex=function(){return\"\\\\dotplot\\\\left(\"+this.args.map(yi).join(\", \")+\"\\\\right)\"};v.BoxPlot.prototype.printLatex=function(){return\"\\\\boxplot\\\\left(\"+this.args.map(yi).join(\", \")+\"\\\\right)\"};v.TTest.prototype.printLatex=function(){return\"\\\\TTest\\\\left(\"+this.args.map(yi).join(\", \")+\"\\\\right)\"};v.IndependentTTest.prototype.printLatex=function(){return\"\\\\IndependentTTest\\\\left(\"+this.args.map(yi).join(\", \")+\"\\\\right)\"};v.Stats.prototype.printLatex=function(){return\"\\\\Stats\\\\left(\"+this.args.map(yi).join(\", \")+\"\\\\right)\"};v.AssignmentExpression.prototype.printLatex=function(){return fn(this._symbol)+\"=\"+this.args[1].printLatex()};v.ListComprehension.prototype.printLatex=function(){return\"\\\\left[\"+this._body.printLatex()+\"\\\\operatorname{for}\"+this._inputLists.map(yi).join(\", \")+\"\\\\right]\"};v.Substitution.prototype.printLatex=function(){return\"\\\\left(\\\\left(\"+this._body.printLatex()+\"\\\\right)\\\\operatorname{with}\"+this._assignments.map(yi).join(\", \")+\"\\\\right)\"};v.Construction.prototype.printLatex=function(){return\"\\\\construction \"};v.Base.prototype.getExpressionType=function(e,t){switch(e){case 114:case 115:case 116:return t&&W(t)?\"POINT3D_LIST\":\"POINT3D\";case 100:case 101:case 102:case 128:return\"CURVE3D_xyz_t\";case 119:return\"SEGMENT3D\";case 129:return\"VECTOR3D\";case 130:case 103:case 104:case 105:return\"SURFACE_xyz_uv\";case 110:return\"SURFACE_r_\\u03B8z\";case 124:return\"SURFACE_r_\\u03B8z_AMBIGUOUS\";case 109:return\"SURFACE_z_r\\u03B8\";case 111:return\"SURFACE_r_\\u03B8\\u03C6\";case 107:case 108:case 106:return\"SURFACE\";case 118:return\"SPHERE3D\";case 117:return\"TRIANGLE3D\";case 120:case 121:return\"SURFACE_AMBIGUOUS\";case 122:case 123:return\"SURFACE_CONSTANT_AMBIGUOUS\";case 112:case 113:case 210:return\"IMPLICIT_SURFACE\";case 126:case 127:return\"IMPLICIT_SURFACE_AMBIGUOUS\";case 3:case 4:return t&&W(t)?\"POINT_LIST\":\"SINGLE_POINT\";case 1:case 2:return\"X_OR_Y\";case 5:return\"PARAMETRIC\";case 6:return\"POLAR\";case 8:return\"IMPLICIT\";case 24:case 17:return\"VECTOR2D\";case 200:case 201:case 202:case 205:case 209:return\"SLICE\";case 211:case 206:return\"SLICE_r\\u03B8z_at_z\";case 203:return\"SLICE_zr\\u03B8_at_r\";case 204:return\"SLICE_zr\\u03B8_at_\\u03B8\";case 213:return\"SLICE_zr\\u03B8_at_xyz\";case 207:return\"SLICE_r\\u03B8\\u03C6_at_\\u03B8\";case 208:return\"SLICE_r\\u03B8\\u03C6_at_\\u03C6\";case 212:return\"SLICE_r\\u03B8\\u03C6_at_xyz\";case 214:case 215:return\"SLICE_xyz_uv\";default:return t!==void 0&&ce(t,Be)?\"POLYGON\":\"X_OR_Y\"}};v.Histogram.prototype.getExpressionType=function(e,t){return\"HISTOGRAM\"};v.DotPlot.prototype.getExpressionType=function(e,t){return\"DOTPLOT\"};v.BoxPlot.prototype.getExpressionType=function(e,t){return\"BOXPLOT\"};var gh=class extends Q{};var hh=class extends Q{constructor(t){super(t),this._symbol=\"sphere\"}};function Zz(e){return function(r){return new e(r)}}var Wz=[lu,Qa,Xa,vl,Yl,Xl,Fi,gh,pu,Ml,fu,xl,Pl,El,Sl,bl,ko,Ya,$l,Zl,sl,Wl,ts,jl,dn,il,gl,hl,Tl,hh,Ol,Tn,Dl,Il];for(let e of Wz)e.prototype.copyWithArgs=Zz(e);ws.prototype.copyWithArgs=function(e){return new Ti[this.operator](e)};ja.prototype.copyWithArgs=function(e){return new ja(this.symbols,e)};jt.prototype.copyWithArgs=function(e){return new jt(this._constantValue)};Ju.prototype.copyWithArgs=function(e){return new Ju(this.constructedObjectIds)};lc.prototype.copyWithArgs=function(e){return new lc(this._symbol,e)};mc.prototype.copyWithArgs=function(e){return new mc(this.tag,e)};lr.prototype.copyWithArgs=function(e){return new lr(new Fe(this._symbol),e)};Fe.prototype.copyWithArgs=function(e){return new Fe(this._symbol)};ha.prototype.copyWithArgs=function(e){return new ha(e[0],e[1],e.slice(2),this.shouldCoerceToList,this.parameters)};Qu.prototype.copyWithArgs=function(e){return new Qu(this.symbol,e)};cc.prototype.copyWithArgs=function(e){return new cc(this.order,e)};Ts.prototype.copyWithArgs=function(e){return new Ts(this._symbol,this.specifiedArg,e[0],this.originalNode)};Bi.prototype.copyWithArgs=function(e){return new Bi(this._symbol,this.recursiveParameter,e)};pc.prototype.copyWithArgs=function(e){return new pc(this.value)};Uo.prototype.copyWithArgs=function(e){return new Uo(e[0],e.slice(1))};dc.prototype.copyWithArgs=function(e){return new dc(this._stringValue)};function bh(e,t,r){let n=[],i={},s={},o={},a={},u={},c={},l={},p=new Set,f={},m=0,g=[],y=[];if(!r){r=[];for(let x in t)t.hasOwnProperty(x)&&r.push(x)}for(let x in t){if(!t.hasOwnProperty(x))continue;let P=t[x].exportPenalty||0;for(;n.length<P+1;)n.push([]);n[P].push(x)}for(let x of n){let P={};for(let E of x){let M=t[E],I=t[E].exportPenalty||0,D=qs(M),O=M.getLegalExports(e);for(let N of O)rt[N]||i[N]||(D&&(u[N]=!0),I===0&&(a[N]=!0),P[N]=P[N]||[],P[N].push(E),P[N].length>1&&(!s[N]&&D&&(o[N]=!0),s[N]=!0))}for(let E in P)o[E]||(i[E]=P[E])}for(let x of r)f.hasOwnProperty(x)||d(x);function d(x){f[x]=f[x]||{};let P=f[x],E;P.id=x,P.index=m,P.lowlink=m,g.push(P),P.instack=!0,m++;let M=t[x].getDependencies();for(let I of M){if(!i.hasOwnProperty(I))continue;let D=i[I];for(let O of D)f.hasOwnProperty(O)?(E=f[O],E.instack&&(P.lowlink=Math.min(P.lowlink,E.index))):(d(O),E=f[O],P.lowlink=Math.min(P.lowlink,E.lowlink))}if(P.lowlink===P.index)if(E=g.pop(),E.instack=!1,E===P)h(P);else{let I=[E];for(;E=g.pop(),E.instack=!1,I.push(E),E!==P;);b(I)}}function h(x){y.push(x.id);let P=t[x.id];P instanceof In&&P._expression.getDependencies().indexOf(P._symbol)!==-1&&(l[x.id]={[x.id]:P},p.add(P._symbol))}function b(x){let P=[],E=!0,M={},I=new Set;for(let D=x.length-1;D>=0;D--){let O=x[D],N=t[O.id],A=N.getLegalExports(e);Array.prototype.push.apply(P,A),P.push(A[0]),I.add(O.id),y.push(O.id),N instanceof In?M[O.id]=N:E=!1}if(P=Sp(P),P.sort(),E){for(let D of[...I])l[D]=M;for(let D of P)p.add(D)}for(let D of P)c[D]=P}return{resolved:y,globallyDefined:a,tableDefined:u,multiplyDefined:s,multiplyDefinedByTables:o,cyclicallyDefined:c,recursiveFunctionGroups:l,recursiveFunctionSymbols:p}}var jz=100;function xh(e){for(var t=[],r=0;r<e;r++)t[r]={x:[],y:[],intersects:[]};return t}function Jz(e,t,r,n){return r===1&&n===1||r===2&&n===2?function(i){return t(i)-e(i)}:r===1&&n===2||r===2&&n===1?function(i){return i-t(e(i))}:!1}function oA(e,t){t instanceof v.SolvedEquation?t=t._expression:t instanceof v.OptimizedRegression&&(t=t.model);var r=[],n=[];return t instanceof v.DoubleInequality?v.List.eachArgs(t._expressions,function(i){r.push(i[0].getCompiledFunction()),n.push(i[0].isConstant&&i[1].isNaN()),r.push(i[1].getCompiledFunction()),n.push(i[1].isConstant&&i[1].isNaN())}):v.List.wrap(t).eachElement(function(i){r.push(i.getCompiledFunction()),n.push(i.isConstant&&i.isNaN())}),{functions:r,skipIntersecting:n}}function Qz(e,t){var r=[];for(var n in e)if(e.hasOwnProperty(n)&&String(n)!==String(t)&&e[n].shouldIntersect()){var i=e[n],s=oA(i.policy,i.concreteTree);r.push({id:n,graphMode:i.getGraphMode(),functions:s.functions,skipIntersecting:s.skipIntersecting})}return r}function Kz(e,t){e.intersects=Array(e.x.length);for(var r=0;r<e.x.length;r++)e.intersects[r]=t}function ek(e,t){if(t===1){var r=e.y;e.y=e.x,e.x=r}}function tk(e,t){Array.prototype.push.apply(e.x,t.x),Array.prototype.push.apply(e.y,t.y),e.intersects&&t.intersects&&Array.prototype.push.apply(e.intersects,t.intersects)}function rk(e,t,r){var n=c0(e,t),i=n.poi.zeros,s=n.poi.extrema,o=[],a=0,u=0;for(a=0;a<i.x.length;a++){for(;u<s.x.length&&s.x[u]<i.x[a];u++)wi(s.y[u],0)&&o.push(s.x[u]);o.push(i.x[a])}for(;u<s.x.length;u++)wi(s.y[u],0)&&o.push(s.x[u]);return{x:o,y:o.map(r)}}function aA(e,t,r){var n=e[r],i=n.getGraphInfo(),s=n.getGraphMode(),o,a,u;try{o=oA(n.policy,n.concreteTree),a=xh(o.functions.length),u=Qz(e,r)}catch(x){return xh(0)}if(!u)return a;for(var c=0,l=0;l<u.length;l++)for(var p=u[l],f=0;f<o.functions.length;f++)if(!o.skipIntersecting[f]){for(var m=o.functions[f].fn,g=yp(t,i,m),y=0;y<p.functions.length;y++)if(!u[l].skipIntersecting[y]){var d=p.functions[y].fn,h=Jz(m,d,s,p.graphMode);if(h){var b;try{b=rk(h,g,m)}catch(x){return xh(0)}if(c+=b.x.length,c>jz)return xh(o.functions.length);Kz(b,p.id),ek(b,s),tk(a[f],b)}}}return a}function nk(e){if(e.length<2)return\"text\";let t=e.split(\"`\").length-1;return t<2?\"text\":t===2&&e[0]===\"`\"&&e[e.length-1]===\"`\"?\"latex\":\"mixed\"}function ik(e){if(e.length===0)return[\"\"];let t=[],r=e.split(/(`)/),n=!1,i=\"\";for(let s=0;s<r.length;s++){let o=r[s];o.length&&(o===\"`\"?(i+=\"`\",n=!n,n||(t.push(i),i=\"\")):(i+=o,n||(t.push(i),i=\"\")))}return i.length&&t.push(i),t}function tM(e){return ik(e).map(sk)}function sk(e){let r=\"\\\\$({\"+[\"[a-zA-Z][0-9]*\",\"[a-zA-Z]_[a-zA-Z0-9]+\",\"[a-zA-Z]_\\\\{[a-zA-Z0-9]+\\\\}\",\"\\\\\\\\[a-zA-Z]+\",\"\\\\\\\\[a-zA-Z]+_{[a-zA-Z0-9]+}\",\"\\\\\\\\[a-zA-Z]+_[a-zA-Z0-9]+\"].join(\"})|\\\\$({\")+\"})\",n=new RegExp(r,\"g\"),i=[],s=0,o=0,a;for(;a=n.exec(e);){o=a.index,o>s&&i.push(e.substr(s,o-s));let u=a[0],c=u.replace(/[{}\\$]/g,\"\").replace(/^([a-zA-Z])([0-9]+)$/,\"$1_$2\");i.push({symbol:c,str:u}),s=a.index+u.length}return s<e.length&&i.push(e.substr(s)),{raw:e,parts:i}}function uA(e,t){return t?\"{\"+zh(e,{bigCutoff:1e7,digits:8})+\"}\":Gh(e,{bigCutoff:1e7,digits:8})}function rM(e,t,r,n){return e.map(i=>ok(i,t,r,n)).join(\"\")}function ok(e,t,r,n){let i=[],s=nk(e.raw)===\"latex\";for(let o of e.parts)if(typeof o==\"string\")i.push(o);else{let a=new v.Identifier(o.symbol).tryGetConcreteTree(t,r);if(a.valueType===T&&a.getDependencies().length===0){let u=a.asValue();if(typeof u==\"number\"){i.push(uA(u,s));continue}}else if(a.valueType===le&&n<a.length&&a.getDependencies().length===0){let u=a.elementAt(n).asValue();if(typeof u==\"number\"){i.push(uA(u,s));continue}}s?i.push(\"{?}\"):i.push(\"?\")}return i.join(\"\")}function cA(){let e={},t={},r={},n=[];for(let i in this.statements){if(!this.statements.hasOwnProperty(i))continue;let s=this.statements[i];if(!(s.type===\"Construction\"&&!this.policy.isGeometryEnabled())&&s.type!==\"Ticker\")switch(s.type){case\"Error\":break;case\"Regression\":{r[i]=[],n.push(i);break}default:{let o=s.getLegalExports(this.policy);if(o){for(let u of o)s.exportPenalty!==void 0&&s.exportPenalty>0?t[u]=i:e[u]=i;let a=[];for(let u of s.getDependencies())a.push(u);r[i]=Lh(a,s.getDummyDependencies(),o)}break}}}for(let i of n){let s=this.statements[i],o=Bo(s.userData.residualVariable);o&&(t[o]=i);let a=s.getDependencies().slice(),u={},c;for(;c=a.pop();){if(u[c])continue;u[c]=!0;let l=e[c]||t[c];if(l){a.push(...r[l]),r[i].push(c);continue}t[c]=i}}return{exportMap:e,weakExportMap:t,dependencyMap:r}}var yd=class{constructor(){this.data={}}getChildIntersections(t){return this.data[t]||{count:0}}addListParent(t,r,n){if(Ep(n.valueType,[C,xt]),r!==void 0)n.valueType===xt?this.addPoint(t,r,n.value[r]):this.addPoint(t,r,n.value);else{Ep(n.valueType,[xt]);for(let i=0;i<n.value.length;i++)this.addPoint(t,i,n.value[i])}}addPrimitiveParent(t,r){if(Ep(r.valueType,[C,xt]),r.valueType===C)this.addPoint(t,0,r.value);else for(let n=0;n<r.value.length;n++)this.addPoint(t,0,r.value[n])}addPoint(t,r,n){var s;let i=this.data[t]||{count:0};this.data[t]||(this.data[t]=i),i[r]||(i[r]=[]),(s=i[r])==null||s.push(n),i.count++}};var gd=class{constructor(t){this.singleExpression=t.singleExpression}isGeometryEnabled(){return!1}is3dProduct(){return!1}is3dPolicy(){return!1}isBeta3d(){return!1}areAllScalesLinear(){return!0}assignmentForbidden(t){return this.substitutionForbidden(t)}substitutionForbidden(t){return t.slice(0,3)!==\"ans\"}isValidSlider(t){return!1}sliderVariables(){return[]}graphingEnabled(){return!1}ansEnabled(){return!this.singleExpression}dimensionVarsEnabled(){return!1}disabledFeatures(){return[\"Sum\",\"Product\",\"Integral\",\"List\",\"Derivative\",\"Piecewise\",\"Exponent\",\"PercentOf\",\"Substitution\"]}};var hd=class{constructor(t){this.singleExpression=t.singleExpression}isGeometryEnabled(){return!1}is3dProduct(){return!1}is3dPolicy(){return!1}isBeta3d(){return!1}areAllScalesLinear(){return!0}assignmentForbidden(t){return this.substitutionForbidden(t)}substitutionForbidden(t){return this.singleExpression?t.slice(0,3)!==\"ans\":t.slice(0,3)===\"tmp\"}isValidSlider(t){return!1}sliderVariables(){return[]}graphingEnabled(){return!1}ansEnabled(){return!this.singleExpression}dimensionVarsEnabled(){return!1}disabledFeatures(){return this.singleExpression?[\"Sum\",\"Product\",\"Integral\",\"Derivative\",\"Piecewise\",\"Substitution\",\"PercentOf\"]:[\"Sum\",\"Product\",\"Integral\",\"Derivative\",\"Piecewise\",\"Substitution\"]}};function lA(e,t,r,n){let i={};for(let s in n)i[n[s]._symbol]=n[s];try{let s=new nM(i),o=lk(s),a={},u={loopStructure:o,definitions:a,baseCases:s.getBaseCases()};for(let c in n){let l=n[c];fk(s,l,u)}for(let c of s.getBaseCaseExports()){let l=c.tryGetConcreteTree(e,t);for(let p of c.getLegalExports(e))delete t[p];c.exportTo(e,l,t)}for(let c in n){let l=n[c],p=l._symbol,f=a[p];f.userData=l.userData,f.metaData=l.metaData,f instanceof R?r[c]=new U(e,t,l,f):r[c]=f.analyze(e,t,r),r[c].exportTo(e,t)}}catch(s){if(!(s instanceof R))throw s;for(let o in n)r[o]=new U(e,t,n[o],s),r[o].exportTo(e,t)}return!0}var nM=class{constructor(t){this.referencesFrom={};this.referencesTo={};this.baseCases={};this.baseCaseExports=[];this.analyzedFunctions={};this.recursiveFunctionGroup=t;for(let r in t)this.referencesFrom[r]=[],this.referencesTo[r]=[],this.baseCases[r]=[];if(this.analyzeRecursiveReferences(),!!this.hasRecursiveReferences())for(let r in this.recursiveFunctionGroup)this.analyzeRecursiveFunctionDefinition(this.recursiveFunctionGroup[r])}analyzeRecursiveReferences(){for(let t in this.recursiveFunctionGroup)pk(this,this.recursiveFunctionGroup[t],r=>this.addReference(t,r));if(this.hasRecursiveReferences())e:for(let t of this.getAllReferences()){if(t.type!==\"iteration-compatible\")break;for(let r=0;r<t.argSymbols.length;r++){let n=t.argSymbols[r];if(this.recursiveFunctionGroup[t.from]._argSymbols.indexOf(n)!==r){this.recursiveParameterIndex=void 0;break e}if(t.argOffsets[r]!==0){if(this.recursiveParameterIndex!==void 0&&r!==this.recursiveParameterIndex){this.recursiveParameterIndex=void 0;break e}this.recursiveParameterIndex=r}}}}analyzeRecursiveFunctionDefinition(t){let r;for(let o of t.getExternalBaseCases())this.addBaseCase(o);if(t._expression instanceof dn){r=t._expression;do{let o=r.args[0],a=r.args[1];if(this.recursiveParameterIndex!==void 0&&o instanceof Ti[\"=\"]){let u=t._argSymbols[this.recursiveParameterIndex],c=o.args.findIndex(m=>m instanceof Fe&&m._symbol===u);if(c===-1)break;let l=o.args[1-c];if(!(l instanceof jt))break;let p=l.asValue(),f=new Ts(t._symbol,{valid:!0,argIndex:this.recursiveParameterIndex,argValue:p},a,a);this.baseCaseExports.push(f),this.addBaseCase(f)}else break;r=r.args[2]}while(r instanceof dn)}else if(t._expression instanceof Uo){let o=[];for(let a of t._expression._assignments){let u=Ts.fromEquation(this.recursiveFunctionGroup,a);u&&t._symbol===u._symbol?(this.baseCaseExports.push(u),this.addBaseCase(u)):o.push(a)}o.length>0?r=new Uo(t._expression._body,o):r=t._expression._body}else r=t._expression;let n=this.getReferencesTo(t._symbol),i=1/0,s=-1/0;if(this.recursiveParameterIndex!==void 0)for(let o of n){if(o.type!==\"iteration-compatible\")break;let a=o.argOffsets[this.recursiveParameterIndex];a<i&&(i=a),a>s&&(s=a)}this.analyzedFunctions[t._symbol]={recursiveExpression:r,maxOffset:isFinite(s)?s:void 0}}addReference(t,r){this.referencesFrom[t].push(r),this.referencesTo[r.to].push(r)}hasRecursiveReferences(){for(let t in this.referencesFrom)if(this.referencesFrom[t].length>0)return!0;return!1}getReferencesFrom(t){return this.referencesFrom[t]}getReferencesTo(t){return this.referencesTo[t]}getAllReferences(){let t=[];for(let r in this.referencesFrom)t.push(...this.referencesFrom[r]);return t}addBaseCase(t){this.baseCases[t._symbol].push(t)}getBaseCasesForFunction(t){return this.baseCases[t]}getBaseCases(){return this.baseCases}getBaseCaseExports(){return this.baseCaseExports}getFunctionAnalysis(t){return this.analyzedFunctions[t]}};function bd(e,t){if(t instanceof lr&&t._symbol in e.recursiveFunctionGroup)return!0;if(t instanceof dn){if(bd(e,t.args[0]))return!0;let n=bd(e,t.args[1]),i=bd(e,t.args[2]);return n&&i}for(let r of t.args)if(bd(e,r))return!0;return!1}function lk(e){if(!e.hasRecursiveReferences())return;let t=e.recursiveParameterIndex;if(t===void 0)return;for(let a in e.recursiveFunctionGroup){let u=e.getFunctionAnalysis(a);if(!u||!bd(e,u.recursiveExpression))return}let r={};for(let a in e.recursiveFunctionGroup){let u;for(let c of e.getBaseCasesForFunction(a)){if(!c.specifiedArg.valid)continue;if(c.specifiedArg.argIndex!==t)return;let l=c.specifiedArg.argValue;if(u||(u={min:l,max:l}),l<u.min-1||l>u.max+1)return;l<u.min&&(u.min=l),l>u.max&&(u.max=l)}r[a]=u}let n=dk(e),i={};for(let a=0;a<n.length;a++){let u=n[a];for(let c of e.getReferencesFrom(u)){if(c.type!==\"iteration-compatible\")return;let l=c.argOffsets[t];if(l===0&&n.indexOf(c.to)<a)continue;let p=c.to;i[p]||(i[p]={min:l,max:l}),l<i[p].min&&(i[p].min=l),l>i[p].max&&(i[p].max=l)}}let s,o;for(let a in i){let u=i[a],c=r[a];if(c){let l=c.min+u.max;(s===void 0||l>s)&&(s=l);let p=c.max+u.min;(o===void 0||p<o)&&(o=p)}else return}if(!(s===void 0||o!==void 0&&s>o))return{start:s,order:n,previousValuesNeeded:i,recursiveParameterIndex:t}}function pk(e,t,r){let n=(i,s)=>{let o=pA(e,t,i,s);o&&r(o),s.args.forEach(a=>n(s,a))};n(t,t._expression)}function fk(e,t,r){let n=e.getFunctionAnalysis(t._symbol);if(!n){r.definitions[t._symbol]=t;return}let i=(o,a)=>{let u=pA(e,t,o,a);return u?new Bi(u.to,e.recursiveParameterIndex!==void 0&&u.type===\"iteration-compatible\"?{offset:u.argOffsets[e.recursiveParameterIndex]}:void 0,a.args.map(c=>i(a,c))):a.copyWithArgs(a.args.map(c=>i(a,c)))};n.recursiveExpression=i(t,n.recursiveExpression);let s=new In(new Fe(t._symbol),t._argSymbols.map(o=>new Fe(o)),n.recursiveExpression,r);s.setExternalBaseCases(t.getExternalBaseCases()),r.definitions[t._symbol]=s}function pA(e,t,r,n){if(!(n instanceof lr)||r instanceof Qa&&n===r._lhs||!e.recursiveFunctionGroup[n._symbol])return;let s=[],o=[];for(let a=0;a<n.args.length;a++){let u=n.args[a],c,l;if((u instanceof Tn||u instanceof lu)&&u.args[0]instanceof Fe&&u.args[1]instanceof jt)l=u.args[0]._symbol,c=(u instanceof Tn?1:-1)*u.args[1].asValue();else if(u instanceof Fe)l=u._symbol,c=0;else return{type:\"arbitrary\",from:t._symbol,to:n._symbol};s.push(c),o.push(l)}return{type:\"iteration-compatible\",from:t._symbol,to:n._symbol,argOffsets:s,argSymbols:o}}function dk(e){let t=e.recursiveParameterIndex;if(t===void 0)throw ee(\"Programming error: no recursive parameter\");let r=Object.keys(e.recursiveFunctionGroup),n=new Map,i=new Map,s=u=>{let c=new Set;for(let l of e.getReferencesTo(u))l.type===\"iteration-compatible\"&&l.argOffsets[t]===0&&c.add(l.from);return[...c]};r.forEach(u=>{let c=s(u);n.set(u,c);for(let l of c)i.set(l,(i.get(l)||0)+1);i.has(u)||i.set(u,0)});let o=[];i.forEach((u,c)=>{u===0&&o.push(c)});let a=[];for(;o.length>0;){let u=o.shift();a.push(u),(n.get(u)||[]).forEach(l=>{let p=l,f=i.get(p)-1;i.set(p,f),f===0&&o.push(p)})}if(a.length!==r.length)throw Jr(\"Cyclic dependency\");return a}var za=typeof performance!=\"undefined\"?()=>performance.now():()=>Date.now(),{Constant:io,Seed:dA,FunctionCall:xA,Image:xk,Slider:Pk,Table:Tk,TableColumn:Ik,Construction:Ek}=v;function Mk(e,t,r,n){switch(e){case\"fourFunction\":return new gd({singleExpression:!1});case\"singleExpressionFourFunction\":return new gd({singleExpression:!0});case\"scientific\":return new hd({singleExpression:!1});case\"singleExpressionScientific\":return new hd({singleExpression:!0});case\"graphing\":return new gp({enableGeometry:!1,enable3d:t,beta3d:r,scales:n});case\"geometry\":return new gp({enableGeometry:!0,enable3d:!1,beta3d:!1,scales:n});case\"graphing_3d\":return new eh(r)}}var vk={fourFunction:Ud,singleExpressionFourFunction:Ud,scientific:Yh,singleExpressionScientific:Xh,graphing:Cp,graphing_3d:Cp,geometry:Cp},_o=\"**geo_construction_statement_id**\";function Li(e,t){var r=Hs(e,t);return r.isError||r instanceof v.Expression?r:_p()}function Dk(e){let t=e.rawTree.userData,r=e.rawTree.metaData;return!!(t.cdf&&t.cdf.show&&r.distributionSpec)}function Sk(e){let t=e.evaluationState.expression_type,r=e.rawTree.userData;return!r.clickableInfo||!r.clickableInfo.enabled?!1:jf(e.rawTree)?!0:e.getGraphMode()===4?!1:vE(t)}function sr(e,t){let r=\"id\"+e;for(let[n,i]of t||[])r+=\"::\"+n+i;return r}var Ok=new io(Re(0,1)),Rk=new io(Re(1,1)),Ck=new io(NaN);function Wi(e,t){return e?e===\"0\"?Ok:e===\"1\"?Rk:Li(e,t):Ck}function ku(e,t){if(e)return Li(e,t)}function Nk(e){return e.slice(0,3)!==\"ans\"}function Ak(e){return e.slice(0,6)!==\"idref_\"}function mA(e,t,r){let{multiplyDefined:n,multiplyDefinedByTables:i,cyclicallyDefined:s,recursiveFunctionSymbols:o}=e;for(let a in s){if(!s.hasOwnProperty(a)||r&&o.has(a))continue;let u=e.tableDefined[a]&&!e.globallyDefined[a],c=s[a].filter(Nk).filter(Ak);t[a]=u?Lx(c):ym(c)}for(let a in n)n.hasOwnProperty(a)&&(t[a]=i[a]?_x(a):ll(a))}function Pd(e,t,r){for(let n of r)e[n]||(e[n]=[]),e[n].push(t)}function yA(e,t,r){if(r.extraDepNodes)for(let n of r.extraDepNodes)n&&Pd(e,t,n.getDependencies());r.clickHandler&&Pd(e,t,r.clickHandler.getDependencies())}function _k(e,t,r){let n=e.evaluationState,i=e.rawTree,s=i.metaData.cdfMin,o=i.metaData.cdfMax,a={},u=i.type===\"Assignment\"?i._expression:i,c=u&&u.metaData&&u.metaData.distributionSpec,l=ua(t,r,s,a,-1/0),p=ua(t,r,o,a,1/0),f=!0,m=!0;if(isNaN(l)&&(f=!1,l=NaN),isNaN(p)&&(m=!1,p=NaN),f?m?l>p&&(f=!1,m=!1,n.error=Yx().getError()):n.error=$x().getError():n.error=qx().getError(),f&&m){let d=new xA(\"cdf\",[u,new io(l),new io(p)]);n.cdf_evaluation=+d.tryGetConcreteTree(t,r).asValue()}let g=-1/0,y=1/0;if(c&&(c.discrete&&(g=0),c.symbol===\"binomialdist\"&&u.args&&u.args[0])){let d=+u.args[0].asValue();isFinite(d)&&(y=d)}i.metaData.evaluatedCDFMin=l,i.metaData.evaluatedCDFMax=p,n.cdf_min_valid=f,n.cdf_max_valid=m,n.cdf_min_default=g,n.cdf_max_default=y,n.is_single_identifier=!1,Bu(n,t,a)}function Lk(e,t,r,n,i){let s={},o=!0,a=NaN,u,c=!1;if(r){let l=r.tryGetConcreteTree(e,t);u=l.getDependencies().length===0?l.asValue():NaN,c=Array.isArray(u),a=c?u:+u;for(let p of l.getDependencies())s[p]=!0}if(c){for(let l of a)if(!isFinite(+l)){o=!1,a=NaN;break}}else isFinite(+a)?i!==void 0&&a>i&&(a=i):(o=!1,a=NaN);return r||(o=!0,n!==void 0&&(a=n)),{value:a,valid:o,missingVarsMap:s}}var xd={lineWidth:{parseNode:\"lineWidth\",valueOutputProp:\"computedLineWidth\",formulaOutputProp:\"\",validOutputProp:\"line_width_valid\",default:(e,t,r,n)=>{let i=r.isGeometryEnabled(),s=r.is3dPolicy(),o=n!==void 0&&ce(n,Be);return i&&o?1.5:s?1:2.5},transform:void 0,shouldEvaluate:void 0,seed:\"lw\"},resolution:{parseNode:\"resolution\",valueOutputProp:\"computedResolution\",formulaOutputProp:\"\",validOutputProp:\"resolution_valid\",default:()=>{},transform:void 0,shouldEvaluate:void 0,seed:\"re\"},lineOpacity:{parseNode:\"lineOpacity\",valueOutputProp:\"computedLineOpacity\",formulaOutputProp:\"\",validOutputProp:\"line_opacity_valid\",default:()=>1,transform:void 0,shouldEvaluate:void 0,seed:\"lo\"},pointOpacity:{parseNode:\"pointOpacity\",valueOutputProp:\"computedPointOpacity\",formulaOutputProp:\"\",validOutputProp:\"point_opacity_valid\",default:()=>1,transform:void 0,shouldEvaluate:void 0,seed:\"po\"},pointSize:{parseNode:\"pointSize\",valueOutputProp:\"computedPointSize\",formulaOutputProp:\"\",validOutputProp:\"point_size_valid\",default:(e,t,r)=>r.is3dProduct()?3:8,shouldEvaluate:void 0,transform:void 0,seed:\"ps\"},movablePointSize:{parseNode:\"movablePointSize\",valueOutputProp:\"computedMovablePointSize\",formulaOutputProp:\"\",validOutputProp:\"movable_point_size_valid\",default:()=>8,shouldEvaluate:void 0,transform:void 0,seed:\"ps\"},fillOpacity:{parseNode:\"fillOpacity\",valueOutputProp:\"computedFillOpacity\",formulaOutputProp:\"\",validOutputProp:\"fill_opacity_valid\",default:(e,t,r,n)=>r.is3dProduct()?1:.4,transform:void 0,shouldEvaluate:e=>{if(!e)return!1;let{expression_type:t,is_inequality:r}=e.evaluationState;return!!(t===\"POLYGON\"||t===\"PARAMETRIC\"||t===\"CURVE3D_xyz_t\"||t===\"SURFACE\"||t===\"SPHERE3D\"||t===\"SURFACE_AMBIGUOUS\"||t===\"SURFACE_CONSTANT_AMBIGUOUS\"||t===\"IMPLICIT_SURFACE\"||t===\"IMPLICIT_SURFACE_AMBIGUOUS\"||t===\"SURFACE_xyz_uv\"||t===\"SURFACE_z_r\\u03B8\"||t===\"SURFACE_r_\\u03B8z\"||t===\"SURFACE_r_\\u03B8\\u03C6\"||t===\"SURFACE_r_\\u03B8z_AMBIGUOUS\"||t===\"TRIANGLE3D\"||r)},seed:\"fo\"},labelSize:{parseNode:\"labelSize\",valueOutputProp:\"computedLabelSize\",formulaOutputProp:\"\",validOutputProp:\"label_size_valid\",transform:void 0,default:()=>1,shouldEvaluate:void 0,seed:\"ls\"},labelAngle:{parseNode:\"labelAngle\",valueOutputProp:\"computedLabelAngle\",formulaOutputProp:\"label_angle_value\",validOutputProp:\"label_angle_valid\",default:()=>0,transform:e=>`-\\\\trigAngleMultiplier*(${e})`,shouldEvaluate:void 0,seed:\"la\"}};function gA(e,t,r,n,i,s,o){let a=xd[s],u;e&&(u=e.tryGetConcreteTree(n,i));let c=a.default&&a.default(e,u,n,o),l=[\"lineWidth\",\"pointSize\",\"movablePointSize\"].indexOf(s)>=0,p=Lk(n,i,r[a.parseNode],c,l?1e4:void 0);r[a.valueOutputProp]=p.value,a.formulaOutputProp&&(t[a.formulaOutputProp]=p.value),t[a.validOutputProp]=p.valid,Bu(t,n,p.missingVarsMap)}function wk(e,t,r,n){let i,s,o;if(qs(e.rawTree)&&e.evaluationState.column_data&&e.rawTree.columns)for(let a=0;a<e.evaluationState.column_data.length;a++){i=e.evaluationState.column_data[a];let u=e.rawTree.columns[a];Eo(u)||(s=u.header.metaData,o=s[n],gA(o,i,s,t,r,n,e.concreteTree.valueType))}else i=e.evaluationState,s=e.rawTree.metaData,o=s[n],gA(o,i,s,t,r,n,e.concreteTree.valueType)}function hA(e){return xc(e[0],e[1],e[2]).formatHex()}function bA(e,t,r,n,i){let s;if(e){let o=e.tryGetConcreteTree(n,i),a=o.getDependencies().length>0?void 0:o.asValue(),{valueType:u}=o;if(s=!!(a&&(u===qt||u===Zr)),s){let c=o&&o.valueType===qt?hA(a):a.map(hA);t.colorLatexValue=c,r.color_latex_value=c}else delete t.colorLatexValue,delete r.color_latex_value}else s=!0;r.color_latex_valid=s}function Fk(e,t,r){let n,i,s;if(qs(e.rawTree)&&e.evaluationState.column_data&&e.rawTree.columns)for(let o=0;o<e.evaluationState.column_data.length;o++){n=e.evaluationState.column_data[o];let a=e.rawTree.columns[o];Eo(a)||(i=a.header.metaData,s=i.colorLatex,bA(s,i,n,t,r))}else n=e.evaluationState,i=e.rawTree.metaData,s=i.colorLatex,bA(s,i,n,t,r)}function Vk(e){if(e.concreteTree.valueType===qt&&e.concreteTree.getDependencies().length>0){let t=e.concreteTree._chunk;try{e.evaluationState.shader=Jo(t,0)}catch(r){e.evaluationState.error=r instanceof v.Error?r.getError():ee(r).getError()}}}function Bk(e,t,r){let n=e.evaluationState,i=e.rawTree,s={},o=i.metaData.clickHandler;if(!o)return;let a=o.tryGetConcreteTree(t,r);!a.isError&&a.valueType!==Ke&&(a=zp(ne(a.valueType)));for(let c of a.getDependencies())t.validActionVariable(c)||(s[c]=!0);let u=Object.keys(s);u.length>0&&(a=ar(u).setDependencies(a.getDependencies())),a.isError&&!_0(t,a)?n.click_handler={status:\"error\",error:a.getError()}:a.isEmptyAction?n.click_handler={status:\"empty\"}:n.click_handler={status:\"maybe-valid\"},Bu(n,t,s)}function Gk(e,t,r){let n,i=e.evaluationState,s=e.rawTree,o,a;i.internal_domain_dependency?(n=i.internal_domain_dependency,n===\"u\"?(o=s.metaData.parametricDomain3DuMin,a=s.metaData.parametricDomain3DuMax):n===\"v\"?(o=s.metaData.parametricDomain3DvMin,a=s.metaData.parametricDomain3DvMax):(o=s.metaData.parametricDomainMin,a=s.metaData.parametricDomainMax)):i.expression_type===\"POLAR\"||iC(i.expression_type)?(o=s.metaData.polarDomainMin,a=s.metaData.polarDomainMax,n=\"theta\"):(o=s.metaData.parametricDomainMin,a=s.metaData.parametricDomainMax,n=\"t\");let u={},c=!!(o||a),l=ua(t,r,o,u,0),p=NaN;a?p=ua(t,r,a,u,NaN):i.expression_type===\"PARAMETRIC\"||i.expression_type===\"CURVE3D_xyz_t\"?p=1:i.expression_type===\"POLAR\"?p=Math.PI*12/+r.trigAngleMultiplier.asValue():(i.expression_type===\"SURFACE_r_\\u03B8z\"||i.expression_type===\"SURFACE_r_\\u03B8z_AMBIGUOUS\"||i.expression_type===\"SLICE_r\\u03B8z_at_z\")&&(p=Math.PI*2/+r.trigAngleMultiplier.asValue());let f=oM(l,p,i);({min:l,max:p}=f),s.metaData.evaluatedDomainMin=l,s.metaData.evaluatedDomainMax=p,(i.expression_type===\"POLAR\"||i.expression_type===\"SURFACE_r_\\u03B8z\"||i.expression_type===\"SURFACE_r_\\u03B8z_AMBIGUOUS\"||i.expression_type===\"SLICE_r\\u03B8z_at_z\")&&(s.metaData.isExplicitDomain=c),i.domains=[{variable:n,minNumber:l,maxNumber:p,minValid:f.minValid,maxValid:f.maxValid}],i.expression_type===\"PARAMETRIC\"&&delete u.t,i.expression_type===\"CURVE3D_xyz_t\"&&(delete u.t,delete u.u,delete u.v),Bu(i,t,u)}function zk(e,t,r){let n=e.evaluationState,i=n.expression_type,s=e.rawTree,o,a,u,c,l={},p=0,f=1,m=0,g=1;var y,d;rC(i)?(y=\"theta\",d=\"phi\",o=s.metaData.polarDomainMin,a=s.metaData.polarDomainMax,u=s.metaData.parametricDomain3DphiMin,c=s.metaData.parametricDomain3DphiMax,f=2*Math.PI/+r.trigAngleMultiplier.asValue(),g=Math.PI/+r.trigAngleMultiplier.asValue()):nC(i)?(y=\"r\",d=\"theta\",o=s.metaData.parametricDomain3DrMin,a=s.metaData.parametricDomain3DrMax,u=s.metaData.polarDomainMin,c=s.metaData.polarDomainMax,f=mn.xmax,g=2*Math.PI/+r.trigAngleMultiplier.asValue()):(y=\"u\",d=\"v\",o=s.metaData.parametricDomain3DuMin,a=s.metaData.parametricDomain3DuMax,u=s.metaData.parametricDomain3DvMin,c=s.metaData.parametricDomain3DvMax),p=ua(t,r,o,l,p),f=ua(t,r,a,l,f),m=ua(t,r,u,l,m),g=ua(t,r,c,l,g);let h=oM(p,f,n);({min:p,max:f}=h);let b=oM(m,g,n);({min:m,max:g}=b),s.metaData.evaluatedDomain3DMin1=p,s.metaData.evaluatedDomain3DMax1=f,s.metaData.evaluatedDomain3DMin2=m,s.metaData.evaluatedDomain3DMax2=g,n.domains=[{variable:y,minNumber:p,minValid:h.minValid,maxNumber:f,maxValid:h.maxValid},{variable:d,minNumber:m,minValid:b.minValid,maxNumber:g,maxValid:b.maxValid}],(n.expression_type===\"SURFACE_xyz_uv\"||n.expression_type===\"SLICE_xyz_uv\")&&(delete l.u,delete l.v),Bu(n,t,l)}function ua(e,t,r,n,i){if(r){let s=r.tryGetConcreteTree(e,t);for(let o of s.getDependencies())n[o]=!0;return s.isConstant?+s.asValue():NaN}else return i}function oM(e,t,r){let n=!0,i=!0;return isFinite(e)||(n=!1,e=NaN),isFinite(t)||(i=!1,t=NaN),n?i?e>t&&(n=!1,i=!1,r.error=Ux().getError()):r.error=Hx().getError():r.error=kx().getError(),{min:e,max:t,minValid:n,maxValid:i}}function kk(e,t,r){let n=e.evaluationState,i=e.rawTree,s=i.metaData.vizAxisOffset,o=i.metaData.vizBreadth,a={},u=ua(t,r,s,a,1),c=ua(t,r,o,a,1),l=!0,p=!0;isFinite(u)||(l=!1,u=NaN),isFinite(c)||(p=!1,c=NaN),l?p||(n.error=Xb().getError()):n.error=Yb().getError(),i.metaData.evaluatedAxisOffset=u,i.metaData.evaluatedBreadth=c,n.viz_values={axisOffset:u,breadth:c},n.viz_valids={axisOffset:l,breadth:p},Bu(n,t,a)}function Hk(e){return e.globalRandomSeed||[]}function iM(e,t,r,n,i){let s={},o={},a=[],u=[];for(let c in n)n[c]&&(o[c]=!0,a.push(c));for(let c in i)i[c]&&(s[c]=!0,u.push(c));for(;a.length||u.length;){for(;a.length;){let c=a.pop(),l=t[c];if(l)for(let p of l.getLegalExports(e))s[p]||(s[p]=!0,u.push(p))}for(;u.length;){let c=u.pop(),l=r[c];if(l)for(let p of l)o[p]||(o[p]=!0,a.push(p))}}return{ids:o,symbols:s}}function sM(e,t,r){if(e.isError||e.getDependencies().length||e.valueType!==Ke)return;let n=e.asValue();if(n)for(let i in n.updateRules){t[i]=SE(n,i);let{value:s,valueType:o}=n.updateRules[i];r[i]=new v.Assignment(i,bt(o,s))}}var Ph=class{constructor(){this.childIntersections=new yd;this.getCLSymbolMap=cA;this.statements={},this.analysis={},this.currentStatus={},this.currentLabel={},this.unpublishedIds={},this.dimensions={width:0,height:0},this.intersectId=void 0,this.dirtyExportedSymbolRoots={},this.dirtyStatementRoots={},this.markedRegressionDirty=!1,this.use_degrees=!1,this.initialEvaluation=!1,this.globalEventCount=0,this.actions=!0,this.substitutions=!0,this.intervalComprehensions=!1,this.recursion=!1,this.setEvaluationMode(\"graphing\"),this.setProduct(\"graphing\"),this.setBeta3d(!1),this.setRestrictedFunctions(!1),this.setForceEnableGeometryFunctions(!1),this.setFunctionDefinition(!0),this.setReplaceRoundWithReciprocal(!1),this.setDistributions(!0),this.invalidate()}invalidate(){delete this.statements[_o];for(let r in this.statements)this.statements.hasOwnProperty(r)&&this.markAsDirtyRoot(r);this.currentStatus={},this.analysis={};let t=this.viewState?{xAxisScale:this.viewState.xAxisScale,yAxisScale:this.viewState.yAxisScale}:void 0;this.policy=Mk(this.evaluationMode,this.product===\"graphing-3d\",this.beta3d,t),this.parent_frame=vk[this.evaluationMode].getFrame({restrictedFunctions:this.restrictedFunctions,forceEnableGeometryFunctions:this.forceEnableGeometryFunctions,isGeometryCalculator:this.evaluationMode===\"geometry\",is3DCalculator:this.product===\"graphing-3d\",replaceRoundWithReciprocal:this.replaceRoundWithReciprocal,distributions:this.distributions,additionalFunctions:this.additionalFunctions,trigAngleMultiplier:new io(this.use_degrees?Math.PI/180:Re(1,1)),initialEvaluation:new io(this.initialEvaluation?1:0),globalEventCount:new io(0),globalRandomSeed:new dA(this.globalRandomSeedString||\"\"),width:this.policy.dimensionVarsEnabled()?new io(Re(this.dimensions.width,1)):Sm(\"width\"),height:this.policy.dimensionVarsEnabled()?new io(Re(this.dimensions.height,1)):Sm(\"height\")}),this.frame=Object.create(this.parent_frame),this.lastFrame=Object.create(this.parent_frame),this.regressionFrame=Object.create(this.parent_frame),this.lastClockTickTime=void 0}getAllActionUpdateSymbols(){var r;let t=new Set;for(let n in this.statements){let i=this.statements[n];i.getUpdateSymbols().forEach(o=>t.add(o)),i instanceof v.Ticker&&i.handler.getUpdateSymbols().forEach(o=>t.add(o));let s=this.analysis[n];(jf(i)||s&&s.getGraphMode()!==4&&vE(s.evaluationState.expression_type))&&((r=i.metaData.clickHandler)==null||r.getUpdateSymbols().forEach(o=>t.add(o)))}return[...new Set(t)]}processChangeSet(t){let r=za(),n={cacheWrites:0,cacheReads:0,cacheHits:0,cacheMisses:0};SR(n);let i={intersections:{},graphs:{}};t.isCompleteState&&(this.invalidate(),this.statements={},this.currentLabel={});let s=!!t.isCompleteState&&!t.isUndoRedoState;s!==this.initialEvaluation&&(this.initialEvaluation=s,this.parent_frame.initialEvaluation=new io(s?1:0)),t.hasOwnProperty(\"logInternalErrors\")&&jh(t.logInternalErrors),t.viewState&&this.setViewState(t.viewState),t.hasOwnProperty(\"degreeMode\")&&this.setDegreeMode(t.degreeMode),t.hasOwnProperty(\"globalRandomSeed\")&&this.setGlobalRandomSeed(t.globalRandomSeed),t.hasOwnProperty(\"evaluationMode\")&&this.setEvaluationMode(t.evaluationMode),t.hasOwnProperty(\"additionalFunctions\")&&this.setAdditionalFunctions(t.additionalFunctions),t.hasOwnProperty(\"restrictedFunctions\")&&this.setRestrictedFunctions(t.restrictedFunctions),t.hasOwnProperty(\"forceEnableGeometryFunctions\")&&this.setForceEnableGeometryFunctions(t.forceEnableGeometryFunctions),t.hasOwnProperty(\"distributions\")&&this.setDistributions(t.distributions),t.hasOwnProperty(\"functionDefinition\")&&this.setFunctionDefinition(t.functionDefinition),t.hasOwnProperty(\"replaceRoundWithReciprocal\")&&this.setReplaceRoundWithReciprocal(t.replaceRoundWithReciprocal),t.hasOwnProperty(\"pointsOfInterest\")&&this.setWorkerConfigProperty(\"pointsOfInterest\",t.pointsOfInterest),t.hasOwnProperty(\"plotSingleVariableImplicitEquations\")&&this.setWorkerConfigProperty(\"plotSingleVariableImplicitEquations\",t.plotSingleVariableImplicitEquations),t.hasOwnProperty(\"plotImplicits\")&&this.setWorkerConfigProperty(\"plotImplicits\",t.plotImplicits),t.hasOwnProperty(\"plotInequalities\")&&this.setWorkerConfigProperty(\"plotInequalities\",t.plotInequalities),t.hasOwnProperty(\"sliders\")&&this.setWorkerConfigProperty(\"sliders\",t.sliders),t.hasOwnProperty(\"actions\")&&this.setActions(!!t.actions),t.hasOwnProperty(\"substitutions\")&&this.setSubstitutions(!!t.substitutions),t.hasOwnProperty(\"intervalComprehensions\")&&this.setIntervalComprehensions(!!t.intervalComprehensions),t.hasOwnProperty(\"recursion\")&&this.setRecursion(!!t.recursion);let o=t.recursionDepthLimit;o!==void 0&&o>0&&o<=10**6&&CT(o),t.hasOwnProperty(\"beta3d\")&&this.setBeta3d(!!t.beta3d),t.hasOwnProperty(\"product\")&&this.setProduct(t.product);let a;if(t.hasOwnProperty(\"selectedIds\")){let f=t.selectedIds||{};(this.intersectId===void 0||!f[this.intersectId])&&([a]=Object.keys(f),this.intersectId=a)}t.hasOwnProperty(\"dimensions\")&&this.setDimensions(t.dimensions);let u=za();this.processStatements(t,i);let c=za();n.processStatements=c-u,u=c,this.updateAnalysis(),c=za(),n.updateAnalysis=c-u,u=c,a!==void 0&&this._updateIntersections(a,i),c=za(),n.updateIntersections=c-u,u=c;let l=this._publishAllStatuses();c=za(),n.publishAllStatuses=c-u,u=c,this._computeAllLabels(),c=za(),n.computeAllLabels=c-u,u=c,this._computeAriaDescriptions(),c=za(),n.computeAriaDescriptions=c-u,u=c,this._graphAllChanged(i),c=za(),n.graphAllChanges=c-u;let p=this.processEvents(t.events);return this.unpublishedIds={},n.timeInWorker=c-r,{syncId:t.syncId,isCompleteState:t.isCompleteState,intersectionChanges:i.intersections,statusChanges:l,graphChanges:i.graphs,timingData:n,eventUpdates:p}}processStatements(t,r){if(t.removes)for(let n in t.removes){let i;if(!t.isCompleteState&&this.statements.hasOwnProperty(n)&&(i=this.statements[n].getAllIds()),this.removeStatement(n,r),!t.isCompleteState&&i)for(let s of i)r.graphs[s]=void 0}if(t.statements)for(let n in t.statements){let i=t.statements[n];i===null||this.addStatement(i,r)}}setViewState(t){if(Vo(t,this.viewState))return;let r=!!(this.viewState&&t.xAxisScale===this.viewState.xAxisScale&&t.yAxisScale===this.viewState.yAxisScale);if(this.viewState=t,r)for(let n in this.statements)this.statements.hasOwnProperty(n)&&(this.unpublishedIds[n]=!0);else this.invalidate()}getViewState(){return this.viewState}setDegreeMode(t){this.use_degrees=t,this.invalidate()}setDimensions(t){t!==void 0&&(this.dimensions=t,this.invalidate())}setGlobalRandomSeed(t){this.globalRandomSeedString=t,this.parent_frame.globalRandomSeed=new dA(t),this.dirtyExportedSymbolRoots.globalRandomSeed=!0}setEvaluationMode(t){this.evaluationMode=t,this.invalidate()}setProduct(t){this.product=t,this.invalidate()}setBeta3d(t){this.beta3d=t,this.invalidate()}setAdditionalFunctions(t){this.additionalFunctions=t,this.invalidate()}setRestrictedFunctions(t){this.restrictedFunctions=t,this.invalidate()}setForceEnableGeometryFunctions(t){this.forceEnableGeometryFunctions=t,this.invalidate()}setDistributions(t){this.distributions=t,this.invalidate()}setFunctionDefinition(t){this.functionDefinition=t,this.invalidate()}setReplaceRoundWithReciprocal(t){this.replaceRoundWithReciprocal=t,this.invalidate()}setActions(t){t!==this.actions&&(this.actions=t,this.invalidate())}setSubstitutions(t){t!==this.substitutions&&(this.substitutions=t,this.invalidate())}setIntervalComprehensions(t){t!==this.intervalComprehensions&&(this.intervalComprehensions=t,this.invalidate())}setRecursion(t){t!==this.recursion&&(this.recursion=t,this.invalidate())}setWorkerConfigProperty(t,r){r!==os[t]&&(os[t]=r,this.invalidate())}_publishAllStatuses(){let t={},r=this.currentStatus;this.currentStatus={};for(let n in this.unpublishedIds){if(!this.analysis.hasOwnProperty(n))continue;let i=this.analysis[n].evaluationState;Vo(i,r[n])||(t[n]=i),this.currentStatus[n]=i}return t}_computeAllLabels(){for(let t in this.currentLabel){let r=this.statements[t];if(!r)continue;let n=r.tryGetConcreteTree(this.policy,this.frame),i=1;(n.valueType===xt||n.valueType===xr||n.valueType===Or||n.valueType===mr||n.valueType===yr)&&(i=n.length);let s=[],o=this.currentLabel[t];if(bo(o))for(let a=0;a<i;a++)s.push(rM(o,this.policy,this.frame,a));Vo(s,r.computedLabels)||(r.computedLabels=s,this.unpublishedIds[t]=!0)}}_computeAriaDescriptions(){for(let t in this.analysis){let r=this.analysis[t],n=r.evaluationState,s=r.rawTree.userData,o;if(s.description?o=s.description:s.label&&(o=s.label),o){n.computed_description=[];let a=1;r.concreteTree.isList?a=r.concreteTree.length:n.dimensions&&n.dimensions.x&&Array.isArray(n.dimensions.x)&&(a=n.dimensions.x.length);for(let u=0;u<a;u++)n.computed_description.push(rM(tM(o),this.policy,this.frame,u))}}}_graphAllChanged(t){let r=this.getViewState(),n=!1;if(!(!r||!BC(r))){for(let i in this.unpublishedIds){if(!this.analysis.hasOwnProperty(i))continue;let s=this.analysis[i],o=s.evaluationState.expression_type,a=o===\"SINGLE_POINT\"||o===\"POINT_LIST\";if(qs(s.rawTree)){let u=s.graph(r,void 0),c=s.rawTree.getAllIds();for(let l of c)u[l]?this._notifyGraphComputed(l,u[l],t):this._notifyGraphRemoved(l,t)}else s.evaluationState.is_graphable&&(s.rawTree.userData.shouldGraph||s.rawTree.userData.showLabel&&a)?(this._notifyGraphComputed(i,s.graph(r,this.childIntersections.getChildIntersections(i)),t),this.intersectId===i&&(n=!0)):this._notifyGraphRemoved(i,t)}Pi(this.unpublishedIds).length&&this.intersectId!==void 0&&(this.unpublishedIds.hasOwnProperty(this.intersectId)||(n=!0)),n&&this._updateIntersections(this.intersectId,t)}}_notifyGraphRemoved(t,r){r.graphs[t]=void 0}_notifyGraphComputed(t,r,n){m1(r),n.graphs[t]=r}_updateIntersections(t,r){if(!this.viewState)return;if(!this.analysis[t]||!this.analysis[t].shouldIntersect()){r.intersections[t]=[];return}let n=aA(this.analysis,this.viewState,t);r.intersections[t]=n}getDisabledFeatures(){let t=this.policy.disabledFeatures();this.functionDefinition===!1&&(t=t.concat(\"FunctionDefinition\")),this.actions===!1&&(t=t.concat(\"UpdateRule\")),this.substitutions===!1&&(t=t.concat([\"Substitution\",\"ListComprehension\"]));let r=this.additionalFunctions||[];return t=t.filter(n=>!(n===\"Exponent\"&&r.indexOf(\"exponent\")!==-1||n===\"PercentOf\"&&r.indexOf(\"percent\")!==-1)),t}areFractionsDisallowed(){let{evaluationMode:t}=this;return t!==\"fourFunction\"&&t!==\"singleExpressionFourFunction\"?!1:!this.additionalFunctions||this.additionalFunctions.indexOf(\"fraction\")===-1}addStatement(t,r){if(!t)return;let n=t.id;this.markExportsDirty(n),this.markAsDirtyRoot(n);let i;if(t.type===\"statement\"){let c=t.latexSelection;i=c&&{input:t.latex,start:c.start,end:c.end}}let s={index:this.policy.ansEnabled()?t.index:void 0,disabledFeatures:this.getDisabledFeatures(),disallowFrac:this.areFractionsDisallowed(),allowIntervalComprehensions:!!this.intervalComprehensions,seedPrefix:sr(n),writeIntegral:this.evaluationMode===\"geometry\",selection:i,specializeDoubleInequalities:!this.policy.is3dProduct()},o={extraDepNodes:[]};switch(t.type){case\"table\":let c=[];this.statements.hasOwnProperty(n)&&(c=this.statements[n].getAllIds()),t.shouldGraph=!0;let l=t.columns,p=[],f=M=>!M.replace(/\\\\space|\\\\ /g,\"\").match(/\\S/);for(let M=0;M<l.length;M++){let I,D,O,N=l[M];I=Hs(N.latex,{...s,seedPrefix:sr(n,[[\"tr\",0],[\"tc\",M]])}),D=[];let A=-1;for(let L=0;L<l[M].values.length;L++)f(N.values[L])?D.push(new io(NaN)):(D.push(Hs(N.values[L],{...s,seedPrefix:sr(n,[[\"tr\",L+1],[\"tc\",M]])})),A=L);if(D=D.slice(0,A+1),O=new Ik(I,D),O.id=N.id,O.header){if(O.header.userData=N,O.header.metaData={extraDepNodes:[]},N.colorLatex){let L=Li(N.colorLatex,{...s,seedPrefix:sr(n,[[\"tr\",0],[\"tc\",M],[\"cl\",M]])});O.header.metaData.colorLatex=L,O.header.metaData.extraDepNodes.push(L)}if(N.pointSize){let L=Li(N.pointSize,{...s,seedPrefix:sr(n,[[\"tr\",0],[\"tc\",M],[\"ps\",M]])});O.header.metaData.pointSize=L,O.header.metaData.extraDepNodes.push(L)}if(N.pointOpacity){let L=Li(N.pointOpacity,{...s,seedPrefix:sr(n,[[\"tr\",0],[\"tc\",M],[\"po\",M]])});O.header.metaData.pointOpacity=L,O.header.metaData.extraDepNodes.push(L)}if(N.lineWidth){let L=Li(N.lineWidth,{...s,seedPrefix:sr(n,[[\"tr\",0],[\"tc\",M],[\"lw\",M]])});O.header.metaData.lineWidth=L,O.header.metaData.extraDepNodes.push(L)}if(N.lineOpacity){let L=Li(N.lineOpacity,{...s,seedPrefix:sr(n,[[\"tr\",0],[\"tc\",M],[\"lo\",M]])});O.header.metaData.lineOpacity=L,O.header.metaData.extraDepNodes.push(L)}}p.push(O)}this.statements[n]=new Tk(p);let m=this.statements[n].getAllIds();c.forEach(M=>{m.indexOf(M)===-1&&this._notifyGraphRemoved(M,r)});break;case\"image\":let g=\"-\\\\trigAngleMultiplier*(\"+t.angle+\")\",y=Li(t.center,{...s,seedPrefix:sr(n,[[\"ic\",n]])}),d=Li(g,{...s,seedPrefix:sr(n,[[\"ia\",n]])}),h=Li(t.width,{...s,seedPrefix:sr(n,[[\"iw\",n]])}),b=Li(t.height,{...s,seedPrefix:sr(n,[[\"ih\",n]])}),x=Li(t.opacity,{...s,seedPrefix:sr(n,[[\"io\",n]])});this.statements[n]=new xk({center:y,radianAngle:d,width:h,height:b,opacity:x},void 0);break;case\"ticker\":{this.statements[n]=new v.Ticker({handler:Li(t.handlerLatex,{...s,allowDt:!0}),minStep:Li(t.minStepLatex||\"0\",s)});break}case\"geometry-toolbar-predicate\":{this.statements[n]=Li(`\\\\{${t.latex}:1,0\\\\}`,{...s});break}default:t=t;let P,E=Go(t.latex);E.slice(-1)===\"=\"?P=E.substring(0,E.length-1):P=t.latex,this.statements[n]=Hs(P,s);for(let M in xd){let I=M;if(t[I]){let D=xd[I],O=t[I];D.transform&&(O=D.transform(O));let N=Wi(O,{...s,seedPrefix:sr(n,[[D.seed,n]])});o[I]=N,o.extraDepNodes.push(N)}}if(t.colorLatex){let M=ku(t.colorLatex,{...s,seedPrefix:sr(n,[[\"ac\",n]])});o.colorLatex=M,o.extraDepNodes.push(M)}if(t.polarDomain&&t.polarDomain.min&&(o.polarDomainMin=Wi(t.polarDomain.min,{...s,seedPrefix:sr(n,[[\"lm\",n]])}),o.extraDepNodes.push(o.polarDomainMin)),t.polarDomain&&t.polarDomain.max&&(o.polarDomainMax=Wi(t.polarDomain.max,{...s,seedPrefix:sr(n,[[\"lM\",n]])}),o.extraDepNodes.push(o.polarDomainMax)),t.parametricDomain&&t.parametricDomain.min&&(o.parametricDomainMin=Wi(t.parametricDomain.min,{...s,seedPrefix:sr(n,[[\"lm\",n]])}),o.extraDepNodes.push(o.parametricDomainMin)),t.parametricDomain&&t.parametricDomain.max&&(o.parametricDomainMax=Wi(t.parametricDomain.max,{...s,seedPrefix:sr(n,[[\"lM\",n]])}),o.extraDepNodes.push(o.parametricDomainMax)),t.parametricDomain3Du&&t.parametricDomain3Du.min&&(o.parametricDomain3DuMin=Wi(t.parametricDomain3Du.min,{...s,seedPrefix:sr(n,[[\"lm\",n]])}),o.extraDepNodes.push(o.parametricDomain3DuMin)),t.parametricDomain3Du&&t.parametricDomain3Du.max&&(o.parametricDomain3DuMax=Wi(t.parametricDomain3Du.max,{...s,seedPrefix:sr(n,[[\"lM\",n]])}),o.extraDepNodes.push(o.parametricDomain3DuMax)),t.parametricDomain3Dv&&t.parametricDomain3Dv.min&&(o.parametricDomain3DvMin=Wi(t.parametricDomain3Dv.min,{...s,seedPrefix:sr(n,[[\"lm\",n]])}),o.extraDepNodes.push(o.parametricDomain3DvMin)),t.parametricDomain3Dv&&t.parametricDomain3Dv.max&&(o.parametricDomain3DvMax=Wi(t.parametricDomain3Dv.max,{...s,seedPrefix:sr(n,[[\"lM\",n]])}),o.extraDepNodes.push(o.parametricDomain3DvMax)),t.parametricDomain3Dr&&t.parametricDomain3Dr.min&&(o.parametricDomain3DrMin=Wi(t.parametricDomain3Dr.min,{...s,seedPrefix:sr(n,[[\"lm\",n]])}),o.extraDepNodes.push(o.parametricDomain3DrMin)),t.parametricDomain3Dr&&t.parametricDomain3Dr.max&&(o.parametricDomain3DrMax=Wi(t.parametricDomain3Dr.max,{...s,seedPrefix:sr(n,[[\"lM\",n]])}),o.extraDepNodes.push(o.parametricDomain3DrMax)),t.parametricDomain3Dphi&&t.parametricDomain3Dphi.min&&(o.parametricDomain3DphiMin=Wi(t.parametricDomain3Dphi.min,{...s,seedPrefix:sr(n,[[\"lm\",n]])}),o.extraDepNodes.push(o.parametricDomain3DphiMin)),t.parametricDomain3Dphi&&t.parametricDomain3Dphi.max&&(o.parametricDomain3DphiMax=Wi(t.parametricDomain3Dphi.max,{...s,seedPrefix:sr(n,[[\"lM\",n]])}),o.extraDepNodes.push(o.parametricDomain3DphiMax)),t.vizProps&&(t.vizProps.axisOffset&&(o.vizAxisOffset=Wi(t.vizProps.axisOffset,{...s,seedPrefix:sr(n,[[\"vo\",n]])}),o.extraDepNodes.push(o.vizAxisOffset)),t.vizProps.breadth&&(o.vizBreadth=Wi(t.vizProps.breadth,{...s,seedPrefix:sr(n,[[\"vb\",n]])}),o.extraDepNodes.push(o.vizBreadth))),t.cdf&&t.cdf.show){let M=tC(t.latex);M&&M.type===\"distribution\"&&(o.distributionSpec=M,o.cdfMin=ku(t.cdf.min,{...s,seedPrefix:sr(n,[[\"lm\",n]])}),o.extraDepNodes.push(o.cdfMin),o.cdfMax=ku(t.cdf.max,{...s,seedPrefix:sr(n,[[\"lM\",n]])}),o.extraDepNodes.push(o.cdfMax))}if(this.statements[n].shouldPromoteToSlider(this.policy)){let M=t.slider,I=!!(M&&M.isPlayingOnce),D=ku(M&&M.softMin,s),O=ku(M&&M.softMax,s),N=ku(M&&M.min,{...s,seedPrefix:sr(n,[[\"lm\",n]])}),A=ku(M&&M.max,{...s,seedPrefix:sr(n,[[\"lM\",n]])}),L=ku(M&&M.step,{...s,seedPrefix:sr(n,[[\"ls\",n]])});this.statements[n]=new Pk(this.statements[n],{sliderMin:N,sliderMax:A,sliderStep:L,sliderIsPlayingOnce:I,sliderSoftMin:D,sliderSoftMax:O})}}let a=t.clickableInfo;a&&a.enabled&&a.latex&&(o.clickHandler=Li(a.latex,{...s,allowIndex:!0})),this.statements[n].userData=t,this.statements[n].metaData=o;let u=t.label;if(u){let c=this.currentLabel[n];(!c||c.raw!==u)&&(this.currentLabel[n]=tM(u))}else delete this.currentLabel[n]}removeStatement(t,r){let n=this.statements[t];if(n){if(this.markExportsDirty(t),qs(n)){let i=this;n.getAllIds().forEach(function(s){i._notifyGraphRemoved(s,r)})}else this._notifyGraphRemoved(t,r);delete this.currentLabel[t],delete this.statements[t],delete this.analysis[t],delete this.currentStatus[t]}}markExportsDirty(t){if(this.statements[t]){sp(this.statements[t])&&(this.markedRegressionDirty=!0);for(let r of this.statements[t].getLegalExports(this.policy))this.dirtyExportedSymbolRoots[r]=!0}}markAsDirtyRoot(t){this.dirtyStatementRoots[t]=!0}getFrame(){return this.updateAnalysis(),this.frame}getAnalysis(){return this.updateAnalysis(),this.analysis}getEvaluationState(t){if(this.updateAnalysis(),!!this.analysis[t])return this.analysis[t].evaluationState}_updateRegressions(t){let r=this.frame,n=this.lastFrame,i=this.regressionFrame;if(!this.policy.graphingEnabled())return;let s=[];for(let l in t)t.hasOwnProperty(l)&&sp(t[l])&&s.push(l);let o=this;s.sort(function(l,p){let f=o.statements[l].userData&&o.statements[l].userData.residualVariable,m=o.statements[p].userData&&o.statements[p].userData.residualVariable;return f&&!m?-1:m&&!f?1:0});let a=bh(this.policy,t,s);mA(a,i,this.recursion);let u=a.resolved,c={};for(let l of u)if(l!==_o)if(sp(this.statements[l]))this.analysis[l]=t[l].analyze(this.policy,i,r,n,c),this.analysis[l].exportTo(this.policy,r),delete t[l];else{let p=t[l].tryGetConcreteTree(this.policy,i);t[l].exportTo(this.policy,p,i),c[l]={rawTree:t[l],concreteTree:p}}}buildSymbolToExpressionDirtyMap(){let t={};for(let r in this.statements){if(!this.statements.hasOwnProperty(r))continue;let n=this.statements[r],i=n.metaData;if(Pd(t,r,n.getDependencies()),Pd(t,r,n.getLegalExports(this.policy)),sp(n)&&n.userData&&n.userData.residualVariable&&Pd(t,r,[Bo(n.userData.residualVariable)]),yA(t,r,i),qs(n)&&n.columns)for(let s=0;s<n.columns.length;s++){let o=n.columns[s];!Eo(o)&&o.header&&o.header.metaData&&yA(t,r,o.header.metaData)}}return t}buildChildIntersectionMap(){var n,i;let t=this.childIntersections,r=new yd;for(let s in this.analysis){let o=this.analysis[s],{geometry:a}=o.evaluationState;if(a!=null&&a.call&&a.call.symbol===\"intersection\"&&this.statements[s].userData.shouldGraph&&!o.concreteTree.isError){let u=!!this.unpublishedIds[s],c=o.concreteTree.asTypedValue();for(let l of a.call.parents){let p=l&&this.frame[l[0]],f=p&&p.userData.id;if(f==null)continue;let m=l&&l[1],g=this.analysis[f];W(g.concreteTree.asTypedValue().valueType)?r.addListParent(f,m===void 0?void 0:m-1,c):r.addPrimitiveParent(f,c),u&&(this.unpublishedIds[f]=!0)}}}for(let s in t.data){let o=((n=t.data[s])==null?void 0:n.count)||0;(((i=r.data[s])==null?void 0:i.count)||0)<o&&(this.unpublishedIds[s]=!0)}return r}updateConstruction(){if(!this.policy.isGeometryEnabled){this.parent_frame.construction=nf();return}let t=[];for(let o in this.statements)this.statements[o].userData.isInConstructionsFolder&&t.push(o);let r=this.statements[_o],n=new Ek(t);n.metaData={extraDepNodes:[]},n.userData={};let i={};for(let o of(r==null?void 0:r.getDependencies())||[])i[o]=!0;let s={};for(let o of n.getDependencies())s[o]=!0;(!r||!Vo(i,s))&&(this.statements[_o]=n,this.parent_frame.construction=n,this.markAsDirtyRoot(_o),this.markExportsDirty(_o))}analyzeExternalRecursiveBaseCases(){if(!this.recursion)return;let t=[],r={};for(let o in this.statements){if(!this.statements.hasOwnProperty(o))continue;let a=this.statements[o];a instanceof In&&(t.push(o),r[a._symbol]=a)}let n=bh(this.policy,this.statements,t),i=new Set;for(let o of t){let a=this.statements[o];a instanceof In&&n.recursiveFunctionGroups[o]&&i.add(a._symbol)}let s={};for(let o in this.statements){let a=this.statements[o];if(a instanceof Vs&&a._lhs instanceof xA&&i.has(a._lhs._symbol)){let u=Ts.fromEquation(r,a);if(!u)continue;this.markExportsDirty(o),this.markAsDirtyRoot(o),this.statements[o]=u,s[u._symbol]||(s[u._symbol]=[]),s[u._symbol].push(u)}else a instanceof Ts&&(i.has(a._symbol)?(s[a._symbol]||(s[a._symbol]=[]),s[a._symbol].push(a)):(this.markExportsDirty(o),this.markAsDirtyRoot(o),this.statements[o]=a.originalNode))}for(let o in r){let a=r[o],u=a.getExternalBaseCases(),c=s[o]||[],l=!1;if(u.length===c.length){for(let p=0;p<c.length;p++)if(c[p]!==u[p]){l=!0;break}}else l=!0;l&&(a.setExternalBaseCases(c),this.markExportsDirty(a.userData.id),this.markAsDirtyRoot(a.userData.id))}}updateAnalysis(){var m;this.updateConstruction(),this.analyzeExternalRecursiveBaseCases();let t=this.buildSymbolToExpressionDirtyMap(),r=iM(this.policy,this.statements,t,this.dirtyStatementRoots,this.dirtyExportedSymbolRoots),n=this.markedRegressionDirty;for(let g in r.ids)this.statements[g]&&sp(this.statements[g])&&(n=!0);let i={};if(n){for(let g in this.statements)this.statements[g]&&(i[g]=this.statements[g]);this.frame=Object.create(this.parent_frame),this.regressionFrame=Object.create(this.parent_frame)}else{let g=r.ids;for(let d in g)this.statements[d]&&(i[d]=this.statements[d]);let y=r.symbols;for(let d in y)y[d]&&(delete this.frame[d],delete this.regressionFrame[d])}for(let g in i)i[g]&&(this.unpublishedIds[g]=!0);this.markedRegressionDirty=!1,this.dirtyExportedSymbolRoots={},this.dirtyStatementRoots={};let s=this.analysis,o=this.frame;(this.evaluationMode===\"graphing\"||this.evaluationMode===\"geometry\"||this.evaluationMode===\"graphing_3d\")&&this._updateRegressions(i);let a=bh(this.policy,i);mA(a,o,this.recursion);let u=a.resolved,c=new Set;for(let g of u)if(g!==_o)switch(this.evaluationMode){case\"fourFunction\":case\"singleExpressionFourFunction\":s[g]=this.statements[g].analyzeFourFunction(this.policy,o,s),s[g].exportTo(this.policy,o);break;case\"scientific\":s[g]=this.statements[g].analyzeScientific(this.policy,o,s),s[g].exportTo(this.policy,o);break;case\"singleExpressionScientific\":s[g]=this.statements[g].analyzeSingleExpressionScientific(this.policy,o,s),s[g].exportTo(this.policy,o);break;case\"graphing\":case\"graphing_3d\":case\"geometry\":if(!this.policy.graphingEnabled())break;if(c.has(g))continue;let y=a.recursiveFunctionGroups[g];if(o.r){let h=Object.create(o);if(h.r=void 0,s[g]=this.statements[g].analyze(this.policy,h,s),s[g].getGraphMode()===6){s[g].exportTo(this.policy,o);continue}}let d=!1;if(y&&this.recursion&&(d=lA(this.policy,o,s,y),d))for(let h in y)c.add(h);d||(s[g]=this.statements[g].analyze(this.policy,o,s),s[g].exportTo(this.policy,o));break}if(this.policy.graphingEnabled()){for(let g of u){if(g===_o)continue;let y=s[g],d=y.evaluationState.expression_type;for(let h in xd){let b=h;var l=xd[b];this.evaluationMode!==\"graphing_3d\"&&b===\"resolution\"||(!l.shouldEvaluate||l.shouldEvaluate(y))&&wk(y,this.policy,o,b)}Fk(y,this.policy,o),this.product===\"graphing-3d\"&&Vk(y),this.actions&&Sk(y)&&Bk(y,this.policy,o),d===\"PARAMETRIC\"||d===\"CURVE3D_xyz_t\"||d===\"POLAR\"||d===\"SURFACE_r_\\u03B8z\"||d===\"SURFACE_r_\\u03B8z_AMBIGUOUS\"||d===\"SLICE_r\\u03B8z_at_z\"?Gk(y,this.policy,o):d===\"SURFACE_xyz_uv\"||d===\"SLICE_xyz_uv\"||d===\"SURFACE_r_\\u03B8\\u03C6\"||d===\"SURFACE_z_r\\u03B8\"||d===\"SLICE_zr\\u03B8_at_r\"||d===\"SLICE_zr\\u03B8_at_\\u03B8\"||d===\"SLICE_zr\\u03B8_at_xyz\"||d===\"SLICE_r\\u03B8\\u03C6_at_\\u03B8\"||d===\"SLICE_r\\u03B8\\u03C6_at_\\u03C6\"||d===\"SLICE_r\\u03B8\\u03C6_at_xyz\"?zk(y,this.policy,o):d===\"BOXPLOT\"?kk(y,this.policy,o):Dk(y)&&_k(y,this.policy,o)}this.childIntersections=this.buildChildIntersectionMap()}Hk(t).forEach(function(g){s[g].evaluationState.depends_on_random_seed=!0});let p=iM(this.policy,this.statements,t,{[_o]:!0},{construction:!0});for(let g in p.ids){if(g===_o)continue;let y=s[g].evaluationState;y.geometry&&(y.geometry.unconstructable=!0)}let f;for(let g in this.statements)if((m=this.statements[g].parseOptions)!=null&&m.selection){f=g;break}if(f){let g=iM(this.policy,this.statements,t,{[f]:!0},{[`idref_${f}`]:!0});for(let y in g.ids){if(y===_o)continue;let d=s[y].evaluationState;d.geometry&&(d.geometry.depends_on_selected=!0)}}this.lastFrame=Object.create(this.parent_frame);for(let g in o)o.hasOwnProperty(g)&&(this.lastFrame[g]=o[g])}processEvents(t){if(!t||!this.actions)return;let r=Object.create(this.frame),n={},i=!1,s=!1,o;for(let c of t)switch(this.globalEventCount+=1,r.globalEventCount=new v.Constant(this.globalEventCount),c.type){case\"step\":{let p=this.statements[c.expressionId];if(!p)continue;let f=p.tryGetConcreteTree(this.policy,r);s=!0,sM(f,n,r);break}case\"click\":{let p=this.statements[c.expressionId];if(!p||!p.metaData.clickHandler)continue;r.index=new v.Constant(c.indexVar+1);let f=p.metaData.clickHandler.tryGetConcreteTree(this.policy,r);s=!0,i=!0,sM(f,n,r);break}case\"clock-tick\":{(o===void 0||c.isFirstTick&&!o.isFirstTick)&&(o=c);break}default:return c}if(o){let c=this.statements[o.id];if(c&&c instanceof v.Ticker){var a=c.minStep.tryGetConcreteTree(this.policy,r).asValue(),u=typeof a==\"number\"&&a>=0&&isFinite(a);if(u){let l=this.lastClockTickTime;if(this.lastClockTickTime=Date.now(),!o.isFirstTick&&l!==void 0){r.dt=new v.Constant(this.lastClockTickTime-l);let p=c.handler.tryGetConcreteTree(this.policy,r);sM(p,n,r)}}}}return{objectClicked:i,userAction:s,updates:n}}};var PA=class{constructor(t){this.context=new Ph,this.sendMessage=t}processChangeSet(t){var r=this.context.processChangeSet(t);this.sendMessage(\"processChangeSet\",r)}};Object.defineProperty(__dcg_chunk_exports__, 'a', { get: () => Uk });\nObject.defineProperty(__dcg_chunk_exports__, 'b', { get: () => qk });\nObject.defineProperty(__dcg_chunk_exports__, 'c', { get: () => $k });\nObject.defineProperty(__dcg_chunk_exports__, 'd', { get: () => wo });\nObject.defineProperty(__dcg_chunk_exports__, 'e', { get: () => Yk });\nObject.defineProperty(__dcg_chunk_exports__, 'f', { get: () => Xk });\nObject.defineProperty(__dcg_chunk_exports__, 'g', { get: () => Qc });\nObject.defineProperty(__dcg_chunk_exports__, 'h', { get: () => Ld });\nObject.defineProperty(__dcg_chunk_exports__, 'i', { get: () => UA });\nObject.defineProperty(__dcg_chunk_exports__, 'j', { get: () => OH });\nObject.defineProperty(__dcg_chunk_exports__, 'k', { get: () => RH });\nObject.defineProperty(__dcg_chunk_exports__, 'l', { get: () => jc });\nObject.defineProperty(__dcg_chunk_exports__, 'm', { get: () => wM });\nObject.defineProperty(__dcg_chunk_exports__, 'n', { get: () => qA });\nObject.defineProperty(__dcg_chunk_exports__, 'o', { get: () => NH });\nObject.defineProperty(__dcg_chunk_exports__, 'p', { get: () => AH });\nObject.defineProperty(__dcg_chunk_exports__, 'q', { get: () => _H });\nObject.defineProperty(__dcg_chunk_exports__, 'r', { get: () => FH });\nObject.defineProperty(__dcg_chunk_exports__, 's', { get: () => VH });\nObject.defineProperty(__dcg_chunk_exports__, 't', { get: () => GH });\nObject.defineProperty(__dcg_chunk_exports__, 'u', { get: () => zH });\nObject.defineProperty(__dcg_chunk_exports__, 'v', { get: () => Lh });\nObject.defineProperty(__dcg_chunk_exports__, 'w', { get: () => XA });\nObject.defineProperty(__dcg_chunk_exports__, 'x', { get: () => jA });\nObject.defineProperty(__dcg_chunk_exports__, 'y', { get: () => qH });\nObject.defineProperty(__dcg_chunk_exports__, 'z', { get: () => XH });\nObject.defineProperty(__dcg_chunk_exports__, 'A', { get: () => ZH });\nObject.defineProperty(__dcg_chunk_exports__, 'B', { get: () => Pi });\nObject.defineProperty(__dcg_chunk_exports__, 'C', { get: () => Dp });\nObject.defineProperty(__dcg_chunk_exports__, 'D', { get: () => s_ });\nObject.defineProperty(__dcg_chunk_exports__, 'E', { get: () => Vo });\nObject.defineProperty(__dcg_chunk_exports__, 'F', { get: () => QH });\nObject.defineProperty(__dcg_chunk_exports__, 'G', { get: () => Kc });\nObject.defineProperty(__dcg_chunk_exports__, 'H', { get: () => el });\nObject.defineProperty(__dcg_chunk_exports__, 'I', { get: () => c_ });\nObject.defineProperty(__dcg_chunk_exports__, 'J', { get: () => oU });\nObject.defineProperty(__dcg_chunk_exports__, 'K', { get: () => uU });\nObject.defineProperty(__dcg_chunk_exports__, 'L', { get: () => h2 });\nObject.defineProperty(__dcg_chunk_exports__, 'M', { get: () => Wk });\nObject.defineProperty(__dcg_chunk_exports__, 'N', { get: () => y0 });\nObject.defineProperty(__dcg_chunk_exports__, 'O', { get: () => Kg });\nObject.defineProperty(__dcg_chunk_exports__, 'P', { get: () => x2 });\nObject.defineProperty(__dcg_chunk_exports__, 'Q', { get: () => rN });\nObject.defineProperty(__dcg_chunk_exports__, 'R', { get: () => P2 });\nObject.defineProperty(__dcg_chunk_exports__, 'S', { get: () => nN });\nObject.defineProperty(__dcg_chunk_exports__, 'T', { get: () => Qg });\nObject.defineProperty(__dcg_chunk_exports__, 'U', { get: () => I2 });\nObject.defineProperty(__dcg_chunk_exports__, 'V', { get: () => g0 });\nObject.defineProperty(__dcg_chunk_exports__, 'W', { get: () => Vc });\nObject.defineProperty(__dcg_chunk_exports__, 'X', { get: () => E2 });\nObject.defineProperty(__dcg_chunk_exports__, 'Y', { get: () => M2 });\nObject.defineProperty(__dcg_chunk_exports__, 'Z', { get: () => Us });\nObject.defineProperty(__dcg_chunk_exports__, '_', { get: () => cee });\nObject.defineProperty(__dcg_chunk_exports__, '$', { get: () => v2 });\nObject.defineProperty(__dcg_chunk_exports__, 'aa', { get: () => yM });\nObject.defineProperty(__dcg_chunk_exports__, 'ba', { get: () => Sd });\nObject.defineProperty(__dcg_chunk_exports__, 'ca', { get: () => gH });\nObject.defineProperty(__dcg_chunk_exports__, 'da', { get: () => ls });\nObject.defineProperty(__dcg_chunk_exports__, 'ea', { get: () => da });\nObject.defineProperty(__dcg_chunk_exports__, 'fa', { get: () => Ls });\nObject.defineProperty(__dcg_chunk_exports__, 'ga', { get: () => LA });\nObject.defineProperty(__dcg_chunk_exports__, 'ha', { get: () => bH });\nObject.defineProperty(__dcg_chunk_exports__, 'ia', { get: () => xH });\nObject.defineProperty(__dcg_chunk_exports__, 'ja', { get: () => wi });\nObject.defineProperty(__dcg_chunk_exports__, 'ka', { get: () => PH });\nObject.defineProperty(__dcg_chunk_exports__, 'la', { get: () => Dv });\nObject.defineProperty(__dcg_chunk_exports__, 'ma', { get: () => yf });\nObject.defineProperty(__dcg_chunk_exports__, 'na', { get: () => Jm });\nObject.defineProperty(__dcg_chunk_exports__, 'oa', { get: () => ns });\nObject.defineProperty(__dcg_chunk_exports__, 'pa', { get: () => Qv });\nObject.defineProperty(__dcg_chunk_exports__, 'qa', { get: () => iY });\nObject.defineProperty(__dcg_chunk_exports__, 'ra', { get: () => cY });\nObject.defineProperty(__dcg_chunk_exports__, 'sa', { get: () => S });\nObject.defineProperty(__dcg_chunk_exports__, 'ta', { get: () => vt });\nObject.defineProperty(__dcg_chunk_exports__, 'ua', { get: () => T });\nObject.defineProperty(__dcg_chunk_exports__, 'va', { get: () => C });\nObject.defineProperty(__dcg_chunk_exports__, 'wa', { get: () => or });\nObject.defineProperty(__dcg_chunk_exports__, 'xa', { get: () => le });\nObject.defineProperty(__dcg_chunk_exports__, 'ya', { get: () => _r });\nObject.defineProperty(__dcg_chunk_exports__, 'za', { get: () => xt });\nObject.defineProperty(__dcg_chunk_exports__, 'Aa', { get: () => Lr });\nObject.defineProperty(__dcg_chunk_exports__, 'Ba', { get: () => Xe });\nObject.defineProperty(__dcg_chunk_exports__, 'Ca', { get: () => Zr });\nObject.defineProperty(__dcg_chunk_exports__, 'Da', { get: () => Be });\nObject.defineProperty(__dcg_chunk_exports__, 'Ea', { get: () => Or });\nObject.defineProperty(__dcg_chunk_exports__, 'Fa', { get: () => Se });\nObject.defineProperty(__dcg_chunk_exports__, 'Ga', { get: () => xr });\nObject.defineProperty(__dcg_chunk_exports__, 'Ha', { get: () => he });\nObject.defineProperty(__dcg_chunk_exports__, 'Ia', { get: () => wr });\nObject.defineProperty(__dcg_chunk_exports__, 'Ja', { get: () => fe });\nObject.defineProperty(__dcg_chunk_exports__, 'Ka', { get: () => Fr });\nObject.defineProperty(__dcg_chunk_exports__, 'La', { get: () => be });\nObject.defineProperty(__dcg_chunk_exports__, 'Ma', { get: () => Vr });\nObject.defineProperty(__dcg_chunk_exports__, 'Na', { get: () => _e });\nObject.defineProperty(__dcg_chunk_exports__, 'Oa', { get: () => Br });\nObject.defineProperty(__dcg_chunk_exports__, 'Pa', { get: () => Ge });\nObject.defineProperty(__dcg_chunk_exports__, 'Qa', { get: () => mr });\nObject.defineProperty(__dcg_chunk_exports__, 'Ra', { get: () => Ae });\nObject.defineProperty(__dcg_chunk_exports__, 'Sa', { get: () => yr });\nObject.defineProperty(__dcg_chunk_exports__, 'Ta', { get: () => Ue });\nObject.defineProperty(__dcg_chunk_exports__, 'Ua', { get: () => bn });\nObject.defineProperty(__dcg_chunk_exports__, 'Va', { get: () => Me });\nObject.defineProperty(__dcg_chunk_exports__, 'Wa', { get: () => Gr });\nObject.defineProperty(__dcg_chunk_exports__, 'Xa', { get: () => kn });\nObject.defineProperty(__dcg_chunk_exports__, 'Ya', { get: () => pr });\nObject.defineProperty(__dcg_chunk_exports__, 'Za', { get: () => Hn });\nObject.defineProperty(__dcg_chunk_exports__, '_a', { get: () => V });\nObject.defineProperty(__dcg_chunk_exports__, '$a', { get: () => mM });\nObject.defineProperty(__dcg_chunk_exports__, 'ab', { get: () => OA });\nObject.defineProperty(__dcg_chunk_exports__, 'bb', { get: () => $t });\nObject.defineProperty(__dcg_chunk_exports__, 'cb', { get: () => ne });\nObject.defineProperty(__dcg_chunk_exports__, 'db', { get: () => W });\nObject.defineProperty(__dcg_chunk_exports__, 'eb', { get: () => ze });\nObject.defineProperty(__dcg_chunk_exports__, 'fb', { get: () => Tp });\nObject.defineProperty(__dcg_chunk_exports__, 'gb', { get: () => Kn });\nObject.defineProperty(__dcg_chunk_exports__, 'hb', { get: () => Dd });\nObject.defineProperty(__dcg_chunk_exports__, 'ib', { get: () => ce });\nObject.defineProperty(__dcg_chunk_exports__, 'jb', { get: () => pa });\nObject.defineProperty(__dcg_chunk_exports__, 'kb', { get: () => Le });\nObject.defineProperty(__dcg_chunk_exports__, 'lb', { get: () => ri });\nObject.defineProperty(__dcg_chunk_exports__, 'mb', { get: () => gi });\nObject.defineProperty(__dcg_chunk_exports__, 'nb', { get: () => Sr });\nObject.defineProperty(__dcg_chunk_exports__, 'ob', { get: () => Vh });\nObject.defineProperty(__dcg_chunk_exports__, 'pb', { get: () => b_ });\nObject.defineProperty(__dcg_chunk_exports__, 'qb', { get: () => jM });\nObject.defineProperty(__dcg_chunk_exports__, 'rb', { get: () => Bd });\nObject.defineProperty(__dcg_chunk_exports__, 'sb', { get: () => E_ });\nObject.defineProperty(__dcg_chunk_exports__, 'tb', { get: () => zh });\nObject.defineProperty(__dcg_chunk_exports__, 'ub', { get: () => fn });\nObject.defineProperty(__dcg_chunk_exports__, 'vb', { get: () => v_ });\nObject.defineProperty(__dcg_chunk_exports__, 'wb', { get: () => Bo });\nObject.defineProperty(__dcg_chunk_exports__, 'xb', { get: () => Go });\nObject.defineProperty(__dcg_chunk_exports__, 'yb', { get: () => D_ });\nObject.defineProperty(__dcg_chunk_exports__, 'zb', { get: () => ya });\nObject.defineProperty(__dcg_chunk_exports__, 'Ab', { get: () => go });\nObject.defineProperty(__dcg_chunk_exports__, 'Bb', { get: () => QL });\nObject.defineProperty(__dcg_chunk_exports__, 'Cb', { get: () => on });\nObject.defineProperty(__dcg_chunk_exports__, 'Db', { get: () => AD });\nObject.defineProperty(__dcg_chunk_exports__, 'Eb', { get: () => zl });\nObject.defineProperty(__dcg_chunk_exports__, 'Fb', { get: () => Ul });\nObject.defineProperty(__dcg_chunk_exports__, 'Gb', { get: () => ql });\nObject.defineProperty(__dcg_chunk_exports__, 'Hb', { get: () => YT });\nObject.defineProperty(__dcg_chunk_exports__, 'Ib', { get: () => XT });\nObject.defineProperty(__dcg_chunk_exports__, 'Jb', { get: () => DT });\nObject.defineProperty(__dcg_chunk_exports__, 'Kb', { get: () => $F });\nObject.defineProperty(__dcg_chunk_exports__, 'Lb', { get: () => o1 });\nObject.defineProperty(__dcg_chunk_exports__, 'Mb', { get: () => YF });\nObject.defineProperty(__dcg_chunk_exports__, 'Nb', { get: () => Ey });\nObject.defineProperty(__dcg_chunk_exports__, 'Ob', { get: () => Sf });\nObject.defineProperty(__dcg_chunk_exports__, 'Pb', { get: () => ZT });\nObject.defineProperty(__dcg_chunk_exports__, 'Qb', { get: () => WT });\nObject.defineProperty(__dcg_chunk_exports__, 'Rb', { get: () => u1 });\nObject.defineProperty(__dcg_chunk_exports__, 'Sb', { get: () => WF });\nObject.defineProperty(__dcg_chunk_exports__, 'Tb', { get: () => c1 });\nObject.defineProperty(__dcg_chunk_exports__, 'Ub', { get: () => jF });\nObject.defineProperty(__dcg_chunk_exports__, 'Vb', { get: () => l1 });\nObject.defineProperty(__dcg_chunk_exports__, 'Wb', { get: () => JF });\nObject.defineProperty(__dcg_chunk_exports__, 'Xb', { get: () => aV });\nObject.defineProperty(__dcg_chunk_exports__, 'Yb', { get: () => lV });\nObject.defineProperty(__dcg_chunk_exports__, 'Zb', { get: () => pV });\nObject.defineProperty(__dcg_chunk_exports__, '_b', { get: () => Wo });\nObject.defineProperty(__dcg_chunk_exports__, '$b', { get: () => kC });\nObject.defineProperty(__dcg_chunk_exports__, 'ac', { get: () => AK });\nObject.defineProperty(__dcg_chunk_exports__, 'bc', { get: () => jt });\nObject.defineProperty(__dcg_chunk_exports__, 'cc', { get: () => rt });\nObject.defineProperty(__dcg_chunk_exports__, 'dc', { get: () => l3 });\nObject.defineProperty(__dcg_chunk_exports__, 'ec', { get: () => _n });\nObject.defineProperty(__dcg_chunk_exports__, 'fc', { get: () => Vs });\nObject.defineProperty(__dcg_chunk_exports__, 'gc', { get: () => bo });\nObject.defineProperty(__dcg_chunk_exports__, 'hc', { get: () => TY });\nObject.defineProperty(__dcg_chunk_exports__, 'ic', { get: () => RV });\nObject.defineProperty(__dcg_chunk_exports__, 'jc', { get: () => v });\nObject.defineProperty(__dcg_chunk_exports__, 'kc', { get: () => mn });\nObject.defineProperty(__dcg_chunk_exports__, 'lc', { get: () => zX });\nObject.defineProperty(__dcg_chunk_exports__, 'mc', { get: () => Dy });\nObject.defineProperty(__dcg_chunk_exports__, 'nc', { get: () => b1 });\nObject.defineProperty(__dcg_chunk_exports__, 'oc', { get: () => PI });\nObject.defineProperty(__dcg_chunk_exports__, 'pc', { get: () => a6 });\nObject.defineProperty(__dcg_chunk_exports__, 'qc', { get: () => $e });\nObject.defineProperty(__dcg_chunk_exports__, 'rc', { get: () => x6 });\nObject.defineProperty(__dcg_chunk_exports__, 'sc', { get: () => P6 });\nObject.defineProperty(__dcg_chunk_exports__, 'tc', { get: () => sS });\nObject.defineProperty(__dcg_chunk_exports__, 'uc', { get: () => To });\nObject.defineProperty(__dcg_chunk_exports__, 'vc', { get: () => qy });\nObject.defineProperty(__dcg_chunk_exports__, 'wc', { get: () => gS });\nObject.defineProperty(__dcg_chunk_exports__, 'xc', { get: () => Ur });\nObject.defineProperty(__dcg_chunk_exports__, 'yc', { get: () => Ne });\nObject.defineProperty(__dcg_chunk_exports__, 'zc', { get: () => FI });\nObject.defineProperty(__dcg_chunk_exports__, 'Ac', { get: () => l7 });\nObject.defineProperty(__dcg_chunk_exports__, 'Bc', { get: () => p7 });\nObject.defineProperty(__dcg_chunk_exports__, 'Cc', { get: () => $O });\nObject.defineProperty(__dcg_chunk_exports__, 'Dc', { get: () => tR });\nObject.defineProperty(__dcg_chunk_exports__, 'Ec', { get: () => Hs });\nObject.defineProperty(__dcg_chunk_exports__, 'Fc', { get: () => LR });\nObject.defineProperty(__dcg_chunk_exports__, 'Gc', { get: () => ra });\nObject.defineProperty(__dcg_chunk_exports__, 'Hc', { get: () => tC });\nObject.defineProperty(__dcg_chunk_exports__, 'Ic', { get: () => ME });\nObject.defineProperty(__dcg_chunk_exports__, 'Jc', { get: () => vE });\nObject.defineProperty(__dcg_chunk_exports__, 'Kc', { get: () => rC });\nObject.defineProperty(__dcg_chunk_exports__, 'Lc', { get: () => nC });\nObject.defineProperty(__dcg_chunk_exports__, 'Mc', { get: () => iC });\nObject.defineProperty(__dcg_chunk_exports__, 'Nc', { get: () => na });\nObject.defineProperty(__dcg_chunk_exports__, 'Oc', { get: () => uG });\nObject.defineProperty(__dcg_chunk_exports__, 'Pc', { get: () => Wj });\nObject.defineProperty(__dcg_chunk_exports__, 'Qc', { get: () => je });\nObject.defineProperty(__dcg_chunk_exports__, 'Rc', { get: () => OG });\nObject.defineProperty(__dcg_chunk_exports__, 'Sc', { get: () => ie });\nObject.defineProperty(__dcg_chunk_exports__, 'Tc', { get: () => od });\nObject.defineProperty(__dcg_chunk_exports__, 'Uc', { get: () => bC });\nObject.defineProperty(__dcg_chunk_exports__, 'Vc', { get: () => WE });\nObject.defineProperty(__dcg_chunk_exports__, 'Wc', { get: () => jE });\nObject.defineProperty(__dcg_chunk_exports__, 'Xc', { get: () => JE });\nObject.defineProperty(__dcg_chunk_exports__, 'Yc', { get: () => wg });\nObject.defineProperty(__dcg_chunk_exports__, 'Zc', { get: () => Fg });\nObject.defineProperty(__dcg_chunk_exports__, '_c', { get: () => Cu });\nObject.defineProperty(__dcg_chunk_exports__, '$c', { get: () => Ug });\nObject.defineProperty(__dcg_chunk_exports__, 'ad', { get: () => cd });\nObject.defineProperty(__dcg_chunk_exports__, 'bd', { get: () => jg });\nObject.defineProperty(__dcg_chunk_exports__, 'cd', { get: () => FK });\nObject.defineProperty(__dcg_chunk_exports__, 'dd', { get: () => BK });\nObject.defineProperty(__dcg_chunk_exports__, 'ed', { get: () => GK });\nObject.defineProperty(__dcg_chunk_exports__, 'fd', { get: () => XC });\nObject.defineProperty(__dcg_chunk_exports__, 'gd', { get: () => zK });\nObject.defineProperty(__dcg_chunk_exports__, 'hd', { get: () => UK });\nObject.defineProperty(__dcg_chunk_exports__, 'id', { get: () => qK });\nObject.defineProperty(__dcg_chunk_exports__, 'jd', { get: () => WC });\nObject.defineProperty(__dcg_chunk_exports__, 'kd', { get: () => jC });\nObject.defineProperty(__dcg_chunk_exports__, 'ld', { get: () => Jg });\nObject.defineProperty(__dcg_chunk_exports__, 'md', { get: () => JC });\nObject.defineProperty(__dcg_chunk_exports__, 'nd', { get: () => QC });\nObject.defineProperty(__dcg_chunk_exports__, 'od', { get: () => KC });\nObject.defineProperty(__dcg_chunk_exports__, 'pd', { get: () => nee });\nObject.defineProperty(__dcg_chunk_exports__, 'qd', { get: () => iee });\nObject.defineProperty(__dcg_chunk_exports__, 'rd', { get: () => b2 });\nObject.defineProperty(__dcg_chunk_exports__, 'sd', { get: () => see });\nObject.defineProperty(__dcg_chunk_exports__, 'td', { get: () => oee });\nObject.defineProperty(__dcg_chunk_exports__, 'ud', { get: () => gp });\nObject.defineProperty(__dcg_chunk_exports__, 'vd', { get: () => pN });\nObject.defineProperty(__dcg_chunk_exports__, 'wd', { get: () => Q2 });\nObject.defineProperty(__dcg_chunk_exports__, 'xd', { get: () => oz });\nObject.defineProperty(__dcg_chunk_exports__, 'yd', { get: () => Dr });\nObject.defineProperty(__dcg_chunk_exports__, 'zd', { get: () => ah });\nObject.defineProperty(__dcg_chunk_exports__, 'Ad', { get: () => mz });\nObject.defineProperty(__dcg_chunk_exports__, 'Bd', { get: () => sA });\nObject.defineProperty(__dcg_chunk_exports__, 'Cd', { get: () => nv });\nObject.defineProperty(__dcg_chunk_exports__, 'Dd', { get: () => iv });\nObject.defineProperty(__dcg_chunk_exports__, 'Ed', { get: () => nk });\nObject.defineProperty(__dcg_chunk_exports__, 'Fd', { get: () => ik });\nObject.defineProperty(__dcg_chunk_exports__, 'Gd', { get: () => gd });\nObject.defineProperty(__dcg_chunk_exports__, 'Hd', { get: () => hd });\nObject.defineProperty(__dcg_chunk_exports__, 'Id', { get: () => Ph });\nObject.defineProperty(__dcg_chunk_exports__, 'Jd', { get: () => PA });\n\n    return __dcg_chunk_exports__;\n  })();"
  const __dcg_shared_module_exports__ = eval(__dcg_shared_module_source__);
  const __dcg_worker_source_exports__ = (function () {
    // worker.js
    const __dcg_worker_source__ = `
      // store the code for the worker module as a function that takes the shared module exports as an argument
      const __dcg_worker_module__ = (__dcg_shared_module_exports__) => {
` + "var o={};__dcg_shared_module_exports__['M'].log=function(e){self.postMessage({log:JSON.stringify(e)})};var a=self;a.window=a;a.onmessage=function(e){var n=e.data&&e.data.connectionId;if(n)if(e.data.originalMessage.type===\"destroy\")delete o[n];else{var s=o[n];s||(s=new __dcg_shared_module_exports__['Jd'](function(g,c){a.postMessage({connectionId:n,originalMessage:{type:g,payload:c}})}),o[n]=s),s.processChangeSet(e.data.originalMessage)}};a.loadMessageQueue&&(a.loadMessageQueue.forEach(function(e){a.onmessage(e)}),delete a.loadMessageQueue);\n" + `
      };
      // execute the shared module store its exports
      const __dcg_worker_shared_module_exports__ = ${__dcg_shared_module_source__};
      // call the worker module, passing in the shared module exports
      __dcg_worker_module__(__dcg_worker_shared_module_exports__);`

    let createWorker;
    if (typeof Blob !== 'undefined' && URL && typeof URL.createObjectURL === 'function') {
      createWorker = () => {
        const workerURL = URL.createObjectURL(new Blob([__dcg_worker_source__], { type: 'application/javascript' }))
        const worker = new Worker(workerURL);
        worker.revokeObjectURL = () => {
          URL.revokeObjectURL(workerURL);
        }
        return worker;
      }
    } else {
      // Just for testing in Node
      createWorker = () => {
        (new Function(__dcg_worker_source__))();
      }
    }

    return {createWorker, default: {createWorker}};
  })();
  function HD(r){return r==null?r+"":typeof r=="object"||typeof r=="function"?qD[H5.call(r)]||"object":typeof r}function MP(r){var e=!!r&&"length"in r&&r.length,t=HD(r);return Yu(r)||oy(r)?!1:t==="array"||e===0||typeof e=="number"&&e>0&&e-1 in r}function ey(r,e){return r.nodeName&&r.nodeName.toLowerCase()===e.toLowerCase()}function CZ(r,e){return e.toUpperCase()}function Wu(r){return r.replace(wZ,"ms-").replace(vZ,CZ)}function zv(){this.expando=fe.expando+zv.uid++}function DZ(r){return r==="true"?!0:r==="false"?!1:r==="null"?null:r===+r+""?+r:EZ.test(r)?JSON.parse(r):r}function P5(r,e,t){var i;if(t===void 0&&r.nodeType===1)if(i="data-"+e.replace(SZ,"-$&").toLowerCase(),t=r.getAttribute(i),typeof t=="string"){try{t=DZ(t)}catch(o){}$u.set(r,e,t)}else t=void 0;return t}function GZ(r,e,t,i){var o,n,a=20,s=i?function(){return i.cur()}:function(){return fe.css(r,e,"")},l=s(),c=t&&t[3]||(fe.cssNumber[e]?"":"px"),d=r.nodeType&&(fe.cssNumber[e]||c!=="px"&&+l)&&WD.exec(fe.css(r,e));if(d&&d[3]!==c){for(l=l/2,c=c||d[3],d=+l||1;a--;)fe.style(r,e,d+c),(1-n)*(1-(n=s()/l||.5))<=0&&(a=0),d=d/n;d=d*2,fe.style(r,e,d+c),t=t||[]}return t&&(d=+d||+l||0,o=t[1]?d+(t[1]+1)*t[2]:+t[2],i&&(i.unit=c,i.start=d,i.end=o)),o}function ry(){return!0}function iy(){return!1}function TZ(r,e){return r===MZ()==(e==="focus")}function MZ(){try{return Pa.activeElement}catch(r){}}function VP(r,e,t,i,o,n){var a,s;if(typeof e=="object"){typeof t!="string"&&(i=i||t,t=void 0);for(s in e)VP(r,s,t,i,e[s],n);return r}if(i==null&&o==null?(o=t,i=t=void 0):o==null&&(typeof t=="string"?(o=i,i=void 0):(o=i,i=t,t=void 0)),o===!1)o=iy;else if(!o)return r;return n===1&&(a=o,o=function(l){return fe().off(l),a.apply(this,arguments)},o.guid=a.guid||(a.guid=fe.guid++)),r.each(function(){fe.event.add(this,e,o,i,t)})}function KD(r,e,t){if(!t){en.get(r,e)===void 0&&fe.event.add(r,e,ry);return}en.set(r,e,!1),fe.event.add(r,e,{namespace:!1,handler:function(i){var o,n,a=en.get(this,e);if(i.isTrigger&1&&this[e]){if(a.length)(fe.event.special[e]||{}).delegateType&&i.stopPropagation();else if(a=BD.call(arguments),en.set(this,e,a),o=t(this,e),this[e](),n=en.get(this,e),a!==n||o?en.set(this,e,!1):n={},a!==n)return i.stopImmediatePropagation(),i.preventDefault(),n&&n.value}else a.length&&(en.set(this,e,{value:fe.event.trigger(fe.extend(a[0],fe.Event.prototype),a.slice(1),this)}),i.stopImmediatePropagation())}})}function Bv(r,e,t){var i,o,n,a,s=r.style;return t=t||$D(r),t&&(a=t.getPropertyValue(e)||t[e],a===""&&!X5(r)&&(a=fe.style(r,e)),!_a.pixelBoxStyles()&&_P.test(a)&&IZ.test(e)&&(i=s.width,o=s.minWidth,n=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=t.width,s.width=i,s.minWidth=o,s.maxWidth=n)),a!==void 0?a+"":a}function Q5(r,e){return{get:function(){if(r()){delete this.get;return}return(this.get=e).apply(this,arguments)}}}function AZ(r){for(var e=r[0].toUpperCase()+r.slice(1),t=O5.length;t--;)if(r=O5[t]+e,r in Z5)return r}function F5(r){var e=fe.cssProps[r]||R5[r];return e||(r in Z5?r:R5[r]=AZ(r)||r)}function eU(r,e,t){var i=WD.exec(e);return i?Math.max(0,i[2]-(t||0))+(i[3]||"px"):e}function LP(r,e,t,i,o,n){var a=e==="width"?1:0,s=0,l=0;if(t===(i?"border":"content"))return 0;for(;a<4;a+=2)t==="margin"&&(l+=fe.css(r,t+sg[a],!0,o)),i?(t==="content"&&(l-=fe.css(r,"padding"+sg[a],!0,o)),t!=="margin"&&(l-=fe.css(r,"border"+sg[a]+"Width",!0,o))):(l+=fe.css(r,"padding"+sg[a],!0,o),t!=="padding"?l+=fe.css(r,"border"+sg[a]+"Width",!0,o):s+=fe.css(r,"border"+sg[a]+"Width",!0,o));return!i&&n>=0&&(l+=Math.max(0,Math.ceil(r["offset"+e[0].toUpperCase()+e.slice(1)]-n-l-s-.5))||0),l}function U5(r,e,t){var i=$D(r),o=!_a.boxSizingReliable()||t,n=o&&fe.css(r,"boxSizing",!1,i)==="border-box",a=n,s=Bv(r,e,i),l="offset"+e[0].toUpperCase()+e.slice(1);if(_P.test(s)){if(!t)return s;s="auto"}return(!_a.boxSizingReliable()&&n||!_a.reliableTrDimensions()&&ey(r,"tr")||s==="auto"||!parseFloat(s)&&fe.css(r,"display",!1,i)==="inline")&&r.getClientRects().length&&(n=fe.css(r,"boxSizing",!1,i)==="border-box",a=l in r,a&&(s=r[l])),s=parseFloat(s)||0,s+LP(r,e,t||(n?"border":"content"),a,i,s)+"px"}function PP(r,e,t,i){var o;if(Array.isArray(e))fe.each(e,function(n,a){t||PZ.test(r)?i(r,a):PP(r+"["+(typeof a=="object"&&a!=null?n:"")+"]",a,t,i)});else if(!t&&HD(e)==="object")for(o in e)PP(r+"["+o+"]",e[o],t,i);else i(r,e)}var ju,gZ,BD,mZ,q5,fZ,qD,H5,UD,W5,bZ,_a,Yu,oy,Pa,$5,fe,yZ,j5,xZ,AP,Uv,wZ,vZ,zD,en,$u,EZ,SZ,Y5,WD,sg,ty,X5,kZ,IP,_5,_P,$D,J5,IZ,O5,Z5,R5,VZ,N5,LZ,B5,z5,K5,PZ,_Z,OZ,RZ,ie,qt=__dcg_shared_module_exports__['b'](()=>{"use strict";ju=[],gZ=Object.getPrototypeOf,BD=ju.slice,mZ=ju.flat?function(r){return ju.flat.call(r)}:function(r){return ju.concat.apply([],r)},q5=ju.push,fZ=ju.indexOf,qD={},H5=qD.toString,UD=qD.hasOwnProperty,W5=UD.toString,bZ=W5.call(Object),_a={},Yu=function(e){return typeof e=="function"&&typeof e.nodeType!="number"&&typeof e.item!="function"},oy=function(e){return e!=null&&e===e.window},Pa=window.document;$5="3.6.0",fe=function(r,e){return new fe.fn.init(r,e)};fe.fn=fe.prototype={jquery:$5,constructor:fe,length:0,toArray:function(){return BD.call(this)},get:function(r){return r==null?BD.call(this):r<0?this[r+this.length]:this[r]},pushStack:function(r){var e=fe.merge(this.constructor(),r);return e.prevObject=this,e},each:function(r){return fe.each(this,r)},map:function(r){return this.pushStack(fe.map(this,function(e,t){return r.call(e,t,e)}))},slice:function(){return this.pushStack(BD.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(fe.grep(this,function(r,e){return(e+1)%2}))},odd:function(){return this.pushStack(fe.grep(this,function(r,e){return e%2}))},eq:function(r){var e=this.length,t=+r+(r<0?e:0);return this.pushStack(t>=0&&t<e?[this[t]]:[])},end:function(){return this.prevObject||this.constructor()},push:q5,sort:ju.sort,splice:ju.splice};fe.extend=fe.fn.extend=function(){var r,e,t,i,o,n,a=arguments[0]||{},s=1,l=arguments.length,c=!1;for(typeof a=="boolean"&&(c=a,a=arguments[s]||{},s++),typeof a!="object"&&!Yu(a)&&(a={}),s===l&&(a=this,s--);s<l;s++)if((r=arguments[s])!=null)for(e in r)i=r[e],!(e==="__proto__"||a===i)&&(c&&i&&(fe.isPlainObject(i)||(o=Array.isArray(i)))?(t=a[e],o&&!Array.isArray(t)?n=[]:!o&&!fe.isPlainObject(t)?n={}:n=t,o=!1,a[e]=fe.extend(c,n,i)):i!==void 0&&(a[e]=i));return a};fe.extend({expando:"jQuery"+($5+Math.random()).replace(/\D/g,""),isReady:!0,error:function(r){throw new Error(r)},noop:function(){},isPlainObject:function(r){var e,t;return!r||H5.call(r)!=="[object Object]"?!1:(e=gZ(r),e?(t=UD.call(e,"constructor")&&e.constructor,typeof t=="function"&&W5.call(t)===bZ):!0)},isEmptyObject:function(r){var e;for(e in r)return!1;return!0},each:function(r,e){var t,i=0;if(MP(r))for(t=r.length;i<t&&e.call(r[i],i,r[i])!==!1;i++);else for(i in r)if(e.call(r[i],i,r[i])===!1)break;return r},makeArray:function(r,e){var t=e||[];return r!=null&&(MP(Object(r))?fe.merge(t,typeof r=="string"?[r]:r):q5.call(t,r)),t},inArray:function(r,e,t){return e==null?-1:fZ.call(e,r,t)},merge:function(r,e){for(var t=+e.length,i=0,o=r.length;i<t;i++)r[o++]=e[i];return r.length=o,r},grep:function(r,e,t){for(var i,o=[],n=0,a=r.length,s=!t;n<a;n++)i=!e(r[n],n),i!==s&&o.push(r[n]);return o},map:function(r,e,t){var i,o,n=0,a=[];if(MP(r))for(i=r.length;n<i;n++)o=e(r[n],n,t),o!=null&&a.push(o);else for(n in r)o=e(r[n],n,t),o!=null&&a.push(o);return mZ(a)},guid:1,support:_a});typeof Symbol=="function"&&(fe.fn[Symbol.iterator]=ju[Symbol.iterator]);fe.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(r,e){qD["[object "+e+"]"]=e.toLowerCase()});yZ=function(r){var e,t,i,o,n,a,s,l=r.document,c=[],d=c.push,p=c.push,g=c.slice,h=/HTML$/i,f=/^[^{]+\{\s*\[native \w/,y=function(){i()};try{p.apply(c=g.call(l.childNodes),l.childNodes),c[l.childNodes.length].nodeType}catch(C){p={apply:c.length?function(S,v){d.apply(S,g.call(v))}:function(S,v){for(var M=S.length,A=0;S[M++]=v[A++];);S.length=M-1}}}function x(){}function E(C){var S=o.createElement("fieldset");try{return!!C(S)}catch(v){return!1}finally{S.parentNode&&S.parentNode.removeChild(S),S=null}}return e=x.support={},t=x.isXML=function(C){var S=C&&C.namespaceURI,v=C&&(C.ownerDocument||C).documentElement;return!h.test(S||v&&v.nodeName||"HTML")},i=x.setDocument=function(C){var S,v,M=C?C.ownerDocument||C:l;return M==o||M.nodeType!==9||!M.documentElement||(o=M,n=o.documentElement,a=!t(o),l!=o&&(v=o.defaultView)&&v.top!==v&&(v.addEventListener?v.addEventListener("unload",y,!1):v.attachEvent&&v.attachEvent("onunload",y)),e.attributes=E(function(A){return A.className="i",!A.getAttribute("className")}),e.getElementsByTagName=E(function(A){return A.appendChild(o.createComment("")),!A.getElementsByTagName("*").length}),S=f.test(n.compareDocumentPosition),s=S||f.test(n.contains)?function(A,I){var P=A.nodeType===9?A.documentElement:A,_=I&&I.parentNode;return A===_||!!(_&&_.nodeType===1&&(P.contains?P.contains(_):A.compareDocumentPosition&&A.compareDocumentPosition(_)&16))}:function(A,I){if(I){for(;I=I.parentNode;)if(I===A)return!0}return!1}),o},x.contains=function(C,S){return(C.ownerDocument||C)!=o&&i(C),s(C,S)},i(),e.sortDetached=E(function(C){return C.compareDocumentPosition(o.createElement("fieldset"))&1}),x}(window);fe.contains=yZ.contains;xZ=fe.fn.init=function(r,e,t){if(!r)return this;if(t=t||j5,typeof r=="string")throw new Error("$(string) implementation has been removed");if(r.nodeType)return this[0]=r,this.length=1,this;if(Yu(r))throw new Error("$(function) implementation has been removed");return fe.makeArray(r,this)};xZ.prototype=fe.fn;j5=fe(Pa);AP=/[^\x20\t\r\n\f]+/g,Uv=function(r,e,t,i,o,n,a){var s=0,l=r.length,c=t==null;if(HD(t)==="object"){o=!0;for(s in t)Uv(r,e,s,t[s],!0,n,a)}else if(i!==void 0&&(o=!0,Yu(i)||(a=!0),c&&(a?(e.call(r,i),e=null):(c=e,e=function(d,p,g){return c.call(fe(d),g)})),e))for(;s<l;s++)e(r[s],t,a?i:i.call(r[s],s,e(r[s],t)));return o?r:c?e.call(r):l?e(r[0],t):n},wZ=/^-ms-/,vZ=/-([a-z])/g;zD=function(r){return r.nodeType===1||r.nodeType===9||!+r.nodeType};zv.uid=1;zv.prototype={cache:function(r){var e=r[this.expando];return e||(e={},zD(r)&&(r.nodeType?r[this.expando]=e:Object.defineProperty(r,this.expando,{value:e,configurable:!0}))),e},set:function(r,e,t){var i,o=this.cache(r);if(typeof e=="string")o[Wu(e)]=t;else for(i in e)o[Wu(i)]=e[i];return o},get:function(r,e){return e===void 0?this.cache(r):r[this.expando]&&r[this.expando][Wu(e)]},access:function(r,e,t){return e===void 0||e&&typeof e=="string"&&t===void 0?this.get(r,e):(this.set(r,e,t),t!==void 0?t:e)},remove:function(r,e){var t,i=r[this.expando];if(i!==void 0){if(e!==void 0)for(Array.isArray(e)?e=e.map(Wu):(e=Wu(e),e=e in i?[e]:e.match(AP)||[]),t=e.length;t--;)delete i[e[t]];(e===void 0||fe.isEmptyObject(i))&&(r.nodeType?r[this.expando]=void 0:delete r[this.expando])}},hasData:function(r){var e=r[this.expando];return e!==void 0&&!fe.isEmptyObject(e)}};en=new zv,$u=new zv,EZ=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,SZ=/[A-Z]/g;fe.extend({hasData:function(r){return $u.hasData(r)||en.hasData(r)},data:function(r,e,t){return $u.access(r,e,t)},removeData:function(r,e){$u.remove(r,e)},_data:function(r,e,t){return en.access(r,e,t)},_removeData:function(r,e){en.remove(r,e)}});fe.fn.extend({data:function(r,e){var t,i,o,n=this[0],a=n&&n.attributes;if(r===void 0){if(this.length&&(o=$u.get(n),n.nodeType===1&&!en.get(n,"hasDataAttrs"))){for(t=a.length;t--;)a[t]&&(i=a[t].name,i.indexOf("data-")===0&&(i=Wu(i.slice(5)),P5(n,i,o[i])));en.set(n,"hasDataAttrs",!0)}return o}return typeof r=="object"?this.each(function(){$u.set(this,r)}):Uv(this,function(s){var l;if(n&&s===void 0)return l=$u.get(n,r),l!==void 0||(l=P5(n,r),l!==void 0)?l:void 0;this.each(function(){$u.set(this,r,s)})},null,e,arguments.length>1,null,!0)},removeData:function(r){return this.each(function(){$u.remove(this,r)})}});Y5=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,WD=new RegExp("^(?:([+-])=|)("+Y5+")([a-z%]*)$","i"),sg=["Top","Right","Bottom","Left"],ty=Pa.documentElement,X5=function(r){return fe.contains(r.ownerDocument,r)},kZ={composed:!0};ty.getRootNode&&(X5=function(r){return fe.contains(r.ownerDocument,r)||r.getRootNode(kZ)===r.ownerDocument});IP=/^(?:checkbox|radio)$/i;(function(){var r=Pa.createDocumentFragment(),e=r.appendChild(Pa.createElement("div")),t=Pa.createElement("input");t.setAttribute("type","radio"),t.setAttribute("checked","checked"),t.setAttribute("name","t"),e.appendChild(t),_a.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",_a.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue,e.innerHTML="<option></option>",_a.option=!!e.lastChild})();_5=/^([^.]*)(?:\.(.+)|)/;fe.event={global:{},add:function(r,e,t,i,o){var n,a,s,l,c,d,p,g,h,f,y,x=en.get(r);if(zD(r)){if(t.handler&&(n=t,t=n.handler,o=n.selector),o)throw new Error("Support for event delegation has been removed");for(t.guid||(t.guid=fe.guid++),(l=x.events)||(l=x.events=Object.create(null)),(a=x.handle)||(a=x.handle=function(E){return typeof fe!="undefined"&&fe.event.triggered!==E.type?fe.event.dispatch.apply(r,arguments):void 0}),e=(e||"").match(AP)||[""],c=e.length;c--;)if(s=_5.exec(e[c])||[],h=y=s[1],f=(s[2]||"").split(".").sort(),!!h){if(p=fe.event.special[h]||{},h=(o?p.delegateType:p.bindType)||h,p=fe.event.special[h]||{},d=fe.extend({type:h,origType:y,data:i,handler:t,guid:t.guid,selector:o,namespace:f.join(".")},n),(g=l[h])||(g=l[h]=[],g.delegateCount=0,(!p.setup||p.setup.call(r,i,f,a)===!1)&&r.addEventListener&&r.addEventListener(h,a)),p.add&&(p.add.call(r,d),d.handler.guid||(d.handler.guid=t.guid)),o)throw new Error("Support for event delegation has been removed");g.push(d),fe.event.global[h]=!0}}},remove:function(r,e,t,i,o){var n,a,s,l,c,d,p,g,h,f,y,x=en.hasData(r)&&en.get(r);if(!(!x||!(l=x.events))){for(e=(e||"").match(AP)||[""],c=e.length;c--;){if(s=_5.exec(e[c])||[],h=y=s[1],f=(s[2]||"").split(".").sort(),!h){for(h in l)fe.event.remove(r,h+e[c],t,i,!0);continue}for(p=fe.event.special[h]||{},h=(i?p.delegateType:p.bindType)||h,g=l[h]||[],s=s[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=n=g.length;n--;)d=g[n],(o||y===d.origType)&&(!t||t.guid===d.guid)&&(!s||s.test(d.namespace))&&(!i||i===d.selector||i==="**"&&d.selector)&&(g.splice(n,1),d.selector&&g.delegateCount--,p.remove&&p.remove.call(r,d));a&&!g.length&&((!p.teardown||p.teardown.call(r,f,x.handle)===!1)&&fe.removeEvent(r,h,x.handle),delete l[h])}fe.isEmptyObject(l)&&en.remove(r,"handle events")}},dispatch:function(r){var e,t,i,o,n,a,s=new Array(arguments.length),l=fe.event.fix(r),c=(en.get(this,"events")||Object.create(null))[l.type]||[],d=fe.event.special[l.type]||{};for(s[0]=l,e=1;e<arguments.length;e++)s[e]=arguments[e];if(l.delegateTarget=this,!(d.preDispatch&&d.preDispatch.call(this,l)===!1)){for(a=fe.event.handlers.call(this,l,c),e=0;(o=a[e++])&&!l.isPropagationStopped();)for(l.currentTarget=o.elem,t=0;(n=o.handlers[t++])&&!l.isImmediatePropagationStopped();)(!l.rnamespace||n.namespace===!1||l.rnamespace.test(n.namespace))&&(l.handleObj=n,l.data=n.data,i=((fe.event.special[n.origType]||{}).handle||n.handler).apply(o.elem,s),i!==void 0&&(l.result=i)===!1&&(l.preventDefault(),l.stopPropagation()));return d.postDispatch&&d.postDispatch.call(this,l),l.result}},handlers:function(r,e){var t=[],i=e.delegateCount,o=r.target;if(i)throw new Error("Support for event delegtaion has been removed");return o=this,i<e.length&&t.push({elem:o,handlers:e.slice(i)}),t},addProp:function(r,e){Object.defineProperty(fe.Event.prototype,r,{enumerable:!0,configurable:!0,get:Yu(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[r]},set:function(t){Object.defineProperty(this,r,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(r){return r[fe.expando]?r:new fe.Event(r)},special:{load:{noBubble:!0},click:{setup:function(r){var e=this||r;return IP.test(e.type)&&e.click&&ey(e,"input")&&KD(e,"click",ry),!1},trigger:function(r){var e=this||r;return IP.test(e.type)&&e.click&&ey(e,"input")&&KD(e,"click"),!0},_default:function(r){var e=r.target;return IP.test(e.type)&&e.click&&ey(e,"input")&&en.get(e,"click")||ey(e,"a")}},beforeunload:{postDispatch:function(r){r.result!==void 0&&r.originalEvent&&(r.originalEvent.returnValue=r.result)}}}};fe.removeEvent=function(r,e,t){r.removeEventListener&&r.removeEventListener(e,t)};fe.Event=function(r,e){if(!(this instanceof fe.Event))return new fe.Event(r,e);r&&r.type?(this.originalEvent=r,this.type=r.type,this.isDefaultPrevented=r.defaultPrevented||r.defaultPrevented===void 0&&r.returnValue===!1?ry:iy,this.target=r.target&&r.target.nodeType===3?r.target.parentNode:r.target,this.currentTarget=r.currentTarget,this.relatedTarget=r.relatedTarget):this.type=r,e&&fe.extend(this,e),this.timeStamp=r&&r.timeStamp||Date.now(),this[fe.expando]=!0};fe.Event.prototype={constructor:fe.Event,isDefaultPrevented:iy,isPropagationStopped:iy,isImmediatePropagationStopped:iy,isSimulated:!1,preventDefault:function(){var r=this.originalEvent;this.isDefaultPrevented=ry,r&&!this.isSimulated&&r.preventDefault()},stopPropagation:function(){var r=this.originalEvent;this.isPropagationStopped=ry,r&&!this.isSimulated&&r.stopPropagation()},stopImmediatePropagation:function(){var r=this.originalEvent;this.isImmediatePropagationStopped=ry,r&&!this.isSimulated&&r.stopImmediatePropagation(),this.stopPropagation()}};fe.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},fe.event.addProp);fe.each({focus:"focusin",blur:"focusout"},function(r,e){fe.event.special[r]={setup:function(){return KD(this,r,TZ),!1},trigger:function(){return KD(this,r),!0},_default:function(){return!0},delegateType:e}});fe.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(r,e){fe.event.special[r]={delegateType:e,bindType:e,handle:function(t){var i,o=this,n=t.relatedTarget,a=t.handleObj;return(!n||n!==o&&!fe.contains(o,n))&&(t.type=a.origType,i=a.handler.apply(this,arguments),t.type=e),i}}});fe.fn.extend({on:function(r,e,t,i){return VP(this,r,e,t,i)},one:function(r,e,t,i){return VP(this,r,e,t,i,1)},off:function(r,e,t){var i,o;if(r&&r.preventDefault&&r.handleObj)return i=r.handleObj,fe(r.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if(typeof r=="object"){for(o in r)this.off(o,e,r[o]);return this}return(e===!1||typeof e=="function")&&(t=e,e=void 0),t===!1&&(t=iy),this.each(function(){fe.event.remove(this,r,t,e)})}});_P=new RegExp("^("+Y5+")(?!px)[a-z%]+$","i"),$D=function(r){var e=r.ownerDocument.defaultView;return(!e||!e.opener)&&(e=window),e.getComputedStyle(r)},J5=function(r,e,t){var i,o,n={};for(o in e)n[o]=r.style[o],r.style[o]=e[o];i=t.call(r);for(o in e)r.style[o]=n[o];return i},IZ=new RegExp(sg.join("|"),"i");(function(){function r(){if(c){l.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ty.appendChild(l).appendChild(c);var d=window.getComputedStyle(c);t=d.top!=="1%",s=e(d.marginLeft)===12,c.style.right="60%",n=e(d.right)===36,i=e(d.width)===36,c.style.position="absolute",o=e(c.offsetWidth/3)===12,ty.removeChild(l),c=null}}function e(d){return Math.round(parseFloat(d))}var t,i,o,n,a,s,l=Pa.createElement("div"),c=Pa.createElement("div");c.style&&(c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",_a.clearCloneStyle=c.style.backgroundClip==="content-box",fe.extend(_a,{boxSizingReliable:function(){return r(),i},pixelBoxStyles:function(){return r(),n},pixelPosition:function(){return r(),t},reliableMarginLeft:function(){return r(),s},scrollboxSize:function(){return r(),o},reliableTrDimensions:function(){var d,p,g,h;return a==null&&(d=Pa.createElement("table"),p=Pa.createElement("tr"),g=Pa.createElement("div"),d.style.cssText="position:absolute;left:-11111px;border-collapse:separate",p.style.cssText="border:1px solid",p.style.height="1px",g.style.height="9px",g.style.display="block",ty.appendChild(d).appendChild(p).appendChild(g),h=window.getComputedStyle(p),a=parseInt(h.height,10)+parseInt(h.borderTopWidth,10)+parseInt(h.borderBottomWidth,10)===p.offsetHeight,ty.removeChild(d)),a}}))})();O5=["Webkit","Moz","ms"],Z5=Pa.createElement("div").style,R5={};VZ=/^(none|table(?!-c[ea]).+)/,N5=/^--/,LZ={position:"absolute",visibility:"hidden",display:"block"},B5={letterSpacing:"0",fontWeight:"400"};fe.extend({cssHooks:{opacity:{get:function(r,e){if(e){var t=Bv(r,"opacity");return t===""?"1":t}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(r,e,t,i){if(!(!r||r.nodeType===3||r.nodeType===8||!r.style)){var o,n,a,s=Wu(e),l=N5.test(e),c=r.style;if(l||(e=F5(s)),a=fe.cssHooks[e]||fe.cssHooks[s],t!==void 0){if(n=typeof t,n==="string"&&(o=WD.exec(t))&&o[1]&&(t=GZ(r,e,o),n="number"),t==null||t!==t)return;n==="number"&&!l&&(t+=o&&o[3]||(fe.cssNumber[s]?"":"px")),!_a.clearCloneStyle&&t===""&&e.indexOf("background")===0&&(c[e]="inherit"),(!a||!("set"in a)||(t=a.set(r,t,i))!==void 0)&&(l?c.setProperty(e,t):c[e]=t)}else return a&&"get"in a&&(o=a.get(r,!1,i))!==void 0?o:c[e]}},css:function(r,e,t,i){var o,n,a,s=Wu(e),l=N5.test(e);return l||(e=F5(s)),a=fe.cssHooks[e]||fe.cssHooks[s],a&&"get"in a&&(o=a.get(r,!0,t)),o===void 0&&(o=Bv(r,e,i)),o==="normal"&&e in B5&&(o=B5[e]),t===""||t?(n=parseFloat(o),t===!0||isFinite(n)?n||0:o):o}});fe.each(["height","width"],function(r,e){fe.cssHooks[e]={get:function(t,i,o){if(i)return VZ.test(fe.css(t,"display"))&&(!t.getClientRects().length||!t.getBoundingClientRect().width)?J5(t,LZ,function(){return U5(t,e,o)}):U5(t,e,o)},set:function(t,i,o){var n,a=$D(t),s=!_a.scrollboxSize()&&a.position==="absolute",l=s||o,c=l&&fe.css(t,"boxSizing",!1,a)==="border-box",d=o?LP(t,e,o,c,a):0;return c&&s&&(d-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(a[e])-LP(t,e,"border",!1,a)-.5)),d&&(n=WD.exec(i))&&(n[3]||"px")!=="px"&&(t.style[e]=i,i=fe.css(t,e)),eU(t,i,d)}}});fe.cssHooks.marginLeft=Q5(_a.reliableMarginLeft,function(r,e){if(e)return(parseFloat(Bv(r,"marginLeft"))||r.getBoundingClientRect().left-J5(r,{marginLeft:0},function(){return r.getBoundingClientRect().left}))+"px"});fe.each({margin:"",padding:"",border:"Width"},function(r,e){fe.cssHooks[r+e]={expand:function(t){for(var i=0,o={},n=typeof t=="string"?t.split(" "):[t];i<4;i++)o[r+sg[i]+e]=n[i]||n[i-2]||n[0];return o}},r!=="margin"&&(fe.cssHooks[r+e].set=eU)});fe.fn.extend({css:function(r,e){return Uv(this,function(t,i,o){var n,a,s={},l=0;if(Array.isArray(i)){for(n=$D(t),a=i.length;l<a;l++)s[i[l]]=fe.css(t,i[l],!1,n);return s}return o!==void 0?fe.style(t,i,o):fe.css(t,i)},r,e,arguments.length>1)}});(function(){var r=Pa.createElement("input"),e=Pa.createElement("select"),t=e.appendChild(Pa.createElement("option"));r.type="checkbox",_a.checkOn=r.value!=="",_a.optSelected=t.selected,r=Pa.createElement("input"),r.value="t",r.type="radio",_a.radioValue=r.value==="t"})();_a.focusin="onfocusin"in window;z5=/^(?:focusinfocus|focusoutblur)$/,K5=function(r){r.stopPropagation()};fe.extend(fe.event,{trigger:function(r,e,t,i){var o,n,a,s,l,c,d,p,g=[t||Pa],h=UD.call(r,"type")?r.type:r,f=UD.call(r,"namespace")?r.namespace.split("."):[];if(n=p=a=t=t||Pa,!(t.nodeType===3||t.nodeType===8)&&!z5.test(h+fe.event.triggered)&&(h.indexOf(".")>-1&&(f=h.split("."),h=f.shift(),f.sort()),l=h.indexOf(":")<0&&"on"+h,r=r[fe.expando]?r:new fe.Event(h,typeof r=="object"&&r),r.isTrigger=i?2:3,r.namespace=f.join("."),r.rnamespace=r.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,r.result=void 0,r.target||(r.target=t),e=e==null?[r]:fe.makeArray(e,[r]),d=fe.event.special[h]||{},!(!i&&d.trigger&&d.trigger.apply(t,e)===!1))){if(!i&&!d.noBubble&&!oy(t)){for(s=d.delegateType||h,z5.test(s+h)||(n=n.parentNode);n;n=n.parentNode)g.push(n),a=n;a===(t.ownerDocument||Pa)&&g.push(a.defaultView||a.parentWindow||window)}for(o=0;(n=g[o++])&&!r.isPropagationStopped();)p=n,r.type=o>1?s:d.bindType||h,c=(en.get(n,"events")||Object.create(null))[r.type]&&en.get(n,"handle"),c&&c.apply(n,e),c=l&&n[l],c&&c.apply&&zD(n)&&(r.result=c.apply(n,e),r.result===!1&&r.preventDefault());return r.type=h,!i&&!r.isDefaultPrevented()&&(!d._default||d._default.apply(g.pop(),e)===!1)&&zD(t)&&l&&Yu(t[h])&&!oy(t)&&(a=t[l],a&&(t[l]=null),fe.event.triggered=h,r.isPropagationStopped()&&p.addEventListener(h,K5),t[h](),r.isPropagationStopped()&&p.removeEventListener(h,K5),fe.event.triggered=void 0,a&&(t[l]=a)),r.result}},simulate:function(r,e,t){var i=fe.extend(new fe.Event,t,{type:r,isSimulated:!0});fe.event.trigger(i,null,e)}});fe.fn.extend({trigger:function(r,e){return this.each(function(){fe.event.trigger(r,e,this)})},triggerHandler:function(r,e){var t=this[0];if(t)return fe.event.trigger(r,e,t,!0)}});_a.focusin||fe.each({focus:"focusin",blur:"focusout"},function(r,e){var t=function(i){fe.event.simulate(e,i.target,fe.event.fix(i))};fe.event.special[e]={setup:function(){var i=this.ownerDocument||this.document||this,o=en.access(i,e);o||i.addEventListener(r,t,!0),en.access(i,e,(o||0)+1)},teardown:function(){var i=this.ownerDocument||this.document||this,o=en.access(i,e)-1;o?en.access(i,e,o):(i.removeEventListener(r,t,!0),en.remove(i,e))}}});PZ=/\[\]$/;fe.param=function(r,e){var t,i=[],o=function(n,a){var s=Yu(a)?a():a;i[i.length]=encodeURIComponent(n)+"="+encodeURIComponent(s==null?"":s)};if(r==null)return"";if(Array.isArray(r)||r.jquery&&!fe.isPlainObject(r))fe.each(r,function(){o(this.name,this.value)});else for(t in r)PP(t,r[t],e,o);return i.join("&")};fe.offset={setOffset:function(r,e,t){var i,o,n,a,s,l,c,d=fe.css(r,"position"),p=fe(r),g={};d==="static"&&(r.style.position="relative"),s=p.offset(),n=fe.css(r,"top"),l=fe.css(r,"left"),c=(d==="absolute"||d==="fixed")&&(n+l).indexOf("auto")>-1,c?(i=p.position(),a=i.top,o=i.left):(a=parseFloat(n)||0,o=parseFloat(l)||0),Yu(e)&&(e=e.call(r,t,fe.extend({},s))),e.top!=null&&(g.top=e.top-s.top+a),e.left!=null&&(g.left=e.left-s.left+o),"using"in e?e.using.call(r,g):p.css(g)}};fe.fn.extend({offset:function(r){if(arguments.length)return r===void 0?this:this.each(function(o){fe.offset.setOffset(this,r,o)});var e,t,i=this[0];if(i)return i.getClientRects().length?(e=i.getBoundingClientRect(),t=i.ownerDocument.defaultView,{top:e.top+t.pageYOffset,left:e.left+t.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var r,e,t,i=this[0],o={top:0,left:0};if(fe.css(i,"position")==="fixed")e=i.getBoundingClientRect();else{for(e=this.offset(),t=i.ownerDocument,r=i.offsetParent||t.documentElement;r&&(r===t.body||r===t.documentElement)&&fe.css(r,"position")==="static";)r=r.parentNode;r&&r!==i&&r.nodeType===1&&(o=fe(r).offset(),o.top+=fe.css(r,"borderTopWidth",!0),o.left+=fe.css(r,"borderLeftWidth",!0))}return{top:e.top-o.top-fe.css(i,"marginTop",!0),left:e.left-o.left-fe.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var r=this.offsetParent;r&&fe.css(r,"position")==="static";)r=r.offsetParent;return r||ty})}});fe.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(r,e){var t=e==="pageYOffset";fe.fn[r]=function(i){return Uv(this,function(o,n,a){var s;if(oy(o)?s=o:o.nodeType===9&&(s=o.defaultView),a===void 0)return s?s[e]:o[n];s?s.scrollTo(t?s.pageXOffset:a,t?a:s.pageYOffset):o[n]=a},r,i,arguments.length)}});fe.each(["top","left"],function(r,e){fe.cssHooks[e]=Q5(_a.pixelPosition,function(t,i){if(i)return i=Bv(t,e),_P.test(i)?fe(t).position()[e]+"px":i})});fe.each({Height:"height",Width:"width"},function(r,e){fe.each({padding:"inner"+r,content:e,"":"outer"+r},function(t,i){fe.fn[i]=function(o,n){var a=arguments.length&&(t||typeof o!="boolean"),s=t||(o===!0||n===!0?"margin":"border");return Uv(this,function(l,c,d){var p;return oy(l)?i.indexOf("outer")===0?l["inner"+r]:l.document.documentElement["client"+r]:l.nodeType===9?(p=l.documentElement,Math.max(l.body["scroll"+r],p["scroll"+r],l.body["offset"+r],p["offset"+r],p["client"+r])):d===void 0?fe.css(l,c,s):fe.style(l,c,d,s)},e,a?o:void 0,a)}})});fe.fn.extend({bind:function(r,e,t){return this.on(r,null,e,t)},unbind:function(r,e){return this.off(r,null,e)},delegate:function(r,e,t,i){return this.on(e,r,t,i)},undelegate:function(r,e,t){return arguments.length===1?this.off(r,"**"):this.off(e,r||"**",t)},hover:function(r,e){return this.mouseenter(r).mouseleave(e||r)}});fe.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(r,e){fe.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}});_Z=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;fe.isArray=Array.isArray;fe.parseJSON=JSON.parse;fe.nodeName=ey;fe.isFunction=Yu;fe.isWindow=oy;fe.camelCase=Wu;fe.type=HD;fe.now=Date.now;fe.isNumeric=function(r){var e=fe.type(r);return(e==="number"||e==="string")&&!isNaN(r-parseFloat(r))};fe.trim=function(r){return r==null?"":(r+"").replace(_Z,"")};OZ=window.jQuery,RZ=window.$;fe.noConflict=function(r){return window.$===fe&&(window.$=RZ),r&&window.jQuery===fe&&(window.jQuery=OZ),fe};typeof noGlobal=="undefined"&&(window.jQuery=window.$=fe);ie=fe});var tn,Rc=__dcg_shared_module_exports__['b'](()=>{tn=()=>(typeof location!="undefined"?location.search.slice(1):"").split("&").reduce((e,t)=>{let[i,o]=t.split("=");return e[i]=o?decodeURIComponent(o):!0,e},{})});function HU(r,e){if(e!=null){if(typeof r!="string")throw new Error("Must pass a string for an EventHandler name");if(typeof e!="function")throw new Error("Must pass a function for an EventHandler callback");return{bindings:{onMount:t=>{t[r.toLowerCase()]=(i,...o)=>{i&&e.apply(t,[i,...o])}}}}}}var WU=__dcg_shared_module_exports__['b'](()=>{});function gk(r){let e=()=>r;return e.isDCGViewConst=!0,e}function ns(r){return typeof r=="function"&&r.isDCGViewConst}var Ld=__dcg_shared_module_exports__['b'](()=>{});function mk(r,e,t){return t===void 0?r.removeAttribute(e):r.setAttribute(e,`${t}`)}var t_=__dcg_shared_module_exports__['b'](()=>{});function $U(r,e){let t=e(),i;return ns(e)||(i={onUpdate:o=>{let n=e();n!==t&&(t=n,mk(o,r,n))}}),{value:t,bindings:i}}var jU=__dcg_shared_module_exports__['b'](()=>{Ld();t_()});function YU(r){return r.startsWith("on")&&r[2]===r[2].toUpperCase()}var XU=__dcg_shared_module_exports__['b'](()=>{});function JU(r,e){r_[r]=e}function QU(r){return r_.hasOwnProperty(r)}function ZU(r,e){let t=r_[r];return t(e)}var r_,i_=__dcg_shared_module_exports__['b'](()=>{r_={}});function fk(r,e,t){let i=r._bindings[e];r._bindings[e]=i?[...i,t]:[t]}function Pd(r,e){var i;((i=r._bindings[e])!=null?i:[]).forEach(o=>o())}var Qv=__dcg_shared_module_exports__['b'](()=>{});function ez(r){Zv.push(r)}function tz(r){let e=Zv.filter(t=>t!==r);Zv.length=0,Zv.push(...e)}function mg(r,e){try{if(e&&e._isDCGView){r+=` [${e._viewName}]`;let t=e.traceViewHierarchy();t.ancestors.length>0&&(r+=`
View Hierarchy:
${t.formatted}`)}throw new Error(r)}catch(t){console.warn(t),Zv.forEach(i=>i(t))}}var Zv,eC=__dcg_shared_module_exports__['b'](()=>{Zv=[]});function Tee(r,e,t){let i=!1;return(...o)=>{if(i){mg(`${r} is a one-time binding but was called multiple times`,t);return}i=!0,e(...o)}}function Mee(r,e,t){let{bindings:i}=t;i&&Object.keys(i).forEach(o=>{let n=i[o];kee[o]&&(n=n.bind(null,e)),Gee[o]&&(n=Tee(o,n,r)),fk(r,o,n)})}function Iee(r,e){if(typeof e!="function")throw new Error(`The "${r}" attr must be a function. It is: ${JSON.stringify(e)}`);return QU(r)?ZU(r,e):YU(r)?HU(r,e):$U(r,e)}function rz(r,e,t){e&&Object.keys(e).forEach(i=>{let o=Iee(i,e[i]);if(!o)return;let{value:n}=o;n!==void 0&&t.setAttribute(i,n),o.bindings&&Mee(r,t,o)})}var kee,Gee,iz=__dcg_shared_module_exports__['b'](()=>{WU();jU();XU();i_();Qv();eC();kee={onMount:!0,didMount:!0,willUnmount:!0,willUpdate:!0,onUpdate:!0,didUpdate:!0},Gee={willMount:!0,onMount:!0,didMount:!0,willUnmount:!0,onUnmount:!0,didUnmount:!0}});function nz(){oz=!0}function az(r,e,t){var n;if(typeof t!="function")throw new Error("bindText expects a function");let i=(n=t())!=null?n:"",o=document.createTextNode(i);if(oz){let a=document.createElement("span");a.appendChild(o),e.appendChild(a)}else e.appendChild(o);fk(r,"onUpdate",()=>{var s;let a=(s=t())!=null?s:"";i!==a&&(o.nodeValue=a,i=a)})}var oz,o_=__dcg_shared_module_exports__['b'](()=>{Qv();oz=!1});var sz,bk,lz=__dcg_shared_module_exports__['b'](()=>{iz();o_();Ld();eC();sz=(r,e)=>{let t=document.createTextNode(e);r.appendChild(t)},bk=class{constructor(e,t,i){this._isDCGElement=!0,this.tagName=e,this.attrs=t,this.children=i,Array.isArray(this.children)&&this.children.forEach(o=>{let n=typeof o;(n==="object"||n==="function")&&(o._parentElement=this)})}renderToDocFrag(e,t){if(this._domNode)throw new Error("Cannot remount a DCGElement");let i=document.createElement(this.tagName);this._domNode=i,rz(t,this.attrs,i),e.appendChild(i),this.children.forEach(o=>{o._isDCGElement?o.renderToDocFrag(i,t):ns(o)?sz(i,o()):typeof o=="function"?az(t,i,o):(mg("Text should be a const or a getter: "+JSON.stringify(o),t),sz(i,o))})}}});function cz(r,e){r!=null&&(Array.isArray(r)?r.forEach(t=>cz(t,e)):e.push(r))}function ql(r,e,...t){let i=[];if(t.forEach(o=>cz(o,i)),typeof r=="string")return new bk(r,e,i);if(r&&r._isDCGViewClass)return new r(e,i)._construct();throw new Error("createElement expects a String or DCGViewClass")}var Ey=__dcg_shared_module_exports__['b'](()=>{lz()});function dz(){let r=this._element;for(;r._isDCGView;)r=r._element;return r._domNode}function pz(r,e){if(e&&e._childViews.push(this),this.__generatedHTMLBefore)throw new Error("Cannot remount a DCGView");this.__generatedHTMLBefore=!0,this._element.renderToDocFrag(r,this),Array.isArray(this._siblingElements)&&this._siblingElements.forEach(t=>t.renderToDocFrag(r,this))}function uz(r,e,t){if(!r||!r._isDCGViewClass)throw new Error("Must pass a DCGView class to be mounted");if(!e||e.nodeType!==1)throw new Error("Must pass an HTMLElement for the node");if(e._mountedDCGView)throw new Error("This node is already mounted by a view");let i=new r(t)._construct(),o=document.createDocumentFragment();return i.renderToDocFrag(o),e.innerHTML="",zc(i),e._mountedDCGView=i,e.appendChild(o),Kc(i),qc(i),i}function hz(r){let e=r._mountedDCGView;if(!e)throw new Error("This node is not mounted by a DCGView");Hc(e),r.innerHTML="",delete r._mountedDCGView,Wc(e),$c(e)}function zc(r){r.willMount&&r.willMount(),Pd(r,"willMount"),r._childViews.forEach(zc)}function Kc(r){r._isMounted=!0,r.onMount&&r.onMount(),Pd(r,"onMount"),r._childViews.forEach(Kc)}function qc(r){r.didMount&&r.didMount(),Pd(r,"didMount"),r._childViews.forEach(qc)}function Hc(r){r.willUnmount&&r.willUnmount(),Pd(r,"willUnmount"),r._childViews.forEach(Hc)}function Wc(r){r._isMounted=!1,r._childViews.forEach(Wc),Pd(r,"onUnmount"),r.onUnmount&&r.onUnmount()}function $c(r){r._childViews.forEach($c),Pd(r,"didUnmount"),r.didUnmount&&r.didUnmount()}function Ap(r,e){let t=document.createDocumentFragment();return r.renderToDocFrag(t,e),t.firstChild}var fg=__dcg_shared_module_exports__['b'](()=>{Qv()});function gz(){if(!this._isMounted)return mg("Trying to update view that is not mounted. Ignoring update.",this);this.shouldUpdate&&!this.shouldUpdate()||(this.willUpdate&&this.willUpdate(),Pd(this,"willUpdate"),Pd(this,"onUpdate"),this.onUpdate&&this.onUpdate(),this.overrideChildUpdates?this.overrideChildUpdates():this._childViews.forEach(r=>r.update()),Pd(this,"didUpdate"),this.didUpdate&&this.didUpdate())}var mz=__dcg_shared_module_exports__['b'](()=>{Qv();eC()});var yk,n_=__dcg_shared_module_exports__['b'](()=>{yk=(r,...e)=>Object.assign(r,...e)});function Do(r){if(!r)throw new Error("must pass a spec to DCGView.createClass");if(typeof r.template!="function")throw new Error("must pass a template function to DCGView.createClass");function e(t,i){var o,n;this._isDCGView=!0,this._isDCGElement=!0,this._viewName=r.viewName||((n=(o=this.constructor)==null?void 0:o.name)!=null?n:"Anonymous DCGView"),Object.entries(t!=null?t:{}).forEach(([a,s])=>{if(typeof s!="function"&&s!==void 0)throw new Error(`The "${a}" prop must be a function. It is: ${JSON.stringify(s)}`)}),this.props=t!=null?t:{},this.children=i,this._childViews=[],this._bindings={}}e.prototype._construct=function(){var t;if((t=this.init)==null||t.call(this),this._element=this.template(),!this._element||!this._element._isDCGElement)throw new Error("template() must return a DCGElement");return this._element._parentElement=this,this},e.prototype.bindFn=function(t){return t.bind(this)},e.prototype.bindIfMounted=function(t){return this.bindFn(function(...i){if(this._isMounted)return t.apply(this,i)})},e.prototype.traceViewHierarchy=function(){let t=[],i=this._parentElement;for(;i;)t.unshift(i),i=i._parentElement;let o=a=>a._isDCGView&&!(a._isDCGSwitch&&a._parentElement&&a._parentElement._isDCGIf)&&!a._isDCGIfDefinedWrapper&&!a._isDCGSwitchWrapper&&!a._isDCGSwitchUnionWrapper,n=[...t,this].filter(o).map((a,s)=>"  ".repeat(s)+"<"+a._viewName+">").join(`
`);return{ancestors:t,formatted:n}},e.prototype.findRootNode=dz,e.prototype.renderToDocFrag=pz,e.prototype.const=gk,e.prototype.spread=yk,e.prototype.createElement=ql,e.prototype.update=gz;for(let t in r)if(r.hasOwnProperty(t)){if(e.prototype.hasOwnProperty(t))throw new Error("Cannot override the "+t+"() method");e.prototype[t]=r[t]}return e._isDCGViewClass=!0,e}var jc=__dcg_shared_module_exports__['b'](()=>{Ey();fg();mz();Ld();n_()});function fz(r){let e=r(),t=typeof e;if(t==="string")return e;if(!t||t!=="object")throw new Error(`Unsupported type returned from style getter: ${t}`);return Object.entries(e).filter(([i,o])=>e.hasOwnProperty(i)&&o!==null&&o!==void 0).map(([i,o])=>`${i}:${o}`).join(";")}function bz(r){let e=fz(r),t=ns(r)?void 0:{onUpdate:i=>{let o=fz(r);e!==o&&(mk(i,"style",o),e=o)}};return{value:e,bindings:t}}var yz=__dcg_shared_module_exports__['b'](()=>{Ld();t_()});function xz(r){let e=r(),t=typeof e;if(t==="string")return e;if(!t||t!=="object")throw new Error(`Unsupported type returned from class getter: ${t}`);return Object.keys(e).filter(i=>e.hasOwnProperty(i)&&e[i]).join(" ")}function Aee(r,e,t){let i=r.className.replace(wz,"").split(vz),n=e.replace(wz,"").split(vz).reduce((s,l)=>(s[l]=!0,s),{}),a=i.filter(s=>!n.hasOwnProperty(s));return t?`${t} ${a.join(" ")}`.trim():a.join(" ")}function Cz(r){let e=xz(r),t=ns(r)?void 0:{onUpdate:i=>{let o=xz(r);e!==o&&(i.className=i.className===e?o:Aee(i,e,o),e=o)}};return{value:e,bindings:t}}var wz,vz,Ez=__dcg_shared_module_exports__['b'](()=>{Ld();wz=/^\s+|\s+$/g,vz=/\s+/});function Sz(r){return e=>{if(typeof e!="function")throw new Error(`The ${r} attribute expects a function for the value`);if(ns(e))throw new Error(`The ${r} attribute does not expect a const for the value`);return{bindings:{[r]:e}}}}var Dz=__dcg_shared_module_exports__['b'](()=>{Ld()});var kz,Gz=__dcg_shared_module_exports__['b'](()=>{kz=r=>{let e=r.length,t=new Array(e),i=new Array(e+1),o=0,n;for(let l=0;l<e;l++){if(r[i[o]]<r[l])n=o+1;else{let c=1,d=o-1;for(;c<=d;){let p=Math.ceil((c+d)/2);r[i[p]]<r[l]?c=p+1:d=p-1}n=c}t[l]=i[n-1],i[n]=l,n>o&&(o=n)}let a=new Array(o),s=i[o];for(let l=o-1;l>=0;l--)a[l]=r[s],s=t[s];return a}});function xk(r,e){let t=e.reduce((l,c,d)=>(l[c]=d,l),{}),i=r.filter(l=>t[l]===void 0),o=r.map(l=>t[l]).filter(l=>l!==void 0),a=kz(o).reduce((l,c)=>(l[e[c]]=!0,l),{}),s=e.reduceRight((l,c,d)=>(a[c]||l.push({key:c,beforeKey:e[d+1]}),l),[]);return{removes:i,inserts:s}}var a_=__dcg_shared_module_exports__['b'](()=>{Gz()});function Tz(r,e){return ql(Pee,{items:r,keyFunction:e.key,viewFunction:e.item})}var Vee,Lee,Pee,Mz=__dcg_shared_module_exports__['b'](()=>{jc();a_();Ey();fg();Vee=Do({viewName:"EachPlaceholder",_isDCGEachPlaceholder:!0,template(){return this.createElement("div",{style:this.const("display: none")})}}),Lee=Do({viewName:"EachWrapper",_isDCGEachWrapper:!0,template(){return this.children[0]}}),Pee=Do({viewName:"Each",_isDCGEach:!0,getKeys(){this._keyToItem={};let r=this.props.items(),e=this.props.keyFunction?r.map(this.props.keyFunction):[...r];if(!this._chosenKeyType&&e.length&&(this._chosenKeyType=typeof e[0],this._chosenKeyType!=="string"&&this._chosenKeyType!=="number"))throw new Error(`The key: ${JSON.stringify(e[0])} is not a string or number`);return e.forEach((t,i)=>{if(typeof t!==this._chosenKeyType)throw new Error(`Keys must be the same type. ${JSON.stringify(t)} is not a ${this._chosenKeyType}`);if(this._keyToItem[t])throw new Error(`The key: ${JSON.stringify(t)} is not unique`);this._keyToItem[t]=r[i]}),e},createViewForKey(r){let e=this._keyToItem[r],t=this.props.viewFunction(e,r),i=t;return i._isDCGView||(i=ql(Lee,null,t)),this._keyToView[r]=i,i},template(){return this._keyToView={},this._keys=this.getKeys(),this._element=ql(Vee,null),this._siblingElements=this._keys.map(r=>{let e=this.createViewForKey(r);return e._parentElement=this._element._parentElement,e}),this._element},detachAllRemovedViews(){let r=this._childViews,e=0;for(let t=0;t<r.length;t++){let i=r[t];i._will_be_unmounted_?e++:r[t-e]=i}r.splice(r.length-e,e)},overrideChildUpdates(){let r=this._keys,e=this.getKeys();this._keys=e;let t=this._element.findRootNode().parentNode,i=xk(r,e),o=[];for(let a=i.removes.length-1;a>=0;a--){let s=i.removes[a],l=this._keyToView[s];Hc(l),delete this._keyToView[s],l._will_be_unmounted_=!0,t.removeChild(l.findRootNode()),o.push(l)}o.length>0&&(this.detachAllRemovedViews(),o.forEach(Wc),o.forEach($c));let n=[];for(let a=i.inserts.length-1;a>=0;a--){let s=i.inserts[a].key;if(s in this._keyToView)continue;let l=this.createViewForKey(s);Ap(l,this),n.push(l)}n.forEach(zc),i.inserts.forEach(a=>{let s=this._keyToView[a.key].findRootNode(),l=a.beforeKey!==void 0?this._keyToView[a.beforeKey].findRootNode():null;t.insertBefore(s,l)}),n.forEach(Kc),n.forEach(qc);for(let a=0;a<this._childViews.length-n.length;a++)this._childViews[a].update()}})});var _ee,Iz,Az=__dcg_shared_module_exports__['b'](()=>{jc();a_();Ld();fg();_ee=Do({viewName:"ForWrapper",template:function(){return this.children[0]}}),Iz=Do({viewName:"For",_isDCGFor:!0,getKeys(){this._keyToItem={};let r=this.props.each();if(!Array.isArray(r))throw new Error("<For each={}> must return an array");let e=this.props.key?r.map(this.props.key):[...r];if(!this._chosenKeyType&&e.length&&(this._chosenKeyType=typeof e[0],this._chosenKeyType!=="string"&&this._chosenKeyType!=="number"))throw new Error(`The key: ${JSON.stringify(e[0])} is not a string or number`);return e.forEach((t,i)=>{if(typeof t!==this._chosenKeyType)throw new Error(`Keys must be the same type. ${JSON.stringify(t)} is not a ${this._chosenKeyType}`);if(t in this._keyToItem)throw new Error(`The key: ${JSON.stringify(t)} is not unique`);this._keyToItem[t]=r[i]}),e},createViewForKey(r){let e=this._keyToItem[r],t=this._viewFunction.call(this,e,r),i=t;return i._isDCGView||(i=this.createElement(_ee,null,t)),this._keyToView[r]=i,i},template(){if(this._keyToView={},typeof this.props.each!="function")throw new Error("<For each={}> must be a function");if(this.children.length!==1)throw new Error(`<For> expects a single child. You passed ${this.children.length}`);let r=this.children[0];if(!r||!r._isDCGElement)throw new Error(`<For> expects the root node to be a DCGElement. You passed ${JSON.stringify(r)}`);if(r._isDCGView)throw new Error("<For> expects the root node to not be a DCGView. Pass in something like <div> or <span>");if(r.children.length!==1)throw new Error(`<For> expects a root node with a single child. You passed ${r.children.length}`);if(this._viewFunction=r.children[0],this._viewFunction&&this._viewFunction._isDCGElement)throw new Error("<For> expects a function that constructs a DCGElement. You passed a DCGElement directly");if(typeof this._viewFunction!="function"){let t=JSON.stringify(this._viewFunction);throw new Error(`<For> expects a function that constructs a DCGElement. You passed ${t}`)}if(ns(this._viewFunction))throw new Error("<For> expects a function that constructs a DCGElement. You passed a constant");this._keys=this.getKeys();let e=this._keys.map(t=>{let i=this.createViewForKey(t);return i._parentElement=this,i});return r.children=e,r},detachAllRemovedViews(){let r=this._childViews,e=0;for(let t=0;t<r.length;t++){let i=r[t];i._will_be_unmounted_?e++:r[t-e]=i}r.splice(r.length-e,e)},overrideChildUpdates(){let r=this._keys,e=this.getKeys();this._keys=e;let t=this.findRootNode(),i=xk(r,e),o=[];for(let a=i.removes.length-1;a>=0;a--){let s=i.removes[a],l=this._keyToView[s];Hc(l),delete this._keyToView[s],l._will_be_unmounted_=!0,t.removeChild(l.findRootNode()),o.push(l)}o.length>0&&(this.detachAllRemovedViews(),o.forEach(Wc),o.forEach($c));let n=[];for(let a=i.inserts.length-1;a>=0;a--){let s=i.inserts[a].key;if(s in this._keyToView)continue;let l=this.createViewForKey(s);Ap(l,this),n.push(l)}n.forEach(zc),i.inserts.forEach(a=>{let s=this._keyToView[a.key].findRootNode(),l=a.beforeKey!==void 0?this._keyToView[a.beforeKey].findRootNode():null;t.insertBefore(s,l)}),n.forEach(Kc),n.forEach(qc);for(let a=0;a<this._childViews.length-n.length;a++)this._childViews[a].update()}})});var Oee,wk,s_=__dcg_shared_module_exports__['b'](()=>{jc();Ld();fg();Oee=Do({viewName:"SwitchWrapper",_isDCGSwitchWrapper:!0,template(){return this.children[0]}}),wk=Do({viewName:"Switch",_isDCGSwitch:!0,updateKey(){this._key=this.props.key()},createView(){let r=this._viewFunction(this._key);r=r!=null?r:this.createElement("div",{style:this.const("display: none")});let e=this.createElement(Oee,null,r);return e._parentElement=this,e},template(){if(this._key=void 0,typeof this.props.key!="function")throw new Error("<Switch key={}> must be a function");if(this.children.length!==1)throw new Error("<Switch> expects a single child. You passed "+this.children.length);if(this._viewFunction=this.children[0],this._viewFunction&&this._viewFunction._isDCGElement)throw new Error("<Switch> expects a function that constructs a DCGElement. You passed a DCGElement directly");if(typeof this._viewFunction!="function"){let r=JSON.stringify(this._viewFunction);throw new Error("<Switch> expects a function that constructs a DCGElement. You passed "+r)}if(ns(this._viewFunction))throw new Error("<Switch> expects a function that constructs a DCGElement. You passed a constant");return this.updateKey(),this.createView()},overrideChildUpdates(){let r=this._key;this.updateKey();let e=this._key;if(r===e){this._element.update();return}let t=this.findRootNode(),i=document.createTextNode("");t.parentNode.insertBefore(i,t),Hc(this._element),this._childViews=[],t.parentNode.removeChild(t),Wc(this._element),$c(this._element),this._element=this.createView();let o=Ap(this._element,this);zc(this._element),i.parentNode.insertBefore(o,i),i.parentNode.removeChild(i),Kc(this._element),qc(this._element)}})});function vk(r,e){return typeof r=="string"?Vz.bind(this,r,e):Vz(void 0,r,e)}var Ree,Fee,Vz,l_=__dcg_shared_module_exports__['b'](()=>{jc();fg();Ey();Ree=Do({viewName:"SwitchUnionWrapper",_isDCGSwitchUnionWrapper:!0,template(){return this.children[0]}}),Fee=Do({viewName:"SwitchUnion",_isDCGSwitchUnion:!0,updateCase(){this._case=this.props.getCase()},createView(){let r=this.props.buildChildView(this._case);r=r!=null?r:ql("div",{style:this.const("display: none")});let e=ql(Ree,null,r);return e._parentElement=this,e},template(){return this._case=void 0,this.updateCase(),this.createView()},overrideChildUpdates(){let r=this._case;this.updateCase();let e=this._case;if(r===e){this._element.update();return}let t=this.findRootNode(),i=document.createTextNode("");t.parentNode.insertBefore(i,t),Hc(this._element),this._childViews=[],t.parentNode.removeChild(t),Wc(this._element),$c(this._element),this._element=this.createView();let o=Ap(this._element,this);zc(this._element),i.parentNode.insertBefore(o,i),i.parentNode.removeChild(i),Kc(this._element),qc(this._element)}}),Vz=(r,e,t)=>ql(Fee,{getCase(){let i=e();return r?i&&i[r]:i},buildChildView(i){let o=t[i];return o?o(e):void 0}})});var Lz,Pz=__dcg_shared_module_exports__['b'](()=>{jc();Ld();s_();Lz=Do({viewName:"If",_isDCGIf:!0,template(){let{predicate:r}=this.props;if(typeof r!="function")throw new Error("<If predicate={}> must be a function");if(this.children.length!==1)throw new Error(`<If> expects a single child. You passed ${this.children.length}`);let e=this.children[0];if(e&&e._isDCGElement)throw new Error("<If> expects a function that constructs a DCGElement. You passed a DCGElement directly");if(typeof e!="function"){let o=JSON.stringify(e);throw new Error(`<If> expects a function that constructs a DCGElement. You passed ${o}`)}if(ns(e))throw new Error("<If> expects a function that constructs a DCGElement. You passed a constant");let t=()=>!!r(),i=o=>o?e():void 0;return this.createElement(wk,{key:t},i)}})});function _z(r,e){return ql(Bee,{isDefined(){let t=r();return t!=null},buildChildView(){return e(r)}})}var Nee,Bee,Oz=__dcg_shared_module_exports__['b'](()=>{jc();fg();Ey();Nee=Do({viewName:"IfDefinedWrapper",_isDCGIfDefinedWrapper:!0,template(){return this.children[0]}}),Bee=Do({viewName:"IfDefined",_isDCGIfDefined:!0,updateIsDefined(){this._isDefined=this.props.isDefined()},createView(){let r=this._isDefined?this.props.buildChildView():null;r=r!=null?r:this.createElement("div",{style:this.const("display: none")});let e=this.createElement(Nee,null,r);return e._parentElement=this,e},template(){return this._isDefined=void 0,this.updateIsDefined(),this.createView()},overrideChildUpdates(){let r=this._isDefined;this.updateIsDefined();let e=this._isDefined;if(r===e){this._element.update();return}let t=this.findRootNode(),i=document.createTextNode("");t.parentNode.insertBefore(i,t),Hc(this._element),this._childViews=[],t.parentNode.removeChild(t),Wc(this._element),$c(this._element),this._element=this.createView();let o=Ap(this._element,this);zc(this._element),i.parentNode.insertBefore(o,i),i.parentNode.removeChild(i),Kc(this._element),qc(this._element)}})});function Rz(r,e){let t=vk(()=>r()?"true":"false",e);return t._viewName="IfElse",t}var Fz=__dcg_shared_module_exports__['b'](()=>{l_()});var Nz,Bz=__dcg_shared_module_exports__['b'](()=>{jc();Nz=Do({viewName:"Textarea",computeValue(){let r=this.props.value();return r==null?"":`${r}`},template(){let{value:r,onInput:e,disabled:t}=this.props;if(!r)throw new Error('<Textarea> expects a "value={}" prop');if(!e)throw new Error('<Textarea> expects an "onInput={}" prop');let i={...this.props,onInput:(o=>{this.props.onInput(o.target.value),this._isMounted&&this.update()}).bind(this)};return t&&(i.disabled=()=>t()?!0:void 0),delete i.value,this.createElement("textarea",i,this.const(this.computeValue()))},didUpdate(){this.rootDOM||(this.rootDOM=this.findRootNode());let r=this.computeValue();this.rootDOM.value!==r&&(this.rootDOM.value=r)}})});var Uz,zz=__dcg_shared_module_exports__['b'](()=>{jc();Uz=Do({viewName:"Input",computeValue(){let r=this.props.value();return r==null?"":`${r}`},template(){let{value:r,onInput:e,onEnterPressed:t,disabled:i}=this.props;if(!r)throw new Error('<Input> expects a "value={}" prop');if(!e)throw new Error('<Input> expects an "onInput={}" prop');let o={...this.props,value:this.const(this.computeValue()),onInput:(n=>{e(n.target.value),this._isMounted&&this.update()}).bind(this)};return t&&(o.onKeypress=n=>{n.which===13&&t()}),i&&(o.disabled=()=>i()?!0:void 0),o.hasOwnProperty("tabindex")||(o.tabindex=()=>i&&i()?"-1":"0"),this.createElement("input",o)},didUpdate(){this.rootDOM||(this.rootDOM=this.findRootNode());var r=this.computeValue();this.rootDOM.value!==r&&(this.rootDOM.value=r)}})});var Kz,qz=__dcg_shared_module_exports__['b'](()=>{jc();Kz=Do({viewName:"Checkbox",computeChecked(){return!!this.props.checked()},template(){if(!this.props.checked)throw new Error('<Checkbox> expects a "checked={}" prop');if(!this.props.onChange)throw new Error('<Checkbox> expects an "onChange={}" prop');let r={...this.props,type:this.const("checkbox"),checked:this.const(this.computeChecked()?"checked":void 0),onChange:(e=>{this.props.onChange(e.target.checked),this._isMounted&&this.update()}).bind(this)};return this.createElement("input",r)},didUpdate(){this.rootDOM||(this.rootDOM=this.findRootNode());let r=this.computeChecked();this.rootDOM.checked!==r&&(this.rootDOM.checked=r)}})});var c_={};__dcg_shared_module_exports__['d'](c_,{Checkbox:()=>Kz,Each:()=>Tz,For:()=>Iz,If:()=>Lz,IfDefined:()=>_z,IfElse:()=>Rz,Input:()=>Uz,Switch:()=>wk,SwitchUnion:()=>vk,Textarea:()=>Nz});var Hz=__dcg_shared_module_exports__['b'](()=>{Mz();Az();s_();l_();Pz();Oz();Fz();Bz();zz();qz()});var Wz,$z=__dcg_shared_module_exports__['b'](()=>{jc();Wz=Do({template(){}})});var Ck,_d,jz=__dcg_shared_module_exports__['b'](()=>{Ey();jc();fg();n_();Ld();i_();yz();Ez();Dz();Hz();eC();o_();$z();Ck={createElement:ql,createClass:Do,mountToNode:uz,unmountFromNode:hz,spread:yk,const:gk,isConst:ns,addCustomAttribute:JU,Components:c_,addWarningHandler:ez,removeWarningHandler:tz,_warn:mg,enableSpanWrapping:nz,Class:Wz};Ck.addCustomAttribute("style",bz);Ck.addCustomAttribute("class",Cz);["willMount","onMount","didMount","willUnmount","onUnmount","didUnmount","willUpdate","onUpdate","didUpdate"].forEach(r=>Ck.addCustomAttribute(r,Sz(r)));_d=Ck});function Yz(r){Vp=r}function Ii(r,e){Vp==null||Vp.notify(r,e)}function nf(r,e,t){Vp==null||Vp.leaveBreadcrumb(r,e,t)}function Xz(r){Vp==null||Vp.setBeforeSendCB(r)}var Vp,as=__dcg_shared_module_exports__['b'](()=>{});function oh(r,e){let i=new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(r);return i?decodeURIComponent(i[1].replace(/\+/g,"%20")):null}function Uee(r,e){return new RegExp("[?|&]"+e+"(=|&|;|$)").test(r)}function zee(r,e,t){if(e!==encodeURIComponent(e))throw new Error("Programming error: parameter name should be URL-safe without encoding.");let i=encodeURIComponent(t);if(r.length){let o=r.split("#"),n=/\?/.test(r)?`${o[0]}&${e}=${i}`:`${o[0]}?${e}=${i}`;return o[1]!==void 0?`${n}#${o[1]}`:n}else return`?${e}=${i}`}function Kee(r,e,t){let o=new RegExp("([?|&])"+e+"=([^&;]+?)(&|#|;|$)").exec(r);if(!o)return r;let n=o[1],a=o[2],s=`${n}${e}=${a}`,l=encodeURIComponent(t),c=`${n}${e}=${l}`;return r.replace(s,c)}function Ek(r,e,t){return Uee(r,e)?Kee(r,e,t):zee(r,e,t)}var af=__dcg_shared_module_exports__['b'](()=>{});function jee(r){let e=Wee.exec(r);if(e){let t=e[1];return!$ee.test(t)}return!1}function Sk(r,e){let t=tn(),i="";return e!==void 0?i=e:i=t.lang?""+t.lang:"",r===""||i===""||qee.test(r)||Hee.test(r)||jee(r)?r:Ek(r,"lang",i)}var qee,Hee,Wee,$ee,Jz=__dcg_shared_module_exports__['b'](()=>{Rc();af();qee=/lang=[A-Za-z]+/,Hee=/(cl|learn|help).desmos.com/,Wee=/^(?:https?:)?(?:\/\/)?([^\s\/\?]+)/i,$ee=/(^desmos\.com$)|(\.desmos.com$)/});var Qz=__dcg_shared_module_exports__['b'](()=>{});var te=__dcg_shared_module_exports__['c']((Twe,Zz)=>{jz();qt();as();Jz();Qz();_d.addWarningHandler(r=>Ii(r));_d.addCustomAttribute("href",function(r){let e=Sk(r()),t={value:`${Sk(r())}`,bindings:{onMount(i){if(!i.matches("a")&&!i.matches("use"))throw new Error("Cannot have an href on a non-link element.")}}};return t.bindings.onUpdate=function(i){let o=Sk(r());e!==o&&(e=o,i.setAttribute("href",o))},t});_d.addCustomAttribute("onTap",r=>({value:"",bindings:{onMount(e){ie(e).on("dcg-tap",r)}}}));_d.addCustomAttribute("ignoreRealClick",r=>({bindings:{onMount(e){ie(e).on("click",function(t){r()&&t.preventDefault()})}}}));_d.addCustomAttribute("onTapStart",r=>({bindings:{onMount(e){ie(e).on("dcg-tapstart",r)}}}));_d.addCustomAttribute("onTapMove",r=>({bindings:{onMount(e){ie(e).on("dcg-tapmove",r)}}}));_d.addCustomAttribute("onTapEnd",r=>({bindings:{onMount(e){ie(e).on("dcg-tapend",r)}}}));_d.addCustomAttribute("onLongHold",r=>({bindings:{onMount(e){ie(e).on("dcg-longhold",r)}}}));_d.addCustomAttribute("manageFocus",function(r){return r()===void 0?{}:{bindings:{onMount(e){r().shouldBeFocused()&&e.focus(),e.onfocus=function(t){r().shouldBeFocused()||r().onFocusedChanged(!0,t)},e.onblur=function(t){r().shouldBeFocused()&&r().onFocusedChanged(!1,t)}},onUpdate(e){let t=r().shouldBeFocused(),i=document.activeElement===e;t&&!i?e.focus():i&&!t&&e.blur()},willUnmount(e){e.onfocus=null,e.onblur=null}}}});Zz.exports=_d});var AH=__dcg_shared_module_exports__['c'](BC=>{var At=BC&&BC.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(i[n]=o[n])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),vT=BC&&BC.__assign||function(){return vT=Object.assign||function(r){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=e[o])}return r},vT.apply(this,arguments)};(function(){var r=-1,e=1,t=Math.min,i=Math.max;function o(){}function n(G){for(;G;){if(!G.parent)return G;G=G.parent}}function a(G,b,u){if(!b){var m=new Error("prayer failed: "+G);if(u){var D={};m.dcgExtraErrorMetaData=D;for(var L in u){var K=u[L],re=D[L]={};if(K){re.localLatex=K.latex();var se=n(K);se&&(re.rootLatex=se.latex())}else re.emptyNode=!0}}throw m}}function s(G){a("a direction was passed",G===r||G===e)}function l(G){var b=document.implementation.createHTMLDocument("");if(b.body.innerHTML=G,b.body.children.length===1)return b.body.children[0];for(var u=document.createDocumentFragment();b.body.firstChild;)u.appendChild(b.body.firstChild);return u}var c=function(b,u,m){var D;switch(b){case"svg":case"path":D=document.createElementNS("http://www.w3.org/2000/svg",b);break;default:D=document.createElement(b)}for(var L in u){var K=u[L];K!==void 0&&D.setAttribute(L,typeof K=="string"?K:String(K))}if(m)for(var re=0;re<m.length;re++)D.appendChild(m[re]);return D};c.text=function(G){return document.createTextNode(G)},c.block=function(G,b,u){var m=c(G,b,[u.html()]);return u.setDOM(m),O.linkElementByBlockNode(m,u),m},c.entityText=function(G){var b=l(G);return a("entity parses to a single text node",b instanceof DocumentFragment&&b.childNodes.length===1&&b.childNodes[0]instanceof Text),b.childNodes[0]};function d(G,b){var u,m,D;if(typeof((u=G)===null||u===void 0?void 0:u.closest)=="function")return G.closest(b);if(!(G instanceof HTMLElement))return null;var L=Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,K=G;do{if(L.call(K,b))return K;K=(D=(m=K==null?void 0:K.parentElement)!==null&&m!==void 0?m:K==null?void 0:K.parentNode)!==null&&D!==void 0?D:null}while(K!==null&&K.nodeType===1);return null}var p="\xA0",g="\u200B",h="\u02D9",f="\u2211",y="\u220F",x="\u2210",E="\u222B";function C(G){return G.getClientRects().length?G.getBoundingClientRect():{top:0,left:0,height:0,width:0,x:0,y:0,bottom:0,right:0}}function S(){return window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft}function v(){return window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}var M=function(){var G,b;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(G=requestAnimationFrame,b=cancelAnimationFrame):(G=function(u){return setTimeout(u,13)},b=clearTimeout),function(u,m){var D=Date.now(),L,K=0;function re(){var Ye=(Date.now()-D)/u;Ye<=K?we():K=Ye,m(K,we,se)}function se(){L!==void 0&&b(L),L=void 0}function we(){se(),L=G(re)}m(u<=0?1:0,we,se)}}(),A=function(){function G(b){this.span=c("span",{class:"dcg-mq-aria-alert","aria-live":"assertive","aria-atomic":"true"}),this.msg="",this.items=[],this.controller=b}return G.prototype.attach=function(){var b=this.controller.container;this.span.parentNode!==b&&P(b).prepend(P(this.span))},G.prototype.queue=function(b,u){u===void 0&&(u=!1);var m="";if(b instanceof Oe){var D=b.mathspeak({ignoreShorthand:!0});u&&(b.parent&&b.parent.ariaLabel&&b.ariaLabel==="block"?m=b.parent.ariaLabel+" "+D:b.ariaLabel&&(m=b.ariaLabel+" "+D)),m===""&&(m=D)}else m=b||"";return this.items.push(m),this},G.prototype.queueDirOf=function(b){return s(b),this.queue(b===r?"before":"after")},G.prototype.queueDirEndOf=function(b){return s(b),this.queue(b===r?"beginning of":"end of")},G.prototype.alert=function(b){return this.attach(),b&&this.queue(b),this.items.length&&(this.msg=this.items.join(" ").replace(/ +(?= )/g,"").trim(),this.controller.containerHasFocus()&&(this.controller.options.logAriaAlerts&&this.msg&&console.log(this.msg),this.span.textContent=this.msg)),this.clear()},G.prototype.clear=function(){return this.items.length=0,this},G}(),I=function(){function G(b,u){var m;arguments.length===1&&(u=b),!(!b||!u)&&(this.ends=(m={},m[r]=b,m[e]=u,m))}return G.create=function(b,u){arguments.length===1&&(u=b),a("No half-empty DOMFragments",!!b==!!u);var m=new G(b,u);return a("last is a forward sibling of first",m.isValid()),m},G.prototype.isEmpty=function(){return this.ends===void 0},G.prototype.isOneNode=function(){return!!(this.ends&&this.ends[r]===this.ends[e])},G.prototype.isValid=function(){if(!this.ends||this.ends[r]===this.ends[e])return!0;var b;return this.eachNode(function(u){return b=u}),b===this.ends[e]},G.prototype.firstNode=function(){return a("Fragment is not empty",this.ends),this.ends[r]},G.prototype.lastNode=function(){return a("Fragment is not empty",this.ends),this.ends[e]},G.prototype.children=function(){var b=this.oneNode(),u=b.firstChild,m=b.lastChild;return u&&m?new G(u,m):new G},G.prototype.join=function(b){if(!this.ends)return b;if(!b.ends)return this;for(var u=!1,m=this.ends[e].nextSibling;m;){if(m===b.ends[r]){u=!0;break}m=m.nextSibling}return a("sibling must be a forward DOM sibling of this fragment",u),new G(this.ends[r],b.ends[e])},G.prototype.oneNode=function(){return a("Fragment has a single node",this.ends&&this.ends[r]===this.ends[e]),this.ends[r]},G.prototype.oneElement=function(){var b=this.oneNode();return a("Node is an Element",b.nodeType===Node.ELEMENT_NODE),b},G.prototype.oneText=function(){var b=this.oneNode();return a("Node is Text",b.nodeType===Node.TEXT_NODE),b},G.prototype.eachNode=function(b){if(!this.ends)return this;for(var u=this.ends[e],m=this.ends[r],D=void 0;m&&(D=m.nextSibling,b(m),m!==u);m=D);return this},G.prototype.eachElement=function(b){return this.eachNode(function(u){u.nodeType===Node.ELEMENT_NODE&&b(u)}),this},G.prototype.text=function(){var b="";return this.eachNode(function(u){b+=u.textContent||""}),b},G.prototype.toNodeArray=function(){var b=[];return this.eachNode(function(u){return b.push(u)}),b},G.prototype.toElementArray=function(){var b=[];return this.eachElement(function(u){return b.push(u)}),b},G.prototype.toDocumentFragment=function(){var b=document.createDocumentFragment();return this.eachNode(function(u){return b.appendChild(u)}),b},G.prototype.insertBefore=function(b){return this.insDirOf(r,b)},G.prototype.insertAfter=function(b){return this.insDirOf(e,b)},G.prototype.append=function(b){return b.appendTo(this.oneElement()),this},G.prototype.prepend=function(b){return b.prependTo(this.oneElement()),this},G.prototype.appendTo=function(b){return this.insAtDirEnd(e,b)},G.prototype.prependTo=function(b){return this.insAtDirEnd(r,b)},G.prototype.parent=function(){if(!this.ends)return this;var b=this.ends[r].parentNode;return b?new G(b):new G},G.prototype.wrapAll=function(b){if(b.textContent="",!this.ends)return this;var u=this.ends[r].parentNode,m=this.ends[e].nextSibling;return this.appendTo(b),u&&u.insertBefore(b,m),this},G.prototype.replaceWith=function(b){var u,m=(u=this.ends)===null||u===void 0?void 0:u[e],D=m==null?void 0:m.parentNode,L=m==null?void 0:m.nextSibling;this.detach();var K=b.toDocumentFragment();return!m||!D?this:(D.insertBefore(K,L||null),this)},G.prototype.nthElement=function(b){if(this.ends&&!(b<0||b!==Math.floor(b)))for(var u=this.ends[r];u;){if(u.nodeType===Node.ELEMENT_NODE){if(b<=0)return u;b-=1}if(u===this.ends[e])return;u=u.nextSibling}},G.prototype.firstElement=function(){return this.nthElement(0)},G.prototype.lastElement=function(){if(this.ends)for(var b=this.ends[e];b;){if(b.nodeType===Node.ELEMENT_NODE)return b;if(b===this.ends[r])return;b=b.previousSibling}},G.prototype.first=function(){return new G(this.firstElement())},G.prototype.last=function(){return new G(this.lastElement())},G.prototype.eq=function(b){return new G(this.nthElement(b))},G.prototype.slice=function(b){if(!this.ends)return this;var u=this.nthElement(b);return u?new G(u,this.ends[e]):new G},G.prototype.next=function(){for(var b=this.oneNode();b;)if(b=b.nextSibling,b&&b.nodeType===Node.ELEMENT_NODE)return new G(b);return new G},G.prototype.prev=function(){for(var b=this.oneNode();b;)if(b=b.previousSibling,b&&b.nodeType===Node.ELEMENT_NODE)return new G(b);return new G},G.prototype.empty=function(){return this.eachElement(function(b){b.textContent=""}),this},G.prototype.remove=function(){return this.toDocumentFragment(),this},G.prototype.detach=function(){return this.remove()},G.prototype.insDirOf=function(b,u){var m;if(!this.ends)return this;var D=(m=u.ends)===null||m===void 0?void 0:m[b];return!D||!D.parentNode?this.detach():(_(b,D.parentNode,this.toDocumentFragment(),D),this)},G.prototype.insAtDirEnd=function(b,u){return this.ends?(U(b,this.toDocumentFragment(),u),this):this},G.prototype.hasClass=function(b){var u=!1;return this.eachElement(function(m){m.classList.contains(b)&&(u=!0)}),u},G.prototype.addClass=function(b){for(var u=function(re){if(!re)return"continue";m.eachElement(function(se){se.classList.add(re)})},m=this,D=0,L=b.split(/\s+/);D<L.length;D++){var K=L[D];u(K)}return this},G.prototype.removeClass=function(b){for(var u=function(re){if(!re)return"continue";m.eachElement(function(se){se.classList.remove(re)})},m=this,D=0,L=b.split(/\s+/);D<L.length;D++){var K=L[D];u(K)}return this},G.prototype.toggleClass=function(b,u){if(u===!0)return this.addClass(b);if(u===!1)return this.removeClass(b);for(var m=function(se){if(!se)return"continue";D.eachElement(function(we){we.classList.toggle(se)})},D=this,L=0,K=b.split(/\s+/);L<K.length;L++){var re=K[L];m(re)}return this},G}(),P=I.create;function _(G,b,u,m){b.insertBefore(u,G===r?m:m.nextSibling)}function U(G,b,u){G===r?u.insertBefore(b,u.firstChild):u.appendChild(b)}var Y=function(){function G(b,u,m){this.init(b,u,m)}return G.prototype.init=function(b,u,m){this.parent=b,this[r]=u,this[e]=m},G.copy=function(b){return new G(b.parent,b[r],b[e])},G}();function R(G,b){var u=G[r];if(u){var m=G[e];if(m)for(m=m[e];u!==m;u=u[e]){var D=b(u);if(D===!1)break}}}function H(G,b,u){var m=G[r];if(!m)return b;var D=G[e];if(!D)return b;for(D=D[e];m!==D;m=m[e])b=u(b,m);return b}var O=function(){function G(){var m;this[b]=0,this[u]=0,this.parent=0,this.ends=(m={},m[r]=0,m[e]=0,m),this.id=G.uniqueNodeId()}G.uniqueNodeId=function(){return G.idCounter+=1},G.getNodeOfElement=function(m){if(m){if(!m.nodeType)throw new Error("must pass an Element to NodeBase.getNodeOfElement");var D=m;return D.mqBlockNode||D.mqCmdNode}},G.linkElementByBlockNode=function(m,D){m.mqBlockNode=D},G.linkElementByCmdNode=function(m,D){m.mqCmdNode=D},G.prototype.setEnds=function(m){this.ends=m,a("No half-empty node ends",!!this.ends[r]==!!this.ends[e])},G.prototype.getEnd=function(m){return this.ends[m]},G.prototype.toString=function(){return"{{ MathQuill Node #"+this.id+" }}"},G.prototype.setDOM=function(m){return m&&a("DOM is an element or a text node",m.nodeType===Node.ELEMENT_NODE||m.nodeType===Node.TEXT_NODE),this._el=m,this},G.prototype.domFrag=function(){return P(this._el)},G.prototype.createDir=function(m,D){s(m);var L=this;return L.html(),L.domFrag().insDirOf(m,D.domFrag()),D[m]=L.adopt(D.parent,D[r],D[e]),L},G.prototype.createLeftOf=function(m){this.createDir(r,m)},G.prototype.selectChildren=function(m,D){return new pe(m,D)},G.prototype.bubble=function(m){for(var D=this.getSelfNode(),L=D;L;L=L.parent){var K=m(L);if(K===!1)break}return this},G.prototype.postOrder=function(m){var D=this.getSelfNode();return function L(K){return K?(K.eachChild(L),m(K),!0):!1}(D),D},G.prototype.isEmpty=function(){return this.ends[r]===0&&this.ends[e]===0},G.prototype.isQuietEmptyDelimiter=function(m){if(!this.isEmpty()||!m||!this.parent||this.parent.ctrlSeq===void 0)return!1;var D=this.parent.ctrlSeq.replace(/^\\(left|right)?/,"");return m.hasOwnProperty(D)},G.prototype.isStyleBlock=function(){return!1},G.prototype.isTextBlock=function(){return!1},G.prototype.children=function(){return new w(this.getEnd(r),this.getEnd(e))},G.prototype.eachChild=function(m){return R(this.ends,m),this},G.prototype.foldChildren=function(m,D){return H(this.ends,m,D)},G.prototype.withDirAdopt=function(m,D,L,K){var re=this.getSelfNode();return new w(re,re).withDirAdopt(m,D,L,K),this},G.prototype.adopt=function(m,D,L){var K=this.getSelfNode();return new w(K,K).adopt(m,D,L),this.getSelfNode()},G.prototype.disown=function(){var m=this.getSelfNode();return new w(m,m).disown(),this},G.prototype.remove=function(){return this.domFrag().remove(),this.disown()},G.prototype.shouldIgnoreSubstitutionInSimpleSubscript=function(m){return!(!m.disableAutoSubstitutionInSubscripts||!this.parent||!(this.parent.parent instanceof Rl)||!this.parent.domFrag().hasClass("dcg-mq-sub"))},G.prototype.getSelfNode=function(){return this},G.prototype.parser=function(){a("Abstract parser() method is never called",!1)},G.prototype.html=function(){throw new Error("html() unimplemented in NodeBase")},G.prototype.text=function(){return""},G.prototype.latex=function(){var m={latex:"",startIndex:-1,endIndex:-1};return this.latexRecursive(m),m.latex},G.prototype.latexRecursive=function(m){},G.prototype.checkCursorContextOpen=function(m){m.startSelectionBefore===this&&(m.startIndex=m.latex.length),m.endSelectionBefore===this&&(m.endIndex=m.latex.length)},G.prototype.checkCursorContextClose=function(m){m.startSelectionAfter===this&&(m.startIndex=m.latex.length),m.endSelectionAfter===this&&(m.endIndex=m.latex.length)},G.prototype.finalizeTree=function(m,D){},G.prototype.contactWeld=function(m,D){},G.prototype.blur=function(m){},G.prototype.focus=function(){},G.prototype.intentionalBlur=function(){},G.prototype.reflow=function(){},G.prototype.registerInnerField=function(m,D){},G.prototype.chToCmd=function(m,D){a("Abstract chToCmd() method is never called",!1)},G.prototype.mathspeak=function(m){return""},G.prototype.seek=function(m,D){},G.prototype.siblingDeleted=function(m,D){},G.prototype.siblingCreated=function(m,D){},G.prototype.finalizeInsert=function(m,D){},G.prototype.fixDigitGrouping=function(m){},G.prototype.writeLatex=function(m,D){},G.prototype.write=function(m,D){};var b,u;return b=r,u=e,G.idCounter=0,G}();function q(G,b,u){a("a parent is always present",G),a("leftward is properly set up",function(){return b?b[e]===u&&b.parent===G:G.getEnd(r)===u}(),{parent:G,leftward:b,leftwardL:b&&b[r],leftwardR:b&&b[e],rightwardL:u&&u[r],rightwardR:u&&u[e]}),a("rightward is properly set up",function(){return u?u[r]===b&&u.parent===G:G.getEnd(e)===b}(),{parent:G,rightward:u,leftwardL:b&&b[r],leftwardR:b&&b[e],rightwardL:u&&u[r],rightwardR:u&&u[e],rightwardParent:u&&u.parent})}var w=function(){function G(b,u,m){var D,L;if(this.disowned=!1,m===void 0&&(m=r),s(m),a("no half-empty fragments",!b==!u,{withDir:b,oppDir:u}),!b||!u){this.setEnds((D={},D[r]=0,D[e]=0,D));return}a("withDir is passed to Fragment",b instanceof Oe),a("oppDir is passed to Fragment",u instanceof Oe),a("withDir and oppDir have the same parent",b.parent===u.parent);var K=(L={},L[m]=b,L[-m]=u,L);this.setEnds(K);var re=0;this.each(function(se){re=se}),a("following direction siblings from start reaches end",re===K[e])}return G.prototype.getDOMFragFromEnds=function(){var b=this.ends[r],u=this.ends[e];return b===0||u===0?P():b===u?b.domFrag():b.domFrag().join(u.domFrag())},G.prototype.setEnds=function(b){this.ends=b},G.prototype.getEnd=function(b){return this.ends?this.ends[b]:0},G.prototype.domFrag=function(){return this.getDOMFragFromEnds()},G.prototype.withDirAdopt=function(b,u,m,D){return b===r?this.adopt(u,m,D):this.adopt(u,D,m)},G.prototype.adopt=function(b,u,m){var D;q(b,u,m);var L=this;this.disowned=!1;var K=L.ends[r];if(!K)return this;var re=L.ends[e];if(!re)return this;var se=(D={},D[r]=b.getEnd(r),D[e]=b.getEnd(e),D);return u||(se[r]=K),m?m[r]=re:se[e]=re,b.setEnds(se),re[e]=m,L.each(function(we){return we[r]=u,we.parent=b,u&&(u[e]=we),u=we,!0}),L},G.prototype.disown=function(){var b,u=this,m=u.ends[r];if(!m||u.disowned)return u;this.disowned=!0;var D=u.ends[e];if(!D)return u;var L=m.parent;q(L,m[r],m),q(L,D,D[e]);var K=(b={},b[r]=L.getEnd(r),b[e]=L.getEnd(e),b);if(m[r]){var re=m[r];re[e]=D[e]}else K[r]=D[e];if(D[e]){var se=D[e];se[r]=m[r]}else K[e]=m[r];return K[r]&&K[e]?L.setEnds(K):L.ends=K,u},G.prototype.remove=function(){return this.domFrag().remove(),this.disown()},G.prototype.each=function(b){return R(this.ends,b),this},G.prototype.fold=function(b,u){return H(this.ends,b,u)},G}(),T={},B={};function de(G){return G&&G.prototype instanceof Oe}var F=function(G){At(b,G);function b(u,m,D){var L=G.call(this,u,m,D)||this;return L.ancestors={},L}return b.fromCursor=function(u){return new b(u.parent,u[r],u[e])},b}(Y),j=function(G){At(b,G);function b(u,m,D){var L=G.call(this,u,0,0)||this;return L.upDownCache={},L.cursorElement=c("span",{class:"dcg-mq-cursor"},[c.text(g)]),L._domFrag=P(),L.controller=D,L.options=m,L.setDOMFrag(P(L.cursorElement)),L.blink=function(){P(L.cursorElement).toggleClass("dcg-mq-blink")},L}return b.prototype.setDOMFrag=function(u){return this._domFrag=u,this},b.prototype.domFrag=function(){return this._domFrag},b.prototype.show=function(){if(P(this.cursorElement).removeClass("dcg-mq-blink"),this.setDOMFrag(P(this.cursorElement)),this.intervalId)clearInterval(this.intervalId);else{var u=this[e];if(u){var m=this.selection;m&&m.getEnd(r)[r]===this[r]?this.domFrag().insertBefore(m.domFrag()):this.domFrag().insertBefore(u.domFrag())}else this.domFrag().appendTo(this.parent.domFrag().oneElement());this.parent.focus()}return this.intervalId=setInterval(this.blink,500),this},b.prototype.hide=function(){return this.intervalId&&clearInterval(this.intervalId),this.intervalId=0,this.domFrag().detach(),this.setDOMFrag(P()),this},b.prototype.withDirInsertAt=function(u,m,D,L){var K=this.parent;this.parent=m,this[u]=D,this[-u]=L,K!==m&&K.blur&&K.blur(this)},b.prototype.insDirOf=function(u,m){return s(u),this.domFrag().insDirOf(u,m.domFrag()),this.withDirInsertAt(u,m.parent,m[u],m),this.parent.domFrag().addClass("dcg-mq-hasCursor"),this},b.prototype.insLeftOf=function(u){return this.insDirOf(r,u)},b.prototype.insRightOf=function(u){return this.insDirOf(e,u)},b.prototype.insAtDirEnd=function(u,m){return s(u),this.domFrag().insAtDirEnd(u,m.domFrag().oneElement()),this.withDirInsertAt(u,m,0,m.getEnd(u)),m.focus(),this},b.prototype.insAtLeftEnd=function(u){return this.insAtDirEnd(r,u)},b.prototype.insAtRightEnd=function(u){return this.insAtDirEnd(e,u)},b.prototype.jumpUpDown=function(u,m){var D=this;D.upDownCache[u.id]=Y.copy(D);var L=D.upDownCache[m.id];if(L){var K=L[e];K?D.insLeftOf(K):D.insAtRightEnd(L.parent)}else{var re=D.getBoundingClientRectWithoutMargin().left;m.seek(re,D)}D.controller.aria.queue(m,!0)},b.prototype.getBoundingClientRectWithoutMargin=function(){var u=this.domFrag();u.removeClass("dcg-mq-cursor");var m=C(u.oneElement()),D=m.left,L=m.right;return u.addClass("dcg-mq-cursor"),{left:D,right:L}},b.prototype.unwrapGramp=function(){var u=this.parent.parent,m=u.parent,D=u[e],L=this,K=u[r];if(u.disown().eachChild(function(Fe){return Fe.isEmpty()||(Fe.children().adopt(m,K,D).each(function(at){return at.domFrag().insertBefore(u.domFrag()),!0}),K=Fe.getEnd(e)),!0}),!this[e]){var re=this[r];if(re)this[e]=re[e];else for(;!this[e];){var se=this.parent[e];if(se)this.parent=se,this[e]=se.getEnd(r);else{this[e]=u[e],this.parent=m;break}}}var we=this[e];we?this.insLeftOf(we):this.insAtRightEnd(m),u.domFrag().remove();var Ye=u[r],Ke=u[e];Ye&&Ye.siblingDeleted(L.options,e),Ke&&Ke.siblingDeleted(L.options,r)},b.prototype.startSelection=function(){for(var u=this.anticursor=F.fromCursor(this),m=u.ancestors,D=u;D.parent;D=D.parent)m[D.parent.id]=D},b.prototype.endSelection=function(){delete this.anticursor},b.prototype.select=function(){var u,m=this.anticursor;if(this[r]===m[r]&&this.parent===m.parent)return!1;for(var D=this;D.parent;D=D.parent)if(D.parent.id in m.ancestors){u=D.parent;break}a("cursor and anticursor in the same tree",u);var L=u,K=m.ancestors[L.id],re,se,we=e;if(D[r]!==K){for(var Ye=D;Ye;Ye=Ye[e])if(Ye[e]===K[e]){we=r,re=D,se=K;break}}we===e&&(re=K,se=D),re instanceof Y&&(re=re[e]),se instanceof Y&&(se=se[r]),this.hide().selection=L.selectChildren(re,se);var Ke=this.selection.getEnd(we);return this.insDirOf(we,Ke),this.selectionChanged(),!0},b.prototype.resetToEnd=function(u){this.clearSelection();var m=u.root;this[e]=0,this[r]=m.getEnd(e),this.parent=m},b.prototype.clearSelection=function(){return this.selection&&(this.selection.clear(),delete this.selection,this.selectionChanged()),this},b.prototype.deleteSelection=function(){var u=this.selection;u&&(this[r]=u.getEnd(r)[r],this[e]=u.getEnd(e)[e],u.remove(),this.selectionChanged(),delete this.selection)},b.prototype.replaceSelection=function(){var u=this.selection;return u&&(this[r]=u.getEnd(r)[r],this[e]=u.getEnd(e)[e],delete this.selection),u},b.prototype.depth=function(){for(var u=this,m=0;u=u.parent;)m+=u instanceof We?1:0;return m},b.prototype.isTooDeep=function(u){return this.options.maxDepth!==void 0?this.depth()+(u||0)>this.options.maxDepth:!1},b.prototype.selectionChanged=function(){},b}(Y),pe=function(G){At(b,G);function b(u,m,D){var L=G.call(this,u,m,D)||this;return L._el=c("span",{class:"dcg-mq-selection"}),L.getDOMFragFromEnds().wrapAll(L._el),L}return b.prototype.isCleared=function(){return this._el===void 0},b.prototype.domFrag=function(){return this.isCleared()?this.getDOMFragFromEnds():P(this._el)},b.prototype.setEnds=function(u){a("Selection ends are never empty",u[r]&&u[e]),this.ends=u},b.prototype.getEnd=function(u){return this.ends[u]},b.prototype.adopt=function(u,m,D){return this.clear(),G.prototype.adopt.call(this,u,m,D)},b.prototype.clear=function(){var u=this.getDOMFragFromEnds();return this.domFrag().replaceWith(u),this._el=void 0,this},b.prototype.join=function(u,m){return m===void 0&&(m=""),this.fold("",function(D,L){return D+m+L[u]()})},b}(w),le=function(){function G(b,u,m){this.textareaEventListeners={},this.id=b.id,this.data={},this.root=b,this.container=u,this.options=m,this.aria=new A(this.getControllerSelf()),this.ariaLabel="Math Input",this.ariaPostLabel="",b.controller=this.getControllerSelf(),this.cursor=b.cursor=new j(b,m,this.getControllerSelf())}return G.prototype.getControllerSelf=function(){return this},G.prototype.handle=function(b,u){var m,D=this.options.handlers,L=(m=this.options.handlers)===null||m===void 0?void 0:m.fns[b];if(L){var K=D==null?void 0:D.APIClasses[this.KIND_OF_MQ];a("APIClass is defined",K);var re=new K(this);u===r||u===e?L(u,re):L(re)}},G.onNotify=function(b){G.notifyees.push(b)},G.prototype.notify=function(b){for(var u=0;u<G.notifyees.length;u+=1)G.notifyees[u](this.cursor,b);return this},G.prototype.setAriaLabel=function(b){var u=this.getAriaLabel();return b&&typeof b=="string"&&b!==""?this.ariaLabel=b:this.editable?this.ariaLabel="Math Input":this.ariaLabel="",this.ariaLabel!==u&&!this.containerHasFocus()&&this.updateMathspeak(),this},G.prototype.getAriaLabel=function(){return this.ariaLabel!=="Math Input"?this.ariaLabel:this.editable?"Math Input":""},G.prototype.setAriaPostLabel=function(b,u){var m=this;return b&&typeof b=="string"&&b!==""?(b!==this.ariaPostLabel&&typeof u=="number"&&(this._ariaAlertTimeout&&clearTimeout(this._ariaAlertTimeout),this._ariaAlertTimeout=setTimeout(function(){m.containerHasFocus()?m.aria.alert(m.root.mathspeak().trim()+" "+b.trim()):m.updateMathspeak()},u)),this.ariaPostLabel=b):(this._ariaAlertTimeout&&clearTimeout(this._ariaAlertTimeout),this.ariaPostLabel=""),this},G.prototype.getAriaPostLabel=function(){return this.ariaPostLabel||""},G.prototype.containerHasFocus=function(){return document.activeElement&&this.container.contains(document.activeElement)},G.prototype.getTextareaOrThrow=function(){var b=this.textarea;if(!b)throw new Error("expected a textarea");return b},G.prototype.getTextareaSpanOrThrow=function(){var b=this.textareaSpan;if(!b)throw new Error("expected a textareaSpan");return b},G.prototype.addTextareaEventListeners=function(b){if(this.textarea)for(var u in b){var m=u;this.removeTextareaEventListener(m),this.textarea.addEventListener(m,b[m])}},G.prototype.removeTextareaEventListener=function(b){if(this.textarea){var u=this.textareaEventListeners[b];u&&this.textarea.removeEventListener(b,u)}},G.prototype.exportMathSpeak=function(){return this.root.mathspeak()},G.prototype.updateMathspeak=function(){},G.prototype.scrollHoriz=function(){},G.prototype.selectionChanged=function(){},G.prototype.setOverflowClasses=function(){},G.notifyees=[],G}(),ne={},X={},ae={handlers:!0,autoCommands:!0,quietEmptyDelimiters:!0,autoParenthesizedFunctions:!0,autoOperatorNames:!0,infixOperatorNames:!0,leftRightIntoCmdGoes:!0,maxDepth:!0,interpretTildeAsSim:!0},J={},ge=function(){function G(b){this.version=b}return G.prototype.assertJquery=function(){return a("Interface versions > 2 do not depend on JQuery",this.version<=2),a("JQuery is set for interface v < 3",this.jQuery),this.jQuery},G}(),be=function(){function G(){}return G}(),Ee=function(){window.console&&console.warn(`You are using the MathQuill API without specifying an interface version, which will fail in v1.0.0. Easiest fix is to do the following before doing anything else:

    MathQuill = MathQuill.getInterface(1);
    // now MathQuill.MathField() works like it used to

See also the "\`dev\` branch (2014\u20132015) \u2192 v0.10.0 Migration Guide" at
  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide`)},Le;function Se(G){return Ee(),Le||(Le=W(1)),Le(G)}Se.prototype=be.prototype,Se.VERSION="v0.10.1",Se.interfaceVersion=function(G){if(G!==1)throw"Only interface version 1 supported. You specified: "+G;return Ee=function(){window.console&&console.warn(`You called MathQuill.interfaceVersion(1); to specify the interface version, which will fail in v1.0.0. You can fix this easily by doing this before doing anything else:

    MathQuill = MathQuill.getInterface(1);
    // now MathQuill.MathField() works like it used to

See also the "\`dev\` branch (2014\u20132015) \u2192 v0.10.0 Migration Guide" at
  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide`)},Ee(),Se},Se.getInterface=W;var et=W.MIN=1,Z=W.MAX=3;function W(G){if(G!==1&&G!==2&&G!==3)throw"Only interface versions between "+et+" and "+Z+" supported. You specified: "+G;var b=G;if(b<3){var u=window.jQuery;if(!u)throw"MathQuill interface version ".concat(b," requires jQuery 1.5.2+ to be loaded first");ge.prototype.jQuery=u}var m=vT(vT({},J),{handlers:function(Ke){return{fns:Ke||{},APIClasses:se}}});function D(Ke,Fe){for(var at in Fe)if(Fe.hasOwnProperty(at)){if(at==="substituteKeyboardEvents"&&b>=3)throw new Error(["As of interface version 3, the 'substituteKeyboardEvents'","option is no longer supported. Use 'overrideTypedText' and","'overrideKeystroke' instead."].join(" "));var dt=Fe[at],Ct=m[at];Ke[at]=Ct?Ct(dt):dt}}var L=b<3?ge:function(Ke){At(Fe,Ke);function Fe(){return Ke!==null&&Ke.apply(this,arguments)||this}return Fe}(ge),K=function(Ke){At(Fe,Ke);function Fe(at){var dt=Ke.call(this)||this;return dt.__controller=at,dt.__options=at.options,dt.id=at.id,dt.data=at.data,dt}return Fe.prototype.mathquillify=function(at){var dt=this.__controller,Ct=dt.root,It=dt.container;dt.createTextarea();var _t=P(It).addClass(at).children().detach();Ct.setDOM(P(c("span",{class:"dcg-mq-root-block","aria-hidden":!0})).appendTo(It).oneElement()),O.linkElementByBlockNode(Ct.domFrag().oneElement(),Ct),this.latex(_t.text()),this.revert=function(){return dt.removeMouseEventListener(),P(It).removeClass("dcg-mq-editable-field dcg-mq-math-mode dcg-mq-text-mode").empty().append(_t),b<3?this.__options.assertJquery()(It):It}},Fe.prototype.setAriaLabel=function(at){return this.__controller.setAriaLabel(at),this},Fe.prototype.getAriaLabel=function(){return this.__controller.getAriaLabel()},Fe.prototype.config=function(at){return D(this.__options,at),this},Fe.prototype.el=function(){return this.__controller.container},Fe.prototype.text=function(){return this.__controller.exportText()},Fe.prototype.mathspeak=function(){return this.__controller.exportMathSpeak()},Fe.prototype.latex=function(at){if(arguments.length>0){this.__controller.renderLatexMath(at);var dt=this.__controller.cursor;return this.__controller.blurred&&dt.hide().parent.blur(dt),this}return this.__controller.exportLatex()},Fe.prototype.selection=function(){return this.__controller.exportLatexSelection()},Fe.prototype.html=function(){return this.__controller.root.domFrag().oneElement().innerHTML.replace(/ jQuery\d+="(?:\d+|null)"/g,"").replace(/ mathquill-(?:command|block)-id="?\d+"?/g,"").replace(/<span class="?dcg-mq-cursor( dcg-mq-blink)?"?>.?<\/span>/i,"").replace(/ dcg-mq-hasCursor|dcg-mq-hasCursor ?/,"").replace(/ class=(""|(?= |>))/g,"")},Fe.prototype.reflow=function(){return this.__controller.root.postOrder(function(at){at.reflow()}),this},Fe}(be),re=function(Ke){At(Fe,Ke);function Fe(){return Ke!==null&&Ke.apply(this,arguments)||this}return Fe.prototype.mathquillify=function(at){return Ke.prototype.mathquillify.call(this,at),this.__controller.editable=!0,this.__controller.addMouseEventListener(),this.__controller.editablesTextareaEvents(),this},Fe.prototype.focus=function(){return this.__controller.getTextareaOrThrow().focus(),this.__controller.scrollHoriz(),this},Fe.prototype.blur=function(){return this.__controller.getTextareaOrThrow().blur(),this},Fe.prototype.write=function(at){this.__controller.writeLatex(at),this.__controller.scrollHoriz();var dt=this.__controller.cursor;return this.__controller.blurred&&dt.hide().parent.blur(dt),this},Fe.prototype.empty=function(){var at,dt=this.__controller.root,Ct=this.__controller.cursor;return dt.setEnds((at={},at[r]=0,at[e]=0,at)),dt.domFrag().empty(),delete Ct.selection,Ct.insAtRightEnd(dt),this},Fe.prototype.cmd=function(at){var dt=this.__controller.notify(void 0),Ct=dt.cursor;if(/^\\[a-z]+$/i.test(at)&&!Ct.isTooDeep()){at=at.slice(1);var It=T[at],_t;It&&(It.constructor?_t=new It(at):_t=It(at),Ct.selection&&_t.replaces(Ct.replaceSelection()),_t.createLeftOf(Ct.show()))}else Ct.parent.write(Ct,at);return dt.scrollHoriz(),dt.blurred&&Ct.hide().parent.blur(Ct),this},Fe.prototype.select=function(){return this.__controller.selectAll(),this},Fe.prototype.clearSelection=function(){return this.__controller.cursor.clearSelection(),this},Fe.prototype.moveToDirEnd=function(at){return this.__controller.notify("move").cursor.insAtDirEnd(at,this.__controller.root),this},Fe.prototype.moveToLeftEnd=function(){return this.moveToDirEnd(r)},Fe.prototype.moveToRightEnd=function(){return this.moveToDirEnd(e)},Fe.prototype.keystroke=function(at,dt){for(var Ct=at.replace(/^\s+|\s+$/g,"").split(/\s+/),It=0;It<Ct.length;It+=1)this.__controller.keystroke(Ct[It],dt);return this},Fe.prototype.typedText=function(at){for(var dt=0;dt<at.length;dt+=1)this.__controller.typedText(at.charAt(dt));return this},Fe.prototype.dropEmbedded=function(at,dt,Ct){var It=at-S(),_t=dt-v(),ai=document.elementFromPoint(It,_t);this.__controller.seek(ai,It,_t);var zo=new gD().setOptions(Ct);zo.createLeftOf(this.__controller.cursor)},Fe.prototype.setAriaPostLabel=function(at,dt){return this.__controller.setAriaPostLabel(at,dt),this},Fe.prototype.getAriaPostLabel=function(){return this.__controller.getAriaPostLabel()},Fe.prototype.clickAt=function(at,dt,Ct){Ct=Ct||document.elementFromPoint(at,dt);var It=this.__controller,_t=It.root,ai=_t.domFrag().oneElement();return ai.contains(Ct)||(Ct=ai),It.seek(Ct,at,dt),It.blurred&&this.focus(),this},Fe.prototype.ignoreNextMousedown=function(at){return this.__controller.cursor.options.ignoreNextMousedown=at,this},Fe}(K),se={AbstractMathQuill:K,EditableField:re};a("API.StaticMath defined",ne.StaticMath),se.StaticMath=ne.StaticMath(se),a("API.MathField defined",ne.MathField),se.MathField=ne.MathField(se),a("API.InnerMathField defined",ne.InnerMathField),se.InnerMathField=ne.InnerMathField(se),ne.TextField&&(se.TextField=ne.TextField(se));var we=function(Ke){if(!Ke||!Ke.nodeType)return null;for(var Fe,at=P(Ke).children().toElementArray(),dt=0,Ct=at;dt<Ct.length;dt++){var It=Ct[dt];if(It.classList.contains("dcg-mq-root-block")){Fe=It;break}}var _t=O.getNodeOfElement(Fe),ai=_t&&_t.controller,zo=ai&&se[ai.KIND_OF_MQ];return ai&&zo?new zo(ai):null};we.L=r,we.R=e,we.config=function(Ke){return D(L.prototype,Ke),this},we.registerEmbed=function(Ke,Fe){if(!/^[a-z][a-z0-9]*$/i.test(Ke))throw"Embed name must start with letter and be only letters and digits";X[Ke]=Fe},we.StaticMath=Ye("StaticMath",se.StaticMath),we.MathField=Ye("MathField",se.MathField),we.InnerMathField=Ye("InnerMathField",se.InnerMathField),se.TextField&&(we.TextField=Ye("TextField",se.TextField)),we.prototype=K.prototype,we.EditableField=function(){throw"wtf don't call me, I'm 'abstract'"},we.EditableField.prototype=re.prototype,b<3&&(we.saneKeyboardEvents=Mt);function Ye(Ke,Fe){a(Ke+" is defined",Fe);function at(dt,Ct){if(!dt||!dt.nodeType)return null;var It=we(dt);if(It instanceof Fe)return It;var _t=new Bo(new Fe.RootBlock,dt,new L(b));return _t.KIND_OF_MQ=Ke,new Fe(_t).__mathquillify(Ct||{},b)}return at.prototype=Fe.prototype,at}return we}Se.noConflict=function(){return window.MathQuill=De,Se};var De=window.MathQuill;window.MathQuill=Se;function Ne(G){G.moveOutOf=function(b){a("controller is defined",this.controller),this.controller.handle("moveOutOf",b)},G.deleteOutOf=function(b){a("controller is defined",this.controller),this.controller.handle("deleteOutOf",b)},G.selectOutOf=function(b){a("controller is defined",this.controller),this.controller.handle("selectOutOf",b)},G.upOutOf=function(){a("controller is defined",this.controller),this.controller.handle("upOutOf")},G.downOutOf=function(){a("controller is defined",this.controller),this.controller.handle("downOutOf")},G.reflow=function(){a("controller is defined",this.controller),this.controller.handle("reflow"),this.controller.handle("edited"),this.controller.handle("edit")}}function me(G,b){throw G?G="'"+G+"'":G="EOF","Parse Error: "+b+" at "+G}var ve=function(){function G(b){this._=b}return G.prototype.parse=function(b){return this.skip(G.eof)._(""+b,u,me);function u(m,D){return D}},G.prototype.or=function(b){a("or is passed a parser",b instanceof G);var u=this;return new G(function(m,D,L){return u._(m,D,K);function K(re){return b._(m,D,L)}})},G.prototype.then=function(b){var u=this;return new G(function(m,D,L){return u._(m,K,L);function K(re,se){var we=b instanceof G?b:b(se);return a("a parser is returned",we instanceof G),we._(re,D,L)}})},G.prototype.many=function(){var b=this;return new G(function(u,m,D){for(var L=[];b._(u,K,re););return m(u,L);function K(se,we){return u=se,L.push(we),!0}function re(){return!1}})},G.prototype.times=function(b,u){arguments.length<2&&(u=b);var m=this;return new G(function(D,L,K){for(var re=[],se=!0,we,Ye=0;Ye<b;Ye+=1)if(se=!!m._(D,Ke,Fe),!se)return K(D,we);for(;Ye<u&&se;Ye+=1)m._(D,Ke,at);return L(D,re);function Ke(dt,Ct){return re.push(Ct),D=dt,!0}function Fe(dt,Ct){return we=Ct,D=dt,!1}function at(dt,Ct){return!1}})},G.prototype.result=function(b){return this.then(G.succeed(b))},G.prototype.atMost=function(b){return this.times(0,b)},G.prototype.atLeast=function(b){var u=this;return u.times(b).then(function(m){return u.many().map(function(D){return m.concat(D)})})},G.prototype.map=function(b){return this.then(function(u){return G.succeed(b(u))})},G.prototype.skip=function(b){return this.then(function(u){return b.result(u)})},G.string=function(b){var u=b.length,m="expected '"+b+"'";return new G(function(D,L,K){var re=D.slice(0,u);return re===b?L(D.slice(u),re):K(D,m)})},G.regex=function(b){a("regexp parser is anchored",b.toString().charAt(1)==="^");var u="expected "+b;return new G(function(m,D,L){var K=b.exec(m);if(K){var re=K[0];return D(m.slice(re.length),re)}else return L(m,u)})},G.succeed=function(b){return new G(function(u,m){return m(u,b)})},G.fail=function(b){return new G(function(u,m,D){return D(u,b)})},G.letter=G.regex(/^[a-z]/i),G.letters=G.regex(/^[a-z]*/i),G.digit=G.regex(/^[0-9]/),G.digits=G.regex(/^[0-9]*/),G.whitespace=G.regex(/^\s+/),G.optWhitespace=G.regex(/^\s*/),G.any=new G(function(b,u,m){return b?u(b.slice(1),b.charAt(0)):m(b,"expected any character")}),G.all=new G(function(b,u,m){return u("",b)}),G.eof=new G(function(b,u,m){return b?m(b,"expected EOF"):u(b,b)}),G}(),Pe=function(){function G(){this.fn=o}return G.prototype.listen=function(b){this.fn=b,clearTimeout(this.timeoutId),this.timeoutId=setTimeout(this.fn)},G.prototype.listenOnce=function(b){var u=this;this.listen(function(){for(var m=[],D=0;D<arguments.length;D++)m[D]=arguments[D];u.clearListener(),b.apply(void 0,m)})},G.prototype.clearListener=function(){this.fn=o,clearTimeout(this.timeoutId)},G.prototype.trigger=function(){for(var b=[],u=0;u<arguments.length;u++)b[u]=arguments[u];this.fn.apply(this,b)},G}(),He=function(){var G={8:"Backspace",9:"Tab",10:"Enter",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",144:"NumLock"},b={ArrowRight:"Right",ArrowLeft:"Left",ArrowDown:"Down",ArrowUp:"Up",Delete:"Del",Escape:"Esc"," ":"Spacebar"};function u(K){switch(D(K)){case"Right":case"Left":case"Down":case"Up":return!0}return!1}function m(K){return K.length===1&&K>="a"&&K<="z"}function D(K){var re;if(K.key===void 0){var se=K.which||K.keyCode;return G[se]||String.fromCharCode(se)}return m(K.key)?K.key.toUpperCase():(re=b[K.key])!==null&&re!==void 0?re:K.key}function L(K){var re=D(K),se=[];return K.ctrlKey&&se.push("Ctrl"),K.metaKey&&se.push("Meta"),K.altKey&&se.push("Alt"),K.shiftKey&&se.push("Shift"),se.length?(re!=="Alt"&&re!=="Control"&&re!=="Meta"&&re!=="Shift"&&se.push(re),se.join("-")):re}return function(re,se){var we=null,Ye=null,Ke=new Pe;function Fe(){try{re instanceof HTMLTextAreaElement&&re.select()}catch(z){}}function at(z){Ke.trigger(),Ke.clearListener(),re instanceof HTMLTextAreaElement&&(re.value=z),z&&Fe(),dt=!!z}var dt=!1;function Ct(){return!("selectionStart"in re)||!(re instanceof HTMLTextAreaElement)?!1:re.selectionStart!==re.selectionEnd}function It(){se.options&&se.options.overrideKeystroke?se.options.overrideKeystroke(L(we),we):se.keystroke(L(we),we)}function _t(z){Ke.trigger(z),z.target===re&&(we=z,Ye=null,dt&&Ke.listenOnce(function($){$&&$.type==="focusout"||Fe()}),It())}function ai(z){Ke.trigger(z),z.target===re&&(we&&Ye&&It(),Ye=z,u(z)?Ke.listenOnce(Zo):Ke.listen(ci))}function zo(z){Ke.trigger(z),z.target===re&&we&&!Ye&&(u(z)?Ke.listenOnce(Zo):Ke.listen(ci))}function ci(){if(!Ct()&&re instanceof HTMLTextAreaElement){var z=re.value;we&&!we.altKey&&we.ctrlKey&&!we.metaKey&&we.shiftKey&&(we.key==="U"||we.key==="Unidentified"||we.key==="Process")||(z.length===1?(re.value="",se.options&&se.options.overrideTypedText?se.options.overrideTypedText(z):se.typedText(z)):Zo())}}function Zo(){re instanceof HTMLTextAreaElement&&re.value.length>1&&Fe()}function uo(){we=null,Ye=null,Ke.clearListener(),re instanceof HTMLTextAreaElement&&(re.value="")}function V(z){Ke.trigger(),z.target===re&&(document.activeElement!==re&&re.focus(),Ke.listen(function(){if(re instanceof HTMLTextAreaElement){var oe=re.value;re.value="",oe&&se.paste(oe)}}))}function N(z){Ke.trigger(z)}return se.options&&se.options.disableCopyPaste?se.addTextareaEventListeners({keydown:_t,keypress:ai,keyup:zo,focusout:uo,copy:function(z){z.preventDefault()},cut:function(z){z.preventDefault()},paste:function(z){Ke.trigger(),z.preventDefault()},input:N}):se.addTextareaEventListeners({keydown:_t,keypress:ai,keyup:zo,focusout:uo,cut:function(){Ke.listenOnce(function(){se.cut()})},copy:function(){Ke.listenOnce(function(){se.copy()})},paste:V,input:N}),{select:at}}}(),ot=function(G){At(b,G);function b(){return G!==null&&G.apply(this,arguments)||this}return b.prototype.exportText=function(){return this.root.foldChildren("",function(u,m){return u+m.text()})},b}(le);le.onNotify(function(G,b){if(b==="edit"||b==="replace"||b===void 0){var u=G.controller;if(!u||!u.options.enableDigitGrouping||u.blurred!==!1)return;u.disableGroupingForSeconds(1)}});var Ge=function(G){At(b,G);function b(){var u=G!==null&&G.apply(this,arguments)||this;return u.handleTextareaFocusEditable=function(){var m=u.cursor;u.updateMathspeak(),u.blurred=!1,clearTimeout(u.blurTimeout),P(u.container).addClass("dcg-mq-focused"),m.parent||m.insAtRightEnd(u.root),m.selection?(m.selection.domFrag().removeClass("dcg-mq-blur"),u.selectionChanged()):m.show(),u.setOverflowClasses()},u.handleTextareaBlurEditable=function(){u.textareaSelectionTimeout&&(clearTimeout(u.textareaSelectionTimeout),u.textareaSelectionTimeout=0),u.disableGroupingForSeconds(0),u.blurred=!0,u.blurTimeout=setTimeout(function(){u.root.postOrder(function(m){m.intentionalBlur()}),u.cursor.clearSelection().endSelection(),u.blur(),u.updateMathspeak(),u.scrollHoriz()}),window.addEventListener("blur",u.handleWindowBlur)},u.handleTextareaFocusStatic=function(){u.blurred=!1},u.handleTextareaBlurStatic=function(){u.cursor.selection&&u.cursor.selection.clear(),setTimeout(function(){P(u.getTextareaSpanOrThrow()).detach(),u.blurred=!0})},u.handleWindowBlur=function(){clearTimeout(u.blurTimeout),u.cursor.selection&&u.cursor.selection.domFrag().addClass("dcg-mq-blur"),u.blurWithoutResettingCursor(),u.updateMathspeak()},u}return b.prototype.disableGroupingForSeconds=function(u){var m=this;clearTimeout(this.__disableGroupingTimeout),u===0?this.root.domFrag().removeClass("dcg-mq-suppress-grouping"):(this.root.domFrag().addClass("dcg-mq-suppress-grouping"),this.__disableGroupingTimeout=setTimeout(function(){m.root.domFrag().removeClass("dcg-mq-suppress-grouping")},u*1e3))},b.prototype.blur=function(){this.blurWithoutResettingCursor(),this.options&&this.options.resetCursorOnBlur&&this.cursor.resetToEnd(this)},b.prototype.blurWithoutResettingCursor=function(){this.cursor.hide().parent.blur(this.cursor),P(this.container).removeClass("dcg-mq-focused"),window.removeEventListener("blur",this.handleWindowBlur)},b.prototype.addEditableFocusBlurListeners=function(){var u=this,m=u.cursor;this.addTextareaEventListeners({focus:this.handleTextareaFocusEditable,blur:this.handleTextareaBlurEditable}),u.blurred=!0,m.hide().parent.blur(m)},b.prototype.addStaticFocusBlurListeners=function(){this.addTextareaEventListeners({focus:this.handleTextareaFocusStatic,blur:this.handleTextareaBlurStatic})},b}(ot),Et=!1,Oe=function(G){At(b,G);function b(){return G!==null&&G.apply(this,arguments)||this}return b.prototype.keystroke=function(u,m,D){var L=D.cursor;switch(u){case"Ctrl-Shift-Backspace":case"Ctrl-Backspace":D.ctrlDeleteDir(r);break;case"Shift-Backspace":case"Backspace":D.backspace();break;case"Esc":case"Tab":D.escapeDir(e,u,m);return;case"Shift-Tab":case"Shift-Esc":D.escapeDir(r,u,m);return;case"End":D.notify("move").cursor.insAtRightEnd(L.parent),D.aria.queue("end of").queue(L.parent,!0);break;case"Ctrl-End":D.notify("move").cursor.insAtRightEnd(D.root),D.aria.queue("end of").queue(D.ariaLabel).queue(D.root).queue(D.ariaPostLabel);break;case"Shift-End":D.selectToBlockEndInDir(e);break;case"Ctrl-Shift-End":D.selectToRootEndInDir(e);break;case"Home":D.notify("move").cursor.insAtLeftEnd(L.parent),D.aria.queue("beginning of").queue(L.parent,!0);break;case"Ctrl-Home":D.notify("move").cursor.insAtLeftEnd(D.root),D.aria.queue("beginning of").queue(D.ariaLabel).queue(D.root).queue(D.ariaPostLabel);break;case"Shift-Home":D.selectToBlockEndInDir(r);break;case"Ctrl-Shift-Home":D.selectToRootEndInDir(r);break;case"Left":D.moveLeft();break;case"Shift-Left":D.selectLeft();break;case"Ctrl-Left":break;case"Right":D.moveRight();break;case"Shift-Right":D.selectRight();break;case"Ctrl-Right":break;case"Up":D.moveUp();break;case"Down":D.moveDown();break;case"Shift-Up":D.withIncrementalSelection(function(K){if(L[r])for(;L[r];)K(r);else K(r)});break;case"Shift-Down":D.withIncrementalSelection(function(K){if(L[e])for(;L[e];)K(e);else K(e)});break;case"Ctrl-Up":break;case"Ctrl-Down":break;case"Ctrl-Shift-Del":case"Ctrl-Del":D.ctrlDeleteDir(e);break;case"Shift-Del":case"Del":D.deleteForward();break;case"Meta-A":case"Ctrl-A":D.selectAll();break;case"Ctrl-Alt-Up":L.parent.parent&&L.parent.parent instanceof b?D.aria.queue(L.parent.parent):D.aria.queue("nothing above");break;case"Ctrl-Alt-Down":L.parent&&L.parent instanceof b?D.aria.queue(L.parent):D.aria.queue("block is empty");break;case"Ctrl-Alt-Left":L.parent.parent&&L.parent.parent.getEnd(r)?D.aria.queue(L.parent.parent.getEnd(r)):D.aria.queue("nothing to the left");break;case"Ctrl-Alt-Right":L.parent.parent&&L.parent.parent.getEnd(e)?D.aria.queue(L.parent.parent.getEnd(e)):D.aria.queue("nothing to the right");break;case"Ctrl-Alt-Shift-Down":L.selection?D.aria.queue(L.selection.join("mathspeak"," ").trim()+" selected"):D.aria.queue("nothing selected");break;case"Ctrl-Alt-=":case"Ctrl-Alt-Shift-Right":D.ariaPostLabel.length?D.aria.queue(D.ariaPostLabel):D.aria.queue("no answer");break;default:return}D.aria.alert(),m==null||m.preventDefault(),D.scrollHoriz()},b.prototype.moveOutOf=function(u,m,D){a("overridden or never called on this node",!1)},b.prototype.moveTowards=function(u,m,D){a("overridden or never called on this node",!1)},b.prototype.deleteOutOf=function(u,m){a("overridden or never called on this node",!1)},b.prototype.deleteTowards=function(u,m){a("overridden or never called on this node",!1)},b.prototype.unselectInto=function(u,m){a("overridden or never called on this node",!1)},b.prototype.selectOutOf=function(u,m){a("overridden or never called on this node",!1)},b.prototype.selectTowards=function(u,m){a("overridden or never called on this node",!1)},b}(O);le.onNotify(function(G,b){(b==="move"||b==="upDown")&&G.show().clearSelection()}),J.leftRightIntoCmdGoes=function(G){if(G&&G!=="up"&&G!=="down")throw'"up" or "down" required for leftRightIntoCmdGoes option, got "'+G+'"';return G},le.onNotify(function(G,b){b!=="upDown"&&(G.upDownCache={})}),le.onNotify(function(G,b){b==="edit"&&G.show().deleteSelection()}),le.onNotify(function(G,b){b!=="select"&&G.endSelection()});var Tr=function(G){At(b,G);function b(){return G!==null&&G.apply(this,arguments)||this}return b.prototype.keystroke=function(u,m){this.cursor.parent.keystroke(u,m,this.getControllerSelf())},b.prototype.escapeDir=function(u,m,D){s(u);var L=this.cursor;if(L.parent!==this.root&&(D==null||D.preventDefault()),L.parent!==this.root)return L.clearSelection(),L.parent.moveOutOf(u,L),L.controller.aria.alert(),this.notify("move")},b.prototype.moveDir=function(u){s(u);var m=this.cursor,D=m.options.leftRightIntoCmdGoes,L=m[u];return m.selection?m.insDirOf(u,m.selection.getEnd(u)):L?L.moveTowards(u,m,D):m.parent.moveOutOf(u,m,D),this.notify("move")},b.prototype.moveLeft=function(){return this.moveDir(r)},b.prototype.moveRight=function(){return this.moveDir(e)},b.prototype.moveUp=function(){return this.moveUpDown("up")},b.prototype.moveDown=function(){return this.moveUpDown("down")},b.prototype.moveUpDown=function(u){var m=this,D=m.notify("upDown").cursor,L,K;u==="up"?(L="upInto",K="upOutOf"):(L="downInto",K="downOutOf");var re=D[r],se=D[e],we=se&&se[L],Ye=re&&re[L];return we?D.insAtLeftEnd(we):Ye?D.insAtRightEnd(Ye):D.parent.bubble(function(Ke){var Fe=Ke[K];if(Fe&&(typeof Fe=="function"&&(Fe=Fe.call(Ke,D)),Fe instanceof Oe&&D.jumpUpDown(Ke,Fe),Fe!==!0))return!1}),m},b.prototype.deleteDir=function(u){s(u);var m=this.cursor,D=m[u],L=m.parent.parent,K=m.controller;if(D&&D instanceof Oe)D.sides?K.aria.queue(D.parent.chToCmd(D.sides[-u].ch).mathspeak({createdLeftOf:m})):!D.blocks&&D.parent.ctrlSeq!=="\\text"&&K.aria.queue(D);else if(L&&L instanceof Oe)if(L.sides)K.aria.queue(L.parent.chToCmd(L.sides[u].ch).mathspeak({createdLeftOf:m}));else if(L.blocks&&L.mathspeakTemplate)if(L.upInto&&L.downInto)K.aria.queue(L.mathspeakTemplate[1]);else{var re=L.mathspeakTemplate,se=u===r?re[0]:re[re.length-1];K.aria.queue(se)}else K.aria.queue(L);var we=m.selection;if(this.notify("edit"),!we){var Ye=m[u];Ye?Ye.deleteTowards(u,m):m.parent.deleteOutOf(u,m)}var Ke=m[r],Fe=m[e];return Ke.siblingDeleted&&Ke.siblingDeleted(m.options,e),Fe.siblingDeleted&&Fe.siblingDeleted(m.options,r),m.parent.bubble(function(at){at.reflow()}),this},b.prototype.ctrlDeleteDir=function(u){s(u);var m=this.cursor;if(!m[u]||m.selection)return this.deleteDir(u);this.notify("edit");var D;u===r?D=new w(m.parent.getEnd(r),m[r]):D=new w(m[e],m.parent.getEnd(e)),m.controller.aria.queue(D),D.remove(),m.insAtDirEnd(u,m.parent);var L=m[r],K=m[e];return L&&L.siblingDeleted(m.options,e),K&&K.siblingDeleted(m.options,r),m.parent.bubble(function(re){re.reflow()}),this},b.prototype.backspace=function(){return this.deleteDir(r)},b.prototype.deleteForward=function(){return this.deleteDir(e)},b.prototype.startIncrementalSelection=function(){a("Multiple selections can't be simultaneously open",!Et),Et=!0,this.notify("select");var u=this.cursor;u.anticursor||u.startSelection()},b.prototype.selectDirIncremental=function(u){a("A selection is open",Et),Et=!0;var m=this.cursor,D=m.selection;s(u);var L=m[u];L?D&&D.getEnd(u)===L&&m.anticursor[-u]!==L?L.unselectInto(u,m):L.selectTowards(u,m):m.parent.selectOutOf(u,m)},b.prototype.finishIncrementalSelection=function(){a("A selection is open",Et);var u=this.cursor;u.clearSelection(),u.select()||u.show();var m=u.selection;m&&u.controller.aria.clear().queue(m.join("mathspeak"," ").trim()+" selected"),Et=!1},b.prototype.withIncrementalSelection=function(u){var m=this;try{this.startIncrementalSelection();try{u(function(D){return m.selectDirIncremental(D)})}finally{this.finishIncrementalSelection()}}finally{Et=!1}},b.prototype.selectDir=function(u){this.withIncrementalSelection(function(m){return m(u)})},b.prototype.selectLeft=function(){return this.selectDir(r)},b.prototype.selectRight=function(){return this.selectDir(e)},b.prototype.selectAll=function(){this.notify("move");var u=this.cursor;u.insAtRightEnd(this.root),this.withIncrementalSelection(function(m){for(;u[r];)m(r)})},b.prototype.selectToBlockEndInDir=function(u){var m=this.cursor;this.withIncrementalSelection(function(D){for(;m[u];)D(u)})},b.prototype.selectToRootEndInDir=function(u){var m=this,D=this.cursor;this.withIncrementalSelection(function(L){for(;D[u]||D.parent!==m.root;)L(u)})},b}(Ge),Q=function(G){At(b,G);function b(u){return G.call(this)||this}return b}(Oe),ke=function(){function G(ci){var Zo=new We;return ci.adopt(Zo,0,0),Zo}function b(ci){for(var Zo=ci[0]||new We,uo=1;uo<ci.length;uo+=1)ci[uo].children().adopt(Zo,Zo.getEnd(e),0);return Zo}var u=ve.string,m=ve.regex,D=ve.letter,L=ve.digit,K=ve.any,re=ve.optWhitespace,se=ve.succeed,we=ve.fail,Ye=D.map(function(ci){return new zt(ci)}),Ke=L.map(function(ci){return new vt(ci)}),Fe=m(/^[^${}\\_^]/).map(function(ci){return new al(ci)}),at=m(/^[^\\a-eg-zA-Z]/).or(u("\\").then(m(/^[a-z]+/i).or(m(/^\s+/).result(" ")).or(K))).then(function(ci){var Zo=T[ci];if(Zo)if(Zo.constructor){var uo=Zo;return new uo(ci).parser()}else{var V=Zo;return V(ci).parser()}else return we("unknown command: \\"+ci)}),dt=at.or(Ye).or(Ke).or(Fe),Ct=u("{").then(function(){return _t}).skip(u("}")),It=re.then(Ct.or(dt.map(G))),_t=It.many().map(b).skip(re),ai=u("[").then(It.then(function(ci){return ci.join("latex")!=="]"?se(ci):we("")}).many().map(b).skip(re)).skip(u("]")),zo=_t;return zo.block=It,zo.optBlock=ai,zo}();J.maxDepth=function(G){return typeof G=="number"?G:void 0};var Ue=function(G){At(b,G);function b(){return G!==null&&G.apply(this,arguments)||this}return b.prototype.cleanLatex=function(u){return u.replace(/(\\[a-z]+) (?![a-z])/gi,"$1")},b.prototype.exportLatex=function(){return this.cleanLatex(this.root.latex())},b.prototype.writeLatex=function(u){var m=this.notify("edit").cursor;return m.parent.writeLatex(m,u),this},b.prototype.exportLatexSelection=function(){var u={latex:"",startIndex:-1,endIndex:-1},m=this.cursor.selection;if(m)u.startSelectionBefore=m.getEnd(r),u.endSelectionAfter=m.getEnd(e);else{var D=this.cursor[r];D?u.startSelectionAfter=D:u.startSelectionBefore=this.cursor.parent;var L=this.cursor[e];L?u.endSelectionBefore=L:u.endSelectionAfter=this.cursor.parent}this.root.latexRecursive(u);for(var K=u.latex,re=this.cleanLatex(K),se=u.startIndex,we=u.endIndex,Ye=0,Ke=0;Ke<u.endIndex;Ke++)K[Ke]!==re[Ye]?(Ke<u.startIndex&&(se-=1),we-=1):Ye+=1;return{latex:re,startIndex:se,endIndex:we}},b.prototype.classifyLatexForEfficientUpdate=function(u){if(typeof u=="string"){var m=u.match(/-?[0-9.]+$/g);if(m&&m.length===1)return{latex:u,prefix:u.substr(0,u.length-m[0].length),digits:m[0]}}},b.prototype.updateLatexMathEfficiently=function(u,m){var D,L,K,re,se=this.root,we,Ye=this.classifyLatexForEfficientUpdate(u);if(Ye){if(we=this.classifyLatexForEfficientUpdate(m),!we||we.prefix!==Ye.prefix)return!1}else return!1;var Ke=we.digits,Fe=Ye.digits,at=!1,dt=!1;Ke[0]==="-"&&(at=!0,Ke=Ke.substr(1)),Fe[0]==="-"&&(dt=!0,Fe=Fe.substr(1));for(var Ct=this.root.getEnd(e),It=[],_t=Ke.length-1;_t>=0;_t--){if(!Ct||Ct.ctrlSeq!==Ke[_t]||Ct.parent!==se)return!1;It.unshift(Ct),Ct=Ct[r]}if(at&&!dt){var ai=Ct;if(!ai||ai.ctrlSeq!=="-"||ai[e]!==It[0]||ai.parent!==se)return!1;var zo=ai[r];if(zo&&zo.parent!==se)return!1;It[0][r]=ai[r],se.getEnd(r)===ai&&se.setEnds((D={},D[r]=It[0],D[e]=se.getEnd(e),D)),zo&&(zo[e]=It[0]),ai.domFrag().remove()}if(!at&&dt){var ci=new Om("-"),Zo=document.createElement("span");Zo.textContent="-",ci.setDOM(Zo);var uo=It[0][r];uo&&(uo[e]=ci),se.getEnd(r)===It[0]&&se.setEnds((L={},L[r]=ci,L[e]=se.getEnd(e),L)),ci.parent=se,ci[r]=It[0][r],ci[e]=It[0],It[0][r]=ci,ci.contactWeld(this.cursor),ci.domFrag().insertBefore(It[0].domFrag())}var V=Math.min(Ke.length,Fe.length);for(_t=0;_t<V;_t++){var N=Fe[_t];Ct=It[_t],Ct.ctrlSeq!==N&&(Ct.ctrlSeq=N,Ct.domFrag().oneElement().textContent=N,Ct.mathspeakName=N)}if(Ke.length>Fe.length)for(Ct=It[Fe.length-1],se.setEnds((K={},K[r]=se.getEnd(r),K[e]=Ct,K)),Ct[e]=0,_t=Ke.length-1;_t>=V;_t--)It[_t].domFrag().remove();if(Fe.length>Ke.length){var z=document.createDocumentFragment();for(_t=V;_t<Fe.length;_t++){var $=document.createElement("span");$.className="dcg-mq-digit",$.textContent=Fe[_t];var oe=new vt(Fe[_t]);oe.parent=se,oe.setDOM($),z.appendChild($),oe[r]=se.getEnd(e),oe[e]=0;var ye=oe[r];ye[e]=oe,se.setEnds((re={},re[r]=se.getEnd(r),re[e]=oe,re))}se.domFrag().oneElement().appendChild(z)}var Me=this.exportLatex();if(Me!==u)return console.warn("tried updating latex efficiently but did not work. Attempted: "+u+" but wrote: "+Me),!1;var Je=se.getEnd(e);return Je&&Je.fixDigitGrouping(this.cursor.options),!0},b.prototype.renderLatexMathFromScratch=function(u){var m,D=this.root,L=this.cursor,K=ve.all,re=ve.eof,se=ke.skip(re).or(K.result(!1)).parse(u);if(D.setEnds((m={},m[r]=0,m[e]=0,m)),se&&se.children().adopt(D,0,0),se){var we=D.domFrag();we.children().remove(),we.oneElement().appendChild(se.html()),D.finalizeInsert(L.options,L)}else D.domFrag().empty()},b.prototype.renderLatexMath=function(u){var m=this.cursor,D=this.root;this.notify("replace"),m.clearSelection();var L=this.exportLatex();(!D.getEnd(r)||!D.getEnd(e)||L!==u)&&(this.updateLatexMathEfficiently(u,L)||this.renderLatexMathFromScratch(u),this.updateMathspeak()),m.insAtRightEnd(D)},b.prototype.renderLatexText=function(u){var m,D=this.root,L=this.cursor;D.domFrag().children().slice(1).remove(),D.setEnds((m={},m[r]=0,m[e]=0,m)),delete L.selection,L.show().insAtRightEnd(D);var K=ve.regex,re=ve.string,se=ve.eof,we=ve.all,Ye=re("$").then(ke).skip(re("$").or(se)).map(function(It){var _t=new RootMathCommand(L);_t.createBlocks();var ai=_t.getEnd(r);return It.children().adopt(ai,0,0),_t}),Ke=re("\\$").result("$"),Fe=Ke.or(K(/^[^$]/)).map(function(It){return new al(It)}),at=Ye.or(Fe).many(),dt=at.skip(se).or(we.result(!1)).parse(u);if(dt){for(var Ct=0;Ct<dt.length;Ct+=1)dt[Ct].adopt(D,D.getEnd(e),0);P(D.html()).appendTo(D.domFrag().oneElement()),D.finalizeInsert(L.options,L)}},b}(Tr),xe=function(G){return!1};ge.prototype.ignoreNextMousedown=xe;var ct;(function(){le.onNotify(function(G,b){(b==="edit"||b==="replace")&&ct&&ct.cursor===G&&ct.cb()})})();var it=function(G){At(b,G);function b(){var u=G!==null&&G.apply(this,arguments)||this;return u.handleMouseDown=function(m){var D=d(m.target,".dcg-mq-root-block"),L=D&&O.getNodeOfElement(D)||O.getNodeOfElement(u.root.domFrag().oneElement()),K=L.domFrag().firstNode().ownerDocument,re=L.controller,se=re.cursor,we=se.blink,Ye=re.getTextareaSpanOrThrow(),Ke=re.getTextareaOrThrow();if(m.preventDefault(),m.target.unselectable=!0,se.options.ignoreNextMousedown(m)||d(m.target,".dcg-mq-ignore-mousedown"))return;var Fe=null;function at(zo){Fe=zo.target}function dt(zo){se.anticursor||se.startSelection(),re.seek(Fe,zo.clientX,zo.clientY).cursor.select(),se.selection&&se.controller.aria.clear().queue(se.selection.join("mathspeak")+" selected").alert(),Fe=null}function Ct(){D==null||D.removeEventListener("mousemove",at),K==null||K.removeEventListener("mousemove",dt),K==null||K.removeEventListener("mouseup",_t),ct=void 0}function It(){re.editable?(se.show(),se.controller.aria.queue(se.parent).alert()):P(Ye).detach()}function _t(){se.blink=we,se.selection||It(),Ct()}var ai;ct={cursor:se,cb:function(){ai=!0,se.blink=we,se.clearSelection(),It(),Ct()}},!(re.blurred&&(D&&!re.editable&&P(D).prepend(P(Ye)),Ke.focus(),ai))&&(se.blink=o,re.seek(m.target,m.clientX,m.clientY).cursor.startSelection(),D==null||D.addEventListener("mousemove",at),K==null||K.addEventListener("mousemove",dt),K==null||K.addEventListener("mouseup",_t))},u}return b.prototype.addMouseEventListener=function(){this.container.addEventListener("mousedown",this.handleMouseDown)},b.prototype.removeMouseEventListener=function(){this.container.removeEventListener("mousedown",this.handleMouseDown)},b.prototype.seek=function(u,m,D){for(var L=this.notify("select").cursor,K;u&&(K=O.getNodeOfElement(u),!K);)u=u.parentElement;return K||(K=this.root),L.clearSelection().show(),K.seek(m,L),this.scrollHoriz(),this},b}(Ue),li=function(G){At(b,G);function b(){return G!==null&&G.apply(this,arguments)||this}return b.prototype.setOverflowClasses=function(){var u=this.root.domFrag().oneElement(),m=!1,D=!1;if(!this.blurred){var L=C(u).width,K=u.scrollWidth,re=u.scrollLeft;m=K>L+re,D=re>0}u.classList.contains("dcg-mq-editing-overflow-right")!==m&&u.classList.toggle("dcg-mq-editing-overflow-right"),u.classList.contains("dcg-mq-editing-overflow-left")!==D&&u.classList.toggle("dcg-mq-editing-overflow-left")},b.prototype.scrollHoriz=function(){var u=this,m=this.cursor,D=m.selection,L=C(this.root.domFrag().oneElement());if(m.domFrag().isEmpty()&&!D){this.cancelScrollHoriz&&(this.cancelScrollHoriz(),this.cancelScrollHoriz=void 0);var K=this.root.domFrag().oneElement(),re=K.scrollLeft;M(this.getScrollAnimationDuration(),function(It,_t,ai){It>=1?(u.cancelScrollHoriz=void 0,K.scrollLeft=0,u.setOverflowClasses()):(u.cancelScrollHoriz=ai,_t(),K.scrollLeft=Math.round((1-It)*re))});return}else if(D){var Ye=C(D.domFrag().oneElement()),Ke=Ye.left-(L.left+20),Fe=Ye.right-(L.right-20);if(D.getEnd(r)===m[e])if(Ke<0)var we=Ke;else if(Fe>0)if(Ye.left-Fe<L.left+20)var we=Ke;else var we=Fe;else return;else if(Fe>0)var we=Fe;else if(Ke<0)if(Ye.right-Ke>L.right-20)var we=Fe;else var we=Ke;else return}else{var se=C(m.domFrag().oneElement()).left;if(se>L.right-20)var we=se-(L.right-20);else if(se<L.left+20)var we=se-(L.left+20);else return}var at=this.root.domFrag().oneElement();if(!(we<0&&at.scrollLeft===0)&&!(we>0&&at.scrollWidth<=at.scrollLeft+L.width)){this.cancelScrollHoriz&&(this.cancelScrollHoriz(),this.cancelScrollHoriz=void 0);var dt=this.root.domFrag().oneElement(),Ct=dt.scrollLeft;M(this.getScrollAnimationDuration(),function(It,_t,ai){It>=1?(u.cancelScrollHoriz=void 0,dt.scrollLeft=Math.round(Ct+we),u.setOverflowClasses()):(u.cancelScrollHoriz=ai,_t(),dt.scrollLeft=Math.round(Ct+It*we))})}},b.prototype.getScrollAnimationDuration=function(){var u;return(u=this.options.scrollAnimationDuration)!==null&&u!==void 0?u:100},b}(it);ge.prototype.substituteTextarea=function(){return c("textarea",{autocapitalize:"off",autocomplete:"off",autocorrect:"off",spellcheck:!1,"x-palm-disable-ste-all":!0})};function Mt(G,b){return He(G[0],b)}ge.prototype.substituteKeyboardEvents=Mt;var Bo=function(G){At(b,G);function b(){var u=G!==null&&G.apply(this,arguments)||this;return u.selectFn=o,u}return b.prototype.createTextarea=function(){this.textareaSpan=c("span",{class:"dcg-mq-textarea"});var u=this.options.substituteTextarea();if(!u.nodeType)throw"substituteTextarea() must return a DOM element, got "+u;this.textarea=P(u).appendTo(this.textareaSpan).oneElement();var m=this;m.cursor.selectionChanged=function(){m.selectionChanged()}},b.prototype.selectionChanged=function(){var u=this;u.textareaSelectionTimeout||(u.textareaSelectionTimeout=setTimeout(function(){u.setTextareaSelection()}))},b.prototype.setTextareaSelection=function(){this.textareaSelectionTimeout=0;var u="";this.cursor.selection&&(u=this.cleanLatex(this.cursor.selection.join("latex")),this.options.statelessClipboard&&(u="$"+u+"$")),this.selectFn(u)},b.prototype.staticMathTextareaEvents=function(){var u=this;this.removeTextareaEventListener("cut"),this.removeTextareaEventListener("paste"),u.options.disableCopyPaste?this.removeTextareaEventListener("copy"):this.addTextareaEventListeners({copy:function(){u.setTextareaSelection()}}),this.addStaticFocusBlurListeners(),u.selectFn=function(m){var D=u.getTextareaOrThrow();D instanceof HTMLTextAreaElement&&(D.value=m,m&&D.select())}},b.prototype.editablesTextareaEvents=function(){var u=this,m=u.getTextareaOrThrow(),D=u.getTextareaSpanOrThrow();if(this.options.version<3){var L=this.options.assertJquery(),K=this.options.substituteKeyboardEvents(L(m),this);this.selectFn=function(se){K.select(se)}}else{var re=He(m,this).select;this.selectFn=re}P(this.container).prepend(P(D)),this.addEditableFocusBlurListeners(),this.updateMathspeak()},b.prototype.unbindEditablesEvents=function(){var u=this,m=u.getTextareaOrThrow(),D=u.getTextareaSpanOrThrow();this.selectFn=function(L){m instanceof HTMLTextAreaElement&&(m.value=L,L&&m.select())},P(D).remove(),this.removeTextareaEventListener("focus"),this.removeTextareaEventListener("blur"),u.blurred=!0,this.removeTextareaEventListener("cut"),this.removeTextareaEventListener("paste")},b.prototype.typedText=function(u){if(u===`
`)return this.handle("enter");var m=this.notify(void 0).cursor;m.parent.write(m,u),this.scrollHoriz()},b.prototype.cut=function(){var u=this,m=u.cursor;m.selection&&setTimeout(function(){u.notify("edit"),m.parent.bubble(function(D){D.reflow()}),u.options&&u.options.onCut&&u.options.onCut()})},b.prototype.copy=function(){this.setTextareaSelection()},b.prototype.paste=function(u){this.options.statelessClipboard&&(u.slice(0,1)==="$"&&u.slice(-1)==="$"?u=u.slice(1,-1):u="\\text{"+u+"}"),this.writeLatex(u).cursor.show(),this.scrollHoriz(),this.options&&this.options.onPaste&&this.options.onPaste()},b.prototype.setupStaticField=function(){this.mathspeakSpan=c("span",{class:"dcg-mq-mathspeak"}),P(this.container).prepend(P(this.mathspeakSpan)),this.updateMathspeak(),this.blurred=!0,this.cursor.hide().parent.blur(this.cursor)},b.prototype.updateMathspeak=function(){var u=this,m=u.getAriaLabel(),D=/[A-Za-z0-9]$/.test(m)?m+":":m,L=u.root.mathspeak().trim();this.aria.clear();var K=u.getTextareaOrThrow();u.mathspeakSpan?(K.setAttribute("aria-label",""),u.mathspeakSpan.textContent=(D+" "+L).trim()):K.setAttribute("aria-label",(D+" "+L+" "+u.ariaPostLabel).trim())},b}(li),Di=function(G){At(b,G);function b(){return G!==null&&G.apply(this,arguments)||this}return b.prototype.finalizeInsert=function(u,m){var D=this;D.postOrder(function(re){re.finalizeTree(u)}),D.postOrder(function(re){re.contactWeld(m)}),D.postOrder(function(re){re.blur(m)}),D.postOrder(function(re){re.reflow()});var L=D[e],K=D[r];L&&L.siblingCreated(u,r),K&&K.siblingCreated(u,e),D.bubble(function(re){re.reflow()})},b.prototype.prepareInsertionAt=function(u){var m=u.options.maxDepth;if(m!==void 0){var D=u.depth();if(D>m)return!1;this.removeNodesDeeperThan(m-D)}return!0},b.prototype.removeNodesDeeperThan=function(u){for(var m=0,D=[[this,m]],L;L=D.shift();){var K=L;K[0].children().each(function(re){var se=re instanceof We?1:0;m=K[1]+se,m<=u?D.push([re,m]):(se?re.children():re).remove()})}},b}(Oe),Br=function(){function G(b,u){this.childCount=b,this.render=u}return G}(),ni=function(G){At(b,G);function b(u,m,D){var L=G.call(this)||this;return L.textTemplate=[""],L.mathspeakTemplate=[""],L.setCtrlSeqHtmlAndText(u,m,D),L}return b.prototype.setEnds=function(u){a("MathCommand ends are never empty",u[r]&&u[e]),this.ends=u},b.prototype.getEnd=function(u){return this.ends[u]},b.prototype.setCtrlSeqHtmlAndText=function(u,m,D){this.ctrlSeq||(this.ctrlSeq=u),m&&(this.domView=m),D&&(this.textTemplate=D)},b.prototype.replaces=function(u){u.disown(),this.replacedFragment=u},b.prototype.isEmpty=function(){return this.foldChildren(!0,function(u,m){return u&&m.isEmpty()})},b.prototype.parser=function(){var u=this,m=ke.block;return m.times(this.numBlocks()).map(function(D){u.blocks=D;for(var L=0;L<D.length;L+=1)D[L].adopt(u,u.getEnd(e),0);return u})},b.prototype.createLeftOf=function(u){var m=this,D=m.replacedFragment;if(m.createBlocks(),G.prototype.createLeftOf.call(this,u),D){var L=m.getEnd(r);D.adopt(L,0,0),D.domFrag().appendTo(L.domFrag().oneElement()),m.placeCursor(u),m.prepareInsertionAt(u)}m.finalizeInsert(u.options,u),m.placeCursor(u)},b.prototype.createBlocks=function(){for(var u=this,m=u.numBlocks(),D=u.blocks=Array(m),L=0;L<m;L+=1){var K=D[L]=new We;K.adopt(u,u.getEnd(e),0)}},b.prototype.placeCursor=function(u){u.insAtRightEnd(this.foldChildren(this.getEnd(r),function(m,D){return m.isEmpty()?m:D}))},b.prototype.moveTowards=function(u,m,D){var L;D==="up"?L=this.upInto:D==="down"&&(L=this.downInto);var K=L||this.getEnd(-u);m.insAtDirEnd(-u,K),m.controller.aria.queueDirEndOf(-u).queue(m.parent,!0)},b.prototype.deleteTowards=function(u,m){this.isEmpty()?m[u]=this.remove()[u]:this.moveTowards(u,m)},b.prototype.selectTowards=function(u,m){m[-u]=this,m[u]=this[u]},b.prototype.selectChildren=function(){return new pe(this,this)},b.prototype.unselectInto=function(u,m){var D=m.anticursor,L=D.ancestors[this.id];m.insAtDirEnd(-u,L)},b.prototype.seek=function(u,m){function D(se){var we,Ye=se.domFrag().oneElement(),Ke=C(Ye).left,Fe=Ke+Ye.offsetWidth;return we={},we[r]=Ke,we[e]=Fe,we}var L=this,K=D(L);if(u<K[r])return m.insLeftOf(L);if(u>K[e])return m.insRightOf(L);var re=K[r];L.eachChild(function(se){var we=D(se);if(u<we[r])return u-re<we[r]-u?se[r]?m.insAtRightEnd(se[r]):m.insLeftOf(L):m.insAtLeftEnd(se),!1;if(u>we[e]){se[e]?re=we[e]:K[e]-u<u-we[e]?m.insRightOf(L):m.insAtRightEnd(se);return}else return se.seek(u,m),!1})},b.prototype.numBlocks=function(){return this.domView.childCount},b.prototype.html=function(){var u=this.blocks;a("domView is defined",this.domView);var m=this.domView,D=m.render(u||[]);return this.setDOM(D),O.linkElementByCmdNode(D,this),D},b.prototype.latexRecursive=function(u){this.checkCursorContextOpen(u),u.latex+=this.ctrlSeq||"",this.eachChild(function(m){u.latex+="{";var D=u.latex.length;m.latexRecursive(u);var L=u.latex.length;D===L&&(u.latex+=" "),u.latex+="}"}),this.checkCursorContextClose(u)},b.prototype.text=function(){var u=this,m=0;return u.foldChildren(u.textTemplate[m],function(D,L){m+=1;var K=L.text();return D&&u.textTemplate[m]==="("&&K[0]==="("&&K.slice(-1)===")"?D+K.slice(1,-1)+u.textTemplate[m]:D+K+(u.textTemplate[m]||"")})},b.prototype.mathspeak=function(){var u=this,m=0;return u.foldChildren(u.mathspeakTemplate[m]||"Start"+u.ctrlSeq+" ",function(D,L){return m+=1,D+" "+L.mathspeak()+" "+(u.mathspeakTemplate[m]+" "||"End"+u.ctrlSeq+" ")})},b}(Di),Uo=function(G){At(b,G);function b(u,m,D,L){var K=G.call(this)||this;return K.setCtrlSeqHtmlTextAndMathspeak(u,m?new Br(0,function(){return m.cloneNode(!0)}):void 0,D,L),K}return b.prototype.setCtrlSeqHtmlTextAndMathspeak=function(u,m,D,L){!D&&u&&(D=u.replace(/^\\/,"")),this.mathspeakName=L||D,G.prototype.setCtrlSeqHtmlAndText.call(this,u,m,[D||""])},b.prototype.parser=function(){return ve.succeed(this)},b.prototype.numBlocks=function(){return 0},b.prototype.replaces=function(u){u.remove()},b.prototype.createBlocks=function(){},b.prototype.moveTowards=function(u,m){m.domFrag().insDirOf(u,this.domFrag()),m[-u]=this,m[u]=this[u],m.controller.aria.queue(this)},b.prototype.deleteTowards=function(u,m){m[u]=this.remove()[u]},b.prototype.seek=function(u,m){var D=this.domFrag().oneElement(),L=C(D).left;return u-L<D.offsetWidth/2?m.insLeftOf(this):m.insRightOf(this),m},b.prototype.latexRecursive=function(u){this.checkCursorContextOpen(u),u.latex+=this.ctrlSeq||"",this.checkCursorContextClose(u)},b.prototype.text=function(){return this.textTemplate.join("")},b.prototype.mathspeak=function(u){return this.mathspeakName||""},b.prototype.placeCursor=function(){},b.prototype.isEmpty=function(){return!0},b}(ni),al=function(G){At(b,G);function b(u,m,D){return G.call(this,u,c("span",{},[m||c.text(u)]),void 0,D)||this}return b}(Uo);function Xt(G,b,u){return function(){return new al(G,b?c.entityText(b):void 0,u)}}var he=function(G){At(b,G);function b(u,m,D,L,K){var re=this;return K?re=G.call(this,u,c("span",{},[m||c.text(u||"")]),void 0,L)||this:re=G.call(this,u,c("span",{class:"dcg-mq-binary-operator"},m?[m]:[]),D,L)||this,re}return b}(Uo);function Qe(G,b,u,m){return function(){return new he(G,b?c.entityText(b):void 0,u,m)}}var We=function(G){At(b,G);function b(){var u=G!==null&&G.apply(this,arguments)||this;return u.ariaLabel="block",u}return b.prototype.join=function(u){return this.foldChildren("",function(m,D){return m+D[u]()})},b.prototype.html=function(){var u=document.createDocumentFragment();return this.eachChild(function(m){var D=m.html();u.appendChild(D)}),u},b.prototype.latexRecursive=function(u){this.checkCursorContextOpen(u),this.eachChild(function(m){return m.latexRecursive(u)}),this.checkCursorContextClose(u)},b.prototype.text=function(){var u=this.getEnd(r),m=this.getEnd(e);return u===m&&u!==0?u.text():this.join("text")},b.prototype.mathspeak=function(){var u="",m={};return this.controller&&(m=this.controller.options.autoOperatorNames),this.foldChildren([],function(D,L){if(L.isPartOfOperator)u+=L.mathspeak();else{if(u!==""){if(m._maxLength>0){var K=m[u.toLowerCase()];typeof K=="string"&&(u=K)}D.push(u+" "),u=""}var re=L.mathspeak(),se=L.ctrlSeq;isNaN(se)&&se!=="."&&(!L.parent||!L.parent.parent||!L.parent.parent.isTextBlock())&&(re=" "+re+" "),D.push(re)}return D}).join("").replace(/ +(?= )/g,"").replace(/(\.)([0-9]+)/g,function(D,L,K){return L+K.split("").join(" ").trim()})},b.prototype.keystroke=function(u,m,D){if(D.options.spaceBehavesLikeTab&&(u==="Spacebar"||u==="Shift-Spacebar")){m==null||m.preventDefault(),D.escapeDir(u==="Shift-Spacebar"?r:e,u,m);return}return G.prototype.keystroke.call(this,u,m,D)},b.prototype.moveOutOf=function(u,m,D){var L;if(D==="up"?L=this.parent.upInto:D==="down"&&(L=this.parent.downInto),!L&&this[u]){var K=-u;m.insAtDirEnd(K,this[u]),m.controller.aria.queueDirEndOf(K).queue(m.parent,!0)}else m.insDirOf(u,this.parent),m.controller.aria.queueDirOf(u).queue(this.parent)},b.prototype.selectOutOf=function(u,m){m.insDirOf(u,this.parent)},b.prototype.deleteOutOf=function(u,m){m.unwrapGramp()},b.prototype.seek=function(u,m){var D=this.getEnd(e);if(!D)return m.insAtRightEnd(this);var L=D.domFrag().oneElement(),K=C(L).left;if(K+L.offsetWidth<u)return m.insAtRightEnd(this);var re=this.getEnd(r);if(u<C(re.domFrag().oneElement()).left)return m.insAtLeftEnd(this);for(;u<C(D.domFrag().oneElement()).left;)D=D[r];return D.seek(u,m)},b.prototype.chToCmd=function(u,m){var D;return u.match(/^[a-eg-zA-Z]$/)?new zt(u):/^\d$/.test(u)?new vt(u):m&&m.typingSlashWritesDivisionSymbol&&u==="/"?T["\xF7"](u):m&&m.typingAsteriskWritesTimesSymbol&&u==="*"?T["\xD7"](u):m&&m.typingPercentWritesPercentOf&&u==="%"?T.percentof(u):(D=B[u]||T[u])?D.constructor?new D(u):D(u):new al(u)},b.prototype.write=function(u,m){var D=this.chToCmd(m,u.options);u.selection&&D.replaces(u.replaceSelection()),u.isTooDeep()||(D.createLeftOf(u.show()),m==="/"?u.controller.aria.alert("over"):u.controller.aria.alert(D.mathspeak({createdLeftOf:u})))},b.prototype.writeLatex=function(u,m){var D=ve.all,L=ve.eof,K=ke.skip(L).or(D.result(!1)).parse(m);if(K&&!K.isEmpty()&&K.prepareInsertionAt(u)){K.children().adopt(u.parent,u[r],u[e]),P(K.html()).insertBefore(u.domFrag()),u[r]=K.getEnd(e),K.finalizeInsert(u.options,u);var re=K.getEnd(e),se=K.getEnd(r),we=re[e],Ye=se[r];we&&we.siblingCreated(u.options,r),Ye&&Ye.siblingCreated(u.options,e),u.parent.bubble(function(Ke){Ke.reflow()})}},b.prototype.focus=function(){return this.domFrag().addClass("dcg-mq-hasCursor"),this.domFrag().removeClass("dcg-mq-empty"),this},b.prototype.blur=function(u){return this.domFrag().removeClass("dcg-mq-hasCursor"),this.isEmpty()&&(this.domFrag().addClass("dcg-mq-empty"),u&&this.isQuietEmptyDelimiter(u.options.quietEmptyDelimiters)&&this.domFrag().addClass("dcg-mq-quiet-delimiter")),this},b}(Di);ge.prototype.mouseEvents=!0,ne.StaticMath=function(G){var b;return b=function(u){At(m,u);function m(D){var L=u.call(this,D)||this,K=L.innerFields=[];return L.__controller.root.postOrder(function(re){re.registerInnerField(K,G.InnerMathField)}),L}return m.prototype.__mathquillify=function(D,L){return this.config(D),u.prototype.mathquillify.call(this,"dcg-mq-math-mode"),this.__controller.setupStaticField(),this.__options.mouseEvents&&(this.__controller.addMouseEventListener(),this.__controller.staticMathTextareaEvents()),this},m.prototype.latex=function(D){var L=u.prototype.latex.apply(this,arguments);if(arguments.length>0){var K=this.innerFields=[];this.__controller.root.postOrder(function(re){re.registerInnerField(K,G.InnerMathField)}),this.__controller.updateMathspeak()}return L},m.prototype.setAriaLabel=function(D){return this.__controller.setAriaLabel(D),this},m.prototype.getAriaLabel=function(){return this.__controller.getAriaLabel()},m}(G.AbstractMathQuill),b.RootBlock=We,b};var nt=function(G){At(b,G);function b(){return G!==null&&G.apply(this,arguments)||this}return b}(We);Ne(nt.prototype),ne.MathField=function(G){var b;return b=function(u){At(m,u);function m(){return u!==null&&u.apply(this,arguments)||this}return m.prototype.__mathquillify=function(D,L){return this.config(D),L>1&&(this.__controller.root.reflow=o),u.prototype.mathquillify.call(this,"dcg-mq-editable-field dcg-mq-math-mode"),delete this.__controller.root.reflow,this},m}(G.EditableField),b.RootBlock=nt,b},ne.InnerMathField=function(G){return a("MathField class is defined",G.MathField),function(b){At(u,b);function u(){return b!==null&&b.apply(this,arguments)||this}return u.prototype.makeStatic=function(){this.__controller.editable=!1,this.__controller.root.blur(),this.__controller.unbindEditablesEvents(),P(this.__controller.container).removeClass("dcg-mq-editable-field")},u.prototype.makeEditable=function(){this.__controller.editable=!0,this.__controller.editablesTextareaEvents(),this.__controller.cursor.insAtRightEnd(this.__controller.root),P(this.__controller.container).addClass("dcg-mq-editable-field")},u}(G.MathField)};var St=function(G){At(b,G);function b(){return G!==null&&G.apply(this,arguments)||this}return b.prototype.finalizeTree=function(u,m){this.sharedSiblingMethod(u,m)},b.prototype.siblingDeleted=function(u,m){this.sharedSiblingMethod(u,m)},b.prototype.siblingCreated=function(u,m){this.sharedSiblingMethod(u,m)},b.prototype.sharedSiblingMethod=function(u,m){m!==r&&this[e]instanceof b||this.fixDigitGrouping(u)},b.prototype.fixDigitGrouping=function(u){if(u.enableDigitGrouping){var m=this,D=this,L=0,K=[],re="\\ ",se=".",we=m;do if(/^[0-9]$/.test(we.ctrlSeq))m=we;else if(we.ctrlSeq===re)m=we,L+=1;else if(we.ctrlSeq===se)m=we,K.push(we);else break;while(we=m[r]);for(;we=D[e];)if(/^[0-9]$/.test(we.ctrlSeq))D=we;else if(we.ctrlSeq===re)D=we,L+=1;else if(we.ctrlSeq===se)D=we,K.push(we);else break;for(;D!==m&&m&&m.ctrlSeq===re;)m=m[e],L-=1;for(;D!==m&&D&&D.ctrlSeq===re;)D=D[r],L-=1;if(!(m===D&&m&&m.ctrlSeq===re)){var Ye=L>0||K.length>1;Ye?this.removeGroupingBetween(m,D):K[0]?(K[0]!==m&&this.addGroupingBetween(K[0][r],m),K[0]!==D&&this.removeGroupingBetween(K[0][e],D)):this.addGroupingBetween(D,m)}}},b.prototype.removeGroupingBetween=function(u,m){var D=u;do if(D instanceof b&&D.setGroupingClass(void 0),!D||D===m)break;while(D=D[e])},b.prototype.addGroupingBetween=function(u,m){for(var re=u,D=0,L=0,re=u;re&&(L+=1,re!==m);)re=re[r];var K=L%3;K===0&&(K=3);for(var re=u;re;){D+=1;var se=void 0;if(L>=4&&(D===L?se="dcg-mq-group-leading-"+K:D%3===0&&D!==L&&(se="dcg-mq-group-start"),se||(se="dcg-mq-group-other")),re instanceof b&&re.setGroupingClass(se),re===m)break;re=re[r]}},b.prototype.setGroupingClass=function(u){this._groupingClass!==u&&(this._groupingClass&&this.domFrag().removeClass(this._groupingClass),u&&this.domFrag().addClass(u),this._groupingClass=u)},b}(Uo),vt=function(G){At(b,G);function b(u,m){return G.call(this,u,c("span",{class:"dcg-mq-digit"},[c.text(u)]),void 0,m)||this}return b.prototype.createLeftOf=function(u){var m=u[r],D=m&&m[r],L=u.parent.parent instanceof Rl?u.parent.parent.sub:void 0;u.options.autoSubscriptNumerals&&u.parent!==L&&(m instanceof Lt&&m.isItalic!==!1||m instanceof Rl&&D instanceof Lt&&D.isItalic!==!1)?(new oD().createLeftOf(u),G.prototype.createLeftOf.call(this,u),u.insRightOf(u.parent.parent)):G.prototype.createLeftOf.call(this,u)},b.prototype.mathspeak=function(u){if(u&&u.createdLeftOf){var m=u.createdLeftOf,D=m[r],L=D&&D[r],K=m.parent.parent instanceof Rl?m.parent.parent.sub:void 0;if(m.options.autoSubscriptNumerals&&m.parent!==K&&(D instanceof Lt&&D.isItalic!==!1||m[r]instanceof Rl&&L instanceof Lt&&L.isItalic!==!1))return"Subscript "+G.prototype.mathspeak.call(this)+" Baseline"}return G.prototype.mathspeak.call(this)},b}(St),Lt=function(G){At(b,G);function b(u,m){return G.call(this,u,c("var",{},[m||c.text(u)]))||this}return b.prototype.text=function(){var u=this.ctrlSeq||"";return this.isPartOfOperator?u[0]=="\\"?u=u.slice(1,u.length):u[u.length-1]==" "&&(u=u.slice(0,-1)):(this[r]&&!(this[r]instanceof b)&&!(this[r]instanceof he)&&this[r].ctrlSeq!=="\\ "&&(u="*"+u),this[e]&&!(this[e]instanceof he)&&!(this[e]instanceof Rl)&&(u+="*")),u},b.prototype.mathspeak=function(){var u=this.ctrlSeq||"";return this.isPartOfOperator||u.length>1||this.parent&&this.parent.parent&&this.parent.parent.isTextBlock()?G.prototype.mathspeak.call(this):'"'+u+'"'},b}(Uo);function Rt(G,b,u){return function(){return new Lt(G,c.entityText(b))}}ge.prototype.autoCommands={_maxLength:0},J.autoCommands=function(G){if(typeof G!="string"||!/^[a-z]+(?: [a-z]+)*$/i.test(G))throw'"'+G+'" not a space-delimited list of only letters';for(var b=G.split(" "),u={},m=0,D=0;D<b.length;D+=1){var L=b[D];if(L.length<2)throw'autocommand "'+L+'" not minimum length of 2';if(T[L]===Hn)throw'"'+L+'" is a built-in operator name';u[L]=1,m=i(m,L.length)}return u._maxLength=m,u},ge.prototype.quietEmptyDelimiters={},J.quietEmptyDelimiters=function(G){G===void 0&&(G="");for(var b=G.split(" "),u={},m=0;m<b.length;m+=1){var D=b[m];u[D]=1}return u},ge.prototype.autoParenthesizedFunctions={_maxLength:0},J.autoParenthesizedFunctions=function(G){if(typeof G!="string"||!/^[a-z]+(?: [a-z]+)*$/i.test(G))throw'"'+G+'" not a space-delimited list of only letters';for(var b=G.split(" "),u={},m=0,D=0;D<b.length;D+=1){var L=b[D];if(L.length<2)throw'autocommand "'+L+'" not minimum length of 2';u[L]=1,m=i(m,L.length)}return u._maxLength=m,u};function or(G,b){for(var u="",m=0;G instanceof zt&&G.ctrlSeq===G.letter&&m<b;)u=G.letter+u,G=G[r],m+=1;return u}var zt=function(G){At(b,G);function b(u){var m=G.call(this,u)||this;return m.letter=u,m}return b.prototype.checkAutoCmds=function(u){var m;if(!this.shouldIgnoreSubstitutionInSimpleSubscript(u.options)){var D=u.options.autoCommands,L=D._maxLength||0;if(L>0)for(var K=(m=or(this,L))!==null&&m!==void 0?m:"";K.length;){if(D.hasOwnProperty(K)){for(var re=this,se=1;re&&se<K.length;se+=1,re=re[r]);new w(re,this).remove(),u[r]=re[r];var we=T[K],Ye;return de(we)?Ye=new we(K):Ye=we(K),Ye.createLeftOf(u)}K=K.slice(1)}}},b.prototype.autoParenthesize=function(u){var m=u.parent.getEnd(e);if(!(m&&m instanceof Fl&&m.ctrlSeq==="\\left(")&&!this.shouldIgnoreSubstitutionInSimpleSubscript(u.options)){for(var D="",L=this,K=0,re=u.options.autoParenthesizedFunctions,se=re._maxLength||0,we=u.options.autoOperatorNames;L instanceof b&&K<se;)D=L.letter+D,L=L[r],K+=1;for(;D.length;){if(re.hasOwnProperty(D)&&we.hasOwnProperty(D))return u.parent.write(u,"(");D=D.slice(1)}}},b.prototype.createLeftOf=function(u){G.prototype.createLeftOf.call(this,u),this.checkAutoCmds(u),this.autoParenthesize(u)},b.prototype.italicize=function(u){return this.isItalic=u,this.isPartOfOperator=!u,u&&delete this.endsWord,this.domFrag().toggleClass("dcg-mq-operator-name",!u),this},b.prototype.finalizeTree=function(u,m){this.sharedSiblingMethod(u,m)},b.prototype.siblingDeleted=function(u,m){this.sharedSiblingMethod(u,m)},b.prototype.siblingCreated=function(u,m){this.sharedSiblingMethod(u,m)},b.prototype.sharedSiblingMethod=function(u,m){m!==r&&this[e]instanceof b||this.autoUnItalicize(u)},b.prototype.autoUnItalicize=function(u){var m=u.autoOperatorNames;if(m._maxLength!==0&&!this.shouldIgnoreSubstitutionInSimpleSubscript(u)){for(var D=this.letter,L=this[r];L instanceof b;L=L[r])D=L.letter+D;for(var K=this[e];K instanceof b;K=K[e])D+=K.letter;var re=L&&L[e],se=K&&K[r];new w(re||this.parent.getEnd(r),se||this.parent.getEnd(e)).each(function(V){V instanceof b&&(V.italicize(!0).domFrag().removeClass("dcg-mq-first dcg-mq-last dcg-mq-followed-by-supsub"),V.ctrlSeq=V.letter)});var we=m._maxLength||0;e:for(var Ye=0,Ke=L[e]||this.parent.getEnd(r);Ke&&Ye<D.length;Ye+=1,Ke=Ke[e])for(var Fe=t(we,D.length-Ye);Fe>0;Fe-=1){var at=D.slice(Ye,Ye+Fe),dt=void 0;if(m.hasOwnProperty(at)){for(var Ct=0,It=Ke;Ct<Fe;Ct+=1,It=It[e])It instanceof b&&(It.italicize(!1),dt=It);var _t=Sr.hasOwnProperty(at);if(Ke.ctrlSeq=(_t?"\\":"\\operatorname{")+Ke.ctrlSeq,dt.ctrlSeq+=_t?" ":"}",dt.endsWord=at,Dr.hasOwnProperty(at)){var ai=dt[r],zo=ai&&ai[r],ci=zo&&zo[r];ci.domFrag().addClass("dcg-mq-last")}if(this.shouldOmitPadding(Ke[r])||Ke.domFrag().addClass("dcg-mq-first"),!this.shouldOmitPadding(dt[e]))if(dt[e]instanceof Rl){var Zo=dt[e],uo=Zo.siblingCreated=Zo.siblingDeleted=function(){Zo.domFrag().toggleClass("dcg-mq-after-operator-name",!(Zo[e]instanceof Fl))};uo()}else dt.domFrag().toggleClass("dcg-mq-last",!(dt[e]instanceof Fl));Ye+=Fe-1,Ke=dt;continue e}}}},b.prototype.shouldOmitPadding=function(u){return!u||u.ctrlSeq==="."||u instanceof he||u instanceof mp},b}(Lt),Sr={};ge.prototype.autoOperatorNames=ki();var Dr={limsup:1,liminf:1,projlim:1,injlim:1};function ki(){for(var G={_maxLength:9},b="arg deg det dim exp gcd hom inf ker lg lim ln log max min sup limsup liminf injlim projlim Pr".split(" "),u=0;u<b.length;u+=1)Sr[b[u]]=G[b[u]]=1;for(var m="sin cos tan arcsin arccos arctan sinh cosh tanh sec csc cot coth".split(" "),u=0;u<m.length;u+=1)Sr[m[u]]=1;for(var D="sin cos tan sec cosec csc cotan cot ctg".split(" "),u=0;u<D.length;u+=1)G[D[u]]=G["arc"+D[u]]=G[D[u]+"h"]=G["ar"+D[u]+"h"]=G["arc"+D[u]+"h"]=1;for(var L="gcf hcf lcm proj span".split(" "),u=0;u<L.length;u+=1)G[L[u]]=1;return G}J.autoOperatorNames=function(G){if(typeof G!="string")throw'"'+G+'" not a space-delimited list';if(!/^[a-z\|\-]+(?: [a-z\|\-]+)*$/i.test(G))throw'"'+G+'" not a space-delimited list of letters or "|"';for(var b=G.split(" "),u={},m=0,D=0;D<b.length;D+=1){var L=b[D];if(L.length<2)throw'"'+L+'" not minimum length of 2';if(L.indexOf("|")<0)u[L]=L,m=i(m,L.length);else{var K=L.split("|");if(K.length>2)throw'"'+L+'" has more than 1 mathspeak delimiter';if(K[0].length<2)throw'"'+L[0]+'" not minimum length of 2';u[K[0]]=K[1].replace(/-/g," "),m=i(m,K[0].length)}}return u._maxLength=m,u},ge.prototype.infixOperatorNames={},J.infixOperatorNames=function(G){if(typeof G!="string")throw'"'+G+'" not a space-delimited list';if(!/^[a-z]+(?: [a-z]+)*$/i.test(G))throw'"'+G+'" not a space-delimited list of letters';for(var b=G.split(" "),u={},m=0;m<b.length;m+=1){var D=b[m];if(D.length<2)throw'"'+D+'" not minimum length of 2';u[D]=!0}return u};var Hn=function(G){At(b,G);function b(u){return G.call(this,u||"")||this}return b.prototype.createLeftOf=function(u){for(var m=this.ctrlSeq,D=0;D<m.length;D+=1)new zt(m.charAt(D)).createLeftOf(u)},b.prototype.parser=function(){for(var u=this.ctrlSeq,m=new We,D=0;D<u.length;D+=1)new zt(u.charAt(D)).adopt(m,m.getEnd(e),0);return ve.succeed(m.children())},b}(Uo);for(var Mn in ge.prototype.autoOperatorNames)ge.prototype.autoOperatorNames.hasOwnProperty(Mn)&&(T[Mn]=Hn);T.operatorname=function(G){At(b,G);function b(){return G!==null&&G.apply(this,arguments)||this}return b.prototype.createLeftOf=function(){},b.prototype.numBlocks=function(){return 1},b.prototype.parser=function(){return ke.block.map(function(u){var m=!0,D="",L=u.children();return L.each(function(K){K instanceof zt?D+=K.letter:m=!1}),m&&D==="ans"?sD():L})},b}(ni),T.f=function(G){At(b,G);function b(){var u=this,m="f";return u=G.call(this,m)||this,u.letter=m,u.domView=new Br(0,function(){return c("var",{class:"dcg-mq-f"},[c.text("f")])}),u}return b.prototype.italicize=function(u){return this.domFrag().eachElement(function(m){return m.textContent="f"}),this.domFrag().toggleClass("dcg-mq-f",u),G.prototype.italicize.call(this,u)},b}(zt),T[" "]=T.space=function(){return new St("\\ ",c("span",{},[c.text(p)])," ")},T["."]=function(){return new St(".",c("span",{class:"dcg-mq-digit"},[c.text(".")]),".")},T["'"]=T.prime=Xt("'","&prime;","prime"),T["\u2033"]=T.dprime=Xt("\u2033","&Prime;","double prime"),T.backslash=Xt("\\backslash ","\\","backslash"),B["\\"]||(B["\\"]=T.backslash),T.$=Xt("\\$","$","dollar"),T.square=Xt("\\square ","\u25A1","square"),T.mid=Xt("\\mid ","\u2223","mid");var qi=function(G){At(b,G);function b(u,m,D){return G.call(this,u,c("span",{class:"dcg-mq-nonSymbola"},[m||c.text(u)]))||this}return b}(Uo);T["@"]=function(){return new qi("@")},T["&"]=function(){return new qi("\\&",c.entityText("&amp;"),"and")},T["%"]=function(G){At(b,G);function b(){return G.call(this,"\\%",c.text("%"),"percent")||this}return b.prototype.parser=function(){var u=ve.optWhitespace,m=ve.string;return u.then(m("\\operatorname{of}").map(function(){return lD()})).or(G.prototype.parser.call(this))},b}(qi),T["\u2225"]=T.parallel=Xt("\\parallel ","&#x2225;","parallel"),T["\u2226"]=T.nparallel=Xt("\\nparallel ","&#x2226;","not parallel"),T["\u27C2"]=T.perp=Xt("\\perp ","&#x27C2;","perpendicular");function io(G){return Rt("\\"+G+" ","&"+G+";",G)}T.\u03B1=T.alpha=io("alpha"),T.\u03B2=T.beta=io("beta"),T.\u03B3=T.gamma=io("gamma"),T.\u03B4=T.delta=io("delta"),T.\u03B6=T.zeta=io("zeta"),T.\u03B7=T.eta=io("eta"),T.\u03B8=T.theta=io("theta"),T.\u03B9=T.iota=io("iota"),T.\u03BA=T.kappa=io("kappa"),T.\u03BC=T.mu=io("mu"),T.\u03BD=T.nu=io("nu"),T.\u03BE=T.xi=io("xi"),T.\u03C1=T.rho=io("rho"),T.\u03C3=T.sigma=io("sigma"),T.\u03C4=T.tau=io("tau"),T.\u03C7=T.chi=io("chi"),T.\u03C8=T.psi=io("psi"),T.\u03C9=T.omega=io("omega"),T.\u03D5=T.phi=Rt("\\phi ","&#981;","phi"),T.\u03C6=T.phiv=T.varphi=Rt("\\varphi ","&phi;","phi"),T["\u03F5"]=T.epsilon=Rt("\\epsilon ","&#1013;","epsilon"),T.\u03B5=T.epsiv=T.varepsilon=Rt("\\varepsilon ","&epsilon;","epsilon"),T.\u03D6=T.piv=T.varpi=Rt("\\varpi ","&piv;","piv"),T.\u03C2=T.sigmaf=T.sigmav=T.varsigma=Rt("\\varsigma ","&sigmaf;","sigma"),T.\u03D1=T.thetav=T.vartheta=T.thetasym=Rt("\\vartheta ","&thetasym;","theta"),T.\u03C5=T.upsilon=T.upsi=Rt("\\upsilon ","&upsilon;","upsilon"),T.\u03DC=T.gammad=T.Gammad=T.digamma=Rt("\\digamma ","&#989;","gamma"),T.\u03F0=T.kappav=T.varkappa=Rt("\\varkappa ","&#1008;","kappa"),T.\u03F1=T.rhov=T.varrho=Rt("\\varrho ","&#1009;","rho"),T.pi=T.\u03C0=function(){return new qi("\\pi ",c.entityText("&pi;"),"pi")},T.\u03BB=T.lambda=function(){return new qi("\\lambda ",c.entityText("&lambda;"),"lambda")},T.\u03A5=T.Upsilon=T.Upsi=T.upsih=T.Upsih=function(){return new Uo("\\Upsilon ",c("var",{style:"font-family: serif"},[c.entityText("&upsih;")]),"capital upsilon")};function pn(G){return function(){return new al("\\"+G+" ",c.entityText("&"+G+";"))}}T.\u0393=T.Gamma=pn("Gamma"),T.\u0394=T.Delta=pn("Delta"),T.\u0398=T.Theta=pn("Theta"),T.\u039B=T.Lambda=pn("Lambda"),T.\u039E=T.Xi=pn("Xi"),T.\u03A0=T.Pi=pn("Pi"),T.\u03A3=T.Sigma=pn("Sigma"),T.\u03A6=T.Phi=pn("Phi"),T.\u03A8=T.Psi=pn("Psi"),T.\u03A9=T.Omega=pn("Omega"),T["\u2200"]=T.forall=pn("forall");var wo=function(G){At(b,G);function b(u){var m=G.call(this)||this;return m.latexStr=u,m}return b.prototype.createLeftOf=function(u){var m=ke.parse(this.latexStr);m.children().adopt(u.parent,u[r],u[e]),u[r]=m.getEnd(e),P(m.html()).insertBefore(u.domFrag()),m.finalizeInsert(u.options,u);var D=m.getEnd(e),L=D&&D[e];L&&L.siblingCreated(u.options,r);var K=m.getEnd(r),re=K&&K[r];re&&re.siblingCreated(u.options,e),u.parent.bubble(function(se){se.reflow()})},b.prototype.mathspeak=function(){return ke.parse(this.latexStr).mathspeak()},b.prototype.parser=function(){var u=ke.parse(this.latexStr).children();return ve.succeed(u)},b}(ni);T["\u2070"]=function(){return new wo("^0")},T["\xB9"]=function(){return new wo("^1")},T["\xB2"]=function(){return new wo("^2")},T["\xB3"]=function(){return new wo("^3")},T["\u2074"]=function(){return new wo("^4")},T["\u2075"]=function(){return new wo("^5")},T["\u2076"]=function(){return new wo("^6")},T["\u2077"]=function(){return new wo("^7")},T["\u2078"]=function(){return new wo("^8")},T["\u2079"]=function(){return new wo("^9")},T["\xBC"]=function(){return new wo("\\frac14")},T["\xBD"]=function(){return new wo("\\frac12")},T["\xBE"]=function(){return new wo("\\frac34")},T["\u221A"]=function(){return new wo("\\sqrt{}")};function Ob(G){if(!G)return!1;var b=G[r];if(b){if(b instanceof he||/^(\\ )|[,;:\(\[]$/.test(b.ctrlSeq))return!1}else return G.parent&&G.parent.parent&&G.parent.parent.isStyleBlock()?Ob(G.parent.parent):!1;return!0}var Om=function(G){At(b,G);function b(u,m,D){return G.call(this,u,m,void 0,D,!0)||this}return b.prototype.contactWeld=function(u,m){this.sharedSiblingMethod(u.options,m)},b.prototype.siblingCreated=function(u,m){this.sharedSiblingMethod(u,m)},b.prototype.siblingDeleted=function(u,m){this.sharedSiblingMethod(u,m)},b.prototype.sharedSiblingMethod=function(u,m){if(m!==e)return this.domFrag().oneElement().className=Ob(this)?"dcg-mq-binary-operator":"",this},b}(he);T["+"]=function(G){At(b,G);function b(){return G.call(this,"+",c.text("+"))||this}return b.prototype.mathspeak=function(){return Ob(this)?"plus":"positive"},b}(Om);var Dv=function(G){At(b,G);function b(){return G.call(this,"-",c.entityText("&minus;"))||this}return b.prototype.mathspeak=function(){return Ob(this)?"minus":"negative"},b}(Om);T["\u2212"]=T["\u2014"]=T["\u2013"]=T["-"]=Dv,T["\xB1"]=T.pm=T.plusmn=T.plusminus=function(){return new Om("\\pm ",c.entityText("&plusmn;"),"plus-or-minus")},T.mp=T.mnplus=T.minusplus=function(){return new Om("\\mp ",c.entityText("&#8723;"),"minus-or-plus")},B["*"]=T.sdot=T.cdot=Qe("\\cdot ","&middot;","*","times");var Z0=function(G){At(b,G);function b(){return G.call(this,"\\to ",c.entityText("&rarr;"),"to")||this}return b.prototype.deleteTowards=function(u,m){if(u===r){var D=m[r];new w(D,this).remove(),m[r]=D[r],new Dv().createLeftOf(m),m[r].bubble(function(L){L.reflow()});return}G.prototype.deleteTowards.call(this,u,m)},b}(he);T["\u2192"]=T.to=Z0;var Rm=function(G){At(b,G);function b(u,m){var D=this,L=m?"Strict":"";return D=G.call(this,u["ctrlSeq".concat(L)],c.entityText(u["htmlEntity".concat(L)]),u["text".concat(L)],u["mathspeak".concat(L)])||this,D.data=u,D.strict=m,D}return b.prototype.swap=function(u){this.strict=u;var m=u?"Strict":"";this.ctrlSeq=this.data["ctrlSeq".concat(m)],this.domFrag().children().replaceWith(P(c.entityText(this.data["htmlEntity".concat(m)]))),this.textTemplate=[this.data["text".concat(m)]],this.mathspeakName=this.data["mathspeak".concat(m)]},b.prototype.deleteTowards=function(u,m){if(u===r&&!this.strict){this.swap(!0),this.bubble(function(D){D.reflow()});return}G.prototype.deleteTowards.call(this,u,m)},b}(he),eD={ctrlSeq:"\\le ",htmlEntity:"&le;",text:"\u2264",mathspeak:"less than or equal to",ctrlSeqStrict:"<",htmlEntityStrict:"&lt;",textStrict:"<",mathspeakStrict:"less than"},Rb={ctrlSeq:"\\ge ",htmlEntity:"&ge;",text:"\u2265",mathspeak:"greater than or equal to",ctrlSeqStrict:">",htmlEntityStrict:"&gt;",textStrict:">",mathspeakStrict:"greater than"},tD=function(G){At(b,G);function b(){return G.call(this,Rb,!0)||this}return b.prototype.createLeftOf=function(u){var m=u[r];if(m instanceof he&&m.ctrlSeq==="-"){var D=m;u[r]=D[r],D.remove(),new Z0().createLeftOf(u),u[r].bubble(function(L){L.reflow()});return}G.prototype.createLeftOf.call(this,u)},b}(Rm);T["<"]=T.lt=function(){return new Rm(eD,!0)},T[">"]=T.gt=tD,T["\u2264"]=T.le=T.leq=function(){return new Rm(eD,!1)},T["\u2265"]=T.ge=T.geq=function(){return new Rm(Rb,!1)},T["\u221E"]=T.infty=T.infin=T.infinity=Xt("\\infty ","&infin;","infinity"),T["\u2260"]=T.ne=T.neq=Qe("\\ne ","&ne;","not equal");var kv=function(G){At(b,G);function b(){return G.call(this,"=",c.text("="),"=","equals")||this}return b.prototype.createLeftOf=function(u){var m=u[r];if(m instanceof Rm&&m.strict){m.swap(!1),m.bubble(function(D){D.reflow()});return}G.prototype.createLeftOf.call(this,u)},b}(he);T["="]=kv,T["\xD7"]=T.times=T.cross=Qe("\\times ","&times;","[x]","times"),T["\xF7"]=T.div=T.divide=T.divides=Qe("\\div ","&divide;","[/]","over");var rD=function(G){At(b,G);function b(){return G.call(this,"\\sim ",c.text("~"),"~","tilde")||this}return b.prototype.createLeftOf=function(u){if(u[r]instanceof b){var m=u[r];u[r]=m[r],m.remove(),new iD().createLeftOf(u),u[r].bubble(function(D){D.reflow()});return}G.prototype.createLeftOf.call(this,u)},b}(he),iD=function(G){At(b,G);function b(){return G.call(this,"\\approx ",c.entityText("&approx;"),"\u2248","approximately equal")||this}return b.prototype.deleteTowards=function(u,m){if(u===r){var D=m[r];new w(D,this).remove(),m[r]=D[r],new rD().createLeftOf(m),m[r].bubble(function(L){L.reflow()});return}G.prototype.deleteTowards.call(this,u,m)},b}(he);T.tildeNbsp=Xt("~",p," "),T.sim=rD,T["\u2248"]=T.approx=iD,B["~"]=T.sim,T["~"]=T.tildeNbsp,J.interpretTildeAsSim=function(G){var b=!!G;return b?T["~"]=T.sim:T["~"]=T.tildeNbsp,b};var Fm={sqrt:{width:"",html:function(){return c("svg",{preserveAspectRatio:"none",viewBox:"0 0 32 54"},[c("path",{d:"M0 33 L7 27 L12.5 47 L13 47 L30 0 L32 0 L13 54 L11 54 L4.5 31 L0 33"})])}},"|":{width:".4em",html:function(){return c("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[c("path",{d:"M4.4 0 L4.4 54 L5.6 54 L5.6 0"})])}},"[":{width:".55em",html:function(){return c("svg",{preserveAspectRatio:"none",viewBox:"0 0 11 24"},[c("path",{d:"M8 0 L3 0 L3 24 L8 24 L8 23 L4 23 L4 1 L8 1"})])}},"]":{width:".55em",html:function(){return c("svg",{preserveAspectRatio:"none",viewBox:"0 0 11 24"},[c("path",{d:"M3 0 L8 0 L8 24 L3 24 L3 23 L7 23 L7 1 L3 1"})])}},"(":{width:".55em",html:function(){return c("svg",{preserveAspectRatio:"none",viewBox:"3 0 106 186"},[c("path",{d:"M85 0 A61 101 0 0 0 85 186 L75 186 A75 101 0 0 1 75 0"})])}},")":{width:".55em",html:function(){return c("svg",{preserveAspectRatio:"none",viewBox:"3 0 106 186"},[c("path",{d:"M24 0 A61 101 0 0 1 24 186 L34 186 A75 101 0 0 0 34 0"})])}},"{":{width:".7em",html:function(){return c("svg",{preserveAspectRatio:"none",viewBox:"10 0 210 350"},[c("path",{d:"M170 0 L170 6 A47 52 0 0 0 123 60 L123 127 A35 48 0 0 1 88 175 A35 48 0 0 1 123 223 L123 290 A47 52 0 0 0 170 344 L170 350 L160 350 A58 49 0 0 1 102 301 L103 220 A45 40 0 0 0 58 180 L58 170 A45 40 0 0 0 103 130 L103 49 A58 49 0 0 1 161 0"})])}},"}":{width:".7em",html:function(){return c("svg",{preserveAspectRatio:"none",viewBox:"10 0 210 350"},[c("path",{d:"M60 0 L60 6 A47 52 0 0 1 107 60 L107 127 A35 48 0 0 0 142 175 A35 48 0 0 0 107 223 L107 290 A47 52 0 0 1 60 344 L60 350 L70 350 A58 49 0 0 0 128 301 L127 220 A45 40 0 0 1 172 180 L172 170 A45 40 0 0 1 127 130 L127 49 A58 49 0 0 0 70 0"})])}},"&#8741;":{width:".7em",html:function(){return c("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[c("path",{d:"M3.2 0 L3.2 54 L4 54 L4 0 M6.8 0 L6.8 54 L6 54 L6 0"})])}},"&lang;":{width:".55em",html:function(){return c("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[c("path",{d:"M6.8 0 L3.2 27 L6.8 54 L7.8 54 L4.2 27 L7.8 0"})])}},"&rang;":{width:".55em",html:function(){return c("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[c("path",{d:"M3.2 0 L6.8 27 L3.2 54 L2.2 54 L5.8 27 L2.2 0"})])}}},Ol=function(G){At(b,G);function b(u,m,D,L,K){var re=G.call(this,u,new Br(1,function(se){return c.block(m,D,se[0])}))||this;return re.ariaLabel=L||u.replace(/^\\/,""),re.mathspeakTemplate=["Start"+re.ariaLabel+",","End"+re.ariaLabel],re.shouldNotSpeakDelimiters=K&&K.shouldNotSpeakDelimiters,re}return b.prototype.mathspeak=function(u){return!this.shouldNotSpeakDelimiters||u&&u.ignoreShorthand?G.prototype.mathspeak.call(this):this.foldChildren("",function(m,D){return m+" "+D.mathspeak(u)}).trim()},b}(ni);T.mathrm=function(G){At(b,G);function b(){return G.call(this,"\\mathrm","span",{class:"dcg-mq-roman dcg-mq-font"},"Roman Font",{shouldNotSpeakDelimiters:!0})||this}return b.prototype.isTextBlock=function(){return!0},b}(Ol),T.mathit=function(){return new Ol("\\mathit","i",{class:"dcg-mq-font"},"Italic Font")},T.mathbf=function(){return new Ol("\\mathbf","b",{class:"dcg-mq-font"},"Bold Font")},T.mathsf=function(){return new Ol("\\mathsf","span",{class:"dcg-mq-sans-serif dcg-mq-font"},"Serif Font")},T.mathtt=function(){return new Ol("\\mathtt","span",{class:"dcg-mq-monospace dcg-mq-font"},"Math Text")},T.underline=function(){return new Ol("\\underline","span",{class:"dcg-mq-non-leaf dcg-mq-underline"},"Underline")},T.overline=T.bar=function(){return new Ol("\\overline","span",{class:"dcg-mq-non-leaf dcg-mq-overline"},"Overline")},T.overrightarrow=function(){return new Ol("\\overrightarrow","span",{class:"dcg-mq-non-leaf dcg-mq-overarrow dcg-mq-arrow-right"},"Over Right Arrow")},T.overleftarrow=function(){return new Ol("\\overleftarrow","span",{class:"dcg-mq-non-leaf dcg-mq-overarrow dcg-mq-arrow-left"},"Over Left Arrow")},T.overleftrightarrow=function(){return new Ol("\\overleftrightarrow ","span",{class:"dcg-mq-non-leaf dcg-mq-overarrow dcg-mq-arrow-leftright"},"Over Left and Right Arrow")},T.overarc=function(){return new Ol("\\overarc","span",{class:"dcg-mq-non-leaf dcg-mq-overarc"},"Over Arc")},T.dot=function(){return new ni("\\dot",new Br(1,function(G){return c("span",{class:"dcg-mq-non-leaf"},[c("span",{class:"dcg-mq-dot-recurring-inner"},[c("span",{class:"dcg-mq-dot-recurring"},[c.text(h)]),c.block("span",{class:"dcg-mq-empty-box"},G[0])])])}))},T.textcolor=function(G){At(b,G);function b(){return G!==null&&G.apply(this,arguments)||this}return b.prototype.setColor=function(u){this.color=u,this.domView=new Br(1,function(m){return c.block("span",{class:"dcg-mq-textcolor",style:"color:"+u},m[0])}),this.ariaLabel=u.replace(/^\\/,""),this.mathspeakTemplate=["Start "+this.ariaLabel+",","End "+this.ariaLabel]},b.prototype.latexRecursive=function(u){this.checkCursorContextOpen(u);var m=this.blocks[0];u.latex+="\\textcolor{"+this.color+"}{",m.latexRecursive(u),u.latex+="}",this.checkCursorContextClose(u)},b.prototype.parser=function(){var u=this,m=ve.optWhitespace,D=ve.string,L=ve.regex;return m.then(D("{")).then(L(/^[#\w\s.,()%-]*/)).skip(D("}")).then(function(K){return u.setColor(K),G.prototype.parser.call(u)})},b.prototype.isStyleBlock=function(){return!0},b}(ni);var Fb=T.class=function(G){At(b,G);function b(){return G!==null&&G.apply(this,arguments)||this}return b.prototype.parser=function(){var u=this,m=ve.string,D=ve.regex;return ve.optWhitespace.then(m("{")).then(D(/^[-\w\s\\\xA0-\xFF]*/)).skip(m("}")).then(function(L){return u.cls=L||"",u.domView=new Br(1,function(K){return c.block("span",{class:"dcg-mq-class ".concat(L)},K[0])}),u.ariaLabel=L+" class",u.mathspeakTemplate=["Start "+u.ariaLabel+",","End "+u.ariaLabel],G.prototype.parser.call(u)})},b.prototype.latexRecursive=function(u){this.checkCursorContextOpen(u);var m=this.blocks[0];u.latex+="\\class{"+this.cls+"}{",m.latexRecursive(u),u.latex+="}",this.checkCursorContextClose(u)},b.prototype.isStyleBlock=function(){return!0},b}(ni),Yh=/^[\+\-]?[\d]+$/;function Xh(G){if(!G)return"";var b="";return G.eachChild(function(u){u.ctrlSeq!==void 0&&(b+=u.ctrlSeq)}),b}ge.prototype.charsThatBreakOutOfSupSub="";var Rl=function(G){At(b,G);function b(){var u=G!==null&&G.apply(this,arguments)||this;return u.ctrlSeq="_{...}^{...}",u}return b.prototype.setEnds=function(u){a("SupSub ends must be MathBlocks",u[r]instanceof We&&u[e]instanceof We),this.ends=u},b.prototype.getEnd=function(u){return this.ends[u]},b.prototype.createLeftOf=function(u){if(!(!this.replacedFragment&&!u[r]&&u.options.supSubsRequireOperand))return G.prototype.createLeftOf.call(this,u)},b.prototype.contactWeld=function(u){for(var m=r;m;m=m===r?e:!1){var D=this[m],L=void 0;if(D instanceof b){for(var K="sub";K;K=K==="sub"?"sup":!1){var re=this[K],se=D[K];if(re){if(!se)D.addBlock(re.disown());else if(re.isEmpty())L=new Y(se,0,se.getEnd(r));else{re.domFrag().children().insAtDirEnd(-m,se.domFrag().oneElement());var we=re.children().disown();L=new Y(se,we.getEnd(e),se.getEnd(r)),m===r?we.adopt(se,se.getEnd(e),0):we.adopt(se,0,se.getEnd(r))}this.placeCursor=function(Ye,Ke){return function(Fe){Fe.insAtDirEnd(-m,Ye||Ke)}}(se,re)}}this.remove(),u&&u[r]===this&&(m===e&&L?L[r]?u.insRightOf(L[r]):u.insAtLeftEnd(L.parent):u.insRightOf(D));break}}},b.prototype.finalizeTree=function(){var u=this.getEnd(r);u.write=function(m,D){if(m.options.autoSubscriptNumerals&&this===this.parent.sub&&"0123456789".indexOf(D)>=0){var L=this.chToCmd(D,m.options);L instanceof Uo?m.deleteSelection():m.clearSelection().insRightOf(this.parent),L.createLeftOf(m.show()),m.controller.aria.queue("Baseline").alert(L.mathspeak({createdLeftOf:m}));return}m[r]&&!m[e]&&!m.selection&&m.options.charsThatBreakOutOfSupSub.indexOf(D)>-1&&(m.insRightOf(this.parent),m.controller.aria.queue("Baseline")),We.prototype.write.call(this,m,D)}},b.prototype.moveTowards=function(u,m,D){m.options.autoSubscriptNumerals&&!this.sup?m.insDirOf(u,this):G.prototype.moveTowards.call(this,u,m,D)},b.prototype.deleteTowards=function(u,m){if(m.options.autoSubscriptNumerals&&this.sub){var D=this.sub.getEnd(-u);D instanceof Uo?D.remove():D&&D.deleteTowards(u,m.insAtDirEnd(-u,this.sub)),this.sub.isEmpty()&&(this.sub.deleteOutOf(r,m.insAtLeftEnd(this.sub)),this.sup&&m.insDirOf(-u,this))}else G.prototype.deleteTowards.call(this,u,m)},b.prototype.latexRecursive=function(u){if(this.checkCursorContextOpen(u),this.sub){u.latex+="_{";var m=u.latex.length;this.sub.latexRecursive(u);var D=u.latex.length;m===D&&(u.latex+=" "),u.latex+="}"}if(this.sup){u.latex+="^{";var m=u.latex.length;this.sup.latexRecursive(u);var D=u.latex.length;m===D&&(u.latex+=" "),u.latex+="}"}this.checkCursorContextClose(u)},b.prototype.text=function(){function u(m,D){var L=D&&D.text()||"";return D?m+(L.length===1?L:"("+(L||" ")+")"):""}return u("_",this.sub)+u("^",this.sup)},b.prototype.addBlock=function(u){this.supsub==="sub"?(this.sup=this.upInto=this.sub.upOutOf=u,u.adopt(this,this.sub,0).downOutOf=this.sub,u.setDOM(P(c("span",{class:"dcg-mq-sup"})).append(u.domFrag().children()).prependTo(this.domFrag().oneElement()).oneElement()),O.linkElementByBlockNode(u.domFrag().oneElement(),u)):(this.sub=this.downInto=this.sup.downOutOf=u,u.adopt(this,0,this.sup).upOutOf=this.sup,this.domFrag().removeClass("dcg-mq-sup-only"),u.setDOM(P(c("span",{class:"dcg-mq-sub"})).append(u.domFrag().children()).appendTo(this.domFrag().oneElement()).oneElement()),O.linkElementByBlockNode(u.domFrag().oneElement(),u),this.domFrag().append(P(c("span",{style:"display:inline-block;width:0"},[c.text(g)]))));for(var m=0;m<2;m+=1)(function(D,L,K,re){var se=D[L];se.deleteOutOf=function(we,Ye){if(Ye.insDirOf(this[we]?-we:we,this.parent),!this.isEmpty()){var Ke=this.getEnd(we);this.children().disown().withDirAdopt(we,Ye.parent,Ye[we],Ye[-we]).domFrag().insDirOf(-we,Ye.domFrag()),Ye[-we]=Ke}D.supsub=K,delete D[L],delete D["".concat(re,"Into")];var Fe=D[K];Fe["".concat(re,"OutOf")]=Nb,delete Fe.deleteOutOf,L==="sub"&&D.domFrag().addClass("dcg-mq-sup-only").children().last().remove(),this.remove()}})(this,"sub sup".split(" ")[m],"sup sub".split(" ")[m],"down up".split(" ")[m])},b}(ni);function Nb(G){var b=this.parent,u=G;do{if(u[e])return G.insLeftOf(b);u=u.parent.parent}while(u!==b);G.insRightOf(b)}var oD=function(G){At(b,G);function b(){var u=G!==null&&G.apply(this,arguments)||this;return u.supsub="sub",u.domView=new Br(1,function(m){return c("span",{class:"dcg-mq-supsub dcg-mq-non-leaf"},[c.block("span",{class:"dcg-mq-sub"},m[0]),c("span",{style:"display:inline-block;width:0"},[c.text(g)])])}),u.textTemplate=["_"],u.mathspeakTemplate=["Subscript,",", Baseline"],u.ariaLabel="subscript",u}return b.prototype.finalizeTree=function(){this.downInto=this.sub=this.getEnd(r),this.sub.upOutOf=Nb,G.prototype.finalizeTree.call(this)},b}(Rl);T.subscript=T._=oD,T.superscript=T.supscript=T["^"]=function(G){At(b,G);function b(){var u=G!==null&&G.apply(this,arguments)||this;return u.supsub="sup",u.domView=new Br(1,function(m){return c("span",{class:"dcg-mq-supsub dcg-mq-non-leaf dcg-mq-sup-only"},[c.block("span",{class:"dcg-mq-sup"},m[0])])}),u.textTemplate=["^(",")"],u.ariaLabel="superscript",u.mathspeakTemplate=["Superscript,",", Baseline"],u}return b.prototype.mathspeak=function(u){var m=this.upInto;if(m!==void 0){var D=Xh(m);if((!u||!u.ignoreShorthand)&&Yh.test(D)){if(D==="0")return"to the 0 power";if(D==="2")return"squared";if(D==="3")return"cubed";var L="";/^[+-]?\d{1,3}$/.test(D)&&(/(11|12|13|4|5|6|7|8|9|0)$/.test(D)?L="th":/1$/.test(D)?L="st":/2$/.test(D)?L="nd":/3$/.test(D)&&(L="rd"));var K=typeof m=="object"?m.mathspeak():D;return"to the "+K+L+" power"}}return G.prototype.mathspeak.call(this)},b.prototype.finalizeTree=function(){this.upInto=this.sup=this.getEnd(e),this.sup.downOutOf=Nb,G.prototype.finalizeTree.call(this)},b}(Rl);var mp=function(G){At(b,G);function b(u,m,D){var L=G.call(this)||this;L.ariaLabel=D||u.replace(/^\\/,"");var K=new Br(2,function(re){return c("span",{class:"dcg-mq-large-operator dcg-mq-non-leaf"},[c("span",{class:"dcg-mq-to"},[c.block("span",{},re[1])]),c("big",{},[c.text(m)]),c("span",{class:"dcg-mq-from"},[c.block("span",{},re[0])])])});return Uo.prototype.setCtrlSeqHtmlTextAndMathspeak.call(L,u,K),L}return b.prototype.createLeftOf=function(u){G.prototype.createLeftOf.call(this,u),u.options.sumStartsWithNEquals&&(new zt("n").createLeftOf(u),new kv().createLeftOf(u))},b.prototype.latexRecursive=function(u){this.checkCursorContextOpen(u),u.latex+=this.ctrlSeq+"_{";var m=u.latex.length;this.getEnd(r).latexRecursive(u);var D=u.latex.length;D===m&&(u.latex+=" "),u.latex+="}^{",m=u.latex.length,this.getEnd(e).latexRecursive(u),D=u.latex.length,m===D&&(u.latex+=" "),u.latex+="}",this.checkCursorContextClose(u)},b.prototype.mathspeak=function(){return"Start "+this.ariaLabel+" from "+this.getEnd(r).mathspeak()+" to "+this.getEnd(e).mathspeak()+", end "+this.ariaLabel+", "},b.prototype.parser=function(){for(var u=ve.string,m=ve.optWhitespace,D=ve.succeed,L=ke.block,K=this,re=K.blocks=[new We,new We],se=0;se<re.length;se+=1)re[se].adopt(K,K.getEnd(e),0);return m.then(u("_").or(u("^"))).then(function(we){var Ye=re[we==="_"?0:1];return L.then(function(Ke){return Ke.children().adopt(Ye,Ye.getEnd(e),0),D(K)})}).many().result(K)},b.prototype.finalizeTree=function(){var u=this.getEnd(r),m=this.getEnd(e);u.ariaLabel="lower bound",m.ariaLabel="upper bound",this.downInto=u,this.upInto=m,u.upOutOf=m,m.downOutOf=u},b}(ni);T["\u2211"]=T.sum=T.summation=function(){return new mp("\\sum ",f,"sum")},T["\u220F"]=T.prod=T.product=function(){return new mp("\\prod ",y,"product")},T.coprod=T.coproduct=function(){return new mp("\\coprod ",x,"co product")},T["\u222B"]=T.int=T.integral=function(G){At(b,G);function b(){var u=G.call(this,"\\int ","","integral")||this;return u.ariaLabel="integral",u.domView=new Br(2,function(m){return c("span",{class:"dcg-mq-int dcg-mq-non-leaf"},[c("big",{},[c.text(E)]),c("span",{class:"dcg-mq-supsub dcg-mq-non-leaf"},[c("span",{class:"dcg-mq-sup"},[c.block("span",{class:"dcg-mq-sup-inner"},m[1])]),c.block("span",{class:"dcg-mq-sub"},m[0]),c("span",{style:"display:inline-block;width:0"},[c.text(g)])])])}),u}return b.prototype.createLeftOf=function(u){ni.prototype.createLeftOf.call(this,u)},b}(mp);var nD=T.frac=T.dfrac=T.cfrac=T.fraction=function(G){At(b,G);function b(){var u=G!==null&&G.apply(this,arguments)||this;return u.ctrlSeq="\\frac",u.domView=new Br(2,function(m){return c("span",{class:"dcg-mq-fraction dcg-mq-non-leaf"},[c.block("span",{class:"dcg-mq-numerator"},m[0]),c.block("span",{class:"dcg-mq-denominator"},m[1]),c("span",{style:"display:inline-block;width:0"},[c.text(g)])])}),u.textTemplate=["(",")/(",")"],u}return b.prototype.finalizeTree=function(){var u=this.getEnd(r),m=this.getEnd(e);this.upInto=m.upOutOf=u,this.downInto=u.downOutOf=m,u.ariaLabel="numerator",m.ariaLabel="denominator",this.getFracDepth()>1?this.mathspeakTemplate=["StartNestedFraction,","NestedOver",", EndNestedFraction"]:this.mathspeakTemplate=["StartFraction,","Over",", EndFraction"]},b.prototype.mathspeak=function(u){if(u&&u.createdLeftOf){var m=u.createdLeftOf;return m.parent.mathspeak()}var D=Xh(this.getEnd(r)),L=Xh(this.getEnd(e));if((!u||!u.ignoreShorthand)&&Yh.test(D)&&Yh.test(L)){var K=D==="1"||D==="-1",re="";if(L==="2"?re=K?"half":"halves":L==="3"?re=K?"third":"thirds":L==="4"?re=K?"quarter":"quarters":L==="5"?re=K?"fifth":"fifths":L==="6"?re=K?"sixth":"sixths":L==="7"?re=K?"seventh":"sevenths":L==="8"?re=K?"eighth":"eighths":L==="9"&&(re=K?"ninth":"ninths"),re!==""){for(var se="",we=!1,Ye=this[r];Ye&&Ye[r]!==void 0;Ye=Ye[r])if(Ye.ctrlSeq!=="\\ ")if(Yh.test(Ye.ctrlSeq||""))we=!0;else{we=!1;break}return we&&(se+="and "),se+=this.getEnd(r).mathspeak()+" "+re,se}}return G.prototype.mathspeak.call(this)},b.prototype.getFracDepth=function(){var u=0,m=function(D,L){return D instanceof Oe&&D.ctrlSeq&&D.ctrlSeq.toLowerCase().search("frac")>=0&&(L+=1),D&&D.parent?m(D.parent,L):L};return m(this,u)},b}(ni),aD=T.over=B["/"]=function(G){At(b,G);function b(){return G!==null&&G.apply(this,arguments)||this}return b.prototype.createLeftOf=function(u){if(!this.replacedFragment){var m=u[r],D=u.options.typingSlashCreatesNewFraction&&this instanceof nD;if(!D)for(;m&&!(m instanceof he||m instanceof zt&&m.endsWord&&u.options.infixOperatorNames[m.endsWord]||m instanceof(T.text||o)||m instanceof mp||m.ctrlSeq==="\\ "||/^[,;:]$/.test(m.ctrlSeq));)m=m[r];if(m instanceof mp&&m[e]instanceof Rl){m=m[e];var L=m[e];L instanceof Rl&&L.ctrlSeq!=m.ctrlSeq&&(m=m[e])}if(m!==u[r]&&!u.isTooDeep(1)){var L=m[e],K=u[r];this.replaces(new w(L||u.parent.getEnd(r),K)),u[r]=m}}G.prototype.createLeftOf.call(this,u)},b}(nD),sD=function(){return new Uo("\\operatorname{ans}",c("span",{class:"dcg-mq-ans"},[c.text("ans")]),"ans")};T.ans=sD;var lD=function(){return new Uo("\\%\\operatorname{of}",c("span",{class:"dcg-mq-nonSymbola dcg-mq-operator-name"},[c.text("% of ")]),"percent of")};T.percent=T.percentof=lD;var cD=function(G){At(b,G);function b(){var u=G!==null&&G.apply(this,arguments)||this;return u.tokenId="",u.ctrlSeq="\\token",u.textTemplate=["token(",")"],u.mathspeakTemplate=["StartToken,",", EndToken"],u.ariaLabel="token",u}return b.prototype.html=function(){var u=c("span",{class:"dcg-mq-token dcg-mq-ignore-mousedown","data-dcg-mq-token":this.tokenId});return this.setDOM(u),O.linkElementByCmdNode(u,this),u},b.prototype.latexRecursive=function(u){this.checkCursorContextOpen(u),u.latex+="\\token{"+this.tokenId+"}",this.checkCursorContextClose(u)},b.prototype.mathspeak=function(){var u=[];return this.domFrag().children().eachElement(function(m){var D=m.getAttribute("aria-label");typeof D=="string"&&D!==""&&u.push(D)}),u.length>0?u.join(" ").trim():"token "+this.tokenId},b.prototype.parser=function(){var u=this;return ke.block.map(function(m){var D=m.getEnd(r);if(D)for(u.tokenId+=D.ctrlSeq;D=D[e];)u.tokenId+=D.ctrlSeq;return u})},b}(Uo);T.token=cD;var dD=function(G){At(b,G);function b(){var u=G!==null&&G.apply(this,arguments)||this;return u.ctrlSeq="\\sqrt",u.domView=new Br(1,function(m){return c("span",{class:"dcg-mq-non-leaf dcg-mq-sqrt-container"},[c("span",{class:"dcg-mq-scaled dcg-mq-sqrt-prefix"},[Fm.sqrt.html()]),c.block("span",{class:"dcg-mq-non-leaf dcg-mq-sqrt-stem"},m[0])])}),u.textTemplate=["sqrt(",")"],u.mathspeakTemplate=["StartRoot,",", EndRoot"],u.ariaLabel="root",u}return b.prototype.parser=function(){return ke.optBlock.then(function(u){return ke.block.map(function(m){var D=new Gv;return D.blocks=[u,m],u.adopt(D,0,0),m.adopt(D,u,0),D})}).or(G.prototype.parser.call(this))},b.prototype.deleteTowards=function(u,m){if(!this.isEmpty()&&u===1){this.moveTowards(e,m),m.parent.deleteOutOf(r,m);return}G.prototype.deleteTowards.call(this,u,m)},b}(ni);T.sqrt=dD,T.hat=function(G){At(b,G);function b(){var u=G!==null&&G.apply(this,arguments)||this;return u.ctrlSeq="\\hat",u.domView=new Br(1,function(m){return c("span",{class:"dcg-mq-non-leaf"},[c("span",{class:"dcg-mq-hat-prefix"},[c.text("^")]),c.block("span",{class:"dcg-mq-hat-stem"},m[0])])}),u.textTemplate=["hat(",")"],u}return b}(ni);var Gv=function(G){At(b,G);function b(){var u=G!==null&&G.apply(this,arguments)||this;return u.domView=new Br(2,function(m){return c("span",{class:"dcg-mq-nthroot-container dcg-mq-non-leaf"},[c.block("sup",{class:"dcg-mq-nthroot dcg-mq-non-leaf"},m[0]),c("span",{class:"dcg-mq-scaled dcg-mq-sqrt-container"},[c("span",{class:"dcg-mq-sqrt-prefix dcg-mq-scaled"},[Fm.sqrt.html()]),c.block("span",{class:"dcg-mq-sqrt-stem dcg-mq-non-leaf"},m[1])])])}),u.textTemplate=["sqrt[","](",")"],u}return b.prototype.latexRecursive=function(u){this.checkCursorContextOpen(u),u.latex+="\\sqrt[",this.getEnd(r).latexRecursive(u),u.latex+="]{",this.getEnd(e).latexRecursive(u),u.latex+="}",this.checkCursorContextClose(u)},b.prototype.mathspeak=function(){var u=this.getEnd(r).mathspeak(),m=this.getEnd(e).mathspeak();return this.getEnd(r).ariaLabel="Index",this.getEnd(e).ariaLabel="Radicand",u==="3"?"Start Cube Root, "+m+", End Cube Root":"Root Index "+u+", Start Root, "+m+", End Root"},b.prototype.deleteTowards=function(u,m){ni.prototype.deleteTowards.call(this,u,m)},b}(dD);T.nthroot=Gv,T.cbrt=function(G){At(b,G);function b(){return G!==null&&G.apply(this,arguments)||this}return b.prototype.createLeftOf=function(u){G.prototype.createLeftOf.call(this,u),new vt("3").createLeftOf(u),u.controller.moveRight()},b}(Gv);var pD=function(G){At(b,G);function b(u,m,D){var L=this,K=new Br(1,function(re){return c("span",{class:"dcg-mq-non-leaf"},[c("span",{class:"dcg-mq-diacritic-above"},[m]),c.block("span",{class:"dcg-mq-diacritic-stem"},re[0])])});return L=G.call(this,u,K,D)||this,L}return b}(ni);T.vec=function(){return new pD("\\vec",c.entityText("&rarr;"),["vec(",")"])},T.tilde=function(){return new pD("\\tilde",c.text("~"),["tilde(",")"])};var uD=function(G){At(b,G);function b(){return G!==null&&G.apply(this,arguments)||this}return b.prototype.setDOM=function(u){var m;G.prototype.setDOM.call(this,u);var D=this.domFrag().children();return D.isEmpty()||(this.delimFrags=(m={},m[r]=D.first(),m[e]=D.last(),m)),this},b}(ni),Fl=function(G){At(b,G);function b(u,m,D,L,K){var re,se=G.call(this,"\\left"+L,void 0,[m,D])||this;return se.side=u,se.sides=(re={},re[r]={ch:m,ctrlSeq:L},re[e]={ch:D,ctrlSeq:K},re),se}return b.prototype.numBlocks=function(){return 1},b.prototype.html=function(){var u=this,m=this.getSymbol(r),D=this.getSymbol(e);return this.domView=new Br(1,function(L){return c("span",{class:"dcg-mq-non-leaf dcg-mq-bracket-container"},[c("span",{style:"width:"+m.width,class:"dcg-mq-scaled dcg-mq-bracket-l dcg-mq-paren"+(u.side===e?" dcg-mq-ghost":"")},[m.html()]),c.block("span",{style:"margin-left:"+m.width+";margin-right:"+D.width,class:"dcg-mq-bracket-middle dcg-mq-non-leaf"},L[0]),c("span",{style:"width:"+D.width,class:"dcg-mq-scaled dcg-mq-bracket-r dcg-mq-paren"+(u.side===r?" dcg-mq-ghost":"")},[D.html()])])}),G.prototype.html.call(this)},b.prototype.getSymbol=function(u){var m=this.sides[u||e].ch;return Fm[m]||{width:"0",html:""}},b.prototype.latexRecursive=function(u){this.checkCursorContextOpen(u),u.latex+="\\left"+this.sides[r].ctrlSeq,this.getEnd(r).latexRecursive(u),u.latex+="\\right"+this.sides[e].ctrlSeq,this.checkCursorContextClose(u)},b.prototype.mathspeak=function(u){var m=this.sides[r].ch,D=this.sides[e].ch;if(m==="|"&&D==="|")this.mathspeakTemplate=["StartAbsoluteValue,",", EndAbsoluteValue"],this.ariaLabel="absolute value";else if(u&&u.createdLeftOf&&this.side){var L="";return this.side===r?L=this.textTemplate[0]:this.side===e&&(L=this.textTemplate[1]),(this.side===r?"left ":"right ")+Lu[L]}else this.mathspeakTemplate=["left "+Lu[m]+",",", right "+Lu[D]],this.ariaLabel=Lu[m]+" block";return G.prototype.mathspeak.call(this)},b.prototype.matchBrack=function(u,m,D){return D instanceof b&&D.side&&D.side!==-m&&(!u.restrictMismatchedBrackets||Jh[this.sides[this.side].ch]===D.sides[D.side].ch||{"(":"]","[":")"}[this.sides[r].ch]===D.sides[e].ch)&&D},b.prototype.closeOpposing=function(u){u.side=0,u.sides[this.side]=this.sides[this.side];var m=u.delimFrags[this.side===r?r:e].removeClass("dcg-mq-ghost");this.replaceBracket(m,this.side)},b.prototype.createLeftOf=function(u){var m;if(!this.replacedFragment){var D=u.options;this.sides[r].ch==="|"?m=this.matchBrack(D,e,u[e])||this.matchBrack(D,r,u[r])||this.matchBrack(D,0,u.parent.parent):m=this.matchBrack(D,-this.side,u[-this.side])||this.matchBrack(D,-this.side,u.parent.parent)}if(m){var L=this.side=-m.side;this.closeOpposing(m),m===u.parent.parent&&u[L]&&new w(u[L],u.parent.getEnd(L),-L).disown().withDirAdopt(-L,m.parent,m,m[L]).domFrag().insDirOf(L,m.domFrag()),m.bubble(function(K){K.reflow()})}else m=this,L=m.side,m.replacedFragment?m.side=0:u[-L]&&(m.replaces(new w(u[-L],u.parent.getEnd(-L),L)),u[-L]=0),G.prototype.createLeftOf.call(this,u);L===r?u.insAtLeftEnd(m.getEnd(r)):u.insRightOf(m)},b.prototype.placeCursor=function(){},b.prototype.unwrap=function(){this.getEnd(r).children().disown().adopt(this.parent,this,this[e]).domFrag().insertAfter(this.domFrag()),this.remove()},b.prototype.deleteSide=function(u,m,D){var L=this.parent,K=this[u],re=L.getEnd(u);if(u===this.side){this.unwrap(),K?D.insDirOf(-u,K):D.insAtDirEnd(u,L);return}var se=D.options,we=!this.side;if(this.side=-u,this.matchBrack(se,u,this.getEnd(r).getEnd(this.side))){this.closeOpposing(this.getEnd(r).getEnd(this.side));var Ye=this.getEnd(r).getEnd(u);this.unwrap(),Ye&&Ye.siblingCreated(D.options,u),K?D.insDirOf(-u,K):D.insAtDirEnd(u,L)}else{if(this.matchBrack(se,u,this.parent.parent))this.parent.parent.closeOpposing(this),this.parent.parent.unwrap();else if(m&&we){this.unwrap(),K?D.insDirOf(-u,K):D.insAtDirEnd(u,L);return}else{this.sides[u]=pP(this),this.delimFrags[r].removeClass("dcg-mq-ghost"),this.delimFrags[e].removeClass("dcg-mq-ghost");var Ke=this.delimFrags[u].addClass("dcg-mq-ghost");this.replaceBracket(Ke,u)}if(K){var Fe=this.getEnd(r),Ye=Fe.getEnd(u);Fe.domFrag().removeClass("dcg-mq-empty"),new w(K,re,-u).disown().withDirAdopt(-u,Fe,Ye,0).domFrag().insAtDirEnd(u,Fe.domFrag().oneElement()),Ye&&Ye.siblingCreated(D.options,u),D.insDirOf(-u,K)}else m?D.insDirOf(u,this):D.insAtDirEnd(u,this.getEnd(r))}},b.prototype.replaceBracket=function(u,m){var D=this.getSymbol(m);if(u.children().replaceWith(P(D.html())),u.oneElement().style.width=D.width,m===r){var L=u.next();L.isEmpty()||(L.oneElement().style.marginLeft=D.width)}else{var K=u.prev();K.isEmpty()||(K.oneElement().style.marginRight=D.width)}},b.prototype.deleteTowards=function(u,m){this.deleteSide(-u,!1,m)},b.prototype.finalizeTree=function(){this.getEnd(r).deleteOutOf=function(u,m){this.parent.deleteSide(u,!0,m)},this.finalizeTree=this.intentionalBlur=function(){this.delimFrags[this.side===r?e:r].removeClass("dcg-mq-ghost"),this.side=0}},b.prototype.siblingCreated=function(u,m){m===-this.side&&this.finalizeTree()},b}(uD);function pP(G){var b=G.side,u=G.sides[b];return{ch:Jh[u.ch],ctrlSeq:Jh[u.ctrlSeq]}}var Jh={"(":")",")":"(","[":"]","]":"[","{":"}","}":"{","\\{":"\\}","\\}":"\\{","&lang;":"&rang;","&rang;":"&lang;","\\langle ":"\\rangle ","\\rangle ":"\\langle ","|":"|","\\lVert ":"\\rVert ","\\rVert ":"\\lVert "},Lu={"&lang;":"angle-bracket","&rang;":"angle-bracket","|":"pipe"};function Tv(G,m,u){var m=m||G,D=Jh[G],L=Jh[m];B[G]=function(){return new Fl(r,G,D,m,L)},B[D]=function(){return new Fl(e,G,D,m,L)},Lu[G]=Lu[D]=u}Tv("(","","parenthesis"),Tv("[","","bracket"),Tv("{","\\{","brace"),T.langle=function(){return new Fl(r,"&lang;","&rang;","\\langle ","\\rangle ")},T.rangle=function(){return new Fl(e,"&lang;","&rang;","\\langle ","\\rangle ")},B["|"]=function(){return new Fl(r,"|","|","|","|")},T.lVert=function(){return new Fl(r,"&#8741;","&#8741;","\\lVert ","\\rVert ")},T.rVert=function(){return new Fl(e,"&#8741;","&#8741;","\\lVert ","\\rVert ")},T.left=function(G){At(b,G);function b(){return G!==null&&G.apply(this,arguments)||this}return b.prototype.parser=function(){var u=ve.regex,m=ve.string,D=ve.optWhitespace;return D.then(u(/^(?:[([|]|\\\{|\\langle(?![a-zA-Z])|\\lVert(?![a-zA-Z]))/)).then(function(L){var K=L.replace(/^\\/,"");return L=="\\langle"&&(K="&lang;",L=L+" "),L=="\\lVert"&&(K="&#8741;",L=L+" "),ke.then(function(re){return m("\\right").skip(D).then(u(/^(?:[\])|]|\\\}|\\rangle(?![a-zA-Z])|\\rVert(?![a-zA-Z]))/)).map(function(se){var we=se.replace(/^\\/,"");se=="\\rangle"&&(we="&rang;",se=se+" "),se=="\\rVert"&&(we="&#8741;",se=se+" ");var Ye=new Fl(0,K,we,L,se);return Ye.blocks=[re],re.adopt(Ye,0,0),Ye})})})},b}(ni),T.right=function(G){At(b,G);function b(){return G!==null&&G.apply(this,arguments)||this}return b.prototype.parser=function(){return ve.fail("unmatched \\right")},b}(ni);var Nm=Fm["("],Bb=Fm[")"],hD=function(G){At(b,G);function b(){var u=G!==null&&G.apply(this,arguments)||this;return u.ctrlSeq="\\binom",u.domView=new Br(2,function(m){return c("span",{class:"dcg-mq-non-leaf dcg-mq-bracket-container"},[c("span",{style:"width:"+Nm.width,class:"dcg-mq-paren dcg-mq-bracket-l dcg-mq-scaled"},[Nm.html()]),c("span",{style:"margin-left:"+Nm.width+"; margin-right:"+Bb.width,class:"dcg-mq-non-leaf dcg-mq-bracket-middle"},[c("span",{class:"dcg-mq-array dcg-mq-non-leaf"},[c.block("span",{},m[0]),c.block("span",{},m[1])])]),c("span",{style:"width:"+Bb.width,class:"dcg-mq-paren dcg-mq-bracket-r dcg-mq-scaled"},[Bb.html()])])}),u.textTemplate=["choose(",",",")"],u.mathspeakTemplate=["StartBinomial,","Choose",", EndBinomial"],u.ariaLabel="binomial",u}return b.prototype.finalizeTree=function(){var u=this.getEnd(r),m=this.getEnd(e);this.upInto=m.upOutOf=u,this.downInto=u.downOutOf=m,u.ariaLabel="upper index",m.ariaLabel="lower index"},b}(uD);T.binom=T.binomial=hD,T.choose=function(G){At(b,G);function b(){return G!==null&&G.apply(this,arguments)||this}return b.prototype.createLeftOf=function(u){aD.prototype.createLeftOf.call(this,u)},b}(hD);var uP=function(G){At(b,G);function b(){var u=G!==null&&G.apply(this,arguments)||this;return u.ctrlSeq="\\MathQuillMathField",u.domView=new Br(1,function(m){return c("span",{class:"dcg-mq-editable-field"},[c.block("span",{class:"dcg-mq-root-block","aria-hidden":"true"},m[0])])}),u}return b.prototype.parser=function(){var u=this,m=ve.string,D=ve.regex,L=ve.succeed;return m("[").then(D(/^[a-z][a-z0-9]*/i)).skip(m("]")).map(function(K){u.name=K}).or(L(void 0)).then(G.prototype.parser.call(this))},b.prototype.finalizeTree=function(u){var m=new Bo(this.getEnd(r),this.domFrag().oneElement(),u);m.KIND_OF_MQ="MathField",m.editable=!0,m.createTextarea(),m.editablesTextareaEvents(),m.cursor.insAtRightEnd(m.root),Ne(m.root);function D(L){if(L.parentNode&&!P(L).hasClass("dcg-mq-root-block")&&D(L.parentNode),L.nodeType===Node.ELEMENT_NODE){var K=L;K.getAttribute("aria-hidden")==="true"&&(K.removeAttribute("aria-hidden"),P(L).children().eachElement(function(re){re.setAttribute("aria-hidden","true")}))}}D(this.domFrag().parent().oneElement()),this.domFrag().oneElement().removeAttribute("aria-hidden")},b.prototype.registerInnerField=function(u,m){var D=this.getEnd(r).controller,L=new m(D);u[this.name]=L,u.push(L)},b.prototype.latexRecursive=function(u){this.checkCursorContextOpen(u),this.getEnd(r).latexRecursive(u),this.checkCursorContextClose(u)},b.prototype.text=function(){return this.getEnd(r).text()},b}(ni);T.editable=T.MathQuillMathField=uP;var gD=function(G){At(b,G);function b(){return G!==null&&G.apply(this,arguments)||this}return b.prototype.setOptions=function(u){function m(){return""}return this.text=u.text||m,this.domView=new Br(0,function(){return c("span",{},[l(u.htmlString||"")])}),this.latex=u.latex||m,this},b.prototype.latexRecursive=function(u){this.checkCursorContextOpen(u),u.latex+=this.latex(),this.checkCursorContextClose(u)},b.prototype.parser=function(){var u=this,m=ve.string,D=ve.regex,L=ve.succeed;return m("{").then(D(/^[a-z][a-z0-9]*/i)).skip(m("}")).then(function(K){return m("[").then(D(/^[-\w\s]*/)).skip(m("]")).or(L(void 0)).map(function(re){return u.setOptions(X[K](re))})})},b}(Uo);if(T.embed=gD,window.jQuery){Le=W(1);for(var mD in Le)(function(G,b){typeof b=="function"?(Se[G]=function(){return Ee(),b.apply(this,arguments)},Se[G].prototype=b.prototype):Se[G]=b})(mD,Le[mD])}})()});var aX=__dcg_shared_module_exports__['c']((p9e,nX)=>{nX.exports={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,menuitem:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}});var lX=__dcg_shared_module_exports__['c']((u9e,sX)=>{var Cue=/([\w-]+)|=|(['"])([.\s\S]*?)\2/g,Eue=aX();sX.exports=function(r){var e=0,t,i=!0,o={type:"tag",name:"",voidElement:!1,attrs:{},children:[]};return r.replace(Cue,function(n){if(n==="="){i=!0,e++;return}i?e===0?((Eue[n]||r.charAt(r.length-2)==="/")&&(o.voidElement=!0),o.name=n):(o.attrs[t]=n.replace(/^['"]|['"]$/g,""),t=void 0):(t&&(o.attrs[t]=t),t=n),e++,i=!1}),o}});var dX=__dcg_shared_module_exports__['c']((h9e,cX)=>{var Sue=/(?:<!--[\S\s]*?-->|<(?:"[^"]*"['"]*|'[^']*'['"]*|[^'">])+>)/g,Due=lX(),kue=Object.create?Object.create(null):{};function n3(r,e,t,i,o){var n=e.indexOf("<",i),a=e.slice(i,n===-1?void 0:n);/^\s*$/.test(a)&&(a=" "),(!o&&n>-1&&t+r.length>=0||a!==" ")&&r.push({type:"text",content:a})}cX.exports=function(e,t){t||(t={}),t.components||(t.components=kue);var i=[],o,n=-1,a=[],s={},l=!1;return e.replace(Sue,function(c,d){if(l){if(c!=="</"+o.name+">")return;l=!1}var p=c.charAt(1)!=="/",g=c.indexOf("<!--")===0,h=d+c.length,f=e.charAt(h),y;p&&!g&&(n++,o=Due(c),o.type==="tag"&&t.components[o.name]&&(o.type="component",l=!0),!o.voidElement&&!l&&f&&f!=="<"&&n3(o.children,e,n,h,t.ignoreWhitespace),s[o.tagName]=o,n===0&&i.push(o),y=a[n-1],y&&y.children.push(o),a[n]=o),(g||!p||o.voidElement)&&(g||n--,!l&&f!=="<"&&f&&(y=n===-1?i:a[n].children,n3(y,e,n,h,t.ignoreWhitespace)))}),!i.length&&e.length&&n3(i,e,0,0,t.ignoreWhitespace),i}});var hX=__dcg_shared_module_exports__['c']((g9e,uX)=>{function Gue(r){var e=[];for(var t in r)e.push(t+'="'+r[t]+'"');return e.length?" "+e.join(" "):""}function pX(r,e){switch(e.type){case"text":return r+e.content;case"tag":return r+="<"+e.name+(e.attrs?Gue(e.attrs):"")+(e.voidElement?"/>":">"),e.voidElement?r:r+e.children.reduce(pX,"")+"</"+e.name+">"}}uX.exports=function(r){return r.reduce(function(e,t){return e+pX("",t)},"")}});var mX=__dcg_shared_module_exports__['c']((m9e,gX)=>{gX.exports={parse:dX(),stringify:hX()}});var nZ=__dcg_shared_module_exports__['c']((oZ,NN)=>{(function(r){if(typeof oZ=="object"&&typeof NN!="undefined")NN.exports=r();else{var e;typeof window!="undefined"?e=window:typeof global!="undefined"?e=global:typeof self!="undefined"?e=self:e=this,e.Bugsnag=r()}})(function(){var r,e,t,i=["navigation","request","process","log","user","state","error","manual"],o=function(V,N,z){for(var $=z,oe=0,ye=V.length;oe<ye;oe++)$=N($,V[oe],oe,V);return $},n=function(V,N){return o(V,function(z,$,oe,ye){return N($,oe,ye)?z.concat($):z},[])},a=function(V,N){return o(V,function(z,$,oe,ye){return z===!0||$===N},!1)},s=function(V){return Object.prototype.toString.call(V)==="[object Array]"},l=!{toString:null}.propertyIsEnumerable("toString"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=function(V){var N=[],z;for(z in V)Object.prototype.hasOwnProperty.call(V,z)&&N.push(z);if(!l)return N;for(var $=0,oe=c.length;$<oe;$++)Object.prototype.hasOwnProperty.call(V,c[$])&&N.push(c[$]);return N},p=function(V,N){return V===void 0&&(V=1),N===void 0&&(N=1/0),function(z){return typeof z=="number"&&parseInt(""+z,10)===z&&z>=V&&z<=N}},g=function(V){return typeof V=="function"||s(V)&&n(V,function(N){return typeof N=="function"}).length===V.length},h=function(V){return typeof V=="string"&&!!V.length},f={},y=function(){return{unhandledExceptions:!0,unhandledRejections:!0}};f.schema={apiKey:{defaultValue:function(){return null},message:"is required",validate:h},appVersion:{defaultValue:function(){},message:"should be a string",validate:function(V){return V===void 0||h(V)}},appType:{defaultValue:function(){},message:"should be a string",validate:function(V){return V===void 0||h(V)}},autoDetectErrors:{defaultValue:function(){return!0},message:"should be true|false",validate:function(V){return V===!0||V===!1}},enabledErrorTypes:{defaultValue:function(){return y()},message:"should be an object containing the flags { unhandledExceptions:true|false, unhandledRejections:true|false }",allowPartialObject:!0,validate:function(V){if(typeof V!="object"||!V)return!1;var N=d(V),z=d(y());return!(n(N,function($){return a(z,$)}).length<N.length||n(d(V),function($){return typeof V[$]!="boolean"}).length>0)}},onError:{defaultValue:function(){return[]},message:"should be a function or array of functions",validate:g},onSession:{defaultValue:function(){return[]},message:"should be a function or array of functions",validate:g},onBreadcrumb:{defaultValue:function(){return[]},message:"should be a function or array of functions",validate:g},endpoints:{defaultValue:function(){return{notify:"https://notify.bugsnag.com",sessions:"https://sessions.bugsnag.com"}},message:"should be an object containing endpoint URLs { notify, sessions }",validate:function(V){return V&&typeof V=="object"&&h(V.notify)&&h(V.sessions)&&n(d(V),function(N){return!a(["notify","sessions"],N)}).length===0}},autoTrackSessions:{defaultValue:function(V){return!0},message:"should be true|false",validate:function(V){return V===!0||V===!1}},enabledReleaseStages:{defaultValue:function(){return null},message:"should be an array of strings",validate:function(V){return V===null||s(V)&&n(V,function(N){return typeof N=="string"}).length===V.length}},releaseStage:{defaultValue:function(){return"production"},message:"should be a string",validate:function(V){return typeof V=="string"&&V.length}},maxBreadcrumbs:{defaultValue:function(){return 25},message:"should be a number \u2264100",validate:function(V){return p(0,100)(V)}},enabledBreadcrumbTypes:{defaultValue:function(){return i},message:"should be null or a list of available breadcrumb types ("+i.join(",")+")",validate:function(V){return V===null||s(V)&&o(V,function(N,z){return N===!1?N:a(i,z)},!0)}},context:{defaultValue:function(){},message:"should be a string",validate:function(V){return V===void 0||typeof V=="string"}},user:{defaultValue:function(){return{}},message:"should be an object with { id, email, name } properties",validate:function(V){return V===null||V&&o(d(V),function(N,z){return N&&a(["id","email","name"],z)},!0)}},metadata:{defaultValue:function(){return{}},message:"should be an object",validate:function(V){return typeof V=="object"&&V!==null}},logger:{defaultValue:function(){},message:"should be null or an object with methods { debug, info, warn, error }",validate:function(V){return!V||V&&o(["debug","info","warn","error"],function(N,z){return N&&typeof V[z]=="function"},!0)}},redactedKeys:{defaultValue:function(){return["password"]},message:"should be an array of strings|regexes",validate:function(V){return s(V)&&V.length===n(V,function(N){return typeof N=="string"||N&&typeof N.test=="function"}).length}},plugins:{defaultValue:function(){return[]},message:"should be an array of plugin objects",validate:function(V){return s(V)&&V.length===n(V,function(N){return N&&typeof N=="object"&&typeof N.load=="function"}).length}},featureFlags:{defaultValue:function(){return[]},message:'should be an array of objects that have a "name" property',validate:function(V){return s(V)&&V.length===n(V,function(N){return N&&typeof N=="object"&&typeof N.name=="string"}).length}}};var x=function(V){for(var N=1;N<arguments.length;N++){var z=arguments[N];for(var $ in z)Object.prototype.hasOwnProperty.call(z,$)&&(V[$]=z[$])}return V},E=function(V,N){return o(V,function(z,$,oe,ye){return z.concat(N($,oe,ye))},[])};function C(){return C=Object.assign?Object.assign.bind():function(V){for(var N=1;N<arguments.length;N++){var z=arguments[N];for(var $ in z)Object.prototype.hasOwnProperty.call(z,$)&&(V[$]=z[$])}return V},C.apply(this,arguments)}var S=f.schema,v={releaseStage:x({},S.releaseStage,{defaultValue:function(){return/^localhost(:\d+)?$/.test(window.location.host)?"development":"production"}}),appType:C({},S.appType,{defaultValue:function(){return"browser"}}),logger:x({},S.logger,{defaultValue:function(){return typeof console!="undefined"&&typeof console.debug=="function"?M():void 0}})},M=function(){var V={},N=console.log;return E(["debug","info","warn","error"],function(z){var $=console[z];V[z]=typeof $=="function"?$.bind(console,"[bugsnag]"):N.bind(console,"[bugsnag]")}),V},A=function(){function V(z,$,oe,ye){ye===void 0&&(ye=new Date),this.type=oe,this.message=z,this.metadata=$,this.timestamp=ye}var N=V.prototype;return N.toJSON=function(){return{type:this.type,name:this.message,timestamp:this.timestamp,metaData:this.metadata}},V}(),I=A,P={};(function(V,N){"use strict";typeof r=="function"&&r.amd?r("stackframe",[],N):typeof P=="object"?P=N():V.StackFrame=N()})(this,function(){"use strict";function V(yt){return!isNaN(parseFloat(yt))&&isFinite(yt)}function N(yt){return yt.charAt(0).toUpperCase()+yt.substring(1)}function z(yt){return function(){return this[yt]}}var $=["isConstructor","isEval","isNative","isToplevel"],oe=["columnNumber","lineNumber"],ye=["fileName","functionName","source"],Me=["args"],Je=$.concat(oe,ye,Me);function qe(yt){if(yt instanceof Object)for(var cr=0;cr<Je.length;cr++)yt.hasOwnProperty(Je[cr])&&yt[Je[cr]]!==void 0&&this["set"+N(Je[cr])](yt[Je[cr]])}qe.prototype={getArgs:function(){return this.args},setArgs:function(yt){if(Object.prototype.toString.call(yt)!=="[object Array]")throw new TypeError("Args must be an Array");this.args=yt},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(yt){if(yt instanceof qe)this.evalOrigin=yt;else if(yt instanceof Object)this.evalOrigin=new qe(yt);else throw new TypeError("Eval Origin must be an Object or StackFrame")},toString:function(){var yt=this.getFunctionName()||"{anonymous}",cr="("+(this.getArgs()||[]).join(",")+")",Ko=this.getFileName()?"@"+this.getFileName():"",ho=V(this.getLineNumber())?":"+this.getLineNumber():"",tr=V(this.getColumnNumber())?":"+this.getColumnNumber():"";return yt+cr+Ko+ho+tr}};for(var Vt=0;Vt<$.length;Vt++)qe.prototype["get"+N($[Vt])]=z($[Vt]),qe.prototype["set"+N($[Vt])]=function(yt){return function(cr){this[yt]=!!cr}}($[Vt]);for(var Gt=0;Gt<oe.length;Gt++)qe.prototype["get"+N(oe[Gt])]=z(oe[Gt]),qe.prototype["set"+N(oe[Gt])]=function(yt){return function(cr){if(!V(cr))throw new TypeError(yt+" must be a Number");this[yt]=Number(cr)}}(oe[Gt]);for(var xr=0;xr<ye.length;xr++)qe.prototype["get"+N(ye[xr])]=z(ye[xr]),qe.prototype["set"+N(ye[xr])]=function(yt){return function(cr){this[yt]=String(cr)}}(ye[xr]);return qe});var _={};(function(V,N){"use strict";typeof r=="function"&&r.amd?r("error-stack-parser",["stackframe"],N):typeof _=="object"?_=N(P):V.ErrorStackParser=N(V.StackFrame)})(this,function(N){"use strict";var z=/(^|@)\S+\:\d+/,$=/^\s*at .*(\S+\:\d+|\(native\))/m,oe=/^(eval@)?(\[native code\])?$/;return{parse:function(Me){if(typeof Me.stacktrace!="undefined"||typeof Me["opera#sourceloc"]!="undefined")return this.parseOpera(Me);if(Me.stack&&Me.stack.match($))return this.parseV8OrIE(Me);if(Me.stack)return this.parseFFOrSafari(Me);throw new Error("Cannot parse given Error object")},extractLocation:function(Me){if(Me.indexOf(":")===-1)return[Me];var Je=/(.+?)(?:\:(\d+))?(?:\:(\d+))?$/,qe=Je.exec(Me.replace(/[\(\)]/g,""));return[qe[1],qe[2]||void 0,qe[3]||void 0]},parseV8OrIE:function(Me){var Je=Me.stack.split(`
`).filter(function(qe){return!!qe.match($)},this);return Je.map(function(qe){qe.indexOf("(eval ")>-1&&(qe=qe.replace(/eval code/g,"eval").replace(/(\(eval at [^\()]*)|(\)\,.*$)/g,""));var Vt=qe.replace(/^\s+/,"").replace(/\(eval code/g,"("),Gt=Vt.match(/ (\((.+):(\d+):(\d+)\)$)/);Vt=Gt?Vt.replace(Gt[0],""):Vt;var xr=Vt.split(/\s+/).slice(1),yt=this.extractLocation(Gt?Gt[1]:xr.pop()),cr=xr.join(" ")||void 0,Ko=["eval","<anonymous>"].indexOf(yt[0])>-1?void 0:yt[0];return new N({functionName:cr,fileName:Ko,lineNumber:yt[1],columnNumber:yt[2],source:qe})},this)},parseFFOrSafari:function(Me){var Je=Me.stack.split(`
`).filter(function(qe){return!qe.match(oe)},this);return Je.map(function(qe){if(qe.indexOf(" > eval")>-1&&(qe=qe.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g,":$1")),qe.indexOf("@")===-1&&qe.indexOf(":")===-1)return new N({functionName:qe});var Vt=/((.*".+"[^@]*)?[^@]*)(?:@)/,Gt=qe.match(Vt),xr=Gt&&Gt[1]?Gt[1]:void 0,yt=this.extractLocation(qe.replace(Vt,""));return new N({functionName:xr,fileName:yt[0],lineNumber:yt[1],columnNumber:yt[2],source:qe})},this)},parseOpera:function(Me){return!Me.stacktrace||Me.message.indexOf(`
`)>-1&&Me.message.split(`
`).length>Me.stacktrace.split(`
`).length?this.parseOpera9(Me):Me.stack?this.parseOpera11(Me):this.parseOpera10(Me)},parseOpera9:function(Me){for(var Je=/Line (\d+).*script (?:in )?(\S+)/i,qe=Me.message.split(`
`),Vt=[],Gt=2,xr=qe.length;Gt<xr;Gt+=2){var yt=Je.exec(qe[Gt]);yt&&Vt.push(new N({fileName:yt[2],lineNumber:yt[1],source:qe[Gt]}))}return Vt},parseOpera10:function(Me){for(var Je=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,qe=Me.stacktrace.split(`
`),Vt=[],Gt=0,xr=qe.length;Gt<xr;Gt+=2){var yt=Je.exec(qe[Gt]);yt&&Vt.push(new N({functionName:yt[3]||void 0,fileName:yt[2],lineNumber:yt[1],source:qe[Gt]}))}return Vt},parseOpera11:function(Me){var Je=Me.stack.split(`
`).filter(function(qe){return!!qe.match(z)&&!qe.match(/^Error created at/)},this);return Je.map(function(qe){var Vt=qe.split("@"),Gt=this.extractLocation(Vt.pop()),xr=Vt.shift()||"",yt=xr.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^\)]*\)/g,"")||void 0,cr;xr.match(/\(([^\)]*)\)/)&&(cr=xr.replace(/^[^\(]+\(([^\)]*)\)$/,"$1"));var Ko=cr===void 0||cr==="[arguments not available]"?void 0:cr.split(",");return new N({functionName:yt,args:Ko,fileName:Gt[0],lineNumber:Gt[1],columnNumber:Gt[2],source:qe})},this)}}});var U=_,Y=function(V,N,z,$){var oe=$&&$.redactedKeys?$.redactedKeys:[],ye=$&&$.redactedPaths?$.redactedPaths:[];return JSON.stringify(le(V,oe,ye),N,z)},R=20,H=25e3,O=8,q="...";function w(V){return V instanceof Error||/^\[object (Error|(Dom)?Exception)\]$/.test(Object.prototype.toString.call(V))}function T(V){return"[Throws: "+(V?V.message:"?")+"]"}function B(V,N){for(var z=0,$=V.length;z<$;z++)if(V[z]===N)return!0;return!1}function de(V,N){for(var z=0,$=V.length;z<$;z++)if(N.indexOf(V[z])===0)return!0;return!1}function F(V,N){for(var z=0,$=V.length;z<$;z++)if(typeof V[z]=="string"&&V[z].toLowerCase()===N.toLowerCase()||V[z]&&typeof V[z].test=="function"&&V[z].test(N))return!0;return!1}function j(V){return Object.prototype.toString.call(V)==="[object Array]"}function pe(V,N){try{return V[N]}catch(z){return T(z)}}function le(V,N,z){var $=[],oe=0;function ye(Me,Je){function qe(){return Je.length>O&&oe>H}if(oe++,Je.length>R||qe())return q;if(Me===null||typeof Me!="object")return Me;if(B($,Me))return"[Circular]";if($.push(Me),typeof Me.toJSON=="function")try{oe--;var Vt=ye(Me.toJSON(),Je);return $.pop(),Vt}catch($r){return T($r)}var Gt=w(Me);if(Gt){oe--;var xr=ye({name:Me.name,message:Me.message},Je);return $.pop(),xr}if(j(Me)){for(var yt=[],cr=0,Ko=Me.length;cr<Ko;cr++){if(qe()){yt.push(q);break}yt.push(ye(Me[cr],Je.concat("[]")))}return $.pop(),yt}var ho={};try{for(var tr in Me)if(Object.prototype.hasOwnProperty.call(Me,tr)){if(de(z,Je.join("."))&&F(N,tr)){ho[tr]="[REDACTED]";continue}if(qe()){ho[tr]=q;break}ho[tr]=ye(pe(Me,tr),Je.concat(tr))}}catch($r){}return $.pop(),ho}return ye(V,[])}function ne(V,N,z,$){if(typeof z=="string"){$===void 0?$=null:$!==null&&typeof $!="string"&&($=Y($));var oe=N[z];if(typeof oe=="number"){V[oe]={name:z,variant:$};return}V.push({name:z,variant:$}),N[z]=V.length-1}}function X(V,N,z){if(s(N)){for(var $=0;$<N.length;++$){var oe=N[$];oe===null||typeof oe!="object"||ne(V,z,oe.name,oe.variant)}return V}}function ae(V){return E(n(V,Boolean),function(N){var z=N.name,$=N.variant,oe={featureFlag:z};return typeof $=="string"&&(oe.variant=$),oe})}function J(V,N,z){var $=N[z];typeof $=="number"&&(V[$]=null,delete N[z])}var ge={add:ne,clear:J,merge:X,toEventApi:ae},be=function(V){return!!V&&(!!V.stack||!!V.stacktrace||!!V["opera#sourceloc"])&&typeof(V.stack||V.stacktrace||V["opera#sourceloc"])=="string"&&V.stack!==V.name+": "+V.message},Ee=Le;function Le(V){switch(Object.prototype.toString.call(V)){case"[object Error]":return!0;case"[object Exception]":return!0;case"[object DOMException]":return!0;default:return V instanceof Error}}var Se=Ee,et=function(V,N,z,$){var oe;if(N){var ye;if(z===null)return W(V,N);typeof z=="object"&&(ye=z),typeof z=="string"&&(ye=(oe={},oe[z]=$,oe)),ye&&(V[N]||(V[N]={}),V[N]=x({},V[N],ye))}},Z=function(V,N,z){if(typeof N=="string"){if(!z)return V[N];if(V[N])return V[N][z]}},W=function(V,N,z){if(typeof N=="string"){if(!z){delete V[N];return}V[N]&&delete V[N][z]}},De={add:et,get:Z,clear:W},Ne={};(function(V,N){"use strict";typeof r=="function"&&r.amd?r("stack-generator",["stackframe"],N):typeof Ne=="object"?Ne=N(P):V.StackGenerator=N(V.StackFrame)})(this,function(V){return{backtrace:function(z){var $=[],oe=10;typeof z=="object"&&typeof z.maxStackSize=="number"&&(oe=z.maxStackSize);for(var ye=arguments.callee;ye&&$.length<oe&&ye.arguments;){for(var Me=new Array(ye.arguments.length),Je=0;Je<Me.length;++Je)Me[Je]=ye.arguments[Je];/function(?:\s+([\w$]+))+\s*\(/.test(ye.toString())?$.push(new V({functionName:RegExp.$1||void 0,args:Me})):$.push(new V({args:Me}));try{ye=ye.caller}catch(qe){break}}return $}}});var me=function(){function V(z,$,oe,ye,Me){oe===void 0&&(oe=[]),ye===void 0&&(ye=He()),this.apiKey=void 0,this.context=void 0,this.groupingHash=void 0,this.originalError=Me,this._handledState=ye,this.severity=this._handledState.severity,this.unhandled=this._handledState.unhandled,this.app={},this.device={},this.request={},this.breadcrumbs=[],this.threads=[],this._metadata={},this._features=[],this._featuresIndex={},this._user={},this._session=void 0,this.errors=[Ge(z,$,V.__type,oe)]}var N=V.prototype;return N.addMetadata=function($,oe,ye){return De.add(this._metadata,$,oe,ye)},N.getMetadata=function($,oe){return De.get(this._metadata,$,oe)},N.clearMetadata=function($,oe){return De.clear(this._metadata,$,oe)},N.addFeatureFlag=function($,oe){oe===void 0&&(oe=null),ge.add(this._features,this._featuresIndex,$,oe)},N.addFeatureFlags=function($){ge.merge(this._features,$,this._featuresIndex)},N.getFeatureFlags=function(){return ge.toEventApi(this._features)},N.clearFeatureFlag=function($){ge.clear(this._features,this._featuresIndex,$)},N.clearFeatureFlags=function(){this._features=[],this._featuresIndex={}},N.getUser=function(){return this._user},N.setUser=function($,oe,ye){this._user={id:$,email:oe,name:ye}},N.toJSON=function(){return{payloadVersion:"4",exceptions:E(this.errors,function($){return x({},$,{message:$.errorMessage})}),severity:this.severity,unhandled:this._handledState.unhandled,severityReason:this._handledState.severityReason,app:this.app,device:this.device,request:this.request,breadcrumbs:this.breadcrumbs,context:this.context,groupingHash:this.groupingHash,metaData:this._metadata,user:this._user,session:this._session,featureFlags:this.getFeatureFlags()}},V}(),ve=function(V){var N={file:V.fileName,method:Pe(V.functionName),lineNumber:V.lineNumber,columnNumber:V.columnNumber,code:void 0,inProject:void 0};return N.lineNumber>-1&&!N.file&&!N.method&&(N.file="global code"),N},Pe=function(V){return/^global code$/i.test(V)?"global code":V},He=function(){return{unhandled:!1,severity:"warning",severityReason:{type:"handledException"}}},ot=function(V){return typeof V=="string"?V:""};function Ge(V,N,z,$){return{errorClass:ot(V),errorMessage:ot(N),type:z,stacktrace:o($,function(oe,ye){var Me=ve(ye);try{return JSON.stringify(Me)==="{}"?oe:oe.concat(Me)}catch(Je){return oe}},[])}}function Et(V){return V.cause?[V].concat(Et(V.cause)):[V]}me.getStacktrace=function(V,N,z){if(be(V))return U.parse(V).slice(N);try{return n(Ne.backtrace(),function($){return($.functionName||"").indexOf("StackGenerator$$")===-1}).slice(1+z)}catch($){return[]}},me.create=function(V,N,z,$,oe,ye){oe===void 0&&(oe=0);var Me=Tr(V,N,$,ye),Je=Me[0],qe=Me[1],Vt;try{var Gt=me.getStacktrace(Je,qe>0?1+qe+oe:0,1+oe);Vt=new me(Je.name,Je.message,Gt,z,V)}catch(Ko){Vt=new me(Je.name,Je.message,[],z,V)}if(Je.name==="InvalidError"&&Vt.addMetadata(""+$,"non-error parameter",Oe(V)),Je.cause){var xr,yt=Et(Je).slice(1),cr=E(yt,function(Ko){var ho=Se(Ko)&&be(Ko)?U.parse(Ko):[],tr=Tr(Ko,!0,"error cause"),$r=tr[0];return $r.name==="InvalidError"&&Vt.addMetadata("error cause",Oe(Ko)),Ge($r.name,$r.message,me.__type,ho)});(xr=Vt.errors).push.apply(xr,cr)}return Vt};var Oe=function(V){return V===null?"null":V===void 0?"undefined":V},Tr=function(V,N,z,$){var oe,ye=0,Me=function(Je){var qe=z==="error cause"?"was":"received";$&&$.warn(z+" "+qe+' a non-error: "'+Je+'"');var Vt=new Error(z+" "+qe+' a non-error. See "'+z+'" tab for more detail.');return Vt.name="InvalidError",Vt};if(!N)Se(V)?oe=V:(oe=Me(typeof V),ye+=2);else switch(typeof V){case"string":case"number":case"boolean":oe=new Error(String(V)),ye+=1;break;case"function":oe=Me("function"),ye+=2;break;case"object":V!==null&&Se(V)?oe=V:V!==null&&Q(V)?(oe=new Error(V.message||V.errorMessage),oe.name=V.name||V.errorClass,ye+=1):(oe=Me(V===null?"null":"unsupported object"),ye+=2);break;default:oe=Me("nothing"),ye+=2}if(!be(oe))try{throw oe}catch(Je){be(Je)&&(oe=Je,ye=1)}return[oe,ye]};me.__type="browserjs";var Q=function(V){return(typeof V.name=="string"||typeof V.errorClass=="string")&&(typeof V.message=="string"||typeof V.errorMessage=="string")},ke=me,Ue=function(V,N,z){var $=0,oe=function(){if($>=V.length)return z(null,!0);N(V[$],function(ye,Me){if(ye)return z(ye);if(Me===!1)return z(null,!1);$++,oe()})};oe()},xe=function(V,N,z,$){var oe=function(ye,Me){if(typeof ye!="function")return Me(null);try{if(ye.length!==2){var Je=ye(N);return Je&&typeof Je.then=="function"?Je.then(function(qe){return setTimeout(function(){return Me(null,qe)})},function(qe){setTimeout(function(){return z(qe),Me(null,!0)})}):Me(null,Je)}ye(N,function(qe,Vt){if(qe)return z(qe),Me(null);Me(null,Vt)})}catch(qe){z(qe),Me(null)}};Ue(V,oe,$)},ct=function(V,N,z,$){for(var oe=!1,ye=V.slice();!oe&&ye.length;)try{oe=ye.pop()(N)===!1}catch(Me){$.error("Error occurred in "+z+" callback, continuing anyway\u2026"),$.error(Me)}return oe},it=function(N,z){var $="000000000"+N;return $.substr($.length-z)},li=typeof window=="object"?window:self,Mt=0;for(var Bo in li)Object.hasOwnProperty.call(li,Bo)&&Mt++;var Di=navigator.mimeTypes?navigator.mimeTypes.length:0,Br=it((Di+navigator.userAgent.length).toString(36)+Mt.toString(36),4),ni=function(){return Br},Uo=0,al=4,Xt=36,he=Math.pow(Xt,al);function Qe(){return it((Math.random()*he<<0).toString(Xt),al)}function We(){return Uo=Uo<he?Uo:0,Uo++,Uo-1}function nt(){var V="c",N=new Date().getTime().toString(Xt),z=it(We().toString(Xt),al),$=ni(),oe=Qe()+Qe();return V+N+z+$+oe}nt.fingerprint=ni;var St=nt,vt=function(){function V(){this.id=St(),this.startedAt=new Date,this._handled=0,this._unhandled=0,this._user={},this.app={},this.device={}}var N=V.prototype;return N.getUser=function(){return this._user},N.setUser=function($,oe,ye){this._user={id:$,email:oe,name:ye}},N.toJSON=function(){return{id:this.id,startedAt:this.startedAt,events:{handled:this._handled,unhandled:this._unhandled}}},N._track=function($){this[$._handledState.unhandled?"_unhandled":"_handled"]+=1},V}(),Lt=vt,Rt=ge.add,or=ge.clear,zt=ge.merge,Sr=function(){},Dr=function(){function V(z,$,oe,ye){var Me=this;$===void 0&&($=f.schema),oe===void 0&&(oe=[]),this._notifier=ye,this._config={},this._schema=$,this._delivery={sendSession:Sr,sendEvent:Sr},this._logger={debug:Sr,info:Sr,warn:Sr,error:Sr},this._plugins={},this._breadcrumbs=[],this._session=null,this._metadata={},this._featuresIndex={},this._features=[],this._context=void 0,this._user={},this._cbs={e:[],s:[],sp:[],b:[]},this.Client=V,this.Event=ke,this.Breadcrumb=I,this.Session=Lt,this._config=this._configure(z,oe),E(oe.concat(this._config.plugins),function(Vt){Vt&&Me._loadPlugin(Vt)}),this._depth=1;var Je=this,qe=this.notify;this.notify=function(){return qe.apply(Je,arguments)}}var N=V.prototype;return N.addMetadata=function($,oe,ye){return De.add(this._metadata,$,oe,ye)},N.getMetadata=function($,oe){return De.get(this._metadata,$,oe)},N.clearMetadata=function($,oe){return De.clear(this._metadata,$,oe)},N.addFeatureFlag=function($,oe){oe===void 0&&(oe=null),Rt(this._features,this._featuresIndex,$,oe)},N.addFeatureFlags=function($){zt(this._features,$,this._featuresIndex)},N.clearFeatureFlag=function($){or(this._features,this._featuresIndex,$)},N.clearFeatureFlags=function(){this._features=[],this._featuresIndex={}},N.getContext=function(){return this._context},N.setContext=function($){this._context=$},N._configure=function($,oe){var ye=o(oe,function(Vt,Gt){return Gt&&Gt.configSchema?x({},Vt,Gt.configSchema):Vt},this._schema),Me=o(d(ye),function(Vt,Gt){var xr=ye[Gt].defaultValue($[Gt]);if($[Gt]!==void 0){var yt=ye[Gt].validate($[Gt]);yt?ye[Gt].allowPartialObject?Vt.config[Gt]=x(xr,$[Gt]):Vt.config[Gt]=$[Gt]:(Vt.errors[Gt]=ye[Gt].message,Vt.config[Gt]=xr)}else Vt.config[Gt]=xr;return Vt},{errors:{},config:{}}),Je=Me.errors,qe=Me.config;if(ye.apiKey){if(!qe.apiKey)throw new Error("No Bugsnag API Key set");/^[0-9a-f]{32}$/i.test(qe.apiKey)||(Je.apiKey="should be a string of 32 hexadecimal characters")}return this._metadata=x({},qe.metadata),zt(this._features,qe.featureFlags,this._featuresIndex),this._user=x({},qe.user),this._context=qe.context,qe.logger&&(this._logger=qe.logger),qe.onError&&(this._cbs.e=this._cbs.e.concat(qe.onError)),qe.onBreadcrumb&&(this._cbs.b=this._cbs.b.concat(qe.onBreadcrumb)),qe.onSession&&(this._cbs.s=this._cbs.s.concat(qe.onSession)),d(Je).length&&this._logger.warn(ki(Je,$)),qe},N.getUser=function(){return this._user},N.setUser=function($,oe,ye){this._user={id:$,email:oe,name:ye}},N._loadPlugin=function($){var oe=$.load(this);return $.name&&(this._plugins["~"+$.name+"~"]=oe),this},N.getPlugin=function($){return this._plugins["~"+$+"~"]},N._setDelivery=function($){this._delivery=$(this)},N.startSession=function(){var $=new Lt;$.app.releaseStage=this._config.releaseStage,$.app.version=this._config.appVersion,$.app.type=this._config.appType,$._user=x({},this._user);var oe=ct(this._cbs.s,$,"onSession",this._logger);return oe?(this._logger.debug("Session not started due to onSession callback"),this):this._sessionDelegate.startSession(this,$)},N.addOnError=function($,oe){oe===void 0&&(oe=!1),this._cbs.e[oe?"unshift":"push"]($)},N.removeOnError=function($){this._cbs.e=n(this._cbs.e,function(oe){return oe!==$})},N._addOnSessionPayload=function($){this._cbs.sp.push($)},N.addOnSession=function($){this._cbs.s.push($)},N.removeOnSession=function($){this._cbs.s=n(this._cbs.s,function(oe){return oe!==$})},N.addOnBreadcrumb=function($,oe){oe===void 0&&(oe=!1),this._cbs.b[oe?"unshift":"push"]($)},N.removeOnBreadcrumb=function($){this._cbs.b=n(this._cbs.b,function(oe){return oe!==$})},N.pauseSession=function(){return this._sessionDelegate.pauseSession(this)},N.resumeSession=function(){return this._sessionDelegate.resumeSession(this)},N.leaveBreadcrumb=function($,oe,ye){if($=typeof $=="string"?$:"",ye=typeof ye=="string"&&a(i,ye)?ye:"manual",oe=typeof oe=="object"&&oe!==null?oe:{},!!$){var Me=new I($,oe,ye),Je=ct(this._cbs.b,Me,"onBreadcrumb",this._logger);if(Je){this._logger.debug("Breadcrumb not attached due to onBreadcrumb callback");return}this._breadcrumbs.push(Me),this._breadcrumbs.length>this._config.maxBreadcrumbs&&(this._breadcrumbs=this._breadcrumbs.slice(this._breadcrumbs.length-this._config.maxBreadcrumbs))}},N._isBreadcrumbTypeEnabled=function($){var oe=this._config.enabledBreadcrumbTypes;return oe===null||a(oe,$)},N.notify=function($,oe,ye){ye===void 0&&(ye=Sr);var Me=ke.create($,!0,void 0,"notify()",this._depth+1,this._logger);this._notify(Me,oe,ye)},N._notify=function($,oe,ye){var Me=this;if(ye===void 0&&(ye=Sr),$.app=x({},$.app,{releaseStage:this._config.releaseStage,version:this._config.appVersion,type:this._config.appType}),$.context=$.context||this._context,$._metadata=x({},$._metadata,this._metadata),$._user=x({},$._user,this._user),$.breadcrumbs=this._breadcrumbs.slice(),zt($._features,this._features,$._featuresIndex),this._config.enabledReleaseStages!==null&&!a(this._config.enabledReleaseStages,this._config.releaseStage))return this._logger.warn("Event not sent due to releaseStage/enabledReleaseStages configuration"),ye(null,$);var Je=$.severity,qe=function(Gt){Me._logger.error("Error occurred in onError callback, continuing anyway\u2026"),Me._logger.error(Gt)},Vt=[].concat(this._cbs.e).concat(oe);xe(Vt,$,qe,function(Gt,xr){if(Gt&&qe(Gt),!xr)return Me._logger.debug("Event not sent due to onError callback"),ye(null,$);Me._isBreadcrumbTypeEnabled("error")&&V.prototype.leaveBreadcrumb.call(Me,$.errors[0].errorClass,{errorClass:$.errors[0].errorClass,errorMessage:$.errors[0].errorMessage,severity:$.severity},"error"),Je!==$.severity&&($._handledState.severityReason={type:"userCallbackSetSeverity"}),$.unhandled!==$._handledState.unhandled&&($._handledState.severityReason.unhandledOverridden=!0,$._handledState.unhandled=$.unhandled),Me._session&&(Me._session._track($),$._session=Me._session),Me._delivery.sendEvent({apiKey:$.apiKey||Me._config.apiKey,notifier:Me._notifier,events:[$]},function(yt){return ye(yt,$)})})},V}(),ki=function(V,N){var z=new Error(`Invalid configuration
`+E(d(V),function($){return"  - "+$+" "+V[$]+", got "+Hn(N[$])}).join(`

`));return z},Hn=function(V){switch(typeof V){case"string":case"number":case"object":return JSON.stringify(V);default:return String(V)}},Mn=Dr,qi={},io=["events.[].metaData","events.[].breadcrumbs.[].metaData","events.[].request"];qi.event=function(V,N){var z=Y(V,null,null,{redactedPaths:io,redactedKeys:N});return z.length>1e6&&(V.events[0]._metadata={notifier:`WARNING!
Serialized payload was `+z.length/1e6+`MB (limit = 1MB)
metadata was removed`},z=Y(V,null,null,{redactedPaths:io,redactedKeys:N})),z},qi.session=function(V,N){var z=Y(V,null,null);return z};var pn={};pn=function(V,N){return N===void 0&&(N=window),{sendEvent:function(z,$){$===void 0&&($=function(){});var oe=wo(V._config,"notify","4",N),ye=qi.event(z,V._config.redactedKeys),Me=new N.XDomainRequest;Me.onload=function(){$(null)},Me.onerror=function(){var Je=new Error("Event failed to send");V._logger.error("Event failed to send\u2026",Je),ye.length>1e6&&V._logger.warn("Event oversized ("+(ye.length/1e6).toFixed(2)+" MB)"),$(Je)},Me.open("POST",oe),setTimeout(function(){try{Me.send(ye)}catch(Je){V._logger.error(Je),$(Je)}},0)},sendSession:function(z,$){$===void 0&&($=function(){});var oe=wo(V._config,"sessions","1",N),ye=new N.XDomainRequest;ye.onload=function(){$(null)},ye.open("POST",oe),setTimeout(function(){try{ye.send(qi.session(z,V._config.redactedKeys))}catch(Me){V._logger.error(Me),$(Me)}},0)}}};var wo=function(V,N,z,$){var oe=JSON.parse(JSON.stringify(new Date)),ye=Ob(V.endpoints[N],$.location.protocol);return ye+"?apiKey="+encodeURIComponent(V.apiKey)+"&payloadVersion="+z+"&sentAt="+encodeURIComponent(oe)},Ob=pn._matchPageProtocol=function(V,N){return N==="http:"?V.replace(/^https:/,"http:"):V},Om=function(V,N){return N===void 0&&(N=window),{sendEvent:function(z,$){$===void 0&&($=function(){});try{var oe=V._config.endpoints.notify,ye=new N.XMLHttpRequest,Me=qi.event(z,V._config.redactedKeys);ye.onreadystatechange=function(){if(ye.readyState===N.XMLHttpRequest.DONE){var Je=ye.status;if(Je===0||Je>=400){var qe=new Error("Request failed with status "+Je);V._logger.error("Event failed to send\u2026",qe),Me.length>1e6&&V._logger.warn("Event oversized ("+(Me.length/1e6).toFixed(2)+" MB)"),$(qe)}else $(null)}},ye.open("POST",oe),ye.setRequestHeader("Content-Type","application/json"),ye.setRequestHeader("Bugsnag-Api-Key",z.apiKey||V._config.apiKey),ye.setRequestHeader("Bugsnag-Payload-Version","4"),ye.setRequestHeader("Bugsnag-Sent-At",new Date().toISOString()),ye.send(Me)}catch(Je){V._logger.error(Je)}},sendSession:function(z,$){$===void 0&&($=function(){});try{var oe=V._config.endpoints.sessions,ye=new N.XMLHttpRequest;ye.onreadystatechange=function(){if(ye.readyState===N.XMLHttpRequest.DONE){var Me=ye.status;if(Me===0||Me>=400){var Je=new Error("Request failed with status "+Me);V._logger.error("Session failed to send\u2026",Je),$(Je)}else $(null)}},ye.open("POST",oe),ye.setRequestHeader("Content-Type","application/json"),ye.setRequestHeader("Bugsnag-Api-Key",V._config.apiKey),ye.setRequestHeader("Bugsnag-Payload-Version","1"),ye.setRequestHeader("Bugsnag-Sent-At",new Date().toISOString()),ye.send(qi.session(z,V._config.redactedKeys))}catch(Me){V._logger.error(Me)}}}},Dv=new Date,Z0=function(){Dv=new Date},Rm={name:"appDuration",load:function(V){return V.addOnError(function(N){var z=new Date;N.app.duration=z-Dv},!0),{reset:Z0}}},eD=function(V){return V===void 0&&(V=window),{load:function(N){N.addOnError(function(z){z.context===void 0&&(z.context=V.location.pathname)},!0)}}},Rb=function(N,z){var $="000000000"+N;return $.substr($.length-z)},tD=typeof window=="object"?window:self,kv=0;for(var rD in tD)Object.hasOwnProperty.call(tD,rD)&&kv++;var iD=navigator.mimeTypes?navigator.mimeTypes.length:0,Fm=Rb((iD+navigator.userAgent.length).toString(36)+kv.toString(36),4),Ol=function(){return Fm},Fb=0,Yh=4,Xh=36,Rl=Math.pow(Xh,Yh);function Nb(){return Rb((Math.random()*Rl<<0).toString(Xh),Yh)}function oD(){return Fb=Fb<Rl?Fb:0,Fb++,Fb-1}function mp(){var V="c",N=new Date().getTime().toString(Xh),z=Rb(oD().toString(Xh),Yh),$=Ol(),oe=Nb()+Nb();return V+N+z+$+oe}mp.fingerprint=Ol;var nD=mp,aD="bugsnag-anonymous-id",sD=function(V){try{var N=V.localStorage,z=N.getItem(aD);return z&&/^c[a-z0-9]{20,32}$/.test(z)||(z=nD(),N.setItem(aD,z)),z}catch($){}},lD=function(V,N){return V===void 0&&(V=navigator),N===void 0&&(N=window),{load:function(z){var $={locale:V.browserLanguage||V.systemLanguage||V.userLanguage||V.language,userAgent:V.userAgent};N&&N.screen&&N.screen.orientation&&N.screen.orientation.type?$.orientation=N.screen.orientation.type:N&&N.document&&($.orientation=N.document.documentElement.clientWidth>N.document.documentElement.clientHeight?"landscape":"portrait"),z._config.generateAnonymousId&&($.id=sD(N)),z.addOnSession(function(oe){oe.device=x({},oe.device,$),z._config.collectUserIp||cD(oe)}),z.addOnError(function(oe){oe.device=x({},oe.device,$,{time:new Date}),z._config.collectUserIp||cD(oe)},!0)},configSchema:{generateAnonymousId:{validate:function(z){return z===!0||z===!1},defaultValue:function(){return!0},message:"should be true|false"}}}},cD=function(V){var N=V.getUser();(!N||!N.id)&&V.setUser(V.device.id)},dD=function(V){return V===void 0&&(V=window),{load:function(N){N.addOnError(function(z){z.request&&z.request.url||(z.request=x({},z.request,{url:V.location.href}))},!0)}}},Gv={load:function(V){V._sessionDelegate=pD}},pD={startSession:function(V,N){var z=V;return z._session=N,z._pausedSession=null,z._config.enabledReleaseStages!==null&&!a(z._config.enabledReleaseStages,z._config.releaseStage)?(z._logger.warn("Session not sent due to releaseStage/enabledReleaseStages configuration"),z):(z._delivery.sendSession({notifier:z._notifier,device:N.device,app:N.app,sessions:[{id:N.id,startedAt:N.startedAt,user:N._user}]}),z)},resumeSession:function(V){return V._session?V:V._pausedSession?(V._session=V._pausedSession,V._pausedSession=null,V):V.startSession()},pauseSession:function(V){V._pausedSession=V._session,V._session=null}},uD={load:function(V){V._config.collectUserIp||V.addOnError(function(N){N._user&&typeof N._user.id=="undefined"&&delete N._user.id,N._user=x({id:"[REDACTED]"},N._user),N.request=x({clientIp:"[REDACTED]"},N.request)})},configSchema:{collectUserIp:{defaultValue:function(){return!0},message:"should be true|false",validate:function(V){return V===!0||V===!1}}}},Fl={};Fl.load=function(V){var N=/^(local-)?dev(elopment)?$/.test(V._config.releaseStage);N||!V._isBreadcrumbTypeEnabled("log")||E(pP,function(z){var $=console[z];console[z]=function(){for(var oe=arguments.length,ye=new Array(oe),Me=0;Me<oe;Me++)ye[Me]=arguments[Me];V.leaveBreadcrumb("Console output",o(ye,function(Je,qe,Vt){var Gt="[Unknown value]";try{Gt=String(qe)}catch(xr){}if(Gt==="[object Object]")try{Gt=JSON.stringify(qe)}catch(xr){}return Je["["+Vt+"]"]=Gt,Je},{severity:z.indexOf("group")===0?"log":z}),"log"),$.apply(console,ye)},console[z]._restore=function(){console[z]=$}})};var pP=n(["log","debug","info","warn","error"],function(V){return typeof console!="undefined"&&typeof console[V]=="function"}),Jh=200,Lu=5e5,Tv=function(V,N){return V===void 0&&(V=document),N===void 0&&(N=window),{load:function(z){if(!z._config.trackInlineScripts)return;var $=N.location.href,oe="",ye=!!V.attachEvent,Me=ye?V.readyState==="complete":V.readyState!=="loading",Je=function(){return V.documentElement.outerHTML};oe=Je();var qe=V.onreadystatechange;V.onreadystatechange=function(){V.readyState==="interactive"&&(oe=Je(),Me=!0);try{qe.apply(this,arguments)}catch(tr){}};var Vt=null,Gt=function(tr){Vt=tr},xr=function(){var tr=V.currentScript||Vt;if(!tr&&!Me){var $r=V.scripts||V.getElementsByTagName("script");tr=$r[$r.length-1]}return tr},yt=function(tr){(!Me||!oe)&&(oe=Je());var $r=["<!-- DOC START -->"].concat(oe.split(`
`)),xa=tr-1,na=Math.max(xa-3,0),Td=Math.min(xa+3,$r.length);return o($r.slice(na,Td),function(wa,Mv,hP){return wa[na+1+hP]=Mv.length<=Jh?Mv:Mv.substr(0,Jh),wa},{})};z.addOnError(function(tr){tr.errors[0].stacktrace=n(tr.errors[0].stacktrace,function(wa){return!/__trace__$/.test(wa.method)});var $r=tr.errors[0].stacktrace[0],xa=function(wa){return wa.replace(/#.*$/,"").replace(/\?.*$/,"")};if(!($r&&$r.file&&xa($r.file)!==xa($))){var na=xr();if(na){var Td=na.innerHTML;tr.addMetadata("script","content",Td.length<=Lu?Td:Td.substr(0,Lu)),$r&&$r.lineNumber&&($r.code=yt($r.lineNumber))}}},!0);var cr=E(["setTimeout","setInterval","setImmediate","requestAnimationFrame"],function(tr){return Nm(N,tr,function($r){return ho($r,function(xa){return{get:function(){return xa[0]},replace:function(na){xa[0]=na}}})})}),Ko=cr[0];E(["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],function(tr){!N[tr]||!N[tr].prototype||!Object.prototype.hasOwnProperty.call(N[tr].prototype,"addEventListener")||(Nm(N[tr].prototype,"addEventListener",function($r){return ho($r,Bb)}),Nm(N[tr].prototype,"removeEventListener",function($r){return ho($r,Bb,!0)}))});function ho(tr,$r,xa){return xa===void 0&&(xa=!1),function(){var na=[].slice.call(arguments);try{var Td=$r(na),wa=Td.get();if(xa&&tr.apply(this,na),typeof wa!="function")return tr.apply(this,na);if(wa.__trace__)Td.replace(wa.__trace__);else{var Mv=xr();wa.__trace__=function(){Gt(Mv),Ko(function(){Gt(null)},0);var pZ=wa.apply(this,arguments);return Gt(null),pZ},wa.__trace__.__trace__=wa.__trace__,Td.replace(wa.__trace__)}}catch(hP){}if(tr.apply)return tr.apply(this,na);switch(na.length){case 1:return tr(na[0]);case 2:return tr(na[0],na[1]);default:return tr()}}}},configSchema:{trackInlineScripts:{validate:function(z){return z===!0||z===!1},defaultValue:function(){return!0},message:"should be true|false"}}}};function Nm(V,N,z){var $=V[N];if(!$)return $;var oe=z($);return V[N]=oe,$}function Bb(V){var N=!!V[1]&&typeof V[1].handleEvent=="function";return{get:function(){return N?V[1].handleEvent:V[1]},replace:function(z){N?V[1].handleEvent=z:V[1]=z}}}var hD=function(V){return V===void 0&&(V=window),{load:function(N){"addEventListener"in V&&N._isBreadcrumbTypeEnabled("user")&&V.addEventListener("click",function(z){var $,oe;try{$=mD(z.target),oe=G(z.target,V)}catch(ye){$="[hidden]",oe="[hidden]",N._logger.error("Cross domain error when tracking click event. See docs: https://tinyurl.com/yy3rn63z")}N.leaveBreadcrumb("UI click",{targetText:$,targetSelector:oe},"user")},!0)}}},uP=/^\s+/,gD=/(^|[^\s])\s+$/;function mD(V){var N=V.textContent||V.innerText||"";return!N&&(V.type==="submit"||V.type==="button")&&(N=V.value),N=N.replace(uP,"").replace(gD,"$1"),N.length>140?N.slice(0,135)+"(...)":N}function G(V,N){var z=[V.tagName];if(V.id&&z.push("#"+V.id),V.className&&V.className.length&&z.push("."+V.className.split(" ").join(".")),!N.document.querySelectorAll||!Array.prototype.indexOf)return z.join("");try{if(N.document.querySelectorAll(z.join("")).length===1)return z.join("")}catch(oe){return z.join("")}if(V.parentNode.childNodes.length>1){var $=Array.prototype.indexOf.call(V.parentNode.childNodes,V)+1;z.push(":nth-child("+$+")")}return N.document.querySelectorAll(z.join("")).length===1?z.join(""):V.parentNode?G(V.parentNode,N)+" > "+z.join(""):z.join("")}var b={};b=function(V){V===void 0&&(V=window);var N={load:function(z){if("addEventListener"in V&&z._isBreadcrumbTypeEnabled("navigation")){var $=function(oe){return function(){return z.leaveBreadcrumb(oe,{},"navigation")}};V.addEventListener("pagehide",$("Page hidden"),!0),V.addEventListener("pageshow",$("Page shown"),!0),V.addEventListener("load",$("Page loaded"),!0),V.document.addEventListener("DOMContentLoaded",$("DOMContentLoaded"),!0),V.addEventListener("load",function(){return V.addEventListener("popstate",$("Navigated back"),!0)}),V.addEventListener("hashchange",function(oe){var ye=oe.oldURL?{from:u(oe.oldURL,V),to:u(oe.newURL,V),state:L(V)}:{to:u(V.location.href,V)};z.leaveBreadcrumb("Hash changed",ye,"navigation")},!0),V.history.replaceState&&D(z,V.history,"replaceState",V),V.history.pushState&&D(z,V.history,"pushState",V)}}};return N};var u=function(V,N){var z=N.document.createElement("A");return z.href=V,""+z.pathname+z.search+z.hash},m=function(V,N,z,$){var oe=u(V.location.href,V);return{title:z,state:N,prevState:L(V),to:$||oe,from:oe}},D=function(V,N,z,$){var oe=N[z];N[z]=function(ye,Me,Je){V.leaveBreadcrumb("History "+z,m($,ye,Me,Je),"navigation"),typeof V.resetEventCount=="function"&&V.resetEventCount(),V._config.autoTrackSessions&&V.startSession(),oe.apply(N,[ye,Me].concat(Je!==void 0?Je:[]))}},L=function(V){try{return V.history.state}catch(N){}},K="request",re=function(V,N){V===void 0&&(V=[]),N===void 0&&(N=window);var z=[],$={load:function(oe){if(!oe._isBreadcrumbTypeEnabled("request"))return;var ye=[oe._config.endpoints.notify,oe._config.endpoints.sessions].concat(V);Me(),Vt();function Me(){if("addEventListener"in N.XMLHttpRequest.prototype){var yt=N.XMLHttpRequest.prototype.open;N.XMLHttpRequest.prototype.open=function(Ko,ho){var tr=this,$r=!1,xa=function(){return qe(Ko,ho)},na=function(){return Je(Ko,ho,tr.status)};$r&&(this.removeEventListener("load",na),this.removeEventListener("error",xa)),this.addEventListener("load",na),this.addEventListener("error",xa),$r=!0,yt.apply(this,arguments)}}}function Je(yt,cr,Ko){if(cr===void 0){oe._logger.warn("The request URL is no longer present on this XMLHttpRequest. A breadcrumb cannot be left for this request.");return}if(!(typeof cr=="string"&&a(ye,cr.replace(/\?.*$/,"")))){var ho={status:Ko,request:yt+" "+cr};Ko>=400?oe.leaveBreadcrumb("XMLHttpRequest failed",ho,K):oe.leaveBreadcrumb("XMLHttpRequest succeeded",ho,K)}}function qe(yt,cr){if(cr===void 0){oe._logger.warn("The request URL is no longer present on this XMLHttpRequest. A breadcrumb cannot be left for this request.");return}typeof cr=="string"&&a(ye,cr.replace(/\?.*$/,""))||oe.leaveBreadcrumb("XMLHttpRequest error",{request:yt+" "+cr},K)}function Vt(){if(!(!("fetch"in N)||N.fetch.polyfill)){var yt=N.fetch;N.fetch=function(){var Ko=arguments,ho=arguments[0],tr=arguments[1],$r,xa=null;return ho&&typeof ho=="object"?(xa=ho.url,tr&&"method"in tr?$r=tr.method:ho&&"method"in ho&&($r=ho.method)):(xa=ho,tr&&"method"in tr&&($r=tr.method)),$r===void 0&&($r="GET"),new Promise(function(na,Td){yt.apply(void 0,Ko).then(function(wa){Gt(wa,$r,xa),na(wa)}).catch(function(wa){xr($r,xa),Td(wa)})})}}}var Gt=function(yt,cr,Ko){var ho={status:yt.status,request:cr+" "+Ko};yt.status>=400?oe.leaveBreadcrumb("fetch() failed",ho,K):oe.leaveBreadcrumb("fetch() succeeded",ho,K)},xr=function(yt,cr){oe.leaveBreadcrumb("fetch() error",{request:yt+" "+cr},K)}}};return $},se={load:function(V){var N=0;V.addOnError(function(z){if(N>=V._config.maxEvents)return V._logger.warn("Cancelling event send due to maxEvents per session limit of "+V._config.maxEvents+" being reached"),!1;N++}),V.resetEventCount=function(){N=0}},configSchema:{maxEvents:{defaultValue:function(){return 10},message:"should be a positive integer \u2264100",validate:function(V){return p(1,100)(V)}}}},we={};we={load:function(V){V.addOnError(function(N){var z=o(N.errors,function($,oe){return $.concat(oe.stacktrace)},[]);E(z,function($){$.file=Ye($.file)})})}};var Ye=we._strip=function(V){return typeof V=="string"?V.replace(/\?.*$/,"").replace(/#.*$/,""):V},Ke=function(V,N){return V===void 0&&(V=window),N===void 0&&(N="window onerror"),{load:function(z){if(!z._config.autoDetectErrors||!z._config.enabledErrorTypes.unhandledExceptions)return;function $(ye,Me,Je,qe,Vt){if(Je===0&&/Script error\.?/.test(ye))z._logger.warn("Ignoring cross-domain or eval script error. See docs: https://tinyurl.com/yy3rn63z");else{var Gt={severity:"error",unhandled:!0,severityReason:{type:"unhandledException"}},xr;if(Vt)xr=z.Event.create(Vt,!0,Gt,N,1),Fe(xr.errors[0].stacktrace,Me,Je,qe);else if(typeof ye=="object"&&ye!==null&&(!Me||typeof Me!="string")&&!Je&&!qe&&!Vt){var yt=ye.type?"Event: "+ye.type:"Error",cr=ye.message||ye.detail||"";xr=z.Event.create({name:yt,message:cr},!0,Gt,N,1),xr.originalError=ye,xr.addMetadata(N,{event:ye,extraParameters:Me})}else xr=z.Event.create(ye,!0,Gt,N,1),Fe(xr.errors[0].stacktrace,Me,Je,qe);z._notify(xr)}typeof oe=="function"&&oe.apply(this,arguments)}var oe=V.onerror;V.onerror=$}}},Fe=function(V,N,z,$){V[0]||V.push({});var oe=V[0];!oe.file&&typeof N=="string"&&(oe.file=N),!oe.lineNumber&&at(z)&&(oe.lineNumber=z),oe.columnNumber||(at($)?oe.columnNumber=$:window.event&&at(window.event.errorCharacter)&&(oe.columnNumber=window.event.errorCharacter))},at=function(V){return typeof V=="number"&&String.call(V)!=="NaN"},dt,Ct=function(V){V===void 0&&(V=window);var N={load:function(z){if(!(!z._config.autoDetectErrors||!z._config.enabledErrorTypes.unhandledRejections)){var $=function(oe){var ye=oe.reason,Me=!1;try{oe.detail&&oe.detail.reason&&(ye=oe.detail.reason,Me=!0)}catch(qe){}var Je=z.Event.create(ye,!1,{severity:"error",unhandled:!0,severityReason:{type:"unhandledPromiseRejection"}},"unhandledrejection handler",1,z._logger);Me&&E(Je.errors[0].stacktrace,It(ye)),z._notify(Je,function(qe){if(Se(qe.originalError)&&!qe.originalError.stack){var Vt;qe.addMetadata("unhandledRejection handler",(Vt={},Vt[Object.prototype.toString.call(qe.originalError)]={name:qe.originalError.name,message:qe.originalError.message,code:qe.originalError.code},Vt))}})};"addEventListener"in V?V.addEventListener("unhandledrejection",$):V.onunhandledrejection=function(oe,ye){$({detail:{reason:oe,promise:ye}})},dt=$}}};return N},It=function(V){return function(N){N.file!==V.toString()&&N.method&&(N.method=N.method.replace(/^\s+/,""))}},_t={},ai="Bugsnag JavaScript",zo="7.22.4",ci="https://github.com/bugsnag/bugsnag-js",Zo=x({},f.schema,v),uo={_client:null,createClient:function(V){typeof V=="string"&&(V={apiKey:V}),V||(V={});var N=[Rm,lD(),eD(),dD(),se,Gv,uD,we,Ke(),Ct(),b(),hD(),re(),Fl,Tv()],z=new Mn(V,Zo,N,{name:ai,version:zo,url:ci});return z._setDelivery(window.XDomainRequest?pn:Om),z._logger.debug("Loaded!"),z.leaveBreadcrumb("Bugsnag loaded",{},"state"),z._config.autoTrackSessions?z.startSession():z},start:function(V){return uo._client?(uo._client._logger.warn("Bugsnag.start() was called more than once. Ignoring."),uo._client):(uo._client=uo.createClient(V),uo._client)},isStarted:function(){return uo._client!=null}};return E(["resetEventCount"].concat(d(Mn.prototype)),function(V){/^_/.test(V)||(uo[V]=function(){if(!uo._client)return console.log("Bugsnag."+V+"() was called before Bugsnag.start()");uo._client._depth+=1;var N=uo._client[V].apply(uo._client,arguments);return uo._client._depth-=1,N})}),_t=uo,_t.Client=Mn,_t.Event=ke,_t.Session=Lt,_t.Breadcrumb=I,_t.default=uo,_t})});var V5;function uZ(r){V5=r(__dcg_shared_module_exports__['a'])}uZ(function(r){function e(){window.consoleOverride=!0;var i=window.console.log;window.console.log=function(){for(var o=[],n=0;n<arguments.length;n++)o.push(arguments[n]);i.apply(window.console,[].concat([o.join(" ")],o))}}var t={ready:function(){try{window.TestBridge=t,parent.USING_SELENIUM&&e()}catch(i){}}};return t});var{ready:L5}=V5;qt();var Ur={};__dcg_shared_module_exports__['d'](Ur,{ALT:()=>zZ,BACKSPACE:()=>Nc,CAPSLOCK:()=>KZ,CONTROL:()=>UZ,DELETE:()=>cy,DOWN:()=>hn,END:()=>Dp,ENTER:()=>dl,ESCAPE:()=>rn,HOME:()=>cg,LEFT:()=>kp,PAGEDOWN:()=>ly,PAGEUP:()=>sy,RIGHT:()=>Gp,SHIFT:()=>Kv,SPACEBAR:()=>lg,TAB:()=>cl,UP:()=>un,default:()=>FZ,isBacktick:()=>BZ,isHelp:()=>RP,isRedo:()=>rf,isSelectAll:()=>NZ,isSwitchPanes:()=>FP,isUndo:()=>tf,lookup:()=>Be,lookupChar:()=>ji});Rc();var jfe=navigator.userAgent.match(/MSIE 8.0/i)!==null,Yfe=navigator.userAgent.match(/MSIE 9.0/i)!==null,rU=navigator.userAgent.match(/MSIE/i)!==null||navigator.userAgent.match(/Trident/i)!==null&&navigator.userAgent.match(/rv:11/i)!==null,Xfe=navigator.userAgent.match(/Edge/i)!==null,ll=navigator.userAgent.match(/iPad/i)!==null,Sp=navigator.userAgent.match(/Mobile|Android/i)!==null,Ju=navigator.userAgent.match(/Android/i)!==null,Fc=navigator.userAgent.match(/(iPad|iPhone|iPod)/i)!==null||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,iU=navigator.userAgent.match(/Chrome/i)!==null,ny=navigator.userAgent.match(/Firefox/i)!==null,oU=navigator.userAgent.match(/^((?!chrome|android).)*safari/i)!==null,Ti=navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i)!==null,nU=navigator.platform.match(/(Win32)/i)!==null,aU=navigator.userAgent.match(/Touch/i)!==null,Jfe=navigator.userAgent.match(/Kindle/i)!==null||navigator.userAgent.match(/Silk/i)!==null,Qfe=navigator.userAgent.match(/KeyWeb/i)!==null,Qu=window.parent!==window;var OP=Fc||Ju||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i),Id=OP,Xu=(()=>{let r=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return r?[parseInt(r[1],10),parseInt(r[2],10),parseInt(r[3]||"0",10)]:null})(),Zfe=(()=>{let r=navigator.appVersion.match(/OS X (\d+)_(\d+)_?(\d+)?/);return r?[parseInt(r[1],10),parseInt(r[2],10),parseInt(r[3]||"0",10)]:null})(),ebe=(()=>{let r=navigator.appVersion.match(/Chrom(e|ium)\/([0-9]+)\.([0-9]+)\.?([0-9]+)?/);return r?[parseInt(r[2],10),parseInt(r[3],10),parseInt(r[4]||"0",10)]:null})(),jD=!(!("inputMode"in document.createElement("textarea"))||Fc&&Xu&&Xu[0]<15),tbe=(()=>{let r=document.createElement("canvas");return!!(r.getContext&&r.getContext("2d"))})(),ay=window.matchMedia("(prefers-reduced-motion: reduce)").matches||document.location.search.indexOf("prefersReducedMotion")>=0,sU=()=>document.createElement("video"),rbe=(()=>{let r=sU();return r.canPlayType&&!!r.canPlayType('video/webm; codecs="vp8, vorbis"')})(),ibe=(async()=>{let r=tn().autoplay;if(r===!0||r==="true")return!0;if(r==="false")return!1;let e=sU();e.src="data:video/mp4;base64,AAAAIGZ0eXBpc29tAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAAAu1tZGF0AAACrQYF//+p3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE1NSByMjkwMSA3ZDBmZjIyIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxOCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTMgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MzoweDExMyBtZT1oZXggc3VibWU9NyBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0xIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MSA4eDhkY3Q9MSBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0tMiB0aHJlYWRzPTMgbG9va2FoZWFkX3RocmVhZHM9MSBzbGljZWRfdGhyZWFkcz0wIG5yPTAgZGVjaW1hdGU9MSBpbnRlcmxhY2VkPTAgYmx1cmF5X2NvbXBhdD0wIGNvbnN0cmFpbmVkX2ludHJhPTAgYmZyYW1lcz0zIGJfcHlyYW1pZD0yIGJfYWRhcHQ9MSBiX2JpYXM9MCBkaXJlY3Q9MSB3ZWlnaHRiPTEgb3Blbl9nb3A9MCB3ZWlnaHRwPTIga2V5aW50PTI1MCBrZXlpbnRfbWluPTEgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD00MCByYz1jcmYgbWJ0cmVlPTEgY3JmPTI4LjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IGlwX3JhdGlvPTEuNDAgYXE9MToxLjAwAIAAAAAwZYiEAD//8m+P5OXfBeLGOfKE3xkODvFZuBflHv/+VwJIta6cbpIo4ABLoKBaYTkTAAAC7m1vb3YAAABsbXZoZAAAAAAAAAAAAAAAAAAAA+gAAAPoAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIYdHJhawAAAFx0a2hkAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAPoAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAACgAAAAWgAAAAAAJGVkdHMAAAAcZWxzdAAAAAAAAAABAAAD6AAAAAAAAQAAAAABkG1kaWEAAAAgbWRoZAAAAAAAAAAAAAAAAAAAQAAAAEAAVcQAAAAAAC1oZGxyAAAAAAAAAAB2aWRlAAAAAAAAAAAAAAAAVmlkZW9IYW5kbGVyAAAAATttaW5mAAAAFHZtaGQAAAABAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAAD7c3RibAAAAJdzdHNkAAAAAAAAAAEAAACHYXZjMQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAACgAFoASAAAAEgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABj//wAAADFhdmNDAWQACv/hABhnZAAKrNlCjfkhAAADAAEAAAMAAg8SJZYBAAZo6+JLIsAAAAAYc3R0cwAAAAAAAAABAAAAAQAAQAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAEAAAABAAAAFHN0c3oAAAAAAAAC5QAAAAEAAAAUc3RjbwAAAAAAAAABAAAAMAAAAGJ1ZHRhAAAAWm1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAALWlsc3QAAAAlqXRvbwAAAB1kYXRhAAAAAQAAAABMYXZmNTguMTIuMTAw",e.muted=!0,e.playsInline=!0,e.style.display="none";let t=await new Promise(i=>{document.readyState!=="loading"?i(document.body):document.addEventListener("DOMContentLoaded",()=>i(document.body))});t.appendChild(e);try{await e.play()}catch(i){return!1}finally{t.removeChild(e)}return!0})(),tU,YD=(tU=window.matchMedia("(forced-colors: active)"))==null?void 0:tU.matches;var lU=function(){{var r=function(){for(var e={8:this.BACKSPACE="Backspace",9:this.TAB="Tab",13:this.ENTER="Enter",16:this.SHIFT="Shift",17:this.CONTROL="Control",18:this.ALT="Alt",20:this.CAPSLOCK="CapsLock",27:this.ESCAPE="Esc",32:this.SPACEBAR="Space",33:this.PAGEUP="PageUp",34:this.PAGEDOWN="PageDown",35:this.END="End",36:this.HOME="Home",37:this.LEFT="Left",38:this.UP="Up",39:this.RIGHT="Right",40:this.DOWN="Down",46:this.DELETE="Del"},t={Backspace:this.BACKSPACE,Tab:this.TAB,Enter:this.ENTER,Shift:this.SHIFT,Control:this.CONTROL,Alt:this.ALT,CapsLock:this.CAPSLOCK,Escape:this.ESCAPE," ":this.SPACEBAR,PageUp:this.PAGEUP,PageDown:this.PAGEDOWN,End:this.END,Home:this.HOME,ArrowLeft:this.LEFT,ArrowUp:this.UP,ArrowRight:this.RIGHT,ArrowDown:this.DOWN,Delete:this.DELETE},i={UIKeyInputUpArrow:this.UP,UIKeyInputDownArrow:this.DOWN,UIKeyInputLeftArrow:this.LEFT,UIKeyInputRightArrow:this.RIGHT,UIKeyInputEscape:this.ESCAPE,UIKeyInputPageUp:this.PAGEUP,UIKeyInputPageDown:this.PAGEDOWN},o=["0123456789abcdefghijklmnopqrstuvwxyz","\xBA\xA1\u2122\xA3\xA2\u221E\xA7\xB6\u2022\xAA\xE5\u222B\xE7\u2202 \u0192\xA9\u02D9 \u2206\u02DA\xAC\xB5 \xF8\u03C0\u0153\xAE\xDF\u2020 \u221A\u2211\u2248\xA5\u03A9","\u201A\u2044\u20AC\u2039\u203A\uFB01\uFB02\u2021\xB0\xB7\xC5\u0131\xC7\xCE\xB4\xCF\u02DD\xD3\u02C6\xD4\uF8FF\xD2\xC2\u02DC\xD8\u220F\u0152\u2030\xCD\u02C7\xA8\u25CA\u201E\u02DB\xC1\xB8"].map(function(g){return g.split("")}),n=o[0],a=o[1],s=o[2],l={},c={},d=0;d<n.length;d++){var p=n[d];a[d]!==" "&&(l[a[d]]=p.toUpperCase()),s[d]!==" "&&(c[s[d]]=p.toUpperCase())}this.isUndo=function(g){return!g.altKey&&!g.shiftKey&&(g.ctrlKey||g.metaKey)&&(g.key=="z"||g.which==90)},this.isRedo=function(g){return!g.altKey&&(g.ctrlKey||g.metaKey)&&(g.key==="y"||g.which==89||g.shiftKey&&(g.key==="Z"||g.key==="z"||g.which===90))},this.isSelectAll=function(g){return!g.altKey&&(g.ctrlKey||g.metaKey)&&(g.key==="a"||g.key==="A"||g.which==65)},this.isBacktick=function(g){return!g.altKey&&!g.ctrlKey&&!g.metaKey&&!g.shiftKey&&(g.key==="`"||g.which==192)},this.isHelp=function(g){return!g.altKey&&(g.ctrlKey||g.metaKey)&&(g.key==="/"||g.which==191)},this.isSwitchPanes=function(g){return g.key==="F6"||g.key==="f6"||g.which===117||g.keyCode===117},this.lookup=function(g){return t[g.key]||e[g.which]||i[g.key]},this.lookupChar=function(g){if(!g.key)return String.fromCharCode(g.which);if(Ti&&g.altKey){var h=g.shiftKey?c:l;if(h[g.key])return h[g.key]}if(g.key.length===1)return g.key.toUpperCase();if(g.key==="Enter")return"\r";if(g.key==="Tab")return"	"}};return new r}}(),FZ=lU,{isUndo:tf,isRedo:rf,isSelectAll:NZ,isBacktick:BZ,isHelp:RP,isSwitchPanes:FP,BACKSPACE:Nc,TAB:cl,ENTER:dl,SHIFT:Kv,CONTROL:UZ,ALT:zZ,CAPSLOCK:KZ,ESCAPE:rn,SPACEBAR:lg,PAGEUP:sy,PAGEDOWN:ly,END:Dp,HOME:cg,LEFT:kp,UP:un,RIGHT:Gp,DOWN:hn,DELETE:cy,lookup:Be,lookupChar:ji}=lU;var go=function(r){if(!r)return;let e=r.getBoundingClientRect();return{top:e.top+window.scrollY,left:e.left+window.scrollX}},aa=function(r,e){Object.assign(r.style,e)};function Zu(r){return!!(r&&(r.offsetWidth||r.offsetHeight||r.getClientRects().length))}function XD(r){if(document.readyState!=="loading")r();else{var e=function(){document.removeEventListener("DOMContentLoaded",e),r()};document.addEventListener("DOMContentLoaded",e)}}var qZ=document.location.href.indexOf("dcgDebugTouchTracking=dcgYES")!==-1,dg,dy;window._touchtracking_id_counter==null&&(window._touchtracking_id_counter=0);window._touchtracking_id_counter+=1;var Hv="touchtracking_id_"+window._touchtracking_id_counter,gn=function(r){dy&&(dy.value="("+Date.now()+") "+r+`
`+dy.value)};function rh(r){if(r.classList.add("dcg-tap-container",Hv),qZ){dg&&dg.remove(),dg=document.createElement("div"),aa(dg,{position:"absolute",bottom:"10px",right:"10px"});let e=document.createElement("textarea");e.setAttribute("rows","30"),e.setAttribute("cols","40"),dg.append(e);let t=document.createElement("div");t.id="dcg-touchtracking-debug-copy",t.classList.add("dcg-btn-blue"),t.innerText="COPY LOGS",dg.append(t),dy=dg.querySelector("textarea"),r.append(dg),t.addEventListener("mousedown",function(){dy&&(dy.select(),document.execCommand("copy"))},!0),gn("monitor touches")}}var hy=0,Bc=1,Wv=2,py=3,th=4,jr=hy,NP={},Ad={},eh=[],BP=0,qv=null,QD=null,of=!1,JD=null,cU=of,pg=function(r){if(r.type.startsWith("key")){let t=r;!t.ctrlKey&&!t.altKey&&!t.metaKey&&(of=!0)}else r.type.startsWith("pointer")&&(of=!1);let e=document.activeElement;e&&!e.closest(".dcg-tap-container."+Hv)&&(e=null),e!==JD?(JD&&JD.classList.remove("dcg-focus-visible"),e&&of&&e.classList.add("dcg-focus-visible")):cU!==of&&e&&(of?e.classList.add("dcg-focus-visible"):e.classList.remove("dcg-focus-visible")),cU=of,JD=e};document.addEventListener("keydown",pg,{capture:!0});document.addEventListener("keydown",pg);document.addEventListener("pointerdown",pg);document.addEventListener("pointerdown",pg,{capture:!0});document.addEventListener("focusin",pg,{capture:!0});document.addEventListener("focusin",pg);document.addEventListener("focusout",pg,{capture:!0});document.addEventListener("focusout",pg);var dU,Ul=[],UP=function(r){if(!(r instanceof Element))return[];let e=r.closest(".dcg-tap-container."+Hv);if(!e)return[];let t=r,i=[];for(;t;){if(i.push(t),t===e)return i;t=t.parentNode}return[]},ZD=function(r,e){QD=null,jr=r,gn("beginMode:"+jr),jr===Bc?eh=UP(e.originalEvent.touches[0].target):eh=UP(e.target),eh.forEach(t=>{t.classList.add("dcg-depressed"),gU(t)&&t.classList.add("dcg-focus-by-tap")}),eh.forEach(function(t){let i=ie(t);i.data({originalScrollTop:i.scrollTop(),originalScrollLeft:i.scrollLeft()})}),Ad={}};function ug(r){return r.matches('input, textarea, select, [role="textbox"]')||r.classList.contains("dcg-mathquill-input-span")||r.matches("[contenteditable=true]")}var gy=function(r){if(!(r instanceof Element))return!1;let e=r.closest(".dcg-tap-container");return e?e.matches(".dcg-tap-container."+Hv):!1},gU=function(r){return jr!==py&&!ug(r)&&gy(r)},my=function(r,e){QD=null;let t=!1;gn("endMode:"+jr),document.querySelectorAll(".dcg-depressed").forEach(o=>{o.classList.remove("dcg-depressed")});let i=document.activeElement;if(!yU(r.target)&&i&&gU(i))try{i.blur()}catch(o){}if(document.querySelectorAll(".dcg-focus-by-tap").forEach(o=>o.classList.remove("dcg-focus-by-tap")),eh.forEach(function(o){let n=ie(o),a=n.data("originalScrollTop")-n.scrollTop(),s=n.data("originalScrollLeft")-n.scrollLeft();(a||s)&&(Ad.scroll=!0)}),Ad["dcg-tapstart"]===1&&Ad["dcg-tapend"]===1&&!Ad["dcg-tapcancel"]&&!Ad.scroll){gn("potential dcg-tap");let o=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY;if(r&&!r.device&&o===0&&n===0){gn("event appears to be simulated"),t=!0,jr=py;let l=r.target.getBoundingClientRect();o=(l.left+l.right)/2,n=(l.top+l.bottom)/2}gn("potential dcg-tap coords:"+o+":"+n);let a=!1,s=!1;for(let l of eh){if(a)break;let c;if(typeof l.getBoundingClientRect=="function"&&(c=l.getBoundingClientRect()),typeof l.getAttribute=="function"&&l.getAttribute("tapboundary")==="true"&&(a=!0),!(c&&(o<c.left||n<c.top||o>c.right||n>c.bottom))){QD=l,s=!0,pl("dcg-tap",r,{target:QD,touches:e.touches,changedTouches:e.changedTouches});break}}gn("result of dcg-tap:  did_dispatch="+s+"  did_escape="+a)}jr===Bc||jr===th?qv=setTimeout(function(){qv=null,BP=new Date().getTime()},1e3):t&&(qv=setTimeout(function(){qv=null,BP=new Date().getTime()},100)),eh=[],jr=hy},uy=function(){return qv||new Date().getTime()-BP<500},mU=function(r){return r.identifier!==void 0?r.identifier:r.pointerId},pU=function(r){let e=[];for(let t of r)e.push({identifier:mU(t),x:t.pageX,y:t.pageY,screenX:t.screenX,screenY:t.screenY,pageX:t.pageX,pageY:t.pageY,clientX:t.clientX,clientY:t.clientY});return e},pl=function(r,e,t){let i=mU(e),o=pU(t.touches),n=pU(t.changedTouches);if(gn("dispatchEvent:"+r),r==="dcg-tapstart")NP[i]={type:r,pageX:n[0].pageX,pageY:n[0].pageY};else if(r==="dcg-tapmove"){let c=n[0],d=NP[i];if(d&&c.pageX===d.pageX&&c.pageY===d.pageY||(jr===Bc||jr===th)&&d&&d.type==="dcg-tapstart"&&Math.abs(d.pageX-c.pageX)+Math.abs(d.pageY-c.pageY)<2)return;NP[i]={type:r,pageX:n[0].pageX,pageY:n[0].pageY}}let a=r.toLowerCase();Ad[a]===void 0?Ad[a]=1:Ad[a]+=1;let s=ie.event.fix(e.originalEvent);s.type=r,s.device=jr===Bc||jr===th?"touch":jr===py?"keyboard":"mouse",s.touches=o,s.changedTouches=n,s.target=t.target?t.target:e.target;let l=s.device!=="keyboard"&&Ad["dcg-longhold"]>0;s.wasLongheld=function(){return l},s.preventTap=function(){Ad["dcg-tapcancel"]=1},clearTimeout(dU),s.type==="dcg-tapstart"&&s.device!=="keyboard"&&s.touches.length===1&&(dU=setTimeout(function(){pl("dcg-longhold",e,t)},500)),s.target&&s.target.nodeName&&s.target.nodeName.toLowerCase()==="a"&&s.type==="dcg-tap"&&s.device==="keyboard"&&s.target.click&&s.target.click(),gn("trigger event:"+s.type),ie(s.target).trigger(s)},ek=function(r){let e=eh,t=!!eh.length,i=document.querySelectorAll(".dcg-tap-container."+Hv+" .dcg-hovered"),o=Array.from(i).filter(gy),n=[],a=[],s=[];r&&UP(r).forEach(function(l){(!t||e.indexOf(l)!==-1)&&(o.indexOf(l)===-1&&s.push(l),n.push(l))});for(let l of o)n.indexOf(l)===-1&&a.push(l);a.forEach(l=>{l&&l.classList.remove("dcg-hovered"),ie(l).trigger("tipsyhide")}),s.forEach(l=>{l&&l.classList.add("dcg-hovered"),ie(l).trigger("tipsyshow")})},tk=function(r){for(let e of Ul)if(e.pointerId===r)return!0;return!1},zP=function(r){for(let e=0;e<Ul.length;e++)if(Ul[e].pointerId===r){Ul.splice(e,1)[0];return}},fU=function(r){jr===hy&&ZD(th,r),ek(null),Ul.push(r.originalEvent),pl("dcg-tapstart",r,{touches:Ul,changedTouches:[r.originalEvent]})},uU=function(r){zP(r.originalEvent.pointerId);let e={touches:Ul,changedTouches:[r.originalEvent]};pl("dcg-tapcancel",r,e),Ul.length===0&&my(r,e)},hU=function(r){zP(r.originalEvent.pointerId);let e={touches:Ul,changedTouches:[r.originalEvent]};pl("dcg-tapend",r,e),Ul.length===0&&my(r,e)},rk=function(r){return r.originalEvent.pointerType==="touch"},fy=function(r,e){r.trim().split(/\s+/).forEach(function(t){let i=HZ?{passive:!1}:void 0;document.addEventListener(t,function(o){gn("document.on:"+o.type),e(ie.event.fix(o))},i)})};fy("pointerdown MSPointerDown",function(r){if(!(jr===Wv||jr===Bc||!rk(r))){if(tk(r.originalEvent.pointerId)){gn("exit. pointer id already exists: "+r.originalEvent.pointerId);return}fU(r)}});fy("pointermove MSPointerMove",function(r){jr===Wv||jr===Bc||!rk(r)||(tk(r.originalEvent.pointerId)||(gn("pointer id already exists: "+r.originalEvent.pointerId),fU(r)),zP(r.originalEvent.pointerId),Ul.push(r.originalEvent),pl("dcg-tapmove",r,{touches:Ul,changedTouches:[r.originalEvent]}))});ie(document).on("pointercancel MSPointerCancel",function(r){if(gn("document.on:"+r.type),jr!==th||!rk(r)||!tk(r.originalEvent.pointerId))return;uU(r);let e;for(;e=Ul.pop();){let t=ie.Event(e,{originalEvent:e});uU(t)}});ie(document).on("pointerup MSPointerUp",function(r){if(gn("document.on:"+r.type),jr!==th||!rk(r)||!tk(r.originalEvent.pointerId))return;hU(r);let e;for(;e=Ul.pop();){let t=ie.Event(e,{originalEvent:e});hU(t)}});var HZ=function(){let r=!1;try{let e=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("test",function(){},e),window.removeEventListener("test",function(){},e)}catch(e){}return r}();fy("touchstart",function(r){jr===Wv||jr===th||(jr===hy&&ZD(Bc,r),ek(null),pl("dcg-tapstart",r,{touches:r.originalEvent.touches,changedTouches:r.originalEvent.changedTouches}))});fy("touchmove",function(r){jr===Bc&&pl("dcg-tapmove",r,{touches:r.originalEvent.touches,changedTouches:r.originalEvent.changedTouches})});fy("touchcancel",function(r){if(jr!==Bc)return;let e={touches:r.originalEvent.touches,changedTouches:r.originalEvent.changedTouches};pl("dcg-tapcancel",r,e),r.originalEvent.touches.length===0&&my(r,e)});fy("touchend",function(r){if(jr!==Bc)return;let e={touches:r.originalEvent.touches,changedTouches:r.originalEvent.changedTouches};pl("dcg-tapend",r,e),r.originalEvent.touches.length===0&&my(r,e)});function bU(){return!!(jr===Bc||jr===th||uy())}ie(document).on("mousedown",function(r){if(gn("document.on:"+r.type),!(r.button===1||r.button===2)){if(bU()){!r.target.matches("input, textarea, select")&&gy(r.target)&&r.preventDefault(),gn("abort mousedown: "+jr+":"+uy());return}ZD(Wv,r),pl("dcg-tapstart",r,{touches:[r],changedTouches:[r]})}});var yU=function(r){if(!(r instanceof Element))return!1;let e=!!r.closest(".dcg-do-not-blur"),t=!!r.closest(".dcg-do-blur");return!!(e&&!t&&gy(r))};ie(document).on("mousedown",function(r){if(gn("document.on:"+r.type),!!yU(r.target)){r.preventDefault();try{let e=window.getSelection();if(e.rangeCount===1){let t=e.getRangeAt(0);t.startContainer===t.endContainer&&t.startContainer.closest(".dcg-text-selectable")&&e.removeAllRanges()}}catch(e){}}});ie(document).on("mouseleave",function(r){if(gn("document.on:"+r.type),jr===hy){if(uy()){gn("abort mouseleave: "+jr+":"+uy());return}ek(null)}});ie(document).on("mousemove",function(r){if(gn("document.on:"+r.type),!(r.button===1||r.button===2)&&!(jr===Bc||jr===th)){if(uy()){gn("abort mousemove: "+jr+":"+uy());return}ek(r.target),pl("dcg-tapmove",r,{touches:[r],changedTouches:[r]})}});ie(document).on("mouseup",function(r){if(gn("document.on:"+r.type),r.button===1||r.button===2||jr!==Wv)return;let e={touches:[],changedTouches:[r]};pl("dcg-tapend",r,e),my(r,e)});ie(document).on("keydown",function(r){if(gn("document.on:"+r.type),!(Be(r)!==dl&&Be(r)!==lg||!gy(r.target))&&jr!==py){if(r.target.matches('a:not([ontap]), button:not([ontap]), input, textarea, select, [role="textbox"], [contenteditable="true"], summary'))return;r.preventDefault(),ZD(py,r),pl("dcg-tapstart",r,{touches:[r],changedTouches:[r]})}});ie(document).on("keyup",function(r){if(gn("document.on:"+r.type),Be(r)!==dl&&Be(r)!==lg||!gy(r.target)||jr!==py)return;let e={touches:[],changedTouches:[r]};pl("dcg-tapend",r,e),my(r,e)});function KP(){return jr!==hy}var xU={monitor:rh,isTapActive:KP,elIsFocusable:ug,shouldIgnoreMouseDown:bU};var wU=`[
  {
    "hash": "2rnqgoa6a4",
    "parent_hash": "89ndqgh5id",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/2rnqgoa6a4.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/2rnqgoa6a4",
    "title": "Lines: Slope Intercept Form",
    "access": "all",
    "created": "Tue, 18 Aug 2015 19:24:05 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-lines-slope-intercept-form",
    "example": true
  },
  {
    "hash": "onfy0dzx2o",
    "parent_hash": "kha6fgxhaf",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/onfy0dzx2o.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/onfy0dzx2o",
    "title": "Lines: Point Slope Form",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:21:16 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-lines-point-slope-form",
    "example": true
  },
  {
    "hash": "md6buy4efz",
    "parent_hash": "fi71u8ej0q",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/md6buy4efz.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/md6buy4efz",
    "title": "Lines: Two Point Form",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:21:39 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-lines-two-point-form",
    "example": true
  },
  {
    "hash": "zukjgk9iry",
    "parent_hash": "jv9fmw2qz8",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/zukjgk9iry.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/zukjgk9iry",
    "title": "Parabolas: Standard Form",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:22:02 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-parabolas-standard-form",
    "example": true
  },
  {
    "hash": "8keeh1pt5l",
    "parent_hash": "klodq5d0ph",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/8keeh1pt5l.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/8keeh1pt5l",
    "title": "Parabolas: Vertex Form",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:22:22 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-parabolas-vertex-form",
    "example": true
  },
  {
    "hash": "dxkknajdqb",
    "parent_hash": "t6auzqijzl",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/dxkknajdqb.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/dxkknajdqb",
    "title": "Parabolas: Standard Form + Tangent",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:24:05 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-parabolas-standard-form-plus-tangent",
    "example": true
  },
  {
    "hash": "kihjluohq9",
    "parent_hash": "vpnnmvncdb",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/kihjluohq9.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/kihjluohq9",
    "title": "Trigonometry: Period and Amplitude",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:24:32 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-trig-period-and-amplitude",
    "example": true
  },
  {
    "hash": "l3u8133jwj",
    "parent_hash": "51d9lso1ia",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/l3u8133jwj.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/l3u8133jwj",
    "title": "Trigonometry: Phase",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:24:53 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-trig-phase",
    "example": true
  },
  {
    "hash": "7eeumgl7it",
    "parent_hash": "7rnv0erick",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/7eeumgl7it.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/7eeumgl7it",
    "title": "Trigonometry: Wave Interference",
    "access": "link",
    "created": "Tue, 03 Dec 2019 18:14:54 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-trig-wave-interference",
    "example": true
  },
  {
    "hash": "qmzx2skkzy",
    "parent_hash": "s9myfmvujr",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/qmzx2skkzy.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/qmzx2skkzy",
    "title": "Trigonometry: Unit Circle",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:26:18 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-trig-unit-circle",
    "example": true
  },
  {
    "hash": "ivud1auwvw",
    "parent_hash": "8dsmqe5ycc",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/ivud1auwvw.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/ivud1auwvw",
    "title": "Conic Sections: Circle",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:27:04 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-conic-sections-circle",
    "example": true
  },
  {
    "hash": "djcrjdfiif",
    "parent_hash": "0jwlvn9hcs",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/djcrjdfiif.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/djcrjdfiif",
    "title": "Conic Sections: Parabola and Focus",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:27:50 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-conic-sections-parabola-and-focus",
    "example": true
  },
  {
    "hash": "afja7ee9mh",
    "parent_hash": "duajwxdopa",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/afja7ee9mh.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/afja7ee9mh",
    "title": "Conic Sections: Ellipse with Foci",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:28:08 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-conic-sections-ellipse-with-foci",
    "example": true
  },
  {
    "hash": "vgfqbejegx",
    "parent_hash": "k6xcbueze5",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/vgfqbejegx.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/vgfqbejegx",
    "title": "Conic Sections: Hyperbola",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:28:27 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-conic-sections-hyperbola",
    "example": true
  },
  {
    "hash": "0ovfwwmfrb",
    "parent_hash": "scuci1750d",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/0ovfwwmfrb.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/0ovfwwmfrb",
    "title": "Polar: Rose",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:28:48 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-polar-rose",
    "example": true
  },
  {
    "hash": "qlbdlxyrza",
    "parent_hash": "nicremwert",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/qlbdlxyrza.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/qlbdlxyrza",
    "title": "Polar: Logarithmic Spiral",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:29:08 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-polar-logarithmic-spiral",
    "example": true
  },
  {
    "hash": "rayzacuktw",
    "parent_hash": "21pbohd07u",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/rayzacuktw.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/rayzacuktw",
    "title": "Polar: Limacon",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:29:25 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-polar-limacon",
    "example": true
  },
  {
    "hash": "gxnu7fbgks",
    "parent_hash": "kk3axf8oon",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/gxnu7fbgks.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/gxnu7fbgks",
    "title": "Polar: Conic Sections",
    "access": "link",
    "created": "Tue, 18 Aug 2015 20:29:42 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-polar-conic-sections",
    "example": true
  },
  {
    "hash": "rnyjcjpouf",
    "parent_hash": "ogvj2tzgjj",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/rnyjcjpouf.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/rnyjcjpouf",
    "title": "Parametric: Introduction",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:30:31 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-parametric-introduction",
    "example": true
  },
  {
    "hash": "eg5he4xpg9",
    "parent_hash": "pwjl3pe4da",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/eg5he4xpg9.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/eg5he4xpg9",
    "title": "Parametric: Cycloid",
    "access": "link",
    "created": "Tue, 18 Aug 2015 20:30:46 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-parametric-cycloid",
    "example": true
  },
  {
    "hash": "nyterjs0uf",
    "parent_hash": "nqxx2mhknn",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/nyterjs0uf.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/nyterjs0uf",
    "title": "Transformations: Translating a Function",
    "access": "link",
    "created": "Fri, 29 Sep 2017 00:47:36 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-transformations-translating-a-function",
    "example": true
  },
  {
    "hash": "vdkjrpznnu",
    "parent_hash": "doxva7ciht",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/vdkjrpznnu.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/vdkjrpznnu",
    "title": "Transformations: Scaling a Function",
    "access": "link",
    "created": "Tue, 18 Aug 2015 21:23:20 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-transformations-scaling-a-function",
    "example": true
  },
  {
    "hash": "fcjhdt1xdw",
    "parent_hash": "tif5liedlj",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/fcjhdt1xdw.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/fcjhdt1xdw",
    "title": "Transformations: Inverse of a Function",
    "access": "link",
    "created": "Tue, 18 Aug 2015 21:23:36 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-transformations-inverse-of-a-function",
    "example": true
  },
  {
    "hash": "jwquvmikhr",
    "parent_hash": "2l0r87hkmq",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/jwquvmikhr.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/jwquvmikhr",
    "title": "Statistics: Linear Regression",
    "access": "link",
    "created": "Tue, 18 Aug 2015 21:24:01 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-stats-linear-regression",
    "example": true
  },
  {
    "hash": "qrdbrcfnsl",
    "parent_hash": "paknt6oneh",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/qrdbrcfnsl.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/qrdbrcfnsl",
    "title": "Statistics: Anscombe's Quartet",
    "access": "link",
    "created": "Mon, 13 Jul 2020 20:40:16 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-stats-anscombes-quartet",
    "example": true
  },
  {
    "hash": "sanlujpfmc",
    "parent_hash": "tyszvsmelo",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/sanlujpfmc.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/sanlujpfmc",
    "title": "Statistics: 4th Order Polynomial",
    "access": "all",
    "created": "Tue, 18 Aug 2015 21:25:02 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-stats-fourth-order-polynomial",
    "example": true
  },
  {
    "hash": "iwfjdrhdyr",
    "parent_hash": "4n11jtzki0",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/iwfjdrhdyr.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/iwfjdrhdyr",
    "title": "Lists: Family of sin Curves",
    "access": "link",
    "created": "Tue, 18 Aug 2015 21:25:30 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-lists-family-of-sin-curves",
    "example": true
  },
  {
    "hash": "ib4qkln029",
    "parent_hash": "1flkupc1yt",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/ib4qkln029.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/ib4qkln029",
    "title": "Lists: Curve Stitching",
    "access": "link",
    "created": "Thu, 05 May 2016 06:33:59 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-lists-curve-stitching",
    "example": true
  },
  {
    "hash": "zdv2kras4n",
    "parent_hash": "fqhp5hq3ka",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/zdv2kras4n.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/zdv2kras4n",
    "title": "Lists: Plotting a List of Points",
    "access": "link",
    "created": "Tue, 18 Aug 2015 21:27:01 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-lists-plotting-a-list-of-points",
    "example": true
  },
  {
    "hash": "qtzamwcdrk",
    "parent_hash": "aqgbwm3qfd",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/qtzamwcdrk.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/qtzamwcdrk",
    "title": "Calculus: Derivatives",
    "access": "link",
    "created": "Tue, 18 Aug 2015 21:27:17 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-calculus-derivatives",
    "example": true
  },
  {
    "hash": "mekfho0w38",
    "parent_hash": "irip8pnpdf",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/mekfho0w38.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/mekfho0w38",
    "title": "Calculus: Secant Line",
    "access": "link",
    "created": "Tue, 18 Aug 2015 21:27:32 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-calculus-secant-line",
    "example": true
  },
  {
    "hash": "fs3lx8gptb",
    "parent_hash": "dlzhsldcgo",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/fs3lx8gptb.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/fs3lx8gptb",
    "title": "Calculus: Tangent Line",
    "access": "link",
    "created": "Tue, 18 Aug 2015 21:27:46 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-calculus-tangent-line",
    "example": true
  },
  {
    "hash": "noanuckuli",
    "parent_hash": "gkjridbqfj",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/noanuckuli.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/noanuckuli",
    "title": "Calculus: Taylor Expansion of sin(x)",
    "access": "link",
    "created": "Tue, 18 Aug 2015 21:28:02 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-calculus-taylor-expansion-of-sin-x",
    "example": true
  },
  {
    "hash": "qigfpckugc",
    "parent_hash": null,
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/qigfpckugc.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/qigfpckugc",
    "title": "Calculus: Integrals",
    "access": "link",
    "created": "Tue, 19 Apr 2016 14:03:33 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-calculus-integrals",
    "example": true
  },
  {
    "hash": "u2qz73ufju",
    "parent_hash": "o3pwn3vkgh",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/u2qz73ufju.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/u2qz73ufju",
    "title": "Calculus: Integral with adjustable bounds",
    "access": "link",
    "created": "Tue, 19 Apr 2016 14:12:40 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-calculus-integral-with-adjustable-bounds",
    "example": true
  },
  {
    "hash": "gaa5aqyb5s",
    "parent_hash": null,
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/gaa5aqyb5s.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/gaa5aqyb5s",
    "title": "Calculus: Fundamental Theorem of Calculus",
    "access": "link",
    "created": "Tue, 19 Apr 2016 14:15:45 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-calculus-fundamental-theorem-of-calculus",
    "example": true
  },
  {
    "hash": "8hxtdephtf",
    "parent_hash": "xova2bfhj5",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/8hxtdephtf.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/8hxtdephtf",
    "title": "hungry pac-man",
    "access": "link",
    "created": "Mon, 20 Apr 2015 14:47:01 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-pac-man",
    "example": true,
    "easterEgg": "betchacant"
  },
  {
    "hash": "qbaliml2om",
    "parent_hash": "8mmk4hrmqg",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/qbaliml2om.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/qbaliml2om",
    "title": "PRIDE flag",
    "access": "link",
    "created": "Wed, 02 Jun 2021 01:46:57 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-pride-flag",
    "example": true,
    "easterEgg": "pride"
  },
  {
    "hash": "ieellz6qbr",
    "parent_hash": "velayq9vsr",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/ieellz6qbr.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/ieellz6qbr",
    "title": "PRIDE flag",
    "access": "link",
    "created": "Wed, 02 Jun 2021 01:51:23 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-pride-flag",
    "example": true,
    "easterEgg": "pride"
  },
  {
    "hash": "dhzndt8brx",
    "parent_hash": "brei8peg52",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/dhzndt8brx.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/dhzndt8brx",
    "title": "3D World",
    "access": "link",
    "created": "Fri, 03 Jun 2016 01:50:06 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-3d-world",
    "example": true,
    "easterEgg": "betchacant"
  },
  {
    "hash": "zzhx3zzlns",
    "parent_hash": "ccmfndxptv",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/zzhx3zzlns.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/zzhx3zzlns",
    "title": "Checkerboard Inversion",
    "access": "link",
    "created": "Thu, 02 Jun 2016 22:06:08 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-checkerboard-inversion",
    "example": true,
    "easterEgg": "betchacant"
  },
  {
    "hash": "c1u72uowae",
    "parent_hash": null,
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/c1u72uowae.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/c1u72uowae",
    "title": "desmos graph of awesomeness",
    "access": "link",
    "created": "Sun, 18 Aug 2013 06:25:20 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-regular-sine-wave",
    "example": true,
    "easterEgg": "betchacant"
  },
  {
    "hash": "2mwse3jtff",
    "parent_hash": "msmdonti4c",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/2mwse3jtff.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/2mwse3jtff",
    "title": "Fastest path to point",
    "access": "link",
    "created": "Thu, 02 Jun 2016 22:02:44 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-fastest-path-to-a-point",
    "example": true,
    "easterEgg": "betchacant"
  },
  {
    "hash": "8ytrg3nyln",
    "parent_hash": "d7qrsg2hxg",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/8ytrg3nyln.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/8ytrg3nyln",
    "title": "Fireworks!",
    "access": "link",
    "created": "Fri, 03 Jun 2016 01:50:52 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-fireworks",
    "example": true,
    "easterEgg": "betchacant"
  },
  {
    "hash": "9ed6k6wexp",
    "parent_hash": "9ed6k6wexp",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/9qixqdozzh.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/9ed6k6wexp",
    "title": "Sierpinski Valentine",
    "access": "link",
    "created": "Sat, 14 Feb 2015 18:42:18 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-fractal-valentine",
    "example": true,
    "easterEgg": "betchacant"
  },
  {
    "hash": "am6ab20tmw",
    "parent_hash": "hvycjwscfq",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/am6ab20tmw.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/am6ab20tmw",
    "title": "Outstretched Arm",
    "access": "link",
    "created": "Fri, 03 Jun 2016 01:45:50 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-outstretched-arm",
    "example": true,
    "easterEgg": "betchacant"
  }
]
`;var qP={showGrid:!0,showXAxis:!0,showYAxis:!0,xAxisStep:0,yAxisStep:0,xAxisScale:"linear",yAxisScale:"linear",xAxisMinorSubdivisions:0,yAxisMinorSubdivisions:0,xAxisArrowMode:"NONE",yAxisArrowMode:"NONE",xAxisLabel:"",yAxisLabel:"",xAxisNumbers:!0,yAxisNumbers:!0,polarMode:!1,polarNumbers:!0,degreeMode:!1,randomSeed:"",restrictGridToFirstQuadrant:!1,userLockedViewport:!1},vU={threeDMode:!1,worldRotation3D:[],axis3D:[0,0,1],speed3D:0,showPlane3D:!0,showNumbers3D:!0,plane3dOpacity:"",backgroundColor3d:"#FFF",showAxis3D:!0,showAxisLabels3D:!0,showBox3D:!0},$Z={squareAxes:!0},jZ={...vU,...$Z,product:"graphing",hideCustomColors:!1};function CU(r){return r in vU}var Uc={...qP,...jZ},EU=Object.keys(qP);function SU(r){return r in qP}var yy=r=>isFinite(r)&&(r>0||r===0);var YZ=0,XZ="guid_"+Math.round(Math.random()*1e6)+"_"+new Date().getTime()+"_",HP=class{constructor(){this.__observers={},this.__eventObservers={},this.__oldProperties={},this.__propertyComparators={},this.guid=XZ+ ++YZ}unobserveAll(){this.__observers={},this.__eventObservers={}}getProperty(e){return this[e]}getOldProperty(e){return this.__oldProperties[e]}setProperty(e,t){var i=this[e];this[e]=t;var o=this.__propertyComparators[e];if(o){if(o(i,t))return}else if(__dcg_shared_module_exports__['E'](i,t))return;this.__oldProperties[e]=i,this.notifyPropertyChange(e)}setProperties(e){for(var t in e)e.hasOwnProperty(t)&&this.setProperty(t,e[t])}setPropertyComparator(e,t){this.__propertyComparators[e]=t}notifyPropertyChange(e){this.__callObservers(this.__observers,e,this)}observe(e,t){this.__addObservers(this.__observers,e,t)}unobserve(e){this.__removeObservers(this.__observers,e)}observeAndSync(e,t){this.observe(e,t);for(var i=e.split(" "),o=0;o<i.length;o++){var n=i[o].split("."),a=n[0];this.hasOwnProperty(a)&&t(a,this)}}triggerEvent(e,t){this.__callObservers(this.__eventObservers,e,t)}observeEvent(e,t){this.__addObservers(this.__eventObservers,e,t)}unobserveEvent(e){this.__removeObservers(this.__eventObservers,e)}__callObservers(e,t,i){var o=e[t];if(o)for(var n=0;n<o.length;n++)o[n].callback(t,i)}__removeObservers(e,t){for(var i=t.split(" "),o=0;o<i.length;o++){var n=i[o].split("."),a=n[0],s=n[1];if(a&&s){var l=e[a],c=[];if(!l)continue;for(var d=0;d<l.length;d++){var p=l[d];p.namespace!==s&&c.push(p)}e[a]=c}else if(a)delete e[a];else if(s)for(a in e)e.hasOwnProperty(a)&&this.__removeObservers(e,a+"."+s)}}__addObservers(e,t,i){for(var o=t.split(" "),n=0;n<o.length;n++){var a=o[n].split("."),s=a[0];if(!s)throw"Must supply a property to observe";var l=a[1],c={namespace:l,callback:i},d=e[s];d?d.push(c):e[s]=[c]}}},Yr=HP;Rc();var Ca={},dc=tn();if(typeof Desmos!="undefined"&&Desmos.config)for(ik in Desmos.config)Desmos.config.hasOwnProperty(ik)&&(dc[ik]=Desmos.config[ik]);var ik,Vd=function(r){return dc.hasOwnProperty(r)},Ir=function(r){Ca[r]=Vd(r)},So=function(r){Ca[r]=!Vd("no"+r)};Ir("testing");Ir("maintenance");Ir("disableScrollFix");Ir("nativeOnscreenKeypad");Ir("hidden");Ir("disableMouseInteractions");Ir("advancedStyling");Ir("outofdom");Ir("beta3d");dc.lang&&(Ca.language=dc.lang);dc.fontSize&&(Ca.fontSize=dc.fontSize);dc.backgroundColor&&(Ca.backgroundColor="#"+dc.backgroundColor);dc.textColor&&(Ca.textColor="#"+dc.textColor);Ca.no_navigation_warning=Vd("noconcat")||Vd("testing");Ca.previewMessage="You're previewing some new accessibility features.";Ca.previewFeedbackUrl="mailto:feedback@desmos.com";var JZ=location&&location.hostname==="preview.desmos.com";Ca.previewMode=Vd("previewMode")||JZ;Ir("lockViewport");Ir("authorFeatures");Ir("degreeMode");Ir("clearIntoDegreeMode");Ir("plaidMode");Ir("wireframe");Ir("editOnWeb");Ir("crossOriginSaveTest");Ir("showResetButtonOnGraphpaper");Ir("transparentBackground");Ir("forceLogModeRegressions");So("links");So("trace");So("zoomFit");Ir("expressionsCollapsed");Ir("invertedColors");Ir("projectorMode");So("images");So("folders");So("settingsMenu");So("expressionsTopbar");So("zoomButtons");So("keypad");So("graphpaper");So("expressions");So("branding");So("pointsOfInterest");So("plotSingleVariableImplicitEquations");So("plotImplicits");So("plotInequalities");So("notes");So("sliders");Ir("pauseWhenOffscreen");Ir("worksheetSVG");So("brailleControls");Ir("audioTraceKeypad");Ir("audioTraceSimult");So("audio");Ir("sciKeypad");Ir("4fnKeypad");Ir("ans");Vd("braille")&&(Ca.braille=!0);So("qwertyKeyboard");Ir("restrictedFunctions");Ir("forceEnableGeometryFunctions");So("functionDefinition");Ir("singleExpression");Ir("restrictedEditing");Ir("replaceCommaWith10Exp");Ir("replaceRoundWithReciprocal");Vd("typingAsteriskWritesTimesSymbol")&&(Ca.typingAsteriskWritesTimesSymbol=!0);So("substitutions");So("intervalComprehensions");Ir("recursion");So("logScales");So("labels");So("distributions");Ca["4fnKeypad"]?Ir("decimalToFraction"):So("decimalToFraction");Ir("translucentSurfaces");Ir("3d");Ir("disableWorkerOnZoom");Ir("disableLighting");Ir("showPerformanceMeter");Vd("exponentButtonForSquareRoot")?Ca.additionalFunctions=["exponent"]:dc.additionalFunctions&&typeof dc.additionalFunctions=="string"&&(Ca.additionalFunctions=dc.additionalFunctions.split(","));Vd("actions")?Ca.actions=!0:Vd("noactions")?Ca.actions=!1:Vd("clickableObjects")&&(Ca.actions=!0);function pr(r){return Ca[r]}function ok(){return __dcg_shared_module_exports__['Z'](Ca)}function nk(r){var e=[];for(let i of r)if(!(!i||typeof i!="string")){var t=i.split("-")[0];e.push(i),e.push(t);for(let o in pc){let n=pc[o];o.split("-")[0]===t&&n.useAsRoot&&e.push(o)}}return e}function DU(){let r={},e=Object.keys(pc);for(let t in e){let i=e[t];r[i]={code:i,display_name:pc[i].displayName}}return r}var pc={en:{displayName:"English (US)",userGuideURL:"https://docs.google.com/document/d/1gV-WgDjgR9hKKb32ffeUpjwggNAgfqxl0Gsg6xocbok/preview",useAsRoot:!1},es:{displayName:"Espa\xF1ol (LATAM)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_ES-ES.pdf",useAsRoot:!0},et:{displayName:"Eesti",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ru:{displayName:"\u0420\u0443\u0441\u0441\u043A\u0438\u0439",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_RU.pdf",useAsRoot:!1},da:{displayName:"Dansk",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},de:{displayName:"Deutsch",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_DE.pdf",useAsRoot:!1},"pt-BR":{displayName:"Portugu\xEAs (Brasil)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!0},"pt-PT":{displayName:"Portugu\xEAs (Portugal)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ca:{displayName:"Catal\xE0",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},fr:{displayName:"Fran\xE7ais",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_FR.pdf",useAsRoot:!1},it:{displayName:"Italiano",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_IT.pdf",useAsRoot:!1},is:{displayName:"\xCDslenska",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},nl:{displayName:"Nederlands",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},no:{displayName:"Norsk",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},"sv-SE":{displayName:"Svenska",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!0},hu:{displayName:"Magyar",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},cs:{displayName:"\u010Ce\u0161tina",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},pl:{displayName:"Polski",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_PL.pdf",useAsRoot:!1},id:{displayName:"Bahasa Indonesia",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},vi:{displayName:"Ti\u1EBFng Vi\u1EC7t",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_VI.pdf",useAsRoot:!1},el:{displayName:"\u0395\u03BB\u03BB\u03B7\u03BD\u03B9\u03BA\u03AC",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_EL.pdf",useAsRoot:!1},uk:{displayName:"\u0423\u043A\u0440\u0430\u0457\u043D\u0441\u044C\u043A\u0430",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ka:{displayName:"\u10E5\u10D0\u10E0\u10D7\u10E3\u10DA\u10D8",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},th:{displayName:"\u0E20\u0E32\u0E29\u0E32\u0E44\u0E17\u0E22",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},tr:{displayName:"T\xFCrk\xE7e",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_TR.pdf",useAsRoot:!1},"zh-CN":{displayName:"\u7B80\u4F53\u4E2D\u6587",useAsRoot:!0,userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_ZH-CN.pdf"},"zh-TW":{displayName:"\u7E41\u9AD4\u4E2D\u6587",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_ZH-TW.pdf",useAsRoot:!1},ko:{displayName:"\uD55C\uAD6D\uC5B4",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ja:{displayName:"\u65E5\u672C\u8A9E",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_JA.pdf",useAsRoot:!1}};var kU=`account-shell-button-cancel = Cancel
account-shell-button-confirm-delete =
    { $count ->
        [one] Yes, delete graph
       *[other] Yes, delete graphs
    }
account-shell-button-contact-us = Contact Us
account-shell-button-delete = Delete
account-shell-button-download-braille = Download Braille Equations
account-shell-button-download-png = Download PNG
account-shell-button-download-svg = Download SVG
account-shell-button-duplicate = Duplicate
account-shell-button-edit = Edit
account-shell-button-embed = Embed
account-shell-button-export-image = Export Image
account-shell-button-hide-browser-warning = Hide this warning.
account-shell-button-line-medium = Medium
account-shell-button-line-thick = Thick
account-shell-button-line-thin = Thin
account-shell-button-log-in = Log In
account-shell-button-mygraphs-attempt-recovery = Attempt recovery.
account-shell-button-mygraphs-cancel = Cancel
account-shell-button-mygraphs-close-graph-list = Close Graph List
account-shell-button-mygraphs-close-graph-preview = Close Graph Preview
account-shell-button-mygraphs-delete-graph = Delete Graph
account-shell-button-mygraphs-delete-title = Delete { $graphTitle }
account-shell-button-mygraphs-offline-try-again = offline. click to try again.
account-shell-button-mygraphs-save = Save
account-shell-button-mygraphs-try-again = Try again
account-shell-button-open-construction = Open Construction
account-shell-button-open-graph = Open Graph
account-shell-button-print = Print
account-shell-button-rename = Rename
account-shell-button-retry-now = Retry now
account-shell-button-save = Save
account-shell-button-save-copy = Save Copy
account-shell-button-sign-up = Sign Up
account-shell-button-submit-graph = Submit this graph
account-shell-button-update-graph = Submit your current graph instead
account-shell-error-art-contest-logged-out = Log in to participate in the art contest
account-shell-error-deletion-error = There was an error. Try again later?
account-shell-error-graph-too-large = This graph is too large to save. The maximum allowable size is 5 MB.
account-shell-error-logging-out = Error logging out.
account-shell-error-mygraphs-check-connection = Check your internet connection?
account-shell-error-mygraphs-error-deleting = Error deleting.
account-shell-error-mygraphs-error-loading = Error loading graph
account-shell-error-save-art-contest = Error saving. Please try again later.
account-shell-error-sharing-link = Sorry, there was an error generating a link to your graph. Check your internet connection.
account-shell-error-something-went-wrong = Something went wrong, please report this to desmos.com support. (Error { $error_num })
account-shell-error-submitting = Error submitting. Please try again later.
account-shell-error-unexpected-error = Unexpected error.
account-shell-error-unknown = Sorry! Something went wrong. Please try again later.
account-shell-heading-3dcalc-page-title = Desmos | 3D Graphing Calculator
account-shell-heading-artist-statement = Your Artist Statement
account-shell-heading-birth-year = Your Birth Year
account-shell-heading-contact-us = Contact Us
account-shell-heading-country = Your Country
account-shell-heading-download-instructions = Download Instructions
account-shell-heading-duplicate-construction = Duplicate This Construction
account-shell-heading-duplicate-graph = Duplicate This Graph
account-shell-heading-email = Your Email
account-shell-heading-email-details = This will never be shared, but please provide an email where we can reach you!
account-shell-heading-embossing-instructions = Embossing Instructions
account-shell-heading-export-graph = Export Your Graph
account-shell-heading-export-size = Size
account-shell-heading-file-format = File Format
account-shell-heading-geometry-legacy-page-title = Desmos | Geometry (Legacy)
account-shell-heading-geometry-page-title = Desmos | Geometry
account-shell-heading-graphingcalc-page-title = Desmos | Graphing Calculator
account-shell-heading-line-thickness = Line Thickness
account-shell-heading-math-art-contest = Global Math Art Contest
account-shell-heading-mygraphs-examples = Examples
account-shell-heading-mygraphs-recovered-work = Recovered Work
account-shell-heading-mygraphs-saved-constructions = Saved Constructions
account-shell-heading-mygraphs-saved-graphs = Saved Graphs
account-shell-heading-name = Your Name
account-shell-heading-name-details = This will be public.
account-shell-heading-named-graph = { $title } | Desmos
account-shell-heading-rename-graph = Rename This Graph
account-shell-heading-resources = Resources
account-shell-heading-save-construction = Save This Construction
account-shell-heading-save-graph = Save This Graph
account-shell-heading-share-graph = Share Your Graph
account-shell-heading-submit-graph = Submit This Graph
account-shell-heading-title-mygraphs-search = Search
account-shell-heading-tours = Tours
account-shell-heading-unsupported-browser = Unsupported Browser
account-shell-label-account-information = Account Information
account-shell-label-advanced-preferences = Advanced
account-shell-label-art-contest-nudge-construction = Have a construction that you're proud of? We'd love to see it!
account-shell-label-art-contest-nudge-graph = Do you have a graph that you're proud of? We'd love to see it!
account-shell-label-artist-statement-description = In 2-3 sentences, describe the inspiration behind your graph.
account-shell-label-artist-statement-placeholder = Tell us about this graph...
account-shell-label-betchacant-loading = Challenge accepted...
account-shell-label-birth-year-placeholder = Birth Year
account-shell-label-country-placeholder = Country
account-shell-label-created-days-ago = { $number } days ago
account-shell-label-created-hours-ago = { $number } hours ago
account-shell-label-created-last-week = last week
account-shell-label-created-minutes-ago = { $number } minutes ago
account-shell-label-created-on-date = { $month } { $day }, { $year }
account-shell-label-created-one-hour-ago = one hour ago
account-shell-label-created-one-minute-ago = one minute ago
account-shell-label-created-seconds-ago = less than a minute ago
account-shell-label-created-weeks-ago = { $number } weeks ago
account-shell-label-created-yesterday = yesterday
account-shell-label-delete-graph-modal-title = Delete Graph
account-shell-label-email-address = Email Address
account-shell-label-email-placeholder = email@example.com
account-shell-label-export-size-large-rectangle = Large Rectangle
account-shell-label-export-size-large-square = Large Square
account-shell-label-export-size-medium-rectangle = Medium Rectangle
account-shell-label-export-size-medium-square = Medium Square
account-shell-label-export-size-small-square = Small Square
account-shell-label-feature-flag-actions = Actions
account-shell-label-feedback = Feedback
account-shell-label-feedback-email = Email address so we can respond! (optional)
account-shell-label-feedback-message = Questions? Feedback?
account-shell-label-feedback-placeholder = Write to us!
account-shell-label-feedback-sending = Sending...
account-shell-label-graph-actions = Graph actions
account-shell-label-graph-title = Title
account-shell-label-help = Help
account-shell-label-help-menu = Help Menu
account-shell-label-join-contest = Join the contest
account-shell-label-language = Language
account-shell-label-loading = Loading...
account-shell-label-math-art-contest = Global Math Art Contest
account-shell-label-month-apr = Apr
account-shell-label-month-aug = Aug
account-shell-label-month-dec = Dec
account-shell-label-month-feb = Feb
account-shell-label-month-jan = Jan
account-shell-label-month-jul = Jul
account-shell-label-month-jun = Jun
account-shell-label-month-mar = Mar
account-shell-label-month-may = May
account-shell-label-month-nov = Nov
account-shell-label-month-oct = Oct
account-shell-label-month-sep = Sep
account-shell-label-mygraphs-example = example
account-shell-label-mygraphs-last-saved = last saved: { $date }
account-shell-label-mygraphs-no-unsaved-changes = no unsaved changes
account-shell-label-mygraphs-unsaved-graph = unsaved graph
account-shell-label-no-unsaved-changes = No Unsaved Changes
account-shell-label-open-graph-mac = { $open_graph } (cmd+o)
account-shell-label-open-graph-pc = { $open_graph } (ctrl+o)
account-shell-label-save-changes-mac = Save Changes (cmd+s)
account-shell-label-save-changes-pc = Save Changes (ctrl+s)
account-shell-label-saving-graph = Saving graph...
account-shell-label-share = share
account-shell-label-share-graph = Share Graph
account-shell-label-share-link = Share this link:
account-shell-label-submission-already-received = Your Art Contest Submission
account-shell-label-submission-received = Submission Received!
account-shell-label-submitting = Submitting...
account-shell-label-success = Success
account-shell-label-try-a-quest-title = Try a Quest
account-shell-label-zoom = Zoom: { $value }%
account-shell-link-3d-user-guide = 3D User Guide
account-shell-link-account-settings = Account Settings
account-shell-link-download-chrome = Click here to download Google Chrome.
account-shell-link-email-support = Email Our Support Team
account-shell-link-geometry-user-guide = Geometry User Guide
account-shell-link-getting-started = Getting Started
account-shell-link-help = Help
account-shell-link-help-center = Help Center
account-shell-link-keyboard-shortcuts = Keyboard Shortcuts
account-shell-link-learn-more = Learn More
account-shell-link-privacy = Privacy Policy
account-shell-link-read-blog = Read our blog
account-shell-link-send-feedback = Send Feedback and Questions
account-shell-link-share-thoughts = Share your thoughts!
account-shell-link-sign-out = Sign Out
account-shell-link-terms = Terms of Service
account-shell-link-try-a-quest = Try a quest
account-shell-link-try-next-quest = Try another
account-shell-link-user-guide = Desmos User Guide
account-shell-link-video-tutorials = Video Tutorials
account-shell-link-view-all-quests = View all quests
account-shell-narration-edit-selected-country = Edit Selected Country
account-shell-narration-edit-selected-year = Edit Selected Year
account-shell-narration-graph-preview = Graph Preview
account-shell-narration-language-menu = Language Options Menu
account-shell-narration-mygraphs-open-graph = Open graph
account-shell-narration-share-options = Share Options
account-shell-text-3d-beta-notice = Thank you for visiting our Beta 3D Calculator! Please share any bugs, questions, or suggestions with us below.
account-shell-text-3d-expression-list-notice = Please share any bugs, questions, or suggestions at: <1>feedback@desmos.com</1>
account-shell-text-advanced-preferences-instructions = Try these advanced features. Feel free to send any questions or feedback to support@desmos.com.
account-shell-text-art-contest-congratulations = Congratulations, and keep graphing!
account-shell-text-art-contest-copyright-agreement = I pledge that (a) this is my original work and (b) this isn't based on copyrighted material.
account-shell-text-art-contest-create-graph-notice = Create a new graph or open one of your graphs to participate in the art contest.
account-shell-text-art-contest-deadline-notice = Submissions are open until January 15th.
account-shell-text-art-contest-has-arrived = Have a graph that you're proud of? We'd love to see it! Learn more at <1>desmos.com/art<2> (opens in new tab)</2></1>.
account-shell-text-art-contest-has-closed = This year's contest is now closed. We're hard at work looking through all of the incredible creations, and will post results soon at <1>desmos.com/art<2> (opens in new tab)</2></1>.
account-shell-text-art-contest-legal-disclaimer = By submitting this graph, you acknowledge that Desmos Studio, PBC may, at its discretion, post it publicly at the contest website and/or on social media channels.
account-shell-text-art-contest-loading-submissions = Loading your submissions...
account-shell-text-art-contest-my-first-year = This is my first year participating in the art contest.
account-shell-text-art-contest-see-submissions = See your submissions
account-shell-text-art-contest-someone-else-artist-statement = Participant's Artist Statement
account-shell-text-art-contest-someone-else-artist-statement-description = In 2-3 sentences, please have the participant describe the inspiration behind their graph.
account-shell-text-art-contest-someone-else-birth-year = Participant's Birth Year
account-shell-text-art-contest-someone-else-copyright-agreement = I pledge that (a) I am 18 or older and legally allowed to submit on behalf of this participant, (b) this is the participant's original work, and (c) this work isn't based on copyrighted material.
account-shell-text-art-contest-someone-else-country = Participant's Country
account-shell-text-art-contest-someone-else-email = Adult's (Your) Email
account-shell-text-art-contest-someone-else-first-year = This is the participant\u2019s first year participating in the art contest.
account-shell-text-art-contest-someone-else-name = Participant's Name
account-shell-text-art-contest-submit-construction = Submit your current construction
account-shell-text-art-contest-submit-graph = Submit your current graph
account-shell-text-art-contest-success-paragraph = If you'd like to revise your submission, feel free to resubmit anytime before<1> January 15th</1>. We'll only look at the most recent submission for each tool.
account-shell-text-art-contest-success-paragraph-someone-else = If you'd like to revise the submission, please delete it from the table of graphs you\u2019ve submitted and resubmit. Feel free to resubmit anytime before<1> January 15th</1>. We'll only look at the most recent submission for each tool.
account-shell-text-art-contest-view-or-update-submission = View or change your submission
account-shell-text-art-contest-view-submission = View your submission
account-shell-text-art-contest-your-2d-submission = View your graphing calculator submission
account-shell-text-art-contest-your-3d-submission = View your 3D submission
account-shell-text-art-contest-your-geometry-submission = View your geometry submission
account-shell-text-artcontest-ineligible = <1><2>Based on the provided age, we aren\u2019t able to accept this graph submission this year.</2><3>Keep up the awesome graphing! There will be new contests every year.</3></1>
account-shell-text-artcontest-someone-else = <1><2>Based on your age and location, you need a teacher, parent, or guardian over the age of 18 to submit your graph for you.</2><3>Here is the link to your graph: </3><graphlink/><4>Please share it with one of them and have them submit it at <5>desmos.com/art</5>.</4></1>
account-shell-text-confirm-leave = Are you sure you want to leave this graph? Your unsaved work will be lost.
account-shell-text-construction-cleared = Construction Cleared.
account-shell-text-continue-with-quest = ...or <1>keep playing with this quest</1>.
account-shell-text-copy-of-title = [Copy of] { $originalTitle }
account-shell-text-delete-graphs-confirmation =
    Are you sure you want to delete { $count ->
        [one] "{ $title }"
       *[other] the { $count } selected graphs
    }?
account-shell-text-download-instructions = To download, right click on the image of the graph select "Save As." You might also be able to click and drag the image onto your desktop.
account-shell-text-embossing-etc-print = Set paper size to { $size }. Then click "Edit" and select File > Emboss.
account-shell-text-embossing-etc-save = Save this image. Open Firebird, select File > Open > Image File, and open the image.
account-shell-text-embossing-vpmax-print = Right click image and select "print". Set paper size to { $size }.
account-shell-text-embossing-vpmax-save = Right click graph image and save to desktop.
account-shell-text-error = error
account-shell-text-feature-flag-actions-description = Make graphs interactive by defining rules for responding to clicks or to the passage of time.
account-shell-text-feedback-sent = Thank you! We'll be in touch soon.
account-shell-text-geometry-beta-notice = Thank you for visiting our new Geometry Tool! Please share any bugs, questions, or suggestions with us below.
account-shell-text-graph-cleared = Graph cleared.
account-shell-text-graph-migrated-from-geometry = '{ $title }' was auto-migrated from the old geometry tool.
account-shell-text-logged-in = Logged in successfully!
account-shell-text-login-window-blocked-apple = Login window blocked. Please allow popups from desmos.com to sign in with Apple
account-shell-text-login-window-blocked-google = Login window blocked. Please allow popups from desmos.com to sign in with Google.
account-shell-text-maintenance-mode = Desmos is in Maintenance Mode.
account-shell-text-mygraphs-attempting-recovery = Attempting recovery...
account-shell-text-mygraphs-contest-submit-to-contest = <1>Submit this graph to the <2>Global Math Art Contest!</2></1>
account-shell-text-mygraphs-count-more = { $count } more...
account-shell-text-mygraphs-current-construction = Current Construction
account-shell-text-mygraphs-current-graph = Current Graph
account-shell-text-mygraphs-deleting = Deleting...
account-shell-text-mygraphs-loading = Loading...
account-shell-text-mygraphs-lost-work = Lost work?
account-shell-text-mygraphs-maintenance-mode = Desmos is temporarily in maintenance mode. You can open example graphs, but won't be able to sign in, open your graphs, or save any changes. We're so sorry for the inconvenience.
account-shell-text-mygraphs-new-blank-graph = New Blank Graph
account-shell-text-mygraphs-new-construction = New Construction
account-shell-text-mygraphs-no-examples-match-search = No examples match your search.
account-shell-text-mygraphs-no-saved-graphs = No saved graphs yet.
account-shell-text-mygraphs-no-search-results = No saved graphs match your search.
account-shell-text-mygraphs-no-unsaved-graphs = Couldn't find any unsaved graphs.
account-shell-text-mygraphs-opened-graph = Opened '{ $graphTitle }'
account-shell-text-mygraphs-or = or
account-shell-text-mygraphs-search-by-title = search by title
account-shell-text-mygraphs-share-thoughts = Share your thoughts!
account-shell-text-mygraphs-synced = synced!
account-shell-text-mygraphs-to-save-constructions = to save your constructions!
account-shell-text-mygraphs-to-save-graphs = to save your graphs!
account-shell-text-mygraphs-updating-graphs = updating graphs...
account-shell-text-mygraphs-version = Version
account-shell-text-new-construction-created = New construction created.
account-shell-text-new-graph-created = New graph created.
account-shell-text-or = or
account-shell-text-saved = saved
account-shell-text-unsupported-browser-android = Desmos works best on your version of Android if you use the Chrome Browser.
account-shell-text-untitled = Untitled
account-shell-text-untitled-graph = Untitled Graph
account-shell-text-welcome-to-3d = Welcome to Desmos 3D (Beta)
shared-button-cancel = Cancel
shared-button-change-email-address = Change email address
shared-button-change-email-and-password = Change email and password
shared-button-close-dialog = Close Dialog
shared-button-close-message = Close Message
shared-button-confirm-name = Confirm Name
shared-button-continue-to-desmos = Continue to Desmos
shared-button-create-account = Create Account
shared-button-delete-account-question = Delete your Desmos account?
shared-button-email-address-narrow = Email
shared-button-email-address-wide = Email Address
shared-button-external-account-narrow = External
shared-button-external-account-wide = External Account
shared-button-google-account-narrow = Google
shared-button-google-account-wide = Google Account
shared-button-learn-more-capitalized = Learn More
shared-button-login = Log in
shared-button-login-capitalized = Log In
shared-button-recover-password = Recover Password
shared-button-save = Save
shared-button-send-delete-account-email = Send Delete Account Email
shared-button-send-email = Send Email
shared-button-sign-in-with-apple = Sign in with Apple
shared-button-sign-in-with-google = Sign in with Google
shared-button-try-again = Didn't work? Try again!
shared-calculator-button-braille-mode-nemeth = Nemeth
shared-calculator-button-braille-mode-ueb = UEB
shared-calculator-button-clear = clear
shared-calculator-button-controlbar-functions = functions
shared-calculator-button-go = Go
shared-calculator-button-hide-options = Hide Options
shared-calculator-button-mac = Mac Shortcuts
shared-calculator-button-show-options = Show Options
shared-calculator-button-windows-chrome = Windows / ChromeOS Shortcuts
shared-calculator-error-3d-bad-equality-slice = We don't support this type of equality restriction.
shared-calculator-error-3d-length-type-error = Function '{ $fn }' cannot be applied to { $arg } in the 3d calculator. Use '{ $alternativeFn }' to find the number of elements in a list.
shared-calculator-error-3d-mixed-restriction-equation = Cannot apply both an inequality restriction and an equality restriction to this expression.
shared-calculator-error-3d-multiple-equality-restrictions = Cannot apply more than one equality restriction.
shared-calculator-error-action-merge-free-variable = Cannot combine an action that depends on free variable '{ $symbol }'.
shared-calculator-error-add-arguments-to-definition-many = Try including '{ $symbols }' and '{ $lastSymbol }' as arguments by defining the function as '{ $newSignature }'.
shared-calculator-error-add-arguments-to-definition-one = Try including '{ $lastSymbol }' as an argument by defining the function as '{ $newSignature }'.
shared-calculator-error-add-type-error = Cannot add { $symbol1 } and { $symbol2 }.
shared-calculator-error-adjacent-mixed-number = Sorry, I don't know what to do with mixed number '{ $mixedNumber }'. Try using a '*' symbol around it.
shared-calculator-error-adjacent-numbers = Sorry, I don't know what to do with adjacent numbers '{ $left }' and '{ $right }'. Try using parentheses or a '*' symbol.
shared-calculator-error-ans-undefined = The previous expression didn't define any value for ans.
shared-calculator-error-assignments-unsupported = This calculator does not support defining variables.
shared-calculator-error-bad-for-input-list-dependency = A definition on the right-hand side of 'for' can't depend on input variable '{ $symbol }'.
shared-calculator-error-bad-for-interval-dependency = Parameter bounds on the right-hand side of 'for' can't depend on input variable '{ $symbol }'.
shared-calculator-error-bad-implicit-call = Use parentheses around the argument of '{ $symbol }'.
shared-calculator-error-bad-integral-bound-dependency = Integration bounds can't depend on integration variable '{ $symbol }'.
shared-calculator-error-bad-interval-comprehension-arity =
    { $count ->
        [one] You can't use 'for' to parameterize { $type } using 1 parameter.
       *[other] You can't use 'for' to parameterize { $type } using { $count } parameters.
    }
shared-calculator-error-bad-log-exponent = Only { $form } is supported. Otherwise, use parens.
shared-calculator-error-bad-product-bound-dependency = Product bounds can't depend on product index '{ $symbol }'.
shared-calculator-error-bad-sample-size = Sample size must be a finite, non-negative number.
shared-calculator-error-bad-sum-bound-dependency = Summation bounds can't depend on summation index '{ $symbol }'.
shared-calculator-error-bad-symbol-context = You can't use '{ $symbol }' in this context.
shared-calculator-error-bad-trig-exponent = Only { $form1 } and { $form2 } are supported. Otherwise, use parens.
shared-calculator-error-bad-tuple-dimensions = Points may only have { $symbol } coordinates.
shared-calculator-error-binary-operator-missing-operand = You need something on both sides of the '{ $symbol }' symbol.
shared-calculator-error-blank-expression = You haven't written anything yet.
shared-calculator-error-boxplot-breadth-invalid = Invalid height. Try using any number.
shared-calculator-error-boxplot-offset-invalid = Invalid offset. Try using any number.
shared-calculator-error-cannot-assign-color = Cannot assign a color to '{ $variable }'.
shared-calculator-error-cannot-redefine = You can't redefine '{ $symbol }' because it's already defined.
shared-calculator-error-cannot-redefine-root = You can't define '{ $symbol }' because '{ $symbolRoot }' is already defined.
shared-calculator-error-cannot-restrict = Cannot create a restriction based on '{ $variable }' in this type of expression.
shared-calculator-error-cannot-restrict-with-equality = Cannot create an equality restriction based on '{ $variable }' in this type of expression.
shared-calculator-error-cannot-subscript = '{ $symbol }' cannot have a subscript.
shared-calculator-error-cant-combine-spherical-and-cylindrical = Can't combine spherical and cylindrical coordinates.
shared-calculator-error-cdf-max-invalid = Invalid cdf max. Try using any number.
shared-calculator-error-cdf-max-less-than-min = Invalid cdf limits. Min should be less than max.
shared-calculator-error-cdf-min-invalid = Invalid cdf min. Try using any number.
shared-calculator-error-cdf-too-many-arguments = 'cdf' should be called on a distribution with at most two numbers. { $recommendation }
shared-calculator-error-cdf-too-many-arguments-recommendation = For example, try typing: D.cdf(-1,1) where D=normaldist().
shared-calculator-error-cdf-wrong-arity = 'cdf' should be called on a distribution with at least one number. { $recommendation }
shared-calculator-error-cdf-wrong-arity-recommendation = For example, try typing: D.cdf(x) where D=normaldist().
shared-calculator-error-clickable-object-assignment-not-defined = "{ $symbol }" is not defined. Try using a different variable or adding a slider.
shared-calculator-error-clickable-object-assignment-not-identifier = Invalid symbol. Try using a single letter.
shared-calculator-error-clickable-object-invalid-expression = Can't evaluate this. Try a number or simple expression.
shared-calculator-error-colon-missing-condition = The left side of a ':' must be a condition, like 'x>1'.
shared-calculator-error-color-arity = '{ $symbol }' should be called with 3 arguments. { $recommendation }
shared-calculator-error-color-arity-recommendation = For example, try typing: { $recommendation }.
shared-calculator-error-color-not-assigned = To use a color, you must assign it to a variable.
shared-calculator-error-combine-type-error = Cannot combine { $symbol1 } and { $symbol2 }.
shared-calculator-error-comparator-type-error = Cannot compare { $symbol1 } to { $symbol2 }.
shared-calculator-error-complicated-double-inequality = We only support solved double inequalities. Try deleting one side of the inequality.
shared-calculator-error-complicated-polar-implicit = Polar equations must be linear in r.
shared-calculator-error-constant-unsupported = This calculator does not support the constant '{ $symbol }'.
shared-calculator-error-custom-toolbar-not-condition = Please write a valid condition and make sure every referenced variable is defined.
shared-calculator-error-deeply-nested = Definitions are nested too deeply.
shared-calculator-error-dependency-cycle = '{ $symbols }' and '{ $lastSymbol }' can't be defined in terms of each other.
shared-calculator-error-depends-on-deleted-geo-object = This depends on a geometric object that's no longer defined.
shared-calculator-error-derivative-missing-body = What do you want to take the derivative of?
shared-calculator-error-derivative-type-error = Cannot take the derivative of { $symbol }.
shared-calculator-error-derivative-variable-type-error = Cannot take derivative with respect to '{ $symbol1 }' because it is { $symbol2 }.
shared-calculator-error-differential-with-superscript = Integration variable cannot have a superscript.
shared-calculator-error-distribution-as-function = Cannot call distribution '{ $symbol }' as a function. Try '{ $symbol }.pdf(x)'.
shared-calculator-error-divide-type-error = Cannot divide { $symbol1 } by { $symbol2 }.
shared-calculator-error-domain-max-invalid = Invalid domain max. Try using any number.
shared-calculator-error-domain-max-less-than-min = Invalid domain limits. Min should be less than max.
shared-calculator-error-domain-min-invalid = Invalid domain min. Try using any number.
shared-calculator-error-dot-lhs-type-error = Cannot call '.{ $symbol }' on { $type }.
shared-calculator-error-duplicate-function-parameter = Cannot use '{ $dependency }' for multiple parameters of this function.
shared-calculator-error-duplicate-update-rules = An action cannot specify multiple update rules for '{ $symbol }'.
shared-calculator-error-empty-paren = Parentheses cannot be empty.
shared-calculator-error-empty-pipe = Absolute value symbol cannot be empty.
shared-calculator-error-empty-radical = Radical cannot be empty.
shared-calculator-error-empty-radical-index = Radical index cannot be empty.
shared-calculator-error-empty-square-bracket = Square brackets cannot be empty.
shared-calculator-error-empty-subscript = Subscripts cannot be empty.
shared-calculator-error-empty-superscript = Superscripts cannot be empty.
shared-calculator-error-equation-required = Try adding an equals sign to turn this into an equation.
shared-calculator-error-equation-required-symbol = Try adding '{ $lhs }' to the beginning of this equation.
shared-calculator-error-equations-unsupported = This calculator does not support this type of equation.
shared-calculator-error-event-handler-type-error = This should be an action. Try '{ $example }'.
shared-calculator-error-exponent-type-error = Cannot raise { $symbol1 } to { $symbol2 }.
shared-calculator-error-feature-unavailable = This feature is not available in the current calculator.
shared-calculator-error-fraction-empty = You need a numerator and denominator for your fraction.
shared-calculator-error-fraction-missing-denominator = You need a denominator for the bottom of your fraction.
shared-calculator-error-fraction-missing-numerator = You need a numerator for the top of your fraction.
shared-calculator-error-function-definition-unsupported = This calculator does not support function definitions.
shared-calculator-error-function-name-as-parameter = Cannot use function name '{ $dependency }' as a function parameter.
shared-calculator-error-function-not-defined = Function '{ $dependency }' is not defined.
shared-calculator-error-function-type-error-1 = Function '{ $fn }' cannot be applied to { $arg }.
shared-calculator-error-function-type-error-2 = Function '{ $fn }' cannot be applied to { $arg1 } and { $arg2 }.
shared-calculator-error-function-type-error-many = Function '{ $fn }' cannot be applied to these arguments.
shared-calculator-error-function-unsupported = This calculator does not support the '{ $symbol }' function.
shared-calculator-error-geometry-length-type-error = Function '{ $fn }' cannot be applied to { $arg } in the geometry calculator. Use '{ $alternativeFn }' to find the number of elements in a list.
shared-calculator-error-gpu-function-unsupported = Cannot use the '{ $symbol }' function here.
shared-calculator-error-gpu-integral-unsupported = Cannot use integrals here.
shared-calculator-error-gpu-long-product = Products may not have more than { $maxTermCount } terms here.
shared-calculator-error-gpu-long-sum = Sums may not have more than { $maxTermCount } terms here.
shared-calculator-error-gpu-max-list-size = Lists may not have more than { $maxListSize } elements here.
shared-calculator-error-gpu-variable-list-length = List length cannot depend on variable '{ $symbol }' here.
shared-calculator-error-gpu-variable-product = Product bound cannot depend on variable '{ $symbol }' here.
shared-calculator-error-gpu-variable-sum = Sum bound cannot depend on variable '{ $symbol }' here.
shared-calculator-error-heterogeneous-list = All elements of a list must have the same type.
shared-calculator-error-identifier-as-function = '{ $symbol }' is a function. Try using parentheses.
shared-calculator-error-identifier-is-not-function = '{ $symbol }' is not a function. Try defining it as '{ $symbol }(x) = x^2' instead.
shared-calculator-error-illegal-bin-width = The second argument to '{ $symbol }' must be a positive number.
shared-calculator-error-illegal-dot-call = Function '{ $symbol }' cannot be called with dot notation.
shared-calculator-error-implicits-disabled = Plotting implicit equations and inequalities is disabled.
shared-calculator-error-incorrect-list-comprehension-input = Definitions on the right-hand side of 'for' must set a variable equal to a list. Try i=[1...10].
shared-calculator-error-incorrect-product-lower-bound = Lower bound of a product must set a variable equal to a number. Try n=1.
shared-calculator-error-incorrect-sum-lower-bound = Lower bound of a sum must set a variable equal to a number. Try n=1.
shared-calculator-error-index-type-error = Cannot index { $symbol1 } with { $symbol2 }.
shared-calculator-error-inequalities-disabled = Plotting inequalities is disabled.
shared-calculator-error-inequalities-unsupported = This calculator does not support inequalities.
shared-calculator-error-integral-argument-type-error = Cannot take the integral of { $symbol }.
shared-calculator-error-integral-lower-bound-type-error = Lower bound of an integral cannot be { $symbol }.
shared-calculator-error-integral-missing-body = What do you want to take the integral of?
shared-calculator-error-integral-missing-bound = Integrals must have upper and lower bounds.
shared-calculator-error-integral-missing-differential = Integrand must end with an integration variable, like dx.
shared-calculator-error-integral-upper-bound-type-error = Upper bound of an integral cannot be { $symbol }.
shared-calculator-error-internal-error = [internal] { $msg }
shared-calculator-error-invalid-dependent-first-table-column = This column header can't be defined elsewhere in the calculator.
shared-calculator-error-invalid-double-equality-3d = Sorry, we only plot double equalities that contain z. Try adding 0*z to one side.
shared-calculator-error-invalid-double-inequality-3d = We only plot double inequalities of x, y, and z.
shared-calculator-error-invalid-double-inequality-variables = We only plot double inequalities of x and y.
shared-calculator-error-invalid-first-table-column = First column may not be { $most } or { $last }.
shared-calculator-error-invalid-half-empty-range = Range must have an upper and lower bound.
shared-calculator-error-invalid-implicit-variables = We only support implicit equations of x and y.
shared-calculator-error-invalid-implicit-variables-3d = We only support implicit equations of x, y, and z.
shared-calculator-error-invalid-inequality-variables = We only plot inequalities of x and y, or r and \u03B8.
shared-calculator-error-invalid-interval-comprehension-invalid-bound = Parameter bounds on the right-hand side of 'for' must be of the form '0<{ $identifier }<1'.
shared-calculator-error-invalid-interval-comprehension-return-type = You can't use 'for' to parameterize { $type }.
shared-calculator-error-invalid-lhs = Sorry, you can't graph { $symbol } as a function of anything yet.
shared-calculator-error-invalid-operator-name = Operator names may only contain letters.
shared-calculator-error-invalid-regression-parameter = '{ $symbol }' may not be used as a regression parameter. Try using a list.
shared-calculator-error-invalid-subscript = Subscripts may only contain letters and digits. '{ $symbol }' is not allowed.
shared-calculator-error-invalid-table-entry = Table entries must be simple expressions. { $supplement }
shared-calculator-error-invalid-table-header = Table headers must be simple expressions. { $supplement }
shared-calculator-error-list-comprehension-input-type-error = A definition on the right-hand side of 'for' must be a list, but { $identifier } is { $actual }. Try { $identifier }={ $example }.
shared-calculator-error-list-type-error = Cannot store { $symbol1 } in a list.
shared-calculator-error-log-scale-box-plot = Cannot plot a box plot on a log scale.
shared-calculator-error-log-scale-dot-plot = Cannot plot a dot plot on a log scale.
shared-calculator-error-log-scale-histogram = Cannot plot a histogram on a log scale.
shared-calculator-error-log-scale-type-error = Cannot plot { $symbol } on a log scale.
shared-calculator-error-logbase-unsupported = This calculator does not support specifying the base of a logarithm. Try 'log' or 'ln'.
shared-calculator-error-malformed-list = Lists are written like this: [1, 2, 3].
shared-calculator-error-malformed-point = Points are written like this: (1, 2).
shared-calculator-error-matrix-add-dimensions = Cannot add matrices with different dimensions.
shared-calculator-error-matrix-assignment = This calculator does not support this type of variable definition. Try using 'New Matrix'.
shared-calculator-error-matrix-element-type-error = Cannot use { $arg } as an element of a matrix.
shared-calculator-error-matrix-fractional-power = A matrix can only be raised to integer powers.
shared-calculator-error-matrix-invalid-variable = Cannot use '{ $symbol }' as a variable.
shared-calculator-error-matrix-multiply-dimensions = Cannot multiply matrices with incompatible dimensions.
shared-calculator-error-matrix-power-dimensions = Only square matrices can be raised to a power.
shared-calculator-error-matrix-subtract-dimensions = Cannot subtract matrices with different dimensions.
shared-calculator-error-max-list-size = Lists may not have more than { $maxListSize } elements.
shared-calculator-error-method-requires-list = '{ $symbol }' requires a list. For example, try typing: { $recommendation }.
shared-calculator-error-mismatched-braces = Expected '{ $symbol1 }' to match '{ $symbol2 }'.
shared-calculator-error-mismatched-double-inequality = Double inequalities must both go the same way, e.g. { $example }.
shared-calculator-error-mixed-comparator-chain = Cannot mix inequalities and equations in a chain of comparisons.
shared-calculator-error-multiply-defined = You've defined '{ $dependency }' in more than one place. Try deleting some of the definitions of '{ $dependency }'.
shared-calculator-error-multiply-type-error = Cannot multiply { $symbol1 } by { $symbol2 }.
shared-calculator-error-multiply-type-error-2d = Ambiguous multiplication of { $symbol1 } by { $symbol2 }. Try typing: (1, 2) * (2, 1).
shared-calculator-error-multiply-type-error-3d = Ambiguous multiplication of { $symbol1 } by { $symbol2 }. Try typing: (1, 2, 3) cross (2, 1, 0).
shared-calculator-error-multiply-type-error-cross = Cannot take the cross product of { $symbol1 } and { $symbol2 }.
shared-calculator-error-negative-type-error = Cannot negate { $symbol }.
shared-calculator-error-nested-interval-comprehension = You can't yet use 'for' to introduce a new parameter to an already parameterized point.
shared-calculator-error-non-arithmetic-range = Ranges must be arithmetic sequences.
shared-calculator-error-non-list-double-reducer = Both arguments of '{ $symbol }' must be lists. For example, try typing: { $recommendation }.
shared-calculator-error-non-list-parameterized-reducer = The first argument of '{ $symbol }' must be a list. For example, try typing: { $recommendation }.
shared-calculator-error-non-singular-inverse = Singular matrices do not have an inverse.
shared-calculator-error-non-square-determinant = Only square matrices have a determinant.
shared-calculator-error-non-square-inverse = Only square matrices have an inverse.
shared-calculator-error-non-square-trace = Only square matrices have a trace.
shared-calculator-error-operator-type-error = Cannot apply { $symbol } to { $symbol1 } and { $symbol2 }.
shared-calculator-error-optimization-error = We couldn't find any region where this model is defined.
shared-calculator-error-ordered-pair-access-type-error = Cannot access a coordinate of { $symbol }.
shared-calculator-error-parameter-already-defined = You can't use '{ $dependency }' as a parameter of this function because '{ $dependency }' is already defined.
shared-calculator-error-parse-error = Sorry, I don't understand this.
shared-calculator-error-pdf-wrong-arity = 'pdf' should be called on a distribution with a number. { $recommendation }
shared-calculator-error-pdf-wrong-arity-recommendation = For example, try typing: D.pdf(x) where D=normaldist().
shared-calculator-error-percent-missing-of = '%' must be used with 'of'. Try '25% of 12'.
shared-calculator-error-piecewise-branch-type-error = Cannot use { $symbol1 } and { $symbol2 } as the branches in a piecewise. Every branch must have the same type.
shared-calculator-error-piecewise-condition-type-error = The condition in a piecewise expression must be { $symbol1 } but was { $symbol2 }.
shared-calculator-error-piecewise-missing-condition = A piecewise expression must have at least one condition.
shared-calculator-error-piecewise-part-missing-condition = Every part of a piecewise expression must have a condition except the last.
shared-calculator-error-point-type-error = Cannot use { $symbol1 } as a coordinate of { $symbol2 }.
shared-calculator-error-points-unsupported = This calculator does not support points.
shared-calculator-error-polygon-unsupported-in-3d = This calculator does not support the 'polygon' function. Try 'triangle' instead.
shared-calculator-error-prime-without-paren = Primed function calls must use parentheses.
shared-calculator-error-primed-function-arity = Prime notation can only be used for functions of a single argument.
shared-calculator-error-product-argument-type-error = Cannot take the product of { $symbol }.
shared-calculator-error-product-infinite-bound-type-error = Product bounds must be finite numbers.
shared-calculator-error-product-lower-bound-type-error = Lower bound of a product cannot be { $symbol }.
shared-calculator-error-product-missing-body = What do you want to take the product of?
shared-calculator-error-product-missing-bound = Products must have upper and lower bounds.
shared-calculator-error-product-upper-bound-type-error = Upper bound of a product cannot be { $symbol }.
shared-calculator-error-random-arity = 'random' should be called with no arguments, or an optional number of samples. For example, try random() or random(10).
shared-calculator-error-random-from-broadcast-distribution = Cannot sample from a list of distributions
shared-calculator-error-recursion-todo-error = [recursion] { $msg }
shared-calculator-error-regression-type-error = Cannot regress { $symbol1 } against { $symbol2 }.
shared-calculator-error-regressions-unsupported = This calculator does not support regressions.
shared-calculator-error-self-referential-function = The definition of function '{ $symbol }' cannot depend on '{ $symbol }'.
shared-calculator-error-shadowed-index = You can't use '{ $symbol }' as an index because it's already defined.
shared-calculator-error-shadowed-integration-variable = You can't use '{ $symbol }' as an integration variable because it's already defined.
shared-calculator-error-shadowed-list-comprehension-input = You can't define '{ $symbol }' more than once on the right-hand side of 'for'.
shared-calculator-error-single-variable-implicit-equations-disabled = Plotting single-variable implicit equations is disabled.
shared-calculator-error-slider-limit-references-export = Slider limits cannot depend on the slider variable '{ $symbol }'.
shared-calculator-error-slider-max-invalid = Invalid slider max. Try using any number.
shared-calculator-error-slider-max-less-than-min = Invalid slider limits. Min should be less than max.
shared-calculator-error-slider-min-invalid = Invalid slider min. Try using any number.
shared-calculator-error-slider-step-invalid = Invalid slider step. Try using any number.
shared-calculator-error-substitution-ambiguous-comma = Ambiguous use of ',' and '{ $operation }'. Add parentheses around the '{ $operation }' expression.
shared-calculator-error-substitution-body-action = The left hand side of a 'with' substitution cannot be an action.
shared-calculator-error-substitution-body-regression-parameter-dependency = Can't use '{ $operator }' to substitute for the existing variable '{ $globalVariable }' because the expression on the left-hand side depends on '{ $regressionParameter }', which is a regression parameter.
shared-calculator-error-substitution-duplicate-assignment = A 'with' expression cannot make multiple substitutions for '{ $symbol }'.
shared-calculator-error-substitution-function-lhs = Substituting for '{ $symbol }' is not allowed because it is a function.
shared-calculator-error-substitution-illegal-lhs = Substituting for '{ $symbol }' is not allowed.
shared-calculator-error-substitution-invalid-assignments = 'with' must be followed by one or more variable definitions.
shared-calculator-error-substitution-local-lhs = Substituting for variable '{ $symbol }' is not allowed because it is locally defined.
shared-calculator-error-substitution-nested = Using one 'with' expression inside another 'with' expression is not allowed.
shared-calculator-error-substitution-type-error = Cannot substitute { $actual } for { $expected }.
shared-calculator-error-substitution-unsupported-interval = Intervals are not allowed on the right-hand side of 'with'. You might want to try using 'for' instead.
shared-calculator-error-subtract-type-error = Cannot subtract { $symbol2 } from { $symbol1 }.
shared-calculator-error-sum-argument-type-error = Cannot take the sum of { $symbol }.
shared-calculator-error-sum-infinite-bound-type-error = Summation bounds must be finite numbers.
shared-calculator-error-sum-lower-bound-type-error = Lower bound of a sum cannot be { $symbol }.
shared-calculator-error-sum-missing-body = What do you want to take the sum of?
shared-calculator-error-sum-missing-bound = Sums must have upper and lower bounds.
shared-calculator-error-sum-upper-bound-type-error = Upper bound of a sum cannot be { $symbol }.
shared-calculator-error-superscript-with-prime = Superscripts and primes cannot be combined.
shared-calculator-error-table-entry-type-error = Table entry cannot be { $symbol }.
shared-calculator-error-table-equation-supplement = Equations are not allowed.
shared-calculator-error-table-function-definition-supplement = Function definitions are not allowed.
shared-calculator-error-table-generic-supplement = This type of expression is not allowed.
shared-calculator-error-table-header-type-error = Table header cannot be { $symbol }.
shared-calculator-error-table-inequality-supplement = Inequalities are not allowed.
shared-calculator-error-table-list-supplement = Lists are not allowed.
shared-calculator-error-table-regression-supplement = Regressions are not allowed.
shared-calculator-error-tdist-wrong-arity = 'tdist' requires 1 argument. For example, try typing: tdist(1).
shared-calculator-error-ticker-min-step-nonnegative = Min step must evaluate to a non-negative number.
shared-calculator-error-token-with-subscript = Tokens may not have subscripts.
shared-calculator-error-too-many-arguments = '{ $symbol }' accepts at most { $max } arguments.
shared-calculator-error-too-many-variables-many-symbols = Too many variables. Try defining '{ $variables }' or '{ $lastVariable }'.
shared-calculator-error-too-many-variables-no-symbols = Too many variables, I don't know what to do with this.
shared-calculator-error-too-many-variables-one-symbol = Too many variables. Try defining '{ $variable }'.
shared-calculator-error-transformation-definition-expected-types-1 = Try using { $arg }.
shared-calculator-error-transformation-definition-expected-types-2 = Try using { $arg1 } and { $arg2 }.
shared-calculator-error-transformation-definition-expected-types-use-fewer-1 = Try using just { $arg }.
shared-calculator-error-transformation-definition-expected-types-use-fewer-2 = Try using just { $arg1 } and { $arg2 }.
shared-calculator-error-transformation-definition-type-error-1 = A { $fn } cannot be defined using { $arg }. { $expectedTypeMessage }
shared-calculator-error-transformation-definition-type-error-2 = A { $fn } cannot be defined using { $arg1 } and { $arg2 }. { $expectedTypeMessage }
shared-calculator-error-transformation-definition-type-error-many = A '{ $fn }' cannot be defined with these arguments.
shared-calculator-error-transformation-definition-type-error-use-more-1 = A { $fn } cannot be defined using just { $arg }. { $expectedTypeMessage }
shared-calculator-error-transformation-definition-type-error-use-more-2 = A { $fn } cannot be defined using just { $arg1 } and { $arg2 }. { $expectedTypeMessage }
shared-calculator-error-transformation-type-error-1 = Transformation '{ $fn }' cannot be applied to { $arg }.
shared-calculator-error-transformation-type-error-2 = Transformation '{ $fn }' cannot be applied to { $arg1 } and { $arg2 }.
shared-calculator-error-transformation-type-error-many = Transformation '{ $fn }' cannot be applied to these arguments.
shared-calculator-error-ttest-list-too-short = Lists for '{ $symbol }' must have at least 2 elements.
shared-calculator-error-two-numbers-error = Cannot make a polygon from two numbers.
shared-calculator-error-unary-operator-missing-left = You need something before the '{ $symbol }' symbol.
shared-calculator-error-unary-operator-missing-right = You need something after the '{ $symbol }' symbol.
shared-calculator-error-unexpected-equality = Cannot use an equality here.
shared-calculator-error-unexpected-inequality = Cannot use an inequality here.
shared-calculator-error-unexpected-prime = Sorry, I don't understand this use of prime notation.
shared-calculator-error-unexpected-subscript = Only functions and variables may have subscripts.
shared-calculator-error-unexpected-symbol = Sorry, I don't understand the way that '{ $symbol }' is used here.
shared-calculator-error-unplottable-chained-equality = This calculator cannot plot chained equations.
shared-calculator-error-unplottable-long-inequality-chain = This calculator cannot plot chains of more than 2 inequalities.
shared-calculator-error-unplottable-polar-function = We can't plot \u03B8 as a function of r. Try plotting r(\u03B8) instead.
shared-calculator-error-unrecognized-symbol = Sorry, I don't understand the '{ $symbol }' symbol.
shared-calculator-error-update-rule-function-lhs = '{ $symbol }' cannot be updated because it is a function.
shared-calculator-error-update-rule-illegal-lhs = Variable '{ $symbol }' cannot be updated.
shared-calculator-error-update-rule-local-lhs = Variable '{ $symbol }' cannot be updated because it is locally defined.
shared-calculator-error-update-rule-non-identifier-lhs = The left hand side of '{ $arrow }' should be a variable name like '{ $example }'.
shared-calculator-error-update-rule-type-error = Cannot update a variable to { $symbol }.
shared-calculator-error-update-rule-undefined-lhs = Variable '{ $symbol }' must be defined to be updated.
shared-calculator-error-use-r-for-cylindrical-coordinates = Can't combine '\u03C1' and 'z'. Try 'r' for cylindrical coordinates.
shared-calculator-error-use-rho-for-spherical-coordinates = Can't combine 'r' and '\u03C6'. Try '\u03C1' (rho) for spherical coordinates.
shared-calculator-error-variable-as-function = Variable '{ $dependency }' can't be used as a function.
shared-calculator-error-variable-function-free-variable = Function '{ $functionSymbol }' cannot depend on free variable '{ $variableSymbol }'.
shared-calculator-error-variable-invalid-function-name = This calculator can not use '{ $symbol }' as a function name.
shared-calculator-error-variable-length-distribution-list = The length of a list of distributions can't depend on free variable '{ $symbol }'.
shared-calculator-error-variable-length-product-body-depends-on-index = Can't take the product of a list whose length depends on product index '{ $symbol }'.
shared-calculator-error-variable-length-sum-body-depends-on-index = Can't sum a list whose length depends on summation index '{ $symbol }'.
shared-calculator-error-variable-length-top-level-list = Can't plot a list whose length depends on free variable '{ $symbol }'.
shared-calculator-error-variable-seed = Random seed cannot depend on free variable '{ $symbol }'.
shared-calculator-error-variable-unsupported = This calculator does not support the '{ $symbol }' variable.
shared-calculator-error-variables-unsupported = This calculator does not support variables like '{ $variable }'.
shared-calculator-error-write-integral = Type '{ $command }' for { $symbol }.
shared-calculator-error-wrong-arity-many-arg = Function '{ $dependency }' requires { $assignment_arity } arguments. { $supplement }
shared-calculator-error-wrong-arity-single-arg-too-few = Function '{ $dependency }' requires an argument. { $supplement }
shared-calculator-error-wrong-arity-single-arg-too-many = Function '{ $dependency }' requires only 1 argument. { $supplement }
shared-calculator-error-wrong-arity-supplement = For example, try typing: { $recommendation }.
shared-calculator-error-wrong-two-arg-arity = Function '{ $symbol }' requires 2 arguments. For example, try typing: { $recommendation }.
shared-calculator-error-zero-arg-reducer = Function '{ $symbol }' requires at least one argument. For example, try typing: { $symbol }(1, 2).
shared-calculator-heading-function-table-column-header = Function
shared-calculator-heading-keyboard-shortcuts = Keyboard Shortcuts
shared-calculator-heading-keyboard-shortcuts-audio-tracing = Audio Tracing
shared-calculator-heading-keyboard-shortcuts-braille = Braille
shared-calculator-heading-keyboard-shortcuts-common-actions = Common Actions
shared-calculator-heading-keyboard-shortcuts-common-symbols = Common Symbols
shared-calculator-heading-keyboard-shortcuts-desmos-com-only = Desmos.com Only
shared-calculator-heading-keyboard-shortcuts-expression-entry-and-navigation = Expression Entry and Navigation
shared-calculator-heading-keyboard-shortcuts-geometry-expression-edit = Expression Edit
shared-calculator-heading-keyboard-shortcuts-geometry-graph-navigation-during-construction = Graph Navigation During Construction
shared-calculator-heading-keyboard-shortcuts-geometry-token-navigator = Token Navigator
shared-calculator-heading-keyboard-shortcuts-geometry-tool-selection = Tool Selection
shared-calculator-heading-keyboard-shortcuts-interactive-points = Interactive Points
shared-calculator-heading-keyboard-shortcuts-slider-trace = Slider Trace
shared-calculator-heading-keyboard-shortcuts-sliders = Sliders
shared-calculator-heading-keyboard-shortcuts-symbols = Symbols
shared-calculator-heading-keyboard-shortcuts-tables = Tables
shared-calculator-heading-mac-table-column-header = Mac Shortcut
shared-calculator-heading-windows-chrome-table-column-header = Windows / ChromeOS Shortcut
shared-calculator-label-dropdown-options = Dropdown Options
shared-calculator-label-hide-custom-colors = Hide custom colors from geo toolbar
shared-calculator-label-os = Operating System
shared-calculator-label-saved = Saved!
shared-calculator-label-saving = Saving...
shared-calculator-label-search-results = Search Results
shared-calculator-label-toast-learn-more = Learn more
shared-calculator-label-toast-undo = Undo
shared-calculator-label-value-type-action = an action
shared-calculator-label-value-type-angle = an angle
shared-calculator-label-value-type-any = an unknown object
shared-calculator-label-value-type-arc = an arc
shared-calculator-label-value-type-bool = a true/false value
shared-calculator-label-value-type-circle = a circle
shared-calculator-label-value-type-color = a color
shared-calculator-label-value-type-directed-angle = a directed angle
shared-calculator-label-value-type-distribution = a distribution
shared-calculator-label-value-type-empty-list = an empty list
shared-calculator-label-value-type-error = an error object
shared-calculator-label-value-type-lambda-point = a parameterized point
shared-calculator-label-value-type-lambda-point3d = a parameterized 3d point
shared-calculator-label-value-type-line = a line
shared-calculator-label-value-type-list-of-3d-points = a list of 3D points
shared-calculator-label-value-type-list-of-angles = a list of angles
shared-calculator-label-value-type-list-of-any = a list of unknown objects
shared-calculator-label-value-type-list-of-arcs = a list of arcs
shared-calculator-label-value-type-list-of-bool = a list of true/false values
shared-calculator-label-value-type-list-of-circles = a list of circles
shared-calculator-label-value-type-list-of-colors = a list of colors
shared-calculator-label-value-type-list-of-directed-angles = a list of directed angles
shared-calculator-label-value-type-list-of-distributions = a list of distributions
shared-calculator-label-value-type-list-of-lambda-point = a list of parameterized points
shared-calculator-label-value-type-list-of-lambda-point3d = a list of parameterized 3d points
shared-calculator-label-value-type-list-of-lines = a list of lines
shared-calculator-label-value-type-list-of-numbers = a list of numbers
shared-calculator-label-value-type-list-of-points = a list of points
shared-calculator-label-value-type-list-of-polygons = a list of polygons
shared-calculator-label-value-type-list-of-rays = a list of rays
shared-calculator-label-value-type-list-of-restrictions = a list of restrictions
shared-calculator-label-value-type-list-of-segment3d = a list of 3d segments
shared-calculator-label-value-type-list-of-segments = a list of segments
shared-calculator-label-value-type-list-of-sphere3d = a list of 3d sphere
shared-calculator-label-value-type-list-of-tone = a list of tones
shared-calculator-label-value-type-list-of-transformations = a list of transformations
shared-calculator-label-value-type-list-of-triangle3d = a list of 3d triangles
shared-calculator-label-value-type-list-of-vector3d = a list of 3d vectors
shared-calculator-label-value-type-list-of-vectors = a list of vectors
shared-calculator-label-value-type-number = a number
shared-calculator-label-value-type-point = a point
shared-calculator-label-value-type-point3d = a 3d point
shared-calculator-label-value-type-polygon = a polygon
shared-calculator-label-value-type-ray = a ray
shared-calculator-label-value-type-restriction = a restriction
shared-calculator-label-value-type-seed = a string
shared-calculator-label-value-type-segment = a segment
shared-calculator-label-value-type-segment3d = a 3d segment
shared-calculator-label-value-type-sphere3d = a 3d sphere
shared-calculator-label-value-type-tone = a tone
shared-calculator-label-value-type-transformation = a transformation
shared-calculator-label-value-type-triangle3d = a 3d triangle
shared-calculator-label-value-type-vector = a vector
shared-calculator-label-value-type-vector3d = a 3d vector
shared-calculator-narration-author-mode = Author Mode
shared-calculator-narration-author-mode-off = Author mode off
shared-calculator-narration-author-mode-on = Author mode on
shared-calculator-narration-braille-mode = Braille Mode
shared-calculator-narration-control-toggle-switch-to-default = { $toggled } selected. Press Enter to switch to { $default }.
shared-calculator-narration-control-toggle-switch-to-toggled = { $default } selected. Press Enter to switch to { $toggled }.
shared-calculator-narration-disable-tool = Disable { $tool } when this condition is true
shared-calculator-narration-display-as-decimal = Displaying as fraction. Press Enter to display as Decimal
shared-calculator-narration-display-as-fraction = Displaying as decimal. Press Enter to display as Fraction
shared-calculator-narration-expression-index = Expression { $index }
shared-calculator-narration-expression-list = Expression List
shared-calculator-narration-hotkey-braille-mode-nemeth = Braille mode Nemeth
shared-calculator-narration-hotkey-braille-mode-off = Braille mode off
shared-calculator-narration-hotkey-braille-mode-ueb = Braille mode UEB
shared-calculator-narration-input-error = input has an error
shared-calculator-narration-item-clickable = { $item } clickable
shared-calculator-narration-item-selected = { $item } selected
shared-calculator-narration-item-unknown = Unknown
shared-calculator-narration-item-unselected = { $item } unselected
shared-calculator-narration-keypad = keypad
shared-calculator-narration-keypad-controlbar = Control Bar
shared-calculator-narration-keypad-key-10-n = Times ten to the power of
shared-calculator-narration-keypad-key-abs = Absolute Value
shared-calculator-narration-keypad-key-action-to = Set Value To
shared-calculator-narration-keypad-key-action-with = Substitute With
shared-calculator-narration-keypad-key-alpha = Alpha
shared-calculator-narration-keypad-key-angle = Angle
shared-calculator-narration-keypad-key-angles = Angles
shared-calculator-narration-keypad-key-ans = Answer
shared-calculator-narration-keypad-key-arc = Arc
shared-calculator-narration-keypad-key-arccos = Inverse Cosine
shared-calculator-narration-keypad-key-arccot = Inverse Cotangent
shared-calculator-narration-keypad-key-arccsc = Inverse Cosecant
shared-calculator-narration-keypad-key-arcsec = Inverse Secant
shared-calculator-narration-keypad-key-arcsin = Inverse Sine
shared-calculator-narration-keypad-key-arctan = Inverse Tangent
shared-calculator-narration-keypad-key-area = Area
shared-calculator-narration-keypad-key-backspace = Backspace
shared-calculator-narration-keypad-key-beta = Beta
shared-calculator-narration-keypad-key-binomialdist = Binomial Distribution
shared-calculator-narration-keypad-key-boxplot = Box Plot
shared-calculator-narration-keypad-key-ceil = Ceiling
shared-calculator-narration-keypad-key-center = Center
shared-calculator-narration-keypad-key-circle = Circle
shared-calculator-narration-keypad-key-corr = Correlation
shared-calculator-narration-keypad-key-cos = Cosine
shared-calculator-narration-keypad-key-cosh = Hyperbolic Cosine
shared-calculator-narration-keypad-key-cot = Cotangent
shared-calculator-narration-keypad-key-coterminal = Coterminal
shared-calculator-narration-keypad-key-coth = Hyperbolic Cotangent
shared-calculator-narration-keypad-key-cov = Co Variance
shared-calculator-narration-keypad-key-covp = Population Co Variance
shared-calculator-narration-keypad-key-csc = Cosecant
shared-calculator-narration-keypad-key-csch = Hyperbolic Cosecant
shared-calculator-narration-keypad-key-cubed = Cubed
shared-calculator-narration-keypad-key-decimal = Decimal
shared-calculator-narration-keypad-key-dilate = Dilate
shared-calculator-narration-keypad-key-directed-angle = Directed Angle
shared-calculator-narration-keypad-key-directed-angles = Directed Angles
shared-calculator-narration-keypad-key-distance = Distance
shared-calculator-narration-keypad-key-divide = Divide
shared-calculator-narration-keypad-key-dotplot = Dot Plot
shared-calculator-narration-keypad-key-enter = Enter
shared-calculator-narration-keypad-key-erf = Error Function
shared-calculator-narration-keypad-key-exp = Exponent
shared-calculator-narration-keypad-key-factorial = Factorial
shared-calculator-narration-keypad-key-floor = Floor
shared-calculator-narration-keypad-key-fraction = A over B
shared-calculator-narration-keypad-key-glider = Glider
shared-calculator-narration-keypad-key-histogram = Histogram
shared-calculator-narration-keypad-key-int = Integral
shared-calculator-narration-keypad-key-intersection = Intersection
shared-calculator-narration-keypad-key-inversecdf = Inverse CDF function
shared-calculator-narration-keypad-key-ittest = Independent T Test
shared-calculator-narration-keypad-key-left-arrow = Left Arrow
shared-calculator-narration-keypad-key-left-bracket = Left Bracket
shared-calculator-narration-keypad-key-left-paren = Left Parenthesis
shared-calculator-narration-keypad-key-line = Line
shared-calculator-narration-keypad-key-ln = Natural Log
shared-calculator-narration-keypad-key-log = Log
shared-calculator-narration-keypad-key-loga = Log A
shared-calculator-narration-keypad-key-mean = Mean
shared-calculator-narration-keypad-key-median = Median
shared-calculator-narration-keypad-key-midpoint = Midpoint
shared-calculator-narration-keypad-key-minus = Minus
shared-calculator-narration-keypad-key-normaldist = Normal Distribution
shared-calculator-narration-keypad-key-nthroot = Nth Root
shared-calculator-narration-keypad-key-parallel = Parallel
shared-calculator-narration-keypad-key-pdf = Probability Density Function
shared-calculator-narration-keypad-key-percent-of = Percent Of
shared-calculator-narration-keypad-key-perimeter = Perimeter
shared-calculator-narration-keypad-key-perpendicular = Perpendicular
shared-calculator-narration-keypad-key-phi = Phi
shared-calculator-narration-keypad-key-pi = Pi
shared-calculator-narration-keypad-key-plus = Plus
shared-calculator-narration-keypad-key-poissondist = Poisson Distribution
shared-calculator-narration-keypad-key-polygon = Polygon
shared-calculator-narration-keypad-key-prime = Function derivative
shared-calculator-narration-keypad-key-product = Product
shared-calculator-narration-keypad-key-quantile = Quantile
shared-calculator-narration-keypad-key-quartile = Quartile
shared-calculator-narration-keypad-key-radius = Radius
shared-calculator-narration-keypad-key-random = Random Number
shared-calculator-narration-keypad-key-ray = Ray
shared-calculator-narration-keypad-key-reciprocal = Reciprocal
shared-calculator-narration-keypad-key-reflect = Reflect
shared-calculator-narration-keypad-key-rho = Rho
shared-calculator-narration-keypad-key-right-arrow = Right Arrow
shared-calculator-narration-keypad-key-right-bracket = Right Bracket
shared-calculator-narration-keypad-key-right-paren = Right Parenthesis
shared-calculator-narration-keypad-key-rotate = Rotate
shared-calculator-narration-keypad-key-round = Round
shared-calculator-narration-keypad-key-sec = Secant
shared-calculator-narration-keypad-key-segment = Segment
shared-calculator-narration-keypad-key-segments = Segments
shared-calculator-narration-keypad-key-shift = Shift
shared-calculator-narration-keypad-key-sin = Sine
shared-calculator-narration-keypad-key-sinh = Hyperbolic Sine
shared-calculator-narration-keypad-key-spearman = Spearman Rank Correlation
shared-calculator-narration-keypad-key-sphere = Sphere
shared-calculator-narration-keypad-key-sqrt = Square Root
shared-calculator-narration-keypad-key-squared = Squared
shared-calculator-narration-keypad-key-stats = Summary statistics
shared-calculator-narration-keypad-key-stdev = Standard Deviation
shared-calculator-narration-keypad-key-stdevp = Standard Deviation of Population
shared-calculator-narration-keypad-key-subscript = Subscript
shared-calculator-narration-keypad-key-sum = Sum
shared-calculator-narration-keypad-key-superscript = Superscript
shared-calculator-narration-keypad-key-supplement = Supplement
shared-calculator-narration-keypad-key-tan = Tangent
shared-calculator-narration-keypad-key-tanh = Hyperbolic Tangent
shared-calculator-narration-keypad-key-tau = Tau
shared-calculator-narration-keypad-key-tdist = Student-t Distribution
shared-calculator-narration-keypad-key-theta = Theta
shared-calculator-narration-keypad-key-times = Times
shared-calculator-narration-keypad-key-toggle-audio-trace = Toggle Audio Trace
shared-calculator-narration-keypad-key-toggle-letters = Toggle Letters
shared-calculator-narration-keypad-key-toggle-numbers = Toggle Numbers
shared-calculator-narration-keypad-key-tone = Tone
shared-calculator-narration-keypad-key-translate = Translate
shared-calculator-narration-keypad-key-triangle = Triangle
shared-calculator-narration-keypad-key-tscore = T Score
shared-calculator-narration-keypad-key-ttest = T Test
shared-calculator-narration-keypad-key-uniformdist = Uniform Distribution
shared-calculator-narration-keypad-key-vector = Vector
shared-calculator-narration-keypad-key-vertices = Vertices
shared-calculator-narration-keypad-key-ythroot = Yth Root
shared-calculator-narration-keypad-plus-minus = Plus-Minus
shared-calculator-narration-math-input-error-message = expression has error
shared-calculator-narration-settings-display-size = Display Size
shared-calculator-narration-settings-display-size-default = Display size: default
shared-calculator-narration-settings-display-size-large = Display size: large
shared-calculator-narration-show-as-decimal = Show as Decimal
shared-calculator-narration-show-as-fraction = Show as Fraction
shared-calculator-narration-six-key-mode-off = Six Key Braille Input off
shared-calculator-narration-six-key-mode-on = Six Key Braille Input on
shared-calculator-text-customize-toolbar = Customize the Toolbar
shared-calculator-text-keyboard-shortcut-add-expression = Add an Expression
shared-calculator-text-keyboard-shortcut-add-folder = Add a Folder
shared-calculator-text-keyboard-shortcut-add-image = Add an Image
shared-calculator-text-keyboard-shortcut-add-note = Add a Note
shared-calculator-text-keyboard-shortcut-add-table = Add a Table
shared-calculator-text-keyboard-shortcut-adjust-playback-speed = Adjust Playback Speed (1 = slowest, 5 = fastest)
shared-calculator-text-keyboard-shortcut-announce-slider-animations = Announce Active Slider Animations
shared-calculator-text-keyboard-shortcut-beginning-of-block = Beginning of Current Block
shared-calculator-text-keyboard-shortcut-beginning-of-expression = Beginning of Current Expression
shared-calculator-text-keyboard-shortcut-close-a-dialog = Close a Dialog
shared-calculator-text-keyboard-shortcut-collapse-all-folders = Collapse All Folders
shared-calculator-text-keyboard-shortcut-collapse-folder = Collapse Selected Folder
shared-calculator-text-keyboard-shortcut-decrease-volume = Decrease Volume
shared-calculator-text-keyboard-shortcut-decrease-x = Decrease X
shared-calculator-text-keyboard-shortcut-decrease-x-larger = Decrease X by Larger Amount
shared-calculator-text-keyboard-shortcut-decrease-y = Decrease Y
shared-calculator-text-keyboard-shortcut-decrease-y-larger = Decrease Y by Larger Amount
shared-calculator-text-keyboard-shortcut-degrees-toggle = Toggle Between Degrees and Radians
shared-calculator-text-keyboard-shortcut-delete-expression = Delete the Expression that has Keyboard Focus
shared-calculator-text-keyboard-shortcut-delete-selection = Delete Selection
shared-calculator-text-keyboard-shortcut-describe-axes = Describe the graph axes
shared-calculator-text-keyboard-shortcut-end-of-block = End of Current Block
shared-calculator-text-keyboard-shortcut-end-of-expression = End of Current Expression
shared-calculator-text-keyboard-shortcut-exit-block = Exit Current Block
shared-calculator-text-keyboard-shortcut-expand-all-folders = Expand All Folders
shared-calculator-text-keyboard-shortcut-expand-folder = Expand Selected Folder
shared-calculator-text-keyboard-shortcut-first-point = First Point
shared-calculator-text-keyboard-shortcut-focus-expression-list = Focus the Expression List
shared-calculator-text-keyboard-shortcut-focus-first-interactive-point = Focus First Interactive Point On Screen
shared-calculator-text-keyboard-shortcut-focus-graph-paper = Focus the Graph Paper
shared-calculator-text-keyboard-shortcut-geometry-add-object-to-selection = Add Object that has Keyboard Focus to Group of Selected Items (when box-select is active)
shared-calculator-text-keyboard-shortcut-geometry-add-object-token-to-selection = Add an Object Token to Selection
shared-calculator-text-keyboard-shortcut-geometry-cancel-active-tool = Cancel Active Tool
shared-calculator-text-keyboard-shortcut-geometry-choose-toolbar-item-and-focus-graph = Select a Tool and Focus the Graph
shared-calculator-text-keyboard-shortcut-geometry-close-token-navigator = Close Token navigator
shared-calculator-text-keyboard-shortcut-geometry-delete-selected-objects = Delete Selected Object(s)
shared-calculator-text-keyboard-shortcut-geometry-describe-object = Describe Object that has Keyboard Focus
shared-calculator-text-keyboard-shortcut-geometry-deselect-all-objects = Deselect All Objects
shared-calculator-text-keyboard-shortcut-geometry-drag-movable-objects = Drag All Movable Objects
shared-calculator-text-keyboard-shortcut-geometry-expression-edit-add-object = Add Object that has Keyboard Focus to Expression
shared-calculator-text-keyboard-shortcut-geometry-expression-edit-complete = Finish Editing and Return to Expression List (When All Required Objects Have Been Added)
shared-calculator-text-keyboard-shortcut-geometry-expression-edit-next-object = Move to Next Valid Object for the Active Expression
shared-calculator-text-keyboard-shortcut-geometry-expression-edit-previous-object = Move to Previous Valid Object for the Active Expression
shared-calculator-text-keyboard-shortcut-geometry-focus-selected-objects-toolbar = Focus the Toolbar for the Selected Object(s)
shared-calculator-text-keyboard-shortcut-geometry-focus-toolbar = Focus the Geometry Toolbar
shared-calculator-text-keyboard-shortcut-geometry-move-between-toolbar-categories = Move Between Categories in the Toolbar
shared-calculator-text-keyboard-shortcut-geometry-move-between-toolbar-dropdown-items = Move Through Tools in a Dropdown
shared-calculator-text-keyboard-shortcut-geometry-move-to-bottom-of-graph = Move to Bottom Edge of Graph
shared-calculator-text-keyboard-shortcut-geometry-move-to-left-of-graph = Move to Left Edge of Graph
shared-calculator-text-keyboard-shortcut-geometry-move-to-right-of-graph = Move to Right Edge of Graph
shared-calculator-text-keyboard-shortcut-geometry-move-to-top-of-graph = Move to Top Edge of Graph
shared-calculator-text-keyboard-shortcut-geometry-move-token-between-expression-list-and-navigator = Move an Object Token Between the Expression List and Navigator
shared-calculator-text-keyboard-shortcut-geometry-navigate-graph = Move to Add Point
shared-calculator-text-keyboard-shortcut-geometry-navigate-object-levels = Navigate Between Object Levels
shared-calculator-text-keyboard-shortcut-geometry-navigate-tokens-at-current-level = Move Between Object Tokens at Current Level
shared-calculator-text-keyboard-shortcut-geometry-next-object = Give Attention to Next Valid Object for the Active Tool
shared-calculator-text-keyboard-shortcut-geometry-open-options = Open Options for the Selected Object(s)
shared-calculator-text-keyboard-shortcut-geometry-open-token-navigator = Open Token navigator
shared-calculator-text-keyboard-shortcut-geometry-open-transformation-options = Open Transformation Options for Selected Object
shared-calculator-text-keyboard-shortcut-geometry-previous-object = Give Attention to Previous Valid Object for the Active Tool
shared-calculator-text-keyboard-shortcut-geometry-repeat-active-tool-prompt = Repeat Active Tool Prompt
shared-calculator-text-keyboard-shortcut-geometry-select-next-category = Select Next Construction Tool Category
shared-calculator-text-keyboard-shortcut-geometry-select-next-tool-within-category = Select Next Tool within Active Category
shared-calculator-text-keyboard-shortcut-geometry-select-previous-category = Select Previous Construction Tool Category
shared-calculator-text-keyboard-shortcut-geometry-select-previous-tool-within-category = Select Previous Tool within Active Category
shared-calculator-text-keyboard-shortcut-geometry-select-single-object-token = Select a Single Object Token
shared-calculator-text-keyboard-shortcut-geometry-select-tool-by-number = Select the nth Construction Tool Category
shared-calculator-text-keyboard-shortcut-hear-graph = Hear Graph
shared-calculator-text-keyboard-shortcut-hear-specific-branch = Hear Only Branch 1 Through 10
shared-calculator-text-keyboard-shortcut-increase-selection-left = Increase Selection Left
shared-calculator-text-keyboard-shortcut-increase-selection-right = Increase Selection Right
shared-calculator-text-keyboard-shortcut-increase-volume = Increase Volume
shared-calculator-text-keyboard-shortcut-increase-x = Increase X
shared-calculator-text-keyboard-shortcut-increase-x-larger = Increase X by Larger Amount
shared-calculator-text-keyboard-shortcut-increase-y = Increase Y
shared-calculator-text-keyboard-shortcut-increase-y-larger = Increase Y by Larger Amount
shared-calculator-text-keyboard-shortcut-keypad-toggle = Show or Hide the Keypad
shared-calculator-text-keyboard-shortcut-last-point = Last Point
shared-calculator-text-keyboard-shortcut-move-to-denominator = Move to Denominator Within Fraction
shared-calculator-text-keyboard-shortcut-move-to-numerator = Move to Numerator Within Fraction
shared-calculator-text-keyboard-shortcut-move-to-origin = Move to Origin
shared-calculator-text-keyboard-shortcut-mute-toggle = Mute or Unmute Audio Playback
shared-calculator-text-keyboard-shortcut-nemeth-mode = Switch to Nemeth
shared-calculator-text-keyboard-shortcut-next-character = Next Character
shared-calculator-text-keyboard-shortcut-next-curve = Move to Next Curve
shared-calculator-text-keyboard-shortcut-next-expression = Move to Next Expression
shared-calculator-text-keyboard-shortcut-next-interactive-point = Go to Next Interactive Point
shared-calculator-text-keyboard-shortcut-next-poi = Next Point of Interest
shared-calculator-text-keyboard-shortcut-next-point = Next Point
shared-calculator-text-keyboard-shortcut-open-a-graph = Open a Graph
shared-calculator-text-keyboard-shortcut-open-expression-options = Open Options for the Expression that has Keyboard Focus
shared-calculator-text-keyboard-shortcut-open-shortcuts-dialog = Open Keyboard Shortcuts Dialog
shared-calculator-text-keyboard-shortcut-previous-character = Previous Character
shared-calculator-text-keyboard-shortcut-previous-curve = Move to Previous Curve
shared-calculator-text-keyboard-shortcut-previous-expression = Move to Previous Expression
shared-calculator-text-keyboard-shortcut-previous-interactive-point = Go to Previous Interactive Point
shared-calculator-text-keyboard-shortcut-previous-poi = Previous Point of Interest
shared-calculator-text-keyboard-shortcut-previous-point = Previous Point
shared-calculator-text-keyboard-shortcut-print-a-graph = Print a Graph
shared-calculator-text-keyboard-shortcut-print-mode = Switch to Print
shared-calculator-text-keyboard-shortcut-redo = Redo
shared-calculator-text-keyboard-shortcut-remove-empty-expression = Remove Selected Empty Expression
shared-calculator-text-keyboard-shortcut-rotate-3d-cube = Rotate Cube in Given Direction (when focused)
shared-calculator-text-keyboard-shortcut-rotate-3d-cube-command = <key>UP ARROW</key>, <key>DOWN ARROW</key>, <key>LEFT ARROW</key>, or <key>RIGHT ARROW</key>
shared-calculator-text-keyboard-shortcut-save-a-graph = Save a Graph
shared-calculator-text-keyboard-shortcut-select-all = Select All
shared-calculator-text-keyboard-shortcut-show-answer-as-decimal-or-fraction = Show Answer as Decimal or Fraction
shared-calculator-text-keyboard-shortcut-show-or-hide-expression = Show or Hide the Selected Expression
shared-calculator-text-keyboard-shortcut-show-or-hide-expression-list = Show or Hide the Expression List
shared-calculator-text-keyboard-shortcut-slider-decrease = Decrease Value
shared-calculator-text-keyboard-shortcut-slider-decrease-larger = Decrease Value by Larger Increment
shared-calculator-text-keyboard-shortcut-slider-increase = Increase Value
shared-calculator-text-keyboard-shortcut-slider-increase-larger = Increase Value by Larger Increment
shared-calculator-text-keyboard-shortcut-slider-maximum = Highest Value
shared-calculator-text-keyboard-shortcut-slider-minimum = Lowest Value
shared-calculator-text-keyboard-shortcut-slider-trace-decrease = Decrease Value of Selected Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-decrease-larger = Decrease Value of Selected Slider by Larger Increment When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-increase = Increase Value of Selected Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-increase-larger = Increase Value of Selected Slider by Larger Increment When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-maximum = Move to Highest Value of Selected Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-minimum = Move to Lowest Value of Selected Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-next-slider = Select Next Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-previous-slider = Select Previous Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-speak-answer = Speak Answer
shared-calculator-text-keyboard-shortcut-speak-branch = Speak Branch
shared-calculator-text-keyboard-shortcut-speak-color = Speak Color
shared-calculator-text-keyboard-shortcut-speak-focused-block = Speak Block that has Keyboard Focus
shared-calculator-text-keyboard-shortcut-speak-label = Speak Label
shared-calculator-text-keyboard-shortcut-speak-left-adjacent-block = Speak Left-Adjacent Block
shared-calculator-text-keyboard-shortcut-speak-parent-block = Speak Parent Block
shared-calculator-text-keyboard-shortcut-speak-poi-count = Speak Point of Interest Count
shared-calculator-text-keyboard-shortcut-speak-point-type = Speak Type of Selected Point
shared-calculator-text-keyboard-shortcut-speak-right-adjacent-block = Speak Right-Adjacent Block
shared-calculator-text-keyboard-shortcut-speak-selection = Speak Selection
shared-calculator-text-keyboard-shortcut-speak-x = Speak X Coordinate
shared-calculator-text-keyboard-shortcut-speak-y = Speak Y Coordinate
shared-calculator-text-keyboard-shortcut-spin-3d-cube = Spin Cube in Given Direction (when focused)
shared-calculator-text-keyboard-shortcut-spin-3d-cube-command = Press and hold <key>UP ARROW</key>, <key>DOWN ARROW</key>, <key>LEFT ARROW</key>, or <key>RIGHT ARROW</key>
shared-calculator-text-keyboard-shortcut-summarize-graph = Summarize Selected Curve
shared-calculator-text-keyboard-shortcut-switch-pane-in-3d-quest = Move Between Expression List and Quest Instruction Pane
shared-calculator-text-keyboard-shortcut-table-first-column = First Column in Row
shared-calculator-text-keyboard-shortcut-table-first-row = First Row in Column
shared-calculator-text-keyboard-shortcut-table-last-column = Last Column in Row
shared-calculator-text-keyboard-shortcut-table-last-row = Last Row in Column
shared-calculator-text-keyboard-shortcut-table-next-cell = Next Cell
shared-calculator-text-keyboard-shortcut-table-next-column = Next Column
shared-calculator-text-keyboard-shortcut-table-next-row = Next Row
shared-calculator-text-keyboard-shortcut-table-previous-cell = Previous Cell
shared-calculator-text-keyboard-shortcut-table-previous-column = Previous Column
shared-calculator-text-keyboard-shortcut-table-previous-row = Previous Row
shared-calculator-text-keyboard-shortcut-table-speak-column-header = Speak Column Header
shared-calculator-text-keyboard-shortcut-toggle-account-menu = Open or Close the Account Menu
shared-calculator-text-keyboard-shortcut-toggle-audio-trace = Enable or Disable Audio Trace Mode
shared-calculator-text-keyboard-shortcut-toggle-author-mode = Toggle Author Mode Features
shared-calculator-text-keyboard-shortcut-toggle-braille-typing = Turn Braille Typing On or Off
shared-calculator-text-keyboard-shortcut-toggle-edit-list-mode = Turn Edit List Mode On or Off
shared-calculator-text-keyboard-shortcut-toggle-graph-settings-menu = Open or Close the Graph Settings Menu
shared-calculator-text-keyboard-shortcut-toggle-help-menu = Open or Close the Help Menu
shared-calculator-text-keyboard-shortcut-toggle-language-menu = Open or Close the Language Menu
shared-calculator-text-keyboard-shortcut-toggle-share-menu = Open or Close the Share Menu
shared-calculator-text-keyboard-shortcut-toggle-slider-trace = Toggle Slider Trace Mode
shared-calculator-text-keyboard-shortcut-ueb-mode = Switch to UEB
shared-calculator-text-keyboard-shortcut-undo = Undo
shared-calculator-text-keyboard-shortcut-zoom-fit = Zoom to Fit
shared-calculator-text-keyboard-shortcut-zoom-in = Zoom In
shared-calculator-text-keyboard-shortcut-zoom-out = Zoom Out
shared-calculator-text-keyboard-shortcut-zoom-restore-default = Restore Default Viewport
shared-calculator-text-search-results =
    { $count ->
        [0] No results.
        [one] 1 result.
       *[other] { $count } results.
    }
shared-label-email = Email
shared-label-family-name = Last Name (optional)
shared-label-given-name-or-nickname = First Name or Nickname
shared-label-name = Name
shared-label-new-email-address = New Email Address
shared-label-opens-in-new-tab-suffix = { $title } (opens in new tab)
shared-label-password = Password
shared-label-to = to
shared-message-account-reactivated = You previously requested to delete your account, but because you logged back in within 30 days, we will not delete your account. Welcome back!
shared-message-change-password-email-sent = We will send a link to your email address ({ $emailAddress }) so you can change your password.
shared-message-check-email-for-delete-link = Please check your email ({ $emailAddress }) for the link to delete your account.
shared-message-check-email-for-link = Please check { $emailAddress } for the Change Email link.
shared-message-check-email-for-password-link = Please check your email ({ $emailAddress }) for the link to change your password.
shared-message-check-email-for-password-recovery-link = Message sent. Please check your email for a password recovery link.
shared-message-consent-text = I agree to let Desmos store and maintain the information I provide (e.g. login credentials, saved work) in order to provide and improve its service. To withdraw consent, you may delete your account at any time.
shared-message-cookie-notice = <1>Note:</1> Desmos uses cookies to enable persistence when you are signed in. If you do not wish to use cookies, please use Desmos without logging in. <2>Learn More.</2>
shared-message-delete-account-notice = When you delete your account, <1>we will retain your data for 30 days.</1> You can reactivate your account at any time during those 30 days by logging back in. If there's something about Desmos we can improve, please <2>let us know.</2>
shared-message-delete-account-will-send-email = We will send you a link to your email address ({ $email }) so you can delete your account.
shared-message-email-sent = Email sent
shared-message-email-settings-will-send-email = We will send a Change Email link to { $emailAddress }.
shared-message-google-login-not-available = Google Login is not available on this device.
shared-message-information-saved = Saved!
shared-message-or-login-with-desmos = Or log in with Desmos
shared-message-please-review-name = We tried to split your name into first and last name. Please review your name below and edit any mistakes.
shared-message-privacy-notice = I have read, understand, and accept the <1>Terms of Service</1> and <2>Privacy Policy</2>.
shared-message-set-new-email-address = Set a new email address and password.
shared-prompt-already-have-account = Already have a Desmos account?
shared-prompt-enter-email-for-password-recovery-link = Enter your email address to get a password recovery link.
shared-prompt-forgot-your-password = Forgot your password?
shared-prompt-new-to-desmos-sign-up-here = New to Desmos? <1>Sign up</1>.
shared-prompt-new-to-desmos-teacher-or-student = New to Desmos? <1>Sign up!</1>
shared-prompt-please-consent-to-sign-up-with-apple = Please consent above to sign up with Apple
shared-prompt-please-consent-to-sign-up-with-google = Please consent above to sign up with Google
shared-prompt-sign-up-with-apple = Sign up with Apple
shared-prompt-sign-up-with-google = Sign up with Google
shared-title-account-reactivated = Your account has been reactivated.
shared-title-account-settings = Account Settings
shared-title-change-email-address = Change your Desmos email address
shared-title-change-password-narrow = Password
shared-title-change-password-wide = Change Password
shared-title-delete-account = Are you sure you want to delete your account?
shared-title-email-settings = Email
shared-title-language-menu = Language
shared-title-login = Log In
shared-title-profile-information-narrow = Profile
shared-title-profile-information-wide = Profile Information
shared-title-recover-password = Recover Password
shared-title-signup = Sign-Up
basic-calculator-button-controlbar-abc = abc
basic-calculator-button-controlbar-clear = clear
basic-calculator-button-controlbar-clear-all = clear all
basic-calculator-button-controlbar-func = func
basic-calculator-button-controlbar-main = main
basic-calculator-button-turn-braille-mode-off = Turn { $mode } off
basic-calculator-error-fractions-unavailable = Fractions are not available in the current calculator.
basic-calculator-heading-braille-table-type-this = Type this
basic-calculator-heading-braille-table-typeset = Typeset
basic-calculator-label-answer-hint = Your answers show up on this side.
basic-calculator-label-controlbar-deg = deg
basic-calculator-label-controlbar-rad = rad
basic-calculator-label-convert-to-decimal = Convert to decimal.
basic-calculator-label-convert-to-fraction = Convert to fraction.
basic-calculator-label-reverse-contrast = Reverse Contrast
basic-calculator-link-download-braille-equations = Download Braille Equations
basic-calculator-link-view-braille-examples = View more examples
basic-calculator-narration-calc-description-fourfunction = Desmos Four-Function Calculator
basic-calculator-narration-calc-description-scientific = Desmos Scientific Calculator
basic-calculator-narration-controlbar-abc = A B C
basic-calculator-narration-controlbar-backspace = backspace
basic-calculator-narration-controlbar-clear = clear
basic-calculator-narration-controlbar-clear-all = clear all
basic-calculator-narration-controlbar-degrees = Degrees
basic-calculator-narration-controlbar-functions = Functions
basic-calculator-narration-controlbar-main = main
basic-calculator-narration-controlbar-radians = Radians
basic-calculator-narration-controlbar-redo = Redo
basic-calculator-narration-controlbar-settings = settings
basic-calculator-narration-controlbar-undo = Undo
basic-calculator-narration-convert-to-decimal = Displaying as fraction. Press Enter to display as Decimal
basic-calculator-narration-convert-to-fraction = Displaying as decimal. Press Enter to display as Fraction
basic-calculator-narration-hotkey-six-key-input-off = Six Key Braille Input off
basic-calculator-narration-hotkey-six-key-input-on = Six Key Braille Input on
basic-calculator-text-braille-mode-is-on = { $mode } is on!
basic-calculator-text-how-to-type-braille = Use a Refreshable Braille display, or just type Braille with a keyboard.
geometry-label-construct-instruction = Click down here to construct
geometry-label-pick-tool-instruction = Pick a tool to get started
graphing-calculator-button-audio-trace-hear-graph = Hear Graph
graphing-calculator-button-audio-trace-stop-graph = Stop Graph
graphing-calculator-button-change-image = Change Image
graphing-calculator-button-clear-graph = Delete All
graphing-calculator-button-done = Done
graphing-calculator-button-draggable = Draggable
graphing-calculator-button-edit-graph-on-desmos-logo = edit graph on
graphing-calculator-button-editable-math = Editable Math
graphing-calculator-button-editable-text = Editable Text
graphing-calculator-button-find-cdf = Find Cumulative Probability (CDF)
graphing-calculator-button-funcs = funcs
graphing-calculator-button-functions = functions
graphing-calculator-button-functions-menu-custom-colors = Custom Colors
graphing-calculator-button-functions-menu-number-theory = Number Theory
graphing-calculator-button-geometry-label-points-checkbox = Label Points
graphing-calculator-button-hide-folder-from-students-2 = Hide this folder from students.
graphing-calculator-button-keypad-audio-trace-off = Audio Trace Off
graphing-calculator-button-keypad-describe-axes = Describe Axes
graphing-calculator-button-keypad-describe-curve = Describe Curve
graphing-calculator-button-keypad-describe-curve-short = Curve
graphing-calculator-button-keypad-describe-point = Describe Point
graphing-calculator-button-keypad-describe-point-short = Point
graphing-calculator-button-label = Label
graphing-calculator-button-label-editable = Editable
graphing-calculator-button-label-show-on-hover = Show on hover
graphing-calculator-button-label-text-outline = Text outline
graphing-calculator-button-load-image-retry = Retry.
graphing-calculator-button-move-to-folder-action = Move
graphing-calculator-button-place-image-behind-graphs = Place behind graphs
graphing-calculator-button-regression-log-mode = Log Mode
graphing-calculator-button-regression-plot-residuals = plot
graphing-calculator-button-replace = Replace
graphing-calculator-button-reset-graph = Reset
graphing-calculator-button-settings-degrees = Degrees
graphing-calculator-button-settings-radians = Radians
graphing-calculator-button-settings-zoom-square = Zoom Square
graphing-calculator-button-share-graph-link-copy = Copy
graphing-calculator-button-show-all-table-rows = Show all
graphing-calculator-button-slider-add-all-variables = all
graphing-calculator-button-visual-parameters-binned = Binned
graphing-calculator-button-visual-parameters-center = Center
graphing-calculator-button-visual-parameters-count = Count
graphing-calculator-button-visual-parameters-density = Density
graphing-calculator-button-visual-parameters-exact = Exact
graphing-calculator-button-visual-parameters-exclude-outliers = Exclude Outliers
graphing-calculator-button-visual-parameters-left = Left
graphing-calculator-button-visual-parameters-relative = Relative
graphing-calculator-error-equation-contains-unresolved-details = This plot contains fine detail that has not been fully resolved.
graphing-calculator-error-expression-replacement = Replacement must be a valid function or variable name.
graphing-calculator-error-expression-search = Can only rename a valid function or variable name.
graphing-calculator-error-failed-to-load-image = Failed to load image.
graphing-calculator-error-image-invalid-angle = Invalid angle. Try using any number.
graphing-calculator-error-image-invalid-center = Invalid center. Try, for example, (0,0).
graphing-calculator-error-image-invalid-file = The file "{ $file }" is not an image
graphing-calculator-error-image-invalid-height = Invalid height. Try using any number.
graphing-calculator-error-image-invalid-opacity = Invalid opacity. Try using any number.
graphing-calculator-error-image-invalid-width = Invalid width. Try using any number.
graphing-calculator-error-log-axes-image = Cannot plot images on a log scale.
graphing-calculator-error-tone-frequency-out-of-range = Tones can only play for frequencies between { $min }Hz and { $max }Hz.
graphing-calculator-heading-advanced = Advanced
graphing-calculator-heading-audio-trace-describe = Describe
graphing-calculator-heading-audio-trace-navigation = Navigation
graphing-calculator-heading-audio-trace-screen-reader = Screen Reader
graphing-calculator-heading-calculus = Calculus
graphing-calculator-heading-clickable = Clickable
graphing-calculator-heading-dist-tab-distributions = Distributions
graphing-calculator-heading-dist-tab-visualizations = Visualizations
graphing-calculator-heading-drag = Drag
graphing-calculator-heading-fill = Fill
graphing-calculator-heading-functions-menu-advanced = Advanced
graphing-calculator-heading-functions-menu-polar = Polar Coordinates
graphing-calculator-heading-functions-menu-sound = Sound
graphing-calculator-heading-geometry = Geometry
graphing-calculator-heading-geometry-measurements = Properties & Measurements
graphing-calculator-heading-geometry-tools = Geometry Tools
graphing-calculator-heading-geometry-transformations = Transformations
graphing-calculator-heading-hyperbolic-trig = Hyperbolic Trig Functions
graphing-calculator-heading-image-opacity = Opacity
graphing-calculator-heading-inverse-trig = Inverse Trig Functions
graphing-calculator-heading-keypad-audio-trace-point-of-interest = <1>Point</1><2>of Interest</2>
graphing-calculator-heading-label = Label
graphing-calculator-heading-label-orientation = Orientation
graphing-calculator-heading-lines = Lines
graphing-calculator-heading-lists = List Operations
graphing-calculator-heading-points = Points
graphing-calculator-heading-quest = Quest: { $title }
graphing-calculator-heading-quests = Quests
graphing-calculator-heading-regression-parameters = Parameters
graphing-calculator-heading-regression-residuals = Residuals
graphing-calculator-heading-regression-statistics = Statistics
graphing-calculator-heading-slider-animation-mode = Animation Mode
graphing-calculator-heading-slider-speed = Speed
graphing-calculator-heading-stat-tests = Statistical Tests
graphing-calculator-heading-stats = Statistics
graphing-calculator-heading-style = Style
graphing-calculator-heading-surfaces = Surfaces
graphing-calculator-heading-trig = Trig Functions
graphing-calculator-heading-visual-parameters-bar-heights = Bar Heights
graphing-calculator-heading-visual-parameters-bin-alignment = Bin Alignment
graphing-calculator-heading-visual-parameters-display-properties = Display Properties
graphing-calculator-heading-visual-parameters-x-values = X Values
graphing-calculator-label-add-depressed-image-tooltip = Add Depressed Image
graphing-calculator-label-add-hovered-image-tooltip = Add Hovered Image
graphing-calculator-label-add-item-tooltip = Add Item
graphing-calculator-label-add-slider = add slider:
graphing-calculator-label-angle-tooltip = Angle
graphing-calculator-label-animation-properties-tooltip = Animation Properties
graphing-calculator-label-audio-trace-curve = Curve
graphing-calculator-label-audio-trace-need-screen-reader = Your Screen Reader needs to be on to hear these.
graphing-calculator-label-audio-trace-point = Point
graphing-calculator-label-audio-trace-speed = Speed
graphing-calculator-label-audio-trace-volume = Volume
graphing-calculator-label-axes = Axes
graphing-calculator-label-braille-nemeth = Braille Nemeth
graphing-calculator-label-braille-size-etc11 = ETC Romeo/Juliet (11.5 x 11 in)
graphing-calculator-label-braille-size-etc8 = ETC Romeo/Juliet (8.5 x 11 in)
graphing-calculator-label-braille-size-vpmax11 = VP Max (11.5 x 11 in)
graphing-calculator-label-braille-size-vpmax8 = VP Max (8.5 x 11 in)
graphing-calculator-label-braille-ueb = Braille UEB
graphing-calculator-label-cdf-maximum = Max:
graphing-calculator-label-cdf-minimum = Min:
graphing-calculator-label-change-depressed-image-tooltip = Change Depressed Image
graphing-calculator-label-change-hovered-image-tooltip = Change Hovered Image
graphing-calculator-label-convert-to-table-tooltip = Convert to Table
graphing-calculator-label-create-table = Create Table
graphing-calculator-label-depressed = Depressed
graphing-calculator-label-disable-graph-interactions = Disable Graph Interactions
graphing-calculator-label-disable-zoom = Disable zooming
graphing-calculator-label-display-properties = Local Display Preferences
graphing-calculator-label-drop-image-here = Drop Image Here
graphing-calculator-label-duplicate-expression-tooltip = Duplicate
graphing-calculator-label-edit-graph-bounds = Graph Bounds
graphing-calculator-label-edit-list-tooltip = Edit List
graphing-calculator-label-evaluation-list = { $count } element list
graphing-calculator-label-example-graph-3d-world = 3D World
graphing-calculator-label-example-graph-calculus-derivatives = Calculus: Derivatives
graphing-calculator-label-example-graph-calculus-fundamental-theorem-of-calculus = Calculus: Fundamental Theorem of Calculus
graphing-calculator-label-example-graph-calculus-integral-with-adjustable-bounds = Calculus: Integral with adjustable bounds
graphing-calculator-label-example-graph-calculus-integrals = Calculus: Integrals
graphing-calculator-label-example-graph-calculus-secant-line = Calculus: Secant Line
graphing-calculator-label-example-graph-calculus-tangent-line = Calculus: Tangent Line
graphing-calculator-label-example-graph-calculus-taylor-expansion-of-sin-x = Calculus: Taylor Expansion of sin(x)
graphing-calculator-label-example-graph-checkerboard-inversion = Checkerboard Inversion
graphing-calculator-label-example-graph-conic-sections-circle = Conic Sections: Circle
graphing-calculator-label-example-graph-conic-sections-ellipse-with-foci = Conic Sections: Ellipse with Foci
graphing-calculator-label-example-graph-conic-sections-hyperbola = Conic Sections: Hyperbola
graphing-calculator-label-example-graph-conic-sections-parabola-and-focus = Conic Sections: Parabola and Focus
graphing-calculator-label-example-graph-fastest-path-to-a-point = Fastest Path to a Point
graphing-calculator-label-example-graph-fireworks = Fireworks!
graphing-calculator-label-example-graph-fractal-valentine = Fractal Valentine
graphing-calculator-label-example-graph-lines-point-slope-form = Lines: Point Slope Form
graphing-calculator-label-example-graph-lines-slope-intercept-form = Lines: Slope Intercept Form
graphing-calculator-label-example-graph-lines-two-point-form = Lines: Two Point Form
graphing-calculator-label-example-graph-lists-curve-stitching = Lists: Curve Stitching
graphing-calculator-label-example-graph-lists-family-of-sin-curves = Lists: Family of sin Curves
graphing-calculator-label-example-graph-lists-plotting-a-list-of-points = Lists: Plotting a List of Points
graphing-calculator-label-example-graph-outstretched-arm = Outstretched Arm
graphing-calculator-label-example-graph-pac-man = Pac Man
graphing-calculator-label-example-graph-parabolas-standard-form = Parabolas: Standard Form
graphing-calculator-label-example-graph-parabolas-standard-form-plus-tangent = Parabolas: Standard Form + Tangent
graphing-calculator-label-example-graph-parabolas-vertex-form = Parabolas: Vertex Form
graphing-calculator-label-example-graph-parametric-cycloid = Parametric: Cycloid
graphing-calculator-label-example-graph-parametric-introduction = Parametric: Introduction
graphing-calculator-label-example-graph-polar-conic-sections = Polar: Conic Sections
graphing-calculator-label-example-graph-polar-limacon = Polar: Limacon
graphing-calculator-label-example-graph-polar-logarithmic-spiral = Polar: Logarithmic Spiral
graphing-calculator-label-example-graph-polar-rose = Polar: Rose
graphing-calculator-label-example-graph-pride-flag = PRIDE flag
graphing-calculator-label-example-graph-regular-sine-wave = Regular Sine Wave?
graphing-calculator-label-example-graph-stats-anscombes-quartet = Statistics: Anscombe's Quartet
graphing-calculator-label-example-graph-stats-fourth-order-polynomial = Statistics: 4th Order Polynomial
graphing-calculator-label-example-graph-stats-linear-regression = Statistics: Linear Regression
graphing-calculator-label-example-graph-transformations-inverse-of-a-function = Transformations: Inverse of a Function
graphing-calculator-label-example-graph-transformations-scaling-a-function = Transformations: Scaling a Function
graphing-calculator-label-example-graph-transformations-translating-a-function = Transformations: Translating a Function
graphing-calculator-label-example-graph-trig-period-and-amplitude = Trigonometry: Period and Amplitude
graphing-calculator-label-example-graph-trig-phase = Trigonometry: Phase
graphing-calculator-label-example-graph-trig-unit-circle = Trigonometry: Unit Circle
graphing-calculator-label-example-graph-trig-wave-interference = Trigonometry: Wave Interference
graphing-calculator-label-expression-delete-tooltip = Delete
graphing-calculator-label-expression-lowercase = expression
graphing-calculator-label-extend-to-3d = Extend to 3D
graphing-calculator-label-folder-lowercase = folder
graphing-calculator-label-geometry-move-to-folder-placeholder = Folder name
graphing-calculator-label-geometry-tools = Geometry Tools
graphing-calculator-label-geometry-tools-dropdown-menu-angle = Angle tools
graphing-calculator-label-geometry-tools-dropdown-menu-circle = Circle tools
graphing-calculator-label-geometry-tools-dropdown-menu-line = Line tools
graphing-calculator-label-geometry-tools-dropdown-menu-point = Point tools
graphing-calculator-label-geometry-tools-dropdown-menu-polygon = Polygon tools
graphing-calculator-label-geometry-tools-dropdown-menu-selection = Selection tools
graphing-calculator-label-geometry-tools-dropdown-menu-transformation = Transformation tools
graphing-calculator-label-geometry-tools-open-dropdown-menu-transformation = Open { $item } menu
graphing-calculator-label-hide-expression-list-tooltip = Hide Expression List
graphing-calculator-label-hide-keypad = Hide Keypad
graphing-calculator-label-hovered = Hovered
graphing-calculator-label-image-angle = Angle:
graphing-calculator-label-image-center = Center:
graphing-calculator-label-image-height = Height:
graphing-calculator-label-image-lowercase = image
graphing-calculator-label-image-opacity = Opacity:
graphing-calculator-label-image-width = Width:
graphing-calculator-label-label-size-tooltip = Label Scale Factor
graphing-calculator-label-line-thickness-3d-tooltip = Line Thickness
graphing-calculator-label-line-thickness-tooltip = Line Thickness (px)
graphing-calculator-label-list-index = Use <1>index</1> to reference the clicked index in the list.
graphing-calculator-label-lock-expression-tooltip = Prevent Editing
graphing-calculator-label-more-viewport-options = More Options
graphing-calculator-label-new-transformation = New Transformation
graphing-calculator-label-note-lowercase = note
graphing-calculator-label-opacity-tooltip = Opacity (0 to 1)
graphing-calculator-label-open-graph-tooltip = Open Graph
graphing-calculator-label-open-graph-with-shortcut-tooltip = Open Graph (CTRL+O)
graphing-calculator-label-png = PNG
graphing-calculator-label-poi-unknown = unknown coordinates
graphing-calculator-label-point-size-3d-tooltip = Point Size
graphing-calculator-label-point-size-tooltip = Point Size (px)
graphing-calculator-label-powered-by = powered by
graphing-calculator-label-randomize-tooltip = Randomize
graphing-calculator-label-recent-transformations = Recent Transformations
graphing-calculator-label-recenter = Center Origin
graphing-calculator-label-redo-tooltip = Redo
graphing-calculator-label-redo-with-shortcut-tooltip = Redo (CTRL+Y)
graphing-calculator-label-reference-count =
    { $count ->
        [one] (1 reference)
       *[other] ({ $count } references)
    }
graphing-calculator-label-reference-count-in-folder =
    { $count ->
        [one] (1 reference in folder)
       *[other] ({ $count } references in folder)
    }
graphing-calculator-label-regression-log-mode-help-tooltip = Log mode help
graphing-calculator-label-regression-parameters-not-exact = Parameters might not be exact. Click to learn more.
graphing-calculator-label-regression-what-is-rmse-tooltip = What is RMSE? Click to learn more.
graphing-calculator-label-regression-why-is-negative-tooltip = Why is this negative? Click to learn more.
graphing-calculator-label-remove-depressed-image = Remove depressed image
graphing-calculator-label-remove-hovered-image = Remove hovered image
graphing-calculator-label-rename = rename
graphing-calculator-label-resolution-tooltip = 3D Grid Sample Resolution
graphing-calculator-label-search-expressions = Search this graph
graphing-calculator-label-settings-3d-perspective-distortion-ratio = Perspective Distortion Ratio
graphing-calculator-label-settings-3d-perspective-max = Most distortion (Perspective view)
graphing-calculator-label-settings-3d-perspective-min = No distortion (Orthographic view)
graphing-calculator-label-settings-all-axes = All axes:
graphing-calculator-label-settings-arrows = Arrows
graphing-calculator-label-settings-axis-labels-3d = Labels
graphing-calculator-label-settings-axis-numbers = Axis Numbers
graphing-calculator-label-settings-domain-plane = XY plane
graphing-calculator-label-settings-grid = Grid
graphing-calculator-label-settings-hidden-objects = Reveal { $count } hidden objects
graphing-calculator-label-settings-lock-viewport = Lock Viewport
graphing-calculator-label-settings-minor-gridlines = Minor Gridlines
graphing-calculator-label-settings-numbers-3d = Numbers
graphing-calculator-label-settings-one-quadrant = One Quadrant
graphing-calculator-label-settings-reverse-contrast = Reverse contrast
graphing-calculator-label-settings-six-key-braille = Six Key Braille Input
graphing-calculator-label-settings-step = Step:
graphing-calculator-label-settings-translucent-surfaces = Translucent surfaces
graphing-calculator-label-settings-x-axis = X-Axis
graphing-calculator-label-settings-y-axis = Y-Axis
graphing-calculator-label-show-keypad = Show Keypad
graphing-calculator-label-slider-disabled-while-ticker-playing = Sliders are disabled while the ticker is running.
graphing-calculator-label-slider-step = Step:
graphing-calculator-label-svg = SVG
graphing-calculator-label-table-lowercase = table
graphing-calculator-label-ticker-close = cancel
graphing-calculator-label-ticker-help-tooltip = On slow computers, this might run slower. Use local variable "dt" to capture the actual update speed.
graphing-calculator-label-ticker-lowercase = ticker
graphing-calculator-label-ticker-min-step = Min Step Time
graphing-calculator-label-ticker-pause = pause
graphing-calculator-label-ticker-play = play
graphing-calculator-label-tooltip-geometry-settings = Geometry Settings
graphing-calculator-label-tooltip-graph-settings = Graph Settings
graphing-calculator-label-tooltip-open-graph = Open Graph
graphing-calculator-label-tooltip-reset = Reset
graphing-calculator-label-tooltip-show-list = Show List
graphing-calculator-label-tooltip-viewport-default = Default Viewport
graphing-calculator-label-tooltip-zoom-default-orientation = Default Orientation
graphing-calculator-label-tooltip-zoom-in = Zoom In
graphing-calculator-label-tooltip-zoom-out = Zoom Out
graphing-calculator-label-tooltip-zoom-xy-orientation = XY Orientation
graphing-calculator-label-undo-tooltip = Undo
graphing-calculator-label-undo-with-shortcut-tooltip = Undo (CTRL+Z)
graphing-calculator-label-unlock-expression-tooltip = Allow Editing
graphing-calculator-label-update-on-click = On click:
graphing-calculator-link-edit-on-desmos = edit graph on
graphing-calculator-link-learn-more = Learn more.
graphing-calculator-link-view-braille-examples = View examples
graphing-calculator-narration-3d-graphpaper-label = three-dimensional graph paper
graphing-calculator-narration-3d-orientation-options-label = Orientation
graphing-calculator-narration-3d-rotate-down = Tilt forward.
graphing-calculator-narration-3d-rotate-left = Rotate left.
graphing-calculator-narration-3d-rotate-right = Rotate right.
graphing-calculator-narration-3d-rotate-up = Tilt backward.
graphing-calculator-narration-3d-rotation-speed = Speed { $speed } \xB0 per second
graphing-calculator-narration-3d-rotation-stopped = Stopped.
graphing-calculator-narration-add-expression = Add expression
graphing-calculator-narration-add-folder = Add folder
graphing-calculator-narration-add-image = Add image
graphing-calculator-narration-add-item-menu = Add Item Menu
graphing-calculator-narration-add-note = Add note
graphing-calculator-narration-add-slider-prompt = Add slider for { $vars }
graphing-calculator-narration-add-table = Add table
graphing-calculator-narration-add-ticker = Add Ticker
graphing-calculator-narration-all-folders-collapsed = all folders collapsed
graphing-calculator-narration-all-folders-expanded = all folders expanded
graphing-calculator-narration-audio-instructions-enter-audio-trace-mac = Press OPTION+T for audio trace.
graphing-calculator-narration-audio-instructions-enter-audio-trace-windows = Press ALT+T for audio trace.
graphing-calculator-narration-audio-trace-branch-not-found = Branch { $branch } does not exist.
graphing-calculator-narration-audio-trace-cannot-change-slider-value = Unable to adjust slider
graphing-calculator-narration-audio-trace-description-branch-count = Branches: { $branches }.
graphing-calculator-narration-audio-trace-description-color = Color: { $color }.
graphing-calculator-narration-audio-trace-description-multiple-extrema = { $count } extrema.
graphing-calculator-narration-audio-trace-description-multiple-intercepts = { $count } intercepts.
graphing-calculator-narration-audio-trace-description-multiple-intersections = { $count } intersections.
graphing-calculator-narration-audio-trace-description-multiple-labels = { $count } point labels.
graphing-calculator-narration-audio-trace-description-multiple-roots = { $count } zero crossings.
graphing-calculator-narration-audio-trace-description-no-curve-selected = No curve selected.
graphing-calculator-narration-audio-trace-description-one-extremum = 1 extremum.
graphing-calculator-narration-audio-trace-description-one-intercept = 1 intercept.
graphing-calculator-narration-audio-trace-description-one-intersection = 1 intersection.
graphing-calculator-narration-audio-trace-description-one-label = 1 point label.
graphing-calculator-narration-audio-trace-description-one-root = 1 zero crossing.
graphing-calculator-narration-audio-trace-description-shading-above = Shading above.
graphing-calculator-narration-audio-trace-description-shading-below = Shading below.
graphing-calculator-narration-audio-trace-description-shading-in-regions = Shading in regions.
graphing-calculator-narration-audio-trace-description-shading-left = Shading on the left.
graphing-calculator-narration-audio-trace-description-shading-right = Shading on the right.
graphing-calculator-narration-audio-trace-description-visible-grid = Grid lines are visible.
graphing-calculator-narration-audio-trace-description-visible-x-axis = X axis visible.
graphing-calculator-narration-audio-trace-description-visible-x-axis-and-label = X axis visible and is labeled { $label }.
graphing-calculator-narration-audio-trace-description-visible-x-axis-range = X axis visible from { $xmin } to { $xmax }.
graphing-calculator-narration-audio-trace-description-visible-x-axis-range-and-label = X axis visible from { $xmin } to { $xmax } and is labeled { $label }.
graphing-calculator-narration-audio-trace-description-visible-xyz-axis-range = X Y and Z axes visible from { $xmin } to { $xmax }.
graphing-calculator-narration-audio-trace-description-visible-y-axis = Y axis visible.
graphing-calculator-narration-audio-trace-description-visible-y-axis-and-label = Y axis visible and is labeled { $label }.
graphing-calculator-narration-audio-trace-description-visible-y-axis-range = Y axis visible from { $ymin } to { $ymax }.
graphing-calculator-narration-audio-trace-description-visible-y-axis-range-and-label = Y axis visible from { $ymin } to { $ymax } and is labeled { $label }.
graphing-calculator-narration-audio-trace-description-visible-z-axis = Z axis visible.
graphing-calculator-narration-audio-trace-description-visible-z-axis-and-label = Z axis visible and is labeled { $label }.
graphing-calculator-narration-audio-trace-description-visible-z-axis-range = Z axis visible from { $zmin } to { $zmax }.
graphing-calculator-narration-audio-trace-description-visible-z-axis-range-and-label = Z axis visible from { $zmin } to { $zmax } and is labeled { $label }.
graphing-calculator-narration-audio-trace-expression-with-column = Expression { $index } column { $column }
graphing-calculator-narration-audio-trace-first-point = First point
graphing-calculator-narration-audio-trace-first-slider = First slider.
graphing-calculator-narration-audio-trace-instructions-disable-mac = To disable audio trace, press OPTION+T.
graphing-calculator-narration-audio-trace-instructions-disable-windows = To disable audio trace, press ALT+T.
graphing-calculator-narration-audio-trace-instructions-expression-navigation-mac = To move between expressions, press COMMAND+Up-Arrow or COMMAND+Down-Arrow.
graphing-calculator-narration-audio-trace-instructions-expression-navigation-windows = To move between expressions, press ALT+Up-Arrow or ALT+Down-Arrow.
graphing-calculator-narration-audio-trace-instructions-hear-graph = To hear the graph, press H.
graphing-calculator-narration-audio-trace-instructions-use-arrow-keys = Use Arrow keys to navigate.
graphing-calculator-narration-audio-trace-last-point = Last point
graphing-calculator-narration-audio-trace-last-slider = Last slider.
graphing-calculator-narration-audio-trace-multiple-sliders-paused = { $sliders } animating sliders were paused.
graphing-calculator-narration-audio-trace-no-more-pois = No more points of interest
graphing-calculator-narration-audio-trace-no-sliders-paused = No animating sliders were paused.
graphing-calculator-narration-audio-trace-one-slider-paused = One animating slider was paused.
graphing-calculator-narration-audio-trace-playback-speed = Graph playback speed { $speed }
graphing-calculator-narration-audio-trace-poi-count = Points of interest, { $x }.
graphing-calculator-narration-audio-trace-point-type-definition = Definition
graphing-calculator-narration-audio-trace-point-type-extremum = Extremum
graphing-calculator-narration-audio-trace-point-type-intercept = Intercept
graphing-calculator-narration-audio-trace-point-type-intersection = Intersection
graphing-calculator-narration-audio-trace-point-type-intersection-with-curves = Intersection with { $curves }
graphing-calculator-narration-audio-trace-point-type-label = Label
graphing-calculator-narration-audio-trace-point-type-not-a-poi = Not a P O I
graphing-calculator-narration-audio-trace-point-type-root = Zero
graphing-calculator-narration-audio-trace-point-type-trace = Trace
graphing-calculator-narration-audio-trace-property-branch-number = Branch { $branch }.
graphing-calculator-narration-audio-trace-property-type-before-coordinates = { $type } at
graphing-calculator-narration-audio-trace-property-x = X: { $x }.
graphing-calculator-narration-audio-trace-property-y = Y: { $y }.
graphing-calculator-narration-audio-trace-slider-value-unknown = Unable to determine slider value
graphing-calculator-narration-audio-trace-sound-effects-disabled = Sound effects have been disabled.
graphing-calculator-narration-audio-trace-traceable-curves =
    { $sketchCount ->
        [one] 1 audio traceable curve.
       *[other] { $sketchCount } audio traceable curves.
    }
graphing-calculator-narration-audio-trace-tracing-different-expression = Tracing { $expression }.
graphing-calculator-narration-audio-trace-unable-to-play = Unable to play audio.
graphing-calculator-narration-audio-trace-unable-to-trace-this-expression = Unable to audio trace this expression.
graphing-calculator-narration-audio-trace-unsupported-expression = { $expression } cannot be audio traced.
graphing-calculator-narration-audio-trace-volume = Volume { $volume } percent
graphing-calculator-narration-cdf-maximum = Max
graphing-calculator-narration-cdf-minimum = Min
graphing-calculator-narration-click-action = Click Action
graphing-calculator-narration-clickable-image-options = Clickable Image Options
graphing-calculator-narration-collapse = Collapse
graphing-calculator-narration-collapse-folder-index = Collapse Folder { $index }
graphing-calculator-narration-collapse-folder-title = Collapse { $folder } folder
graphing-calculator-narration-color-unknown = unknown
graphing-calculator-narration-computed-cell-role-description = computed cell
graphing-calculator-narration-configure-toolbar = Geometry Toolbar Configuration
graphing-calculator-narration-create-table = Create Table
graphing-calculator-narration-create-table-expression = Create Table from Expression { $index }
graphing-calculator-narration-create-table-secret-expression = Create Table from Secret Expression { $index }
graphing-calculator-narration-delete = Delete
graphing-calculator-narration-delete-expression = Delete Expression { $index }
graphing-calculator-narration-delete-folder-index = Delete Folder { $index }
graphing-calculator-narration-delete-folder-title = Delete { $folder } folder
graphing-calculator-narration-delete-image = Delete Image { $index }
graphing-calculator-narration-delete-secret-expression = Delete Secret Expression { $index }
graphing-calculator-narration-delete-table = Delete Table { $index }
graphing-calculator-narration-delete-text = Delete Note { $index }
graphing-calculator-narration-describe = Unknown object
graphing-calculator-narration-describe-expression = Expression { $index }
graphing-calculator-narration-describe-folder-index = Folder { $index }
graphing-calculator-narration-describe-folder-title = { $folder } folder
graphing-calculator-narration-describe-image = Image { $index }
graphing-calculator-narration-describe-secret-expression = Secret expression { $index }
graphing-calculator-narration-describe-table = Table { $index }
graphing-calculator-narration-describe-text = Note { $index }
graphing-calculator-narration-description-collapsed-folder = Collapsed Folder
graphing-calculator-narration-description-collapsed-readonly-folder = Collapsed Locked Folder
graphing-calculator-narration-description-collapsed-secret-folder = Collapsed Secret Folder
graphing-calculator-narration-description-collapsed-secret-readonly-folder = Collapsed Secret Locked Folder
graphing-calculator-narration-description-folder = Folder
graphing-calculator-narration-description-hidden-collapsed-folder = Hidden Collapsed Folder
graphing-calculator-narration-description-hidden-collapsed-readonly-folder = Hidden Collapsed Locked Folder
graphing-calculator-narration-description-hidden-collapsed-secret-folder = Hidden Collapsed Secret Folder
graphing-calculator-narration-description-hidden-collapsed-secret-readonly-folder = Hidden Collapsed Secret Locked Folder
graphing-calculator-narration-description-hidden-folder = Hidden Folder
graphing-calculator-narration-description-hidden-readonly-folder = Hidden Locked Folder
graphing-calculator-narration-description-hidden-secret-folder = Hidden Secret Folder
graphing-calculator-narration-description-hidden-secret-readonly-folder = Hidden Secret Locked Folder
graphing-calculator-narration-description-readonly-folder = Locked Folder
graphing-calculator-narration-description-secret-folder = Secret Folder
graphing-calculator-narration-description-secret-readonly-folder = Secret Locked Folder
graphing-calculator-narration-dist-tab-distributions = Distributions
graphing-calculator-narration-dist-tab-visualizations = Visualizations
graphing-calculator-narration-domain3d-maximum = domain { $term } Maximum:
graphing-calculator-narration-domain3d-minimum = domain { $term } Minimum:
graphing-calculator-narration-drag-mode-x = X
graphing-calculator-narration-drag-mode-xy = X and Y
graphing-calculator-narration-drag-mode-y = Y
graphing-calculator-narration-draggable-image-off-screen-prompt = { " " }not completely visible on screen
graphing-calculator-narration-duplicate = Duplicate
graphing-calculator-narration-duplicate-expression = Duplicate Expression { $index }
graphing-calculator-narration-duplicate-folder-index = Duplicate Folder { $index }
graphing-calculator-narration-duplicate-folder-title = Duplicate { $folder } folder
graphing-calculator-narration-duplicate-image = Duplicate Image { $index }
graphing-calculator-narration-duplicate-secret-expression = Duplicate Secret Expression { $index }
graphing-calculator-narration-duplicate-table = Duplicate Table { $index }
graphing-calculator-narration-duplicate-text = Duplicate Note { $index }
graphing-calculator-narration-edit-action = Edit Action
graphing-calculator-narration-edit-expression-list = Edit Expression List
graphing-calculator-narration-edit-folder-title = Edit Folder { $index } Title
graphing-calculator-narration-edit-graph-on-desmos = Edit graph on Desmos
graphing-calculator-narration-edit-image-title = Edit Image { $index } Title
graphing-calculator-narration-edit-list-mode-off = Edit list mode off.
graphing-calculator-narration-edit-list-mode-on = Edit list mode on.
graphing-calculator-narration-edit-on-desmos = Edit graph on Desmos
graphing-calculator-narration-edit-slider-variable-limits = Edit { $variable } Limits
graphing-calculator-narration-edit-text-title = Note { $index }
graphing-calculator-narration-edit-title = Edit Title
graphing-calculator-narration-editable-label-mode = Editable label mode
graphing-calculator-narration-editable-point-label-at-coordinates = Editable point label at { $coordinates }
graphing-calculator-narration-expand = Expand
graphing-calculator-narration-expand-folder-index = Expand Folder { $index }
graphing-calculator-narration-expand-folder-title = Expand { $folder } folder
graphing-calculator-narration-expression-audio-trace-mac = To audio trace, press OPTION+T.
graphing-calculator-narration-expression-audio-trace-windows = To audio trace, press ALT+T.
graphing-calculator-narration-expression-bar = Expression Bar
graphing-calculator-narration-expression-evaluation-has-graph = Has graph.
graphing-calculator-narration-expression-evaluation-has-graph-and-regression = Has graph and regression. To access statistics, press Tab.
graphing-calculator-narration-expression-evaluation-has-regression = Has regression. To access statistics, press Tab.
graphing-calculator-narration-expression-evaluation-is-distribution = is distribution.
graphing-calculator-narration-expression-evaluation-is-t-test = is T test. To access statistics, press Tab.
graphing-calculator-narration-expression-hidden-label = Hidden { $label }
graphing-calculator-narration-expression-index-table = Expression { $index } table
graphing-calculator-narration-expression-label = Label
graphing-calculator-narration-expression-tone-muted = Muted tone.
graphing-calculator-narration-expression-tone-unmuted = Unmuted tone.
graphing-calculator-narration-fill-opacity = Fill Opacity:
graphing-calculator-narration-fill-visible = Fill visible
graphing-calculator-narration-folder-collapsed = folder collapsed
graphing-calculator-narration-folder-expanded = folder expanded
graphing-calculator-narration-folder-has-items = { $folder } has { $count } items
graphing-calculator-narration-functions = Functions
graphing-calculator-narration-geometry-added-object-type = Added { $type }.
graphing-calculator-narration-geometry-added-object-type-and-point = Added { $type } and 1 point.
graphing-calculator-narration-geometry-added-object-type-and-points = Added { $type } and { $points } points.
graphing-calculator-narration-geometry-added-points = Added { $points } points.
graphing-calculator-narration-geometry-angle-of-polygon = { $itemDescription } of { $parent }
graphing-calculator-narration-geometry-angle-through-points = { $itemDescription } through { $parent1 }, { $parent2 }, and { $parent3 }
graphing-calculator-narration-geometry-arc-through-points = Arc { $index } starting at { $start }. Middle at { $middle }. End at { $end }.
graphing-calculator-narration-geometry-circle-with-center-and-radius = Circle { $index } with center at { $center } and radius { $radius }.
graphing-calculator-narration-geometry-construction-icon-label = Token Count
graphing-calculator-narration-geometry-construction-role-description = construction
graphing-calculator-narration-geometry-deselect-all = Deselect All
graphing-calculator-narration-geometry-dilated-item = dilated { $item }
graphing-calculator-narration-geometry-edge-of-polygon = Edge { $polygonEdge } of { $item }
graphing-calculator-narration-geometry-glider-on-item = { $gliderDescription } on { $item }
graphing-calculator-narration-geometry-glider-with-assignment = Glider { $assignment }
graphing-calculator-narration-geometry-hidden-construction-description = Hidden { $description }
graphing-calculator-narration-geometry-intersection-of-items = { $intersectionDescription } of { $item1 } and { $item2 }
graphing-calculator-narration-geometry-intersection-with-assignment = Intersection { $assignment }
graphing-calculator-narration-geometry-item-at-coordinates-to-coordinates = { $itemDescription } from { $x1 } { $y1 } to { $x2 } { $y2 }
graphing-calculator-narration-geometry-list-of-angles = List of { $count } angles
graphing-calculator-narration-geometry-list-of-any = List of { $count } unknown objects
graphing-calculator-narration-geometry-list-of-arcs = List of { $count } arcs
graphing-calculator-narration-geometry-list-of-circles = List of { $count } circles
graphing-calculator-narration-geometry-list-of-directed-angles = List of { $count } directed angles
graphing-calculator-narration-geometry-list-of-lines = List of { $count } lines
graphing-calculator-narration-geometry-list-of-points = List of { $count } points
graphing-calculator-narration-geometry-list-of-polygons = List of { $count } polygons
graphing-calculator-narration-geometry-list-of-rays = List of { $count } rays
graphing-calculator-narration-geometry-list-of-segments = List of { $count } segments
graphing-calculator-narration-geometry-midpoint-of-item = { $midpointDescription } of { $item }
graphing-calculator-narration-geometry-midpoint-with-assignment = Midpoint { $assignment }
graphing-calculator-narration-geometry-moved-to-coordinates = Moved to x: { $x }, y: { $y }.
graphing-calculator-narration-geometry-near-item = Near { $item }.
graphing-calculator-narration-geometry-no-tool-inputs = No inputs exist
graphing-calculator-narration-geometry-nothing-selected = Nothing selected.
graphing-calculator-narration-geometry-parallel-to-line-through-point = Parallel line { $index } to { $line }, passing through { $point }
graphing-calculator-narration-geometry-perpendicular-to-line-through-point = Perpedicular line { $index } to { $line }, passing through { $point }
graphing-calculator-narration-geometry-point-with-assignment = Point { $assignment }
graphing-calculator-narration-geometry-reflected-item = reflected { $item }
graphing-calculator-narration-geometry-rotated-item = rotated { $item }
graphing-calculator-narration-geometry-segment-with-assignment = Segment { $assignment }
graphing-calculator-narration-geometry-straight-from-item-to-item = { $straightType } from { $start } to { $end }
graphing-calculator-narration-geometry-straight-index-of-item = { $straightType } index { $index } of { $item }
graphing-calculator-narration-geometry-token-navigator-depth = Depth: { $depth }
graphing-calculator-narration-geometry-token-navigator-label = Token Navigator
graphing-calculator-narration-geometry-tool-cancelled = Cancelled.
graphing-calculator-narration-geometry-tool-disabled = The { $tool } tool is disabled.
graphing-calculator-narration-geometry-transformed-item = transformed { $item }
graphing-calculator-narration-geometry-translated-item = translated { $item }
graphing-calculator-narration-geometry-unable-to-move = Unable to move.
graphing-calculator-narration-geometry-unlabeled-angle = Angle { $index }
graphing-calculator-narration-geometry-unlabeled-angle-with-measurement = { $measurementText } Angle { $index }
graphing-calculator-narration-geometry-unlabeled-arc = Arc { $index }
graphing-calculator-narration-geometry-unlabeled-circle = Circle { $index }
graphing-calculator-narration-geometry-unlabeled-directed-angle = Directed Angle { $index }
graphing-calculator-narration-geometry-unlabeled-directed-angle-with-measurement = { $measurementText } Directed Angle { $index }
graphing-calculator-narration-geometry-unlabeled-glider = Glider { $index }
graphing-calculator-narration-geometry-unlabeled-intersection = Intersection { $index }
graphing-calculator-narration-geometry-unlabeled-line = Line { $index }
graphing-calculator-narration-geometry-unlabeled-midpoint = Midpoint { $index }
graphing-calculator-narration-geometry-unlabeled-parallel = Parallel line { $index }
graphing-calculator-narration-geometry-unlabeled-perpendicular = Perpendicular line { $index }
graphing-calculator-narration-geometry-unlabeled-point = Point { $index }
graphing-calculator-narration-geometry-unlabeled-polygon = Polygon { $index } with { $sideCount } sides
graphing-calculator-narration-geometry-unlabeled-quadrilateral = Quadrilateral { $index }
graphing-calculator-narration-geometry-unlabeled-ray = Ray { $index }
graphing-calculator-narration-geometry-unlabeled-segment = Segment { $index }
graphing-calculator-narration-geometry-unlabeled-triangle = Triangle { $index }
graphing-calculator-narration-geometry-unlabeled-vector = Vector { $index }
graphing-calculator-narration-graph-settings-controls = Graph Settings Controls
graphing-calculator-narration-graphpaper-label = graph paper
graphing-calculator-narration-hide = Hide
graphing-calculator-narration-hide-animation-properties = Hide Animation Properties
graphing-calculator-narration-hide-expression = Hide Expression { $index }
graphing-calculator-narration-hide-expression-list = Hide expression list
graphing-calculator-narration-hide-folder-index = Hide Folder { $index }
graphing-calculator-narration-hide-folder-title = Hide { $folder } folder
graphing-calculator-narration-hide-image = Hide Image { $index }
graphing-calculator-narration-hide-options = Hide Options
graphing-calculator-narration-hide-options-expression = Hide Options for Expression { $index }
graphing-calculator-narration-hide-options-image = Hide Options for Image { $index }
graphing-calculator-narration-hide-options-secret-expression = Hide Options for Secret Expression { $index }
graphing-calculator-narration-hide-secret-expression = Hide Secret Expression { $index }
graphing-calculator-narration-hide-table = Hide Table { $index }
graphing-calculator-narration-hide-table-column = Hide Column
graphing-calculator-narration-hide-text = Hide Note { $index }
graphing-calculator-narration-image-styles = Styles
graphing-calculator-narration-item-at-coordinates = { $itemDescription } at { $x } { $y }
graphing-calculator-narration-item-hidden = Item hidden.
graphing-calculator-narration-item-visible = Item visible.
graphing-calculator-narration-item-with-list-index = index { $listIndex } of { $item }
graphing-calculator-narration-items-deleted =
    { $count ->
        [one] { $count } item deleted.
       *[other] { $count } items deleted.
    }
graphing-calculator-narration-keypad-hidden = Keypad hidden
graphing-calculator-narration-keypad-key-next-curve = Next Curve
graphing-calculator-narration-keypad-key-next-poi = Next Point of Interest
graphing-calculator-narration-keypad-key-next-point = Next Point
graphing-calculator-narration-keypad-key-previous-curve = Previous Curve
graphing-calculator-narration-keypad-key-previous-poi = Previous Point of Interest
graphing-calculator-narration-keypad-key-previous-point = Previous Point
graphing-calculator-narration-keypad-key-speed-down = Speed Down
graphing-calculator-narration-keypad-key-speed-up = Speed Up
graphing-calculator-narration-keypad-key-volume-down = Volume Down
graphing-calculator-narration-keypad-key-volume-up = Volume Up
graphing-calculator-narration-keypad-visible = Keypad visible
graphing-calculator-narration-label-angle = Label Angle:
graphing-calculator-narration-label-size = Label Size:
graphing-calculator-narration-label-text = Label Text
graphing-calculator-narration-label-visible = Label visible
graphing-calculator-narration-line-opacity = Line Opacity:
graphing-calculator-narration-line-style-dashed = Dashed
graphing-calculator-narration-line-style-dotted = Dotted
graphing-calculator-narration-line-style-solid = Solid
graphing-calculator-narration-lines-visible = Lines visible
graphing-calculator-narration-locked-items-not-deleted =
    { $count ->
        [one] { $count } locked item could not be deleted.
       *[other] { $count } locked items could not be deleted.
    }
graphing-calculator-narration-main-desmos-geometry = Desmos Geometry
graphing-calculator-narration-main-desmos-graphing-calculator = Desmos Graphing Calculator
graphing-calculator-narration-make-clickable = make clickable
graphing-calculator-narration-menu-drag-enabled = Drag Enabled
graphing-calculator-narration-movable-point-off-screen-prompt = { " " }not visible on screen
graphing-calculator-narration-movable-point-prefix = Point
graphing-calculator-narration-movable-point-suffix-usage-instructions = { " " }is movable. Press Arrows or Shift+Arrows to adjust.
graphing-calculator-narration-mute = Mute
graphing-calculator-narration-mute-all = Mute all
graphing-calculator-narration-mute-expression = Mute Expression { $index }
graphing-calculator-narration-mute-secret-expression = Mute Secret Expression { $index }
graphing-calculator-narration-muted = Muted
graphing-calculator-narration-no-geometry-tools-available = No geometry tools available.
graphing-calculator-narration-no-playing-tones = No currently playing tones
graphing-calculator-narration-no-tone-expressions = No tones in this graph
graphing-calculator-narration-open-graph = Open Graph
graphing-calculator-narration-options-menu = Options Menu
graphing-calculator-narration-options-menu-closed = Options menu closed.
graphing-calculator-narration-options-menu-open = Options menu open.
graphing-calculator-narration-pause-variable-animation = Pause { $variable } Animation
graphing-calculator-narration-play-variable-animation = Play { $variable } Animation
graphing-calculator-narration-poi-graph-point = Point
graphing-calculator-narration-point-size = Point Size:
graphing-calculator-narration-point-style-cross = Cross
graphing-calculator-narration-point-style-open = Open
graphing-calculator-narration-point-style-point = Point
graphing-calculator-narration-points-visible = Points visible
graphing-calculator-narration-powered-by-desmos = Powered by Desmos
graphing-calculator-narration-redo = Redo
graphing-calculator-narration-rename = Rename
graphing-calculator-narration-rename-expression = Rename in Expression { $index }
graphing-calculator-narration-rename-secret-expression = Rename in Secret Expression { $index }
graphing-calculator-narration-rename-table = Rename in Table { $index }
graphing-calculator-narration-run-action-icon = Run Action
graphing-calculator-narration-settings-all-axes-max = Max for x, y, and z
graphing-calculator-narration-settings-all-axes-min = Min for x, y, and z
graphing-calculator-narration-settings-angle = Angle Settings
graphing-calculator-narration-settings-cartesian-grid = Cartesian Grid
graphing-calculator-narration-settings-polar-grid = Polar Grid
graphing-calculator-narration-settings-show-both = Show Both
graphing-calculator-narration-settings-show-positive = Show Positive
graphing-calculator-narration-settings-x-axis-label-placeholder = e.g. \u201Cx\u201D
graphing-calculator-narration-settings-x-axis-max = X Axis Maximum:{ " " }
graphing-calculator-narration-settings-x-axis-min = X Axis Minimum:{ " " }
graphing-calculator-narration-settings-x-axis-step = X Axis Step Size:{ " " }
graphing-calculator-narration-settings-y-axis-label-placeholder = e.g. \u201Cy\u201D
graphing-calculator-narration-settings-y-axis-max = Y Axis Maximum:{ " " }
graphing-calculator-narration-settings-y-axis-min = Y Axis Minimum:{ " " }
graphing-calculator-narration-settings-y-axis-step = Y Axis Step Size:{ " " }
graphing-calculator-narration-settings-z-axis-max = Z Axis Maximum:{ " " }
graphing-calculator-narration-settings-z-axis-min = Z Axis Minimum:{ " " }
graphing-calculator-narration-share-graph-link = Link to this graph
graphing-calculator-narration-share-graph-link-copied = Link copied
graphing-calculator-narration-share-graph-link-unable-to-copy = Unable to copy link
graphing-calculator-narration-show = Show
graphing-calculator-narration-show-animation-properties = Show Animation Properties
graphing-calculator-narration-show-expression = Show Expression { $index }
graphing-calculator-narration-show-folder-index = Show Folder { $index }
graphing-calculator-narration-show-folder-title = Show { $folder } folder
graphing-calculator-narration-show-image = Show Image { $index }
graphing-calculator-narration-show-options = Show Options
graphing-calculator-narration-show-options-expression = Show Options for Expression { $index }
graphing-calculator-narration-show-options-image = Show Options for Image { $index }
graphing-calculator-narration-show-options-secret-expression = Show Options for Secret Expression { $index }
graphing-calculator-narration-show-secret-expression = Show Secret Expression { $index }
graphing-calculator-narration-show-table = Show Table { $index }
graphing-calculator-narration-show-table-column = Show Column
graphing-calculator-narration-show-text = Show Note { $index }
graphing-calculator-narration-slider-animate-faster = Animate Faster
graphing-calculator-narration-slider-animate-slower = Animate Slower
graphing-calculator-narration-slider-animating-at-speed = Animating at { $speed }x
graphing-calculator-narration-slider-loop-forwards-and-backwards = Loop forwards and backwards
graphing-calculator-narration-slider-maximum = Slider Maximum:
graphing-calculator-narration-slider-minimum = Slider Minimum:
graphing-calculator-narration-slider-play-indefinitely = Play indefinitely
graphing-calculator-narration-slider-play-once = Play once
graphing-calculator-narration-slider-repeat-one-direction = Repeat in one direction
graphing-calculator-narration-slider-step = Slider Step Size:
graphing-calculator-narration-slider-trace-no-sliders = No sliders to trace.
graphing-calculator-narration-slider-trace-off = Slider trace off.
graphing-calculator-narration-slider-trace-on = Slider trace on.
graphing-calculator-narration-slider-variable-paused = { $variable } paused
graphing-calculator-narration-slider-variable-playing = { $variable } playing
graphing-calculator-narration-slider-variable-restarted = { $variable } restarted
graphing-calculator-narration-surfaces-visible = Surfaces visible
graphing-calculator-narration-table-column-header = Column header { $column }
graphing-calculator-narration-table-no-column-header = No column header
graphing-calculator-narration-table-row-column = Row { $row } Col { $column }
graphing-calculator-narration-tick-action = Tick Action
graphing-calculator-narration-toggle-audio-trace = Toggle Audio Trace
graphing-calculator-narration-toggle-letters = Toggle Letters
graphing-calculator-narration-transformations-menu = Transformations Menu
graphing-calculator-narration-unable-to-add-expression = Unable to add expression
graphing-calculator-narration-unable-to-add-note = Unable to add note
graphing-calculator-narration-unable-to-add-table = Unable to add table
graphing-calculator-narration-undo = Undo
graphing-calculator-narration-unmute = Unmute
graphing-calculator-narration-unmute-all = Unmute all
graphing-calculator-narration-unmute-expression = Unmute Expression { $index }
graphing-calculator-narration-unmute-secret-expression = Unmute Secret Expression { $index }
graphing-calculator-narration-unmuted = Unmuted
graphing-calculator-narration-viewport-default = Graph viewport default
graphing-calculator-narration-viewport-updated = Graph viewport updated.
graphing-calculator-narration-viewport-zoom-3d-default = Graph set to default orientation
graphing-calculator-narration-viewport-zoom-3d-xy = Graph set to X Y orientation
graphing-calculator-narration-viewport-zoom-in = Graph zoom in
graphing-calculator-narration-viewport-zoom-out = Graph zoom out
graphing-calculator-narration-viewport-zoom-recenter = Graph recenter
graphing-calculator-narration-viewport-zoom-square = Graph zoom square
graphing-calculator-narration-visual-parameters-height = Height
graphing-calculator-narration-visual-parameters-offset = Offset
graphing-calculator-narration-visual-parameters-width = Width
graphing-calculator-narration-x-percentage-coordinate = { $x } percent from left.
graphing-calculator-narration-y-percentage-coordinate = { $y } percent from top.
graphing-calculator-narration-zoom-options-label = Zoom
graphing-calculator-text-add-screen-reader-label-placeholder = Add screen reader label
graphing-calculator-text-arrow-mode-both = Both
graphing-calculator-text-arrow-mode-default = Default
graphing-calculator-text-arrow-mode-none = None
graphing-calculator-text-arrow-mode-positive = Positive
graphing-calculator-text-audio-trace-no-implicit-support = Sorry, but I can't trace implicit curves yet.
graphing-calculator-text-audio-trace-no-parametric-support = Sorry, but I can't trace parametric curves yet.
graphing-calculator-text-audio-trace-no-polar-support = Sorry, but I can't trace polar curves yet.
graphing-calculator-text-audio-trace-off = Audio trace off.
graphing-calculator-text-audio-trace-on = Audio trace on.
graphing-calculator-text-color-black = black
graphing-calculator-text-color-blue = blue
graphing-calculator-text-color-gray = gray
graphing-calculator-text-color-green = green
graphing-calculator-text-color-orange = orange
graphing-calculator-text-color-purple = purple
graphing-calculator-text-color-red = red
graphing-calculator-text-color-unknown = color unknown
graphing-calculator-text-enter-pareneter = Enter the { $param }.
graphing-calculator-text-export-braille-email-accessibility = Feedback? Email <1>accessibility@desmos.com</1>.
graphing-calculator-text-folder-placeholder = Untitled folder
graphing-calculator-text-geometry-arrow-mode = Arrow Mode: { $mode }
graphing-calculator-text-geometry-delete-selected-objects =
    { $count ->
        [one] Delete 1 object
       *[other] Delete { $count } objects
    }
graphing-calculator-text-geometry-delete-selected-unlocked-objects =
    { $count ->
        [one] Delete 1 unlocked object
       *[other] Delete { $count } unlocked objects
    }
graphing-calculator-text-geometry-glider = glider
graphing-calculator-text-geometry-hide-objects =
    { $count ->
        [one] Hide
       *[other] Hide all
    }
graphing-calculator-text-geometry-intersection = intersection
graphing-calculator-text-geometry-move-to-folder-message =
    { $count ->
        [one] Move to folder:
       *[other] Move { $count } objects to folder:
    }
graphing-calculator-text-geometry-multi-select-more-dropdown = More
graphing-calculator-text-geometry-multi-select-transform = Transform
graphing-calculator-text-geometry-no-constructed-objects = No constructed objects yet.
graphing-calculator-text-geometry-select-hint = Select a { $type }
graphing-calculator-text-geometry-selected-objects =
    { $count ->
        [one] 1 object selected
       *[other] { $count } objects selected
    }
graphing-calculator-text-geometry-show-objects =
    { $count ->
        [one] Show
       *[other] Show all
    }
graphing-calculator-text-geometry-tool-angle-display-name = Angle
graphing-calculator-text-geometry-tool-angle-hint-1 = Choose a starting point
graphing-calculator-text-geometry-tool-angle-hint-2 = Choose a vertex point
graphing-calculator-text-geometry-tool-angle-hint-3 = Choose an endpoint
graphing-calculator-text-geometry-tool-angles-hint-1 = Choose a starting point or a polygon
graphing-calculator-text-geometry-tool-arc-display-name = Arc
graphing-calculator-text-geometry-tool-arc-hint-1 = Choose a point (start)
graphing-calculator-text-geometry-tool-arc-hint-2 = Choose a point (middle)
graphing-calculator-text-geometry-tool-arc-hint-3 = Choose a point (end)
graphing-calculator-text-geometry-tool-box-selection-display-name = Box Select
graphing-calculator-text-geometry-tool-circle-display-name = Circle
graphing-calculator-text-geometry-tool-circle-hint-center = Choose a point (center)
graphing-calculator-text-geometry-tool-circle-hint-radius = Choose a point (radius)
graphing-calculator-text-geometry-tool-compass-display-name = Compass
graphing-calculator-text-geometry-tool-compass-hint-center = Choose a center point
graphing-calculator-text-geometry-tool-compass-hint-segment = Choose a segment to set the radius
graphing-calculator-text-geometry-tool-dilate-display-name = Dilate
graphing-calculator-text-geometry-tool-dilation-hint-center = Choose point (center)
graphing-calculator-text-geometry-tool-dilation-hint-scale-factor = Scale factor
graphing-calculator-text-geometry-tool-directed-angle-display-name = Directed Angle
graphing-calculator-text-geometry-tool-directedangle-display-name = Directed angle
graphing-calculator-text-geometry-tool-expression-edit-display-name = Insert into current expression.
graphing-calculator-text-geometry-tool-expression-edit-generic-hint-0 = No valid inputs
graphing-calculator-text-geometry-tool-expression-edit-generic-hint-1 = Choose { $type }
graphing-calculator-text-geometry-tool-expression-edit-generic-hint-2 = Choose { $type1 } or { $type2 }
graphing-calculator-text-geometry-tool-expression-edit-generic-hint-any-object = Choose any object
graphing-calculator-text-geometry-tool-expression-edit-generic-hint-many = Choose one of the following: { $types }
graphing-calculator-text-geometry-tool-line-display-name = Line
graphing-calculator-text-geometry-tool-line-hint-end = Choose a 2nd point
graphing-calculator-text-geometry-tool-line-hint-start = Choose a 1st point
graphing-calculator-text-geometry-tool-midpoint-display-name = Midpoint
graphing-calculator-text-geometry-tool-midpoint-hint = Choose a segment
graphing-calculator-text-geometry-tool-parallel-display-name = Parallel
graphing-calculator-text-geometry-tool-parallel-hint-point = Choose a point to pass through
graphing-calculator-text-geometry-tool-parallel-hint-straight-line = Choose a line to be parallel to
graphing-calculator-text-geometry-tool-perpendicular-display-name = Perpendicular
graphing-calculator-text-geometry-tool-perpendicular-hint-point = Choose a point to pass through
graphing-calculator-text-geometry-tool-perpendicular-hint-straight-line = Choose a line to be perpendicular to
graphing-calculator-text-geometry-tool-point-display-name = Point
graphing-calculator-text-geometry-tool-point-hint = Select or create a point
graphing-calculator-text-geometry-tool-polygon-display-name = Polygon
graphing-calculator-text-geometry-tool-polygon-hint-finish-point = Choose another point, or click an existing point to finish
graphing-calculator-text-geometry-tool-polygon-hint-first-point = Choose a point
graphing-calculator-text-geometry-tool-polygon-hint-next-point = Choose another point
graphing-calculator-text-geometry-tool-ray-display-name = Ray
graphing-calculator-text-geometry-tool-ray-hint-end = Choose a point (direction)
graphing-calculator-text-geometry-tool-ray-hint-start = Choose a point (vertex)
graphing-calculator-text-geometry-tool-reflect-display-name = Reflect
graphing-calculator-text-geometry-tool-reflection-hint-choose-line = Choose line of reflection
graphing-calculator-text-geometry-tool-rotate-display-name = Rotate
graphing-calculator-text-geometry-tool-rotation-hint-angle = Choose angle
graphing-calculator-text-geometry-tool-rotation-hint-angle-end = Choose angle end point
graphing-calculator-text-geometry-tool-rotation-hint-angle-start = Construct or choose an angle
graphing-calculator-text-geometry-tool-rotation-hint-angle-vertex = Complete angle: choose 2 more points
graphing-calculator-text-geometry-tool-rotation-hint-center = Choose point (center)
graphing-calculator-text-geometry-tool-segment-display-name = Segment
graphing-calculator-text-geometry-tool-segment-hint-end = Choose another point
graphing-calculator-text-geometry-tool-segment-hint-start = Choose a point
graphing-calculator-text-geometry-tool-selection-display-name = Select
graphing-calculator-text-geometry-tool-translate-display-name = Translate
graphing-calculator-text-geometry-tool-translation-hint-from-with-vector = Choose start point or a vector
graphing-calculator-text-geometry-tool-translation-hint-to = Choose end point
graphing-calculator-text-geometry-tool-vector-copy-display-name = Copy of Vector
graphing-calculator-text-geometry-tool-vector-copy-hint-end = Choose new start point for copy
graphing-calculator-text-geometry-tool-vector-display-name = Vector
graphing-calculator-text-geometry-tool-vector-end-point-display-name = Vector End Point
graphing-calculator-text-geometry-tool-vector-hint-end = Choose end point
graphing-calculator-text-geometry-tool-vector-hint-start = Choose start point or a vector to copy
graphing-calculator-text-geometry-tool-vector-start-point-display-name = Vector Start Point
graphing-calculator-text-image-placeholder = Unnamed image
graphing-calculator-text-label-orientation-above = Above
graphing-calculator-text-label-orientation-above-left = Above Left
graphing-calculator-text-label-orientation-above-right = Above Right
graphing-calculator-text-label-orientation-below = Below
graphing-calculator-text-label-orientation-below-left = Below Left
graphing-calculator-text-label-orientation-below-right = Below Right
graphing-calculator-text-label-orientation-default = Default
graphing-calculator-text-label-orientation-left = Left
graphing-calculator-text-label-orientation-right = Right
graphing-calculator-text-loading-image = Loading image...
graphing-calculator-text-note-placeholder = Empty note
graphing-calculator-text-parameter-name-binwidth = Bin Width
graphing-calculator-text-parameter-name-data = Data Set
graphing-calculator-text-parameter-name-dof = Degrees of Freedom
graphing-calculator-text-parameter-name-height = Height
graphing-calculator-text-parameter-name-max = Maximum
graphing-calculator-text-parameter-name-mean = Mean
graphing-calculator-text-parameter-name-min = Minimum
graphing-calculator-text-parameter-name-offset = Offset
graphing-calculator-text-parameter-name-probsuccess = Success Probability
graphing-calculator-text-parameter-name-stddev = Standard Deviation
graphing-calculator-text-parameter-name-trials = Trials
graphing-calculator-text-refreshable-braille-display-note = Use a refreshable Braille display, or just type Braille with a keyboard.
graphing-calculator-text-regression-potentially-inaccurate-parameters = Some parameters may be too large or small to represent accurately.
graphing-calculator-text-share-graph-link = Link to this graph
graphing-calculator-text-table-created = Table created.
graphing-calculator-text-table-more-rows = { $rowCount } more rows
graphing-calculator-text-toast-choose-one-file = You can only choose one file as a replacement
graphing-calculator-text-toast-error-importing-graph = Error importing graph. Check the URL?
graphing-calculator-text-toast-error-no-folders = Only graphs without folders can be inserted into a folder.
graphing-calculator-text-toast-expression-size-limit = Maximum expression size reached.
graphing-calculator-text-toast-graph-cleared = Graph cleared.
graphing-calculator-text-toast-graph-reset = Graph reset.
graphing-calculator-text-toast-image-upload-failed = Image upload failed.
graphing-calculator-text-toast-imported-graph = Graph imported!
graphing-calculator-text-toast-importing-graph = Importing graph...
graphing-calculator-text-toast-no-file-selected = You did not select a file
graphing-calculator-text-toast-uploading-images = Uploading images...
graphing-calculator-text-toast-zoom-to-fit = We zoomed to fit your data.
graphing-calculator-text-zoom-fit = Zoom Fit
graphing-tours-heading-quest-success = You completed the "{ $title }" quest.
graphing-tours-heading-regressions = Regressions
graphing-tours-heading-restrictions = Restrictions
graphing-tours-heading-sliders = Sliders
graphing-tours-heading-tables = Tables
graphing-tours-label-add-slider = Add a slider
graphing-tours-label-awesome = Awesome!
graphing-tours-label-brilliant = Brilliant!
graphing-tours-label-change-color = Change color
graphing-tours-label-check-progress = Check my progress
graphing-tours-label-close-quest = Exit quest
graphing-tours-label-close-quests = Exit quests
graphing-tours-label-close-tour = Close tour
graphing-tours-label-new-item = Click here to add a new item.
graphing-tours-label-next-step-countdown = Continuing in { $seconds }...
graphing-tours-label-nice = Nice!
graphing-tours-label-quest-back-to-quest = Back to quest
graphing-tours-label-quest-take-a-tour = Take a tour
graphing-tours-label-quest-tours = Looking around? Try a quick tour.
graphing-tours-label-quest-tours-aria = Tours that might help with this quest
graphing-tours-label-regressions-better-fit = Edit this equation to find a better fit. Try, for example:<br>{ $equation }
graphing-tours-label-regressions-check-model = Nice. Let's check the model.
graphing-tours-label-regressions-data = First, let's get some data.
graphing-tours-label-regressions-data-2 = Let's start with some data!
graphing-tours-label-regressions-docs = Head over to Google Docs and copy and paste this { $sample_data_link }.
graphing-tours-label-regressions-equation = Now type: { $equation }
graphing-tours-label-regressions-expression-option = ... and select the "expression" option.
graphing-tours-label-regressions-fill-sample-data = Fill in the sample data:
graphing-tours-label-regressions-hint-1 = Hint #1: to get { $y_1 } type { $y1 }.
graphing-tours-label-regressions-hint-2 = Hint #2: { $twiddle } is in our onscreen keypad in the 'A B C' section.
graphing-tours-label-regressions-keep-exploring = Nice work \u2013 Keep exploring!
graphing-tours-label-regressions-new-model = Now, let's try a new model.
graphing-tours-label-regressions-new-table = Click here to add a new table.
graphing-tours-label-regressions-own-data = Note: you can add your own data instead by clicking the { $plus_icon } button.
graphing-tours-label-regressions-residuals = Residuals are the difference between your data and your model. Click here to add them to your table and plot them on the graph.
graphing-tours-label-regressions-sample-data = sample data
graphing-tours-label-require-expressions-visible = Click to show the list of expressions.
graphing-tours-label-require-not-edit-list-mode = Click to return to your expressions.
graphing-tours-label-require-resources-not-open = Click to return to this graph.
graphing-tours-label-restrictions-abc = Hint: press the 'A B C' button on the keypad to find the { $buttons } buttons
graphing-tours-label-restrictions-blank-expression = Click here to make a new blank expression.
graphing-tours-label-restrictions-change-equation = Change this equation to { $sample_expression }
graphing-tours-label-restrictions-domain = Restrict the domain of this line by adding { $sample_expression } to the end.
graphing-tours-label-restrictions-dont-forget = Don't forget the "y="!
graphing-tours-label-restrictions-graph-parabola = Now graph: { $sample_expression }
graphing-tours-label-restrictions-move-parabola = Move the parabola.
graphing-tours-label-restrictions-new-expression = Click here to create a new expression.
graphing-tours-label-restrictions-range = Now let's restrict the range. Add { $sample_expression } to the end.
graphing-tours-label-restrictions-star = You're a restrictions star!
graphing-tours-label-restrictions-start = Let's get started!
graphing-tours-label-restrictions-straight-line = Try graphing a straight line, like { $sample_expression }
graphing-tours-label-restrictions-type-all = Try typing all of { $sample_expression }
graphing-tours-label-restrictions-typing-hint = Hint: you can type { $suggestion1 }, or use the { $suggestion2 } button on the keypad below.
graphing-tours-label-self-destruct = This message will self-destruct in { $seconds }...
graphing-tours-label-show-surface = Show 3D surface
graphing-tours-label-sliders-add = Now click here to add the sliders.
graphing-tours-label-sliders-blank-expression = Click here to create a new blank expression.
graphing-tours-label-sliders-change-value = Type in here to change the value.
graphing-tours-label-sliders-drag-handle = Drag the handle to change the value.
graphing-tours-label-sliders-hands-free = Go "Hands-free"
graphing-tours-label-sliders-make-sliders = Let's make some sliders!
graphing-tours-label-sliders-press-play = Press play to animate the slider.
graphing-tours-label-sliders-pro = You're a slider pro!
graphing-tours-label-sliders-try-typing = Try typing { $sample_expression }
graphing-tours-label-tables-back = Click back to continue editing.
graphing-tours-label-tables-close-options = Click anywhere to close the drawing options.
graphing-tours-label-tables-dots = Click here to connect the dots.
graphing-tours-label-tables-enter = Now try pressing Enter.
graphing-tours-label-tables-fill-another = Just fill in one more...
graphing-tours-label-tables-fill-cell = Fill it in.
graphing-tours-label-tables-fill-row = Fill in this whole row.
graphing-tours-label-tables-last-trick = Last trick!
graphing-tours-label-tables-next-row = Go down to the next row to add more data.
graphing-tours-label-tables-open-options = Click and hold on this icon until the options menu opens up.
graphing-tours-label-tables-scroll = Scroll back up to the table.
graphing-tours-label-tables-select-table = ... and select the "table" option.
graphing-tours-label-tables-start = Let's make a table!
graphing-tours-label-tables-type-number = Type any number here.
graphing-tours-label-tables-valid-number = Uh-oh! Type a valid number here.
graphing-tours-label-tables-whiz = You're a tables whiz!
graphing-tours-label-turn-off-axes = Turn off axes
graphing-tours-narration-exiting-quest = Exiting quest.
graphing-tours-narration-quest-goal-complete = { $goal }. Complete.
graphing-tours-narration-quest-goal-incomplete = { $goal }. Incomplete.
graphing-tours-narration-quest-started = Started "{ $title }" quest.
graphing-tours-narration-quest-thumbnail = Thumbnail for '{ $title }' quest
graphing-tours-narration-tour-thumbnail = Thumbnail for '{ $title }' tour
matrix-calculator-narration-keypad-key-det = Determinant
matrix-calculator-narration-keypad-key-inverse = Inverse
matrix-calculator-narration-keypad-key-rref = Reduced row echelon form
matrix-calculator-narration-keypad-key-trace = Trace
matrix-calculator-narration-keypad-key-transpose = Transpose
frontpage-error-something-went-wrong-try-again-later = Sorry! Something went wrong. Please try again later.
frontpage-link-shared-3d-calculator-short = 3D
frontpage-link-shared-geometry-short = Geometry
frontpage-link-shared-graphing-calculator-short = Graphing
frontpage-narration-art-contest-image-of-graph = Image of { $graphTitle }
frontpage-narration-art-contest-image-of-graph-by = Image of graph by { $name }
frontpage-narration-shared-desmos-logo = Desmos Logo
frontpage-text-header-terms-update = We've updated our Terms of Service.































































































































































































































































































































































































































































































































































































































































































































































































`;var hg=class{constructor(e){this.value=e}valueOf(){return this.value}},Wo=class extends hg{constructor(e="???"){super(e)}toString(e){return`{${this.value}}`}},zl=class extends hg{constructor(e,t={}){super(e),this.opts=t}toString(e){try{return e.memoizeIntlObject(Intl.NumberFormat,this.opts).format(this.value)}catch(t){return e.reportError(t),this.value.toString(10)}}},Tp=class extends hg{constructor(e,t={}){super(e),this.opts=t}toString(e){try{return e.memoizeIntlObject(Intl.DateTimeFormat,this.opts).format(this.value)}catch(t){return e.reportError(t),new Date(this.value).toISOString()}}};var GU=100,ZZ="\u2068",eee="\u2069";function tee(r,e,t){if(t===e||t instanceof zl&&e instanceof zl&&t.value===e.value)return!0;if(e instanceof zl&&typeof t=="string"){let i=r.memoizeIntlObject(Intl.PluralRules,e.opts).select(e.value);if(t===i)return!0}return!1}function TU(r,e,t){return e[t]?xy(r,e[t].value):(r.reportError(new RangeError("No default")),new Wo)}function WP(r,e){let t=[],i=Object.create(null);for(let o of e)o.type==="narg"?i[o.name]=$v(r,o.value):t.push($v(r,o));return{positional:t,named:i}}function $v(r,e){switch(e.type){case"str":return e.value;case"num":return new zl(e.value,{minimumFractionDigits:e.precision});case"var":return ree(r,e);case"mesg":return iee(r,e);case"term":return oee(r,e);case"func":return nee(r,e);case"select":return aee(r,e);default:return new Wo}}function ree(r,{name:e}){let t;if(r.params)if(Object.prototype.hasOwnProperty.call(r.params,e))t=r.params[e];else return new Wo(`$${e}`);else if(r.args&&Object.prototype.hasOwnProperty.call(r.args,e))t=r.args[e];else return r.reportError(new ReferenceError(`Unknown variable: $${e}`)),new Wo(`$${e}`);if(t instanceof hg)return t;switch(typeof t){case"string":return t;case"number":return new zl(t);case"object":if(t instanceof Date)return new Tp(t.getTime());default:return r.reportError(new TypeError(`Variable type not supported: $${e}, ${typeof t}`)),new Wo(`$${e}`)}}function iee(r,{name:e,attr:t}){let i=r.bundle._messages.get(e);if(!i)return r.reportError(new ReferenceError(`Unknown message: ${e}`)),new Wo(e);if(t){let o=i.attributes[t];return o?xy(r,o):(r.reportError(new ReferenceError(`Unknown attribute: ${t}`)),new Wo(`${e}.${t}`))}return i.value?xy(r,i.value):(r.reportError(new ReferenceError(`No value: ${e}`)),new Wo(e))}function oee(r,{name:e,attr:t,args:i}){let o=`-${e}`,n=r.bundle._terms.get(o);if(!n)return r.reportError(new ReferenceError(`Unknown term: ${o}`)),new Wo(o);if(t){let s=n.attributes[t];if(s){r.params=WP(r,i).named;let l=xy(r,s);return r.params=null,l}return r.reportError(new ReferenceError(`Unknown attribute: ${t}`)),new Wo(`${o}.${t}`)}r.params=WP(r,i).named;let a=xy(r,n.value);return r.params=null,a}function nee(r,{name:e,args:t}){let i=r.bundle._functions[e];if(!i)return r.reportError(new ReferenceError(`Unknown function: ${e}()`)),new Wo(`${e}()`);if(typeof i!="function")return r.reportError(new TypeError(`Function ${e}() is not callable`)),new Wo(`${e}()`);try{let o=WP(r,t);return i(o.positional,o.named)}catch(o){return r.reportError(o),new Wo(`${e}()`)}}function aee(r,{selector:e,variants:t,star:i}){let o=$v(r,e);if(o instanceof Wo)return TU(r,t,i);for(let n of t){let a=$v(r,n.key);if(tee(r,o,a))return xy(r,n.value)}return TU(r,t,i)}function $P(r,e){if(r.dirty.has(e))return r.reportError(new RangeError("Cyclic reference")),new Wo;r.dirty.add(e);let t=[],i=r.bundle._useIsolating&&e.length>1;for(let o of e){if(typeof o=="string"){t.push(r.bundle._transform(o));continue}if(r.placeables++,r.placeables>GU)throw r.dirty.delete(e),new RangeError(`Too many placeables expanded: ${r.placeables}, max allowed is ${GU}`);i&&t.push(ZZ),t.push($v(r,o).toString(r)),i&&t.push(eee)}return r.dirty.delete(e),t.join("")}function xy(r,e){return typeof e=="string"?r.bundle._transform(e):$P(r,e)}var ak=class{constructor(e,t,i){this.dirty=new WeakSet,this.params=null,this.placeables=0,this.bundle=e,this.errors=t,this.args=i}reportError(e){if(!this.errors||!(e instanceof Error))throw e;this.errors.push(e)}memoizeIntlObject(e,t){let i=this.bundle._intls.get(e);i||(i={},this.bundle._intls.set(e,i));let o=JSON.stringify(t);return i[o]||(i[o]=new e(this.bundle.locales,t)),i[o]}};function sk(r,e){let t=Object.create(null);for(let[i,o]of Object.entries(r))e.includes(i)&&(t[i]=o.valueOf());return t}var MU=["unitDisplay","currencyDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits"];function AU(r,e){let t=r[0];if(t instanceof Wo)return new Wo(`NUMBER(${t.valueOf()})`);if(t instanceof zl)return new zl(t.valueOf(),{...t.opts,...sk(e,MU)});if(t instanceof Tp)return new zl(t.valueOf(),{...sk(e,MU)});throw new TypeError("Invalid argument to NUMBER")}var IU=["dateStyle","timeStyle","fractionalSecondDigits","dayPeriod","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName"];function VU(r,e){let t=r[0];if(t instanceof Wo)return new Wo(`DATETIME(${t.valueOf()})`);if(t instanceof Tp)return new Tp(t.valueOf(),{...t.opts,...sk(e,IU)});if(t instanceof zl)return new Tp(t.valueOf(),{...sk(e,IU)});throw new TypeError("Invalid argument to DATETIME")}var LU=new Map;function PU(r){let e=Array.isArray(r)?r.join(" "):r,t=LU.get(e);return t===void 0&&(t=new Map,LU.set(e,t)),t}var jv=class{constructor(e,{functions:t,useIsolating:i=!0,transform:o=n=>n}={}){this._terms=new Map,this._messages=new Map,this.locales=Array.isArray(e)?e:[e],this._functions={NUMBER:AU,DATETIME:VU,...t},this._useIsolating=i,this._transform=o,this._intls=PU(e)}hasMessage(e){return this._messages.has(e)}getMessage(e){return this._messages.get(e)}addResource(e,{allowOverrides:t=!1}={}){let i=[];for(let o=0;o<e.body.length;o++){let n=e.body[o];if(n.id.startsWith("-")){if(t===!1&&this._terms.has(n.id)){i.push(new Error(`Attempt to override an existing term: "${n.id}"`));continue}this._terms.set(n.id,n)}else{if(t===!1&&this._messages.has(n.id)){i.push(new Error(`Attempt to override an existing message: "${n.id}"`));continue}this._messages.set(n.id,n)}}return i}formatPattern(e,t=null,i=null){if(typeof e=="string")return this._transform(e);let o=new ak(this,i,t);try{return $P(o,e).toString(o)}catch(n){if(o.errors&&n instanceof Error)return o.errors.push(n),new Wo().toString(o);throw n}}};var jP=/^(-?[a-zA-Z][\w-]*) *= */gm,_U=/\.([a-zA-Z][\w-]*) *= */y,see=/\*?\[/y,YP=/(-?[0-9]+(?:\.([0-9]+))?)/y,lee=/([a-zA-Z][\w-]*)/y,OU=/([$-])?([a-zA-Z][\w-]*)(?:\.([a-zA-Z][\w-]*))?/y,cee=/^[A-Z][A-Z0-9_-]*$/,lk=/([^{}\n\r]+)/y,dee=/([^\\"\n\r]*)/y,RU=/\\([\\"])/y,FU=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{6})/y,pee=/^\n+/,NU=/ +$/,uee=/ *\r?\n/g,hee=/( *)$/,gee=/{\s*/y,BU=/\s*}/y,mee=/\[\s*/y,fee=/\s*] */y,bee=/\s*\(\s*/y,yee=/\s*->\s*/y,xee=/\s*:\s*/y,wee=/\s*,?\s*/y,vee=/\s+/y,wy=class{constructor(e){this.body=[],jP.lastIndex=0;let t=0;for(;;){let _=jP.exec(e);if(_===null)break;t=jP.lastIndex;try{this.body.push(l(_[1]))}catch(U){if(U instanceof SyntaxError)continue;throw U}}function i(_){return _.lastIndex=t,_.test(e)}function o(_,U){if(e[t]===_)return t++,!0;if(U)throw new U(`Expected ${_}`);return!1}function n(_,U){if(i(_))return t=_.lastIndex,!0;if(U)throw new U(`Expected ${_.toString()}`);return!1}function a(_){_.lastIndex=t;let U=_.exec(e);if(U===null)throw new SyntaxError(`Expected ${_.toString()}`);return t=_.lastIndex,U}function s(_){return a(_)[1]}function l(_){let U=d(),Y=c();if(U===null&&Object.keys(Y).length===0)throw new SyntaxError("Expected message value or attributes");return{id:_,value:U,attributes:Y}}function c(){let _=Object.create(null);for(;i(_U);){let U=s(_U),Y=d();if(Y===null)throw new SyntaxError("Expected attribute value");_[U]=Y}return _}function d(){let _;if(i(lk)&&(_=s(lk)),e[t]==="{"||e[t]==="}")return p(_?[_]:[],1/0);let U=A();return U?_?p([_,U],U.length):(U.value=I(U.value,pee),p([U],U.length)):_?I(_,NU):null}function p(_=[],U){for(;;){if(i(lk)){_.push(s(lk));continue}if(e[t]==="{"){_.push(g());continue}if(e[t]==="}")throw new SyntaxError("Unbalanced closing brace");let O=A();if(O){_.push(O),U=Math.min(U,O.length);continue}break}let Y=_.length-1,R=_[Y];typeof R=="string"&&(_[Y]=I(R,NU));let H=[];for(let O of _)O instanceof ck&&(O=O.value.slice(0,O.value.length-U)),O&&H.push(O);return H}function g(){n(gee,SyntaxError);let _=h();if(n(BU))return _;if(n(yee)){let U=x();return n(BU,SyntaxError),{type:"select",selector:_,...U}}throw new SyntaxError("Unclosed placeable")}function h(){if(e[t]==="{")return g();if(i(OU)){let[,_,U,Y=null]=a(OU);if(_==="$")return{type:"var",name:U};if(n(bee)){let R=f();if(_==="-")return{type:"term",name:U,attr:Y,args:R};if(cee.test(U))return{type:"func",name:U,args:R};throw new SyntaxError("Function names must be all upper-case")}return _==="-"?{type:"term",name:U,attr:Y,args:[]}:{type:"mesg",name:U,attr:Y}}return C()}function f(){let _=[];for(;;){switch(e[t]){case")":return t++,_;case void 0:throw new SyntaxError("Unclosed argument list")}_.push(y()),n(wee)}}function y(){let _=h();return _.type!=="mesg"?_:n(xee)?{type:"narg",name:_.name,value:C()}:_}function x(){let _=[],U=0,Y;for(;i(see);){o("*")&&(Y=U);let R=E(),H=d();if(H===null)throw new SyntaxError("Expected variant value");_[U++]={key:R,value:H}}if(U===0)return null;if(Y===void 0)throw new SyntaxError("Expected default variant");return{variants:_,star:Y}}function E(){n(mee,SyntaxError);let _;return i(YP)?_=S():_={type:"str",value:s(lee)},n(fee,SyntaxError),_}function C(){if(i(YP))return S();if(e[t]==='"')return v();throw new SyntaxError("Invalid expression")}function S(){let[,_,U=""]=a(YP),Y=U.length;return{type:"num",value:parseFloat(_),precision:Y}}function v(){o('"',SyntaxError);let _="";for(;;){if(_+=s(dee),e[t]==="\\"){_+=M();continue}if(o('"'))return{type:"str",value:_};throw new SyntaxError("Unclosed string literal")}}function M(){if(i(RU))return s(RU);if(i(FU)){let[,_,U]=a(FU),Y=parseInt(_||U,16);return Y<=55295||57344<=Y?String.fromCodePoint(Y):"\uFFFD"}throw new SyntaxError("Unknown escape sequence")}function A(){let _=t;switch(n(vee),e[t]){case".":case"[":case"*":case"}":case void 0:return!1;case"{":return P(e.slice(_,t))}return e[t-1]===" "?P(e.slice(_,t)):!1}function I(_,U){return _.replace(U,"")}function P(_){let U=_.replace(uee,`
`),Y=hee.exec(_)[1].length;return new ck(U,Y)}}},ck=class{constructor(e,t){this.value=e,this.length=t}};var Eee=["ae","ar","arc","bcc","bqi","ckb","dv","fa","glk","he","ku","mzn","nqo","pnb","ps","sd","ug","ur","yi"],on=class{constructor(e){this.value=e}},dk=class r{constructor(e,t){this.bundles=e;this.onError=t}static fromSources(e,t,i){let o=[];for(let{lang:n,source:a}of e){let s=n.split("-")[0],l=new jv(n,{...i,useIsolating:Eee.indexOf(s)>=0});l.addResource(new wy(a),{allowOverrides:!1}),l.addResource(new wy(`
l10n-internal-date-day-month-year = {DATETIME($d, month: "short", day: "numeric", year: "numeric")}
l10n-internal-date-day-month = {DATETIME($d, month: "short", day: "numeric")}
l10n-internal-time = {DATETIME($d, minute: "numeric", hour: "numeric")}
      `),{allowOverrides:!1}),o.push(l)}return new r(o,t)}format(e,t){for(let i of this.bundles){if(!i.hasMessage(e))continue;let o=i.getMessage(e);if(!(o!=null&&o.value))return;let n=[],a=i.formatPattern(o.value,this.coerceNumericVariables(t),n);for(let s of n)this.onError(`Error formatting ${e} for locale ${i.locales.join(",")}: ${s}`);return a}this.onError(`Couldn't find message for key ${e} for locales ${this.getLocales().join(",")}`)}formatDate(e,t){return t.showYear?this.format("l10n-internal-date-day-month-year",{d:e}):this.format("l10n-internal-date-day-month",{d:e})}formatTime(e){let t=this.format("l10n-internal-time",{d:e});return this.getLocales()[0]==="en"?t==null?void 0:t.toLowerCase():t}hasTranslation(e,t){for(let i of this.bundles)if(i.locales.indexOf(t)>=0)return i.hasMessage(e);return!1}coerceNumericVariables(e){let t={};for(let i in e){let o=e[i];o instanceof on?t[i]=o.value:typeof o=="number"?t[i]=`${o}`:t[i]=o}return t}getLocales(){return this.bundles.reduce((e,t)=>e.concat(t.locales),[])}};var pk="",XP={},UU={},JP={},See=["ar","hy-AM","hi","tr","xx-XX"];function uk(r){pk=r||""}function QP(r){for(let e in r)delete JP[e],UU[e]=r[e]}function ZP(r,e){let t=e!=null?e:pk;return KU(t).hasTranslation(r,t)}function Kl(r,e){if(e)for(var t in e)e.hasOwnProperty(t)&&(r=r.split("__"+t+"__").join(e[t]));return r}function Pn(r,e,t){return zU(r,e!=null?e:{},t!=null?t:pk)}function uc(r){return function(t,i){return zU(t,i!=null?i:{},r())}}function Dee(r){let e={};for(let t in r){let i=r[t];i!==void 0&&(e[t]=i)}return e}function zU(r,e,t){let o=KU(t).format(r,Dee(e));return o==null?(__dcg_shared_module_exports__['M'].warn(`Could not format string ${r}`),""):o}function KU(r){let e=JP[r];if(!e){XP[r]||(XP[r]=nk([r]));let t=[];for(let o of XP[r]){let n=UU[o];n&&t.push({lang:o,source:n})}let i={};r==="xx-XX"&&(i.transform=o=>o.replace(/[a-z]/gi,"\u2666")),e=JP[r]=dk.fromSources([...t,{lang:"en",source:kU}],o=>{__dcg_shared_module_exports__['M'].warn(o)},i)}return e}function Yv(){return pk}function e_(r){return pc.hasOwnProperty(r)||__dcg_shared_module_exports__['l'](See,r)}function Mp(r,e){if(r==null)return"";if(typeof r=="string")return r;if(typeof r=="number")return""+r;let t=r.vars,i;if(t){i={};for(let o in t)t.hasOwnProperty(o)&&(i[o]=Mp(t[o],e))}return Pn(r.key,i,e)}var Ip={cb20221031:"1"};var Xv=typeof desmosLocaleData=="object"?desmosLocaleData:{};function Jv(){for(var r=nk([pr("language"),navigator.userLanguage,navigator.language]),e=0;e<r.length;e++){var t=r[e];if(e_(t))return t}return"en"}async function vy(r){if(Xv[r]||r==="en"||r==="xx-XX")return uk(r),!0;if(!e_(r)){let i=r.indexOf("-")!==-1?r.split("-")[0]:r;for(let o in pc)if(i===o.split("-")[0]&&pc[o].useAsRoot){r=o;break}}let e=await fetch(`/api/v1/calculator/language/${r}.ftl?${new URLSearchParams(Ip)}`,{headers:{Accept:"application/json"}});if(!e.ok)throw e.status===404&&__dcg_shared_module_exports__['M'].warn(r+" is not an available language."),void 0;let t=await e.json();return Xv[r]=t[r],QP(Xv),uk(r),!0}function hk(r){return!!Xv[r]}QP(Xv);uk(Jv());var ih=class r extends Yr{constructor(){super();this.highlightPropertyMultipliers={};this.stateProperties=[],this.cloneProperties=[],this.highlightPropertyMultipliers={},this.config=new Yr;for(var t in Uc)Uc.hasOwnProperty(t)&&this.addStateProperty(t,Uc[t]);this.labelHangingColor="rgba(150,150,150,1)",this.lastChangedAxis="x",this.addDynamicProperties()}addDynamicProperties(){var t=this;function i(n,a,s){t.cloneProperties.push(n);function l(){t.setProperty(n,t.config.projectorMode?s:a)}t.config.observe("projectorMode",l),l()}function o(n,a,s,l,c){t.cloneProperties.push(n);function d(){var g;t.config.projectorMode?g=t.highlight?c:l:g=t.highlight?s:a,t.setProperty(n,g)}var p=[a,s,l,c];t.highlightPropertyMultipliers[n]=p.map(function(g){return g/p[0]}),t.observe("highlight",d),t.config.observe("projectorMode",d),d()}i("labelSize",14,19),i("majorAxisOpacity",.4,1),i("minorAxisOpacity",.12,.25),i("axisOpacity",.9,.9),i("axisLineWidth",1.5,2),i("axisLineOffset",.25,0),i("pixelsPerLabel",80,120),o("curveOpacity",.7,1,.7,1),i("globalCurveColor",void 0,void 0),i("disableFill",!1,!1),o("graphLineWidth",2.5,3.5,5,7),o("pointLineWidth",8,8*1.2,8*1.3,8*1.2*1.3)}setController(t){this.controller=t,this.registerCallbacks()}getHighlightPropertyMultiplier(t,i){var o=i?1:0;return this.config.projectorMode?this.highlightPropertyMultipliers[t][2+o]:this.highlightPropertyMultipliers[t][o]}getFillOpacityMultiplier(){return this.highlight&&this.controller&&this.controller.isGeometry()?1.3:1}addStateProperty(t,i){this[t]=i,this.stateProperties.push(t),this.cloneProperties.push(t)}static fromObject(t){var i=new r;return i.cloneProperties.forEach(function(o){t.hasOwnProperty(o)&&i.setProperty(o,t[o])}),i}registerCallbacks(){var t=()=>{var i;(i=this.controller)==null||i.requestRedrawGraph()};this.stateProperties.forEach(i=>{this.observe(i,t)}),this.config.observe("backgroundColor",t),this.config.observe("textColor",t),this.config.observe("invertedColors",t),this.observe("backgroundColor",t),this.observe("textColor",t),this.config.observe("enableTabindex",t),this.config.observeAndSync("projectorMode",t)}_validateSetting(t,i){var o;switch(t){case"xAxisMinorSubdivisions":case"yAxisMinorSubdivisions":o=Math.round(Math.min(Math.max(0,i),5)),i!==o&&__dcg_shared_module_exports__['M'].warn("minorSubdivisions must be an integer between 0 and 5. You provided "+i+", which we changed to "+o+".");break;case"degreeMode":case"projectorMode":case"showGrid":case"showXAxis":case"showYAxis":case"xAxisNumbers":case"yAxisNumbers":case"polarNumbers":case"enableTabindex":case"invertedColors":o=i==="false"?!1:!!i,i!==o&&__dcg_shared_module_exports__['M'].warn(t+" must be a Boolean. You provided "+i+" ("+typeof i+"), which we changed to "+o+" ("+typeof o+").");break;case"xAxisStep":case"yAxisStep":o=parseFloat(i),isFinite(i)||(o=0,__dcg_shared_module_exports__['M'].warn(t+" must be a number. You provided "+i+", which we changed to "+o+"."));break;case"xAxisScale":case"yAxisScale":o=i,!this.config.logScales&&i==="logarithmic"?(o="linear",__dcg_shared_module_exports__['M'].warn("Must set logScales: true to set "+t+" to 'logarithmic'.")):i!=="linear"&&i!=="logarithmic"&&(o="linear",__dcg_shared_module_exports__['M'].warn(t+' must be "linear" or "logarithmic". You provided '+i+", which we changed to "+o+"."));break;case"xAxisArrowMode":case"yAxisArrowMode":o=__dcg_shared_module_exports__['L'][i],o!==i&&(o="NONE",__dcg_shared_module_exports__['M'].warn(`unknown AxisArrowMode. Allowed values are: 
`+__dcg_shared_module_exports__['B'](__dcg_shared_module_exports__['L']).join(`
`)));break;case"xAxisLabel":case"yAxisLabel":o=i,typeof i!="string"&&(o="",__dcg_shared_module_exports__['M'].warn(t+" must be a string. you provided a "+typeof i+"."));break;case"randomSeed":o=i,typeof i!="string"&&(o=""+i,__dcg_shared_module_exports__['M'].warn("randomSeed must be a string. you provided a "+typeof i+"."));break;case"backgroundColor":o=i,typeof i!="string"&&(o="",__dcg_shared_module_exports__['M'].warn(t+" must be a string. you provided a "+typeof i+".")),o||(o="#fff"),o[0]!=="#"&&(o="#"+o);break;case"textColor":o=i,typeof i!="string"&&(o="",__dcg_shared_module_exports__['M'].warn(t+" must be a string. you provided a "+typeof i+".")),o||(o="#000"),o[0]!=="#"&&(o="#"+o);break;case"fontSize":o=i,typeof i!="number"&&(o=parseInt(o,10),__dcg_shared_module_exports__['M'].warn("fontSize must be a number. Attempted to convert "+i+" to "+o+"."));break;case"language":o=i,typeof i!="string"&&(o="",__dcg_shared_module_exports__['M'].warn(t+" must be a string. you provided a "+typeof i+".")),i!=="en"&&!hk(i)&&(o="en",__dcg_shared_module_exports__['M'].warn(i+" is not currently an available language."));break;default:o=i;break}return o}validateSettings(t){var i={},o=!1;for(var n in t)this.stateProperties.indexOf(n)>=0?i[n]=this._validateSetting(n,t[n]):(__dcg_shared_module_exports__['M'].warn('Invalid graph setting "'+n+'".'),o=!0);return o&&__dcg_shared_module_exports__['M'].warn(`Available graph settings are: 
`+this.stateProperties.join(`
`)),i}getBackgroundColor({invertWhite:t}={invertWhite:!1}){var i=__dcg_shared_module_exports__['N'](this.config.backgroundColor||"#fff");return this.config.invertedColors&&(i!=="#ffffff"||t)?__dcg_shared_module_exports__['R'](i):i}getTextColor({invertBlack:t}={invertBlack:!1}){var i=__dcg_shared_module_exports__['N'](this.config.textColor||"#000");return this.config.invertedColors&&(i!=="#000000"||t)?__dcg_shared_module_exports__['R'](i):i}};qt();var FY=__dcg_shared_module_exports__['e'](te());function e4(r,e){var t=__dcg_shared_module_exports__['Bb'](r),i=__dcg_shared_module_exports__['Bb'](e);if(__dcg_shared_module_exports__['ja'](t.n/t.d,r)&&__dcg_shared_module_exports__['ja'](i.n/i.d,e)){var o=__dcg_shared_module_exports__['Db'](t.d,i.d),n=t.n*(o/t.d),a=i.n*(o/i.d),s=a-n;return{nstart:n,nstep:s,lcm:o}}}var t4={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function u_(r){let e=[],t=r.toLowerCase();if(t.slice(0,3)==="rgb")try{e=t.replace(/[^\d,]/g,"").split(",").slice(0,3).map(function(o){return parseInt(o,10)})}catch(o){p_(r)}else if(t[0]==="#"){var i=/^#?([a-f\d])([a-f\d])([a-f\d])$/;t=t.replace(i,function(o,n,a,s){return n+n+a+a+s+s});try{e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/.exec(t).slice(1).map(function(o){return parseInt(o,16)})}catch(o){p_(r)}}else e=t4[t];return Yee(e)||p_(r),{R:e[0],G:e[1],B:e[2]}}function Yee(r){return!__dcg_shared_module_exports__['G'](r)||r.length!==3?!1:__dcg_shared_module_exports__['j'](r,function(e){return Number.isInteger(e)&&e>=0&&e<=255})}function p_(r){throw new Error("Invalid color string: "+r)}function r4(r){var e=r.R/255,t=r.G/255,i=r.B/255,o=[];return o[0]=.49*e+.31*t+.2*i,o[1]=.17697*e+.8124*t+.01063*i,o[2]=.01*t+.99*i,o=__dcg_shared_module_exports__['h'](o,function(n){return n/.17697}),{X:o[0],Y:o[1],Z:o[2]}}function i4(r){var e=95.047,t=100,i=108.883,o=r.X,n=r.Y,a=r.Z,s=[];return s[0]=116*rC(n/t)-16,s[1]=500*(rC(o/e)-rC(n/t)),s[2]=200*(rC(n/t)-rC(a/i)),{L:s[0],a:s[1],b:s[2]}}function rC(r){var e=.20689655172413793;return r>Math.pow(e,3)?Math.pow(r,1/3):r/(3*e*e)+4/29}function Xee(r,e){var t=1,i=.045,o=.015,n=1,a=1,s=1,l=r.L,c=r.a,d=r.b,p=e.L,g=e.a,h=e.b,f=l-p,y=Math.sqrt(c*c+d*d),x=Math.sqrt(g*g+h*h),E=y-x,C=c-g,S=d-h,v=Math.sqrt(C*C+S*S-E*E),M=1+i*y,A=1+o*y,I=f/(t*s),P=E/(n*M),_=v/(a*A);return Math.sqrt(I*I+P*P+_*_)}function Jee(r,e){var t=i4(r4(u_(r))),i=i4(r4(u_(e)));return Xee(t,i)}function o4(r,e){var t=__dcg_shared_module_exports__['h'](e,function(o){return Jee(r,o)}),i=__dcg_shared_module_exports__['o'](t);return e[t.indexOf(i)]}function Qee({R:r,G:e,B:t}){return .2126729*(r/255)**2.4+.7151522*(e/255)**2.4+.072175*(t/255)**2.4}var h_=.342;function g_(r,e=!1,t=h_){if(typeof r!="string"||!r)return!1;try{let i=u_(r);return Qee(i)>t?!e:e}catch(i){return!1}}function Bi(r,e){var t=/^\s*(\-|\+)?([0-9]+(\.[0-9]+)?)\s*$/;if(t.test(r))return parseFloat(r);var i=Object.create(__dcg_shared_module_exports__['cc']);return i.trigAngleMultiplier=new __dcg_shared_module_exports__['bc'](e?Math.PI/180:1),+__dcg_shared_module_exports__['Ec'](r).tryGetConcreteTree(__dcg_shared_module_exports__['dc'],i).asValue()}function Yi(r,e){if(!isFinite(r))return r;if(!isFinite(e))return e;var t=__dcg_shared_module_exports__['ea'](r,e);if(r>0!=e>0||r===0||e===0)return 0;var i=r>0?1:-1,o=Math.abs(r).toExponential().split("e"),n=Math.abs(e).toExponential().split("e"),a=o[0],s=n[0],l=o[1],c=n[1];if(c!==l)return i*Math.pow(10,Math.max(parseFloat(l),parseFloat(c)));if(a[0]!==s[0])return parseFloat(t.toPrecision(1));for(var d=1,p=2;p<Math.min(a.length,s.length)&&(d++,a[p]===s[p]);p++);return parseFloat(t.toPrecision(d))}function Zee(r){return __dcg_shared_module_exports__['ma'](r)!==null}var Sy=Zee;function iC(r){let e=__dcg_shared_module_exports__['Ec'](r);if(e.type!=="Assignment")return NaN;if(e._expression.type!=="Constant")return NaN;if(!new __dcg_shared_module_exports__['ud']({enableGeometry:!1,enable3d:!1,beta3d:!1,scales:void 0}).validLHS(e._symbol))return NaN;if(__dcg_shared_module_exports__['cc'][e._symbol])return NaN;let i=e._expression.asValue();return typeof i=="number"?i:NaN}function ete(r){switch(r.type){case"TokenNode":case"Letter":return!0;case"OperatorName":{for(let e of r.arg.args)if(e.type!=="Letter")return!1;return!0}case"Cmd":return __dcg_shared_module_exports__['Ac'](r.val);default:return!1}}function m_(r){let e;try{e=__dcg_shared_module_exports__['wc'](r)}catch(o){return}if(e.args.length===0||e.args.length>2)return;let t=e.args[0];if(!ete(t))return;let i;if(e.args.length>1){let o=e.args[1];if(o.type!=="SupSub")return;let{sup:n,sub:a}=o;if(n!==void 0||a===void 0)return;for(let s of a.args)if(s.type!=="Letter"&&s.type!=="Digit")return;i=a}return{base:t,subscript:i}}function ul(r){return m_(r)!==void 0}function c4(r){let e=__dcg_shared_module_exports__['wc'](r),t=__dcg_shared_module_exports__['Dc'](e);switch(t.type){case"Letter":return t.val;case"Cmd":return t.val;default:return}}function a4(r){return r.replace(/^(\\? )+|(\\? )+$/g,"")}function d4(r){try{let e=__dcg_shared_module_exports__['wc'](r),t=__dcg_shared_module_exports__['Dc'](e);if(t.type==="Comparator"&&t.symbol==="="&&(t=t.args[1]),t.type==="Call"){let i=t.args[1];return i.type==="Seq"?i.args:[i]}return}catch(e){return}}function oC(r){let e=r.indexOf("=");if(e===-1)return;let t=a4(r.slice(0,e));if(ul(t))return t;try{let i=__dcg_shared_module_exports__['wc'](`${t}=0`),o=__dcg_shared_module_exports__['Dc'](i);if(o.type==="Comparator"&&o.symbol==="="&&__dcg_shared_module_exports__['Cc'](o.args[0])){let n=r.indexOf("\\left(");if(n===-1&&(n=r.indexOf("(")),n===-1)return;let a=a4(r.slice(0,n));if(ul(a))return a}}catch(i){}}function ky(r,e){let t=m_(e);if(t===void 0)return[];let i=[],o;try{o=__dcg_shared_module_exports__['wc'](r)}catch(n){return i}return Dy(o,t,i,{wrapInBraces:!1}),i}function Od(r,e){return ky(r,e).length!==0}function Dk(r,e,t){return m_(t)===void 0?r:f_(r,e,t)}function f_(r,e,t){let i=ky(r,e);if(i.length===0)return r;let o="",n=0;for(let a of i){if(o+=r.slice(n,a.base.start),a.wrapInBraces&&(o+="{"),o+=t,n=a.base.end,a.subscript){let s=0,l=0;for(let c=a.subscript.start;c>=0;c--)if(r[c]==="{"&&(s+=1),r[c]==="_"){l=c;break}o+=r.slice(n,l),n=a.subscript.end;for(let c=a.subscript.end;c<r.length&&!(s<=0);c++)r[c]==="}"&&(s-=1,n=c+1)}a.wrapInBraces&&(o+="}")}return o+=r.slice(n,r.length),o}function s4(r,e){if(r.args.length!==e.args.length)return!1;for(let t=0;t<r.args.length;t++){let i=r.args[t],o=e.args[t];if(!(i.type==="Letter"&&o.type==="Letter"&&i.val===o.val)&&!(i.type==="Digit"&&o.type==="Digit"&&i.val===o.val))return!1}return!0}function tte(r,e,t){let i=r.arg.args,o=e.arg.args;if(i.length===o.length){for(let n=0;n<i.length;n++){let a=i[n],s=o[n];if(a.type!=="Digit"||a.type!==s.type||a.val!==s.val)return}t.push({base:e.span,wrapInBraces:!1})}}function Dy(r,e,t,{wrapInBraces:i}){let{base:o,subscript:n}=e;for(let a=0;a<r.args.length;a++){let s=a-1>=0?r.args[a-1]:void 0,l=r.args[a],c;if(a+1<r.args.length){let d=r.args[a+1];d.type==="SupSub"&&d.sub!==void 0&&(c=d.sub)}switch(l.type){case"Letter":case"Cmd":if(o.type!==l.type||o.val!==l.val)break;if(n&&c&&s4(n,c))t.push({base:l.span,subscript:c.span,wrapInBraces:i});else if(!n&&!c){if((s==null?void 0:s.type)==="Symbol"&&s.val==="."&&l.type==="Letter"&&(o.val==="x"||o.val==="y"||o.val==="z"))break;t.push({base:l.span,wrapInBraces:i})}break;case"OperatorName":{if(o.type!==l.type||o.arg.args.length!==l.arg.args.length)break;let d=!0;for(let p=0;p<o.arg.args.length;p++){let g=o.arg.args[p],h=l.arg.args[p];if(g.type!=="Letter"||h.type!=="Letter"||g.val!==h.val){d=!1;break}}if(!d)break;n&&c&&s4(n,c)?t.push({base:l.span,subscript:c.span,wrapInBraces:i}):!n&&!c&&t.push({base:l.span,wrapInBraces:i});break}case"Digit":case"Symbol":case"EscapedSymbol":break;case"LeftRight":case"Sqrt":Dy(l.arg,e,t,{wrapInBraces:!1});break;case"Frac":Dy(l.num,e,t,{wrapInBraces:!1}),Dy(l.den,e,t,{wrapInBraces:!1});break;case"SupSub":(s==null?void 0:s.type)==="Cmd"&&__dcg_shared_module_exports__['Bc'](s.val)&&l.sub&&Dy(l.sub,e,t,{wrapInBraces:!l4(l.sub,"_")}),l.sup&&Dy(l.sup,e,t,{wrapInBraces:!l4(l.sup,"^")});break;case"TokenNode":{if(o.type!==l.type)break;tte(o,l,t)}break;default:{let d=l;throw new Error("Unexpected token type: "+d.type)}}}}function l4(r,e){for(let t=r.span.start;t>=0;t--){let i=r.span.input[t];if(i===e)break;if(i==="{")return!0}return!1}as();var Gy=class{suspend(){return new Promise((e,t)=>{if(this.audioContext)this.audioContext.suspend().then(()=>{e()}).catch(i=>{Ii(i),t(i)});else{e();return}})}getResumedAudioContext(){return new Promise((e,t)=>{if(!this.audioContext){let i=window.AudioContext||window.webkitAudioContext;if(!i){t();return}try{this.audioContext=new i({latencyHint:"interactive",sampleRate:44100})}catch(o){t(o)}}this.audioContext&&(this.audioContext.state!=="running"?this.audioContext.resume().then(()=>{e({audioContext:this.audioContext,poiBuffer:this.poiBuffer})}).catch(i=>{Ii(i),t(i)}):this.audioContext.resume().then(()=>{e({audioContext:this.audioContext,poiBuffer:this.poiBuffer})}).catch(i=>{Ii(i),t(i)}))})}};Rc();var kk=class{constructor(e,t){this.cb=e;this.document=t;this.observedAriaLiveElements=new WeakMap;this.destroyed=!1;this.onAriaLabelFocus=e=>{let t=e.target;if(this.isElement(t)){let i=t.getAttribute("aria-label");i&&this.cb(i,"label")}};this.document.documentElement.addEventListener("focus",this.onAriaLabelFocus,!0),this.ariaLiveContentObserver=new MutationObserver(i=>this.handleAriaLiveContentMutations(i)),t.documentElement.querySelectorAll('[aria-live="assertive"]').forEach(i=>this.startObservingAriaLiveElement(i)),this.treeObserver=new MutationObserver(i=>this.handleDocumentTreeMutations(i)),this.treeObserver.observe(t.documentElement,{childList:!0,subtree:!0,attributeFilter:["aria-live"]})}destroy(){this.destroyed=!0,this.document.documentElement.removeEventListener("focus",this.onAriaLabelFocus,!0),this.ariaLiveContentObserver.disconnect()}isObservingElement(e){return!!this.observedAriaLiveElements.get(e)}handleAriaLiveContentMutations(e){var i;let t=new Map;for(let o of e){if(!this.observedAriaLiveElements.get(o.target))continue;let n=t.get(o.target);n||(n=[],t.set(o.target,n)),n.push(o)}for(let[o,n]of t){let a=o.cloneNode(!0),s=[a.textContent||""];for(let l=n.length-1;l>=0;l--){let c=n[l];switch(c.type){case"attributes":{c.attributeName!==null&&a.setAttribute(c.attributeName,c.oldValue||""),s.push(a.textContent||"");break}case"characterData":{c.oldValue!==null&&(a.textContent=c.oldValue),a.textContent&&a.textContent!==s[s.length-1]&&s.push(a.textContent);break}case"childList":{if(c.addedNodes.length>1||c.removedNodes.length>1)throw new Error(`Expected at most one removed node and one added node, but got ${c.removedNodes.length} removed nodes and ${c.addedNodes.length} added nodes`);c.addedNodes.length===1&&((i=a.firstChild)==null||i.remove()),c.removedNodes.length===1&&c.removedNodes.forEach(d=>a.appendChild(d.cloneNode(!0))),a.textContent&&a.textContent!==s[s.length-1]&&s.push(a.textContent);break}}}for(let l of s.reverse())this.cb(l,"alert")}}startObservingAriaLiveElement(e){this.destroyed||e.getAttribute("aria-live")==="assertive"&&(this.observedAriaLiveElements.get(e)||(this.observedAriaLiveElements.set(e,!0),e.textContent&&this.cb(e.textContent,"alert"),this.ariaLiveContentObserver.observe(e,{attributes:!0,characterData:!0,childList:!0,attributeOldValue:!0,characterDataOldValue:!0})))}stopObservingAriaLiveElement(e){this.observedAriaLiveElements.set(e,!1)}handleDocumentTreeMutations(e){for(let t of e)t.addedNodes.forEach(i=>{this.isElement(i)&&i.getAttribute("aria-live")==="assertive"&&this.startObservingAriaLiveElement(i)}),this.isElement(t.target)&&t.attributeName==="aria-live"&&(t.target.getAttribute("aria-live")==="assertive"?this.startObservingAriaLiveElement(t.target):this.stopObservingAriaLiveElement(t.target)),t.removedNodes.forEach(i=>{this.isElement(i)&&(this.stopObservingAriaLiveElement(i),i.querySelectorAll('[aria-live="assertive"]').forEach(o=>this.stopObservingAriaLiveElement(o)))})}isElement(e){var i;let t=(i=this.document.defaultView)==null?void 0:i.Element;return t?e instanceof t:!1}};var Lp,Gk=[],p4="",rte;function On(){Lp&&(Lp.textContent="")}function Kt(r){Gk.push(r)}function Te(r){if(r!==void 0&&Kt(r),Lp&&Gk.length>0){let e=Gk.join(" ").replace(/ +(?= )/g,"");Lp.setAttribute("aria-relevant",p4===e&&Ti?"all":"additions text"),Lp.textContent=e,p4=e}Gk.length=0}function ite(){Lp=document.createElement("p"),Lp.setAttribute("aria-live","assertive"),Lp.setAttribute("aria-atomic","true"),Lp.classList.add("dcg-aria-alert"),document.body.appendChild(Lp),tn().logAria&&(rte=new kk((e,t)=>__dcg_shared_module_exports__['M'].log(`[aria ${t}] ${e}`),document))}XD(ite);var ote=.25;function u4(r,e){return ote*__dcg_shared_module_exports__['pa'](r,0,nte(e))}function nte(r){return r<=0||!isFinite(r)?0:__dcg_shared_module_exports__['pa'](660/r,0,10)}var ss,ate="data:audio/mpeg;base64,//uQx"+"A".repeat(23)+"WGluZwAAAA8AAAACAAACcQCA"+"gICA".repeat(16)+"/".repeat(66)+"8AAABhTEFNRTMuMTAwA8MAAAAAAAAAABQgJAUHQQAB9AAAAnGMHkkI"+"A".repeat(320)+"//sQxAADgnABGiAAQBCqgCRMAAgEAH"+"/".repeat(15)+"7+n/9FTuQsQH//////2NG0jWUGlio5gLQTOtIoeR2WX////X4s9Atb/JRVCbBUpeRUq"+"/".repeat(18)+"9RUi0f2jn/+xDECgPCjAEQAABN4AAANIAAAAQVTEFNRTMuMTAw"+"V".repeat(97)+"Q==";function ste(){ss&&(ss.src="about:blank",ss.load(),ss=void 0)}function Tk(){if(!(!ll&&!Fc)){if(!ss){let r=document.createElement("div");ss=document.createElement("audio"),r.appendChild(ss),ss.setAttribute("x-webkit-airplay","deny"),ss.controls=!1,ss.disableRemotePlayback=!0,ss.preload="auto",ss.loop=!0,ss.src=ate,ss.load()}ss.paused&&ss.play().catch(ste)}}function Mk(){ss&&ss.pause()}var h4=44100,Pp=ny?.02:0,nC=class{constructor(e){this.expressionSynthMap=new Map;this.useOfflineContext=!1;this.globalUnmuteState=!1;this.hasEverInteractedWithMute=!1;this.maxGain=.5;this.handleVisibilityChange=()=>{!this.audioContext||this.isGlobalMuted()||document.visibilityState==="hidden"&&this.controller.dispatch({type:"mute-global"})};this.handleBeforeUnload=()=>{if(!this.audioContext||this.isGlobalMuted())return;let e=this.audioContext;e instanceof AudioContext&&setTimeout(()=>{if(e.state!=="closed")try{e.close()}catch(t){}},100),this.controller.dispatch({type:"mute-global"}),this.controller.runAfterDispatch(()=>this.clearAudioContext())};this.audioContextManager=new Gy,this.controller=e,document.addEventListener("visibilitychange",this.handleVisibilityChange),window.addEventListener("beforeunload",this.handleBeforeUnload)}unload(){this.handleBeforeUnload()}setOfflineAudio(){this.useOfflineContext=!0}prepareToRenderAudio(e){this.useOfflineContext&&(this.offlineBuffer=void 0,this.audioContext=new OfflineAudioContext(1,e*h4,h4),this.audioContext.addEventListener("complete",async t=>{this.offlineBuffer=t.renderedBuffer,this.clearAudioContext()}),this.createMainNodes(),this.recomputeAudio())}getHasEverInteractedWithMute(){return this.hasEverInteractedWithMute}registerMuteInteraction(){this.hasEverInteractedWithMute=!0}async startRendering(){return this.audioContext.startRendering()}getRenderedBuffer(){return this.offlineBuffer}clearAudioContext(){for(let e of this.expressionSynthMap.values())e.tearDown();this.audioContext=void 0,this.expressionSynthMap=new Map}async spinUpAudioContext(){if(!this.useOfflineContext){if(this.audioContext)this.audioContext.state==="suspended"&&!this.useOfflineContext&&await this.audioContext.resume();else{let e=await this.audioContextManager.getResumedAudioContext();this.audioContext=e.audioContext}this.gainNode||this.createMainNodes()}}createMainNodes(){this.audioContext&&(this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=0,this.compressor=this.audioContext.createDynamicsCompressor(),this.compressor.threshold.value=-10,this.compressor.knee.value=4,this.compressor.ratio.value=20,this.compressor.attack.value=.01,this.compressor.release.value=.01,this.gainNode.connect(this.compressor),this.compressor.connect(this.audioContext.destination))}async _recomputeAudio(e){var t,i,o,n,a,s,l;if(e.length!==0&&!(this.nothingShouldSound()&&((t=this.audioContext)==null?void 0:t.state)!=="running")){if(this.useOfflineContext){if(!this.audioContext)return}else await this.spinUpAudioContext();if(this.nothingShouldSound()){if(this.expressionSynthMap.size>0){for(let c of this.expressionSynthMap.values())c.tearDown();this.expressionSynthMap.clear()}}else for(let c of e){let d=c.type==="expression"?c.formula.typed_constant_value:void 0,p=c.id;d&&!this.expressionSynthMap.has(p)&&this.expressionSynthMap.set(p,new Ik(this,this.gainNode)),(i=this.expressionSynthMap.get(p))==null||i.updateFromValues(d),c.type==="remove"&&this.expressionSynthMap.has(p)?((o=this.expressionSynthMap.get(p))==null||o.tearDown(),this.expressionSynthMap.delete(p)):c.type==="expression"&&(sC(c)?(a=this.expressionSynthMap.get(p))==null||a.setGain(0):(n=this.expressionSynthMap.get(p))==null||n.setGain(this.maxGain))}this.audioContext&&(this.expressionSynthMap.size>0&&!this.isGlobalMuted()?(s=this.gainNode)==null||s.gain.setTargetAtTime(1,this.audioContext.currentTime+Pp,nh):(l=this.gainNode)==null||l.gain.setTargetAtTime(0,this.audioContext.currentTime+Pp,nh))}}nothingShouldSound(){return!this.globalUnmuteState||!this.hasAnyUnmutedTones()}recomputeAudio(){lC(this.controller.getListModel());let t=this.controller.getAllItemModels().filter(n=>aC(n)),i=[],o=new Set(t.map(n=>n.id));for(let n of this.expressionSynthMap.keys())o.has(n)||i.push({id:n,type:"remove"});this._recomputeAudio([...t,...i])}isGlobalMuted(){return!this.globalUnmuteState}someExpressionsShouldPlayTones(){var e,t;return(t=(e=this.controller)==null?void 0:e.getAllItemModels())==null?void 0:t.some(i=>aC(i))}hasAnyUnmutedTones(){return g4(this.controller.getListModel())}handleAction(e){var t,i,o,n;switch(e.type){case"mute-global":{Mk(),this.globalUnmuteState=!1,(i=(t=this.controller).logEvent)==null||i.call(t,{category:"tone",action:"mute-global"});break}case"unmute-global":{Tk(),this.globalUnmuteState=!0,this.hasEverInteractedWithMute=!0,(n=(o=this.controller).logEvent)==null||n.call(o,{category:"tone",action:"unmute-global"});break}default:return e}this.recomputeAudio()}handleMuteKeyShortcut(){this.controller.toneItemsExist()?this.isGlobalMuted()?(this.controller.dispatch({type:"unmute-global"}),Kt(this.controller.s("graphing-calculator-narration-unmuted")),this.someExpressionsShouldPlayTones()||Kt(this.controller.s("graphing-calculator-narration-no-playing-tones"))):(this.controller.dispatch({type:"mute-global"}),Kt(this.controller.s("graphing-calculator-narration-muted"))):Kt(this.controller.s("graphing-calculator-narration-no-tone-expressions")),Te()}};var nh=.005,lte=15e-5,Ty=20,My=2e4,b_=class{constructor(e,t){e.audioContext&&(this.audioContext=e.audioContext,this.oscillator=this.audioContext.createOscillator(),this.oscillator.type="sine",this.gain=this.audioContext.createGain(),this.gain.gain.value=0,this.oscillator.connect(this.gain),this.gain.connect(t),this.oscillator.start())}stop(e=0){this.gain.gain.setTargetAtTime(0,this.audioContext.currentTime+e+Pp,nh),setTimeout(()=>{this.oscillator.stop()},1e3*(2*nh+e+Pp)+1)}setFrequencyAndGain(e,t){(!isFinite(e)||!isFinite(t)||e>My||e<Ty)&&(t=0);let i=u4(t,e);i>0&&this.oscillator.frequency.setTargetAtTime(__dcg_shared_module_exports__['pa'](e,Ty,My),this.audioContext.currentTime+Pp,lte),this.gain.gain.setTargetAtTime(i,this.audioContext.currentTime+Pp,nh)}},Ik=class{constructor(e,t){e.audioContext&&(this.audioContext=e.audioContext,this.gain=this.audioContext.createGain(),this.gain.gain.value=0,this.gain.connect(t),this.synthesizers=[])}updateFromValues(e){var t,i,o;if(e&&e.valueType===__dcg_shared_module_exports__['Ya'])this.synthesizers.length>1?(this.tearDownSynthesizers(this.synthesizers.slice(1)),this.synthesizers.length=1):this.synthesizers.length===0&&(this.synthesizers=[this.makeSynth()]),(t=this.synthesizers[0])==null||t.setFrequencyAndGain(e.value[0],e.value[1]);else if(e&&e.valueType===__dcg_shared_module_exports__['Za']){if(this.synthesizers.length>e.value.length&&(this.tearDownSynthesizers(this.synthesizers.slice(e.value.length)),this.synthesizers.length=e.value.length),e.value.length>this.synthesizers.length)for(let n=this.synthesizers.length;n<e.value.length;n++)this.synthesizers.push(this.makeSynth());for(let n=0;n<e.value.length;n++)this.synthesizers[n].setFrequencyAndGain(e.value[n][0],e.value[n][1])}else this.tearDownSynthesizers(this.synthesizers),this.synthesizers=[];this.synthesizers.length>0?(i=this.gain)==null||i.gain.setTargetAtTime(1,this.audioContext.currentTime+Pp,nh):(o=this.gain)==null||o.gain.setTargetAtTime(0,this.audioContext.currentTime+Pp,nh)}makeSynth(){return new b_(this,this.gain)}tearDownSynthesizers(e){if(e)for(let t of e)t.stop()}setGain(e){this.gain.gain.setTargetAtTime(e,this.audioContext.currentTime+Pp,nh)}tearDown(){this.tearDownSynthesizers(this.synthesizers),this.synthesizers=[]}};as();function x_(r){return r===void 0?NaN:+r}function Xc(r){return!!r&&r.type==="expression"&&!!r.formula&&!!r.formula.typed_constant_value&&!!r.formula.geometry}var y4={smallCutoff:1e-6,bigCutoff:1e9,digits:12};function x4(r){let e=r.formula;return e?r.controller.isDecimalToFractionEnabled()&&e.hasOwnProperty("constant_value")&&__dcg_shared_module_exports__['qb'](x_(e.constant_value)):!1}function xg(r){return!!(r.formula&&r.formula.is_graphable)}function w_(r){let e=r.formula;if(!e)return!1;let i=!(e.operator==="="&&r.controller.isThreeDMode()&&(e.assignment==="x"||e.assignment==="y"||e.assignment==="z"||e.assignment==="r"))&&e.is_evaluable&&e.zero_values&&e.zero_values.length>0&&typeof e.zero_values[0].val!="boolean"&&!(__dcg_shared_module_exports__['Ec'](r.latex)instanceof __dcg_shared_module_exports__['fc']),o=x4(r)&&wg(r),n=!!e.rgb_value&&r.formula.assignment;return i||o||n}function v_(r){let e=r.formula;return w_(r)?e.zero_values&&e.zero_values.length?e.zero_values[0].val:e.rgb_value?e.rgb_value:e.constant_value:x4(r)?r.formula.constant_value:NaN}function Iy(r){var e=r.formula.ttest_results;if(!(!e||!isFinite(e.lessThan)))return{lessThan:e.lessThan,greaterThan:e.greaterThan,notEqual:e.notEqual}}function Ay(r){var e=r.formula.stats_results;if(!(!e||!isFinite(e.min)))return{min:e.min,q1:e.q1,median:e.median,q3:e.q3,max:e.max}}function yg(r,e){if(!isFinite(e))return r;let t=r.indexOf("=")+1;return Bi(r.slice(t),!1)===e?r:r.slice(0,t)+__dcg_shared_module_exports__['Oc'](e)}function Hl(r){var e=r.latex||"",t=r.label||"",i=e+t;return i.split(" ").join("")===""}function mo(r,e={isReverseDrag:!1}){let t=r.dragMode==="AUTO"&&r.formula.default_drag_mode!==void 0?r.formula.default_drag_mode:r.dragMode;return r.controller.isThreeDMode()&&(t="NONE"),r.dragMode==="AUTO"&&!e.isReverseDrag&&ls(r)&&(t="NONE"),__dcg_shared_module_exports__['$b'](t,r.formula.move_strategy)}function pte(r){let e=mo(r);r.interactiveLabel&&e!=="NONE"&&yC(r,!1)}function Yc(r,e,t){if(!r.sliderExists)return NaN;let i=hc(r),o=Rd(r),n=Jc(r);if(t&&t.overwriteStep!==void 0&&(n=t.overwriteStep),e=__dcg_shared_module_exports__['mc']({target:e,hardMin:r.slider.hardMin?i:void 0,hardMax:r.slider.hardMax?o:void 0,step:n}),!t||!t.ignoreSoftLimits){if(!r.slider.hardMin&&e<i)return i;if(!r.slider.hardMax&&e>o)return o}return e}function C_(r,e,t={}){if(!r.sliderExists)return NaN;let i=hl(r),o=hc(r),n=Rd(r),a=Jc(r);t.overwriteStep===void 0&&(t.overwriteStep=a||(n-o)/20);var s=0;switch(e){case"min":return Yc(r,o);case"max":return Yc(r,n);case"up":s=1;break;case"down":s=-1;break;case"bigup":s=5;break;case"bigdown":s=-5;break;default:return e}let l=i;for(var c=0;c<20;c++){let d=c/3*t.overwriteStep,p=i;if(s>0)i=Yc(r,l+d,t),i>p&&(s-=1);else if(s<0)i=Yc(r,l-d,t),i<p&&(s+=1);else break}return i}function Ak(r,e){if(r.sliderExists){r.slider.isPlaying&&$l(r,!1);var t=Yc(r,e,{ignoreSoftLimits:!0});r.latex=yg(r.latex,t)}}function w4(r,e,t){if(r.sliderExists){r.slider.isPlaying&&$l(r,!1),Oy(r);var i=C_(r,e,t);r.latex=yg(r.latex,i)}}function v4(r,e){if(r.sliderExists){r.slider.isPlaying&&$l(r,!1);var t=Yc(r,e);r.latex=yg(r.latex,t)}}function C4(r,e){if(!r.sliderExists||r.resetSliderAnimationTargetValue)return;var t=r.sliderLastTickTime;if(r.sliderLastTickTime=e,t===void 0)return;var i=e-t;let o=hc(r),n=Rd(r),a=Jc(r),s=r.slider.animationPeriod,l=r.slider.loopMode;if(isNaN(r.sliderAnimationTargetValue)){var c=hl(r);isNaN(c)||(r.sliderAnimationTargetValue=c)}var d=a?a/2:0;if(l==="LOOP_FORWARD_REVERSE")r.sliderAnimationTargetValue>=n?Ra(r,{playDirection:-1}):r.sliderAnimationTargetValue<=o&&Ra(r,{playDirection:1});else if(l==="LOOP_FORWARD")Ra(r,{playDirection:1}),r.sliderAnimationTargetValue>=n+d&&(r.sliderAnimationTargetValue=o-d);else if(l==="PLAY_ONCE")Ra(r,{playDirection:1});else if(l==="PLAY_INDEFINITELY")Ra(r,{playDirection:1});else throw new Error("Unexpected slider loop mode: "+l);isFinite(i)||(i=0);var p,g;if(l==="PLAY_INDEFINITELY")p=i/(s/4),a&&(p*=a),r.sliderAnimationTargetValue+=p,g=r.sliderAnimationTargetValue,a||(g=Yi(g-p*.1,g+p*.1)),g=Yc(r,g,{ignoreSoftLimits:!0}),r.latex=yg(r.latex,g);else{if(i=Math.min(i,s/10),p=(n-o)*i/s,r.sliderAnimationTargetValue+=p*r.slider.playDirection,r.sliderAnimationTargetValue=Math.max(o-d,Math.min(n+d,r.sliderAnimationTargetValue)),g=r.sliderAnimationTargetValue,!a){let h=p/i*16.666666666666668;g=Yi(g-h*.1,g+h*.1)}g=Yc(r,g),r.latex=yg(r.latex,g)}}function Vk(r){let e=r.formula;return e?e.is_single_identifier?[]:e.variables||[]:[]}function E_(r,e){r.formula=e,r.error=e.error,r.unresolved=!1,e.is_slider?(!r.sliderExists||r.resetSliderAnimationTargetValue)&&(r.sliderAnimationTargetValue=hl(r),r.sliderDragging=!1,r.sliderExists=!0):r.sliderExists=!1,r.resetSliderAnimationTargetValue=!1;var t={};e.is_regression&&(t=e.regression.parameters,r.residualVariable=e.regression.residualVariable,r.controller.areLogModeRegressionsForced()&&(r.isLogModeRegression=!0)),__dcg_shared_module_exports__['E'](r.regressionParameters,t)||(r.regressionParameters=t)}function Wl(r){var e,t;return r.type==="expression"&&(((e=r.formula.typed_constant_value)==null?void 0:e.valueType)===__dcg_shared_module_exports__['Ya']||((t=r.formula.typed_constant_value)==null?void 0:t.valueType)===__dcg_shared_module_exports__['Za'])}function S_(r){var t,i,o,n;if(!Wl(r)||((t=r.formula.typed_constant_value)==null?void 0:t.valueType)===__dcg_shared_module_exports__['Za']||((i=r.formula.typed_constant_value)==null?void 0:i.valueType)===__dcg_shared_module_exports__['Ya']&&((o=r.formula.typed_constant_value)==null?void 0:o.value[0])>=Ty&&((n=r.formula.typed_constant_value)==null?void 0:n.value[0])<=My)return!1;let e=__dcg_shared_module_exports__['Ec'](r.latex);return!!(e&&e._dependencies&&e._dependencies.length===1)}function sC(r){var e;return!!r.hidden||!!((e=bl(r))!=null&&e.hidden)}function aC(r){return!Wl(r)||sC(r)?!1:r.formula.typed_constant_value.valueType===__dcg_shared_module_exports__['Ya']?r.formula.typed_constant_value.value[1]>0:r.formula.typed_constant_value.valueType===__dcg_shared_module_exports__['Za']?r.formula.typed_constant_value.value.some(e=>e[1]>0):!1}function ute(r){if(r.shouldGraph=!ls(r),r.folderId===__dcg_shared_module_exports__['jd']){let e=r.controller.getExpressionIdForIdentifier(r.controller.getHoveredOrFocusedTokenIdentifier())===r.id,t=r.controller.isItemSelected(r.id);(e||t||r.controller.getGhostMode())&&(r.shouldGraph=!0)}}function ls(r){var t;if(!r)return!1;if(r.hidden)return!0;if((t=r==null?void 0:r.formula)!=null&&t.expression_type&&By(r))return!0;let e=bl(r);return!!(e&&e.hidden)}function hte(r){let e=r.formula&&r.formula.raw_slider_latex;if(!r.sliderExists||r.latex!==e){r.cachedDisplayLatex={storedLatex:r.latex,valueLatex:r.latex};return}let{latex:t}=r;if(r.cachedDisplayLatex.storedLatex!==t){r.cachedDisplayLatex={storedLatex:r.latex,valueLatex:r.latex};return}let i=D4(r);if(isFinite(i)){let o=r.controller.getFocusLocation();o&&o.type==="expression"&&o.id===r.id||(r.cachedDisplayLatex.valueLatex=yg(r.latex,i))}}function dC(r){return r.cachedDisplayLatex.valueLatex}function E4(r){return __dcg_shared_module_exports__['ob'](r).latex}function Lk(r){return r.slider.hardMin?r.slider.min:E4(hc(r))}function S4(r){return r.slider.hardMax?r.slider.max:E4(Rd(r))}function hc(r){if(r.slider.hardMin){let e=r.formula.slider_min_number;return isFinite(e)?e:NaN}else{let e=r.controller.isDegreeMode(),t=Bi(r.slider.min,e),i=hl(r),o=Jc(r),n=r.slider.hardMax?r.formula.slider_max_number:void 0,s=r.controller.is3dProduct()?__dcg_shared_module_exports__['kc'].xmin:-10;if(t<s&&(s=t),i<s&&(s=i),n<s&&(s=n),o){let l=__dcg_shared_module_exports__['mc']({target:s,hardMin:void 0,hardMax:n,step:o});l<=s?s=l:s=l-o}return s}}function Rd(r){if(r.slider.hardMax){let e=r.formula.slider_max_number;return isFinite(e)?e:NaN}else{let e=r.controller.isDegreeMode(),t=Bi(r.slider.max,e),i=hl(r),o=Jc(r),n=r.slider.hardMin?r.formula.slider_min_number:void 0;return __dcg_shared_module_exports__['nc']({storedMax:t,sliderValue:i,step:o,hardMin:n,is3d:r.controller.is3dProduct()})}}function Jc(r){return r.formula.slider_step_number}function D4(r){if(!r.formula||!r.formula.is_slider)return;let e=r.formula.constant_value;if(e!==void 0)return+e}function hl(r){let e=r.formula&&r.formula.raw_slider_latex;if(r.latex!==e)return iC(r.latex);let t=D4(r);return isFinite(t)?t:NaN}function D_(r){return r.slider.loopMode!=="PLAY_ONCE"?!1:hl(r)>=Rd(r)}function k4(r,e){return r.formula.viz_valids?!!r.formula.viz_valids[e]:!1}function ah(r,e){return r.vizProps[e]}function G4(r,e,t){r.vizProps={...r.vizProps,[e]:t}}function Vy(r,e){if(e.type==="inert")r.disableGraphInteractions=e.disableGraphInteractions,e.disableGraphInteractions&&(r.dragMode="NONE",r.clickableInfo={...r.clickableInfo,enabled:!1},r.editableLabelMode="NONE",r.interactiveLabel=!1);else if(e.type==="drag-mode"){let t=e.dragMode;r.dragMode=t,t!=="NONE"&&(r.disableGraphInteractions=!1),r.movablePointSize!==r.pointSize&&(t==="NONE"?r.pointSize=r.movablePointSize:r.movablePointSize=r.pointSize)}else e.type==="clickable"?(r.clickableInfo=e.clickableInfo,e.clickableInfo.enabled&&(r.disableGraphInteractions=!1)):e.type==="editable-label"?(r.editableLabelMode=e.editable,e.editable!=="NONE"&&(r.disableGraphInteractions=!1)):e.type==="interactive-label"&&(r.interactiveLabel=e.interactive,e.interactive&&(r.disableGraphInteractions=!1))}function T4(r,e,t){Vy(r,{type:"clickable",clickableInfo:{...r.clickableInfo,[e]:t}})}function Pk(r,e){Vy(r,{type:"clickable",clickableInfo:{...r.clickableInfo,latex:e}})}function cs(r){var e;return!!(r.clickableInfo.enabled&&j_(r)&&((e=r.formula.click_handler)==null?void 0:e.status)==="maybe-valid")}function Ly(r){return!!(r&&r.type==="expression"&&cs(r))}function M4(r){return!!r.__workerNeedsDotplotXMode}function _k(r){return!!(r.formula&&r.formula.slider_min_valid)}function Ok(r){return!!(r.formula&&r.formula.slider_max_valid)}function Rk(r){return!!(r.formula&&r.formula.slider_step_valid)}function Fk(r,e){var t;if(!e)throw new Error("Programming Error in test. Pass domain variable");return(t=r.formula.domains)==null?void 0:t.find(i=>i.variable===e)}function I4(r,e){if(!r.formula)return NaN;if(Ky(r)&&isFinite(r.__workerSampledDomainMin))return r.__workerSampledDomainMin;let t=Fk(r,e),i=t==null?void 0:t.minNumber;return i!==void 0&&isFinite(i)?i:NaN}function A4(r,e){if(!r.formula)return NaN;if(Ky(r)&&isFinite(r.__workerSampledDomainMax))return r.__workerSampledDomainMax;let t=Fk(r,e),i=t==null?void 0:t.maxNumber;return i!==void 0&&isFinite(i)?i:NaN}function V4(r,e){let t=Fk(r,e);return t?t.minValid:!1}function L4(r,e){let t=Fk(r,e);return t?t.maxValid:!1}function Nk(r,e){let t=r.cachedViewState;if((!e.stripDefaults||r.parametricDomain.min!==""||r.parametricDomain.max!=="")&&(t={...t,domain:{min:r.parametricDomain.min===""?"0":r.parametricDomain.min,max:r.parametricDomain.max===""?"1":r.parametricDomain.max}}),e.stripDefaults)return __dcg_shared_module_exports__['qd'](t,{is3d:r.controller.is3dProduct()});if(t.points===void 0||t.lines===void 0||t.fill===void 0){let i=__dcg_shared_module_exports__['Z'](t);return i.points===void 0&&delete i.points,i.lines===void 0&&delete i.lines,i.fill===void 0&&delete i.fill,i}return t}function gte(r){let e=r.cachedViewState;e&&__dcg_shared_module_exports__['sd'](e,r)&&e.folderId===r.folderId&&e.color===r.color&&e.latex===r.latex&&e.showLabel===r.showLabel&&e.showAngleLabel===r.showAngleLabel&&e.label===r.label&&e.hidden===r.hidden&&e.secret===r.secret&&e.readonly===r.readonly&&e.disableGraphInteractions===r.disableGraphInteractions&&e.fill===r.fill&&e.points===r.points&&e.lines===r.lines&&e.extendTo3D===r.extendTo3D&&e.lineStyle===r.lineStyle&&e.arrowMode===r.arrowMode&&e.pointStyle===r.pointStyle&&e.dragMode===r.dragMode&&e.labelSize===r.labelSize&&e.labelOrientation===r.labelOrientation&&e.suppressTextOutline===r.suppressTextOutline&&e.interactiveLabel===r.interactiveLabel&&e.editableLabelMode===r.editableLabelMode&&e.residualVariable===r.residualVariable&&e.regressionParameters===r.regressionParameters&&e.isLogModeRegression===r.isLogModeRegression&&e.displayEvaluationAsFraction===r.displayEvaluationAsFraction&&e.slider===r.slider&&e.strictIntersection===r.strictIntersection||(r.cachedViewState={type:r.type,id:r.id,folderId:r.folderId,color:r.color,latex:r.latex,showLabel:r.showLabel,showAngleLabel:r.showAngleLabel,label:r.label,hidden:r.hidden,secret:r.secret,readonly:r.readonly,disableGraphInteractions:r.disableGraphInteractions,points:r.points,lines:r.lines,extendTo3D:r.extendTo3D,lineStyle:r.lineStyle,arrowMode:r.arrowMode,pointStyle:r.pointStyle,fill:r.fill,dragMode:r.dragMode,labelSize:r.labelSize,labelOrientation:r.labelOrientation,suppressTextOutline:r.suppressTextOutline,interactiveLabel:r.interactiveLabel,editableLabelMode:r.editableLabelMode,residualVariable:r.residualVariable,regressionParameters:r.regressionParameters,isLogModeRegression:r.isLogModeRegression,displayEvaluationAsFraction:r.displayEvaluationAsFraction,slider:r.slider,strictIntersection:r.strictIntersection,...__dcg_shared_module_exports__['rd'](r)})}function k_(r,e){e&&Oy(r),r.draggingOnGraphpaper=e}function mte(r){var e=r.memoizedUndoRedoStateParams,t=r.cachedViewState,i=r.preTransientState;if(r.cachedUndoRedoFullState=t,e&&e.viewState===t&&e.preTransientState===i)return;r.memoizedUndoRedoStateParams={viewState:t,preTransientState:i};let o;i?o={...t,latex:i.latex,slider:{...t.slider,...i.slider}}:o={...t},delete o.regressionParameters,delete o.residualVariable,r.cachedUndoRedoDiffState=o}function Bk(r,e){let t=__dcg_shared_module_exports__['Z'](__dcg_shared_module_exports__['pd'](r,{is3d:e.is3dProduct()})),{color:i}=t;return(!i||!Sy(i))&&(i=e.getNextColor()),{...t,...Fp(e),labelDropdownOpen:!1,formula:{error:void 0,operator:"=",variables:[]},error:void 0,unresolved:!1,color:i,pointStyle:t.pointStyle,lineStyle:t.lineStyle,arrowMode:t.arrowMode,displayEvaluationAsFraction:t.displayEvaluationAsFraction,shouldGraph:void 0,sliderDragging:void 0,sliderAnimationTargetValue:void 0,resetSliderAnimationTargetValue:!1,sliderLastTickTime:void 0,draggingOnGraphpaper:!1,cachedUndoRedoDiffState:void 0,cachedUndoRedoFullState:void 0,cachedParsableState:void 0,cachedViewState:void 0,cachedDisplayLatex:{storedLatex:"",valueLatex:""}}}function fte(r){let e=bl(r),t=!!(e&&e.hidden),i=r.cachedViewState,o=r.index,n=r.showLabel&&!t,a=r.showAngleLabel,s=r.shouldGraph,l=r.memoizedParsableStateParams;if(l&&l.viewState===i&&l.index===o&&l.showLabel===n&&l.showAngleLabel===a&&l.shouldGraph===s)return;r.memoizedParsableStateParams={viewState:i,index:o,showLabel:n,showAngleLabel:a,shouldGraph:s};let c=__dcg_shared_module_exports__['td'](i);c.index=o,c.showLabel=n,c.showAngleLabel=a,c.shouldGraph=s,c.isInConstructionsFolder=r.folderId===__dcg_shared_module_exports__['jd'],r.cachedParsableState=c}function Uk(r,e){e(r.latex,"latex"),e(r.clickableInfo.latex,"clickableInfoLatex"),e(r.lineWidth,"lineWidth"),e(r.fillOpacity,"fillOpacity"),e(r.lineOpacity,"lineOpacity"),e(r.pointOpacity,"pointOpacity"),e(r.pointSize,"pointSize"),e(r.movablePointSize,"movablePointSize"),e(r.labelSize,"labelSize"),e(r.labelAngle,"labelAngle"),e(r.colorLatex,"colorLatex"),pf(r)&&(e(r.parametricDomain.min,"parametricDomainMin"),e(r.parametricDomain.max,"parametricDomainMax")),(a8(r)||n8(r))&&(e(r.parametricDomain3Du.min,"parametricDomain3DuMin"),e(r.parametricDomain3Du.max,"parametricDomain3DuMax"),e(r.parametricDomain3Dv.min,"parametricDomain3DvMin"),e(r.parametricDomain3Dv.max,"parametricDomain3DvMax")),(Ky(r)||Qk(r))&&(e(r.polarDomain.min,"polarDomainMin"),e(r.polarDomain.max,"polarDomainMax")),(N_(r)||F_(r))&&e(r.resolution,"resolution"),Rp(r)&&(e(r.cdf.min,"cdfMin"),e(r.cdf.max,"cdfMax")),r.sliderExists&&(e(r.slider.min,"sliderMin"),e(r.slider.max,"sliderMax"),e(r.slider.step,"sliderStep")),r.residualVariable&&e(r.residualVariable,"residualVariable")}function sa(r){return r.formula&&r.formula.assignment}function G_(r){return r.formula&&r.formula.shader}function mn(r){let e=r.cachedAssignmentOrFunctionName;if(e&&e.latex===r.latex)return e.result;let t=oC(r.latex),i=t?{latex:t,identifier:__dcg_shared_module_exports__['wb'](t)}:void 0;return r.cachedAssignmentOrFunctionName={latex:r.latex,result:i},i}function T_(r){let e=r.cachedFunctionCallArgumentsLatex;if(e&&e.latex===r.latex)return e.parsedArgs;let t=d4(r.latex);return r.cachedFunctionCallArgumentsLatex={latex:r.latex,parsedArgs:t},t}function P4(r){var t,i;let e=(i=(t=r.formula)==null?void 0:t.typed_constant_value)==null?void 0:i.valueType;return e==null?!1:__dcg_shared_module_exports__['db'](e)}function M_(r){var i;let e=(i=mn(r))==null?void 0:i.latex;var t=e==null?void 0:e.match(/^(\\token\{\d+\})$/);if(t)return t[1]}function _4(r){var i,o;let e=(o=(i=r.formula)==null?void 0:i.typed_constant_value)==null?void 0:o.valueType,t=!1;if(e&&__dcg_shared_module_exports__['db'](e)&&(t=!0,e=__dcg_shared_module_exports__['eb'](e)),e==null||!__dcg_shared_module_exports__['fb'](e))return"U";switch(e){case __dcg_shared_module_exports__['va']:return t?"P":"p";case __dcg_shared_module_exports__['Fa']:case __dcg_shared_module_exports__['Na']:case __dcg_shared_module_exports__['La']:return t?"L":"l";case __dcg_shared_module_exports__['Va']:return t?"V":"v";case __dcg_shared_module_exports__['Ja']:case __dcg_shared_module_exports__['Ha']:return t?"C":"c";case __dcg_shared_module_exports__['Pa']:case __dcg_shared_module_exports__['Ra']:return t?"A":"a";case __dcg_shared_module_exports__['Da']:return"P";case __dcg_shared_module_exports__['Ta']:return"T";default:return e}}function bte(r){var t,i;let e=(i=(t=r.formula)==null?void 0:t.typed_constant_value)==null?void 0:i.valueType;if(e==null||(__dcg_shared_module_exports__['db'](e)&&(e=__dcg_shared_module_exports__['eb'](e)),!__dcg_shared_module_exports__['fb'](e)))return"unknown";switch(e){case __dcg_shared_module_exports__['va']:return"point";case __dcg_shared_module_exports__['Fa']:return"segment";case __dcg_shared_module_exports__['Na']:return"ray";case __dcg_shared_module_exports__['La']:return"line";case __dcg_shared_module_exports__['Va']:return"vector";case __dcg_shared_module_exports__['Ja']:return"arc";case __dcg_shared_module_exports__['Ha']:return"circle";case __dcg_shared_module_exports__['Pa']:return"angle";case __dcg_shared_module_exports__['Ra']:return"directedangle";case __dcg_shared_module_exports__['Da']:return"polygon";case __dcg_shared_module_exports__['Ta']:return"transformation";default:return e}return"unknown"}function I_(r){var t,i;let e=(i=(t=r.formula)==null?void 0:t.typed_constant_value)==null?void 0:i.valueType;if(e==null||(__dcg_shared_module_exports__['db'](e)&&(e=__dcg_shared_module_exports__['eb'](e)),!__dcg_shared_module_exports__['fb'](e)))return"unknown";switch(e){case __dcg_shared_module_exports__['va']:return"point";case __dcg_shared_module_exports__['Fa']:case __dcg_shared_module_exports__['Na']:case __dcg_shared_module_exports__['La']:case __dcg_shared_module_exports__['Va']:return"line";case __dcg_shared_module_exports__['Ja']:return"arc";case __dcg_shared_module_exports__['Ha']:return"circle";case __dcg_shared_module_exports__['Pa']:return"angle";case __dcg_shared_module_exports__['Ra']:return"directedangle";case __dcg_shared_module_exports__['Da']:return"polygon";case __dcg_shared_module_exports__['Ta']:return"transformation";default:return e}return"unknown"}function O4(r){return r.indexOf("\\token{")!==-1}function R4(r){var i,o,n,a;let e=(o=(i=r.formula.geometry)==null?void 0:i.call)==null?void 0:o.symbol,t=(a=(n=r.formula)==null?void 0:n.typed_constant_value)==null?void 0:a.valueType;return!e||e==="apply"||__dcg_shared_module_exports__['oc'](e)&&t!==void 0&&!__dcg_shared_module_exports__['ib'](t,__dcg_shared_module_exports__['Ta'])?bte(r):e}function yte(r){return!!(r.sliderExists&&(r.slider.isPlaying||r.sliderDragging)||r.draggingOnGraphpaper)}function F4(r){return!!(r.sliderExists&&r.sliderDragging||r.draggingOnGraphpaper)}function A_(r){var e=yte(r);e?r.preTransientState||(r.preTransientState={latex:r.latex,slider:{min:r.slider.min,max:r.slider.max,playDirection:r.slider.playDirection}}):delete r.preTransientState,(!r.sliderExists||!r.slider.isPlaying)&&(r.sliderLastTickTime=void 0),Np(r),ute(r),pte(r),gte(r),mte(r),fte(r),hte(r)}var xte={id:!1,type:!1,color:!0,folderId:!0,latex:!0,showLabel:!0,showAngleLabel:!0,label:!0,hidden:!0,secret:!0,readonly:!0,disableGraphInteractions:!0,points:!0,lines:!0,lineStyle:!0,arrowMode:!0,pointStyle:!0,fill:!0,dragMode:!0,labelSize:!0,labelOrientation:!0,suppressTextOutline:!0,interactiveLabel:!0,editableLabelMode:!0,residualVariable:!0,regressionParameters:!0,isLogModeRegression:!0,displayEvaluationAsFraction:!0,slider:!0,strictIntersection:!0,angleType:!0,showAngleDirection:!0,extendTo3D:!1,...__dcg_shared_module_exports__['gd'](__dcg_shared_module_exports__['ld'])};function N4(r,e){__dcg_shared_module_exports__['dd']({from:e,to:r,props:xte}),r.resetSliderAnimationTargetValue=!0,r.sliderAnimationTargetValue=void 0}function Py(r,e){e?Ra(r,{hardMin:!0,min:e}):Ra(r,{hardMin:!1,min:r.controller.is3dProduct()?`${__dcg_shared_module_exports__['kc'].xmin}`:"-10"})}function _y(r,e){e?Ra(r,{hardMax:!0,max:e}):Ra(r,{hardMax:!1,max:r.controller.is3dProduct()?`${__dcg_shared_module_exports__['kc'].xmax}`:"10"})}function Ra(r,e){r.slider={...r.slider,...e}}function $l(r,e){!r||r.slider.isPlaying===e||(Ra(r,{isPlaying:e}),e&&(Oy(r),r.sliderAnimationTargetValue=hl(r)))}function Oy(r){if(!r.slider.hardMin){let e=__dcg_shared_module_exports__['Nc'](hc(r));e!==r.slider.min&&Ra(r,{min:e})}if(!r.slider.hardMax){let e=__dcg_shared_module_exports__['Nc'](Rd(r));e!==r.slider.max&&Ra(r,{max:e})}}function gl(r,e){var t=iC(e);if(isFinite(t)){let i=__dcg_shared_module_exports__['lc']({target:t,step:Jc(r),hardMin:r.slider.hardMin?hc(r):void 0,hardMax:r.slider.hardMax?Rd(r):void 0});i.min||Ra(r,{hardMin:!1,min:"-10"}),i.max||Ra(r,{hardMax:!1,max:"10"}),i.step||Ra(r,{step:""})}r.latex=e}function B4(r,e){Ra(r,{loopMode:e,playDirection:1}),e==="PLAY_INDEFINITELY"&&Ra(r,{hardMin:!1,hardMax:!1,min:"",max:""}),r.sliderAnimationTargetValue=hc(r)}function pC(r,e){e&&Oy(r),r.sliderDragging=e}function uC(r,e){Ra(r,{step:e})}function U4(r,e){Ra(r,{animationPeriod:e})}function wg(r){return r.displayEvaluationAsFraction}function z4(r,e){r.displayEvaluationAsFraction=e}function sh(r,e){r.label=e}function cf(r,e){Cg(r)?r.showAngleLabel=e:r.showLabel=e}function K4(r,e){r.description=e}function ml(r,e,t){switch(t){case"theta":r.polarDomain={...r.polarDomain,min:e};break;case"t":r.parametricDomain={...r.parametricDomain,min:e};break;case"u":r.parametricDomain3Du={...r.parametricDomain3Du,min:e};break;case"v":r.parametricDomain3Dv={...r.parametricDomain3Dv,min:e};break;case"r":r.parametricDomain3Dr={...r.parametricDomain3Dr,min:e};break;case"phi":r.parametricDomain3Dphi={...r.parametricDomain3Dphi,min:e};break;default:return t}}function fl(r,e,t){switch(t){case"theta":r.polarDomain={...r.polarDomain,max:e};break;case"t":r.parametricDomain={...r.parametricDomain,max:e};break;case"u":r.parametricDomain3Du={...r.parametricDomain3Du,max:e};break;case"v":r.parametricDomain3Dv={...r.parametricDomain3Dv,max:e};break;case"r":r.parametricDomain3Dr={...r.parametricDomain3Dr,max:e};break;case"phi":r.parametricDomain3Dphi={...r.parametricDomain3Dphi,max:e};break;default:return t}}function V_(r,e){r.isLogModeRegression=e}function zk(r,e){Sy(e)&&(r.color=e,r.colorLatex="")}function L_(r,e){r.fill=e}function hC(r,e){r.fillOpacity!==e&&(r.fillOpacity=e)}function Ry(r,e){r.lineOpacity!==e&&(r.lineOpacity=e)}function gC(r,e){r.pointOpacity!==e&&(r.pointOpacity=e)}function mC(r,e){r.pointSize===e&&r.movablePointSize===e||(r.pointSize=e,r.movablePointSize=e)}function Fy(r,e){r.lineWidth!==e&&(r.lineWidth=e)}function Kk(r,e){r.resolution!==e&&(r.resolution=e)}function fC(r,e){r.colorLatex!==e&&(r.colorLatex=e)}function q4(r,e){r.labelDropdownOpen=e}function df(r,e){Vy(r,{type:"drag-mode",dragMode:e})}function P_(r,e){r.points=e}function __(r,e){r.pointStyle!==e&&(r.pointStyle=e,e!=="POINT"&&(r.dragMode="NONE"))}function O_(r,e){r.lines=e}function H4(r,e){r.extendTo3D=e}function qk(r,e){r.lineStyle!==e&&(r.lineStyle=e)}function W4(r,e){r.arrowMode=e===wte(r)?"DEFAULT":e}function wte(r){return"NONE"}function bC(r,e){r.labelSize=e}function Hk(r,e){r.labelAngle=e}function R_(r,e){r.labelOrientation=e}function $4(r,e){r.suppressTextOutline=e}function yC(r,e){Vy(r,{type:"interactive-label",interactive:e})}function Wk(r,e){Vy(r,{type:"editable-label",editable:e})}function j4(r){return r.editableLabelMode}function Ny(r){let{editableLabelMode:e}=r;return e==="MATH"||e==="TEXT"}function Y4(r,e){r.strictIntersection=e}function X4(r){return!!(mo(r)!=="NONE"&&ls(r))}function J4(r,e){r.hidden=e,!e&&By(r)&&(r.lines=r.points=r.fill=void 0)}function By(r){if(_p(r)&&!r.controller.isThreeDMode())return!1;let{points:e,lines:t,fill:i}=r,o=__dcg_shared_module_exports__['Ic'](r.formula.expression_type,{points:e,lines:t,fill:i},n=>{Ii("getReconciledExpressionProps [Chrome Switch Bug]",{metaData:{method:"areAllVisibilityPropsOff",type:n}})});return!o.points&&!o.lines&&!o.fill}function $k(r){return r.formula.map_type!==void 0?!1:pf(r)||Ky(r)||Qk(r)}function jk(r){return r.formula.map_type!==void 0?!1:a8(r)||n8(r)||B_(r)}function Q4(r,e){switch(e){case"theta":return r.polarDomain.min;case"t":return r.parametricDomain.min;case"u":return r.parametricDomain3Du.min;case"v":return r.parametricDomain3Dv.min;case"r":return r.parametricDomain3Dr.min;case"phi":return r.parametricDomain3Dphi.min;default:return e}}function Z4(r,e){switch(e){case"theta":return r.polarDomain.max;case"t":return r.parametricDomain.max;case"u":return r.parametricDomain3Du.max;case"v":return r.parametricDomain3Dv.max;case"r":return r.parametricDomain3Dr.max;case"phi":return r.parametricDomain3Dphi.max;default:return e}}function Uy(r){return!!r.formula.action_value&&Object.keys(r.formula.action_value).length>0}function e8(r){return!!r.sliderExists}function vg(r){return r.formula.expression_type==="POLYGON"}function _p(r){return!!r.formula.is_inequality}function zy(r){return!!r.formula.is_regression}function pf(r){return r.formula.expression_type==="PARAMETRIC"||r.formula.expression_type==="CURVE3D_xyz_t"&&!U_(r)&&!z_(r)}function Yk(r){return r.formula.expression_type==="POINT3D"}function F_(r){return r.formula.expression_type==="CURVE3D_xyz_t"||r.formula.expression_type==="SLICE"||r.formula.expression_type==="SLICE_r\u03B8z_at_z"||r.formula.expression_type==="SLICE_zr\u03B8_at_r"||r.formula.expression_type==="SLICE_zr\u03B8_at_\u03B8"||r.formula.expression_type==="SLICE_zr\u03B8_at_xyz"||r.formula.expression_type==="SLICE_r\u03B8\u03C6_at_\u03B8"||r.formula.expression_type==="SLICE_r\u03B8\u03C6_at_\u03C6"||r.formula.expression_type==="SLICE_r\u03B8\u03C6_at_xyz"||r.formula.expression_type==="SLICE_xyz_uv"}function t8(r){return r.formula.expression_type==="SLICE_zr\u03B8_at_r"||r.formula.expression_type==="SLICE_r\u03B8\u03C6_at_\u03B8"}function r8(r){return r.formula.expression_type==="SLICE_zr\u03B8_at_\u03B8"||r.formula.expression_type==="SLICE_r\u03B8\u03C6_at_\u03C6"}function N_(r){switch(r.formula.expression_type){case"SURFACE_xyz_uv":case"SURFACE_z_r\u03B8":case"SURFACE_r_\u03B8z":case"SURFACE_r_\u03B8z_AMBIGUOUS":case"SURFACE_r_\u03B8\u03C6":case"SURFACE":case"SURFACE_AMBIGUOUS":case"SURFACE_CONSTANT_AMBIGUOUS":case"IMPLICIT_SURFACE":case"IMPLICIT_SURFACE_AMBIGUOUS":case"TRIANGLE3D":case"SPHERE3D":return!0;default:return!1}}function Xk(r){return r.formula.expression_type==="TRIANGLE3D"}function i8(r){return r.formula.expression_type==="SPHERE3D"}function o8(r){return r.formula.expression_type==="IMPLICIT_SURFACE"||r.formula.expression_type==="IMPLICIT_SURFACE_AMBIGUOUS"}function Jk(r){return(vte(r)||Cte(r))&&r.shouldGraph}function vte(r){return r.formula.expression_type==="X_OR_Y"||r.formula.expression_type==="IMPLICIT"||r.formula.expression_type==="SURFACE_AMBIGUOUS"||r.formula.expression_type==="SURFACE_CONSTANT_AMBIGUOUS"||r.formula.expression_type==="IMPLICIT_SURFACE_AMBIGUOUS"}function Cte(r){return!r.formula.is_inequality&&(r.formula.expression_type==="POLAR"||r.formula.expression_type==="SURFACE_r_\u03B8z_AMBIGUOUS")}function Ky(r){return r.formula.expression_type==="POLAR"}function Qk(r){return __dcg_shared_module_exports__['Mc'](r.formula.expression_type)}function B_(r){return __dcg_shared_module_exports__['Lc'](r.formula.expression_type)}function n8(r){return __dcg_shared_module_exports__['Kc'](r.formula.expression_type)}function a8(r){return r.formula.expression_type==="SURFACE_xyz_uv"||r.formula.expression_type==="SLICE_xyz_uv"}function Cg(r){let e=r.formula.typed_constant_value;if(!e)return!1;let t=e.valueType;return t===__dcg_shared_module_exports__['Pa']||t===__dcg_shared_module_exports__['Qa']||t===__dcg_shared_module_exports__['Ra']||t===__dcg_shared_module_exports__['Sa']}function Fd(r){let e=Cg(r);return e&&r.showAngleLabel||!e&&r.showLabel}function s8(r){if(Op(r))return!0;let e=r.formula.typed_constant_value;if(!e)return!1;let t=e.valueType;return t===__dcg_shared_module_exports__['Fa']||t===__dcg_shared_module_exports__['Ga']||t===__dcg_shared_module_exports__['Pa']||t===__dcg_shared_module_exports__['Qa']||t===__dcg_shared_module_exports__['Ra']||t===__dcg_shared_module_exports__['Sa']}function U_(r){return r.formula.expression_type==="SEGMENT3D"}function z_(r){return r.formula.expression_type==="VECTOR3D"}function zs(r){return r.formula.expression_type==="SINGLE_POINT"}function uf(r){return r.formula.expression_type==="POINT_LIST"}function Op(r){return r.formula.expression_type==="POINT_LIST"||r.formula.expression_type==="SINGLE_POINT"}function qy(r){return r.formula.expression_type==="POINT3D_LIST"}function Eg(r){let e=gc(r);return!!(e&&e.type==="visualization"&&e.symbol==="boxplot")}function lh(r){let e=gc(r);return!!(e&&e.type==="visualization"&&e.symbol==="dotplot")}function hf(r){let e=gc(r);return!!(e&&e.type==="visualization"&&e.symbol==="histogram")}function Zk(r){var e=Eg(r)||lh(r)||hf(r);return e}function eG(r){return r.formula.expression_type==="TTEST"}function l8(r){return r.formula.expression_type==="STATS"}function Sg(r){let e=gc(r);return!!(e&&e.type==="distribution")}function c8(r){let{formula:e}=r;return e?!!e.is_discrete_distribution:!1}function gc(r){if(r.controller.areDistributionsEnabled()&&r.latex)return(!r.cachedParseToplevelFunction||r.cachedParseToplevelFunction.latex!==r.latex)&&(r.cachedParseToplevelFunction={latex:r.latex,spec:__dcg_shared_module_exports__['Hc'](r.latex)}),r.cachedParseToplevelFunction.spec}function K_(r){return xC(r)&&Sg(r)}function xC(r){return!!r.formula.expression_type}function q_(r){return!!r.formula.is_concrete_list}function Rp(r){return!K_(r)||q_(r)?!1:r.cdf.show}function wC(r){return r.cdf.min}function vC(r){return r.cdf.max}function d8(r){var e=x_(r.formula.cdf_min_default);return e===-1/0?"-\\infty":isFinite(e)?e+"":"-\\infty"}function p8(r){var e=x_(r.formula.cdf_max_default);return e===1/0?"\\infty":isFinite(e)?e+"":"\\infty"}function u8(r,e){r.cdf={...r.cdf,show:e}}function tG(r,e){r.cdf={...r.cdf,min:e}}function rG(r,e){r.cdf={...r.cdf,max:e}}function CC(r){return!!r.formula&&r.formula.cdf_min_valid!==!1}function EC(r){return!!r.formula&&r.formula.cdf_max_valid!==!1}function H_(r){return!!r.formula&&r.formula.fill_opacity_valid!==!1}function h8(r){return!!r.formula&&r.formula.line_opacity_valid!==!1}function g8(r){return!!r.formula&&r.formula.point_opacity_valid!==!1}function W_(r){return!!r.formula&&r.formula.label_size_valid!==!1}function $_(r){return!!r.formula&&r.formula.label_angle_valid!==!1}function m8(r){return!!r.formula&&r.formula.movable_point_size_valid!==!1}function iG(r){return!!r.formula&&r.formula.point_size_valid!==!1}function oG(r){return!!r.formula&&r.formula.line_width_valid!==!1}function f8(r){return!!r.formula&&r.formula.resolution_valid!==!1}function b8(r){return!!r.formula&&r.formula.color_latex_valid!==!1}function y8(r){return r.formula&&r.formula.color_latex_value}function x8(r){return r.formula&&r.formula.label_angle_value}function nG(r){var e=r.formula&&r.formula.cdf_evaluation;return isFinite(e)?e:0}function j_(r){if(!r||!__dcg_shared_module_exports__['Jc'](r.formula.expression_type))return!1;let e=mo(r);return!(e&&e!=="NONE")}function w8(r){r.showLabel=__dcg_shared_module_exports__['md'].showLabel,r.showAngleLabel=__dcg_shared_module_exports__['md'].showAngleLabel,r.label=__dcg_shared_module_exports__['md'].label,r.hidden=__dcg_shared_module_exports__['md'].hidden,r.dragMode=__dcg_shared_module_exports__['md'].dragMode,r.fill=__dcg_shared_module_exports__['md'].fill,r.points=__dcg_shared_module_exports__['md'].points,r.pointStyle=__dcg_shared_module_exports__['md'].pointStyle,r.lines=__dcg_shared_module_exports__['md'].lines,r.lineStyle=__dcg_shared_module_exports__['md'].lineStyle,r.slider=r.controller.is3dProduct()?__dcg_shared_module_exports__['od']:__dcg_shared_module_exports__['nd'],r.latex="",r.labelSize="",r.labelOrientation="default",r.displayEvaluationAsFraction=__dcg_shared_module_exports__['md'].displayEvaluationAsFraction,r.strictIntersection=__dcg_shared_module_exports__['md'].strictIntersection,r.suppressTextOutline=!1,r.interactiveLabel=!1,r.editableLabelMode=__dcg_shared_module_exports__['md'].editableLabelMode,__dcg_shared_module_exports__['ed'](__dcg_shared_module_exports__['ld'],r)}function aG(r){return!!r.formula.move_strategy}function Y_(r,e){Vy(r,{type:"inert",disableGraphInteractions:e})}function sG(r,e){var t=r.cachedViewState;return e.stripDefaults?__dcg_shared_module_exports__['id'](t):t}function Ete(r){r.cachedViewState={type:r.type,id:r.id,title:r.title,hidden:r.hidden,readonly:r.readonly,collapsed:r.collapsed,secret:r.secret}}function Ste(r){r.cachedUndoRedoDiffState=r.cachedViewState,r.cachedUndoRedoFullState=r.cachedViewState}function v8(r,e){return{...__dcg_shared_module_exports__['Z'](__dcg_shared_module_exports__['hd'](r)),...Fp(e),cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{},cachedViewState:{}}}function C8(r){Dte(r),Np(r),Ete(r),Ste(r)}function Dte(r){var e=r.controller,t=e.getAllSelectedItems();r.collapsedChildIsSelected=r.collapsed&&__dcg_shared_module_exports__['k'](t,i=>i.type!=="folder"&&i.folderId===r.id)}var kte={id:!1,type:!1,hidden:!0,secret:!0,collapsed:!0,title:!0,readonly:!0,disableGraphInteractions:!0};function E8(r,e){__dcg_shared_module_exports__['dd']({from:e,to:r,props:kte})}function Hy(r,e){r.collapsed=e}function S8(r,e){r.title=e}function D8(r,e){r.hidden=e}var G8={folderId:"",text:"",secret:!1,readonly:!1};function T8(r){return{...G8,...r}}function M8(r){return __dcg_shared_module_exports__['ad'](G8,r)}function I8(r,e){r.text=e}function A8(r,e){return{...__dcg_shared_module_exports__['Z'](T8(r)),...Fp(e),cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{},cachedViewState:{}}}function V8(r){Np(r),Tte(r),Mte(r)}var Gte={id:!1,type:!1,folderId:!0,text:!0,secret:!0,readonly:!0};function L8(r,e){__dcg_shared_module_exports__['dd']({from:e,to:r,props:Gte})}function lG(r,e){var t=r.cachedViewState;return e.stripDefaults?M8(t):t}function Tte(r){r.cachedViewState={type:r.type,id:r.id,folderId:r.folderId,text:r.text,secret:r.secret,readonly:r.readonly}}function Mte(r){r.cachedUndoRedoDiffState=r.cachedViewState,r.cachedUndoRedoFullState=r.cachedViewState}var Ite=0;function Ate(){return"helper_item_"+Ite++}function _8(r){return{...r,formula:__dcg_shared_module_exports__['xd'](),guid:Ate(),cachedParsableState:{type:"statement",id:r.id,latex:r.latex,shouldGraph:!1}}}function O8(r,e,t){var l;e.formula=t;let i=e.proxy,o={numericValue:i.numericValue,listValue:i.listValue},{constant_value:n,zero_values:a}=t,s=n!=null?n:(l=(a||[])[0])==null?void 0:l.val;i.numericValue=__dcg_shared_module_exports__['I'](s)?s:NaN,i.listValue=__dcg_shared_module_exports__['G'](s)&&__dcg_shared_module_exports__['j'](s,__dcg_shared_module_exports__['I'])?s.slice(0):void 0,__dcg_shared_module_exports__['E'](i.numericValue,o.numericValue)||r.runAfterDispatch(()=>{i.notifyPropertyChange("numericValue")}),__dcg_shared_module_exports__['E'](i.listValue,o.listValue)||r.runAfterDispatch(()=>{i.notifyPropertyChange("listValue")})}qt();var X_={enabled:!1,latex:"",hoveredImage:"",depressedImage:""},cG={center:"\\left(0,0\\right)",angle:"0",width:"10",height:"10",opacity:"1",clickableInfo:X_,description:"",draggable:!1},R8={folderId:"",hidden:!1,secret:!1,readonly:!1,disableGraphInteractions:!1,foreground:!1,name:"",...cG};function dG(r){return{...R8,...r,clickableInfo:{...X_,...r.clickableInfo}}}function F8(r){var e=__dcg_shared_module_exports__['ad'](R8,r),t=__dcg_shared_module_exports__['bd'](X_,r.clickableInfo);return t===void 0?delete e.clickableInfo:e.clickableInfo=t,e}function J_(r){return __dcg_shared_module_exports__['fd'](r,cG)}function pG(r){return{type:"image",id:r.id,...J_(r),guid:"",index:0,color:"",shouldGraph:r.hidden,showPoints:!1}}function N8(r,e){r.hidden=e}function jl(r,e,t){r[e]=t}function B8(r,e){return r[e]}function U8(r,e){r.description=e}function z8(r,e){r.name=e}function hG(r,e){e.type==="inert"?(r.disableGraphInteractions=e.disableGraphInteractions,e.disableGraphInteractions&&(r.draggable=!1,r.clickableInfo={...r.clickableInfo,enabled:!1})):e.type==="draggable"?(r.draggable=e.draggable,e.draggable&&(r.disableGraphInteractions=!1)):e.type==="clickable"&&(r.clickableInfo=e.clickableInfo,e.clickableInfo.enabled&&(r.disableGraphInteractions=!1))}function Q_(r,e){hG(r,{type:"draggable",draggable:e})}function Wy(r){if(r.formula){var e=r.formula.center_reference_id,t=r.formula.center_reference_symbol;if(!(!e||!t)){var i=r.controller.getItemModel(e);if(!(!i||i.type!=="expression")&&i.formula.assignment===t&&zs(i))return i}}}function Pte(r){var e=Wy(r);if(!e)return!1;var t=mo(e);return!(!t||t==="NONE")}function Nd(r){return!r.draggable||Yl(r)?!1:Pte(r)}function K8(r){if(!r.formula||!r.formula.center_is_point_literal)return!1;var e=r.formula.move_strategy;if(!e)return!1;var t=e[2],i=e[3],o=t&&t.type!=="none",n=i&&i.type!=="none";return!!(o||n)}function q8(r,e){r.opacity=e}function Z_(r,e){r.foreground=e}function H8(r,e){r.image_url=e}function gG(r,e){e(r.opacity,"imageOpacity"),e(r.center,"imageCenter"),e(r.height,"imageHeight"),e(r.width,"imageWidth"),e(r.angle,"imageAngle")}function _te(r){let e=pG(r);e.color=r.color,e.index=r.index,e.guid=r.guid,e.shouldGraph=r.shouldGraph,e.showPoints=r.showPoints,r.cachedParsableState=e}function W8(r){r.draggingOnGraphpaper?r.preTransientState||(r.preTransientState={center:r.center,width:r.width,height:r.height}):delete r.preTransientState,Np(r);let e=bl(r);r.shouldGraph=e&&e.hidden?!1:!r.hidden,r.showPoints=r.shouldGraph&&Na(r)&&r.loadStatus==="loaded"&&!Nd(r)&&r.controller.isTraceEnabled(),Rte(r),Fte(r),_te(r)}function $8(r,e){r.formula=e,r.error=Ote(r)}function mG(r){return r.formula?r.formula.variables||[]:[]}function Ote(r){var e={scale:r.controller.s("graphing-calculator-error-log-axes-image"),center:r.controller.s("graphing-calculator-error-image-invalid-center"),angle:r.controller.s("graphing-calculator-error-image-invalid-angle"),width:r.controller.s("graphing-calculator-error-image-invalid-width"),height:r.controller.s("graphing-calculator-error-image-invalid-height"),opacity:r.controller.s("graphing-calculator-error-image-invalid-opacity")};for(var t in r.formula.errorMap){var i=r.formula.errorMap[t];if(i)return e[t]}}function j8(r,e){return!r.formula||!r.formula.errorMap?!1:!!r.formula.errorMap[e]}function fG(r,e){var t=r.cachedViewState;return e.stripDefaults?F8(t):t}function Rte(r){var e=r.cachedViewState.clickableInfo,t=!0,i=!0;if(e&&(e.depressedImage===r.clickableInfo.depressedImage&&(i=!1),e.hoveredImage===r.clickableInfo.hoveredImage&&(t=!1)),t&&(r.hoveredImageObj&&(ie(r.hoveredImageObj).off("load"),delete r.hoveredImageObj),r.clickableInfo.hoveredImage)){r.hoveredImageObj=new Image;var o=function(){r.controller.requestRedrawGraph()},n=function(){};uG(r.hoveredImageObj,r.clickableInfo.hoveredImage,o,n)}if(i&&(r.depressedImageObj&&(ie(r.depressedImageObj).off("load"),delete r.depressedImageObj),r.clickableInfo.depressedImage)){r.depressedImageObj=new Image;var o=function(){r.controller.requestRedrawGraph()},n=function(){};uG(r.depressedImageObj,r.clickableInfo.depressedImage,o,n)}if(r.cachedViewState.image_url!==r.image_url){ie(r.imageObj).off("load"),r.imageObj=new Image;let a=function(){r.controller.dispatch({type:"image-load-success",id:r.id})},s=function(){r.controller.dispatch({type:"image-load-error",id:r.id})},c=r.controller.getGraphSettings().config.cacheRenderedSvgs?{fetchMimeType:{imageModel:r}}:void 0;uG(r.imageObj,r.image_url,a,s,c)}r.cachedViewState={type:r.type,id:r.id,folderId:r.folderId,image_url:r.image_url,name:r.name,hidden:r.hidden,foreground:r.foreground,secret:r.secret,readonly:r.readonly,disableGraphInteractions:r.disableGraphInteractions,...J_(r)}}function eO(r,e){r.draggingOnGraphpaper=e}function Fte(r){var e=r.cachedViewState;r.cachedUndoRedoFullState=r.cachedViewState,r.preTransientState&&(e={...e,...r.preTransientState}),r.cachedUndoRedoDiffState=e}function Nte(r){var e=document.createElement("canvas");e.width=2,e.height=2;var t=e.getContext("2d");return t.drawImage(r,0,0,2,2),e.toDataURL()}function uG(r,e,t,i,o={}){ie(r).on("load.initial-image-load",function(){var s=r.width,l=r.height;s===1&&l===1?(ie(r).off(".initial-image-load"),ie(r).on("load",t),r.src=Nte(r)):t()}).on("error",i);let n=/^data:/.test(e);n||(r.crossOrigin="anonymous");let{fetchMimeType:a}=o;a?n?(r.src=e,a.imageModel.mimeType=e.substring(5,e.indexOf(";"))):fetch(e).then(s=>{let l=s.headers.get("Content-type");return l&&(a.imageModel.mimeType=l),s.blob()}).then(s=>{let l=URL.createObjectURL(s);r.src=l}):r.src=e}function Y8(r,e){return{...__dcg_shared_module_exports__['Z'](dG(r)),...Fp(e),color:__dcg_shared_module_exports__['W'].BLUE,loadStatus:"loading",failures:0,imageObj:new Image,hoveredImageObj:void 0,depressedImageObj:void 0,mimeType:void 0,shouldGraph:void 0,showPoints:void 0,error:void 0,formula:void 0,draggingOnGraphpaper:!1,cachedViewState:{},cachedParsableState:{},cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{}}}var Bte={id:!1,type:!1,image_url:!0,name:!0,folderId:!0,hidden:!0,secret:!0,readonly:!0,disableGraphInteractions:!0,foreground:!0,...__dcg_shared_module_exports__['gd'](cG)};function X8(r,e){__dcg_shared_module_exports__['dd']({from:e,to:r,props:Bte})}function J8(r){let{controller:e,files:t,id:i}=r,o={errors:[],tokens:[]};for(let n=0;n<t.length;n++){let a=t[n];if(!a.type.match("image/*")){o.errors.push(e.s("graphing-calculator-error-image-invalid-file",{file:a.name}));continue}o.tokens.push(zte({controller:e,file:a,id:i}))}return o}var Ute=0;function zte(r){let{controller:e,file:t,id:i}=r,o=""+Ute++;return e.getGraphSettings().config.imageUploadCallback(t,(n,a)=>{setTimeout(()=>{if(n)e.dispatch({type:"image-upload-error",token:o,error:n});else{let s=new Image;uG(s,a,function(){var d=s.width,p=s.height,g=Math.max(d,p)/Math.min(d,p);d<p?(p=10,d=Math.round(10*p/g)/10):(d=10,p=Math.round(10*d/g)/10),e.dispatch({type:"image-upload-success",token:o,url:a,width:d+"",height:p+"",name:t.name,id:i})},function(){e.dispatch({type:"image-upload-error",token:o,error:!0})})}})}),o}function bG(r,e){r.loadStatus=e,e==="loaded"&&(r.failures=0),e==="failed"&&(r.failures+=1)}function tO(r){r.imageObj.src=r.imageObj.src,bG(r,"loading")}function yG(r,e,t){hG(r,{type:"clickable",clickableInfo:{...r.clickableInfo,[e]:t}})}function Q8(r,e){hG(r,{type:"clickable",clickableInfo:{...r.clickableInfo,latex:e}})}function mf(r){var e;return!!(r.clickableInfo.enabled&&r.formula&&((e=r.formula.click_handler)==null?void 0:e.status)==="maybe-valid")}function rO(r,e){hG(r,{type:"inert",disableGraphInteractions:e})}var jy={handlerLatex:"",minStepLatex:"",open:!1,playing:!1};function xG(r){return{type:"ticker",id:r.id,handlerLatex:r.handlerLatex,minStepLatex:r.minStepLatex,shouldGraph:!1}}function Z8(r){return __dcg_shared_module_exports__['bd'](jy,r)}function wG(r){return{...jy,...r}}var eK="dcg_ticker_guid_internal",qte=eK;function tK(){return iO(jy)}function Hte(r){r.cachedParsableState=xG(r)}function rK(r,e){return e.stripDefaults?Z8(r.cachedViewState):r.cachedViewState}function iK(r){return r.cachedUndoRedoDiffState}function oK(r){return r.cachedUndoRedoFullState}function Wte(r){r.cachedViewState={handlerLatex:r.handlerLatex,minStepLatex:r.minStepLatex,playing:r.playing,open:r.open}}function $te(r){var e=r.cachedViewState;r.cachedUndoRedoDiffState=e,r.cachedUndoRedoFullState=e}function iO(r){return{...wG(r),type:"ticker",guid:eK,id:qte,avgDelta:0,lastTickTime:void 0,cachedViewState:{},cachedParsableState:{},cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{},filteredBySearch:!1}}function nK(r,e){__dcg_shared_module_exports__['ed'](e,r)}function aK(r,e){r.formula=e}function sK(r){Wte(r),$te(r),Hte(r)}function lK(r,{currentFrameTime:e,previousFrameTime:t}){var a,s;if(!r.playing||((a=r.formula)==null?void 0:a.handler.status)!=="maybe-valid")return!1;if(r.lastTickTime==null||t==null)return!0;if(((s=r.formula)==null?void 0:s.minStep.status)!=="valid")return!1;let i=r.formula.minStep.value,o=r.lastTickTime+i;if(e>=o)return!0;let n=e-t;return o-e<n/2}function cK(r,e){r.lastTickTime=e}function dK(r){if(r.formula)return r.formula.handler.status==="error"?r.formula.handler.error:void 0}function pK(r){if(r.formula)return r.formula.minStep.status==="error"?r.formula.minStep.error:void 0}function SC(r){var e;return((e=r.formula)==null?void 0:e.variables)||[]}function vG(r,e){e(r.handlerLatex,"tickerHandler"),e(r.minStepLatex,"tickerMinStep")}function jte(r){return r.replace(new RegExp("(?<!\\\\left|\\\\sqrt)(\\[|\\(|\\\\\\{)","g"),"\\left$1").replace(new RegExp("(?<!\\\\right)(\\]|\\)|\\\\\\})(?!{)","g"),"\\right$1")}function Yte(r){return jte(__dcg_shared_module_exports__['yb'](r))}function EG(r){if(!r||r.args.length===0)return;let e=r.args[r.args.length-1];switch(e.isTrailing=!0,e.type){case"Sqrt":case"LeftRight":EG(e.arg);break;case"Frac":EG(e.num),EG(e.den);break;case"TokenNode":case"SupSub":case"Other":break;default:}}function oO(r){return{type:"Other",originalType:r.type,val:r.val}}function Xte(r){switch(r.type){case"Cmd":{if(!__dcg_shared_module_exports__['Ac'](r.val))return oO(r);let e=r.val.match(/^\\([a-zA-Z]+)/);if(!e)return oO(r);let t=e[1],i=[];for(let o of t)i.push({type:"Other",originalType:"Letter",val:o});return i}case"OperatorName":return Up(r.arg).args;case"EscapedSymbol":case"Letter":case"Digit":case"Symbol":return oO(r);case"Sqrt":return{type:"Sqrt",optArg:r.optArg&&Up(r.optArg),arg:Up(r.arg)};case"Frac":return{type:"Frac",num:Up(r.num),den:Up(r.den)};case"TokenNode":return{type:"TokenNode",arg:Up(r.arg)};case"SupSub":return{type:"SupSub",sup:r.sup&&Up(r.sup),sub:r.sub&&Up(r.sub),nprimes:r.nprimes};case"LeftRight":return{type:"LeftRight",left:r.left,right:r.right,arg:Up(r.arg)};default:throw new Error(`Programming Error: Invalid atom type ${r.type}`)}}function Up(r){let e=[];for(let t of r.args){let i=Xte(t);Array.isArray(i)?e.push(...i):e.push(i)}return{type:"Group",args:e}}function uK(r){try{return Up(__dcg_shared_module_exports__['wc'](Yte(r)))}catch(e){return}}function gK(r){let e=uK(r);if(e===void 0)return()=>!1;let t=e;EG(t);function i(o){let n=uK(o);return n===void 0?!1:kg(t,n)}return i}function kg(r,e){if(!e)return!1;for(let t=0;t<e.args.length;t++)if(mK(r,e,t)||Jte(r,e.args[t]))return!0;return!1}function Jte(r,e){switch(e.type){case"Sqrt":return kg(r,e.arg)||kg(r,e.optArg);case"Frac":return kg(r,e.num)||kg(r,e.den);case"SupSub":return kg(r,e.sup)||kg(r,e.sub);case"LeftRight":return kg(r,e.arg);case"TokenNode":return!1;case"Other":return!1;default:throw new Error(`Programming Error: Invalid atom type ${e.type}`)}}function mK(r,e,t){if(r.args.length>e.args.length-t)return!1;for(let i=0;i<r.args.length;i++)if(!Qte(r.args[i],e.args[i+t]))return!1;return!0}function Dg(r,e,t){return!r&&!e?!0:!r||!e?!1:r.args.length===0?!0:r.args.length>e.args.length||!(t!=null&&t.allowPrefix)&&r.args.length<e.args.length?!1:mK(r,e,0)}function Qte(r,e){let t=!!r.isTrailing;switch(r.type){case"Sqrt":return e.type==="Sqrt"&&Dg(r.optArg,e.optArg)&&Dg(r.arg,e.arg);case"Frac":return e.type==="Frac"&&Dg(r.num,e.num)&&Dg(r.den,e.den);case"SupSub":return e.type==="SupSub"&&r.nprimes===e.nprimes&&Dg(r.sup,e.sup)&&Dg(r.sub,e.sub,{allowPrefix:t});case"LeftRight":return e.type==="LeftRight"&&hK(r.left,e.left)&&hK(r.right,e.right)&&Dg(r.arg,e.arg,{allowPrefix:t});case"TokenNode":return e.type==="TokenNode"&&Dg(r.arg,e.arg);case"Other":return r.type===e.type&&r.val===e.val}}function hK(r,e){return r.type===e.type&&r.val===e.val}var Yy="dcg_geometry_toolbar_",fK={selection:{visible:!0},"box-selection":{visible:!0},"expression-edit":{visible:!0},point:{visible:!1},line:{visible:!1},segment:{visible:!1},ray:{visible:!1},vector:{visible:!1},circle:{visible:!1},arc:{visible:!1},parallel:{visible:!1},perpendicular:{visible:!1},midpoint:{visible:!1},polygon:{visible:!1},compass:{visible:!1},angle:{visible:!1},directedangle:{visible:!1},reflect:{visible:!1},translate:{visible:!1},rotate:{visible:!1},dilate:{visible:!1}};function bK(r){if(r.toolbar!=="all"){if(r.toolbar==="custom"){let e=__dcg_shared_module_exports__['bd'](fK,r.toolbarState),t={toolbar:"custom"};return e!==void 0&&(t.toolbarState=e),t}return r}}function yK(r){return r===void 0?{toolbar:"all"}:r.toolbar==="custom"?{toolbar:"custom",toolbarState:__dcg_shared_module_exports__['cd'](fK,r.toolbarState)}:r}function xK(r,e){return e.stripDefaults?bK(r.cachedViewState):r.cachedViewState}function nO(r){return r.cachedUndoRedoDiffState}function Zte(r){r.toolbar==="custom"?r.cachedViewState={toolbar:"custom",toolbarState:__dcg_shared_module_exports__['Z'](r.toolbarState)}:r.cachedViewState={toolbar:r.toolbar}}function wK(r){Zte(r),ere(r),r.__cachedToolbarState=void 0}function vK(r){let e=[];for(let t in r.toolbarState){let i=t,o=r.toolbarState[i];o.visible&&o.disabledLatex&&e.push({type:"geometry-toolbar-predicate",id:`${Yy}${i}`,latex:o.disabledLatex})}return e}function CK(r,e){if(!r.toolbarState[e].disabledLatex)return;let t=r.formulas[e];if(t!=null&&t.error)return{key:"shared-calculator-error-custom-toolbar-not-condition",vars:{}}}function EK(r,e,t){let i=e.replace(Yy,"");i in r.toolbarState&&(r.formulas[i]=t)}function ere(r){var e=r.cachedViewState;r.cachedUndoRedoDiffState=e,r.cachedUndoRedoFullState=e}function SG(r){let e=yK(r);return{toolbar:e.toolbar,toolbarState:e.toolbar==="custom"?e.toolbarState:tre(),formulas:{},selectedToolForGroup:{},__cachedToolbarState:void 0,cachedViewState:e,cachedUndoRedoDiffState:e,cachedUndoRedoFullState:e}}function SK(){return SG(void 0)}function tre(){return{selection:{visible:!0},"box-selection":{visible:!0},"expression-edit":{visible:!0},point:{visible:!0},line:{visible:!0},segment:{visible:!0},ray:{visible:!0},vector:{visible:!1},circle:{visible:!0},arc:{visible:!1},parallel:{visible:!1},perpendicular:{visible:!1},midpoint:{visible:!1},polygon:{visible:!1},compass:{visible:!1},angle:{visible:!1},directedangle:{visible:!1},reflect:{visible:!1},translate:{visible:!1},rotate:{visible:!1},dilate:{visible:!1}}}function DK(r,e){r.toolbar=e,r.__cachedToolbarState=void 0}function kK(r,e,t){let{groups:i,items:o}=kG(r,t);for(let n of i){let a=o[n];a!=null&&a.dropdown&&a.dropdown.indexOf(e)!==-1?r.selectedToolForGroup[a.group]=e:a!=null&&a.dropdown&&rre(a.current)&&(r.selectedToolForGroup[a.group]=a.dropdown[0])}r.__cachedToolbarState=void 0}function DG(r,e,t){r.toolbarState[e]={visible:t.visible,disabledLatex:t.disabledLatex},r.__cachedToolbarState=void 0}function ff(r,e){return r.toolbar==="all"?!0:r.toolbar==="none"?!1:r.toolbarState[e].visible}function Xy(r,e){if(r.toolbar==="all")return!0;let t=ff(r,e);if(t&&r.formulas[e]){let i=r.formulas[e],o=i==null?void 0:i.constant_value;return typeof o=="number"?!o:!0}return t||e==="selection"}function kG(r,e){var o;if(((o=r.__cachedToolbarState)==null?void 0:o.authorMode)===e)return r.__cachedToolbarState.state;let t={};for(let n of aO())if(n.dropdown){let a=n.dropdown.filter(s=>e||ff(r,s));if(a.sort((s,l)=>{let c=Xy(r,s),d=Xy(r,l),p=ff(r,s),g=ff(r,l);return(c?0:p?1:2)-(d?0:g?1:2)}),a.length>0){let s=r.selectedToolForGroup[n.group];(!s||a.indexOf(s)===-1)&&(s=a[0]),!e&&!Xy(r,s)&&(s=a.find(l=>Xy(r,l))||a[0]),t[n.group]={group:n.group,current:s,dropdown:a.length>1?a:void 0}}}else(e||ff(r,n.current))&&(t[n.group]=n);let i=Object.keys(t);r.__cachedToolbarState={authorMode:e,state:{groups:i,items:t}};for(let n of i){let a=t[n];r.selectedToolForGroup[n]=a==null?void 0:a.current}return{groups:i,items:t}}function aO(){return[{group:"selection",current:"selection",dropdown:["selection","box-selection"]},{group:"point",current:"point",dropdown:["point","midpoint"]},{group:"line",current:"segment",dropdown:["segment","line","ray","vector","parallel","perpendicular"]},{group:"circle",current:"circle",dropdown:["circle","compass","arc"]},{group:"angle",current:"angle",dropdown:["angle","directedangle"]},{group:"polygon",current:"polygon"}]}function rre(r){switch(r){case"box-selection":case"midpoint":case"parallel":case"perpendicular":case"compass":case"arc":return!0;default:return!1}}var Zy="**dcg_geo_expression_edit_tool_preview**";function GK(r){return{controller:r,__itemModelArray:[],__itemIdToModel:{},__helperIdToModel:{},__toolPreviewIdToModel:{},__anyDependsOnRandomSeed:!1,__anyUnmutedTones:!1,__anyTones:!1,__anyIsAction:!1,selectedItemMap:{},drawOrder:[],colorIdx:0,expressionAnalysis:{},nextDisplayIndex:1,ticker:tK()}}function TK(r){for(var e=0;e<r.__itemModelArray.length;e++){var t=r.__itemModelArray[e];if(t.type==="image"&&t.loadStatus==="loading")return!0}return!1}function MK(r){var e=__dcg_shared_module_exports__['i'](__dcg_shared_module_exports__['C'](r.controller.getColors()),i=>i!=__dcg_shared_module_exports__['W'].ORANGE),t=e[r.colorIdx];return r.colorIdx=(r.colorIdx+1)%e.length,t}function ex(r,e){return r.__itemModelArray[e]}function tx(r){for(let e=0;e<r.__itemModelArray.length;e++){let t=r.__itemModelArray[e];if(rx(t))return t}}function TG(r){for(let e=r.__itemModelArray.length-1;e>=0;e--){let t=r.__itemModelArray[e];if(rx(t))return t}}function bf(r,e){var t;do{if(e--,e===-1)return;t=ex(r,e)}while(t&&!rx(t));return t}function yf(r,e){var t,i=kC(r);do{if(e++,e===i)return;t=ex(r,e)}while(t&&!rx(t));return t}function bl(r){if(r.type!=="folder"&&r.folderId){let e=r.controller.getListModel(),t=zp(e,r.folderId);if(t&&t.type==="folder")return t}}function IK(r,e){let t=zp(r,e);if(!t||t.type!=="folder")return 0;let i=0,o=r.__itemModelArray.length;for(var n=t.index+1;n<o;n++){let a=r.__itemModelArray[n];if(a.type==="folder"||a.folderId!==e)break;i+=1}return i}function AK(r,e){let t=zp(r,e);if(!t||t.type!=="folder")return[];let i=[],o=r.__itemModelArray.length;for(var n=t.index+1;n<o;n++){let a=r.__itemModelArray[n];if(a.type==="folder"||a.folderId!==e)break;i.push(a.id)}return i}function VK(r,e){let t=[],i=zp(r,e);if(!i||i.type!=="folder")return t;let o=r.__itemModelArray.length;for(let n=i.index+1;n<o;n++){let a=r.__itemModelArray[n];if(a.type==="folder"||a.folderId!==e)break;t.push(a)}return t}function LK(r){return!!(r&&r.readonly)}function DC(r){if(!r)return!1;if(r.secret)return!0;let e=bl(r);return!!(e&&e.secret&&e.id!==__dcg_shared_module_exports__['jd'])}function rx(r){return!lO(r)}function PK(r){return r.id===__dcg_shared_module_exports__['jd']||r.type!=="folder"&&r.folderId===__dcg_shared_module_exports__['jd']}function lO(r){if(!r||r.filteredBySearch||PK(r))return!0;if(r.controller.isItemBeingDragged(r.id))return!!r.controller.shouldRenderDraggedItemAsToken();if(!r.controller.shouldShowAuthorFeatures()&&DC(r))return!0;let t=bl(r);return!!(t&&t.collapsed&&!r.controller.getExpressionSearchStr())}function cO(r){return r.__itemModelArray}function _K(r){return __dcg_shared_module_exports__['C'](r.__helperIdToModel)}function ix(r){return __dcg_shared_module_exports__['C'](r.__toolPreviewIdToModel)}function ox(r,e){for(var t=0;t<r.__itemModelArray.length;t++){var i=r.__itemModelArray[t];Jy(i,e)}for(var o in r.__toolPreviewIdToModel)Jy(r.__toolPreviewIdToModel[o],e);if(r.ticker.open&&(e(r.ticker.handlerLatex,{type:"item",location:"tickerHandler",item:r.ticker}),e(r.ticker.minStepLatex,{type:"item",location:"tickerMinStep",item:r.ticker})),r.controller.isGeometry()){let a=r.controller.getGeometryToolbarModel().toolbarState;for(let s in a){let l=s,c=a[l];c.visible&&c.disabledLatex&&e(c.disabledLatex,{type:"geometry-toolbar",tool:l})}}}function Jy(r,e){switch(r.type){case"expression":Uk(r,(i,o)=>e(i,{type:"item",location:o,item:r}));break;case"table":PG(r,(i,o,n)=>e(i,{type:"item",location:o,item:r,...n}));break;case"image":gG(r,(i,o)=>e(i,{type:"item",location:o,item:r}));break;case"ticker":vG(r,(i,o)=>e(i,{type:"item",location:o,item:r}));break;case"folder":case"text":break;default:return r}}function OK(r,e){if(!ul(e))return!1;let i=!1;return ox(r,o=>{Od(o,e)&&(i=!0)}),i}function RK(r,e){let t=0,i=ul(e);r.ticker.filteredBySearch=r.ticker.open&&!Od(r.ticker.handlerLatex,e)&&!Od(r.ticker.minStepLatex,e);for(let o of r.__itemModelArray){if(!i){o.filteredBySearch=!1,t++;continue}switch(o.filteredBySearch=!0,o.type){case"expression":Uk(o,s=>{Od(s,e)&&(o.filteredBySearch=!1,t++)});let n=Fd(o);o.label&&n&&o.label.match(GG(e))&&(o.filteredBySearch=!1,t++);break;case"table":PG(o,s=>{Od(s,e)&&(o.filteredBySearch=!1,t++)});break;case"image":gG(o,s=>{Od(s,e)&&(o.filteredBySearch=!1,t++)});break;case"folder":case"text":break;default:return o}!o.filteredBySearch&&o.type!=="folder"&&o.folderId&&(r.__itemIdToModel[o.folderId].filteredBySearch=!1,t++)}return t}function FK(r,e){let t=0,i=gK(e);r.ticker.filteredBySearch=!!e&&r.ticker.open&&!i(r.ticker.handlerLatex)&&!i(r.ticker.minStepLatex);for(var o=0;o<r.__itemModelArray.length;o++){if(!e){r.__itemModelArray[o].filteredBySearch=!1;continue}var n=r.__itemModelArray[o];switch(n.filteredBySearch=!0,n.type){case"expression":Uk(n,l=>{i(l)&&(n.filteredBySearch=!1,t++)});let a=Fd(n);n.label&&a&&(e==="\\operatorname{label}"||e.length>1&&"label".indexOf(e)===0||i(n.label))&&(n.filteredBySearch=!1,t++);break;case"table":PG(n,l=>{i(l)&&(n.filteredBySearch=!1,t++)});break;case"image":e==="\\operatorname{image}"||e.length>1&&"image".indexOf(e)===0?(n.filteredBySearch=!1,t++):gG(n,l=>{i(l)&&(n.filteredBySearch=!1,t++)});break;case"folder":n.title&&n.title.indexOf(e)>=0&&(n.filteredBySearch=!1,t++);break;case"text":n.text.indexOf(e)>=0&&(n.filteredBySearch=!1,t++);break;default:return n}!n.filteredBySearch&&n.type!=="folder"&&n.folderId&&(r.__itemIdToModel[n.folderId].filteredBySearch=!1,t++)}return t}function GG(r,e){return new RegExp("\\$\\{"+r.replace("{","\\{?").replace("}","\\}?").replace("_","\\_?")+"\\}",e)}function dO(r,e,t){let i=0;for(var o=0;o<r.__itemModelArray.length;o++){var n=r.__itemModelArray[o];if(n.type!=="expression"||t&&n.folderId!==t)continue;if(Fd(n)&&n.label){let s=n.label.match(GG(e,"g"));s&&(i+=s.length)}}return ox(r,(a,s)=>{t&&(s.type!=="item"||s.item.type==="ticker"||s.item.type==="folder"||s.item.folderId!==t)||(i+=ky(a,e).length)}),i}function Tg(r,e,t,i){t=t.trim().replace(/_\{([a-zA-Z0-9])\}/g,"_$1");for(var o=0;o<r.__itemModelArray.length;o++){let n=r.__itemModelArray[o];if(n.type==="expression"){let a=Fd(n);n.label&&a&&n.label.match(GG(e))&&sh(n,n.label.replace(GG(e,"g"),"${"+t.trim()+"}"))}}ox(r,(n,a)=>{if(i&&i.limitToItem!==void 0&&(a.type!=="item"||i.limitToItem!==a.item.id)||i&&i.limitToFolder!==void 0&&(a.type!=="item"||a.item.type==="ticker"||a.item.type==="folder"||i.limitToFolder!==a.item.folderId))return;let s=Dk(n,e,t);if(a.type==="geometry-toolbar"){let c=r.controller.getGeometryToolbarModel();DG(c,a.tool,{visible:!0,disabledLatex:s});return}let l=a.item;if(s!==n){let c;switch(a.cellLocation!==void 0&&l.columnModels&&(c=l.columnModels[a.cellLocation.column].id),a.location){case"latex":{gl(l,s);break}case"cdfMin":{tG(l,s);break}case"cdfMax":{rG(l,s);break}case"colorLatex":{fC(l,s);break}case"lineWidth":{Fy(l,s);break}case"resolution":{Kk(l,s);break}case"clickableInfoLatex":{Pk(l,s);break}case"fillOpacity":{hC(l,s);break}case"lineOpacity":{Ry(l,s);break}case"pointOpacity":{gC(l,s);break}case"pointSize":case"movablePointSize":mC(l,s);break;case"labelAngle":{Hk(l,s);break}case"labelSize":{bC(l,s);break}case"polarDomainMin":{ml(l,s,"theta");break}case"polarDomainMax":{fl(l,s,"theta");break}case"parametricDomainMin":{ml(l,s,"t");break}case"parametricDomainMax":{fl(l,s,"t");break}case"parametricDomain3DuMin":{ml(l,s,"u");break}case"parametricDomain3DuMax":{fl(l,s,"u");break}case"parametricDomain3DvMin":{ml(l,s,"v");break}case"parametricDomain3DvMax":{fl(l,s,"v");break}case"parametricDomain3DrMin":{ml(l,s,"r");break}case"parametricDomain3DrMax":{fl(l,s,"r");break}case"parametricDomain3DphiMin":{ml(l,s,"phi");break}case"parametricDomain3DphiMax":{fl(l,s,"phi");break}case"sliderMin":{Py(l,s);break}case"sliderMax":{_y(l,s);break}case"sliderStep":{uC(l,s);break}case"imageOpacity":{jl(l,"opacity",s);break}case"imageCenter":{jl(l,"center",s);break}case"imageHeight":{jl(l,"height",s);break}case"imageWidth":{jl(l,"width",s);break}case"imageAngle":{jl(l,"angle",s);break}case"tickerHandler":{l.handlerLatex=s;break}case"tickerMinStep":{l.minStepLatex=s;break}case"tableHeader":case"tableCellValue":if(!a.cellLocation||l.type!=="table")break;ch(l,a.cellLocation,s);break;case"tableColumnColorLatex":{c&&NG(l,c,s);break}case"tableColumnPointSize":{c&&RG(l,c,s);break}case"tableColumnPointOpacity":{c&&FG(l,c,s);break}case"tableColumnLineWidth":{c&&_G(l,c,s);break}case"tableColumnLineOpacity":{c&&OG(l,c,s);break}case"residualVariable":break;default:{let d=a.location;throw new Error(`Unexpected latex location ${d}`)}}}})}function MG(r){var e=[];ox(r,function(o){if(!(o.indexOf("~")!==-1||o.indexOf("\\sim")!==-1))for(var n=/_(\d)|_\{(?:\s|\\space)*(\d+)(?:\s|\\space)*\}/g;;){var a=n.exec(o);if(!a)break;e.push(parseInt(a[1]||a[2],10))}}),e.sort(function(o,n){return o-n});for(var t=1,i=0;i<e.length;i++)e[i]===t&&t++;return t}function NK(r){var e=0;return ox(r,function(t){for(var i=/\\token\{(\d+)\}/g;;){var o=i.exec(t);if(!o)break;var n=parseInt(o[1],10);n>e&&(e=n)}}),e}function BK(r){var e={};return ox(r,function(t){if(!(t.indexOf("~")!==-1||t.indexOf("\\sim")!==-1))for(var i=/(\\?[a-zA-Z]+)_(\d)|(\\?[a-zA-Z]+)_\{(?:\s|\\space)*(\d+)(?:\s|\\space)*\}/g;;){var o=i.exec(t);if(!o)break;var n=o[1]||o[3],a=o[2]||o[4];n[0]!=="\\"&&(n=n[n.length-1]);var s=parseInt(a,10);e[n]||(e[n]=0),s>e[n]&&(e[n]=s)}}),e}function UK(r,e){var t=[],i={points:[],angles:[],polygons:[],other:[]};function o(n){if(!(nre(r,n.id)&&e!=="actual")&&!(n.id===Zy&&e!=="preview")){if(n.type==="expression"&&n.folderId===__dcg_shared_module_exports__['jd']){Op(n)?i.points.push(n.id):Cg(n)?i.angles.push(n.id):vg(n)?i.polygons.push(n.id):i.other.push(n.id);return}n.type==="table"?__dcg_shared_module_exports__['g'](n.columnModels,function(a){t.push(a.id)}):t.push(n.id)}}r.__itemModelArray.forEach(o),ix(r).forEach(o),t.push.apply(t,i.polygons),t.push.apply(t,i.other),t.push.apply(t,i.angles),t.push.apply(t,i.points),r.drawOrder=t}function zp(r,e,t){let i=r.__itemIdToModel[e];if(i)return i;if(t&&t.includePreviewItems)return r.__toolPreviewIdToModel[e]}function zK(r,e){return!!r.__toolPreviewIdToModel[e]}function xf(r,e){var n;for(var t=[],i=0;i<r.__itemModelArray.length;i++){var o=r.__itemModelArray[i];o.type==="expression"&&((n=mn(o))==null?void 0:n.identifier)===e&&t.push(o)}return t}function ire(r,e){return r.__helperIdToModel[e]}function KK(r,e){var t=_8(e);r.__helperIdToModel[t.id]=t}function lC(r){r.__anyUnmutedTones=r.__itemModelArray.some(e=>aC(e)),r.__anyTones=r.__anyUnmutedTones||r.__itemModelArray.some(e=>Wl(e))}function pO(r){r.__anyDependsOnRandomSeed=!1;for(var e=0;e<r.__itemModelArray.length;e++){var t=r.__itemModelArray[e];if(t&&"formula"in t&&t.formula&&t.formula.depends_on_random_seed){r.__anyDependsOnRandomSeed=!0;return}}}function qK(r){r.__anyIsAction=!1}function IG(r){if(!r.__anyIsAction){if(r.ticker.open){r.__anyIsAction=!0;return}for(var e=0;e<r.__itemModelArray.length;e++){var t=r.__itemModelArray[e];if(t&&"formula"in t&&t.formula){if(t.type!=="expression"&&t.type!=="image")continue;let{formula:i}=t;if(i.hasOwnProperty("action_value")||i.hasOwnProperty("click_handler")){r.__anyIsAction=!0;return}}}}}function wf(r){for(var e=!r.controller.shouldShowAuthorFeatures(),t=1,i=1,o=0;o<r.__itemModelArray.length;o++){var n=r.__itemModelArray[o];n.index=o,n.displayIndex=t,DC(n)&&(n.secretIndex=i,i+=1),!PK(n)&&(!e||!DC(n))&&(t+=1)}for(var a in r.selectedItemMap)r.__itemIdToModel[a]||delete r.selectedItemMap[a];r.nextDisplayIndex=t}function ore(r){r.__itemModelArray=[],r.__itemIdToModel={},r.__helperIdToModel={},r.__toolPreviewIdToModel={},r.__anyDependsOnRandomSeed=!1,r.__anyUnmutedTones=!1,r.__anyTones=!1}function kC(r){return r.__itemModelArray.length}function HK(r){return r.__itemModelArray.filter(e=>e.type==="expression"&&e.folderId===__dcg_shared_module_exports__['jd']&&!!ls(e)).length}function WK(r){return r.nextDisplayIndex===1}function $K(r){for(var e=[],t=0;t<r.__itemModelArray.length;t++){var i=r.__itemModelArray[t];i.type==="expression"&&i.sliderExists&&e.push(i)}return e}function nx(r){var e;for(var t in r.selectedItemMap){if(e!==void 0)return;e=t}if(e!==void 0)return r.__itemIdToModel[e]}function nre(r,e){return!!r.selectedItemMap[e]}function jK(r){return{...r.selectedItemMap}}function AG(r){var e=[];for(var t in r.selectedItemMap)e.push(r.__itemIdToModel[t]);return e}function YK(r){return{list:r.__itemModelArray.map(function(e){return e.cachedUndoRedoDiffState}),ticker:iK(r.ticker)}}function uO(r){return{list:r.__itemModelArray.map(function(e){return e.cachedUndoRedoFullState}),ticker:oK(r.ticker)}}function XK(r,e){let t={list:r.__itemModelArray.map(function(o){switch(o.type){case"expression":return Nk(o,e);case"image":return fG(o,e);case"table":return cx(o,e);case"folder":return sG(o,e);case"text":return lG(o,e);default:return o}})},i=rK(r.ticker,e);return i&&(t.ticker=i),t}function JK(r){let e=0,t=/^[0-9]+$/;for(var i=r.list.length-1;i>=0;i--){var o=r.list[i];let n=o.id;if(t.test(n)){let a=parseInt(n,10);a>e&&(e=a)}if(o.type==="table"&&o.columns){for(let a=o.columns.length-1;a>=0;a--)if(n=o.columns[a].id,t.test(n)){let s=parseInt(n,10);s>e&&(e=s)}}}return e}function QK(r,e,t){t||(t={});var i,o;for(r.colorIdx=0,ore(r),r.expressionAnalysis={},i=0;i<e.list.length;i++){if(o=Qy(r,e.list[i]),t.remapColors&&"color"in o&&o.color){var n=__dcg_shared_module_exports__['C'](r.controller.getColors());__dcg_shared_module_exports__['l'](n,o.color)||(o.color=o4(o.color,n))}r.__itemModelArray.push(o),r.__itemIdToModel[o.id]=o}if(r.ticker=iO(e.ticker),wf(r),r.nextDisplayIndex===1){var a=Qy(r,{type:"expression",id:r.controller.generateId(),color:r.controller.getNextColor()});fc(r,a,r.__itemModelArray.length)}}function Qy(r,e){switch(e.type){case"expression":return Bk(e,r.controller);case"table":return sq(e,r.controller);case"image":return Y8(e,r.controller);case"folder":return v8(e,r.controller);case"text":return A8(e,r.controller);default:return e}}function ZK(r,e){var t,i;let o=r.__itemIdToModel;for(r.__itemModelArray=[],r.__itemIdToModel={},t=0;t<e.list.length;t++){var n=e.list[t];if(i=o[n.id],i&&i.type===n.type)switch(i.type){case"expression":if(n.type!==i.type)throw new Error("invalid restoration");N4(i,n);break;case"table":if(n.type!==i.type)throw new Error("invalid restoration");aq(i,n);break;case"image":if(n.type!==i.type)throw new Error("invalid restoration");X8(i,n);break;case"folder":{if(n.type!==i.type)throw new Error("invalid restoration");E8(i,n)}break;case"text":if(n.type!==i.type)throw new Error("invalid restoration");L8(i,n);break;default:return i}else i=Qy(r,n);r.__itemModelArray.push(i),r.__itemIdToModel[i.id]=i}e.ticker&&nK(r.ticker,e.ticker),pO(r),IG(r),lC(r),wf(r)}function eq(r,e,t){let i=t[0]&&t[0].tableId,o=zp(r,i||e);if(!o)return;let n;switch(o.type){case"expression":let a=!1,s=!1;o.__workerNeedsDotplotXMode=!1;for(let d=0;d<t.length;d++){let p=t[d];if("hasRecursiveDepthError"in p&&p.hasRecursiveDepthError&&(s=!0),p.graphMode===15){o.error=p.error;continue}"resolved"in p&&!p.resolved&&(a=!0),"boundingBox"in p&&p.boundingBox&&(n||(n=[]),n.push(p.boundingBox)),p.needsDotplotXMode&&(o.__workerNeedsDotplotXMode=!0)}o.unresolved=a,o.boundingBoxes=n,o.recursiveDepthPlottingError=s;let l=1/0,c=-1/0;for(let d of t){if(d.graphMode!==6)continue;let p=d.sampledDomain;p&&(l=Math.min(l,p.min),c=Math.max(c,p.max))}isFinite(l)&&(o.__workerSampledDomainMin=l),isFinite(c)&&(o.__workerSampledDomainMax=c);return;case"table":for(let d=0;d<t.length;d++){let p=t[d];"boundingBox"in p&&p.boundingBox&&(n||(n=[]),n.push(p.boundingBox))}n&&lq(o,e,n);return;default:return}}function tq(r,e){var t,i,o,n=__dcg_shared_module_exports__['Z'](r.expressionAnalysis);for(t in e){if(!e.hasOwnProperty(t))continue;o=e[t],i=zp(r,t);let a={isGraphable:!!o.is_graphable,isError:!!o.error,errorMessage:o.error?r.controller.unpack(o.error):void 0};if(i)switch(i.type){case"expression":if(E_(i,o),o.zero_values&&o.zero_values.length===1){let c=o.zero_values[0].val;__dcg_shared_module_exports__['I'](c)&&(a.evaluation={type:"Number",value:c},a.evaluationDisplayed=!0),__dcg_shared_module_exports__['G'](c)&&c.every(__dcg_shared_module_exports__['I'])&&(a.evaluation={type:"ListOfNumber",value:c.slice()},a.evaluationDisplayed=!0)}else o.hasOwnProperty("constant_value")&&__dcg_shared_module_exports__['I'](o.constant_value)&&(a.evaluation={type:"Number",value:o.constant_value},a.evaluationDisplayed=!1);break;case"image":$8(i,o);break;case"table":nq(i,o);break;case"folder":case"text":break;default:return i}else t===r.ticker.id&&aK(r.ticker,o);let s=ire(r,t);if(s)O8(r.controller,s,o);else{let l=r.__toolPreviewIdToModel[t];l&&E_(l,o)}t.startsWith(Yy)&&EK(r.controller.getGeometryToolbarModel(),t,o),t!==r.ticker.id&&!t.startsWith(Yy)&&(n[t]=a)}pO(r),lC(r),IG(r),r.expressionAnalysis=n}function vi(r,e){r.selectedItemMap={},e&&(r.selectedItemMap[e.id]=!0)}function hO(r,e){r.selectedItemMap[e]?delete r.selectedItemMap[e]:r.selectedItemMap[e]=!0}function gO(r,e){r.selectedItemMap={...e}}function Mg(r,e,t,i){if(e===t)return;let o=r.__itemModelArray.splice(e,i);e<t&&(t=t-i+1),r.__itemModelArray.splice.apply(r.__itemModelArray,[t,0,...o]),wf(r)}function fc(r,e,t){var i=String(e.id);if(r.__itemIdToModel.hasOwnProperty(i))throw Error("Item with id '"+i+"' is already in list");r.__itemIdToModel[i]=e,r.__itemModelArray.splice(t,0,e),wf(r)}function Bd(r,e){fc(r,e,kC(r))}function ax(r,e){let t=[];var i=r.__itemModelArray[e];if(i.type==="folder"){let n=0,a=e+1;for(let s=a;s<r.__itemModelArray.length;s++){var o=r.__itemModelArray[s];if(o.type==="folder"||o.folderId!==i.id)break;Na(o)&&vi(r,void 0),o.readonly?(s>a&&(r.__itemModelArray[s]=r.__itemModelArray[a],r.__itemModelArray[a]=o),Ba(o,""),a+=1):(delete r.__itemIdToModel[o.id],delete r.expressionAnalysis[i.id],n+=1)}n>0&&t.push(...r.__itemModelArray.splice(a,n))}return Na(i)&&vi(r,void 0),t.push(...r.__itemModelArray.splice(e,1)),delete r.__itemIdToModel[i.id],delete r.expressionAnalysis[i.id],pO(r),t.some(n=>Wl(n))&&lC(r),wf(r),t}function rq(r){return r.__anyDependsOnRandomSeed}function iq(r){return r.__anyIsAction}function g4(r){return r.__anyUnmutedTones}function sx(r,e){let t=zp(r,e);return t?ax(r,t.index):[]}function VG(r){let e=nx(r);if(!e)return!1;let t=bf(r,e.index);return t?(vi(r,t),t.index===kC(r)-1&&e.type==="expression"&&Hl(e)&&ax(r,t.index),!0):!1}function LG(r){let e=nx(r);if(!e)return!1;let t=yf(r,e.index);return t?(vi(r,t),!0):!1}function Na(r){return!!r.controller.getListModel().selectedItemMap[r.id]}function GC(r,e){r.dragState=e}function TC(r){switch(r.type){case"expression":return Vk(r);case"image":return mG(r);case"table":return[];case"text":return[];case"folder":return[];default:return r}}function oq(r,e){for(let t of cO(r))t.type==="folder"&&Hy(t,e)}function lx(r){return r?r.type==="image"&&mf(r)||r.type==="expression"&&cs(r):!1}var are=30,sre=10,BG=__dcg_shared_module_exports__['W'].RED,UG=__dcg_shared_module_exports__['W'].BLUE,zG=__dcg_shared_module_exports__['W'].GREEN,KG=__dcg_shared_module_exports__['W'].PURPLE,qG=__dcg_shared_module_exports__['W'].ORANGE,HG=__dcg_shared_module_exports__['W'].BLACK;function vf(r,e){switch(e){case __dcg_shared_module_exports__['W'].RED:return r.s("graphing-calculator-text-color-red");case __dcg_shared_module_exports__['W'].BLUE:return r.s("graphing-calculator-text-color-blue");case __dcg_shared_module_exports__['W'].GREEN:return r.s("graphing-calculator-text-color-green");case __dcg_shared_module_exports__['W'].PURPLE:return r.s("graphing-calculator-text-color-purple");case __dcg_shared_module_exports__['W'].ORANGE:return r.s("graphing-calculator-text-color-orange");case __dcg_shared_module_exports__['W'].BLACK:return r.s("graphing-calculator-text-color-black");case __dcg_shared_module_exports__['W'].GRAY:return r.s("graphing-calculator-text-color-gray");default:return r.s("graphing-calculator-text-color-unknown")}}var mO=r=>{if(!Array.isArray(r))return[r];let e=Array(Math.min(r.length,sre));for(let t=0;t<e.length;t++)e[t]=r[Math.round(t*r.length/e.length)];return e};function cq(r,e){switch(r.type){case"single-color":case"color-array":return mO(r.value).every(i=>g_(i,e));case"shader":case"image":return!1;default:let t=r;throw new Error("Unexpected ColorSwatchSpec type: "+t.type)}}function WG(r,e,t=h_){switch(r.type){case"single-color":case"color-array":return mO(r.value).some(o=>g_(o,e,t));case"shader":case"image":return!0;default:let i=r;throw new Error("Unexpected ColorSwatchSpec type: "+i.type)}}var dx=r=>{switch(r.type){case"single-color":return r.value;case"color-array":let e=mO(r.value);if(e.length===0)return __dcg_shared_module_exports__['W'].BLACK;if(e.length===1)return r.value[0];let t=are/e.length;return`linear-gradient(to right${e.reduce((o,n,a)=>`${o}, ${n} ${a*t}px, ${n} ${(a+1)*t}px`,"")})`;case"shader":return"#808080";case"image":return'url("'+r.value+'")';default:let i=r;throw new Error("Unexpected ColorSwatchSpec type: "+i.type)}};var lre=0;function cre(){return"abstract_item_"+lre++}function Fp(r){return{guid:cre(),controller:r,index:-1,displayIndex:-1,secretIndex:-1,isHiddenFromUI:!0,renderShell:!0}}function fO(r,e){r.secret=e}function $G(r,e){r.readonly=e}function Ba(r,e){r.type!=="folder"&&(r.folderId=e)}function Np(r){r.isHiddenFromUI=lO(r)}function jG(r){return r.isHiddenFromUI||r.filteredBySearch?"none":r.renderShell?"shell":"render"}function Ud(r){let e=MC(r),t=e.type==="color-array"?{type:"single-color",value:e.value[0]}:e;return dx(t)}function MC(r){if(!r.colorLatex)return{type:"single-color",value:r.color};if(/^data:image/.test(r.colorLatex))return{type:"image",value:r.colorLatex};let e,t;return r.type==="expression"?(e=y8(r),t=b8(r)):r.type==="table-column"&&(e=uq(r),t=pq(r)),t&&e?Array.isArray(e)?{type:"color-array",value:e}:{type:"single-color",value:e}:{type:"single-color",value:r.color}}function Yl(r){return r.type==="expression"||r.type==="image"||r.type==="table-column"?!!r.disableGraphInteractions:!1}var hq={folderId:"",secret:!1,readonly:!1},YG={latex:"",color:"",hidden:!1,values:[],points:!0,lines:!1,dragMode:"NONE",pointStyle:"POINT",lineStyle:"SOLID",colorLatex:"",lineOpacity:"",lineWidth:"",pointOpacity:"",pointSize:"",disableGraphInteractions:!1};function XG(r){let e=(r.columns||[]).map(function(t){return{...YG,...t}});return{...hq,...r,columns:e}}function gq(r){return r={...r,columns:r.columns.map(function(e){return __dcg_shared_module_exports__['ad'](YG,e)})},__dcg_shared_module_exports__['ad'](hq,r)}function JG(r){return{type:"table",id:r.id,columns:r.columns.map(function(e){return{...e,tableId:r.id}})}}function pre(r){return isFinite(r)?__dcg_shared_module_exports__['tb'](r,{digits:8,bigCutoff:1e6,smallCutoff:.001}):"\\mathrm{undefined}"}function ure(r,e,t){let i=r.columnModels[e];i.error=t.error,i.discrete=t.discrete,i.disabled=t.dependent,i.draggable=!t.error&&!t.dependent,i.packedErrors=[],i.computedValues=[];let o=t.values;for(let n=o.length-1;n>=0;n--){let a=o[n];typeof a=="number"?i.computedValues[n]=pre(a):(i.computedValues[n]="",i.packedErrors[n]=a)}}function fq(r){let e=ds(r);if(!e)return;let t=Cf(r);if(!t){r.isExpanded||ux(r,!0);return}e.row>=t.min&&e.row<t.max&&ux(r,!0)}function Cf(r){if(r.isExpanded)return;let e=bc(r);if(!(e<30))return{min:8,max:e-4}}function bq(r,e){let t=r.columnModels[e];return{values:t.values.slice(),dragMode:t.dragMode,hidden:t.hidden,id:t.id,color:t.color,points:t.points,lines:t.lines,pointStyle:t.pointStyle,lineStyle:t.lineStyle,latex:t.latex,colorLatex:t.colorLatex,lineOpacity:t.lineOpacity,lineWidth:t.lineWidth,pointSize:t.pointSize,pointOpacity:t.pointOpacity,disableGraphInteractions:t.disableGraphInteractions}}var hre=0;function gre(){return"table_guid_"+hre++}function mre(r,e,t){r.columnModels[e].values.splice(t,0,"")}function fre(r,e,t){r.columnModels[e].values.splice(t,1)}function yq(r,e,t){let{color:i}=t;(!i||!Sy(i))&&(i=r.controller.getNextColor());let o={...t,type:"table-column",guid:gre(),index:e,error:void 0,table:r,color:i,packedErrors:[],computedValues:[],discrete:void 0,shouldGraph:void 0,disabled:void 0,draggable:void 0};return e===0&&(o.hidden=!0),o}function IC(r,e){var t=r.table.formula;if(!t)return!1;var i=t.column_data[r.index];return i?!!i[e]:!1}function pq(r){return IC(r,"color_latex_valid")}function xq(r){return IC(r,"line_opacity_valid")}function wq(r){return IC(r,"line_width_valid")}function vq(r){return IC(r,"point_size_valid")}function Cq(r){return IC(r,"point_opacity_valid")}function uq(r){var e=r.table.formula;if(e){var t=e.column_data[r.index];if(t)return t.color_latex_value}}function Eq(r){r.draggingOnGraphpaper?r.preTransientState||(r.preTransientState={columns:cx(r,{stripDefaults:!1}).columns}):delete r.preTransientState,Np(r);let e=bl(r);var t=e&&e.hidden;__dcg_shared_module_exports__['g'](r.columnModels,function(i){i.shouldGraph=!t&&!i.hidden&&!r.controller.is3dProduct()}),yre(r),xre(r),bre(r)}function bc(r){let e=2,t,i=ds(r);return i&&i.row>e&&(e=i.row),r.columnModels.forEach(o=>{t=o.disabled?o.computedValues.length:o.values.length+1,t>e&&(e=t)}),e}function hx(r){return r.columnModels.length}function nq(r,e){r.formula=e;for(let i=0;i<e.column_data.length&&i<hx(r);i++){let o=e.column_data[i];ure(r,i,o)}let t=r.columnModels[r.columnModels.length-1];t.disabled=!0,t.error=void 0}function bO(r,e){for(let t=0;t<r.columnModels.length;t++)mre(r,t,e)}function Sq(r,e){let t=Cf(r);t&&e===t.max-1&&ux(r,!0);for(var i=0;i<r.columnModels.length;i++)fre(r,i,e),i>0&&Fq(r.columnModels[i])}function QG(r,e){let t={id:r.controller.generateId(),latex:e?e.latex:"",color:r.controller.getNextColor()},i=e?e.columnIndex:r.columnModels.length,o={...YG,...t,values:[]};var n=yq(r,i,o);r.columnModels.splice(i,0,n);for(var a=i+1;a<r.columnModels.length;a++)r.columnModels[a].index=a}function Dq(r,e){r.columnModels.splice(e,1);for(var t=e;t<r.columnModels.length;t++)r.columnModels[t].index=t}function kq(r,e){var t,i=r.columnModels.length,o=[];for(t=0;t<i;t++)o.push("");var n=r.columnModels[0].values;if(e>1){var a=r.controller.isDegreeMode(),s=Bi(n[0],a),l=Bi(n[1],a);if(isFinite(s)&&isFinite(l)){var c=e4(s,l);if(c){var d=c.nstart,p=d/c.lcm;for(t=0;t<e;t++){var g=Bi(n[t],a);if(!__dcg_shared_module_exports__['ja'](g,p))return o;d+=c.nstep,p=d/c.lcm}(""+s).length<8&&(""+l).length<8?o[0]=""+p:o[0]="\\frac{"+d+"}{"+c.lcm+"}"}}}return o}function PG(r,e){for(let o=0;o<r.columnModels.length;o++){let n=r.columnModels[o],a={cellLocation:{column:o,row:0}};e(n.latex,"tableHeader",a),e(n.colorLatex,"tableColumnColorLatex",a),e(n.pointSize,"tableColumnPointSize",a),e(n.pointOpacity,"tableColumnPointOpacity",a),e(n.lineWidth,"tableColumnLineWidth",a),e(n.lineOpacity,"tableColumnLineOpacity",a);for(var t=r.columnModels[o],i=0;i<t.values.length;i++)t.values[i]&&e(t.values[i],"tableCellValue",{cellLocation:{column:o,row:i+1}})}}function bre(r){let e=JG({type:"table",id:r.id,secret:r.secret,readonly:r.readonly,folderId:r.folderId,columns:r.columnModels.map(function(i){return bq(r,i.index)})});for(var t=0;t<e.columns.length;t++)e.columns[t].hidden=!r.columnModels[t].shouldGraph;r.cachedParsableState=e}function Gq(r){return r.slice(0,r.length-1)}function cx(r,e){let t={...r.cachedViewState,columns:Gq(r.cachedViewState.columns)};return e.stripDefaults?gq(t):t}function yre(r){var e=r.columnModels.map(function(t,i){return bq(r,i)});r.cachedViewState={id:r.id,type:r.type,folderId:r.folderId,columns:e,secret:r.secret,readonly:r.readonly}}function yO(r,e){r.draggingOnGraphpaper=e}function xre(r){let e={...r.cachedViewState,columns:Gq(r.cachedViewState.columns)};r.cachedUndoRedoFullState=e,r.preTransientState&&(e={...e,...r.preTransientState}),r.cachedUndoRedoDiffState=e}var wre={id:!1,type:!1,columns:!1,folderId:!0,secret:!0,readonly:!0,disableGraphInteractions:!0};function aq(r,e){__dcg_shared_module_exports__['dd']({from:e,to:r,props:wre}),Tq(r,e.columns)}function sq(r,e){let t=__dcg_shared_module_exports__['Z'](XG(r)),i={...t,...Fp(e),columnModels:void 0,formula:void 0,draggingOnGraphpaper:!1,cachedViewState:{},cachedParsableState:{},cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{},isExpanded:!1};return Tq(i,t.columns),i}function Tq(r,e){r.columnModels=e.map(function(t,i){return yq(r,i,t)}),QG(r)}var mq=["x","y","z","u","v","w"];function xO(r,e,t){for(var i=[],o=Math.min(e.length,mq.length),n=0;n<o;n++)i.push({id:t.generateId(),latex:__dcg_shared_module_exports__['ub'](mq[n]+"_"+r),values:e[n],color:t.getNextColor(),hidden:!1,points:!0,lines:!1,dragMode:"NONE",pointStyle:"POINT",lineStyle:"SOLID",colorLatex:"",lineWidth:"",lineOpacity:"",pointOpacity:"",pointSize:"",disableGraphInteractions:!1});return{id:t.generateId(),type:"table",folderId:"",secret:!1,readonly:!1,columns:i}}function Mq(r,e){let t=cx(r,{stripDefaults:!1});if(!t.columns||!e.columns)return e;for(var i=0;i<e.columns.length;i++){var o=t.columns[i],n=e.columns[i];if(o)for(var a in o)o.hasOwnProperty(a)&&(n.hasOwnProperty(a)||(n[a]=o[a]))}return e}function ds(r){if(!r)return;let e=r.controller.getFocusLocation();if(e&&e.type==="table"&&e.id===r.id)return e.location}function jn(r,e){for(var t=0;t<r.columnModels.length;t++){let i=r.columnModels[t];if(i.id===e)return i}}function wO(r,e,t){let i=jn(r,e);i&&(i.points=t,t||(i.dragMode="NONE"))}function Iq(r,e,t){let i=jn(r,e);i&&(i.pointStyle=t)}function Aq(r,e,t){let i=jn(r,e);i&&(i.lines=t)}function Vq(r,e,t){let i=jn(r,e);i&&(i.lineStyle=t)}function _G(r,e,t){let i=jn(r,e);i&&(i.lineWidth=t)}function OG(r,e,t){let i=jn(r,e);i&&(i.lineOpacity=t)}function RG(r,e,t){let i=jn(r,e);i&&(i.pointSize=t)}function FG(r,e,t){let i=jn(r,e);i&&(i.pointOpacity=t)}function Lq(r,e,t){let i=jn(r,e);if(i)if(t.type==="inert")i.disableGraphInteractions=t.disableGraphInteractions,t.disableGraphInteractions&&(i.dragMode="NONE");else{let o=t.dragMode;i.dragMode=o,o!=="NONE"&&!i.points&&(i.points=!0),o!=="NONE"&&(i.disableGraphInteractions=!1)}}function Pq(r,e,t){Lq(r,e,{type:"draggable",dragMode:t})}function _q(r,e,t){let i=jn(r,e);!i||!Sy(t)||(i.color=t,i.colorLatex="")}function NG(r,e,t){let i=jn(r,e);i&&(i.colorLatex=t)}function ux(r,e){r.isExpanded=e}function Oq(r,e,t){let i=jn(r,e);i&&(i.hidden=t,t&&Rq(r))}function lq(r,e,t){let i=jn(r,e);i&&(i.boundingBoxes=t,Rq(r))}function Rq(r){let e=[];r.columnModels.forEach(t=>{t.boundingBoxes&&!t.hidden&&(e=e.concat(t.boundingBoxes))}),r.boundingBoxes=e}function ZG(r,e){let t=jn(r,e);return t?!t.points&&!t.lines:!0}function ch(r,e,t){if(e.row===0){let n=r.columnModels[e.column].id,a=jn(r,n);if(!a)return;a.latex=t,e.column>=r.columnModels.length-1&&QG(r);return}for(var i=r.columnModels[e.column],o=i.values.length;o<e.row-1;o++)i.values[o]="";r.columnModels[i.index].values[e.row-1]=t,e.column>0&&Fq(r.columnModels[i.index])}function Fq(r){for(;r.values.length>0&&!r.values[r.values.length-1];)r.values.pop()}function Nq(r,e){return!!r.columnModels[e.column]&&e.row>=0}function Bq(r){let e;if(r.values){for(e of r.values)if(e!=="")return!1}if(r.computedValues){for(e of r.computedValues)if(e!=="")return!1}return!0}function Uq(r,e){Lq(r.table,r.id,{type:"inert",disableGraphInteractions:e})}function AC(r,e,t){let i=r.columnModels[t];return i.disabled?i.computedValues[e]||"":i.values[e]||""}function zq(r){let e=bc(r),t=hx(r);for(let i=0;i<t;i++)if(AC(r,e-1,i)!=="")return!1;return!0}function eT(r){var e=r&&r.id;if(r&&r.type==="table"){var t=ds(r);if(t){var i=r.columnModels[t.column];e=i?i.id:void 0}else e=void 0}return e}function Kq(r,e,t){var i=r.getAllSelectedItems(),o={};for(var n of i){var a=eT(n);a!==void 0&&(o[a]=!0,t[a]||e.selectSketch(a))}for(let s in t)o[s]||e.deselectSketch(s);return o}var yc=function(r,e,t){if(r===void 0||e===void 0)return!1;let i,o=e.getBoundingClientRect().height,n=r.getBoundingClientRect().height,a=go(r),s=go(e);if(!a||!s)return!1;let l=e.scrollTop,c=a.top+l-s.top,d=c-t,p=n+c+t-o;return d>=p?i=Math.min(Math.max(l,p),d):i=.5*(d+p),i!==l?(e.scrollTop=i,e.scrollTop!=l):!1};var Hq=1,Wq=2,$q=4,jq=8,iT=15,Yq=12,Xq=3,Jq=1,Qq=2,Zq=3,eH=4,Ef=5,gx=6;function Ig(r,e,t){let i=[],o=r.length;if(t===Ef)for(let n=0;n<o;n+=2){let a=e.mapX(r[n]),s=e.mapY(r[n+1]);i.push(a,s)}else if(t===gx)for(let n=0;n<o;n+=2){let a=e.mapX(r[n+1]),s=e.mapY(r[n]);i.push(a,s)}else if(t===Jq)for(let n=0;n<r.length;n+=2){let a=r[n],s=r[n+1],l=e.mapX(s*Math.cos(a)),c=e.mapY(s*Math.sin(a));i.push(l,c)}else if(t===Qq)for(let n=0;n<r.length;n+=2){let a=r[n],s=r[n+1];s<0&&(s=0);let l=e.mapX(s*Math.cos(a)),c=e.mapY(s*Math.sin(a));i.push(l,c)}else if(t===Zq)for(let n=0;n<r.length;n+=2){let a=r[n]*Math.PI/180,s=r[n+1],l=e.mapX(s*Math.cos(a)),c=e.mapY(s*Math.sin(a));i.push(l,c)}else if(t===eH)for(let n=0;n<r.length;n+=2){let a=r[n]*Math.PI/180,s=r[n+1];s<0&&(s=0);let l=e.mapX(s*Math.cos(a)),c=e.mapY(s*Math.sin(a));i.push(l,c)}return i}function tH(r,e){return vO(r,e,iT,!0)}function rH(r,e){return vre(r,e,iT,!0)}function tT(r,e,t,i){let o=[],n,a,s,l;i?(a=r[0],s=r[1],n=2,l=e(a,s),l&&o.push(a,s)):(a=r[r.length-2],s=r[r.length-1],n=0,l=e(a,s));for(let c=n;c<r.length;c+=2){let d=a,p=s,g=l;a=r[c],s=r[c+1],l=e(a,s),!(!l&&!g)&&(l&&g&&o.push(a,s),l&&!g&&(o.push(...t(a,s,d,p)),o.push(a,s)),!l&&g&&o.push(...t(d,p,a,s)))}return o}function rT(r,e,t,i){let o=[[]],n=0,a,s,l,c;i?(s=r[0],l=r[1],a=2,c=e(s,l),c&&o[n].push(s,l)):(s=r[r.length-2],l=r[r.length-1],a=0,c=e(s,l));for(let d=a;d<r.length;d+=2){let p=s,g=l,h=c;s=r[d],l=r[d+1],c=e(s,l),!(!c&&!h)&&(c&&h&&o[n].push(s,l),c&&!h&&(o[n].push(...t(s,l,p,g)),o[n].push(s,l)),!c&&h&&(o[n].push(...t(p,g,s,l)),n++,o[n]=[]))}return o.filter(d=>d.length>0)}var iH=r=>function(e,t){return e>=r},oH=r=>function(e,t){return e<=r},nH=r=>function(e,t){return t>=r},aH=r=>function(e,t){return t<=r},sH=r=>function(e,t,i,o){let n=o-t;return[r,t+n*(r-e)/(i-e)]},lH=r=>function(e,t,i,o){let n=o-t;return[r,t+n*(r-e)/(i-e)]},cH=r=>function(e,t,i,o){let n=i-e;return[e+n*(r-t)/(o-t),r]},dH=r=>function(e,t,i,o){let n=i-e;return[e+n*(r-t)/(o-t),r]};function vO(r,e,t,i){let o=r;return t&$q&&(o=tT(r,iH(e.xmin),sH(e.xmin),i)),t&Wq&&(o=tT(o,nH(e.ymin),cH(e.ymin),i)),t&jq&&(o=tT(o,oH(e.xmax),lH(e.xmax),i)),t&Hq&&(o=tT(o,aH(e.ymax),dH(e.ymax),i)),o}function vre(r,e,t,i){let o=[r];return t&$q&&(o=__dcg_shared_module_exports__['t'](o.map(n=>rT(n,iH(e.xmin),sH(e.xmin),i)),!0)),t&Wq&&(o=__dcg_shared_module_exports__['t'](o.map(n=>rT(n,nH(e.ymin),cH(e.ymin),i)),!0)),t&jq&&(o=__dcg_shared_module_exports__['t'](o.map(n=>rT(n,oH(e.xmax),lH(e.xmax),i)),!0)),t&Hq&&(o=__dcg_shared_module_exports__['t'](o.map(n=>rT(n,aH(e.ymax),dH(e.ymax),i)),!0)),o}function pH(r,e,t){let i=[],o=r[0],n=o+t,a=[];i.push(a);for(let s=0;s<r.length;s+=2){let l=r[s],c=r[s+1];if(c<0&&(c=0),l>=n){for(a=[],i.push(a),o=r[s-2],n=o;l>=n;)n+=t;s-=4}else a.push(l,c)}if(e===0)for(let s=0;s<i.length;s++)i[s].push(0,0);else{let s=t/16,l=e;for(let c=0;c<i.length;c++){let d=i[c];o=d[0],n=d[d.length-2];for(let p=n;p>o;p-=s)d.push(p,l);d.push(o,l)}}return i}function CO(r,e){return r=r.slice(),r.push(r[r.length-2],e),r.push(r[0],e),[r]}function VC(r,e,t){switch(r){case 1:return gx;case 8:case 5:case 2:return Ef;case 6:return t.degreeMode?e?eH:Zq:e?Qq:Jq}}function Df(r,e,t,i=3){let[o,n,a,s]=r,{x:l,y:c}=e.mathToPixels.mapPoint({x:o,y:n}),{x:d,y:p}=e.mathToPixels.mapPoint({x:a,y:s}),g=Math.min(i,Math.max(e.screen.width,e.screen.height)),h={xmin:-g,ymin:-g,xmax:e.screen.width+g,ymax:e.screen.height+g},f=l-d,y=c-p,x=-f,E=-y,C=l-h.xmin,S=h.xmax-l,v=c-h.ymin,M=h.ymax-c,A=[],I=[];if(f!==0){let O=C/f,q=S/x;f<0?(A.push(O),I.push(q)):(A.push(q),I.push(O))}if(y!==0){let O=v/y,q=M/E;y<0?(A.push(O),I.push(q)):(A.push(q),I.push(O))}(t===17||t===24)&&(A.push(0),I.push(1)),t===19&&A.push(0);let P=Math.max(...A),_=Math.min(...I);if(P>_)return{mapped:[l,c,d,p],clipped:[]};let U=l+x*P,Y=c+E*P,R=l+x*_,H=c+E*_;return U<h.xmin&&R<h.xmin||U>h.xmax&&R>h.xmax||Y<h.ymin&&H<h.ymin||Y>h.ymax&&H>h.ymax?{mapped:[l,c,d,p],clipped:[]}:{mapped:[l,c,d,p],clipped:[U,Y,R,H]}}var Ts=class{constructor(e,t,i){this.pattern=i,this.replen=this.pattern[0]+this.pattern[1],t/this.replen>1e3&&(this.pattern[0]=t*this.pattern[0]/this.replen/1e3,this.pattern[1]=t*this.pattern[1]/this.replen/1e3),this.pstate=0,this.dstaccum=0,this.px=null,this.py=null,this.ctx=e}static getDashedPattern(e,t){let i=e.lineWidth*11/(t?3.5:2.5),o=i*7/11;return[i,o]}static getDottedPattern(e,t,i){let o=.5*e.lineWidth*.1/(i?3.5:2.5),n=o*8/.1;return t&&(n*=2),[o,n]}static getTotalSegmentLength(e){if(e.length<4)return 0;let t=0,i=0,o=e[0],n=e[1];for(;isNaN(o)||isNaN(n);){if(i+=2,i>=e.length)return 0;o=e[i],n=e[i+1]}let a,s;for(i+=2;i<e.length;i+=2)a=e[i],s=e[i+1],!(isNaN(a)||isNaN(s))&&(t+=__dcg_shared_module_exports__['da'](a-o,s-n),o=a,n=s);return t}start(e,t){this.px=e,this.py=t}next(e,t){if(this.px===null||this.py===null)throw new Error("Must call start before calling next");let i=this.pattern[this.pstate],o=Math.sqrt(Math.pow(e-this.px,2)+Math.pow(t-this.py,2));if(o>1e-5){for(;o+this.dstaccum>=i;){let n=e-this.px,a=t-this.py,s=i-this.dstaccum;n*=s/o,a*=s/o,this.pstate===0&&(this.ctx.moveTo(this.px,this.py),this.ctx.lineTo(this.px+n,this.py+a)),this.dstaccum=0,this.px+=n,this.py+=a,this.pstate=this.pstate===0?1:0,i=this.pattern[this.pstate],o-=s}this.pstate===0&&(this.ctx.moveTo(this.px,this.py),this.ctx.lineTo(e,t))}this.px=e,this.py=t,this.dstaccum+=o}close(){this.pstate=0,this.dstaccum=0,this.px=null,this.py=null}drawSegment(e){let t=0,i=e[0],o=e[1];for(;isNaN(i)||isNaN(o);){if(t+=2,t>=e.length)return;i=e[t],o=e[t+1]}this.start(i,o);let n,a;for(t+=2;t<e.length;t+=2)n=e[t],a=e[t+1],!(isNaN(n)||isNaN(a))&&this.next(n,a);this.close()}};var Ag=10,Vg=3;function oT(r,e){return r+1e-8*(e-r)>r&&e-r>1e-300&&e-r<1e300}function uH(r,e){return r>1e-300&&oT(r,e)}var di=class r{constructor(e=-10,t=10,i=-10,o=10,n=-2,a=2){this.xmin=e,this.xmax=t,this.ymin=i,this.ymax=o,this.zmin=n,this.zmax=a}static fromObject({xmin:e,xmax:t,ymin:i,ymax:o,zmin:n,zmax:a}){return new r(e,t,i,o,n,a)}toObject(){return{xmin:this.xmin,ymin:this.ymin,zmin:this.zmin,xmax:this.xmax,ymax:this.ymax,zmax:this.zmax}}equals(e){return!(this.xmin!==e.xmin||this.ymin!==e.ymin||this.zmin!==e.zmin||this.xmax!==e.xmax||this.ymax!==e.ymax||this.zmax!==e.zmax)}isXValid(e){return e==="linear"?oT(this.xmin,this.xmax):uH(this.xmin,this.xmax)}isYValid(e){return e==="linear"?oT(this.ymin,this.ymax):uH(this.ymin,this.ymax)}isZValid(){return this.zmin===void 0||this.zmax===void 0?!1:oT(this.zmin,this.zmax)}isValid(e){return this.isXValid(e.xAxisScale)&&this.isYValid(e.yAxisScale)}isSquare(e,t){return Math.abs(e.height-e.width*this.aspectRatio(t))<1}isSquare3D(){let{xmin:e,xmax:t,ymin:i,ymax:o,zmin:n,zmax:a}=this;if(n===void 0||a===void 0)return!1;let s=[t-e,o-i,a-n];return Math.min(...s)/Math.max(...s)>.99999}aspectRatio(e){let t=Ag/Vg,i=e.yAxisScale==="linear"?this.ymax-this.ymin:Math.log10(this.ymax/this.ymin)*t,o=e.xAxisScale==="linear"?this.xmax-this.xmin:Math.log10(this.xmax/this.xmin)*t;return i/o}getSquaredAxisLimits({axis:e,screen:t,settings:i}){let[o,n,a,s,l]=e==="y"?[{min:this.ymin,max:this.ymax},{min:this.xmin,max:this.xmax},t.height/t.width,i.yAxisScale,i.xAxisScale]:[{min:this.xmin,max:this.xmax},{min:this.ymin,max:this.ymax},t.width/t.height,i.xAxisScale,i.yAxisScale];if(s==="logarithmic"){let d=l==="logarithmic"?Math.log(n.max)-Math.log(n.min):(n.max-n.min)*Vg/(Ag*Math.LOG10E),{min:p,max:g}=hH({min:Math.log(o.min),max:Math.log(o.max)},a*d);return{min:Math.exp(p),max:Math.exp(g)}}let c=l==="logarithmic"?(Math.log10(n.max)-Math.log10(n.min))*Ag/Vg:n.max-n.min;return hH(o,c*a)}squareXAxis(e,t){let{min:i,max:o}=this.getSquaredAxisLimits({axis:"x",screen:e,settings:t}),n=new r(i,o,this.ymin,this.ymax);return n.isXValid(t.xAxisScale)?n:this}squareYAxis(e,t){let{min:i,max:o}=this.getSquaredAxisLimits({axis:"y",screen:e,settings:t}),n=new r(this.xmin,this.xmax,i,o);return n.isYValid(t.yAxisScale)?n:this}squareCrop(e,t){return this.aspectRatio({xAxisScale:t.xAxisScale,yAxisScale:t.yAxisScale})>e.height/e.width?this.squareYAxis(e,t):this.squareXAxis(e,t)}polarDiameter(){let e=Math.abs(this.xmax),t=Math.abs(this.xmin),i=Math.abs(this.ymax),o=Math.abs(this.ymin);return 1.5*Math.max(e,t,i,o)}largestR(){return Math.sqrt(Math.pow(Math.max(-this.xmin,this.xmax),2)+Math.pow(Math.max(-this.ymin,this.ymax),2))}smallestR(){return this.xmin<=0&&this.xmax>=0&&this.ymin<=0&&this.ymax>=0?0:this.xmin<=0&&this.xmax>=0?Math.min(Math.abs(this.ymin),Math.abs(this.ymax)):this.ymin<=0&&this.ymax>=0?Math.min(Math.abs(this.xmin),Math.abs(this.xmax)):Math.sqrt(Math.pow(Math.max(this.xmin,-this.xmax),2)+Math.pow(Math.max(this.ymin,-this.ymax),2))}};function hH(r,e){let t=.5*(r.min+r.max),[i,o]=[t-.5*e,t+.5*e];return Math.abs((o-i)/e-1)>.1?{min:-.5*e,max:.5*e}:{min:i,max:o}}var nT={IS_HOVERED:1.25,IS_PRESSED:1.125,IS_GHOSTED:.4},LC={IS_HOVERED:.5,IS_DEPRESSED:.3},SO={IS_GHOSTED:.4},aT={IS_HOVERED:.3,IS_DEPRESSED:.5},sT={IS_GHOSTED:.4},PC=1;function Po(r,e){let t=r;t._dcgSaveClassName&&t._dcgSaveClassName(e)}function fo(r){let e=r;e._dcgRestoreClassName&&e._dcgRestoreClassName()}var dh,kf=new Map,lT=0;function mH(r,e,t){let i=r.imageObj;if(dh&&dh.color===e&&dh.img===i)return dh.canvas;dh?(dh.color=e,dh.img=i):dh={color:e,img:i,canvas:document.createElement("canvas")};let o=dh.canvas,n=r.mimeType==="image/svg+xml";o.width=0,o.width=n?t.width:i.width,o.height=n?t.height:i.height;let a=o.getContext("2d");return a.drawImage(i,0,0,o.width,o.height),a.fillStyle=e,a.globalCompositeOperation="source-atop",a.fillRect(0,0,o.width,o.height),o}function Ere(r,e){if(e.width*e.height>1e3*1e3*window.devicePixelRatio*window.devicePixelRatio)return r.imageObj;let t=r.image_url,i=kf.get(t),o;if(!i||e.width!==i.size.width||e.height!==i.size.height){i&&(kf.delete(t),lT-=i.canvas.width*i.canvas.height);let a=r.imageObj,s=document.createElement("canvas");s.width=e.width,s.height=e.height;var n=s.getContext("2d");n.drawImage(a,0,0,s.width,s.height);let l=20*1e3*1e3;if(s.width*s.height>l)return r.imageObj;for(lT+=s.width*s.height;lT>l;){let[c,d]=Array.from(kf)[0];kf.delete(c),lT-=d.canvas.width*d.canvas.height}kf.set(t,{canvas:s,size:e}),o=s}else kf.delete(t),kf.set(t,i),o=i.canvas;return o}function cT(r,e,t,i={cacheRenderedSvgs:!1}){let{ctx:o,projection:n}=r,a=e.formula;if(!a||!a.dimensions.x)return;let s=a.dimensions;for(let l=0;l<s.x.length;l++){let c=s.x[l],d=s.y[l],p=s.width[l],g=s.height[l],h=s.radianAngle[l];if(!isFinite(c)||!isFinite(d)||!isFinite(p)||!isFinite(g)||!isFinite(h))continue;Po(o,"dcg-svg-image"),o.save(),fo(o),o.globalAlpha=s.opacity[l];let f=n.mapy(g)-n.mapy(0),y=n.mapx(p)-n.mapx(0),x=h===0?1:Math.abs(y/p*(g/f)),E=n.mapx(c),C=n.mapy(d),S=E-y/2,v=C+f*x/2,M=g<0?-1:1,A=p<0?-1:1,I=S*A,P=v*M,_=Math.abs(y),U=Math.abs(f);h!==0&&(o.translate(E,C),o.scale(1,1/x),o.rotate(h),o.translate(-E,-C)),o.scale(A,M);let Y=t.shouldDrawHovered(r,e.id,l),R=t.shouldDrawPressed(e.id,l),H=i.currentKeyboardAttention&&i.currentKeyboardAttention.calcId===e.id&&(i.currentKeyboardAttention.listIndex===void 0||i.currentKeyboardAttention.listIndex===l),q=e.imageObj,w=window.devicePixelRatio*(n.screen.width/n.screen.height),T={width:Math.floor(_*w),height:Math.floor(U*w)};R?e.depressedImageObj?q=e.depressedImageObj:q=mH(e,"rgba(50,50,50,0.2)",T):Y?e.hoveredImageObj?q=e.hoveredImageObj:q=mH(e,"rgba(200,200,200,0.2)",T):i.cacheRenderedSvgs&&e.mimeType==="image/svg+xml"&&(q=Ere(e,T)),o.drawImage(q,I,P,_,U*x);let B=0,de=3;if(Na(e)&&e.controller.isTraceEnabled()&&(o.beginPath(),o.rect(I-B,P-B,_+2*B,U*x+2*B),o.restore(),o.save(),o.strokeStyle="#6993C7",o.lineWidth=de,o.stroke()),H){let F=o.globalAlpha;B=5,o.beginPath(),o.roundRect?o.roundRect(I-B,P-B,_+2*B,U*x+2*B,B):o.rect(I-B,P-B,_+2*B,U*x+2*B),o.restore(),o.save(),o.strokeStyle=__dcg_shared_module_exports__['W'].FOCUS_OUTLINE,o.globalAlpha=1,o.lineWidth=de,o.stroke(),o.globalAlpha=F}o.restore()}}function Ms(r,e){let t=r;t._dcgStartNamedGroup&&t._dcgStartNamedGroup(e)}function _C(r,e){let t=r;t._dcgSetTitle&&t._dcgSetTitle(e)}function Is(r){let e=r;e._dcgEndNamedGroup&&e._dcgEndNamedGroup()}function fH(r){return r.uncommitted?"#ccc":!r.selected&&!r.hovered&&bH(r)===1?__dcg_shared_module_exports__['P'](r.color,.2):r.color}function bH(r){let e=.6;return r.hidden?r.selected?e=.4:e=.25:r.selected||r.isPoint?e=1:r.hovered&&(e=.8),r.isTransparentObject&&(e*=.3),e}function Sre(r){return r.hidden?r.isPoint?0:r.selected?.3:.2:r.selected||r.isPoint||r.hovered?1:.7}function yH(r,e){if(r=r.replace(/#/,""),r.length===3)var t=parseInt(r.slice(0,1)+r.slice(0,1),16),i=parseInt(r.slice(1,2)+r.slice(1,2),16),o=parseInt(r.slice(2,3)+r.slice(2,3),16);else if(r.length===6)var t=parseInt(r.slice(0,2),16),i=parseInt(r.slice(2,4),16),o=parseInt(r.slice(4,6),16);else var t=0,i=0,o=0;return`rgba(${t}, ${i}, ${o}, ${e})`}function RC(r){return yH(fH(r),Sre(r))}function dT(r){return yH(fH(r),bH(r))}function pT(r){return Math.abs(Math.abs(r)-Math.PI/2)<1e-6}var uT=1.4,wH=1.5,gT={};function DH(r={}){return Object.keys(r).length}function hT(r,e={}){return DH(e)===0?r:r.filter((t,i)=>!e[i])}function vH(r,e){let t=[];for(let i=0;i<r;i++)t.push(e);return t}function Tre(){return!!Object.keys(gT).length}var kH=function(r,e){let t=3;return e&&(t+=e),new di(-t,r.width+t,-t,r.height+t)};function CH(r,e){let{displayAsRightAngle:t,rx:i,ry:o,startAngle:n,deltaAngle:a,yscreen:s,xscreen:l}=r;if(t){let c=i*Math.cos(-n),d=i*Math.cos(-n-a),p=o*Math.sin(-n),g=o*Math.sin(-n-a);e.moveTo(l+c,s+p),e.lineTo(l+c+d,s+p+g),e.lineTo(l+d,s+g)}else e.ellipse(l,s,i,o,0,-n,-n-a,a>0)}var qp=class r{constructor(e,t,i){if(this.controller=e,this.getExpressionAriaLabel=i,t.config.plaidMode){let o=["RED","BLUE","GREEN","PURPLE","ORANGE","BLACK"];for(let n of o)gT[__dcg_shared_module_exports__['W'][n]]=document.createElement("img"),gT[__dcg_shared_module_exports__['W'][n]].setAttribute("src","/assets/img/april-fools/"+n.toLowerCase()+".png")}}redrawToCtx(e,t,i,o,n,a,s){let{ctx:l,projection:c}=e;Ms(l,"expressions");let d=c.settings.highlight,p=this.controller.isGeometry();o.forEach(g=>{let h=t[g],f=i[g];h!==void 0&&(p&&c.settings.setProperty("highlight",h.showHighlight),Ms(l,"sketch"),c.settings.takingScreenshot&&_C(l,this.getExpressionAriaLabel(g)),r.drawSketchToCtx({sketch:t[g],drawContext:e,poiLabelsLayer:n,clickableObjectsLayer:a,geometryContext:this.controller.getGeoModel(),showMovablePoints:s==null?void 0:s.showMovablePoints}),Is(l)),f&&f.shouldGraph&&f.foreground&&cT(e,f,a,{currentKeyboardAttention:this.controller.get2dPOIController().keyboardAttentionManager.getKeyboardAttention(),cacheRenderedSvgs:this.controller.getGraphSettings().config.cacheRenderedSvgs})}),Is(l),c.settings.setProperty("highlight",d)}static eachSegment(e,t){for(let i of e.branches)if(i.graphMode!==15)for(let o of i.segments)t(i,o)}static drawSketchToCtx({sketch:e,drawContext:t,poiLabelsLayer:i,clickableObjectsLayer:o,geometryContext:n}){var h,f,y,x,E;if(!e.branches||!e.branches.length)return;let{ctx:a,projection:s}=t,l=a.lineWidth,c=a.globalAlpha,d=s.settings.globalCurveColor?s.settings.globalCurveColor:e.color,p=gT[d],g;p&&p.complete&&p.naturalWidth>0?g=a.createPattern(p,"repeat"):g=d,a.lineJoin="round",a.lineCap="round";for(let C of e.branches){if(C.graphMode===3||C.graphMode===4||C.graphMode===15||C.graphMode===22)continue;let S=1;o.shouldDrawHovered(t,e.id,C.listIndex)&&(S=nT.IS_HOVERED),o.shouldDrawPressed(e.id,C.listIndex)&&(S=nT.IS_PRESSED),o.shouldDrawGhosted(e.id)&&(S=nT.IS_GHOSTED),S*=(h=n==null?void 0:n.getToolFadeOpacity(e.id))!=null?h:1,S*=s.settings.getFillOpacityMultiplier(),a.strokeStyle=d,a.fillStyle=C.color&&!s.settings.globalCurveColor&&!Tre()?C.color:g,C.graphMode!==6&&(a.desmos_batching=!0,a.beginPath());let v=C.graphMode===6?.2:(f=C.fillOpacity)!=null?f:NaN;a.globalAlpha=r._clampedOpacity(v*S,.4);let M=kO(s,C);for(let A of M)r.fillPolygonFillToCtx(a,A);C.graphMode!==6&&(a.fill(),a.desmos_batching=!1),a.globalAlpha=1;for(let A of C.segments){let I=2;C.graphMode&&(I=C.graphMode);let P=A,_=C.lineWidth!==void 0,U=C.lineWidth,Y=2.5,R=(y=C.arrowMode)!=null?y:"DEFAULT";if(a.strokeStyle=C.color,a.fillStyle=C.color,_&&(U<=0||!isFinite(U)))continue;a.lineWidth=_?U:Y;let H=s.settings.graphLineWidth/Y,O=1.3;s.settings.highlight&&(O*=5/7),e.tokenSelected?(H*=wH,O/=wH):e.tokenHovered&&(H*=uT,O/=uT),a.lineWidth*=H,a.globalAlpha*=s.settings.curveOpacity,a.globalAlpha=r._clampedOpacity(s.settings.curveOpacity===1?1:C.lineOpacity,1);let q=C.operator,w="default";q==="<"||q===">"||q==="!="?w="DASHED":q==="<="||q===">="?w="SOLID":e.style==="DASHED"||C.style==="DASHED"?w="DASHED":(e.style==="DOTTED"||C.style==="DOTTED")&&(w="DOTTED",_&&(a.lineWidth*=2)),a.globalAlpha*=(x=n==null?void 0:n.getToolFadeOpacity(e.id))!=null?x:1;let T=!C.isIntersectionExtension&&o.shouldDrawHovered(t,e.id,C.listIndex),B=!C.isIntersectionExtension&&o.shouldDrawPressed(e.id,C.listIndex),de=o.shouldDrawGhosted(e.id);de?a.globalAlpha*=SO.IS_GHOSTED:(B||T)&&(a.save(),a.lineWidth+=4.5,a.globalAlpha*=B?LC.IS_DEPRESSED:LC.IS_HOVERED,r.drawGraphStrokeToCtx(a,s,P,{type:w,graphMode:I,op:q,arrowMode:R,arrowHeadBaseWidth:(a.lineWidth-4.5)*O,opacityMultiplier:B?LC.IS_DEPRESSED:LC.IS_HOVERED}),a.restore()),r.drawGraphStrokeToCtx(a,s,P,{type:w,graphMode:I,op:q,arrowMode:R,arrowHeadBaseWidth:a.lineWidth*O,opacityMultiplier:((E=n==null?void 0:n.getToolFadeOpacity(e.id))!=null?E:1)*(de?SO.IS_GHOSTED:PC)})}}a.lineWidth=l,a.globalAlpha=c,a.strokeStyle=d,r.eachSegment(e,(function(C,S){var v;if(C.graphMode===3&&C.showPoint){let M=S,A=[],I;if(C.interactiveLabel&&e.labels)for(let w=0,T=e.labels.length;w<T;w++){let B=e.labels[w];if(B.type==="poi"){let de=i.isOpenPOI(B.poi),F=i.getHoveredPOI()===B.poi;A.push(de||F),!de&&F&&(I=w)}}let P=1;typeof C.pointSize=="number"?P=C.pointSize/8:Array.isArray(C.pointSize)&&(P=C.pointSize.map(function(w){return w/8}));let _;Array.isArray(C.color)&&(_=C.color);let U=o.getHoveredObjectById(e.id),Y=o.shouldDrawHovered(t,e.id,void 0),R=o.getPressedObject(),H=o.shouldDrawPressed(e.id,R==null?void 0:R.listIndex),O=o.shouldDrawGhosted(e.id),q=C.droppedIndices;if((Y||H)&&!O){let w=M.length;q&&(w+=DH(q));let T=vH(w,0),B=Array.isArray(P)?P.slice():vH(w,P);H&&R?R.listIndex===void 0?(T=T.map(()=>aT.IS_DEPRESSED),B=B.map(de=>de*1.5)):(T[R.listIndex]=aT.IS_DEPRESSED,B[R.listIndex]*=1.5):Y&&U&&(T=T.map((de,F)=>U.listIndexes===void 0||U.listIndexes[F]?aT.IS_HOVERED:de),B=B.map((de,F)=>U.listIndexes===void 0||U.listIndexes[F]?de*1.5:de)),r.drawPointsToCtx({ctx:a,projection:s,segment:M,style:C.style,sizeOverrideIdxs:A,opacityOverrideIdx:I,sizeFactor:B,opacityFactor:T,colorOverrides:_,baseOpacity:C.pointOpacity,droppedIndices:q,sketch:e,isKeyboardFocused:o.isKeyboardFocused(e.id,void 0)}),a.restore()}r.drawPointsToCtx({ctx:a,projection:s,segment:M,style:C.style,sizeOverrideIdxs:A,opacityOverrideIdx:I,sizeFactor:P,opacityFactor:((v=n==null?void 0:n.getToolFadeOpacity(e.id))!=null?v:1)*(O?sT.IS_GHOSTED:PC),colorOverrides:_,baseOpacity:C.pointOpacity,droppedIndices:q,sketch:e})}}).bind(this))}static drawGraphStrokeToCtx(e,t,i,o){let n={arrowHeadBaseWidth:e.lineWidth},{type:a,graphMode:s,op:l,arrowMode:c,arrowHeadBaseWidth:d}=Object.assign({},n,o);if(s===20||s===21){let[y,x,E]=i,C=t.mathToPixels.mapX(y),S=t.mathToPixels.mapY(x),v=t.mathToPixels.dangerouslyGetXScaleFactor(),M=t.mathToPixels.dangerouslyGetYScaleFactor(),A=Math.abs(E*v),I=Math.abs(E*M),P,_;if(s===21?(P=-i[3],_=-i[4]):(P=0,_=2*Math.PI),e.save(),Po(e,"dcg-svg-curve"),e.desmos_batching||e.beginPath(),a==="DASHED"){let U=Ts.getDashedPattern(e,!!t.settings.highlight);e.setLineDash(U)}else if(a==="DOTTED"){let U=Ts.getDottedPattern(e,!!t.settings.config.projectorMode,!!t.settings.highlight);e.setLineDash(U)}e.ellipse(C,S,A,I,0,P,_,P>_),e.desmos_batching||e.stroke(),fo(e),e.restore();return}else if(s===23){let[y,x,E,C,S]=i,v=!S&&pT(C),M=Lg(C,t),A=t.mathToPixels.mapX(y),I=t.mathToPixels.mapY(x),P=t.mathToPixels.dangerouslyGetXScaleFactor(),_=t.mathToPixels.dangerouslyGetYScaleFactor(),U=P>_?P/_:1,Y=P>_?1:_/P,R=Math.abs(U*M),H=Math.abs(Y*M);if(e.save(),Po(e,"dcg-svg-curve"),e.globalAlpha=.4*o.opacityMultiplier,e.desmos_batching||e.beginPath(),e.moveTo(A,I),e.lineTo(A+R*Math.cos(-E),I+H*Math.sin(-E)),CH({displayAsRightAngle:v,rx:R,ry:H,startAngle:E,deltaAngle:C,yscreen:I,xscreen:A},e),e.lineTo(A,I),!e.desmos_batching&&!S&&e.fill(),e.globalAlpha=o.opacityMultiplier,e.desmos_batching||e.beginPath(),CH({displayAsRightAngle:v,rx:R,ry:H,startAngle:E,deltaAngle:C,yscreen:I,xscreen:A},e),S){let O=-E-C,q=A+R*Math.cos(O),w=I+H*Math.sin(O);GO(e,q,w,-E,-C,10,R)}e.globalAlpha=o.opacityMultiplier,e.desmos_batching||e.stroke(),e.lineWidth=1.5,e.globalAlpha=.2*o.opacityMultiplier,e.moveTo(A+1.5*R*Math.cos(-E),I+1.5*H*Math.sin(-E)),e.lineTo(A,I),e.lineTo(A+1.5*R*Math.cos(-E-C),I+1.5*H*Math.sin(-E-C)),e.stroke(),fo(e),e.restore()}else if(s===17||s===18||s===19||s===24){let{clipped:y,mapped:x}=Df(i,t,s,e.lineWidth);if(y.length===0)return;let[E,C,S,v]=y,[M,A,I,P]=x;e.save(),Po(e,"dcg-svg-curve");let _;if(e.desmos_batching||e.beginPath(),a=="DASHED"?(_=new Ts(e,Ts.getTotalSegmentLength(y),Ts.getDashedPattern(e,!!t.settings.highlight)),_.drawSegment(y)):a=="DOTTED"?(_=new Ts(e,Ts.getTotalSegmentLength(y),Ts.getDottedPattern(e,!!t.settings.config.projectorMode,!!t.settings.highlight)),_.drawSegment(y)):(e.moveTo(E,C),e.lineTo(S,v)),s===17){let U=EH(a)*d,{startArrow:Y,endArrow:R}=Vre(Are(s,c));Y&&Kd(e,I,P,M,A,U),R&&Kd(e,M,A,I,P,U)}else if(s===24&&(M!==I||A!==P)){let U=EH(a)*d;Kd(e,M,A,I,P,U)}e.desmos_batching||e.stroke(),fo(e),e.restore();return}let p=VC(s,l!=="=",t.settings),g=Ig(i,t.mathToPixels,p),h=tH(g,kH(t.screen,e.lineWidth));if(h.length===0)return;e.save(),Po(e,"dcg-svg-curve");let f;if(e.desmos_batching||e.beginPath(),a=="DASHED")f=new Ts(e,Ts.getTotalSegmentLength(h),Ts.getDashedPattern(e,!!t.settings.highlight)),f.drawSegment(h);else if(a=="DOTTED")f=new Ts(e,Ts.getTotalSegmentLength(h),Ts.getDottedPattern(e,!!t.settings.config.projectorMode,!!t.settings.highlight)),f.drawSegment(h);else if((a==="SOLID"||a==="default")&&e.lineWidth===1)if(h.length>4||h[0]!==h[2]&&h[1]!==h[3]){e.moveTo(h[0],h[1]);for(let x=0;x<h.length;x+=2)e.lineTo(h[x],h[x+1])}else{e.moveTo(__dcg_shared_module_exports__['ka'](h[0]),__dcg_shared_module_exports__['ka'](h[1]));for(let x=0;x<h.length;x+=2)e.lineTo(__dcg_shared_module_exports__['ka'](h[x]),__dcg_shared_module_exports__['ka'](h[x+1]))}else{e.moveTo(h[0],h[1]);for(let y=0;y<h.length;y+=2)e.lineTo(h[y],h[y+1])}e.desmos_batching||e.stroke(),fo(e),e.restore()}static mapPointToScreen(e,t,i){let n=e.mapx(t);if(n<-20||n>e.screen.width+20)return null;let a=e.mapy(i);return a<-20||a>e.screen.height+20?null:{x:n,y:a}}static drawPointToCtx(e){let{ctx:t,projection:i,sketch:o,x:n,y:a}=e,{sizeFactor:s}=e,l=t.lineWidth,c=t.fillStyle,d=t.strokeStyle,p=r.mapPointToScreen(i,n,a);if(!p||e.sizeFactor!==void 0&&(e.sizeFactor<=0||!isFinite(e.sizeFactor)))return!1;Po(t,"dcg-svg-point"),e.alpha!==void 0?t.globalAlpha=e.alpha:t.globalAlpha=.9,e.opacityFactor!==void 0&&(t.globalAlpha*=e.opacityFactor),t.desmos_batching||t.beginPath();let g=i.settings.pointLineWidth;if(e.overrideSize&&(g=i.settings.config.projectorMode?17:11,t.lineWidth=g),o.tokenSelected?s?s*=1.5:s=1.5:o.tokenHovered&&(s?s*=uT:s=uT),s!==void 0&&(g*=s,t.lineWidth=g),e.colorOverride&&(t.fillStyle=e.colorOverride,t.strokeStyle=e.colorOverride),e.finalHardcodedSize!==void 0&&(g=e.finalHardcodedSize,t.lineWidth=g),e.style==="CROSS"){let h=g*.4;t.moveTo(p.x-h,p.y-h),t.lineTo(p.x+h,p.y+h),t.moveTo(p.x+h,p.y-h),t.lineTo(p.x-h,p.y+h),t.lineWidth=g*.3}else if(e.style==="OPEN"){let h=g*.42;t.moveTo(p.x+h,p.y),t.arc(p.x,p.y,h,0,Math.PI*2,!0),t.closePath(),t.fillStyle="white",t.lineWidth=g*.25,t.fill()}else t.moveTo(p.x-.1,p.y-.1),t.lineTo(p.x-.1,p.y+.1),t.lineTo(p.x+.1,p.y+.1),t.lineTo(p.x+.1,p.y-.1);if(t.desmos_batching||t.stroke(),t.globalAlpha=1,e.isKeyboardFocused){let h=g/2+6;t.lineWidth=2,t.strokeStyle="#6A93D2",t.beginPath(),t.moveTo(p.x+h,p.y),t.arc(p.x,p.y,h,0,Math.PI*2,!0),t.stroke(),t.closePath()}return t.lineWidth=l,t.fillStyle=c,t.strokeStyle=d,fo(t),!0}static drawPointsToCtx(e){let{ctx:t,projection:i,segment:o,style:n,sizeOverrideIdxs:a,opacityOverrideIdx:s,sizeFactor:l,opacityFactor:c,colorOverrides:d,baseOpacity:p,droppedIndices:g}=e,h=t.lineWidth;t.lineWidth=i.settings.pointLineWidth;let f;Array.isArray(p)?(f=p.map((function(y){return r._clampedOpacity(y,.9)}).bind(this)),f=hT(f,g)):f=r._clampedOpacity(p,.9),Array.isArray(l)&&(l=hT(l,g)),Array.isArray(c)&&(c=hT(c,g)),d&&(d=hT(d,g));for(let y=0;y<o.length;y++)r.drawPointToCtx({ctx:t,projection:i,sketch:e.sketch,x:o[y][0],y:o[y][1],alpha:s===y?.6:Array.isArray(f)?f[y]:f,style:n,overrideSize:a[y],sizeFactor:Array.isArray(l)?l[y]:l,opacityFactor:Array.isArray(c)?c[y]:c,colorOverride:d&&d[y],isKeyboardFocused:e.isKeyboardFocused});t.lineWidth=h}static fillPolygonFillToCtx(e,t){if(t.length>=6){Po(e,"dcg-svg-region"),e.desmos_batching||e.beginPath(),e.moveTo(t[0],t[1]);for(let i=2;i<t.length;i+=2)e.lineTo(t[i],t[i+1]);e.lineTo(t[0],t[1]),e.desmos_batching||e.fill(),fo(e)}}static _clampedOpacity(e,t){return typeof e!="number"?t:e<0?0:e>1?1:isFinite(e)?e:t}};function*Mre(r,e){let t=e.graphMode,i=e.operator,o=i=="<"||i==">"||i=="<="||i==">=",n=!r.settings.disableFill&&(t===7||o),a=i=="<="||i=="<";if(n)for(let s of e.segments)switch(t){case 6:{let l=a?0:r.viewport.polarDiameter(),c=r.settings.degreeMode?180:2*Math.PI;yield*pH(s,l,c);break}case 2:{let l=a?r.viewport.ymin:r.viewport.ymax;yield*CO(s,l);break}case 1:{let l=a?r.viewport.xmin:r.viewport.xmax;yield*CO(s,l);break}case 7:yield s}}function Ire(r){switch(r){case 2:return Xq;case 1:return Yq;case 6:case 7:default:return iT}}function*kO(r,e){let t=e.graphMode;if(t!==1&&t!==2&&t!==6&&t!==7)return;let i=kH(r.screen);for(let o of Mre(r,e)){let n=t===7?Ef:VC(t,!0,r.settings),a=Ig(o,r.mathToPixels,n);yield vO(a,i,Ire(e.graphMode),!1)}}function Are(r,e){return r===17?e==="DEFAULT"?"NONE":e:"NONE"}function Vre(r){switch(r){case"NONE":return{startArrow:!1,endArrow:!1};case"POSITIVE":return{startArrow:!1,endArrow:!0};case"BOTH":return{startArrow:!0,endArrow:!0};default:let e=r;throw new Error("Unexpected arrowMode: "+e)}}function EH(r){switch(r){case"default":case"SOLID":case"DASHED":return 4;case"DOTTED":return 2;default:let e=r;throw new Error("Unexpected line style "+e)}}function Kd(r,e,t,i,o,n){let a=Math.atan2(o-t,i-e),s=i-n*Math.cos(a-Math.PI/9),l=o-n*Math.sin(a-Math.PI/9),c=i-n*Math.cos(a+Math.PI/9),d=o-n*Math.sin(a+Math.PI/9),p=i-(n-2)*Math.cos(a-Math.PI/18),g=o-(n-2)*Math.sin(a-Math.PI/18),h=i-(n-2)*Math.cos(a+Math.PI/18),f=o-(n-2)*Math.sin(a+Math.PI/18);r.moveTo(i,o),r.lineTo(s,l),r.lineTo(c,d),r.lineTo(i,o),r.lineTo(p,g),r.lineTo(h,f),r.lineTo(i,o)}function GO(r,e,t,i,o,n,a){let s=i+o,l=n*Math.min(1,Math.max(.5,Math.abs(o)/.8)),c=o<=0,d=Math.PI/2;a<25?d+=.25:d+=.1,c||(d*=-1);let p=e+Math.cos(s+d),g=t+Math.sin(s+d);Kd(r,p,g,e,t,l)}function Lg(r,e){let t=20;return e.settings.config.projectorMode&&(t*=1.4),t}var fT=class{constructor(e){this.savedPOI=[],this.controller=e}redrawToCtx(e,t,i,o,n){let{ctx:a,projection:s}=e,l=[];for(var c=0;c<n.length;c++){var d=n[c],p=t[d];if(p){p.showHighlight&&!this.controller.isGeometry()&&this.drawSketchHighlight({sketch:p,drawContext:e,poiLabelsLayer:i,clickableObjectsLayer:o,geometryContext:this.controller.getGeoModel()});var g=p.getPOI();(p.showPOI||g.length&&g[0].isAttachedToPlottedPoint())&&l.push.apply(l,this.drawPOIs(g,a,"#AAAAAA",s))}}this.savedPOI=l}getDrawnPOI(){return this.savedPOI}drawSketchHighlight(e){e.drawContext.projection.settings.setProperty("highlight",!0),qp.drawSketchToCtx(e),e.drawContext.projection.settings.setProperty("highlight",!1)}drawPOIs(e,t,i,o){t.lineWidth=o.settings.pointLineWidth,t.strokeStyle=i||"#AAAAAA",t.fillStyle=i||"#AAAAAA",t.lineJoin="round",t.lineCap="round";var n=t.globalAlpha;t.globalAlpha=.01;var a=[],s,l=e.length,c;if(l&&e[0].isAttachedToPlottedPoint())for(s=0;s<l;s++)c=e[s],qp.mapPointToScreen(o,c.x,c.y)&&a.push(c);else for(s=0;s<l;s++)c=e[s],qp.drawPointToCtx({ctx:t,projection:o,...c})&&a.push(c);return t.globalAlpha=n,a}};var bT=class{redrawToCtx(e,t){let{ctx:i,projection:o}=e;if(t){i.save(),i.lineWidth=2,i.fillStyle="rgba(0,0,0,.15)",i.strokeStyle="rgba(0,0,0,.4)";var n=o.mapx(t.left),a=o.mapy(t.top),s=o.mapx(t.right),l=o.mapy(t.bottom),c=s-n,d=l-a;i.fillRect(n,a,c,d),i.strokeRect(n,a,c,d),i.restore()}}};var ph=__dcg_shared_module_exports__['e'](te());var{If:Pre}=ph.Components,yT=class extends ph.Class{init(){this.controller=this.props.grapher().controller,this.poiController=this.props.grapher().poiController}template(){return ph.createElement(Pre,{predicate:this.bindFn(this.showCursor)},()=>ph.createElement("div",{class:ph.const("dcg-geo-keyboard-cursor"),style:()=>({top:`${this.getPosition().y}px`,left:`${this.getPosition().x}px`})}))}getPosition(){let e=this.poiController.getGeoKeyboardPt(),t=this.props.grapher().getProjection();return{x:t.mapx(e.x),y:t.mapy(e.y)}}showCursor(){return this.controller.isVirtualMouseAllowed()}};var xx,Bt,NC,IO,MO;function qs(r,e){var t=Object.keys(e),i;for(i=0;i<t.length;i++)r=r.replace(new RegExp("\\{"+t[i]+"\\}","gi"),e[t[i]]);return r}function xT(r){var e,t,i;if(!r)throw new Error("cannot create a random attribute name for an undefined object");e="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",t="";do for(t="",i=0;i<12;i++)t+=e[Math.floor(Math.random()*e.length)];while(r[t]);return t}function _re(r,e){var t,i,o={},n,a;for(r=r.split(","),e=e||10,t=0;t<r.length;t+=2)i="&"+r[t+1]+";",n=parseInt(r[t],e),o[i]="&#"+n+";";return o["\\xa0"]="&#160;",o}function Ore(r){var e={left:"start",right:"end",center:"middle",start:"start",end:"end"};return e[r]||e.start}MO=_re("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32);xx={strokeStyle:{svgAttr:"stroke",canvas:"#000000",svg:"none",apply:"stroke"},fillStyle:{svgAttr:"fill",canvas:"#000000",svg:null,apply:"fill"},lineCap:{svgAttr:"stroke-linecap",canvas:"butt",svg:"butt",apply:"stroke"},lineJoin:{svgAttr:"stroke-linejoin",canvas:"miter",svg:"miter",apply:"stroke"},miterLimit:{svgAttr:"stroke-miterlimit",canvas:10,svg:4,apply:"stroke"},lineWidth:{svgAttr:"stroke-width",canvas:1,svg:1,apply:"stroke"},globalAlpha:{svgAttr:"opacity",canvas:1,svg:1,apply:"fill stroke"},font:{canvas:"10px sans-serif"},shadowColor:{canvas:"#000000"},shadowOffsetX:{canvas:0},shadowOffsetY:{canvas:0},shadowBlur:{canvas:0},textAlign:{canvas:"start"},textBaseline:{canvas:"alphabetic"},lineDash:{svgAttr:"stroke-dasharray",canvas:[],svg:null,apply:"stroke"}};NC=function(r,e){this.__root=r,this.__ctx=e};NC.prototype.addColorStop=function(r,e){var t=this.__ctx.__createElement("stop"),i,o;t.setAttribute("offset",r),e.indexOf("rgba")!==-1?(i=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi,o=i.exec(e),t.setAttribute("stop-color",qs("rgb({r},{g},{b})",{r:o[1],g:o[2],b:o[3]})),t.setAttribute("stop-opacity",o[4])):t.setAttribute("stop-color",e),this.__root.appendChild(t)};IO=function(r,e){this.__root=r,this.__ctx=e};Bt=function(r){var e={width:500,height:500,enableMirroring:!1},t;if(arguments.length>1?(t=e,t.width=arguments[0],t.height=arguments[1]):r?t=r:t=e,!(this instanceof Bt))return new Bt(t);this._randomPostfix="-"+function(){return"xxxxxxxx".replace(/x/g,function(o){return(Math.random()*16|0).toString(16)})}(),this._svgClassNames=[],this.width=t.width||e.width,this.height=t.height||e.height,this.enableMirroring=t.enableMirroring!==void 0?t.enableMirroring:e.enableMirroring,this.canvas=this,this.__document=t.document||document,t.ctx?this.__ctx=t.ctx:(this.__canvas=this.__document.createElement("canvas"),this.__ctx=this.__canvas.getContext("2d")),this.__setDefaultStyles(),this.__stack=[this.__getStyleState()],this.__groupStack=[],this.__root=this.__document.createElementNS("http://www.w3.org/2000/svg","svg"),this.__root.setAttribute("version",1.1),this.__root.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.__root.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this.__root.setAttribute("width",this.width),this.__root.setAttribute("height",this.height),this.__ids={},this.__defs=this.__document.createElementNS("http://www.w3.org/2000/svg","defs"),this.__root.appendChild(this.__defs),this.__currentElement=this.__document.createElementNS("http://www.w3.org/2000/svg","g"),this.__root.appendChild(this.__currentElement)};Bt.prototype.__createElement=function(r,e,t){typeof e=="undefined"&&(e={});var i=this.__document.createElementNS("http://www.w3.org/2000/svg",r),o=Object.keys(e),n,a;for(t&&(i.setAttribute("fill","none"),i.setAttribute("stroke","none")),n=0;n<o.length;n++)a=o[n],i.setAttribute(a,e[a]);var s=this._svgClassNames&&this._svgClassNames[this._svgClassNames.length-1];return s&&i.setAttribute("class",s),i};Bt.prototype.__setDefaultStyles=function(){var r=Object.keys(xx),e,t;for(e=0;e<r.length;e++)t=r[e],this[t]=xx[t].canvas};Bt.prototype.__applyStyleState=function(r){var e=Object.keys(r),t,i;for(t=0;t<e.length;t++)i=e[t],this[i]=r[i]};Bt.prototype.__getStyleState=function(){var r,e={},t=Object.keys(xx),i;for(r=0;r<t.length;r++)i=t[r],e[i]=this[i];return e};Bt.prototype.__applyStyleToCurrentElement=function(r){var e=this.__currentElement,t=this.__currentElementsToStyle;t&&(e.setAttribute(r,""),e=t.element,t.children.forEach(function(h){h.setAttribute(r,"")}));var i=Object.keys(xx),o,n,a,s,l,c;for(o=0;o<i.length;o++)if(n=xx[i[o]],a=this[i[o]],n.apply){if(a instanceof IO){if(a.__ctx)for(;a.__ctx.__defs.childNodes.length;)s=a.__ctx.__defs.childNodes[0].getAttribute("id"),this.__ids[s]=s,this.__defs.appendChild(a.__ctx.__defs.childNodes[0]);e.setAttribute(n.apply,qs("url(#{id})",{id:a.__root.getAttribute("id")}))}else if(a instanceof NC)e.setAttribute(n.apply,qs("url(#{id})",{id:a.__root.getAttribute("id")}));else if(n.apply.indexOf(r)!==-1&&n.svg!==a)if((n.svgAttr==="stroke"||n.svgAttr==="fill")&&a.indexOf("rgba")!==-1){l=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi,c=l.exec(a),e.setAttribute(n.svgAttr,qs("rgb({r},{g},{b})",{r:c[1],g:c[2],b:c[3]}));var d=c[4],p=this.globalAlpha;p!=null&&(d*=p),e.setAttribute(n.svgAttr+"-opacity",d)}else{var g=n.svgAttr;if(i[o]==="globalAlpha"&&(g=r+"-"+n.svgAttr,e.getAttribute(g)))continue;e.setAttribute(g,a)}}};Bt.prototype.__closestGroupOrSvg=function(r){return r=r||this.__currentElement,r.nodeName==="g"||r.nodeName==="svg"?r:this.__closestGroupOrSvg(r.parentNode)};Bt.prototype.getSerializedSvg=function(r){var e=new XMLSerializer().serializeToString(this.__root),t,i,o,n,a,s;if(s=/xmlns="http:\/\/www\.w3\.org\/2000\/svg".+xmlns="http:\/\/www\.w3\.org\/2000\/svg/gi,s.test(e)&&(e=e.replace('xmlns="http://www.w3.org/2000/svg','xmlns:xlink="http://www.w3.org/1999/xlink')),r)for(t=Object.keys(MO),i=0;i<t.length;i++)o=t[i],n=MO[o],a=new RegExp(o,"gi"),a.test(e)&&(e=e.replace(a,n));return e};Bt.prototype.getSvg=function(){return this.__root};Bt.prototype._dcgStartNamedGroup=function(r){var e=this.__createElement("g");e.setAttribute("id",r+this._randomPostfix);var t=this.__closestGroupOrSvg();this.__groupStack.push(t),t.appendChild(e),this.__currentElement=e};Bt.prototype._dcgEndNamedGroup=function(){this.__currentElement=this.__groupStack.pop(),this.__currentElement||(this.__currentElement=this.__root.childNodes[1])};Bt.prototype._dcgSaveClassName=function(r){this._svgClassNames.push(r),this.__currentElement&&this.__currentElement.tagName==="path"&&!this.__currentDefaultPath&&(this.__currentElement.getAttribute("class")||this.__currentElement.setAttribute("class",r))};Bt.prototype._dcgRestoreClassName=function(){this._svgClassNames.pop()};Bt.prototype.save=function(){var r=this.__createElement("g"),e=this.__closestGroupOrSvg();this.__groupStack.push(e),e.appendChild(r),this.__currentElement=r,this.__stack.push(this.__getStyleState())};Bt.prototype.restore=function(){this.__currentElement=this.__groupStack.pop(),this.__currentElementsToStyle=null,this.__currentElement||(this.__currentElement=this.__root.childNodes[1]);var r=this.__stack.pop();this.__applyStyleState(r)};Bt.prototype.__addTransform=function(r){var e=this.__closestGroupOrSvg();if(e.childNodes.length>0){this.__currentElement.nodeName==="path"&&(this.__currentElementsToStyle||(this.__currentElementsToStyle={element:e,children:[]}),this.__currentElementsToStyle.children.push(this.__currentElement),this.__applyCurrentDefaultPath());var t=this.__createElement("g");e.appendChild(t),this.__currentElement=t}var i=this.__currentElement.getAttribute("transform");i?i+=" ":i="",i+=r,this.__currentElement.setAttribute("transform",i)};Bt.prototype.scale=function(r,e){e===void 0&&(e=r),this.__addTransform(qs("scale({x},{y})",{x:r,y:e}))};Bt.prototype.rotate=function(r){var e=r*180/Math.PI;this.__addTransform(qs("rotate({angle},{cx},{cy})",{angle:e,cx:0,cy:0}))};Bt.prototype.translate=function(r,e){this.__addTransform(qs("translate({x},{y})",{x:r,y:e}))};Bt.prototype.transform=function(r,e,t,i,o,n){this.__addTransform(qs("matrix({a},{b},{c},{d},{e},{f})",{a:r,b:e,c:t,d:i,e:o,f:n}))};Bt.prototype.beginPath=function(){var r,e;this.__currentDefaultPath="",this.__currentPosition={},r=this.__createElement("path",{},!0),e=this.__closestGroupOrSvg(),e.appendChild(r),this.__currentElement=r};Bt.prototype.__applyCurrentDefaultPath=function(){var r=this.__currentElement;r.nodeName==="path"?r.setAttribute("d",this.__currentDefaultPath):console.error("Attempted to apply path command to node",r.nodeName)};Bt.prototype.__addPathCommand=function(r){this.__currentDefaultPath+=" ",this.__currentDefaultPath+=r};Bt.prototype.moveTo=function(r,e){this.__currentElement.nodeName!=="path"&&this.beginPath(),this.__currentPosition={x:r,y:e},this.__addPathCommand(qs("M {x} {y}",{x:r,y:e}))};Bt.prototype.closePath=function(){this.__currentDefaultPath&&this.__addPathCommand("Z")};Bt.prototype.lineTo=function(r,e){this.__currentPosition={x:r,y:e},this.__currentDefaultPath.indexOf("M")>-1?this.__addPathCommand(qs("L {x} {y}",{x:r,y:e})):this.__addPathCommand(qs("M {x} {y}",{x:r,y:e}))};Bt.prototype.bezierCurveTo=function(r,e,t,i,o,n){this.__currentPosition={x:o,y:n},this.__addPathCommand(qs("C {cp1x} {cp1y} {cp2x} {cp2y} {x} {y}",{cp1x:r,cp1y:e,cp2x:t,cp2y:i,x:o,y:n}))};Bt.prototype.quadraticCurveTo=function(r,e,t,i){this.__currentPosition={x:t,y:i},this.__addPathCommand(qs("Q {cpx} {cpy} {x} {y}",{cpx:r,cpy:e,x:t,y:i}))};var TO=function(r){var e=Math.sqrt(r[0]*r[0]+r[1]*r[1]);return[r[0]/e,r[1]/e]};Bt.prototype.arcTo=function(r,e,t,i,o){var n=this.__currentPosition&&this.__currentPosition.x,a=this.__currentPosition&&this.__currentPosition.y;if(!(typeof n=="undefined"||typeof a=="undefined")){if(o<0)throw new Error("IndexSizeError: The radius provided ("+o+") is negative.");if(n===r&&a===e||r===t&&e===i||o===0){this.lineTo(r,e);return}var s=TO([n-r,a-e]),l=TO([t-r,i-e]);if(s[0]*l[1]===s[1]*l[0]){this.lineTo(r,e);return}var c=s[0]*l[0]+s[1]*l[1],d=Math.acos(Math.abs(c)),p=TO([s[0]+l[0],s[1]+l[1]]),g=o/Math.sin(d/2),h=r+g*p[0],f=e+g*p[1],y=[-s[1],s[0]],x=[l[1],-l[0]],E=function(v){var M=v[0],A=v[1];return A>=0?Math.acos(M):-Math.acos(M)},C=E(y),S=E(x);this.lineTo(h+y[0]*o,f+y[1]*o),this.arc(h,f,o,C,S)}};Bt.prototype.stroke=function(){this.__currentElement.nodeName==="path"&&this.__currentElement.setAttribute("paint-order","fill stroke markers"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("stroke")};Bt.prototype.fill=function(){this.__currentElement.nodeName==="path"&&this.__currentElement.setAttribute("paint-order","stroke fill markers"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("fill")};Bt.prototype.rect=function(r,e,t,i){this.__currentElement.nodeName!=="path"&&this.beginPath(),this.moveTo(r,e),this.lineTo(r+t,e),this.lineTo(r+t,e+i),this.lineTo(r,e+i),this.lineTo(r,e),this.closePath()};Bt.prototype.fillRect=function(r,e,t,i){var o,n;o=this.__createElement("rect",{x:r,y:e,width:t,height:i},!0),n=this.__closestGroupOrSvg(),n.appendChild(o),this.__currentElement=o,this.__applyStyleToCurrentElement("fill")};Bt.prototype.strokeRect=function(r,e,t,i){var o,n;o=this.__createElement("rect",{x:r,y:e,width:t,height:i},!0),n=this.__closestGroupOrSvg(),n.appendChild(o),this.__currentElement=o,this.__applyStyleToCurrentElement("stroke")};Bt.prototype.__clearCanvas=function(){for(var r=this.__closestGroupOrSvg(),e=r.getAttribute("transform"),t=this.__root.childNodes[1],i=t.childNodes,o=i.length-1;o>=0;o--)i[o]&&t.removeChild(i[o]);this.__currentElement=t,this.__groupStack=[],e&&this.__addTransform(e)};Bt.prototype.clearRect=function(r,e,t,i){if(r===0&&e===0&&t===this.width&&i===this.height){this.__clearCanvas();return}var o,n=this.__closestGroupOrSvg();o=this.__createElement("rect",{x:r,y:e,width:t,height:i,fill:"#FFFFFF"},!0),n.appendChild(o)};Bt.prototype.createLinearGradient=function(r,e,t,i){var o=this.__createElement("linearGradient",{id:xT(this.__ids),x1:r+"px",x2:t+"px",y1:e+"px",y2:i+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(o),new NC(o,this)};Bt.prototype.createRadialGradient=function(r,e,t,i,o,n){var a=this.__createElement("radialGradient",{id:xT(this.__ids),cx:i+"px",cy:o+"px",r:n+"px",fx:r+"px",fy:e+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(a),new NC(a,this)};Bt.prototype.__parseFont=function(){var r=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-,\'\"\sa-z0-9]+?)\s*$/i,e=r.exec(this.font),t={style:e[1]||"normal",size:e[4]||"10px",family:e[6]||"sans-serif",weight:e[3]||"normal",decoration:e[2]||"normal",href:null};return this.__fontUnderline==="underline"&&(t.decoration="underline"),this.__fontHref&&(t.href=this.__fontHref),t};Bt.prototype.__wrapTextLink=function(r,e){if(r.href){var t=this.__createElement("a");return t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r.href),t.appendChild(e),t}return e};Bt.prototype.__applyText=function(r,e,t,i){var o=this.__parseFont(),n=this.__closestGroupOrSvg(),a=this.__createElement("text",{"font-family":o.family,"font-size":o.size,"font-style":o.style,"font-weight":o.weight,"text-decoration":o.decoration,x:e,y:t,"text-anchor":Ore(this.textAlign)},!0);a.appendChild(this.__document.createTextNode(r)),this.__currentElement=a,this.__applyStyleToCurrentElement(i),n.appendChild(this.__wrapTextLink(o,a))};Bt.prototype.fillText=function(r,e,t){this.__applyText(r,e,t,"fill")};Bt.prototype.strokeText=function(r,e,t){this.__applyText(r,e,t,"stroke")};Bt.prototype.measureText=function(r){return this.__ctx.font=this.font,this.__ctx.measureText(r)};Bt.prototype.arc=function(r,e,t,i,o,n){if(i!==o){i=i%(2*Math.PI),o=o%(2*Math.PI),i===o&&(o=(o+2*Math.PI-.001*(n?-1:1))%(2*Math.PI));var a=r+t*Math.cos(o),s=e+t*Math.sin(o),l=r+t*Math.cos(i),c=e+t*Math.sin(i),d=n?0:1,p=0,g=o-i;g<0&&(g+=2*Math.PI),n?p=g>Math.PI?0:1:p=g>Math.PI?1:0,this.lineTo(l,c),this.__addPathCommand(qs("A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}",{rx:t,ry:t,xAxisRotation:0,largeArcFlag:p,sweepFlag:d,endX:a,endY:s})),this.__currentPosition={x:a,y:s}}};Bt.prototype.clip=function(){var r=this.__closestGroupOrSvg(),e=this.__createElement("clipPath"),t=xT(this.__ids),i=this.__createElement("g");this.__applyCurrentDefaultPath(),r.removeChild(this.__currentElement),e.setAttribute("id",t),e.appendChild(this.__currentElement),this.__defs.appendChild(e),r.setAttribute("clip-path",qs("url(#{id})",{id:t})),r.appendChild(i),this.__currentElement=i};Bt.prototype.drawImage=function(){var r=Array.prototype.slice.call(arguments),e=r[0],t,i,o,n,a=0,s=0,l,c,d,p,g,h,f,y,x,E,C;if(r.length===3)t=r[1],i=r[2],l=e.width,c=e.height,o=l,n=c;else if(r.length===5)t=r[1],i=r[2],o=r[3],n=r[4],l=e.width,c=e.height;else if(r.length===9)a=r[1],s=r[2],l=r[3],c=r[4],t=r[5],i=r[6],o=r[7],n=r[8];else throw new Error("Invalid number of arguments passed to drawImage: "+arguments.length);d=this.__closestGroupOrSvg(),f=this.__currentElement;var S="translate("+t+", "+i+")";if(e instanceof Bt){if(p=e.getSvg().cloneNode(!0),p.childNodes&&p.childNodes.length>1){for(g=p.childNodes[0];g.childNodes.length;)C=g.childNodes[0].getAttribute("id"),this.__ids[C]=C,this.__defs.appendChild(g.childNodes[0]);if(h=p.childNodes[1],h){var v=h.getAttribute("transform"),M;v?M=v+" "+S:M=S,h.setAttribute("transform",M),d.appendChild(h)}}}else(e.nodeName==="CANVAS"||e.nodeName==="IMG")&&(y=this.__createElement("image"),y.setAttribute("width",o),y.setAttribute("height",n),y.setAttribute("opacity",this.globalAlpha),y.setAttribute("preserveAspectRatio","none"),(a||s||l!==e.width||c!==e.height)&&(x=this.__document.createElement("canvas"),x.width=o,x.height=n,E=x.getContext("2d"),E.drawImage(e,a,s,l,c,0,0,o,n),e=x),y.setAttribute("transform",S),y.setAttribute("xlink:href",e.nodeName==="CANVAS"?e.toDataURL():e.getAttribute("src")),d.appendChild(y))};Bt.prototype.createPattern=function(r,e){var t=this.__document.createElementNS("http://www.w3.org/2000/svg","pattern"),i=xT(this.__ids),o;return t.setAttribute("id",i),t.setAttribute("width",r.width),t.setAttribute("height",r.height),r.nodeName==="CANVAS"||r.nodeName==="IMG"?(o=this.__document.createElementNS("http://www.w3.org/2000/svg","image"),o.setAttribute("width",r.width),o.setAttribute("height",r.height),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r.nodeName==="CANVAS"?r.toDataURL():r.getAttribute("src")),t.appendChild(o),this.__defs.appendChild(t)):r instanceof Bt&&(t.appendChild(r.__root.childNodes[1]),this.__defs.appendChild(t)),new IO(t,this)};Bt.prototype.setLineDash=function(r){r&&r.length>0?this.lineDash=r.join(","):this.lineDash=null};Bt.prototype.ellipse=function(r,e,t,i,o,n,a,s){if(n!==a){n=n%(2*Math.PI),a=a%(2*Math.PI),n===a&&(a=(a+2*Math.PI-.001*(s?-1:1))%(2*Math.PI));var l=r+Math.cos(-o)*t*Math.cos(a)+Math.sin(-o)*i*Math.sin(a),c=e-Math.sin(-o)*t*Math.cos(a)+Math.cos(-o)*i*Math.sin(a),d=r+Math.cos(-o)*t*Math.cos(n)+Math.sin(-o)*i*Math.sin(n),p=e-Math.sin(-o)*t*Math.cos(n)+Math.cos(-o)*i*Math.sin(n),g=s?0:1,h=0,f=a-n;f<0&&(f+=2*Math.PI),s?h=f>Math.PI?0:1:h=f>Math.PI?1:0,this.lineTo(d,p),this.__addPathCommand(qs("A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}",{rx:t,ry:i,xAxisRotation:o*(180/Math.PI),largeArcFlag:h,sweepFlag:g,endX:l,endY:c})),this.__currentPosition={x:l,y:c}}};Bt.prototype._dcgSetTitle=function(r){var e=this.__currentElement,t=!1,i,o=e.getElementsByTagName("title");o.length>0?i=o[0]:(i=this.__document.createElementNS("http://www.w3.org/2000/svg","title"),t=!0),i.textContent=r,t&&e.appendChild(i)};Bt.prototype.drawFocusRing=function(){};Bt.prototype.createImageData=function(){};Bt.prototype.getImageData=function(){};Bt.prototype.putImageData=function(){};Bt.prototype.globalCompositeOperation=function(){};Bt.prototype.setTransform=function(){};var TH=Bt;qt();var uh=document.createElement("canvas").getContext("2d"),Hs=class r{constructor(e,t){this._label=e,this._fontSize=t,this._layout=Rre(e,t)}getRect(){return this.getRectWhenCenteredAt({x:0,y:0})}getRectWhenCenteredAt(e){return{left:this._layout.left+e.x,right:this._layout.right+e.x,top:this._layout.top+e.y,bottom:this._layout.bottom+e.y}}getBoundsWhenCenteredAt(e,t){switch(t){case"x":return{lower:this._layout.left+e,upper:this._layout.right+e};case"y":return{lower:this._layout.top+e,upper:this._layout.bottom+e};default:let i=t;throw new Error(`Unknown axis: ${i}`)}}getWidth(){return this._layout.right-this._layout.left}getHeight(){return this._layout.bottom-this._layout.top}getDimensionAlongAxis(e){switch(e){case"x":return this.getWidth();case"y":return this.getHeight();default:let t=e;throw new Error(`Unknown axis: ${t}`)}}clampBoundsWithinRect(e,t){let i,o;return e.x+this._layout.left<t.left?i=t.left-this._layout.left:e.x+this._layout.right>t.right?i=t.right-this._layout.right:i=e.x,e.y+this._layout.top<t.top?o=t.top-this._layout.top:e.y+this._layout.bottom>t.bottom?o=t.bottom-this._layout.bottom:o=e.y,{x:i,y:o}}getValue(){return this._label.value}getMinusWidth(){return this.getValue()<0?(r.setCtxFontSize(uh,this._fontSize),uh.measureText("-1").width-uh.measureText("1").width):0}getString(){return this._label.superscript?this._label.mantissa+"^"+this._label.superscript:this._label.string}drawCenteredAt(e,t,i){let o=t.x,n=r.computeBaselineFromCenter(t.y,this._fontSize);i&&Po(e,i),e.save(),i&&fo(e),r.setCtxFontSize(e,this._fontSize),this._label.superscript?(e.strokeText(this._label.mantissa,this._layout.mantissa_x+o,this._layout.mantissa_y+n),e.strokeText(this._label.superscript,this._layout.superscript_x+o,this._layout.superscript_y+n),e.fillText(this._label.mantissa,this._layout.mantissa_x+o,this._layout.mantissa_y+n),e.fillText(this._label.superscript,this._layout.superscript_x+o,this._layout.superscript_y+n)):(e.strokeText(this._label.string,this._layout.mantissa_x+o,this._layout.mantissa_y+n),e.fillText(this._label.string,this._layout.mantissa_x+o,this._layout.mantissa_y+n)),e.restore()}static computeBaselineFromCenter(e,t){return e+.272*t}static setCtxFontSize(e,t){e.font=t+"px Arial",e.textAlign="center"}};function Rre(r,e){if(r.superscript){let t=e;Hs.setCtxFontSize(uh,t);let i=uh.measureText(r.mantissa).width,o=Math.round(.8*e);Hs.setCtxFontSize(uh,o);let n=uh.measureText(r.superscript).width,a=0,s=e/5,l=i/2+n/2,c=-e/4,d=c-o/2,p=s+t/2,g=a-i/2,h=l+n/2;return{top:d,bottom:p,left:g,right:h,mantissa_height:t,mantissa_width:i,mantissa_x:a,mantissa_y:s,superscript_height:o,superscript_width:n,superscript_x:l,superscript_y:c}}else{let t=e;Hs.setCtxFontSize(uh,e);let i=uh.measureText(r.string).width,o=0,n=0,a=n-t/2,s=n+t/2,l=o-i/2,c=o+i/2;return{top:a,bottom:s,left:l,right:c,mantissa_height:t,mantissa_width:i,mantissa_x:o,mantissa_y:n}}}function Fre(r,e,t,i){let o=Math.ceil(r/t),n=Math.floor(e/t),a=1/t;if(!(o>n)&&!(n-o>1e4))for(let s=o;s<=n;s++)i(s/a)}var AO={base:10,major:[1,2,5],minor:[5,4,5]},Nre={base:10,major:[Math.PI,2*Math.PI,5*Math.PI],minor:[4,4,5]},Bre={base:2,major:[Math.PI/3],minor:[3]};function Ure(r){return r?{base:10,major:[r,2*r,5*r],minor:[4,4,5]}:AO}function VO(r,e){let{major:t,minor:i,base:o}=e,n=1/0,a=1/0;for(let s=0;s<t.length;s++){let l=t[s],c=Math.ceil(Math.log(r/l)/Math.log(o)),d=l*Math.pow(o,c);if(d<n){n=d;let p=i[s];a=n/p}}return{major:n,minor:a}}function zre(r,e,t){return 1+(e-r)/t}function MH(r){let e=r.screen.width,t=r.screen.height,i=r.viewport.xmax-r.viewport.xmin,o=r.viewport.ymax-r.viewport.ymin,n=r.settings.pixelsPerLabel;return{majorStepX:n/e*i,majorStepY:n/t*o}}function Qc(r){let e=l=>{let[c,d,p,g,h]=l==="x"?[r.viewport.xmin,r.viewport.xmax,r.settings.xAxisStep,r.settings.xAxisNumbers,r.settings.xAxisMinorSubdivisions]:[r.viewport.ymin,r.viewport.ymax,r.settings.yAxisStep,r.settings.yAxisNumbers,r.settings.yAxisMinorSubdivisions],f=d-c,y=Math.abs(p!=null?p:NaN),x=0,E=0;if(y&&y!==Math.PI){let C=zre(c,d,y);if(C>=3&&C<100){let S=0;if(g){let M=0;Fre(c,d,y,function(A){let I=new Hs(__dcg_shared_module_exports__['ob'](A,f),r.settings.labelSize);M=Math.max(I.getDimensionAlongAxis(l),M)}),S=M+10}else S=h===1?8:20;let v=l==="x"?"width":"height";C*S<=r.screen[v]&&(x=y,y===3||y===5?E=1:E=y/4)}}if(!x){let C=MH(r)[l==="x"?"majorStepX":"majorStepY"],S=VO(C,__dcg_shared_module_exports__['ob'](y,f).string.indexOf("\u03C0")>=0?C>=1?Nre:Bre:Ure(y));x=S.major,E=S.minor}return{majorStep:x,minorStep:E}},t=()=>{var l,c;if(Math.abs((l=r.settings.xAxisStep)!=null?l:NaN)===Math.abs((c=r.settings.yAxisStep)!=null?c:NaN)){let{xmin:g,xmax:h,ymin:f,ymax:y}=r.viewport,x=r.screen.width/(h-g),E=r.screen.height/(y-f),C=x/E,S=.01;if(C>=1-S&&C<=2){let{majorStep:v,minorStep:M}=e("y");return{x:{majorStep:v,minorStep:M},y:{majorStep:v,minorStep:M}}}if(C<=1-S&&C>=.5){let{majorStep:v,minorStep:M}=e("x");return{x:{majorStep:v,minorStep:M},y:{majorStep:v,minorStep:M}}}}return{x:e("x"),y:e("y")}},i=()=>{let{xAxisScale:l,yAxisScale:c}=r.settings,d=l==="logarithmic",p=c==="logarithmic";return!d&&!p?t():{x:d?{majorStep:NaN,minorStep:NaN}:e("x"),y:p?{majorStep:NaN,minorStep:NaN}:e("y")}},{x:o,y:n}=i(),{xAxisMinorSubdivisions:a=0,yAxisMinorSubdivisions:s=0}=r.settings;return{majorStepX:o.majorStep,minorStepX:a>0?o.majorStep/a:o.minorStep,majorStepY:n.majorStep,minorStepY:s>0?n.majorStep/s:n.minorStep}}function IH(r){let e=MH(r),t=VO(e.majorStepX,AO),i=VO(e.majorStepY,AO),o=t.major>i.major?t:i;return{majorStepR:o.major,minorStepR:o.minor}}qt();function pi(){document.activeElement&&ug(document.activeElement)&&ie(document.activeElement).trigger("blur")}var oSe=__dcg_shared_module_exports__['e'](AH());qt();var VH=["exp|exponent ln|natural-log log","total length count mean median quantile quartile nCr nPr stats","stdev|standard-deviation stddev|standard-deviation","stdDev|standard-deviation stdevp|standard-deviation-population","stddevp|standard-deviation-population stdDevP|standard-deviation-population mad var|variance","varp|variance-population variance cov|co-variance covp|co-variance-population corr|correlation spearman","lcm mcm gcd mcd gcf mod ceil|ceiling floor round abs|absolute-value min max sign|signum signum sgn","sin|sine cos|cosine tan|tangent csc|co-secant sec|secant cot|co-tangent","sinh|hyperbolic-sine cosh|hyperbolic-cosine tanh|hyperbolic-tangent csch|hyperbolic-co-secant","sech|hyperbolic-secant coth|hyperbolic-co-tangent","arcsin|arc-sine arccos|arc-cosine arctan|arc-tangent arccsc|arc-co-secant arcsec|arc-secant","arccot|arc-co-tangent","arcsinh|hyperbolic-arc-sine arccosh|hyperbolic-arc-cosine arctanh|hyperbolic-arc-co-tangent","arccsch|hyperbolic-arc-co-secant arcsech|hyperbolic-arc-secant","arccoth|hyperbolic-arc-co-tangent","arsinh|hyperbolic-ar-sine arcosh|hyperbolic-ar-cosine artanh|hyperbolic-ar-co-tangent","arcsch|hyperbolic-ar-co-secant arsech|hyperbolic-ar-secant","arcoth|hyperbolic-ar-co-tangent","polygon","distance midpoint","sort shuffle join unique","erf|error-function","TTest|t-test ttest|t-test TScore|t-score tscore|t-score","iTTest|independent-t-test ittest|independent-t-test IndependentTTest","TScore|t-score Tscore|t-score tscore|t-score","normaldist|normal-distribution tdist|t-distribution poissondist|poisson-distribution","binomialdist|binomial-distribution","uniformdist|uniform-distribution","pdf cdf random inverseCdf inversecdf","histogram dotplot boxplot","pdf cdf","rgb hsv","for","width height","with"].join(" "),Kre=["det|determinant","inv|inverse","transpose","rref|reduced-row-echelon-form","trace"].join(" ");VH+=" "+Kre;var qre="alpha beta sqrt theta phi rho pi tau nthroot cbrt sum prod integral percent infinity infty cross";function Hp(r){r||(r={});let e=[qre];return r.disallowAns||e.push("ans"),r.disallowFrac||e.push("frac"),r.additionalCommands&&(e=e.concat(r.additionalCommands)),e.join(" ")}function Wp(r){r||(r={});let e=VH;return r.additionalOperators&&r.additionalOperators.length&&(e=`${e} ${r.additionalOperators.join(" ")}`),r.includeGeometryFunctions&&(e+=" "+Object.keys(__dcg_shared_module_exports__['Cd']).join(" ")),r.include3DFunctions&&(e+=" "+Object.keys(__dcg_shared_module_exports__['Dd']).join(" ")),e}function wx(){return"for with"}var LH=window.MathQuill.noConflict().getInterface(3);LH.config({leftRightIntoCmdGoes:"up",sumStartsWithNEquals:!0,supSubsRequireOperand:!0,charsThatBreakOutOfSupSub:"+-=<>*",autoCommands:Hp(),autoSubscriptNumerals:!0,restrictMismatchedBrackets:!0,typingPercentWritesPercentOf:!0,substituteTextarea:function(){if(!jD&&(Fc||Ju)){let e=document.createElement("span");return e.classList.add("dcg-mathquill-input-span"),e.setAttribute("tabindex","0"),e.setAttribute("role","textbox"),aa(e,{display:"inline-block",height:"1px",width:"1px"}),e}if(nU&&aU){let e=document.createElement("textarea");return e.setAttribute("readonly",""),e.setAttribute("inputmode","none"),e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","none"),e.setAttribute("spellcheck","false"),e.setAttribute("autocomplete","off"),ie(e).on("keydown",function(){this.readOnly=!1,this.select()}).on("blur",function(){this.readOnly=!0}),e}let r=document.createElement("textarea");return r.setAttribute("inputmode","none"),r.setAttribute("autocorrect","off"),r.setAttribute("autocapitalize","none"),r.setAttribute("spellcheck","false"),r.setAttribute("autocomplete","off"),r},autoOperatorNames:Wp(),infixOperatorNames:wx(),quietEmptyDelimiters:"( [",resetCursorOnBlur:!0,enableDigitGrouping:!0,disableAutoSubstitutionInSubscripts:!0,interpretTildeAsSim:!0});var Zc=LH;var Wre=/`[^`]*`/g,$re=/^[\+\-]?[\d]*(\.\d+)?$/,jre=r=>{if(r!=null){let e=r.match(/`/g);return(e!=null&&e.length||0)%2==0}return!0},Yre=r=>{let e=[];if(r==null||r.length==0)return e;let t=0,i;for(;i=Wre.exec(r);){let n=r.slice(t,i.index);n.length>0&&e.push({from:t,to:i.index,type:"text",text:n}),t=i.index+i[0].length,e.push({from:i.index,to:t,type:"math",text:i[0].slice(1,-1)})}let o=r.slice(t);return o.length>0&&e.push({from:t,to:r.length,type:"text",text:o}),e},PH=Zc.StaticMath(document.createElement("span"));function la(r){let e="",t=[];jre(r)?t=Yre(r):t=[{from:0,to:r.length,type:"text",text:r}];for(let i of t)e+=i.type==="text"?i.text:Ua(i.text);return e}function Ua(r){let e="";return $re.test(r)?(/^\+/.test(r)?(e="positive ",r=r.slice(1)):/^\-/.test(r)&&(e="negative ",r=r.slice(1)),e+=r.replace(/(\.)([0-9]+)/g,(t,i,o)=>i+o.split("").join(" ").trim())):(PH.latex(r),e=PH.mathspeak().trim()),e}function Ui(r,e){if(!r)return"";let{controller:t}=r;if(r.type==="expression"){let i=t.isItemSecret(r.id);switch(e){case"describe":return i?t.s("graphing-calculator-narration-describe-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-describe-expression",{index:r.displayIndex});case"delete":return i?t.s("graphing-calculator-narration-delete-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-delete-expression",{index:r.displayIndex});case"duplicate":return i?t.s("graphing-calculator-narration-duplicate-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-duplicate-expression",{index:r.displayIndex});case"show":return i?t.s("graphing-calculator-narration-show-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-show-expression",{index:r.displayIndex});case"hide":return i?t.s("graphing-calculator-narration-hide-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-hide-expression",{index:r.displayIndex});case"show-options":return i?t.s("graphing-calculator-narration-show-options-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-show-options-expression",{index:r.displayIndex});case"hide-options":return i?t.s("graphing-calculator-narration-hide-options-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-hide-options-expression",{index:r.displayIndex});case"create_table":return i?t.s("graphing-calculator-narration-create-table-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-create-table-expression",{index:r.displayIndex});case"rename":return i?t.s("graphing-calculator-narration-rename-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-rename-expression",{index:r.displayIndex});case"mute":return i?t.s("graphing-calculator-narration-mute-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-mute-expression",{index:r.displayIndex});case"unmute":return i?t.s("graphing-calculator-narration-unmute-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-unmute-expression",{index:r.displayIndex})}}if(r.type==="image")switch(e){case"describe":return t.s("graphing-calculator-narration-describe-image",{index:r.displayIndex});case"delete":return t.s("graphing-calculator-narration-delete-image",{index:r.displayIndex});case"duplicate":return t.s("graphing-calculator-narration-duplicate-image",{index:r.displayIndex});case"show":return t.s("graphing-calculator-narration-show-image",{index:r.displayIndex});case"hide":return t.s("graphing-calculator-narration-hide-image",{index:r.displayIndex});case"show-options":return t.s("graphing-calculator-narration-show-options-image",{index:r.displayIndex});case"hide-options":return t.s("graphing-calculator-narration-hide-options-image",{index:r.displayIndex});case"edit_title":return t.s("graphing-calculator-narration-edit-image-title",{index:r.displayIndex})}if(r.type==="text")switch(e){case"describe":return t.s("graphing-calculator-narration-describe-text",{index:r.displayIndex});case"delete":return t.s("graphing-calculator-narration-delete-text",{index:r.displayIndex});case"duplicate":return t.s("graphing-calculator-narration-duplicate-text",{index:r.displayIndex});case"show":return t.s("graphing-calculator-narration-show-text",{index:r.displayIndex});case"hide":return t.s("graphing-calculator-narration-hide-text",{index:r.displayIndex});case"edit_title":return t.s("graphing-calculator-narration-edit-text-title",{index:r.displayIndex})}if(r.type==="table")switch(e){case"describe":return t.s("graphing-calculator-narration-describe-table",{index:r.displayIndex});case"delete":return t.s("graphing-calculator-narration-delete-table",{index:r.displayIndex});case"duplicate":return t.s("graphing-calculator-narration-duplicate-table",{index:r.displayIndex});case"show":return t.s("graphing-calculator-narration-show-table",{index:r.displayIndex});case"hide":return t.s("graphing-calculator-narration-hide-table",{index:r.displayIndex});case"rename":return t.s("graphing-calculator-narration-rename-table",{index:r.displayIndex})}if(r.type==="folder"){let i=!!r.title;switch(e){case"describe":return i?t.s("graphing-calculator-narration-describe-folder-title",{folder:r.title}):t.s("graphing-calculator-narration-describe-folder-index",{index:r.displayIndex});case"collapse":return i?t.s("graphing-calculator-narration-collapse-folder-title",{folder:r.title}):t.s("graphing-calculator-narration-collapse-folder-index",{index:r.displayIndex});case"expand":return i?t.s("graphing-calculator-narration-expand-folder-title",{folder:r.title}):t.s("graphing-calculator-narration-expand-folder-index",{index:r.displayIndex});case"show":return i?t.s("graphing-calculator-narration-show-folder-title",{folder:r.title}):t.s("graphing-calculator-narration-show-folder-index",{index:r.displayIndex});case"hide":return i?t.s("graphing-calculator-narration-hide-folder-title",{folder:r.title}):t.s("graphing-calculator-narration-hide-folder-index",{index:r.displayIndex});case"duplicate":return i?t.s("graphing-calculator-narration-duplicate-folder-title",{folder:r.title}):t.s("graphing-calculator-narration-duplicate-folder-index",{index:r.displayIndex});case"delete":return i?t.s("graphing-calculator-narration-delete-folder-title",{folder:r.title}):t.s("graphing-calculator-narration-delete-folder-index",{index:r.displayIndex});case"edit_title":return t.s("graphing-calculator-narration-edit-folder-title",{index:r.displayIndex})}}switch(e){case"describe":return t.s("graphing-calculator-narration-describe");case"delete":return t.s("graphing-calculator-narration-delete");case"duplicate":return t.s("graphing-calculator-narration-duplicate");case"expand":return t.s("graphing-calculator-narration-expand");case"collapse":return t.s("graphing-calculator-narration-collapse");case"show":return t.s("graphing-calculator-narration-show");case"hide":return t.s("graphing-calculator-narration-hide");case"show-options":return t.s("graphing-calculator-narration-show-options");case"hide-options":return t.s("graphing-calculator-narration-hide-options");case"create_table":return t.s("graphing-calculator-narration-create-table");case"rename":return t.s("graphing-calculator-narration-rename");case"edit_title":return t.s("graphing-calculator-narration-edit-title");case"mute":return t.s("graphing-calculator-narration-mute");case"unmute":return t.s("graphing-calculator-narration-unmute");default:return e}}function nn(r,e,t={includeDetails:!0}){var a;if(!r)return e.s("graphing-calculator-narration-geometry-nothing-selected");let i=t.description?t.description:"";if(r.type!=="expression"){if(r.type==="image"){let s=i!==""?i:Ui(r,"describe"),{x:l,y:c}=r.formula.dimensions;l&&c&&typeof l[0]=="number"&&typeof c[0]=="number"?i=e.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:s,x:ps(e,l[0]),y:us(e,c[0])}):i=s}}else(!r.latex||!((a=r.formula)!=null&&a.typed_constant_value))&&(i=i!==""?i:Ui(r,"describe"));let o=t.poi&&t.poi.sketch.showPOI&&t.poi.type==="static-labeled-point";!i&&Xc(r)?(i=Xre(r,e,t),i=Qre(i,r,e,t)):t.includeDetails&&t.poi&&!o&&(i=e.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:i,x:ps(e,t.poi.x),y:us(e,t.poi.y)}));let n=i;return t.includeSelectionState&&!lx(r)&&!o&&(n=LO(n,r,e)),lx(r)&&(n=e.s("shared-calculator-narration-item-clickable",{item:n})),n}function Xre(r,e,t={includeDetails:!0}){var l;let{value:i,valueType:o}=Pg(r,t);if(!i)return e.s("shared-calculator-narration-item-unknown");let n=[];if(__dcg_shared_module_exports__['db'](o))n=BH(r,e,t);else switch(o){case __dcg_shared_module_exports__['va']:n=CT(r,e,t);break;case __dcg_shared_module_exports__['Ha']:n=_H(r,e,t);break;case __dcg_shared_module_exports__['Ja']:n=OH(r,e,t);break;case __dcg_shared_module_exports__['Da']:n=RH(r,e,t);break;case __dcg_shared_module_exports__['La']:case __dcg_shared_module_exports__['Na']:case __dcg_shared_module_exports__['Fa']:case __dcg_shared_module_exports__['Va']:n=FH(r,e,t);break;case __dcg_shared_module_exports__['Pa']:case __dcg_shared_module_exports__['Ra']:n=NH(r,e,t);break;default:n.push(e.s("shared-calculator-narration-item-unknown"))}let a=n.join(" "),s=(l=r.formula.geometry)==null?void 0:l.call;return s&&(a=Jre(a,s,e)),a}function Jre(r,e,t){let i,o=e.parents;if(e.symbol==="apply"){let n=o[0],a=n?t.getItemsByIdentifier(n[0]):[];if(n&&n[0]&&a.length===0)i=n[0];else for(let s of a){if(s.type!=="expression")continue;let l=s.formula.geometry;if(!(!l||!l.call)){i=l.call.symbol;break}}}else if(__dcg_shared_module_exports__['oc'](e.symbol))i=e.symbol;else return r;switch(i){case"coterminal":case"supplement":return r;case"dilate":return t.s("graphing-calculator-narration-geometry-dilated-item",{item:r});case"rotate":return t.s("graphing-calculator-narration-geometry-rotated-item",{item:r});case"translate":return t.s("graphing-calculator-narration-geometry-translated-item",{item:r});case"reflect":return t.s("graphing-calculator-narration-geometry-reflected-item",{item:r});default:return t.s("graphing-calculator-narration-geometry-transformed-item",{item:r})}}function Qre(r,e,t,i){var o,n;return i.listIndex!==void 0&&((n=(o=e.formula)==null?void 0:o.geometry)!=null&&n.valueType)&&__dcg_shared_module_exports__['db'](e.formula.geometry.valueType)?t.s("graphing-calculator-narration-item-with-list-index",{listIndex:i.listIndex+1,item:r}):i.polygonEdge!==void 0?t.s("graphing-calculator-narration-geometry-edge-of-polygon",{polygonEdge:i.polygonEdge+1,item:r}):r}function LO(r,e,t){return(e&&Na(e)?t.s("shared-calculator-narration-item-selected",{item:r}):t.s("shared-calculator-narration-item-unselected",{item:r})).trim()}var wc=1;function Zre(r){let e=r.formula.geometry&&r.formula.geometry.call;return!e||!e.parents?[]:e.parents.map(t=>t===void 0?"":t[0])}function UC(r,e){return Zre(r).map(t=>{let i=e.getGeoTokenInfoFromIdentifier(t);if(i)return e.getItemModel(i.calcId)})}function Pg(r,e={}){let t=r.formula.typed_constant_value.value,i=r.formula.typed_constant_value.valueType;return e.listIndex!==void 0&&__dcg_shared_module_exports__['db'](i)&&(i=__dcg_shared_module_exports__['eb'](i),t=t[e.listIndex]),{value:t,valueType:i}}function CT(r,e,t){var y,x;let i=t.depth?t.depth:0,o,n=[],a=(y=r.formula.geometry.call)==null?void 0:y.symbol,s=UC(r,e),l=s[0],c=s[1],{value:d}=Pg(r,t),p=d[0],g=d[1],h=(x=t.poi)==null?void 0:x.ariaLabel,f=h!==void 0&&h!==""?h:r.label;switch(a){case"intersection":f?o=e.s("graphing-calculator-narration-geometry-intersection-with-assignment",{assignment:la(f)}):o=e.s("graphing-calculator-narration-geometry-unlabeled-intersection",{index:r.id}),i<wc&&l!==void 0&&c!==void 0?n.push(e.s("graphing-calculator-narration-geometry-intersection-of-items",{intersectionDescription:o,item1:nn(l,e,{includeDetails:!1,depth:i+1}),item2:nn(c,e,{includeDetails:!1,depth:i+1})})):n.push(o);break;case"midpoint":f?o=e.s("graphing-calculator-narration-geometry-midpoint-with-assignment",{assignment:la(f)}):o=e.s("graphing-calculator-narration-geometry-unlabeled-midpoint",{index:r.id}),i<wc&&l!==void 0?n.push(e.s("graphing-calculator-narration-geometry-midpoint-of-item",{midpointDescription:o,item:nn(l,e,{includeDetails:!1,depth:i+1})})):n.push(o);break;case"glider":f?o=e.s("graphing-calculator-narration-geometry-glider-with-assignment",{assignment:la(f)}):o=e.s("graphing-calculator-narration-geometry-unlabeled-glider",{index:r.id}),i<wc&&l!==void 0?n.push(e.s("graphing-calculator-narration-geometry-glider-on-item",{gliderDescription:o,item:nn(l,e,{includeDetails:!1,depth:i+1})})):n.push(o);break;default:f?o=e.s("graphing-calculator-narration-geometry-point-with-assignment",{assignment:la(f)}):o=e.s("graphing-calculator-narration-geometry-unlabeled-point",{index:r.id}),t.includeDetails&&typeof p=="number"&&typeof g=="number"?n.push(e.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:o,x:ps(e,p),y:us(e,g)})):n.push(o)}return n}function _H(r,e,t){var p,g;let i=t.depth?t.depth:0,o=[],a=UC(r,e)[0],{value:s}=Pg(r,t),l=s[1],c=e.get2dProjection(),d=c&&c.viewport;return i<wc&&a!==void 0&&Xc(a)&&!((g=(p=a.formula.geometry)==null?void 0:p.call)!=null&&g.symbol)&&typeof l=="number"&&d!==void 0?o.push(e.s("graphing-calculator-narration-geometry-circle-with-center-and-radius",{index:r.id,center:nn(a,e,{includeDetails:!1,depth:i+1}),radius:Ua(__dcg_shared_module_exports__['ob'](l,d.xmax-d.xmin).latex)})):o.push(e.s("graphing-calculator-narration-geometry-unlabeled-circle",{index:r.id})),o}function OH(r,e,t){let i=t.depth?t.depth:0,o=[],n=UC(r,e),a=n[0],s=n[1],l=n[2];return i<wc&&a!==void 0&&s!==void 0&&l!==void 0?o.push(e.s("graphing-calculator-narration-geometry-arc-through-points",{index:r.id,start:nn(a,e,{includeDetails:!1,depth:i+1}),middle:nn(s,e,{includeDetails:!1,depth:i+1}),end:nn(l,e,{includeDetails:!1,depth:i+1})})):o.push(e.s("graphing-calculator-narration-geometry-unlabeled-arc",{index:r.id})),o}function RH(r,e,t){var g,h,f,y;let i=t.depth?t.depth:0,{value:o}=Pg(r,t),n=o.length;if(t.polygonEdge!==void 0)if(t.polygonEdge>=0&&t.polygonEdge<o.length){let x=o[t.polygonEdge],E=o[(t.polygonEdge+1)%o.length];o=[x,E]}else return[e.s("shared-calculator-narration-item-unknown")];let a,s=[],l=(g=o[0])==null?void 0:g[0],c=(h=o[0])==null?void 0:h[1],d=(f=o[1])==null?void 0:f[0],p=(y=o[1])==null?void 0:y[1];return n===3?a=e.s("graphing-calculator-narration-geometry-unlabeled-triangle",{index:r.id}):n===4?a=e.s("graphing-calculator-narration-geometry-unlabeled-quadrilateral",{index:r.id}):a=e.s("graphing-calculator-narration-geometry-unlabeled-polygon",{index:r.id,sideCount:n}),t.polygonEdge!==void 0?t.includeDetails&&i<wc&&typeof l=="number"&&typeof c=="number"&&typeof d=="number"&&typeof p=="number"?s.push(e.s("graphing-calculator-narration-geometry-item-at-coordinates-to-coordinates",{itemDescription:a,x1:ps(e,l),y1:us(e,c),x2:ps(e,d),y2:us(e,p)})):s.push(a):t.includeDetails&&i<wc&&typeof l=="number"&&typeof c=="number"?s.push(e.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:a,x:ps(e,l),y:us(e,c)})):s.push(a),s}function FH(r,e,t){var h;let i=t.depth?t.depth:0,o="",n=[],a=(h=r.formula.geometry.call)==null?void 0:h.symbol,s=r.formula.geometry.listAccess,{valueType:l}=Pg(r,t),c=UC(r,e),d=r.label,p=c[0],g=c[1];return a==="parallel"?i<wc&&p!==void 0&&g!==void 0?n.push(e.s("graphing-calculator-narration-geometry-parallel-to-line-through-point",{index:r.id,line:nn(p,e,{includeDetails:!1,depth:i+1}),point:nn(g,e,{includeDetails:!1,depth:i+1})})):n.push(e.s("graphing-calculator-narration-geometry-unlabeled-parallel",{index:r.id})):a==="perpendicular"?i<wc&&p!==void 0&&g!==void 0?n.push(e.s("graphing-calculator-narration-geometry-perpendicular-to-line-through-point",{index:r.id,line:nn(p,e,{includeDetails:!1,depth:i+1}),point:nn(g,e,{includeDetails:!1,depth:i+1})})):n.push(e.s("graphing-calculator-narration-geometry-unlabeled-perpendicular",{index:r.id})):l===__dcg_shared_module_exports__['La']?o=e.s("graphing-calculator-narration-geometry-unlabeled-line",{index:r.id}):l===__dcg_shared_module_exports__['Na']?o=e.s("graphing-calculator-narration-geometry-unlabeled-ray",{index:r.id}):l===__dcg_shared_module_exports__['Fa']?d?o=e.s("graphing-calculator-narration-geometry-segment-with-assignment",{assignment:la(d)}):o=e.s("graphing-calculator-narration-geometry-unlabeled-segment",{index:r.id}):l===__dcg_shared_module_exports__['Va']&&(o=e.s("graphing-calculator-narration-geometry-unlabeled-vector",{index:r.id})),o!==""&&(i<wc&&p!==void 0&&g!==void 0?n.push(e.s("graphing-calculator-narration-geometry-straight-from-item-to-item",{straightType:o,start:nn(p,e,{includeDetails:!1,depth:i+1}),end:nn(g,e,{includeDetails:!1,depth:i+1})})):i<wc&&p!==void 0&&g===void 0&&s!==void 0?n.push(e.s("graphing-calculator-narration-geometry-straight-index-of-item",{straightType:o,index:s,item:nn(p,e,{includeDetails:!1,depth:i+1})})):n.push(o)),n}function NH(r,e,t){var h;let i=t.depth?t.depth:0,o="",n=[],{valueType:a}=Pg(r,t),s="",l=(h=e.getGrapher())==null?void 0:h.getGraphSketch(r.id);if(l&&"labels"in l){let f=l.labels;f.length>0&&"text"in f[0]&&(s=la(f[0].text))}a===__dcg_shared_module_exports__['Pa']?s!==""?o=e.s("graphing-calculator-narration-geometry-unlabeled-angle-with-measurement",{index:r.id,measurementText:s}):o=e.s("graphing-calculator-narration-geometry-unlabeled-angle",{index:r.id}):a===__dcg_shared_module_exports__['Ra']&&(s!==""?o=e.s("graphing-calculator-narration-geometry-unlabeled-directed-angle-with-measurement",{index:r.id,measurementText:s}):o=e.s("graphing-calculator-narration-geometry-unlabeled-directed-angle",{index:r.id}));let c=UC(r,e),d=c[0],p=c[1],g=c[2];return i<wc&&d!==void 0&&p!==void 0&&g!==void 0?n.push(e.s("graphing-calculator-narration-geometry-angle-through-points",{itemDescription:o,parent1:nn(d,e,{includeDetails:!1,depth:i+1}),parent2:nn(p,e,{includeDetails:!1,depth:i+1}),parent3:nn(g,e,{includeDetails:!1,depth:i+1})})):i<wc&&d!==void 0?n.push(e.s("graphing-calculator-narration-geometry-angle-of-polygon",{itemDescription:o,parent:nn(d,e,{includeDetails:!1,depth:i+1})})):n.push(o),n}function BH(r,e,t){let{value:i,valueType:o}=Pg(r,t),n=[],a=i.length;switch(__dcg_shared_module_exports__['eb'](o)){case __dcg_shared_module_exports__['va']:n.push(e.s("graphing-calculator-narration-geometry-list-of-points",{count:a}));break;case __dcg_shared_module_exports__['Ha']:n.push(e.s("graphing-calculator-narration-geometry-list-of-circles",{count:a}));break;case __dcg_shared_module_exports__['Ja']:n.push(e.s("graphing-calculator-narration-geometry-list-of-arcs",{count:a}));break;case __dcg_shared_module_exports__['Da']:n.push(e.s("graphing-calculator-narration-geometry-list-of-polygons",{count:a}));break;case __dcg_shared_module_exports__['La']:n.push(e.s("graphing-calculator-narration-geometry-list-of-lines",{count:a}));break;case __dcg_shared_module_exports__['Na']:n.push(e.s("graphing-calculator-narration-geometry-list-of-rays",{count:a}));break;case __dcg_shared_module_exports__['Fa']:n.push(e.s("graphing-calculator-narration-geometry-list-of-segments",{count:a}));break;case __dcg_shared_module_exports__['Pa']:n.push(e.s("graphing-calculator-narration-geometry-list-of-angles",{count:a}));break;case __dcg_shared_module_exports__['Ra']:n.push(e.s("graphing-calculator-narration-geometry-list-of-directed-angles",{count:a}));break;default:n.push(e.s("graphing-calculator-narration-geometry-list-of-any",{count:a}));break}return n[0]=`${n[0]}.`,n}var gi=__dcg_shared_module_exports__['e'](te());var eie=1,gh=class{constructor(e,t,i,o,n,a,s){this.x=e,this.y=t,this.type=i,this.sketch=o,this.branch=n,this.pointIdxOnBranch=a,this.bareLabel=s===void 0?!1:s,this.id=eie++}getLabel(){let e=this.sketch&&this.sketch.branches[this.branch];return e&&"labels"in e&&e.labels&&e.labels[this.pointIdxOnBranch]||""}getGraphMode(){return this.sketch.branches[this.branch].graphMode}getCompiledFunction(){let e=this.sketch.branches[this.branch];if(!(!("compiled"in e)||!e.compiled))return e.compiled.fn}isAttachedToPlottedPoint(){return this.type===1006||this.type===1008}isMovable(){return this.getGraphMode()===4}isPersistent(){return this.type===1008}getLabelSize(){let e=this.sketch&&this.sketch.branches[this.branch];return this.type===1008&&e&&"labelSize"in e?e.labelSize===void 0?1:e.labelSize:1}getLabelRotation(){let e=this.sketch&&this.sketch.branches[this.branch];return this.type===1008&&e&&"labelAngle"in e?e.labelAngle===void 0?0:e.labelAngle:0}getPointOpacity(){let e=this.sketch&&this.sketch.branches[this.branch];if(e&&"pointOpacity"in e){let t=e.pointOpacity;if(t!==void 0){let i;return Array.isArray(t)?i=t[this.pointIdxOnBranch]:i=t,isFinite(i)?Math.max(0,Math.min(1,i)):1}}return 1}getPointSize(){let e=this.sketch&&this.sketch.branches[this.branch];if(e&&"pointSize"in e){let t=e.pointSize;if(t!==void 0){let i;Array.isArray(t)?i=t[this.pointIdxOnBranch]:i=t;let o=isFinite(i)?Math.max(0,i):8;return this.isMovable()?__dcg_shared_module_exports__['_'](o):o}}return this.isMovable()?__dcg_shared_module_exports__['$'](8):8}getTextOutline(){if(this.hasEditableLabel())return!1;let e=this.sketch&&this.sketch.branches[this.branch];return this.type===1008&&e&&"suppressTextOutline"in e?!e.suppressTextOutline:!0}hasInteractiveLabel(){let e=this.sketch&&this.sketch.branches[this.branch];return e&&"interactiveLabel"in e?!!e.interactiveLabel:!1}hasEditableLabel(){let e=this.sketch&&this.sketch.branches[this.branch];return e&&"editableLabel"in e?!!e.editableLabel:!1}isBareLabel(){return this.bareLabel}getMovablePoint(){return this.sketch.getMovablePointByIndex(this.pointIdxOnBranch)}isSelected(){return this.sketch.showHighlight}};function ET(r,e,t){return Math.max(e,Math.min(t,r))}var vx=class{constructor(e){let t=e.data,i=e.width,o=e.height;this.imageData=e;for(let l=1;l<i;l++)t[l]+=t[l-1];for(let l=1;l<o;l++)t[l*i]+=t[l*i-i];let n=i*o-i-o+1,a=i-1;for(var s=0;s<n;s++){let l=1+s%a,d=(1+Math.floor(s/a))*i,p=l-1+d,g=l+d-i,h=l-1+d-i;t[d+l]+=t[p]+t[g]-t[h]}}getSumForValidRect(e){let t=e.left-1,i=e.right-1,o=e.top-1,n=e.bottom-1,a=this.imageData.width,s=this.imageData.data,l=s[t+o*a],c=s[i+o*a],d=s[t+n*a],p=s[i+n*a];return t>=0&&o>=0?p-c-d+l:t>=0?p-d:o>=0?p-c:p}getSum(e){let t={left:ET(Math.floor(e.left),0,this.imageData.width),right:ET(Math.ceil(e.right),0,this.imageData.width),top:ET(Math.floor(e.top),0,this.imageData.height),bottom:ET(Math.ceil(e.bottom),0,this.imageData.height)};return t.left>=t.right||t.top>=t.bottom?0:this.getSumForValidRect(t)}};var Og=1/2,_g=document.createElement("canvas"),_O=[];function tie(r,e){if(!(e.width*e.height>0))return new vx({width:0,height:0,data:[]});_g.width=0,_g.width=Math.round(e.width*Og),_g.height=Math.round(e.height*Og);let i=_g.getContext("2d");i.save(),i.scale(_g.width/r.canvas.width,_g.height/r.canvas.height),i.drawImage(r.canvas,0,0),i.restore();var o=i.getImageData(0,0,_g.width,_g.height),n=o.data;n.length/4,_O.length,_O=new Array(n.length/4);for(var a=_O,s=0;s<a.length;s++)a[s]=n[s*4+3];var l=new vx({width:o.width,height:o.height,data:a});return l}function UH(r){for(var e=0;e<r.length;e++){var t=rie(e,r);r[e]=[t]}return r.map(function(i){return i[0]})}function rie(r,e){var t=1/0,i=-1,o=e[r];if(o.length===1)return o[0];for(var n=0;n<o.length;n++){var a=e[r][n].staticScore,s=iie(r,n,e),l=a+s;(i===-1||l<t)&&(t=l,i=n)}return o[i]}function iie(r,e,t){for(var i=0,o=t[r][e],n=0;n<t.length;n++)if(n!==r){for(var a=0,s=t[n],l=s.length-1;l>=0;l--){var c=s[l],d=Math.max(0,Math.min(o.right,c.right)-Math.max(o.left,c.left)),p=Math.max(0,Math.min(o.bottom,c.bottom)-Math.max(o.top,c.top));a+=d*p}i+=a/s.length}return i}function oie(r,e){var t=e.getSum({left:r.left*Og,right:r.right*Og,top:r.top*Og,bottom:r.bottom*Og});return t/=200,t/=Og*Og,t}function nie(r,e){var t=0;return e.forEach(function(i){t+=zH(r,i)}),t}function aie(r,e){var t=zH(r,e);return 10*(r.width*r.height-t)}function zH(r,e){var t=Math.max(0,Math.min(r.right,e.right)-Math.max(r.left,e.left)),i=Math.max(0,Math.min(r.bottom,e.bottom)-Math.max(r.top,e.top));return t*i}function KH(r,e,t){let i;return()=>(i||(i={domObstructions:t,viewport:{left:0,right:e.width,top:0,bottom:e.height},integralImage:tie(r,e)}),i)}function ST(r,e){if(!(e.length<=1)){var t=r();for(var i of e)i.staticScore+=aie(i,t.viewport),i.staticScore+=nie(i,t.domObstructions),i.staticScore+=oie(i,t.integralImage)}}function qH(r,e){var t=e.nakedLabel?0:e.pt_radius,i=Math.round(t/Math.sqrt(2)),o=[],n=e.pt_x,a=e.pt_y,s=e.width,l=e.height,c=400;o.push({cx_s:0,cy_s:0,cx_a:0,cy_a:0,staticScore:c,orientation:"center",matches:{default:1,center:1,center_auto:1,auto_center:1}}),o.push({cx_s:.5,cx_a:t+3,cy_s:0,cy_a:0,staticScore:c,orientation:"right",matches:{default:1,right:1,center_auto:1,auto_right:1}}),o.push({cx_s:-.5,cx_a:-t-3,cy_s:0,cy_a:0,staticScore:c,orientation:"left",matches:{default:1,left:1,center_auto:1,auto_left:1}}),o.push({cx_s:0,cx_a:0,cy_s:-.5,cy_a:-t,staticScore:c,orientation:"above",matches:{default:1,above:1,auto_center:1,above_auto:1}}),o.push({cx_s:-.5,cx_a:-i,cy_s:-.5,cy_a:-i,staticScore:c,orientation:"tl",matches:{default:1,above_left:1,above_auto:1,auto_left:1}}),o.push({cx_s:.5,cx_a:i,cy_s:-.5,cy_a:-i,staticScore:c,orientation:"tr",matches:{default:1,above_right:1,above_auto:1,auto_right:1}}),o.push({cx_s:0,cx_a:0,cy_s:.5,cy_a:t,staticScore:c,orientation:"below",matches:{default:1,below:1,auto_center:1,below_auto:1}}),o.push({cx_s:-.5,cx_a:-i,cy_s:.5,cy_a:i,staticScore:c,orientation:"bl",matches:{default:1,below_left:1,below_auto:1,auto_left:1}}),o.push({cx_s:.5,cx_a:i,cy_s:.5,cy_a:i,staticScore:c,orientation:"br",matches:{default:1,below_right:1,below_auto:1,auto_right:1}});var d=Math.cos(e.rotation),p=Math.sin(e.rotation),g=o.map(function(h){var f=h.cx_s*s+h.cx_a,y=h.cy_s*l+h.cy_a;let x=f*d-y*p,E=y*d+f*p,C=`calc(${h.cx_s*100-50}% + ${h.cx_a}px)`,S=`calc(${h.cy_s*100-50}% + ${h.cy_a}px)`,v=-s/2,M=s/2,A=-l/2,I=l/2;if(e.rotation){let P=sie([{x:v*d-A*p,y:A*d+v*p},{x:v*d-I*p,y:I*d+v*p},{x:M*d-A*p,y:A*d+M*p},{x:M*d-I*p,y:I*d+M*p}]);v=P.left,M=P.right,A=P.top,I=P.bottom}return v=Math.round(n+x+v),M=Math.round(n+x+M),A=Math.round(a+E+A),I=Math.round(a+E+I),{pt_x:Math.round(n),pt_y:Math.round(a),left:v,right:M,top:A,bottom:I,width:M-v,height:I-A,transform:`translate(${C},${S})`,staticScore:e.priorOrientation===h.orientation?h.staticScore-20:h.staticScore,orientation:h.orientation,matches:h.matches}});return e.enforceOrientation&&e.enforceOrientation!=="default"?g=__dcg_shared_module_exports__['i'](g,function(h){return!!h.matches[e.enforceOrientation]}):e.nakedLabel?g=__dcg_shared_module_exports__['i'](g,function(h){return h.orientation==="center"}):e.keepOrientation&&e.priorOrientation?g=__dcg_shared_module_exports__['i'](g,function(h){return h.orientation===e.priorOrientation}):g=__dcg_shared_module_exports__['i'](g,function(h){return h.orientation!=="center"}),ST(r,g),g}function HH(r,e){var t=[],i=e.width,o=e.height,n=i/2,a=o/2,s=e.pt_x1,l=e.pt_y1,c=e.pt_x2,d=e.pt_y2,p=5,g=(d-l)/(c-s),h=Math.atan2(d-l,c-s)+Math.PI/2,f=p*Math.cos(h),y=p*Math.sin(h),x=Math.min(l,d)-Math.abs(y)-o,E=Math.max(l,d)+Math.abs(y),C=[.5,.4,.6,.2,.8],S=[0,20,20,40,40],v=[];for(let U of C)v.push({x:s*(1-U)+c*U,y:l*(1-U)+d*U});for(let U=0;U<v.length;U++){let Y=v[U];var M,A,I,P;if(g>=2||g<=-2){I=P=Y.y-a;let q=Math.abs((c-s)/(d-l)*a)+Math.abs(f);M=Y.x+q,A=Y.x-q-i}else if(g<=.05&&g>=-.05){M=A=Y.x-n;let q=Math.abs(g*n)+Math.abs(y);I=Y.y-q-o,P=Y.y+q}else f>0?(M=Y.x+f,A=Y.x-f-i):(M=Y.x+f-i,A=Y.x-f),y>0?(I=Y.y+y,P=Y.y-y-o):(I=Y.y+y-o,P=Y.y-y);I<x?I=x:I>E&&(I=E),P<x?P=x:P>E&&(P=E);let R=(c-s)*(I-l)-(d-l)*(M-s)>0,H=U.toString()+(R?"-a":"-b");t.push({pt_x:Y.x,pt_y:Y.y,left:M,top:I,staticScore:S[U],orientation:H,matches:{[H]:1}});let O=U.toString()+(R?"-b":"-a");t.push({pt_x:Y.x,pt_y:Y.y,left:A,top:P,staticScore:S[U],orientation:O,matches:{[O]:1}})}var _=t.map(function(U){let Y=Math.round(U.left),R=Math.round(U.left+i),H=Math.round(U.top),O=Math.round(U.top+o);return{pt_x:Math.round(U.pt_x),pt_y:Math.round(U.pt_y),transform:`translate(${U.left-U.pt_x}px,${U.top-U.pt_y}px)`,left:Y,right:R,top:H,bottom:O,width:R-Y,height:O-H,staticScore:e.priorOrientation===U.orientation?U.staticScore-20:U.staticScore,orientation:U.orientation,matches:U.matches}});return e.keepOrientation&&e.priorOrientation&&(_=__dcg_shared_module_exports__['i'](_,function(U){return U.orientation===e.priorOrientation})),ST(r,_),_}function WH(r,e){var t=[],i=e.pt_x,o=e.pt_y,n=e.width,a=e.height;let s=-(e.startAngle+e.deltaAngle/2),l=e.isRightAngle?e.radius*Math.sqrt(2)-1:e.radius+4,c=l+Math.sqrt(e.width*e.width/4+e.height*e.height/4),d=[],p=c*Math.sin(s);p>l+1/2*a&&(p=l+1/2*a),p<-l-1/2*a&&(p=-l-1/2*a),d.push({x:i+c*Math.cos(s)-n/2,y:o+p-a/2});for(let h=0;h<d.length;h++){let f=d[h],y=h.toString()+"-a";t.push({pt_x:f.x,pt_y:f.y,left:f.x,top:f.y,staticScore:0,orientation:y,matches:{[y]:1}})}var g=t.map(function(h){let f=Math.round(h.left),y=Math.round(h.left+n),x=Math.round(h.top),E=Math.round(h.top+a);return{pt_x:Math.round(h.pt_x),pt_y:Math.round(h.pt_y),transform:`translate(${h.left-h.pt_x}px,${h.top-h.pt_y}px)`,left:f,right:y,top:x,bottom:E,width:y-f,height:E-x,staticScore:e.priorOrientation===h.orientation?h.staticScore-20:h.staticScore,orientation:h.orientation,matches:h.matches}});return e.keepOrientation&&e.priorOrientation&&(g=__dcg_shared_module_exports__['i'](g,function(h){return h.orientation===e.priorOrientation})),ST(r,g),g}function $H(r,e){for(var t=[],i=e.width,o=e.height,n=10,a=Math.round(n/Math.sqrt(2)),s=0,l=50,c=0,d=0,p=0,g=0;g<e.path.length-2;g+=2)p+=1,c+=e.path[g],d+=e.path[g+1];var h=c/p,f=d/p;t.push({left:h-i/2,top:f-o/2,staticScore:s,orientation:"center",matches:{center:1}}),t.push({left:h+n+3,top:f-o/2,staticScore:l,orientation:"right",matches:{right:1}}),t.push({left:h-(n+i)-3,top:f-o/2,staticScore:l,orientation:"left",matches:{left:1}}),t.push({left:h-i/2,top:f-(o+n),staticScore:l,orientation:"top",matches:{top:1}}),t.push({left:h-(i+a),top:f-(o+a),staticScore:l,orientation:"tl",matches:{tl:1}}),t.push({left:h+a,top:f-(o+a),staticScore:l,orientation:"tr",matches:{tr:1}}),t.push({left:h-i/2,top:f+n,staticScore:l,orientation:"bottom",matches:{bottom:1}}),t.push({left:h-(i+a),top:f+a,staticScore:l,orientation:"bl",matches:{bl:1}}),t.push({left:h+a,top:f+a,staticScore:l,orientation:"br",matches:{br:1}});var y=t.map(function(x){let E=Math.round(x.left),C=Math.round(x.left+i),S=Math.round(x.top),v=Math.round(x.top+o);return{pt_x:Math.round(h),pt_y:Math.round(f),transform:`translate(${x.left-h}px,${x.top-f}px)`,left:E,right:C,top:S,bottom:v,width:C-E,height:v-S,staticScore:e.priorOrientation===x.orientation?x.staticScore-20:x.staticScore,orientation:x.orientation,matches:x.matches}});return e.keepOrientation&&e.priorOrientation&&(y=__dcg_shared_module_exports__['i'](y,function(x){return x.orientation===e.priorOrientation})),ST(r,y),y}function sie(r){let e=r[0].x,t=r[0].x,i=r[0].y,o=r[0].y;for(var n=r.length-1;n>=1;n--){let{x:a,y:s}=r[n];a<e&&(e=a),a>t&&(t=a),s<i&&(i=s),s>o&&(o=s)}return{left:e,right:t,top:i,bottom:o}}var kT=__dcg_shared_module_exports__['e'](te());var jH=__dcg_shared_module_exports__['e'](te());var za=__dcg_shared_module_exports__['e'](te());function ft(r){return{shouldBeFocused:()=>Tf(r),onFocusedChanged:e=>{OO(r,e)}}}function Tf(r){let e=r.predicate;if(e&&!e())return!1;let t=r.controller.getFocusLocation();return t&&__dcg_shared_module_exports__['E'](t,r.location)}function OO(r,e){let t=r.predicate;t&&!t()||(e?r.controller.dispatch({type:"set-focus-location",location:r.location}):r.controller.dispatch({type:"blur-focus-location",location:r.location}))}var{If:DT}=za.Components,$p=class extends za.Class{init(){this.controller=this.props.controller()}template(){return za.createElement("span",{class:()=>{var t,i;let e=this.parentOrChildHovered();return{"dcg-geo-token-view":!0,"dcg-static-token":(i=(t=this.props).isStatic)==null?void 0:i.call(t),"dcg-selected-token":this.isTokenSelected(),"dcg-hidden-token":this.isHidden(),"dcg-token-has-label":this.hasLabel(),"dcg-child-of-hovered-token":e==="child","dcg-parent-of-hovered-token":e==="parent","dcg-assignment-token":!!this.getAssignment(),"dcg-graph-interactions-disabled":this.isGraphInteractionDisabled()}},style:()=>({color:this.getColor()}),role:this.bindFn(this.getAriaRole),"dcg-token-type":()=>this.getTokenInfo().iconType,"aria-roledescription":()=>this.props.insideGroup()?void 0:this.controller.s("graphing-calculator-narration-geometry-construction-role-description"),"aria-label":this.bindFn(this.getAriaLabel),"aria-selected":this.bindFn(this.isTokenSelected),tabindex:()=>this.props.putInTabOrder()?0:-1,manageFocus:()=>this.props.focusLocation?ft({controller:this.controller,location:this.props.focusLocation()}):void 0,onTapStart:this.bindFn(this.onTapStart),onTap:this.bindFn(this.onTap),onPointerOver:this.bindFn(this.onPointerOver),onPointerOut:this.bindFn(this.onPointerOut)},za.createElement("span",{class:za.const("dcg-token-background")}),za.createElement("span",{class:()=>({"dcg-token-icon":!0,[this.getAdditionalTokenClass()]:this.getAdditionalTokenClass(),"dcg-token-is-list":this.getIsList()&&!this.getAssignment()}),style:()=>({"--dcg-icon-angle":this.getIconAngle()})},za.createElement(DT,{predicate:()=>!!this.getIcon()},()=>za.createElement("i",{class:this.bindFn(this.getIcon)}))),za.createElement(DT,{predicate:()=>!!this.getAssignment()},()=>za.createElement(lt,{latex:this.bindFn(this.getAssignment),config:this.const({})})),za.createElement(DT,{predicate:()=>this.hasLabel()},()=>za.createElement("span",{class:()=>({"dcg-token-label":!0})},()=>this.getLabel())),za.createElement(DT,{predicate:this.bindFn(this.isGraphInteractionDisabled)},()=>za.createElement("i",{class:za.const("dcg-icon-lock")})))}getIconAngle(){let e=this.controller.getItemsByIdentifier(this.props.identifier());if(!e||e.length!==1)return;let t=e[0];if(!t||!t.formula||!t.formula.typed_constant_value)return;let i;switch(this.getIconType()){case"vector":case"translate":if(t.formula.typed_constant_value.valueType!==__dcg_shared_module_exports__['Va'])return;let[o,n]=t.formula.typed_constant_value.value[0];i=__dcg_shared_module_exports__['ca'](o,n);break;case"segment":{if(t.formula.typed_constant_value.valueType!==__dcg_shared_module_exports__['Fa'])return;let[[a,s],[l,c]]=t.formula.typed_constant_value.value;i=__dcg_shared_module_exports__['ca'](l-a,c-s);break}case"line":{if(t.formula.typed_constant_value.valueType!==__dcg_shared_module_exports__['La'])return;let[[a,s],[l,c]]=t.formula.typed_constant_value.value;i=__dcg_shared_module_exports__['ca'](l-a,c-s);break}case"ray":{if(t.formula.typed_constant_value.valueType!==__dcg_shared_module_exports__['Na'])return;let[[a,s],[l,c]]=t.formula.typed_constant_value.value;i=__dcg_shared_module_exports__['ca'](l-a,c-s);break}}return i!==void 0?`${-Number(i).toFixed(2)}rad`:void 0}getAdditionalTokenClass(){if(this.getAssignment()||this.hasError())return"";switch(this.getIconType()){case"glider":return"dcg-token-glider";case"line":return"dcg-token-line";case"segment":return"dcg-token-segment";case"ray":return"dcg-token-ray";case"intersection":return"dcg-token-intersection";case"midpoint":return"dcg-token-midpoint";case"parallel":return"dcg-token-parallel";case"perpendicular":return"dcg-token-perpendicular";case"rotate":return"dcg-token-rotate";case"circle":return"dcg-token-circle";case"arc":return"dcg-token-arc";case"vector":return"dcg-token-vector";case"dilate":return"dcg-token-dilate";case"reflect":return"dcg-token-reflect";case"translate":return"dcg-token-translate";case"transformation":return"dcg-token-transformation";case"point":case"start":case"end":return"dcg-token-point";case"polygon":return"dcg-token-polygon";case"angle":return"dcg-token-angle";case"angles":return"dcg-token-angles";case"directedangle":case"directedangles":return"dcg-token-directedangle"}return""}getIdFromParentRef(e){if(e)return this.controller.getExpressionIdForIdentifier(e[0])}isGraphInteractionDisabled(){let e=this.props.controller().getExpressionIdForIdentifier(this.props.identifier())||"",t=this.controller.getItemModel(e);return!!t&&(t.type==="expression"||t.type==="image")&&!!t.disableGraphInteractions}parentOrChildHovered(){var c,d,p,g,h,f;if(!this.props.showParentChildrenHover||!this.props.showParentChildrenHover())return!1;let e=this.controller.getHoveredOrFocusedTokenIdentifier(),t=this.controller.getExpressionIdForIdentifier(e),i=this.props.identifier(),o=this.props.controller().getExpressionIdForIdentifier(i)||"";if(!t)return!1;let n=this.controller.getItemModel(t),a=this.controller.getItemModel(o);if(!n||n.type!=="expression"||!a||a.type!=="expression")return!1;let s=((p=(d=(c=n.formula)==null?void 0:c.geometry)==null?void 0:d.call)==null?void 0:p.parents)||[],l=((f=(h=(g=a.formula)==null?void 0:g.geometry)==null?void 0:h.call)==null?void 0:f.parents)||[];for(let y=0;y<s.length;y++)if(this.getIdFromParentRef(s[y])===o)return"parent";for(let y=0;y<l.length;y++)if(this.getIdFromParentRef(l[y])===t)return"child";return!1}willUnmount(){this.implicitMouseOut()}didUpdate(){let e=this.props.identifier();this.currentlyActiveIdentifier&&e!==this.currentlyActiveIdentifier&&this.implicitMouseOut()}implicitMouseOut(){this.currentlyActiveIdentifier&&this.controller.runAfterDispatch(()=>{let e=this.currentlyActiveIdentifier;e&&(this.currentlyActiveIdentifier=void 0,this.controller.dispatch({type:"unset-active-token",identifier:e,style:"hovered"}))})}isHidden(){return this.getTokenInfo().isHidden}hasError(){let e=this.getTokenInfo();return!e||e.hasError}getIcon(){if(this.getAssignment())return;let e=this.getTokenInfo();if(this.hasError())return"dcg-icon-error";switch(e.iconType){case"point":case"glider":case"intersection":case"strictintersection":case"midpoint":case"start":case"end":return"dcg-icon-point";case"translate":case"vector":return"dcg-icon-vector";case"dilate":return"dcg-icon-dilation";case"rotate":return"dcg-icon-rotation";case"reflect":return"dcg-icon-reflection";case"transformation":return"dcg-icon-title";case"angle":case"angles":case"directedangle":case"directedangles":return"dcg-icon-angle";case"polygon":return"dcg-icon-polygon-solid";case"apply":case"arc":case"circle":case"clockwise":case"counterclockwise":case"error":case"line":case"parallel":case"perpendicular":case"ray":case"reflex":case"segment":case"segments":case"unknown":case"vertices":return;default:return e.iconType}}hasLabel(){return!!this.getLabel()}getLabel(){if(this.getAssignment())return"";let e=this.getTokenInfo().label.trim();return e.length<=2?e:""}getAssignment(){let e=this.props.identifier();return e[0]!=="$"?__dcg_shared_module_exports__['ub'](e):""}getAriaLabel(){let e=this.getTokenInfo(),t=nn(this.controller.getItemModel(e==null?void 0:e.calcId),this.controller,{includeDetails:!1,depth:1});return this.isHidden()?this.controller.s("graphing-calculator-narration-geometry-hidden-construction-description",{description:t}):t}isTransformation(){var e;return((e=this.getTokenInfo())==null?void 0:e.groupType)==="transformation"}getColor(){if(this.getAssignment())return;let e=this.getTokenInfo();return this.hasError()?"#fa824c":this.isTransformation()||this.isHidden()?"#aaa":e.color}getIconType(){return this.getTokenInfo().iconType}getIsList(){return this.getTokenInfo().isList}getTokenInfo(){let e=this.props.identifier();return this.controller.getTokenRenderInfoByIdentifier(e)}onPointerOver(e){var t,i;(i=(t=this.props).isStatic)!=null&&i.call(t)||e.pointerType==="mouse"&&(this.currentlyActiveIdentifier=this.props.identifier(),this.controller.dispatch({type:"set-active-token",identifier:this.currentlyActiveIdentifier,style:"hovered"}))}onPointerOut(e){var t,i;(i=(t=this.props).isStatic)!=null&&i.call(t)||e.pointerType==="mouse"&&this.currentlyActiveIdentifier&&(this.controller.dispatch({type:"unset-active-token",identifier:this.currentlyActiveIdentifier,style:"hovered"}),this.currentlyActiveIdentifier=void 0)}onTapStart(e){var t,i;(i=(t=this.props).isStatic)!=null&&i.call(t)||e.handle()}onTap(e){var t,i;(i=(t=this.props).isStatic)!=null&&i.call(t)||(e.handle(),this.props.focusLocation&&this.controller.dispatch({type:"set-focus-location",location:this.props.focusLocation()}),this.controller.dispatch({type:"select-expression-that-defines-token",identifier:this.props.identifier(),toggle:this.isTokenSelected(),multiSelectMode:this.controller.isMultiSelectEnabled()&&!!e.shiftKey}))}isTokenSelected(){let e=this.getTokenInfo();return!!(e&&e.isSelected)}getAriaRole(){var e,t;if(!((t=(e=this.props).isStatic)!=null&&t.call(e)))return this.props.insideGroup()?"option":"button"}};var Cx=r=>{let e=function(){return r};return e.isDcgViewConst=!0,e},Ex=class{constructor(e,t,i){this.tokenController=e,this.mathNode=t,this.isStatic=i}updateTokens(e){if(!this.mathNode)return;if(!this.lastTokenInfo||this.lastTokenInfo.latex!==e)if(!this.tokenController.doesLatexContainToken(e))this.lastTokenInfo={latex:e,tokens:[]};else{let i=[];this.mathNode.querySelectorAll(".dcg-mq-token").forEach(o=>{i.push(o)}),this.lastTokenInfo={latex:e,tokens:i}}let t=this.lastTokenInfo.tokens;for(let i of t){let o=i.dcgTokenView;if(o)o.update();else{let n=i.getAttribute("data-dcg-mq-token")||"",a=jH.mountToNode($p,i,{controller:Cx(this.tokenController),identifier:Cx("$"+n),insideMQ:Cx(!0),insideGroup:Cx(!1),putInTabOrder:Cx(!1),isStatic:Cx(this.isStatic)});i.dcgTokenView=a}}}};var lt=class extends kT.Class{template(){return this.children.length===1?this.children[0]:kT.createElement("div",{onMount:e=>this.onMountMathquill(e)})}onMount(){this.children.length===1&&this.onMountMathquill(this.findRootNode())}onMountMathquill(e){this.props.tokenController&&(this.mathquillTokenHelper=new Ex(this.props.tokenController(),e,!0)),this.staticMath=Zc.StaticMath(e,{...this.props.config()}),e.classList.add("dcg-static-mathquill-view"),this.updateMathquill()}didUpdate(){this.updateMathquill()}updateMathquill(){var e;this.updateMathquillAria(),this.updateMathquillLatex(),(e=this.mathquillTokenHelper)==null||e.updateTokens(this.props.latex())}updateMathquillLatex(){if(!this.staticMath)return;let e=this.props.latex();this.lastLatex!==e&&(this.staticMath.latex(e),this.lastLatex=e,this.props.onReflow&&this.props.onReflow())}updateMathquillAria(){if(!this.staticMath||!this.props.getAriaLabel)return;let e=this.props.getAriaLabel();e!==this.staticMath.getAriaLabel()&&this.staticMath.setAriaLabel(e)}};qt();var r0e=function(){{var r="_*_";ie.Event.prototype.wasHandled=function(e){e=e||r;var t=this.originalEvent,i=t&&t.handledBy;if(i&&i[e])return!0;if(e!==r)return!1;var o=this.target.closest("[handleEvent]");return o&&o!==this.currentTarget?o.getAttribute("handleEvent")!=="false":!1},ie.Event.prototype.handle=function(e){e=e||r;var t=this.originalEvent;if(t){var i=t.handledBy;i||(i=t.handledBy={}),i[e]=!0}}}}();var vc=__dcg_shared_module_exports__['e'](te());qt();function Sx(r){let e=__dcg_shared_module_exports__['tc'](r),t=0;for(;!__dcg_shared_module_exports__['vc'](e);)t+=1,e=__dcg_shared_module_exports__['uc'](e);return t}var{If:cie}=vc.Components,Dx=500,die=30,Ze=class r extends vc.Class{constructor(){super(...arguments),this.lastLatexProp="",this.wasFocusedLastUpdate=!1}template(){return vc.createElement("div",{class:vc.const("dcg-mq-container")},vc.createElement(cie,{predicate:()=>this.getPlaceholder().trim().length>0},()=>vc.createElement("span",{class:vc.const("dcg-mq-placeholder")},vc.createElement(lt,{config:()=>this.props.config(),latex:()=>this.getPlaceholder()}))),vc.createElement("div",{class:()=>({"dcg-math-field":!0,"dcg-no-fadeout":this.props.noFadeout&&this.props.noFadeout(),"dcg-invalid":this.props.hasError(),"dcg-focus":this.props.isFocused()}),didMount:e=>this.didMountMathquill(e),"data-dcg-label":()=>this.props.dataLabelAttributeValue?this.props.dataLabelAttributeValue():void 0}))}didMount(){this.children.length===1&&this.didMountMathquill(this.findRootNode())}willUnmount(){this.$mathField.off(".view"),this.mathField=void 0}getPlaceholder(){return!this.props.placeholder||this.props.isFocused()||this.props.latex()?"":this.props.placeholder()}didMountMathquill(e){this.cachedConfig=this.getCacheableMQConfig();let t={...this.cachedConfig,handlers:{reflow:o=>{this.props.onReflow&&this.mathField&&this.props.onReflow(o)}},onCut:()=>{this.mathField&&this.props.onUserChangedLatex(this.mathField.latex())},onPaste:()=>{this.mathField&&this.props.onUserChangedLatex(this.mathField.latex())},overrideTypedText:o=>{this.mathField&&this.viewCanAcceptText(o)&&(this.props.onUserTypedText?this.props.onUserTypedText(o):(this.mathField.typedText(o),this.props.onUserChangedLatex(this.mathField.latex())))},overrideKeystroke:(o,n)=>{if(o==="Backspace"&&n.preventDefault(),!this.mathField)return;if(o==="Spacebar"&&this.props.disableSpace&&this.props.disableSpace())return n.preventDefault();let a=Be(n);if(a==="Up"||a==="Down"||a==="Left"||a==="Right"||a==="Esc"){let s=[];n.ctrlKey&&s.push("Ctrl"),n.metaKey&&s.push("Meta"),n.altKey&&s.push("Alt"),n.shiftKey&&s.push("Shift"),s.length?(s.push(a),o=s.join("-")):o=a}this.props.onUserPressedKey?this.props.onUserPressedKey(o,n):(this.mathField.keystroke(o,n),this.props.onUserChangedLatex(this.mathField.latex())),this.maybeTriggerOnSelectionChange()}};this.props.needsSystemKeypad&&this.props.needsSystemKeypad()&&(t.substituteTextarea=()=>{let o=document.createElement("textarea");return o.setAttribute("autocorrect","off"),o.setAttribute("autocapitalize","none"),o.setAttribute("spellcheck","false"),o.setAttribute("autocomplete","off"),o}),this.props.tokenController&&(this.mathquillTokenHelper=new Ex(this.props.tokenController(),e,!1)),this.$mathField=ie(e);let i=Zc.MathField(e,t);this.mathField=i,e._mqMathFieldInstance=this.mathField,e._mqViewInstance=this,this.$mathField.on("focusin.view focusout.view",o=>this.onFocusEvent(o)).on("paste.view",o=>this.onPasteEvent(o)),!jD&&(Fc||Ju)&&this.$mathField.on("keypress.view",o=>this.onKeypressEvent(o)),this.hookupMQTapTouch(i),this.updateMathquill()}getCacheableMQConfig(){let e={...this.props.config()};return this.props.capExpressionSize()&&(e.maxDepth=die),e}didUpdate(){this.updateMathquill()}updateMathquill(){var e;this.updateMathquillConfig(),this.updateMathquillAria(),this.updateMathquillLatex(),this.updateMathquillFocused(),this.updateMathquillPostLabel(),(e=this.mathquillTokenHelper)==null||e.updateTokens(this.props.latex())}onFocusEvent(e){let t=this.isFocused();t!==this.shouldBeFocused()&&this.props.onFocusedChanged(t,e)}onPasteEvent(e){let t="",i=window.clipboardData,o=e.originalEvent;i&&i.getData?t=i.getData("Text"):o&&o.clipboardData&&o.clipboardData.getData&&(t=o.clipboardData.getData("text/plain"));var n=this.viewCanAcceptText(t);return!n&&this.props.onExpressionSizeExceeded&&this.props.onExpressionSizeExceeded(),n}viewCanAcceptText(e){return r.canAcceptText(this.mathField,this.props.capExpressionSize(),e)}static canAcceptText(e,t,i){if(!e)return!1;if(!t)return!0;let o=e.latex();return Sx(o)+Sx(i)<=Dx}onKeypressEvent(e){if(e.stopPropagation(),e.preventDefault(),!!this.mathField){var t=e.key&&e.key.length===1?e.key:void 0;t&&this.viewCanAcceptText(t)&&(this.props.onUserTypedText?this.props.onUserTypedText(t):(this.mathField.typedText(t),this.props.onUserChangedLatex(this.mathField.latex())))}}hookupMQTapTouch(e){this.$mathField.on("dcg-tapstart.view",()=>{let t="dcg-tapend.mathquill-selection-change";ie(document).on(t,()=>{this.maybeTriggerOnSelectionChange(),ie(document).off(t)})}),e.ignoreNextMousedown(function(){return xU.shouldIgnoreMouseDown()}),this.$mathField.on("dcg-tap.view",t=>{let i=t;if(i.device!=="touch"||i.target.closest(".dcg-mq-ignore-mousedown"))return;let o=i.changedTouches[0];e.clickAt(o.clientX,o.clientY,o.target),this.isFocused()||e.focus()})}updateMathquillConfig(){if(!this.mathField)return;let e=this.getCacheableMQConfig();__dcg_shared_module_exports__['E'](e,this.cachedConfig)||(this.cachedConfig=e,this.mathField.config(e))}updateMathquillAria(){if(!this.mathField)return;let e=this.props.getAriaLabel();e!==this.mathField.getAriaLabel()&&this.mathField.setAriaLabel(e)}updateMathquillPostLabel(){this.mathField&&this.mathField.setAriaPostLabel(this.props.getAriaPostLabel(),this.props.hasError()?5e3:1e3)}updateMathquillLatex(){let e=this.props.latex();this.mathField&&this.lastLatexProp!==e&&(this.props.capExpressionSize()&&Sx(e)>Dx||(this.lastLatexProp=e,this.mathField.latex()!==e&&this.mathField.latex(e)))}updateMathquillFocused(){if(!this.mathField)return;let e=this.isFocused(),t=this.shouldBeFocused();t&&t!==this.wasFocusedLastUpdate&&this.props.selectOnFocus&&this.props.selectOnFocus()&&this.mathField.select(),this.wasFocusedLastUpdate=t,e!==t&&(t?this.mathField.focus():this.mathField.blur())}isFocused(){return!!(document.activeElement&&this.$mathField[0].contains(document.activeElement))}shouldBeFocused(){return this.props.isFocused()}maybeTriggerOnSelectionChange(){let e=this.props.onSelectionChanged;if(!e||!this.mathField)return;let t=this.mathField.selection();__dcg_shared_module_exports__['E'](t,this.lastSelection)||(this.lastSelection=t,e(t))}static getFocusedMathquill(){if(!document.activeElement)return;let e=document.activeElement.closest(".dcg-mq-editable-field");if(e)return e._mqMathFieldInstance}static getMQViewInstance(e){let t=e.el();if(t)return t._mqViewInstance}static applyArrowKeyAndReturnIfWasAtBounds(e,t,i){var o=e.selection();let n=o.startIndex===0&&o.endIndex===o.latex.length;if((t==="Up"||t==="Down")&&n)return e.keystroke(t,i),!0;e.keystroke(t,i);var a=e.selection(),s=a.latex!==o.latex||a.startIndex!==o.startIndex||a.endIndex!==o.endIndex;return!s}static simulateKeypress(e,t){var i=r.getMQViewInstance(e);if(i){if(i.props.onUserPressedKey)i.props.onUserPressedKey(t);else{e.keystroke(t);let o=e.latex();i.props.onUserChangedLatex(o)}i.maybeTriggerOnSelectionChange()}}static simulateUserChangedLatex(e){var t=r.getMQViewInstance(e);if(t&&t.mathField){let i=t.mathField.latex();t.props.onUserChangedLatex(i)}}static handleKeystrokeAndDecideIfSpecialEvent(e,t,i){return t==="Enter"||t==="Delete"&&e.latex()===""||t==="Backspace"&&e.latex()===""?!0:t==="Up"||t==="Down"||t==="Left"||t==="Right"?r.applyArrowKeyAndReturnIfWasAtBounds(e,t,i):(e.keystroke(t,i),!1)}};function YH(r,e){r.translate(e.left,e.top)}function pie(r,e){var t=document.createRange();t.selectNode(r);var i=t.getBoundingClientRect(),o=i.width>0&&i.height>0;if(!o)return;var n=window.getComputedStyle(r.parentElement),a=r.nodeValue||"";if(!a)return;var s=parseFloat(n.fontSize);let l=-.228*s,c=n.fontStyle+" "+n.fontWeight+" "+n.fontSize+" "+n.fontFamily;return{type:"text",rect:{left:i.left-e.pointCenterX,right:i.right-e.pointCenterY,top:i.top-e.pointCenterY,bottom:i.bottom-e.pointCenterY},text:a,color:n.color||"#000",font:c,y:i.height+l,hasOutline:e.hasOutline}}function XH(r,e,t){r.save(),r.font=e.font,t?(r.strokeStyle="#FFF",r.lineWidth=3,r.miterLimit=2,r.strokeText(e.text,0,e.y)):(r.fillStyle=e.color,r.fillText(e.text,0,e.y)),r.restore()}function JH(r,e,t){r.save(),t?(r.strokeStyle="#FFF",r.lineWidth=3):(e.fillColor&&(r.fillStyle=e.fillColor),e.strokeColor&&(r.strokeStyle=e.strokeColor)),r.beginPath();for(let i of e.instructions)switch(i.type){case"moveTo":r.moveTo(i.x,i.y);break;case"lineTo":r.lineTo(i.x,i.y);break;case"arcTo":r.arcTo(i.cx,i.cy,i.x,i.y,i.radius);break;case"ellipse":r.ellipse(i.centerX,i.centerY,i.radiusX,i.radiusY,i.rotation,i.startAngle,i.endAngle,i.anticlockwise);break}r.closePath(),t?r.stroke():(e.strokeColor&&r.stroke(),e.fillColor&&r.fill()),r.restore()}function uie(r,e){var t=r.getBoundingClientRect(),i=t.width>0&&t.height>0;if(i){var o=5,n=3,a=-o,s=t.width+o,l=-o,c=t.height+o,d=[{type:"moveTo",x:a+n,y:l},{type:"lineTo",x:s-n,y:l},{type:"arcTo",cx:s,cy:l,x:s,y:l+n,radius:n},{type:"lineTo",x:s,y:c-n},{type:"arcTo",cx:s,cy:c,x:s-n,y:c,radius:n},{type:"lineTo",x:a+n,y:c},{type:"arcTo",cx:a,cy:c,x:a,y:c-n,radius:n},{type:"lineTo",x:a,y:l+n},{type:"arcTo",cx:a,cy:l,x:a+n,y:l,radius:n}];return{type:"path",disableGlow:!0,rect:{left:t.left-e.pointCenterX,right:t.right-e.pointCenterX,top:t.top-e.pointCenterY,bottom:t.bottom-e.pointCenterY},instructions:d,strokeColor:"#C2C2C2",fillColor:"rgba(255,255,255,.75)"}}}function hie(r,e,t){var i=r.getBoundingClientRect(),o=i.width>0&&i.height>0;if(o){var n=i.width,a=parseFloat(e.borderTopWidth||"1px"),s=e.borderTopColor||"#000",l=[{type:"moveTo",x:0,y:0},{type:"lineTo",x:n,y:0},{type:"lineTo",x:n,y:a},{type:"lineTo",x:0,y:a}];return{type:"path",rect:{left:i.left-t.pointCenterX,right:i.right-t.pointCenterX,top:i.top-t.pointCenterY,bottom:i.bottom-t.pointCenterY},instructions:l,fillColor:s}}}function QH(r,e){var t=Math.sqrt(r[0]*r[0]+r[1]*r[1]),i=Math.sqrt(e[0]*e[0]+e[1]*e[1]),o=r[0]*e[0]+r[1]*e[1],n=Math.acos(o/(t*i));return r[0]*e[1]-r[1]*e[0]<0&&(n*=-1),n}function gie(r,e,t,i,o,n,a,s,l){var c=Math.cos(o),d=Math.sin(o),p=(r-s)/2,g=(e-l)/2,h=c*p+d*g,f=-d*p+c*g,y=t*t,x=i*i,E=h*h,C=f*f,S=Math.sqrt((y*x-y*C-x*E)/(y*C+x*E));n===a&&(S*=-1);var v=S*t*f/i,M=-S*i*h/t,A=(r+s)/2,I=(e+l)/2,P=c*v-d*M+A,_=d*v+c*M+I,U=[1,0],Y=[(h-v)/t,(f-M)/i],R=[(-h-v)/t,(-f-M)/i],H=QH(U,Y),O=QH(U,R);return{centerX:P,centerY:_,radiusX:t,radiusY:i,startAngle:H,endAngle:O,rotation:o,anticlockwise:a===0}}var ZH={};function mie(r,e){var t=r+"-"+e,i=ZH[t];if(i)return i;i=[],ZH[t]=i;var o=e.split(" ");if(o.length!==4)return i;var n=parseFloat(o[0]),a=parseFloat(o[2]),s=parseFloat(o[1]),l=parseFloat(o[3]),c=a-n,d=l-s;function p(A){return(A-n)/c}function g(A){return(A-s)/d}var h="[0-9-.]+",f="(M"+h+" "+h+")",y="(L"+h+" "+h+")",x="(A"+h+" "+h+" "+h+" "+h+" "+h+" "+h+" "+h+")",E=new RegExp(f+"|"+y+"|"+x,"g"),C=r.match(E);if(!C||!C.length)return i;var S=NaN,v=NaN;for(let A of C){var M=A.substr(1).split(" ").map(parseFloat);switch(A[0]){case"M":S=p(M[0]),v=g(M[1]),i.push({type:"moveTo",x:S,y:v});break;case"L":S=p(M[0]),v=g(M[1]),i.push({type:"lineTo",x:S,y:v});break;case"A":let I=M[0]/c,P=M[1]/d,_=M[2],U=M[3],Y=M[4],R=p(M[5]),H=g(M[6]),O=gie(S,v,I,P,_,U,Y,R,H);S=R,v=H,i.push({type:"ellipse",...O});break}}return i}function fie(r,e){var t=r.childNodes[0];if(!(!t||t.nodeName!=="path")){var i=r.getBoundingClientRect(),o=i.width>0&&i.height>0;if(o){var n=t.getAttribute("d")||"",a=r.getAttribute("viewBox")||"",s=mie(n,a),l=window.getComputedStyle(r),c=i.width,d=i.height;s=__dcg_shared_module_exports__['Z'](s);for(let p of s)switch(p.type){case"moveTo":case"lineTo":p.x*=c,p.y*=d;break;case"arcTo":p.x*=c,p.y*=d,p.cx*=c,p.cy*=d,p.radius*=c;break;case"ellipse":p.centerX*=c,p.centerY*=d,p.radiusX*=c,p.radiusY*=d;break;default:return p}return{type:"path",rect:{left:i.left-e.pointCenterX,right:i.right-e.pointCenterX,top:i.top-e.pointCenterY,bottom:i.bottom-e.pointCenterY},fillColor:l.color||"#000",instructions:s}}}}function e6(r,e,t){var i=window.getComputedStyle(r);if(i.borderTopWidth!=="0px"){let s=hie(r,i,e);s&&t.push(s)}for(var o=r.childNodes,n=0;n<o.length;n++){var a=o[n];if(a.nodeType===3){let s=pie(a,e);s&&t.push(s)}else if(a.nodeName==="svg"){let s=fie(a,e);s&&t.push(s)}else a.nodeType===1&&e6(a,e,t)}}function GT(r,e){let t=[];if(e.hasBorder){let i=uie(r,e);i&&t.push(i)}return e6(r,e,t),t}function TT(r,e){Po(e,"dcg-svg-label"),e.save(),fo(e);for(let t of r){switch(e.save(),YH(e,t.rect),t.type){case"path":t.disableGlow||JH(e,t,!0);break;case"text":t.hasOutline&&XH(e,t,!0);break;default:return t}e.restore()}for(let t of r){switch(e.save(),YH(e,t.rect),t.type){case"path":JH(e,t,!1);break;case"text":XH(e,t,!1);break;default:return t}e.restore()}e.restore()}var{If:bie,Input:yie,For:t6,Switch:xie,IfElse:wie}=gi.Components;function vie(r,e){return e?e.getPOIById(r):null}function Mf(r,e){return 1e3*(r.pixelsToMath.mapX(r.mathToPixels.mapX(e)+.5)-r.pixelsToMath.mapX(r.mathToPixels.mapX(e)-.5))}function IT(r,e){return 1e3*(r.pixelsToMath.mapY(r.mathToPixels.mapY(e)+.5)-r.pixelsToMath.mapY(r.mathToPixels.mapY(e)-.5))}function Cie(r,{x:e,y:t}){let i=Mf(r,e),o=IT(r,t);return{xscale:i,yscale:o}}function Eie(r,e){var t,i=!1;let o="",n="";if(r.type==="poi"){let p=r.poi,{xscale:g,yscale:h}=Cie(e,p);t=p.getLabel();let f=p.getGraphMode(),y;var a=p.type===1007&&p.getCompiledFunction();if(a){var s=f===1,l=s?p.y:p.x;if(y=__dcg_shared_module_exports__['pb'](l,g,h,a),s){var c=y[0];y[0]=y[1],y[1]=c}}else y=[__dcg_shared_module_exports__['ob'](p.x,g),__dcg_shared_module_exports__['ob'](p.y,h)];i=!isFinite(y[1].value),o=y[0].superscript?y[0].mantissa+"^{"+y[0].superscript+"}":y[0].string,n=y[1].superscript?y[1].mantissa+"^{"+y[1].superscript+"}":y[1].string,o==="undefined"&&(o="\\mathrm{undefined}"),n==="undefined"&&(n="\\mathrm{undefined}")}else t=r.text;var d=t&&__dcg_shared_module_exports__['Ed'](t);return t?d==="latex"?{is_hole:i,type:"latex",text:t.substr(1,t.length-2)}:d==="text"?{is_hole:i,type:"text",text:t}:{is_hole:i,type:"mixed",text:t}:r.type==="poi"?r.poi.hasEditableLabel()?{is_hole:i,type:"text",text:""}:{is_hole:i,type:"latex",text:"\\left("+o+",\\space "+n+"\\right)"}:{is_hole:i,type:"text",text:"?"}}function r6(r,e,t){let i=r.s("graphing-calculator-label-poi-unknown"),o=e.getProjection();return!o||!o.viewport||t&&(i=AT(r,t.x,t.y)),i}var i6=4,RO=class extends gi.Class{getClassName(){var e;return((e=this.props.point())==null?void 0:e.y)!==void 0?"dcg-audio-trace-line dcg-audio-trace-line--horizontal":"dcg-audio-trace-line"}getTraceCoord(){var o,n;let e=(o=this.props.point())==null?void 0:o.x,t=(n=this.props.point())==null?void 0:n.y,i=this.props.projection();if(e!==void 0)return`${Math.round(10*i.mapx(e))/10-i6/2}px`;if(t!==void 0)return`${Math.round(10*i.mapy(t))/10-i6/2}px`}getStyle(){var i;let e=this.getTraceCoord(),t=(i=this.props.point())==null?void 0:i.color;return{"--dcg-trace-coord":e,"--dcg-trace-color":t}}template(){return gi.createElement("div",{class:this.bindFn(this.getClassName),style:this.bindFn(this.getStyle)})}},kx=class extends gi.Class{constructor(){super(...arguments),this.labelsDirty=!1,this.traceLinePt=void 0}init(){this.grapher=this.props.grapher(),this.controller=this.grapher.controller,this.cachedLabelDict={},this.cachedLabelOrder=[],this.hoveredPOI=void 0,this.openedPOI2Sketch={},this.takingScreenshot=!1}template(){return gi.createElement("div",{class:gi.const("dcg-graph-outer"),style:this.const({"z-index":0}),didMount:this.bindFn(this.didMountRoot)},gi.createElement(t6,{each:()=>this.cachedLabelOrder},gi.createElement("div",null,e=>gi.createElement("div",{class:()=>this.getLabelClasses(e),style:()=>this.getLabelStyles(e),didMount:t=>this.linkLabelContainerNode(e,t)},gi.createElement("div",{class:gi.const("dcg-pt"),style:()=>this.getDotStyles(e)}),gi.createElement("div",{class:gi.const("dcg-label"),didMount:t=>this.linkLabelDOMNode(e,t)},this.renderLabelContent(e))))),gi.createElement(bie,{predicate:()=>!0},()=>gi.createElement(RO,{point:()=>this.traceLinePt,projection:()=>this.grapher.getProjection()})))}setTraceLine(e){__dcg_shared_module_exports__['E'](e,this.traceLinePt)||(this.traceLinePt=e,this.update())}renderLabelContent(e){return gi.createElement(xie,{key:()=>this.getLabelContent(e).type},t=>t==="text"?gi.createElement("span",{class:gi.const("dcg-label-raw-text")},()=>this.getLabelContent(e).text):t==="latex"?gi.createElement(lt,{latex:()=>this.getLabelContent(e).text,config:this.bindFn(this.getMQConfig)}):t==="mixed"?gi.createElement(t6,{each:()=>__dcg_shared_module_exports__['Fd'](this.getLabelContent(e).text),key:(i,o)=>`${i}${o}`},gi.createElement("span",null,i=>wie(()=>__dcg_shared_module_exports__['Ed'](i)==="latex",{true:()=>gi.createElement(lt,{latex:()=>i.substr(1,i.length-2),config:this.bindFn(this.getMQConfig)}),false:()=>gi.createElement("span",{class:gi.const("dcg-label-raw-text")},()=>i)}))):t==="MATH"?gi.createElement("div",{class:()=>({"dcg-editable-label-border":!0,"dcg-do-not-blur":!0,"dcg-focus":this.shouldEditableLabelBeFocused(e),"dcg-empty-label":this.getEditableLabelText(e).trim().length===0}),style:()=>({"border-color":__dcg_shared_module_exports__['P'](this.getEditableLabelTextColor(e),.3)})},gi.createElement(Ze,{latex:()=>this.getEditableLabelText(e),placeholder:()=>"",isFocused:()=>this.shouldEditableLabelBeFocused(e),capExpressionSize:()=>!!this.controller.getGraphSettings().config.capExpressionSize,selectOnFocus:gi.const(!1),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.controller.s("graphing-calculator-narration-editable-point-label-at-coordinates",{coordinates:r6(this.controller,this.grapher,this.cachedLabelDict[e])}),getAriaPostLabel:this.const(""),onUserChangedLatex:i=>this.onLabelInput(i,e),onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:i=>this.onEditableLabelFocusChange(i,e),hasError:this.const(!1),noFadeout:this.const(!0),needsSystemKeypad:()=>!this.controller.isKeypadEnabled()})):gi.createElement("div",{class:()=>({"dcg-resizing-text-input-container":!0,"dcg-editable-label-border":!0,"dcg-focus":this.shouldEditableLabelBeFocused(e),"dcg-empty-label":this.getEditableLabelText(e).trim().length===0}),style:()=>({"border-color":__dcg_shared_module_exports__['P'](this.getEditableLabelTextColor(e),.3)}),onScroll:i=>{i.target&&(i.target.scrollLeft=0)}},gi.createElement(yie,{"aria-label":()=>this.controller.s("graphing-calculator-narration-editable-point-label-at-coordinates",{coordinates:r6(this.controller,this.grapher,this.cachedLabelDict[e])}),onInput:i=>this.onLabelInput(i,e),value:()=>this.getEditableLabelText(e),onFocus:()=>this.onEditableLabelFocusChange(!0,e),onBlur:()=>this.onEditableLabelFocusChange(!1,e)}),gi.createElement("span",{class:gi.const("dcg-text-input-content")},()=>this.getEditableLabelText(e)||" ")))}getSketchIdFromLabelId(e){var t=this.cachedLabelDict[e];if(t)return t.sketchId}getEditableLabelTextColor(e){let t=this.getSketchIdFromLabelId(e);if(!t)return"#000";let i=this.controller.getItemModel(t);return!i||i.type!=="expression"?"#000":Ud(i)}onEditableLabelFocusChange(e,t){let i=this.getSketchIdFromLabelId(t);i&&(e?this.controller.dispatch({type:"set-focus-location",location:{type:"editable-label",id:i}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"editable-label",id:i}}),this.update())}shouldEditableLabelBeFocused(e){let t=this.getSketchIdFromLabelId(e),i=this.controller.getFocusLocation();return!(!i||i.type!=="editable-label"||!t||i.id!==t)}onLabelInput(e,t){let i=this.getSketchIdFromLabelId(t);if(!i)return;let o=this.controller.getItemModel(i);if(!o||o.type!=="expression")return;let n=e;this.controller.getItemEditableLabelMode(i)==="MATH"&&n.length>0&&(n="`"+n+"`"),this.controller.dispatch({type:"set-item-label",id:i,label:n})}getEditableLabelText(e){let t=this.getSketchIdFromLabelId(e);if(!t)return"";let i=this.controller.getItemModel(t);return!i||i.type!=="expression"?"":this.controller.getItemEditableLabelMode(t)==="MATH"?i.label.substr(1,i.label.length-2):i.label}linkLabelDOMNode(e,t){var i=this.cachedLabelDict[e];i&&(i.labelDOM=t)}linkLabelContainerNode(e,t){var i=this.cachedLabelDict[e];i&&(i.containerDOM=t)}getLabelClasses(e){var t=this.cachedLabelDict[e];return t?t.classes:{}}getLabelStyles(e){var t=this.cachedLabelDict[e];return t?t.styles:{}}getDotStyles(e){var t=this.cachedLabelDict[e];return t?t.dotStyles:{}}getLabelContent(e){var t=this.cachedLabelDict[e];if(t){let i=this.getSketchIdFromLabelId(e);if(!i)return{is_hole:!1,type:"text",text:""};let o=this.controller.getItemEditableLabelMode(i);return t.classes["dcg-editable-label"]&&o!==void 0&&o!=="NONE"?{is_hole:!1,type:o,text:""}:t.content}return{is_hole:!1,type:"text",text:""}}didMountRoot(e){this.node=e}computeHoveredLabel(e,t){var i;this.hoveredPOI?this.isOpenPOI(this.hoveredPOI)?this.grapher.setLayerClass("hoveredPOI","dcg-mouse-over-opened-poi"):(i=this.computeLabel(e,{poi:this.hoveredPOI,type:"poi"},t,"hovered"),this.grapher.setLayerClass("hoveredPOI","dcg-mouse-over-closed-poi")):this.grapher.setLayerClass("hoveredPOI",void 0);var o=this.getHoveredInteractiveLabel();o&&!o.bareLabel?this.grapher.setLayerClass("interactiveLabel","dcg-mouse-over-opened-poi"):this.grapher.setLayerClass("interactiveLabel",void 0),i&&this.saveLabelToCache(i)}computeTraceLabel(e,t){if(this.traceInfo){var i=this.traceInfo.pt;if(i){var o=new gh(i.x,i.y,1007,this.traceInfo.branchInfo.sketch,this.traceInfo.branchInfo.branch,0),n=this.computeLabel(e,{poi:o,type:"poi"},t,"trace");n&&this.saveLabelToCache(n)}}}computeLabel(e,t,i,o){let{projection:n}=e,a=t.type==="poi"?t.poi.id+"":t.id;o==="trace"&&(a="*trace*");let s=t.poi,l=n.mapx(s.x),c=n.mapy(s.y),d=l,p=c;if(t.type!=="poi"&&(l=0,c=0),n.coordsAreOnscreen(l,c,20)){if(this.isHiddenInteractiveLabel(s))return;let g=!1,h,f=s.sketch,y=f&&f.branches[0];y&&(g=!!("nakedLabel"in y&&y.nakedLabel),h="labelOrientation"in y?y.labelOrientation:void 0);let x=f.id,E=this.controller.getItemModel(x);if(s.hasEditableLabel()&&E&&E.type==="expression"&&!zs(E))return;let C=Eie(t,n),S=s.pointIdxOnBranch,v=s.getLabelSize();this.grapher.settings.config.projectorMode&&(v*=1.2),Array.isArray(v)&&(v=v[S]);let M=s.getLabelRotation();Array.isArray(M)&&(M=M[S]);let A=s.getPointOpacity()*this.controller.getGeoModel().getToolFadeOpacity(x),I=!!s.getTextOutline(),P=s.isPersistent(),_=s.isAttachedToPlottedPoint(),U=s.hasInteractiveLabel(),Y=s.hasEditableLabel()&&!this.takingScreenshot,R=!!(E&&E.type==="expression"&&cs(E)),H=this.grapher.clickableObjectsLayer.shouldDrawPressed(x,s.pointIdxOnBranch),O=this.grapher.clickableObjectsLayer.shouldDrawHovered(e,x,s.pointIdxOnBranch),q=this.grapher.clickableObjectsLayer.isKeyboardFocused(x,s.pointIdxOnBranch),w=f.color;if(H){let be=__dcg_shared_module_exports__['na'](w);be.l>.2?be.l-=.2:be.l+=.1,w=be.toString()}else if(O){let be=__dcg_shared_module_exports__['na'](w);be.l>.2?be.l-=.1:be.l+=.2,w=be.toString()}let T=!P,B=!!_;U&&(B=!0,T=!0),o==="trace"&&(B=!1,T=!0);let de=i[a],F=de&&de.labelDOM,j=de&&de.containerDOM,pe=de&&de.width,le=de&&de.height,ne=de&&de.orientation,X={"dcg-poi-label":!0,"dcg-tracept":o==="trace","dcg-opened":o==="opened","dcg-hole":C.is_hole,"dcg-show-border":T,"dcg-hide-dot":B,"dcg-naked-label":g,"dcg-editable-label":Y,"dcg-has-outline":I,"dcg-focus":q,"dcg-underlined-label":!!(R&&E&&E.type==="expression"&&E.hidden)};isFinite(v)||(v=1);let ae=Math.round(v*1100)/10,J={left:l+"px",top:c+"px","font-size":ae+"%"};M&&!this.takingScreenshot&&(J.transform=`rotate(${M}rad)`),P&&w&&(J.color=w),J.opacity=`${Math.min(.99,A)}`;let ge={};return o==="trace"&&(ge["background-color"]=w,ge["border-color"]=w),{id:a,sketchId:x,poi:s,x:s.x,y:s.y,screenX:l,screenY:c,top:p,left:d,width:pe,height:le,labelDOM:F,containerDOM:j,forcedOrientation:h,isNakedLabel:g,isClickable:R,orientation:ne,rotation:M,classes:X,styles:J,dotStyles:ge,content:C,hasBorder:s.hasEditableLabel(),opacity:A,hasOutline:I||s.hasEditableLabel(),objectSpec:t.type!=="poi"?t.type==="angle"?{type:t.type,segments:[n.mapx(t.segments[0]),n.mapy(t.segments[1]),t.segments[2],t.segments[3]]}:{type:t.type,segments:n.map_xy_pairs(t.segments)}:void 0}}}computeAllLabels(e,t){var i={},o,n,a=this.grapher.graphSketches;this.grapher.getSketchOrder().forEach(c=>{var d=a[c];if(d){var p=d.labels;if(p.length)for(var g=0;g<p.length;g++){let h=p[g],f=this.computeLabel(e,h,t,"opened");f&&(Array.isArray(d.color)&&(f.styles.color=d.color[g]),this.saveLabelToCache(f))}}});var s={};for(o in this.openedPOI2Sketch){var l=vie(o,a[this.openedPOI2Sketch[o]]);l&&(s[o]=l.sketch.id,n=this.computeLabel(e,{poi:l,type:"poi"},t,"opened"),n&&this.saveLabelToCache(n))}return this.openedPOI2Sketch=s,i}saveLabelToCache(e){var t=e.id;this.cachedLabelDict[t]||this.cachedLabelOrder.push(t),this.cachedLabelDict[t]=e}markLabelsDirty(){this.labelsDirty=!0}getInteractiveLabelUnderPoint(e){let t;for(var i=this.cachedLabelOrder.length-1;i>=0;i--){let o=this.cachedLabelOrder[i],n=this.cachedLabelDict[o];if(!n||!n.width||!n.height)continue;let a=n.screenX,s=n.screenY,{left:l,top:c,width:d,height:p}=n;if(d>0&&p>0&&e.x>a+l&&e.x<a+l+d&&e.y>s+c&&e.y<s+c+p){let g=this.getSketchIdFromLabelId(o);if(g===void 0)continue;let h=this.controller.getItemModel(g);if(!h||h.type!=="expression")continue;if(Ny(h))return{type:"editable",model:h};!t&&X4(h)?t={type:"draggable",model:h,label:{x:n.x,y:n.y}}:!t&&n.isClickable&&(t={type:"clickable",model:h,poi:n.poi})}}return t}positionLabels(e,t,i,o,n){var a=!this.labelsDirty;this.labelsDirty=!1;var s=[];t.forEach(p=>{var g=i[p];if(!g||!g.labelDOM)return;let h,f,y=this.getSketchIdFromLabelId(p);if(y!==void 0){let I=this.grapher.getGraphSketch(y);I&&I.branches&&(h=I.branches[0].pointSize,f=I.branches[0].graphMode===4)}(h===void 0||typeof h!="number"||h<0)&&(h=8);let x=this.grapher.settings.config.projectorMode?1.3:1;f&&(h=__dcg_shared_module_exports__['_'](h));let E=.5*h*x+3;var C=g.screenX,S=g.screenY,v=g.labelDOM.clientWidth,M=g.labelDOM.clientHeight;if(!(v>0&&M>0))return;let A=0;this.takingScreenshot&&g.hasBorder&&(A=5),s.push({renderedLabel:g,pt_x:C,pt_y:S,pt_radius:E+A,rotation:g.rotation,nakedLabel:g.isNakedLabel,width:v,height:M,keepOrientation:a,priorOrientation:g.orientation,enforceOrientation:g.forcedOrientation})});var l=KH(e,o,n),c=s.map(p=>{if(p.renderedLabel.objectSpec){if(p.renderedLabel.objectSpec.type==="segment")return HH(l,{pt_x1:p.renderedLabel.objectSpec.segments[0],pt_y1:p.renderedLabel.objectSpec.segments[1],pt_x2:p.renderedLabel.objectSpec.segments[2],pt_y2:p.renderedLabel.objectSpec.segments[3],pt_radius:10,width:p.width,height:p.height,keepOrientation:p.keepOrientation,priorOrientation:p.priorOrientation||""});if(p.renderedLabel.objectSpec.type==="polygon")return $H(l,{path:p.renderedLabel.objectSpec.segments,pt_radius:10,width:p.width,height:p.height,keepOrientation:p.keepOrientation,priorOrientation:p.priorOrientation||""});if(p.renderedLabel.objectSpec.type==="angle"){let g=p.renderedLabel.objectSpec.segments,h=this.grapher.settings.config.projectorMode?30:20;return WH(l,{pt_x:g[0],pt_y:g[1],startAngle:g[2],deltaAngle:g[3],isRightAngle:pT(g[3]),radius:h,pt_radius:10,width:p.width,height:p.height,keepOrientation:p.keepOrientation,priorOrientation:p.priorOrientation||""})}}else return qH(l,p);return[]}),d=UH(c);d.forEach(function(p,g){var h=s[g].renderedLabel;h.orientation=p.orientation;let f=p.left-p.pt_x,y=p.top-p.pt_y;h.left=f,h.top=y,h.width=p.width,h.height=p.height;var x=h.labelDOM;if(x){x.style.transform=p.transform,x.setAttribute("dcg-label-orientation",p.orientation);var E=h.containerDOM;E&&(E.style.left=p.pt_x+"px",E.style.top=p.pt_y+"px"),setTimeout(()=>x.classList.add("dcg-enable-transition"),1)}})}copyToCtx(e){Ms(e,"labels");var t=this.node.getBoundingClientRect();this.cachedLabelOrder.forEach(i=>{var o=this.cachedLabelDict[i];if(!o)return;var n=o.labelDOM;if(!n)return;let a={pointCenterX:o.screenX,pointCenterY:o.screenY,hasOutline:!!o.hasOutline,hasBorder:!!o.hasBorder};var s=this.computeRotatedCenter(a.pointCenterX,a.pointCenterY,o.rotation);let l=GT(n,a);e.save(),e.globalAlpha=o.opacity,e.rotate(o.rotation),e.translate(s.x-t.left,s.y-t.top),TT(l,e),e.restore()}),Is(e)}computeRotatedCenter(e,t,i){var o=Math.cos(-i),n=Math.sin(-i),a=e*o-t*n,s=t*o+e*n;return{x:a,y:s}}drawForScreenshot(e,t,i,o){this.takingScreenshot=!0,this.redraw(e,i,o),this.takingScreenshot=!1,this.copyToCtx(t)}redraw(e,t,i){let{ctx:o}=e;var n=this.cachedLabelDict;this.cachedLabelDict={},this.cachedLabelOrder=[],this.computeAllLabels(e,n),this.computeHoveredLabel(e,n),this.computeTraceLabel(e,n),this.update(),this.positionLabels(o,this.cachedLabelOrder,this.cachedLabelDict,t,i)}clearOpenedPOI(){this.openedPOI2Sketch={}}closePOI(e){delete this.openedPOI2Sketch[e.id]}openPOI(e){this.openedPOI2Sketch[e.id]=e.sketch.id}isOpenPOI(e){return this.openedPOI2Sketch.hasOwnProperty(e.id)}isOpenInteractiveLabel(e){return this.isOpenPOI(e)?e.hasInteractiveLabel():!1}isHiddenInteractiveLabel(e){return!e||!e.hasInteractiveLabel()?!1:!this.isOpenPOI(e)&&this.getHoveredPOI()!==e}setHoveredPOI(e){this.hoveredPOI=e}getHoveredPOI(){return this.hoveredPOI}getHoveredInteractiveLabel(){var e=this.getHoveredPOI();if(e&&e.hasInteractiveLabel())return e}setTraceInfo(e){this.traceInfo=e}isTracing(){return!!this.traceInfo}getTraceInfo(){return this.traceInfo}getMQConfig(){return this.controller.getMathquillConfig({})}};function Gx(r,e){let t=r[e];return Array.isArray(t)&&r.tableInfo?t[r.tableInfo.rowIndex]:t}var KC=class{constructor(e){this.grapher=e,this.renderedPointsIdOrder=[],this.renderedPoints={},this.speakThrottledAlert=__dcg_shared_module_exports__['z'](()=>{let t=this.getPOIUnderAttention();if(!t){this.lastAriaAlert=void 0;return}let i=this.getAriaAlert({id:t.id,lastAriaAlert:this.lastAriaAlert,includeUsageInstructions:!1});i!=null&&i.updated&&(Te(i.completeMessage),this.lastAriaAlert=i)},1e3,{leading:!1,trailing:!0})}redraw(e,t){let{ctx:i,projection:o}=e;var n=this.grapher.graphSketches,a=this.renderedPoints;this.renderedPoints={},this.renderedPointsIdOrder=[];let s=this.grapher.poiController.keyboardAttentionManager.getKeyboardAttention(),l=s==null?void 0:s.calcId,c=(s==null?void 0:s.listIndex)||0;var d=S=>{let v=!!s&&l===S.sketch.id&&c===S.listIndex;var M=this.processPOI(i,o,S,a[S.id],t,v);M&&(this.renderedPoints[S.id]=M,this.renderedPoints[S.id].poi=S,this.renderedPointsIdOrder.push(S.id))};this.grapher.getSketchOrder().forEach(S=>{var v=n[S];v&&(v.getMovablePoints().forEach(d),v.getStaticLabeledPoints().forEach(d))});var p=this.renderedPoints[this.hoveredPointId],g=this.renderedPoints[this.pressedPointId],h=p&&p.poi,f=g&&g.poi;h||this.setHoveredPointId(void 0),f||this.setPressedPointId(void 0);var y=f||h,x,E;if(y?(x=y.type==="movable-point"&&y.tableInfo&&y.tableInfo.dragX,E=y.type==="movable-point"&&y.tableInfo&&y.tableInfo.dragY,x&&E||!x&&!E?this.grapher.setLayerClass("movablePoints","dcg-mouse-over-movable-point"):x?this.grapher.setLayerClass("movablePoints","dcg-mouse-over-movable-point-ew"):this.grapher.setLayerClass("movablePoints","dcg-mouse-over-movable-point-ns")):this.grapher.setLayerClass("movablePoints",void 0),!this.getPOIUnderAttention()){this.lastAriaAlert=void 0;return}this.speakThrottledAlert()}_clampedOpacity(e){return e<0?0:e>1?1:__dcg_shared_module_exports__['J'](e)?e:1}getAllRenderedObjects(e){return this.renderedPointsIdOrder.filter(t=>e?this.renderedPoints[t].type===e:!0).map(t=>this.renderedPoints[t])}getOrderedTabTargets(e){let t=[];return this.renderedPointsIdOrder.forEach(i=>{let o=this.renderedPoints[i];if(e&&o.type!==e||this.getTabIndex(i)===-1)return;let n=o.poi;t.push({calcId:n.sketch.id,listIndex:n.listIndex,polygonEdge:void 0,description:this.getAriaLabel(i)})}),t}drawForScreenshot(e,t,i,o){var n=this.grapher.graphSketches;for(let d in n){var a=n[d],s=a.branches[0],l,c;s.graphMode===4&&(l=s.pointOpacity,c=s.pointSize!==void 0?s.pointSize:8),a.getMovablePoints().forEach(p=>{var g={screenX:t.mapx(p.x),screenY:t.mapy(p.y),color:p.color,pointOpacity:l,pointSize:c,animationPercent:0};o?this.drawMovablePointOnCtx(e,p.sketch,g,i):qp.drawPointToCtx({ctx:e,projection:t,x:p.x,y:p.y,alpha:l,sketch:p.sketch,sizeFactor:1,opacityFactor:1,finalHardcodedSize:c})})}}processPOI(e,t,i,o,n,a){var s=i.id,l=i.x,c=i.y,d=t.mapx(l),p=t.mapy(c),g=t.coordsAreOnscreen(d,p,20);if(!g&&!a)return;var h=i.sketch?this.grapher.controller.getItemModel(i.sketch.id):void 0,f=!!(h&&Na(h));if(!(h&&this.grapher.controller.shouldIgnoreGraphInteractions(h)))return o||(i.type==="movable-point"?o={type:"movable",id:s,pointOnScreen:g,poi:i,projection:t,screenX,screenY,color:Gx(i,"color"),pointOpacity:Gx(i,"pointOpacity"),pointSize:Gx(i,"pointSize"),pointIsHovered:!1,pointIsPressed:!1,selected:f,lastHoverActionTime:0,animationPercent:0}:h&&h.type==="expression"&&h.label!==void 0&&h.showLabel&&mo(h)!=="NONE"?o={type:"draggable-label",id:s,pointOnScreen:g,selected:f,poi:i,projection:t,screenX,screenY}:o={type:"static",id:s,pointOnScreen:g,poi:i,projection:t,screenX,screenY,selected:f}),o.pointOnScreen=g,o.poi=i,o.projection=t,o.screenX=d,o.screenY=p,o.type==="movable"&&(o.color=Gx(o.poi,"color"),o.pointOpacity=Gx(o.poi,"pointOpacity"),o.pointSize=Gx(o.poi,"pointSize"),o.selected=f,this.updateMovablePointAnimation(o,a),this.drawMovablePointOnCtx(e,o.poi.sketch,o,n)),o}drawMovablePointOnCtx(e,t,i,o){var f;var n=i.pointSize/2*(this.grapher.settings.config.projectorMode?1.3:1);n<0&&(n=0),t.showHighlight&&(n*=1.15);var a=Array.isArray(i.color)?i.color[0]:i.color,s=i.screenX,l=i.screenY,c=i.animationPercent||0;o.push({left:s-n,right:s+n,top:l-n,bottom:l+n}),e.save();var d=e.globalAlpha;let p=this.shouldDrawGhosted(t.id)?sT.IS_GHOSTED:PC;var g=this._clampedOpacity(p*i.pointOpacity);g*=(f=this.grapher.controller.getGeoModel().getToolFadeOpacity(t.id))!=null?f:1;let h=__dcg_shared_module_exports__['$'](n);e.fillStyle=a,e.globalAlpha=.35*g,e.beginPath(),e.moveTo(s+h,l),e.arc(s,l,h,0,Math.PI*2,!0),e.closePath(),e.fill(),e.globalAlpha=g,t.tokenHovered&&(n=.7*n+.3*h),n=n+(h-n)*c,e.beginPath(),e.moveTo(s+n,l),e.arc(s,l,n,0,Math.PI*2,!0),e.closePath(),e.fill(),e.globalAlpha=d,e.restore()}updateMovablePointAnimation(e,t){var i=Date.now(),o=e.id,n=this.hoveredPointId===o||t,a=this.pressedPointId===o;e.pointIsPressed=a,n!==e.pointIsHovered&&(e.pointIsHovered=n,e.lastHoverActionTime=i);var s=e.animationPercent||0,l=i-e.lastHoverActionTime,c=.004*l;a?s=1:n?(s+=c,s>=1?s=1:this.requestRedrawNextFrame()):(s-=c,s<=0?s=0:this.requestRedrawNextFrame()),e.animationPercent=s}shouldDrawGhosted(e){if(!e)return!1;let t=this.grapher.controller.getItemModel(e);return!t||t.type!=="expression"?!1:ls(t)}getTabIndex(e){if(this.grapher.controller.getActiveTool()!=="selection")return-1;let t=this.renderedPoints[e];if(!t)return-1;let i=t.poi,o=this.grapher.controller.getItemEditableLabelMode(i.sketch.id),n=this.grapher.controller.getItemModel(i.sketch.id),a=n&&n.type==="expression"&&!cs(n)&&(t.type==="movable"||o===void 0||o==="NONE");var s=this.grapher.settings;let l=s.config.graphpaper&&s.config.enableTabindex;return a&&l?0:-1}getAriaHidden(){var e=this.grapher.settings;return!e.config.graphpaper}getAriaLabel(e){var t=this.getAriaAlert({id:e,includeUsageInstructions:!1});return t&&t.completeMessage}speakAriaAlert(){var o;let e=(o=this.getPOIUnderAttention())==null?void 0:o.id;if(e){let n=this.renderedPoints[e];if(!n||n.type==="static")return this.lastAriaAlert=void 0,!1}let t=this.getAriaAlert({id:e,lastAriaAlert:this.lastAriaAlert,includeUsageInstructions:!0}),i=!this.lastAriaAlert||this.lastAriaAlert.id!==e||!!(t!=null&&t.updated);return this.lastAriaAlert=t,t!=null&&t.completeMessage?(i&&Te(t.completeMessage),!0):!1}getAriaAlert(e){let{id:t,lastAriaAlert:i,includeUsageInstructions:o}=e;if(!t)return;var n=this.renderedPoints[t];if(!n)return;let{controller:a}=this.grapher,s=n.poi.sketch?a.getItemModel(n.poi.sketch.id):void 0;if(!(!s||s.type!=="expression")){i&&i.id!==t&&(i=void 0);var l=n.poi,c=n.pointOnScreen,d=n.projection;if(!(!l||!d)){var p=d.viewport;if(p){var g=i==null?void 0:i.label,h=l.ariaLabel;a.isGeometry()&&Xc(s)&&(h=CT(s,a,{poi:l,includeDetails:!1}).join(" "));var f=g!==h,y=!!(i!=null&&i.selected),x=n.selected,E=y!==x,C=i==null?void 0:i.coordX,S=i==null?void 0:i.coordY,v=l.x,M=l.y,A=v!==C||M!==S,I=i&&(f||E||A),P=ps(a,v),_=us(a,M),U=`${P} ${_}`,Y=h||a.s("graphing-calculator-narration-movable-point-prefix"),R=!a.isGeometry()&&(n.type==="movable"||n.type==="draggable-label")&&o?a.s("graphing-calculator-narration-movable-point-suffix-usage-instructions"):"",H=c?"":a.s("graphing-calculator-narration-movable-point-off-screen-prompt"),O;if(i?f||!A&&E?O=Y+H:A?O=U+H:E?O=Y:O=i.completeMessage:O=a.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:Y,x:P,y:_})+R+H,(!i||I)&&a.isGeometry()&&(n.type==="movable"||n.type==="draggable-label")){let q=a.getActiveTool();(q==="selection"||q==="box-selection")&&(O=LO(O||h||"",s,a))}return{id:t,coordX:v,coordY:M,label:h,selected:x,completeMessage:O,updated:I}}}}}setHoveredPointId(e){e!==this.hoveredPointId&&(this.hoveredPointId=e,this.requestRedrawNextFrame())}isMovingPoint(){return!!this.pressedPointId}setPressedPointId(e){e!==this.pressedPointId&&(this.pressedPointId=e,this.requestRedrawNextFrame())}getPOIUnderAttention(){let e=this.grapher.poiController.keyboardAttentionManager.getKeyboardAttention();if(!e)return;let t=e.listIndex||0;for(let i in this.renderedPoints){let n=this.renderedPoints[i].poi;if(n.sketch.id===e.calcId&&n.listIndex===t)return n}}requestRedrawNextFrame(){this.grapher.controller.requestRedrawGraph()}};function AT(r,e,t){return ps(r,e)+" "+us(r,t)}function ps(r,e){let t=r.getGraphSettings().showXAxis,i=r.get2dProjection();if(!i)return"";let{width:o}=i.screen;return t?r.s("graphing-calculator-narration-audio-trace-property-x",{x:Ua(__dcg_shared_module_exports__['ob'](e,Mf(i,e)).latex)}):r.s("graphing-calculator-narration-x-percentage-coordinate",{x:Math.round(i.mathToPixels.mapX(e)/o*1e3)/10})}function us(r,e){let t=r.getGraphSettings().showYAxis,i=r.get2dProjection();if(!i)return"";let{height:o}=i.screen;return t?r.s("graphing-calculator-narration-audio-trace-property-y",{y:Ua(__dcg_shared_module_exports__['ob'](e,Mf(i,e)).latex)}):r.s("graphing-calculator-narration-y-percentage-coordinate",{y:Math.round(i.mathToPixels.mapY(e)/o*1e3)/10})}var Sie=Math.hypot&&Math.hypot(1/0,NaN)===1/0;function o6(r){return r===1/0||r===-1/0}var Rg=Sie?Math.hypot:function(r,e){if(o6(r)||o6(e))return 1/0;if(isNaN(r)||isNaN(e))return NaN;if(r===0&&e===0)return 0;if(Math.abs(r)>Math.abs(e)){let t=e/r;return Math.abs(r)*Math.sqrt(t*t+1)}else{let t=r/e;return Math.abs(e)*Math.sqrt(t*t+1)}};function Tx(r){let e=[[r.x0,r.y0],[r.x1,r.y1],[r.x2,r.y2]],[t,i]=__dcg_shared_module_exports__['Fb'](e),o=__dcg_shared_module_exports__['Ab'](r.x0-t,r.y0-i);return{x:t,y:i,radius:o}}function VT(r){let e=[[r.x0,r.y0],[r.x1,r.y1],[r.x2,r.y2]],[t,i]=__dcg_shared_module_exports__['Fb'](e);return{startAngle:Math.atan2(r.y0-i,r.x0-t),deltaAngle:__dcg_shared_module_exports__['Gb'](e)}}var n6=(r,e)=>({x:r.x-e.x,y:r.y-e.y}),Die=(r,e)=>r.x*e.x+r.y*e.y;function PT(r,e){return Rg(r.x-e.x,r.y-e.y)}function a6(r,e){let t={x:r.x1,y:r.y1},i={x:r.x2,y:r.y2},o=n6(e,t),n=n6(i,t),a=PT(t,i),s=a*a;return Die(o,n)/s}function BO(r){return[{x1:r.left,y1:r.top,x2:r.left,y2:r.bottom,extendStart:!1,extendEnd:!1},{x1:r.left,y1:r.top,x2:r.right,y2:r.top,extendStart:!1,extendEnd:!1},{x1:r.right,y1:r.top,x2:r.right,y2:r.bottom,extendStart:!1,extendEnd:!1},{x1:r.left,y1:r.bottom,x2:r.right,y2:r.bottom,extendStart:!1,extendEnd:!1}]}function kie(r){let{angle:e,width:t,height:i,center:o}=r,n=o.x,a=o.y,s=Math.cos(-e),l=Math.sin(-e),c=t/2,d=i/2,p={x:n+s*-c-l*-d,y:a+l*-c+s*-d},g={x:n+s*c-l*-d,y:a+l*c+s*-d},h={x:n+s*c-l*d,y:a+l*c+s*d},f={x:n+s*-c-l*d,y:a+l*-c+s*d};return[{x1:p.x,y1:p.y,x2:g.x,y2:g.y,extendStart:!1,extendEnd:!1},{x1:g.x,y1:g.y,x2:h.x,y2:h.y,extendStart:!1,extendEnd:!1},{x1:h.x,y1:h.y,x2:f.x,y2:f.y,extendStart:!1,extendEnd:!1},{x1:f.x,y1:f.y,x2:p.x,y2:p.y,extendStart:!1,extendEnd:!1}]}function Gie(r,e){let t=BO(r);return!!(_T(e,t[0])||_T(e,t[1])||_T(e,t[2])||_T(e,t[3]))}function Tie(r,e){let t=BO(r);return!!(jp(e,t[0],!1)||jp(e,t[1],!1)||jp(e,t[2],!1)||jp(e,t[3],!1)||jp(e,t[0],!0)||jp(e,t[1],!0)||jp(e,t[2],!0)||jp(e,t[3],!0))}function Mie(r,e){let t=BO(r);return!!(Fg(e,t[0],!1)||Fg(e,t[1],!1)||Fg(e,t[2],!1)||Fg(e,t[3],!1)||Fg(e,t[0],!0)||Fg(e,t[1],!0)||Fg(e,t[2],!0)||Fg(e,t[3],!0))}function Iie(r,e){return r.left<=e.left&&r.right>=e.right&&r.top<=e.top&&r.bottom>=e.bottom}function Aie(r,e){return r.left<=e.x&&e.x<=r.right&&r.top<=e.y&&e.y<=r.bottom}function OT(r,e){if(!e.extendStart){let t=r.left<=e.x1&&e.x1<=r.right,i=r.top<=e.y1&&e.y1<=r.bottom;if(t&&i)return!0}return Gie(r,e)}function u6(r,e){let t={x:e.x0,y:e.y0};return!!(Aie(r,t)||Mie(r,e))}function h6(r,e){let t={left:e.x-e.radius,right:e.x+e.radius,top:e.y-e.radius,bottom:e.y+e.radius};return!!(Iie(r,t)||Tie(r,e))}function Vie(r,e){let t=r.x-e.center.x,i=r.y-e.center.y,o=Math.atan2(i,t),n=Rg(t,i),a={x:n*Math.cos(o+e.angle),y:n*Math.sin(o+e.angle)};return Math.abs(a.x)<=e.width/2&&Math.abs(a.y)<=e.height/2}function g6(r,e){if(e.length<4)return!1;let t={x1:NaN,y1:NaN,x2:e[0],y2:e[1],extendStart:!1,extendEnd:!1};for(var i=2;i<e.length;i+=2)if(t.x1=t.x2,t.y1=t.y2,t.x2=e[i],t.y2=e[i+1],OT(r,t))return!0;return!1}function m6(r,e){var t=kie(e);for(let i of t)if(OT(r,i))return!0;return!!Vie({x:r.left,y:r.top},e)}function Lie(r,e,t){let i=e.x1-r.x,o=e.x2-r.x,n=e.y1-r.y,a=e.y2-r.y,s=r.radius,l=o-i,c=a-n,d=l*l+c*c,p=i*a-o*n,g=Math.sqrt(s*s*d-p*p);if(g<0)return;if(c>=0)var h=1;else var h=-1;let f=t?-1*h:1*h;return{x:r.x+(p*c+f*h*l*g)/d,y:r.y+(-p*l+f*Math.abs(c)*g)/d}}function Pie(r,e){let t=r.y2-r.y1,i=r.x1-r.x2,o=e.y2-e.y1,n=e.x1-e.x2,a=t*r.x1+i*r.y1,s=o*e.x1+n*e.y1,l=t*n-o*i;if(l!==0)return{x:(n*a-i*s)/l,y:(t*s-o*a)/l}}function NO(r,e){let t=a6(e,r);return!(isNaN(t)||t<0&&!e.extendStart||t>1&&!e.extendEnd)}function _ie(r,e){let{x:t,y:i}=Tx(e),{startAngle:o,deltaAngle:n}=VT(e),a=Math.atan2(r.y-i,r.x-t);return __dcg_shared_module_exports__['ba'](a,o,n)}function jp(r,e,t){let i=Lie(r,e,t);if(i!=null&&NO(i,e))return i}function Fg(r,e,t){let i=jp(Tx(r),e,!1)||l6,o=c6(t,d6(r,i),p6(e));if(o||(i=jp(Tx(r),e,!0)||l6,o=c6(t,d6(r,i),p6(e))),o&&_ie(i,r))return i}var l6={x:NaN,y:NaN};function _T(r,e){let t=Pie(r,e);if(t!=null&&NO(t,r)&&NO(t,e))return t}function c6(r,e,t){let i=e.x*t.y-e.y*t.x;return i>0&&r||i<0&&!r}function d6(r,e){let{x:t,y:i}=Tx(r),{deltaAngle:o}=VT(r);return o>0?{x:i-e.y,y:e.x-t}:{x:e.y-i,y:t-e.x}}function p6(r){return{x:r.x2-r.x1,y:r.y2-r.y1}}var nr=__dcg_shared_module_exports__['e'](te());var Sa=__dcg_shared_module_exports__['e'](te());qt();function RT(r){return Array.from(r.querySelectorAll('input:enabled, button:enabled, select:enabled, textarea:enabled, [tabindex="0"], a[href]')).filter(e=>!e.getAttribute("aria-hidden")&&!e.getAttribute("aria-disabled")&&Zu(e))}function f6(r){return function(t){if(Be(t)==cl&&r){let i=RT(r);if(i.length===0)return;let o=i[0],n=i[i.length-1];t.shiftKey&&document.activeElement===o?(t.preventDefault(),ie(n).trigger("focus")):!t.shiftKey&&document.activeElement===n?(t.preventDefault(),ie(o).trigger("focus")):document.activeElement&&!r.contains(document.activeElement)&&(t.preventDefault(),ie(o).trigger("focus"))}}}qt();function Ng(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){let e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}var{IfElse:Rie}=Sa.Components,Fie=500,Yp=5,qC=2,UO=class extends Sa.Class{constructor(){super(...arguments),this.offsetLeft=0}init(){this.uuid=this.props.uuid()}gravity(){var e,t;return((t=(e=this.props).gravity)==null?void 0:t.call(e))||"s"}template(){return Sa.createElement("div",{class:()=>{var e,t,i,o;return{"dcg-tooltip-positioning-container":!0,"dcg-tooltip-gravity-n-s":this.gravity()==="n"||this.gravity()==="s","dcg-tooltip-gravity-e-w":this.gravity()==="e"||this.gravity()==="w","dcg-tooltip-theme-light":((t=(e=this.props).theme)==null?void 0:t.call(e))==="light","dcg-tooltip-theme-dark":((o=(i=this.props).theme)==null?void 0:o.call(i))!=="light"}},style:()=>{var e,t,i,o;return{top:`${this.props.hitAreaRect().top+(((t=(e=this.props).offset)==null?void 0:t.call(e).top)||0)}px`,left:`${this.props.hitAreaRect().left+(((o=(i=this.props).offset)==null?void 0:o.call(i).left)||0)}px`,width:`${this.props.hitAreaRect().width}px`,height:`${this.props.hitAreaRect().height}px`}}},Sa.createElement("div",{class:Sa.const("dcg-tooltip-message-container"),style:this.bindFn(this.getMessageStyle)},Sa.createElement("div",{role:Sa.const("tooltip"),id:this.const(this.uuid),class:()=>({"dcg-tooltip-message":!0,"dcg-sticky-not-stuck":this.props.isStickyAndNotStuck()}),onMount:e=>this.tooltipMessage=e,style:()=>({left:`${Math.round(this.offsetLeft)}px`})},Rie(()=>!!this.props.customTooltipView,{true:()=>this.props.customTooltipView(),false:()=>Sa.createElement("span",null,this.props.tooltip)}))),Sa.createElement("div",{class:()=>({"dcg-tooltip-arrow":!0,[this.getTooltipGravityClass()]:!0}),style:()=>{var e,t;return((t=(e=this.props).theme)==null?void 0:t.call(e))==="light"?this.getArrowWithBorderStyle():this.getSolidArrowStyle()}}))}updatePositionIfNecessary(){if(this.gravity()!=="s"&&this.gravity()!=="n")return;let e=this.tooltipMessage.getBoundingClientRect(),t=this.tooltipMessage.closest(".dcg-tap-container");if(!t)return;let i=t.getBoundingClientRect();e.right+qC>i.right?this.offsetLeft=i.right-e.right-qC:e.left-qC<i.left&&(this.offsetLeft=i.left-e.left+qC),this.offsetLeft!==0&&this.update()}didMount(){this.updatePositionIfNecessary()}getTooltipGravityClass(){switch(this.gravity()){case"n":return"dcg-tooltip-gravity-n";case"s":return"dcg-tooltip-gravity-s";case"e":return"dcg-tooltip-gravity-e";case"w":return"dcg-tooltip-gravity-w"}}getArrowWithBorderStyle(){let e=this.gravity(),t=this.getBackgroundColor(),i="#bbb",o="8px",n={width:o,height:o,border:`1px solid ${i}`,background:t};switch(e){case"s":return{...n,top:"100%",left:"50%","margin-top":"1px","border-right":"0","border-bottom":"0"};case"n":return{...n,bottom:"100%",left:"50%","margin-bottom":"1px","border-left":"0","border-top":"0"};case"e":return{...n,top:"50%",left:"100%","margin-left":"1px","border-right":"0","border-top":"0"};case"w":return{...n,top:"50%",right:"100%","margin-right":"1px","border-left":"0","border-bottom":"0"};default:return e}}getSolidArrowStyle(){let e=this.gravity(),t=this.getBackgroundColor(),i=`transparent transparent ${t} transparent`,o=`${t} transparent transparent transparent`,n=`transparent ${t} transparent transparent`,a=`transparent transparent transparent ${t}`,s=`-${Yp}px`;switch(e){case"s":return{top:"100%",left:"50%",border:`${Yp}px solid transparent`,"border-color":i,"margin-top":s,"margin-left":s};case"n":return{bottom:"100%",left:"50%",border:`${Yp}px solid transparent`,"border-color":o,"margin-bottom":s,"margin-left":s};case"e":return{top:"50%",left:"100%",border:`${Yp}px solid transparent`,"border-color":n,"margin-left":`-${Yp}px`,"margin-top":s};case"w":return{top:"50%",right:"100%",border:`${Yp}px solid transparent`,"border-color":a,"margin-right":s,"margin-top":s};default:return e}}getBackgroundColor(){var e,t;return((t=(e=this.props).theme)==null?void 0:t.call(e))==="light"?"#fff":this.props.isStickyAndNotStuck()?"#666":"#000"}getMessageStyle(){let e=this.props.hitAreaRect(),t=this.gravity(),i=this.props.maxWidth();switch(t){case"s":return{top:"100%",width:`${i}px`,transform:"translate(-50%, 0)",left:`${.5*e.width}px`,"margin-top":`${Yp}px`,"text-align":"center"};case"n":return{bottom:"100%",width:`${i}px`,transform:"translate(-50%, 0)",left:`${.5*e.width}px`,"margin-bottom":`${Yp}px`,"text-align":"center"};case"e":return{transform:"translate(0, -50%)",left:"100%",width:`${i}px`,top:`${.5*e.height}px`,"margin-left":`${Yp}px`,"text-align":"left"};case"w":return{transform:"translate(0, -50%)",right:"100%",width:`${i}px`,top:`${.5*e.height}px`,"margin-right":`${Yp}px`,"text-align":"right"};default:return t}}};function Nie(){return document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}var $e=class extends Sa.Class{init(){this.uuid=`dcg-tooltip-${Ng()}`}template(){return Sa.createElement("div",{class:()=>{var e,t;return{"dcg-tooltip-hit-area-container":!0,"dcg-display-block":(t=(e=this.props).displayBlock)==null?void 0:t.call(e),"dcg-tooltip-disabled":this.props.disabled&&this.props.disabled()}},handleevent:Sa.const("true"),didMount:e=>{this.isMounted=!0,this.hitAreaNode=e,this.setupEventListeners(this.hitAreaNode)},onTap:()=>{if(this.shouldStickOnTargetClick())if(this.isStuck)this.clearTimeouts(),this.hideTooltip();else{if(this.props.disabled&&this.props.disabled())return;this.showTooltip(),this.stickTooltip()}else if(this.shouldShowOnTapstart()){if(this.props.disabled&&this.props.disabled())return;this.showTooltip(),this.setUpHideOnExternalMousedown()}else this.hideTooltipImmediately()}},this.children)}shouldShowOnTapstart(){return this.props.showOnTapstart&&this.props.showOnTapstart()}didUpdate(){this.updateTooltip()}updateTooltip(){if(!this.wrapperRef)return;if(!this.props.tooltip()){this.hideTooltip();return}let e=this.hitAreaNode.getBoundingClientRect(),t=this.wrapperRef.elt.getBoundingClientRect(),{originalTop:i,originalLeft:o}=this.wrapperRef,n=e.top-t.top,a=e.left-t.left;Math.abs(n-i)>3||Math.abs(a-o)>3?this.hideTooltip():this.wrapperRef.view.update()}handleShowEvent(e){if(this.props.disabled&&this.props.disabled())return;let t=this.props.delay?this.props.delay():Fie;this.clearTimeouts(),this.showTooltipTimeout=setTimeout(e,t)}hideTooltipImmediately(){this.clearTimeouts(),this.hideTooltip()}handleHideEvent(){this.clearTimeouts(),this.hideTooltipTimeout=setTimeout(this.bindFn(this.hideTooltip),150)}setupEventListeners(e){ie(e).on("tipsyshow",t=>{t.target===e&&this.handleShowEvent(()=>{this.showTooltip()})}).on("tipsyhide",t=>{t.target!==e||this.isStuck||this.handleHideEvent()})}willUnmount(){this.clearTimeouts(),this.isMounted=!1,this.hideTooltip()}setUpHideOnExternalMousedown(){ie(document).on(`mousedown.dcg-tooltip-${this.uuid} touchstart.dcg-tooltip-${this.uuid} pointerdown.dcg-tooltip-${this.uuid}`,e=>{this.wrapperRef&&(this.hitAreaNode.contains(e.target)||this.wrapperRef.elt.contains(e.target)||this.hideTooltip())})}stickTooltip(){this.isMounted&&this.wrapperRef&&(this.isStuck||(this.setUpHideOnExternalMousedown(),this.isStuck=!0,this.updateTooltip()))}clearTimeouts(){clearTimeout(this.showTooltipTimeout),clearTimeout(this.hideTooltipTimeout)}showTooltip(){var h,f,y;if(!this.isMounted||this.wrapperRef||!this.props.tooltip())return;let e=this.hitAreaNode.getBoundingClientRect(),t=document.createElement("div");t.className="dcg-tooltip-mount-pt";let i=this.hitAreaNode.closest(".dcg-tap-container"),o=Nie();(!!o&&o.contains(this.hitAreaNode)&&o.closest(".dcg-tap-container")?o:i).appendChild(t);let a=t.getBoundingClientRect(),s=e.left-a.left,l=e.top-a.top,c=200;if((f=(h=this.props).noWrap)!=null&&f.call(h)){let x=(y=t.closest(".dcg-tap-container"))==null?void 0:y.getBoundingClientRect();x&&(c=x.width-2*qC)}let d={...this.props,isStickyAndNotStuck:()=>this.shouldStickOnTargetClick()&&!this.isStuck,maxWidth:()=>c,hitAreaRect:()=>({top:l||0,left:s||0,width:e.width||0,height:e.height||0}),uuid:()=>this.uuid};this.setupEventListeners(t),ie(t).on("dcg-tap",()=>{this.shouldStickOnTargetClick()&&this.stickTooltip()});let p=Sa.mountToNode(UO,t,d);ie(document).on(`keydown.dcg-tooltip-${this.uuid}`,x=>{Be(x)===rn&&this.hideTooltip()});let g=()=>this.updateTooltip();window.addEventListener("scroll",g,!0),this.wrapperRef={elt:t,view:p,originalLeft:s,originalTop:l,onScroll:g},this.assignAriaDescribedBy()}hideTooltip(){this.clearTimeouts(),this.wrapperRef&&(this.isStuck=!1,ie(document).off(`.dcg-tooltip-${this.uuid}`),window.removeEventListener("scroll",this.wrapperRef.onScroll,!0),this.restoreAriaDescribedBy(),Sa.unmountFromNode(this.wrapperRef.elt),this.wrapperRef.elt.parentNode&&this.wrapperRef.elt.parentNode.removeChild(this.wrapperRef.elt),this.wrapperRef=void 0)}assignAriaDescribedBy(){let e=RT(this.hitAreaNode)[0]||this.hitAreaNode;this.originalDescribedBy=e.getAttribute("aria-describedby"),e.setAttribute("aria-describedby",this.uuid)}restoreAriaDescribedBy(){let e=RT(this.hitAreaNode)[0]||this.hitAreaNode;this.originalDescribedBy?e.setAttribute("aria-describedby",this.originalDescribedBy):e.removeAttribute("aria-describedby")}shouldStickOnTargetClick(){return!!this.props.sticky&&this.props.sticky()}};var mh=__dcg_shared_module_exports__['e'](te());var FT=class extends mh.Class{template(){return mh.createElement("div",{class:mh.const("dcg-dot-dot-dropdown")},mh.createElement("span",null),mh.createElement("span",null),mh.createElement("span",null))}};var Xl=__dcg_shared_module_exports__['e'](te());var Mx=class extends Xl.Class{template(){return Xl.createElement("span",{class:Xl.const("dcg-navigate-back"),onTap:this.props.onBack,"aria-label":this.props.ariaLabel,role:Xl.const("button"),tabindex:Xl.const("0"),handleEvent:Xl.const("true"),manageFocus:this.const(ft({controller:this.props.controller(),location:{type:"geo-header-back-link"}}))},Xl.createElement("i",{class:Xl.const("dcg-icon-chevron-left"),"aria-hidden":Xl.const("true")}),Xl.createElement("div",{class:Xl.const("dcg-navigate-back-message")},this.props.message))}};var Ai=__dcg_shared_module_exports__['e'](te());var Cc=__dcg_shared_module_exports__['e'](te());var xt=class extends Cc.Class{template(){return Cc.createElement("div",{role:Cc.const("checkbox"),tabindex:()=>this.props.disabled&&this.props.disabled()?-1:0,"aria-label":()=>{var e,t;return(t=(e=this.props).ariaLabel)==null?void 0:t.call(e)},"aria-labelledby":()=>{var e,t;return(t=(e=this.props).labelledBy)==null?void 0:t.call(e)},"aria-describedby":()=>{var e,t;return(t=(e=this.props).describedBy)==null?void 0:t.call(e)},"aria-disabled":()=>this.props.disabled&&this.props.disabled()?!0:void 0,"aria-checked":()=>this.props.checked(),"aria-required":()=>this.props.required?this.props.required():void 0,manageFocus:()=>{var e,t;return(t=(e=this.props).manageFocus)==null?void 0:t.call(e)},class:()=>({"dcg-component-checkbox":!0,"dcg-checked":this.props.checked(),"dcg-disabled":this.props.disabled&&this.props.disabled(),"dcg-small":this.props.small&&this.props.small(),[this.props.class===void 0?"":this.props.class()]:this.props.class!==void 0}),style:()=>this.props.style?this.props.style():{},onTap:this.bindFn(this.onChange)},Cc.createElement("span",{class:Cc.const("dcg-checkbox")},Cc.createElement("i",{class:Cc.const("dcg-icon-check"),"aria-hidden":Cc.const("true")})),Cc.createElement("span",{class:Cc.const("dcg-checkbox-children")},this.children))}onChange(e){let t=e.target;t&&t.getAttribute("href")||this.props.disabled&&this.props.disabled()||this.props.onChange(!this.props.checked())}};var $s=__dcg_shared_module_exports__['e'](te());var{Input:Bie,If:Uie}=$s.Components,NT=class extends $s.Class{init(){this.controller=this.props.controller(),this.cacheFolderList(),this.newFolderTitle=""}willUpdate(){this.cacheFolderList()}template(){return $s.createElement(Uie,{predicate:()=>this.getMovableItemCount()>0},()=>$s.createElement("div",{class:$s.const("dcg-move-to-folder")},$s.createElement("div",{class:$s.const("dcg-move-to-folder-title")},this.bindFn(this.getMoveMessage)),$s.createElement("div",{class:$s.const("dcg-move-to-folder-flex")},$s.createElement(Bie,{"aria-label":this.bindFn(this.getMoveMessage),value:()=>this.newFolderTitle,onInput:e=>{this.newFolderTitle=e,this.update()},placeholder:()=>this.controller.s("graphing-calculator-label-geometry-move-to-folder-placeholder"),didMount:e=>{e.onkeydown=function(t){let i=Be(t);(i==="Backspace"||i==="Del")&&t.stopPropagation()}},onEnterPressed:this.bindFn(this.onEnterPressed)}),$s.createElement("div",{class:()=>({"dcg-btn-blue":!0,"dcg-disabled":!this.newFolderTitle}),role:$s.const("button"),tabindex:()=>this.newFolderTitle?0:-1,onTap:this.bindFn(this.createNewFolder)},()=>this.controller.s("graphing-calculator-button-move-to-folder-action")))))}getMovableItemCount(){return this.controller.getAllSelectedItems().filter(t=>!this.controller.isItemReadonly(t.id)).length}getMoveMessage(){return this.controller.s("graphing-calculator-text-geometry-move-to-folder-message",{count:new on(this.getMovableItemCount())})}onEnterPressed(){let e=!1;this.folderList.forEach(t=>{t.title===this.newFolderTitle&&(e=!0,this.chooseFolder(t.id))}),e||this.createNewFolder()}chooseFolder(e){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"folderId",value:e}})}createNewFolder(){this.newFolderTitle&&this.controller.dispatch({type:"update-all-selected-items",update:{prop:"folderId",value:this.newFolderTitle,createFolder:!0}})}cacheFolderList(){this.folderList=[],this.controller.getAllItemModels().forEach(e=>{e.type==="folder"&&!this.controller.isGeoFolder(e)&&this.folderList.push(e)})}};var KT=__dcg_shared_module_exports__['e'](te());var ii=__dcg_shared_module_exports__['e'](te());var BT=__dcg_shared_module_exports__['e'](te());var zie=.9,If=class extends BT.Class{template(){return BT.createElement("div",{class:()=>{var e,t;return{"dcg-color-swatch":!0,"dcg-forced-color-none":!0,"dcg-color-evaluation":(t=(e=this.props).isEvaluation)==null?void 0:t.call(e),"dcg-light-color":WG(this.props.color(),this.props.invertSwatches(),zie)}},style:()=>({background:dx(this.props.color())})})}};var HC=__dcg_shared_module_exports__['e'](te());var Ix=class extends HC.Class{template(){return HC.createElement($e,{...this.props,customTooltipView:()=>HC.createElement(lt,{latex:this.props.tooltip,config:this.const({})}),theme:this.const("light"),noWrap:this.const(!0)},this.children)}};var{For:b6,If:UT}=ii.Components,Da=class extends ii.Class{init(){this.controller=this.props.controller()}template(){return ii.createElement("div",{class:ii.const("dcg-color-picker-container")},ii.createElement(b6,{each:()=>this.getColorValues()},ii.createElement("div",{class:ii.const("dcg-color-picker-menu dcg-do-not-blur")},e=>ii.createElement("div",{class:ii.const("dcg-color-tile"),handleevent:ii.const("true"),role:ii.const("button"),tabindex:ii.const("0"),"aria-label":()=>vf(this.controller,e),"aria-pressed":()=>this.isSelected(e),onTap:()=>this.props.onColorSelected(e)},ii.createElement(If,{color:()=>({type:"single-color",value:e}),invertSwatches:()=>this.controller.invertSwatches()}),ii.createElement(UT,{predicate:()=>this.isSelected(e)},()=>ii.createElement("i",{class:ii.const("dcg-icon-check"),"aria-hidden":ii.const("true")}))))),ii.createElement(UT,{predicate:()=>this.getUniqueCustomColors().length>0},()=>ii.createElement(b6,{each:this.bindFn(this.getUniqueCustomColors),key:e=>e.assignmentLatex},ii.createElement("div",{class:ii.const("dcg-color-picker-menu dcg-do-not-blur")},e=>ii.createElement(Ix,{tooltip:()=>e.assignmentLatex},ii.createElement("div",{class:ii.const("dcg-color-tile"),handleevent:ii.const("true"),role:ii.const("button"),tabindex:ii.const(0),"aria-label":()=>Ua(e.assignmentLatex),"aria-pressed":()=>this.props.colorLatex()===e.assignmentLatex,onTap:()=>this.props.onCustomColorSelected(e.assignmentLatex)},ii.createElement(If,{color:()=>this.getColorValue(e),invertSwatches:()=>this.controller.invertSwatches()}),ii.createElement(UT,{predicate:()=>this.props.colorLatex()===e.assignmentLatex},()=>ii.createElement("i",{class:()=>this.getCheckmarkClass(e),"aria-hidden":ii.const("true")})),ii.createElement(UT,{predicate:()=>{var t,i;return((i=(t=this.props).customColorVisibility)==null?void 0:i.call(t))==="suppressed"}},()=>ii.createElement("i",{class:ii.const("dcg-icon-lock")}))))))))}hideColorFunctions(){var e,t,i;return(i=(t=(e=this.props).hideColorFunctions)==null?void 0:t.call(e))!=null?i:!1}isSelected(e){var t=this.props.colorLatex();return t&&__dcg_shared_module_exports__['m'](this.getUniqueCustomColors(),"assignmentLatex").indexOf(t)>=0?!1:this.props.selectedColor()===e}getColorValues(){return __dcg_shared_module_exports__['C'](this.controller.getColors())}getUniqueCustomColors(){if(this.props.customColorVisibility&&this.props.customColorVisibility()==="hidden")return[];let e=[];e.push(...this.controller.getAllColorAssignments()),this.hideColorFunctions()||e.push(...this.controller.getAllColorFunctionAssignments());let t=__dcg_shared_module_exports__['r'](e,i=>i.assignmentLatex);return e.filter(i=>t[i.assignmentLatex]===1)}getColorValue(e){switch(e.id){case"shader":return{type:e.id};default:let t=this.controller.getColorById(e.id);return Array.isArray(t)?{type:"color-array",value:t}:/^data:image/.test(t)?{type:"image",value:t}:{type:"single-color",value:t}}}getCheckmarkClass(e){return WG(this.getColorValue(e),!1)?`dcg-icon-check ${cq(this.getColorValue(e),!1)?"dcg-light-color":"dcg-mixed-color"}`:"dcg-icon-check"}};var zT=class extends KT.Class{init(){this.controller=this.props.controller(),this.cacheSelectedColor()}template(){return KT.createElement(Da,{controller:this.props.controller,colorLatex:()=>this.colorLatex,selectedColor:()=>this.selectedColor,onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected),customColorVisibility:this.bindFn(this.getCustomColorVisibility)})}getCustomColorVisibility(){return this.controller.getGraphSettings().hideCustomColors?this.controller.shouldShowAuthorFeatures()?"suppressed":"hidden":"visible"}onCustomColorSelected(e){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"colorLatex",value:e}})}cacheSelectedColor(){let e=__dcg_shared_module_exports__['i'](this.controller.getAllSelectedItems(),t=>t.type==="expression");if(e.length===0){this.selectedColor="",this.colorLatex="";return}this.selectedColor=Ud(e[0]),this.colorLatex=e[0].colorLatex;for(let t=1;t<e.length;t++)if(this.selectedColor!==Ud(e[t])||this.colorLatex!==e[t].colorLatex){this.selectedColor="",this.colorLatex="";return}}willUpdate(){this.cacheSelectedColor()}onColorSelected(e){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"color",value:e}})}getFirstSelectedExpression(){var e=this.controller.getAllSelectedItems();for(let t of e)if(t.type==="expression")return t}};var Jl=__dcg_shared_module_exports__['e'](te());var hs=__dcg_shared_module_exports__['e'](te());var{For:Kie,If:qie}=hs.Components,Xi=class extends hs.Class{init(){this.config=this.props.staticConfig()}template(){return hs.createElement(Kie,{each:()=>this.config,key:e=>e.key},hs.createElement("div",{class:hs.const("dcg-segmented-control-container"),role:hs.const("group"),"aria-label":this.props.ariaGroupLabel},e=>hs.createElement("div",{class:()=>({"dcg-segmented-control-btn":!0,"dcg-selected":e.selected(),"dcg-theme-mini":this.getTheme()==="mini","dcg-theme-default":this.getTheme()==="default","dcg-disabled":this.isDisabled(),[e.class?e.class():""]:!!e.class}),role:hs.const("button"),tabindex:hs.const(0),"aria-label":()=>this.getAriaLabel(e),style:()=>({"min-width":this.props.minButtonWidth?this.props.minButtonWidth()+"px":void 0}),"aria-pressed":()=>e.selected(),onTap:()=>{this.isDisabled()||e.onSelect()},manageFocus:()=>{if(e.focusHelperOptions)return ft(e.focusHelperOptions)}},hs.createElement($e,{tooltip:()=>e.tooltip?e.tooltip():"",gravity:()=>e.tooltipGravity?e.tooltipGravity():"s",disabled:()=>!(e.tooltip&&e.tooltip())},hs.createElement("div",{class:hs.const("dcg-segmented-control-interior")},()=>e.label?e.label():"",hs.createElement(qie,{predicate:()=>!!e.icon},()=>hs.createElement("i",{class:()=>e.icon?e.icon():""})))))))}getAriaLabel(e){return e.ariaLabel?e.ariaLabel():e.label?e.label():e.tooltip?e.tooltip():""}isDisabled(){return this.props.disabled&&this.props.disabled()}getTheme(){return this.props.theme?this.props.theme():"default"}};var{Input:Hie,IfElse:Wie}=Jl.Components,Af=class extends Jl.Class{template(){return this.controller=this.props.controller(),Jl.createElement("div",{class:()=>({"dcg-label-visible":this.getShowLabel(),"dcg-label-container":!0,"dcg-do-blur":!0}),tapboundary:Jl.const("true"),handleEvent:Jl.const("true")},Jl.createElement(xt,{onChange:this.bindFn(this.onCheckboxInput),checked:this.bindFn(this.getShowLabel)},()=>this.controller.s("graphing-calculator-button-label")+(this.getIsDisabled()?"":":")),Wie(this.bindFn(this.hasEditableLabel),{true:()=>Jl.createElement("div",{class:Jl.const("dcg-editable-mode-toggle")},Jl.createElement(Xi,{theme:this.const("mini"),staticConfig:this.bindFn(this.getEditableLabelOptions),ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-editable-label-mode")})),false:()=>Jl.createElement(Hie,{class:()=>({"dcg-label-input":!0,"dcg-disabled-input":this.getIsDisabled(),"dcg-disabled-editable-input":this.hasEditableLabel(),"dcg-readonly":this.getIsReadonly()}),disabled:this.bindFn(this.getIsReadonly),"aria-label":()=>this.controller.s("graphing-calculator-narration-label-text"),"aria-disabled":()=>this.getIsDisabled()||this.hasEditableLabel()||this.getIsReadonly(),value:this.bindFn(this.getLabel),onInput:this.bindFn(this.onLabelInput)})}))}getEditableLabelOptions(){return[{key:"math",label:()=>this.controller.s("graphing-calculator-button-editable-math"),selected:()=>this.model().editableLabelMode==="MATH",onSelect:()=>this.setEditableLabelMode("MATH")},{key:"text",label:()=>this.controller.s("graphing-calculator-button-editable-text"),selected:()=>this.model().editableLabelMode==="TEXT",onSelect:()=>this.setEditableLabelMode("TEXT")}]}setEditableLabelMode(e){this.controller.dispatch({type:"set-item-editable-label-mode",id:this.id(),editableLabelMode:e})}getIsReadonly(){return this.controller.isItemReadonly(this.model().id)}model(){return this.props.model()}id(){return this.model().id}getLabel(){return this.model().label||""}hasEditableLabel(){return Ny(this.model())}getShowLabel(){return Fd(this.model())}getIsDisabled(){return this.getLabel().length===0&&!this.getShowLabel()}onLabelInput(e){var t=e;this.controller.dispatch({type:"set-item-label",id:this.id(),label:t}),this.controller.dispatch({type:"set-item-showlabel",id:this.id(),showLabel:!!t})}onCheckboxInput(){if(this.props.useSmartPointLabeling&&this.props.useSmartPointLabeling()){this.controller.dispatch({type:"toggle-label-for-all-selected-points"});return}this.controller.dispatch({type:"set-item-showlabel",id:this.id(),showLabel:!this.getShowLabel()})}};var{If:Ax}=Ai.Components,qT=class extends Ai.Class{init(){this.controller=this.props.controller(),this.cacheSectionValues()}willUpdate(){this.cacheSectionValues()}isIconModelFocused(){return this.controller.isFocusLocationFocused({type:"multi-select-more-icon"})}template(){return Ai.createElement("div",{class:()=>({"dcg-generic-options-menu":!0,"dcg-options-menu":!0,"dcg-multi-select-options-menu":!0}),role:Ai.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-options-menu")},Ai.createElement("div",{class:Ai.const("dcg-options-menu-section")},Ai.createElement("div",{class:Ai.const("dcg-multi-select-color-picker")},Ai.createElement(zT,{controller:this.props.controller})),Ai.createElement(Ax,{predicate:()=>this.sectionValues.showPointLabels!==void 0},()=>Ai.createElement("div",{class:Ai.const("dcg-checkbox-section")},Ai.createElement(xt,{checked:()=>!!this.sectionValues.showPointLabels,onChange:this.bindFn(this.onShowPointLabelChanged)},()=>this.controller.s("graphing-calculator-button-geometry-label-points-checkbox")))),Ai.createElement(Ax,{predicate:()=>this.sectionValues.singleLabelableExpressionModel!==void 0},()=>Ai.createElement("div",{class:Ai.const("dcg-checkbox-section")},Ai.createElement(Af,{controller:this.props.controller,model:()=>this.sectionValues.singleLabelableExpressionModel,useSmartPointLabeling:()=>this.sectionValues.draggableFreePoint!==void 0}))),Ai.createElement(Ax,{predicate:()=>this.sectionValues.draggableFreePoint!==void 0},()=>Ai.createElement("div",{class:Ai.const("dcg-checkbox-section")},Ai.createElement(xt,{checked:()=>!!this.sectionValues.draggableFreePoint,onChange:this.bindFn(this.onDraggableFreePointChanged)},()=>this.controller.s("graphing-calculator-button-draggable")))),Ai.createElement(Ax,{predicate:()=>this.sectionValues.arrowMode!==void 0},()=>Ai.createElement("div",null,()=>this.controller.s("graphing-calculator-text-geometry-arrow-mode",{mode:this.getArrowModeDisplayName()}))),Ai.createElement(Ax,{predicate:()=>this.controller.getGraphSettings().config.expressions},()=>Ai.createElement(NT,{controller:this.props.controller})),Ai.createElement(Ax,{predicate:()=>this.sectionValues.graphInteractionDisabled!==void 0&&this.props.controller().shouldShowAuthorFeatures()},()=>Ai.createElement("div",{class:Ai.const("dcg-checkbox-section dcg-disable-graph-interactions")},Ai.createElement(xt,{checked:()=>!!this.sectionValues.graphInteractionDisabled,onChange:()=>this.toggleGraphInteractionsDisabled(),ariaLabel:()=>this.controller.s("graphing-calculator-label-disable-graph-interactions")},()=>this.controller.s("graphing-calculator-label-disable-graph-interactions"))))))}toggleGraphInteractionsDisabled(){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"disableGraphInteractions",value:!this.sectionValues.graphInteractionDisabled}})}onShowPointLabelChanged(){this.controller.dispatch({type:"toggle-label-for-all-selected-points"})}onDraggableFreePointChanged(e){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"dragMode",value:e?"XY":"NONE"}})}cacheSectionValues(){this.sectionValues=this.computeSectionValues()}computeSectionValues(){var n;let e={showPointLabels:[],singleLabelableExpressionModel:[],draggableFreePoint:[],arrowMode:[],graphInteractionDisabled:[]},t=this.controller.getAllSelectedItems();for(let a of t){e.graphInteractionDisabled.push(Yl(a));let s=a.type==="expression"?(n=a.formula.geometry)==null?void 0:n.valueType:void 0;if(__dcg_shared_module_exports__['db'](s)&&(s=__dcg_shared_module_exports__['eb'](s)),a.type==="expression"&&__dcg_shared_module_exports__['fb'](s))switch(s){case __dcg_shared_module_exports__['va']:e.showPointLabels.push(a.showLabel),e.singleLabelableExpressionModel.push(a),a.formula.move_strategy&&e.draggableFreePoint.push(a.dragMode!=="NONE");break;case __dcg_shared_module_exports__['Da']:break;case __dcg_shared_module_exports__['Ja']:e.arrowMode.push(a.arrowMode);break;case __dcg_shared_module_exports__['Ha']:break;case __dcg_shared_module_exports__['La']:break;case __dcg_shared_module_exports__['Na']:break;case __dcg_shared_module_exports__['Va']:break;case __dcg_shared_module_exports__['Fa']:e.singleLabelableExpressionModel.push(a),e.arrowMode.push(a.arrowMode);break;case __dcg_shared_module_exports__['Pa']:case __dcg_shared_module_exports__['Ra']:e.singleLabelableExpressionModel.push(a);break;case __dcg_shared_module_exports__['Ta']:break;default:return s}}let i={},o=t.length;for(let a in e){let s=a;switch(s){case"singleLabelableExpressionModel":{let c=e[s];o===1&&c.length===1&&(i[s]=c[0])}break;case"showPointLabels":{let c=e[s];c.length>0&&o>1&&(i[s]=__dcg_shared_module_exports__['j'](c,d=>!!d))}break;case"draggableFreePoint":{let c=e[s];c.length>0&&(i[s]=__dcg_shared_module_exports__['k'](c))}break;case"arrowMode":break;case"graphInteractionDisabled":{i[s]=e[s].every(c=>c);break}default:return s}}return i}getArrowModeDisplayName(){let e=this.sectionValues.arrowMode;if(!e)return"";switch(e){case"NONE":return this.controller.s("graphing-calculator-text-arrow-mode-none");case"DEFAULT":return this.controller.s("graphing-calculator-text-arrow-mode-default");case"POSITIVE":return this.controller.s("graphing-calculator-text-arrow-mode-positive");case"BOTH":return this.controller.s("graphing-calculator-text-arrow-mode-both")}}};var zr=__dcg_shared_module_exports__['e'](te());var e1={};__dcg_shared_module_exports__['d'](e1,{CLCalculator:()=>O6,Label:()=>__dcg_shared_module_exports__['zb'],applyDiff:()=>U6,applyLocalizationMap:()=>q6,blankGeometryCalculatorState:()=>Gne,blankGraphingCalculatorState:()=>kne,builtInFrame:()=>Ene,calculateDiff:()=>N6,colorHelpers:()=>__dcg_shared_module_exports__['Y'],context:()=>Cne,expressionParser:()=>l2,extractLocalizationMap:()=>K6,formatLatex:()=>j6,migrateGeoStateToCalcState:()=>fh,migrateToLatest:()=>Wd,numberToDecimalString:()=>__dcg_shared_module_exports__['Oc'],numberToLatex:()=>__dcg_shared_module_exports__['Nc'],parseNodes:()=>iW,parser:()=>wne,policies:()=>Dne,replaceIdentifierWithLatex:()=>f_,treeQueries:()=>vne,types:()=>Sne});function zO(){return{type:"folder",id:__dcg_shared_module_exports__['jd'],title:"geometry",secret:!0}}var Vx={version:ed,randomSeed:"",graph:{viewport:{xmin:-10,ymin:-13.25,xmax:10,ymax:13.25},showGrid:!1,product:"geometry-calculator",showXAxis:!1,showYAxis:!1,degreeMode:!0},expressions:{list:[zO(),{id:"1",type:"expression"}]}};function $ie(r){typeof r.min=="number"&&(r.min=""+r.min),typeof r.max=="number"&&(r.max=""+r.max),typeof r.step=="number"&&(r.step=""+r.step)}function jie(r){r.slider&&$ie(r.slider),typeof r.id!="string"&&(r.id=""+r.id)}function Yie(r,e){let t=Xie(r)+1,i={},o,n;for(let a of r)if(jie(a),a.type==="folder")o=a.id,i[a.id]&&(a.id=""+t,t+=1),n=a.id,i[a.id]=!0,a.hasOwnProperty("folderId")&&delete a.folderId;else{if(o!==void 0&&a.folderId===o?a.folderId=n:(a.folderId&&(a.folderId=""),o=void 0,n=void 0),a.type==="table"&&Array.isArray(a.columns))for(let s of a.columns)i[s.id]&&(s.id=""+t,t+=1),i[s.id]=!0;i[a.id]&&(a.id=""+t,t+=1),i[a.id]=!0}e==="geometry-calculator"&&!i[__dcg_shared_module_exports__['jd']]&&r.push(zO())}function y6(r,e){let t=parseFloat(e);return t!==Math.floor(t)?r:Math.max(r,t)}function Xie(r){let e=0;for(let t of r)if(e=y6(e,t.id),t.type==="table"&&Array.isArray(t.column))for(let i of t.columns)y6(e,i.id);return e}function HT(r){let e=__dcg_shared_module_exports__['Z'](r),t=e.graph&&e.graph.product,i=e.expressions.list;return Array.isArray(i)&&Yie(i,t),e}var KO={NONE:"NONE",POSITIVE:"POSITIVE",BOTH:"BOTH"},Jie={expression:!0,table:!0,image:!0,folder:!0,text:!0};function Qie(r){if(r.type){if(Jie.hasOwnProperty(r.type))return r.type;throw new Error("Invalid item type: '"+r.type+"'.")}return r.text!==void 0?"text":r.columns!==void 0||r.headings!==void 0?"table":"expression"}function WT(r){return r.replace(/\\(total|length|mean|median|quantile|stdev|stddev|stdDev|stdevp|stddevp|stdDevP|var|variance|cov|corr|ceil|floor|round|abs|mod|lcm|mcm|mcd|nCr|nPr|signum|sign|arcsinh|arccosh|arctanh|arccsch|arcsech|arccoth|arccsc|arcsec|arccot)/g,"\\operatorname{$1}")}function Zie(r){var e={};for(var t in r)r.hasOwnProperty(t)&&(t==="latex"?e[t]=WT(r[t]):t==="values"?e[t]=r[t].map(WT):e[t]=r[t]);return e}function eoe(r){var e=Qie(r),t={},i;switch(e){case"expression":for(i in r)r.hasOwnProperty(i)&&(i==="latex"?t[i]=WT(r[i]):t[i]=r[i]);return t.type=e,t;case"table":for(i in r)r.hasOwnProperty(i)&&(i==="columns"?t[i]=r[i].map(Zie):t[i]=r[i]);return t.type=e,t;case"image":for(i in r)r.hasOwnProperty(i)&&(i==="width"||i==="height"||i==="x"||i==="y"?t[i]=WT(r[i]):t[i]=r[i]);return t.type=e,t;case"text":case"folder":for(i in r)r.hasOwnProperty(i)&&(t[i]=r[i]);return t.type=e,t}}var x6={none:KO.NONE,both:KO.BOTH,positive:KO.POSITIVE};function toe(r){var e={};for(var t in r)r.hasOwnProperty(t)&&(t==="xAxisArrows"||t==="yAxisArrows"||(e[t]=r[t]));return e.xAxisArrowMode=x6[r.xAxisArrows||"none"],e.yAxisArrowMode=x6[r.yAxisArrows||"none"],e}function w6(r){if(r.version)throw new Error("Unexpected version: "+r.version);var e={};return e.graph=toe(r.graph),e.expressions={list:r.expressions.list.map(eoe)},e.version=0,e}var roe=1;function $T(r){return r.replace(/\\(sech|csch)/g,"\\operatorname{$1}")}function ioe(r){var e={};for(var t in r)r.hasOwnProperty(t)&&(t==="latex"?e[t]=$T(r[t]):t==="values"?e[t]=r[t].map($T):e[t]=r[t]);return e}function ooe(r){var e=r.type,t={},i;switch(e){case"expression":for(i in r)r.hasOwnProperty(i)&&(i==="latex"?t[i]=$T(r[i]):t[i]=r[i]);return t;case"table":for(i in r)r.hasOwnProperty(i)&&(i==="columns"?t[i]=r[i].map(ioe):t[i]=r[i]);return t;case"image":for(i in r)r.hasOwnProperty(i)&&(i==="width"||i==="height"||i==="x"||i==="y"?t[i]=$T(r[i]):t[i]=r[i]);return t;case"text":case"folder":for(i in r)r.hasOwnProperty(i)&&(t[i]=r[i]);return t;default:throw new Error("Unexpected expression type: "+e)}}function v6(r){if(r.version)throw new Error("Unexpected version: "+r.version);var e={};return e.graph=r.graph,e.expressions={list:r.expressions.list.map(ooe)},e.version=roe,e}var noe=2,aoe="#C0504D",soe="#4F81BD",loe="#9BBB59",coe="#8064A2",doe="#F79646",poe="#000000";function C6(r){switch(r){case aoe:return __dcg_shared_module_exports__['W'].RED;case soe:return __dcg_shared_module_exports__['W'].BLUE;case loe:return __dcg_shared_module_exports__['W'].GREEN;case coe:return __dcg_shared_module_exports__['W'].PURPLE;case doe:return __dcg_shared_module_exports__['W'].ORANGE;case poe:return __dcg_shared_module_exports__['W'].BLACK;default:return r}}function uoe(r){var e={};for(var t in r)r.hasOwnProperty(t)&&(t==="color"?e[t]=C6(r[t]):e[t]=r[t]);return e}function hoe(r){var e=r.type,t={},i;switch(e){case"expression":for(i in r)r.hasOwnProperty(i)&&(i==="color"?t[i]=C6(r[i]):t[i]=r[i]);return t;case"table":for(i in r)r.hasOwnProperty(i)&&(i==="columns"?t[i]=r[i].map(uoe):t[i]=r[i]);return t;case"image":case"text":case"folder":for(i in r)r.hasOwnProperty(i)&&(t[i]=r[i]);return t;default:throw new Error("Unexpected expression type: "+e)}}function E6(r){if(r.version>1)throw new Error("Unexpected version: "+r.version);var e={};return e.graph=r.graph,e.expressions={list:r.expressions.list.map(hoe)},e.version=noe,e}var goe=3;function qO(r){if(typeof r=="string")return r;if(r===void 0)return"";var e=r+"";return e=e.replace(/1e\+?([-\d]+)/,"10^{$1}"),e=e.replace(/([-\d\.]+)e\+?([-\d]+)/,"$1\\cdot 10^{$2}"),e}function moe(r){var e=r.type,t={},i;switch(e){case"expression":for(i in r)r.hasOwnProperty(i)&&(i==="sliderMax"||i==="sliderMin"||i==="sliderInterval"?t[i]=qO(r[i]):i==="domain"?t[i]={max:qO(r[i].max),min:qO(r[i].min)}:t[i]=r[i]);return t.hasOwnProperty("sliderMin")&&t.sliderInterval===void 0&&(t.sliderInterval=""),t;case"image":case"table":case"text":case"folder":for(i in r)r.hasOwnProperty(i)&&(t[i]=r[i]);return t;default:throw new Error("Unexpected expression type: "+e)}}function S6(r){if(r.version>2)throw new Error("Unexpected version: "+r.version);var e={};return e.graph=r.graph,e.expressions={list:r.expressions.list.map(moe)},e.version=goe,e}var foe=4;function D6(r){switch(r){case"point":return"POINT";case"cross":return"CROSS";case"open":return"OPEN";case"normal":return"SOLID";case"dashed":return"DASHED";case"dotted":return"DOTTED";default:return r}}function boe(r){var e={};for(var t in r)r.hasOwnProperty(t)&&(t==="style"?e[t]=D6(r[t]):e[t]=r[t]);return e}function yoe(r){var e=r.type,t={},i;switch(e){case"expression":for(i in r)r.hasOwnProperty(i)&&(i==="style"?t[i]=D6(r[i]):t[i]=r[i]);return t;case"table":for(i in r)r.hasOwnProperty(i)&&(i==="columns"?t[i]=r[i].map(boe):t[i]=r[i]);return t;case"image":case"text":case"folder":for(i in r)r.hasOwnProperty(i)&&(t[i]=r[i]);return t;default:throw new Error("Unexpected expression type: "+e)}}function k6(r){if(r.version!==3)throw new Error("Unexpected version: "+r.version);var e={};return e.graph=r.graph,e.expressions={list:r.expressions.list.map(yoe)},e.version=foe,e}function xoe(r){var e={},t;for(var i in r)if(r.hasOwnProperty(i))switch(t=r[i],i){case"showAxes":e.showXAxis=t,e.showYAxis=t;break;case"showLabels":e.xAxisNumbers=t,e.yAxisNumbers=t,e.polarNumbers=t;break;case"labelXMode":e.xAxisStep=t==="pi"?Math.PI:0;break;case"labelYMode":e.yAxisStep=t==="pi"?Math.PI:0;break;default:e[i]=t}return e}function woe(r){var e={};for(var t in r)r.hasOwnProperty(t)&&(t==="showPoints"||t==="showLine"||(e[t]=r[t]));return(r.showPoints!==void 0||r.showLine!==void 0)&&(r.showPoints&&r.showLine?e.columnMode="POINTS_AND_LINES":r.showPoints?e.columnMode="POINTS":r.showLine?e.columnMode="LINES":(e.hidden=!0,e.columnMode="POINTS")),e}function voe(r){var e=r.type,t={},i;switch(e){case"expression":r.hidden===void 0?r.hasOwnProperty("graphed")?t.hidden=!r.graphed:r.hasOwnProperty("userRequestedGraphing")?t.hidden=r.userRequestedGraphing==="never":t.hidden=!1:t.hidden=r.hidden;for(i in r)if(r.hasOwnProperty(i)&&!(i==="graphed"||i==="userRequestedGraphing"||i==="hidden")&&i!=="slider"){if(i==="color"){typeof r.color=="object"?t.color=r.color.value:t.color=r.color;continue}if(i==="style"){t.style=r.style==="normal"?"SOLID":r.style;continue}if(i==="sliderInterval"){t.sliderInterval=r.sliderInterval==="undefined"?"":r.sliderInterval;continue}t[i]=r[i]}return t;case"table":if(r.headings||r.columns){var o=r.headings?r.headings:r.columns;if(t.columns=o.map(woe),r.rows)for(var n=0;n<t.columns.length;n++){var a=t.columns[n];a.values=[];for(var s=0;s<r.rows.length;s++)a.values.push(r.rows[s][n])}}for(i in r)r.hasOwnProperty(i)&&(i==="rows"||i==="headings"||i==="columns"||(t[i]=r[i]));return t;case"image":case"text":case"folder":for(i in r)r.hasOwnProperty(i)&&(t[i]=r[i]);return t;default:throw new Error("Unexpected expression type: "+e)}}function G6(r){if(r.version!==4)throw new Error("Unexpected version: "+r.version);var e={version:5,graph:xoe(r.graph),expressions:{list:r.expressions.list.map(voe)}};return e}var Coe=6;function Eoe(r){return r.length<2?!1:r[0]==="`"&&r[r.length-1]==="`"}function Soe(r){if(Eoe(r))return{raw:r,parts:[r]};for(var e=["[a-zA-Z][0-9]*","[a-zA-Z]_[a-zA-Z0-9]+","[a-zA-Z]_\\{[a-zA-Z0-9]+\\}"],t="({"+e.join("})|({")+"})",i=new RegExp(t,"g"),o=[],n=0,a=0,s;s=i.exec(r);){a=s.index,a>n&&o.push(r.substr(n,a-n));var l=s[0],c=l.replace(/[{}\$]/g,"").replace(/^([a-zA-Z])([0-9]+)$/,"$1_$2");o.push({symbol:c,str:l}),n=s.index+l.length}return n<r.length&&o.push(r.substr(n)),{raw:r,parts:o}}function Doe(r){var e={};for(var t in r)if(r.hasOwnProperty(t)&&t!=="style")if(t==="values"&&(e[t]=r[t].map(function(i){return i?""+i:""})),t==="columnMode"&&!r.hasOwnProperty("points")&&!r.hasOwnProperty("lines"))switch(r[t]){case"LINES":e.points=!1,e.lines=!0;break;case"POINTS_AND_LINES":e.points=!0,e.lines=!0;break;default:e.points=!0,e.lines=!1}else e[t]=r[t];return e.hasOwnProperty("pointStyle")||(e.pointStyle="POINT"),e.hasOwnProperty("lineStyle")||(e.lineStyle="SOLID"),e.id=""+e.id,e}var T6={sliderMin:"min",sliderMax:"max",sliderInterval:"step",sliderHardMin:"hardMin",sliderHardMax:"hardMax",sliderAnimationPeriod:"animationPeriod",sliderLoopMode:"loopMode",sliderPlayDirection:"playDirection",sliderIsPlaying:"isPlaying"};function koe(r){var e=Soe(r),t="";return __dcg_shared_module_exports__['g'](e.parts,function(i){t+=typeof i=="object"&&i.str?"$"+i.str:i}),t}function Goe(r,e){var t=r.latex.split("=");if(t.length===2){var i=Bi(t[1],e);if(isFinite(i)){var o=r.slider.hardMin?Bi(r.slider.min||"-10",e):void 0,n=r.slider.hardMax?Bi(r.slider.max||"10",e):void 0,a=r.slider.step?Bi(r.slider.step,e):void 0,s=__dcg_shared_module_exports__['lc']({target:i,step:a,hardMin:o,hardMax:n});s.min||(delete r.slider.hardMin,delete r.slider.min),s.max||(delete r.slider.hardMax,delete r.slider.max),s.step||delete r.slider.step}}}function Toe(r,e,t,i){var o=r.type,n={},a;switch(o){case"folder":for(a in r)r.hasOwnProperty(a)&&(a==="memberIds"||(n[a]=r[a]));break;case"expression":for(a in r)if(r.hasOwnProperty(a)){if(a==="style"&&!r.hasOwnProperty("pointStyle")&&!r.hasOwnProperty("lineStyle")){var s=r[a];__dcg_shared_module_exports__['l'](["POINT","OPEN","CROSS"],s)?(n.pointStyle=s,n.lineStyle="SOLID"):__dcg_shared_module_exports__['l'](["SOLID","DASHED","DOTTED"],s)?(n.pointStyle="POINT",n.lineStyle=s):(n.pointStyle="POINT",n.lineStyle="SOLID");continue}T6.hasOwnProperty(a)?(n.slider=n.slider||{},n.slider[T6[a]]=r[a]):n[a]=r[a],r.label&&(n.label=koe(r.label))}n.latex&&n.slider&&!n.slider.isPlaying&&Goe(n,i),n.hasOwnProperty("fillOpacity")||(n.fillOpacity=.4),n.label===!1&&(n.label=""),n.labelSize||(n.labelSize="medium"),n.labelOrientation||(n.labelOrientation="default"),n.verticalLabel||(n.verticalLabel=!1),n.interactiveLabel||(n.interactiveLabel=!1);break;case"image":for(a in r)!r.hasOwnProperty(a)||a==="x"||a==="y"||(n[a]=r[a]);n.center="\\left("+(r.x||"0")+","+(r.y||"0")+"\\right)",n.angle=r.angle||"0",n.foreground=!!n.foreground;break;case"text":for(a in r)r.hasOwnProperty(a)&&(n[a]=r[a]);break;case"table":for(a in r)r.hasOwnProperty(a)&&(a==="columns"?n[a]=r[a].map(Doe):n[a]=r[a]);break;default:throw new Error("Unexpected expression type: "+o)}if(n.id=""+n.id,r.type==="folder")e.folderId=n.id,e.memberIds=r.memberIds,n.folderId="";else{var l=t[n.id];e.memberIds&&e.memberIds[l]?n.folderId=e.folderId:(n.folderId="",e.folderId=void 0,e.memberIds=void 0)}return n}function Moe(r){for(var e=0,t=/^[0-9]+$/,i=r.length-1;i>=0;i--){var o=r[i],n=o.id,a;if(t.test(n)&&(a=parseInt(n,10),a>e&&(e=a)),o.type==="table"&&o.columns)for(var s=o.columns.length-1;s>=0;s--)n=o.columns[s].id,t.test(n)&&(a=parseInt(n,10),a>e&&(e=a))}return e+1}function M6(r){if(r.version!==5)throw new Error("Unexpected version: "+r.version);var e=!!(r.graph&&r.graph.degreeMode),t=r.expressions.list,i=-1,o={},n={},a={};return{version:Coe,graph:r.graph,expressions:{list:t.map(function(l){return o[l.id]?(i===-1&&(i=Moe(t)),n[i]=l.id,l=__dcg_shared_module_exports__['Z'](l),l.id=i+"",i+=1):n[l.id]=l.id,o[l.id]=!0,Toe(l,a,n,e)})}}}function HO(r){if(r.version!==6)throw new Error(`Unexpected version: ${r.version}`);let e=r.expressions.list.map(t=>{if(t.type==="expression"&&t.domain){let i={...t,parametricDomain:{min:t.domain.min,max:t.domain.max}};return delete i.domain,i}return t});return{version:7,randomSeed:r.randomSeed,graph:r.graph,expressions:{list:e}}}function Ioe(r){return r.length===1?`0${r}`:r}function Xp(){let r=new Uint8Array(16);if(typeof crypto!="undefined")crypto.getRandomValues(r);else if(typeof msCrypto!="undefined")msCrypto.getRandomValues(r);else return __dcg_shared_module_exports__['la'](Date.now().toString()+Math.random().toString());return Array.prototype.slice.call(r).map(t=>Ioe(t.toString(16))).join("")}function WO(r){let e=r.split("_");return e.length===2&&e[1]&&e[1].length===1?e[0]+"_{"+e[1]+"}":r}function I6(r){return r=__dcg_shared_module_exports__['Z'](r),!r.rules&&(r.assignment||r.expression)&&(r.rules=[{id:"1",assignment:r.assignment||"",expression:r.expression||""}]),delete r.assignment,delete r.expression,r}function WC(r){let e=/\\operatorname(?:\{stdev\}p|\{stddev\}p|\{stdDev\}P|\{var\}iance)/g;return r.replace(e,t=>{switch(t){case"\\operatorname{stdev}p":return"\\operatorname{stdevp}";case"\\operatorname{stddev}p":return"\\operatorname{stddevp}";case"\\operatorname{stdDev}P":return"\\operatorname{stdDevP}";case"\\operatorname{var}iance":return"\\operatorname{variance}";default:return""}})}function Aoe(r){return r.columns?{...r,columns:r.columns.map(Voe)}:r}function Voe(r){let{latex:e,values:t}=r,i={...r};return e&&(i.latex=WC(e),i.latex=WO(i.latex)),t&&(i.values=t.map(function(o){return o?WC(o):""})),i}function $O(r){if(r.version!==7)throw new Error(`Unexpected version: ${r.version}`);let e=r.expressions.list.map(t=>{if(t.type==="image"){let i={...t,opacity:""};t.hasOwnProperty("stringOpacity")?i.opacity=t.stringOpacity:t.hasOwnProperty("opacity")?i.opacity=t.opacity+"":delete i.opacity,t.clickableInfo&&(i.clickableInfo=I6(t.clickableInfo)),delete i.stringOpacity;for(let o in t)if(o==="x"||o==="y"||o==="width"||o==="height"){let n=t[o];n&&(i[o]=WC(n))}return i}else if(t.type==="expression"){let i={...t,fillOpacity:"",lineStyle:"SOLID"};if(t.lineStyle==="SINGLE_PIXEL"?i.lineWidth="1":t.hasOwnProperty("lineStyle")?i.lineStyle=t.lineStyle:delete i.lineStyle,i.hasOwnProperty("lineWidth")||(i.lineWidth=""),i.hasOwnProperty("lineOpacity")||(i.lineOpacity=""),i.hasOwnProperty("pointOpacity")||(i.pointOpacity=""),i.hasOwnProperty("pointSize")||(i.pointSize=""),i.hasOwnProperty("colorLatex")||(i.colorLatex=""),typeof t.latex=="string"&&(i.latex=WC(t.latex)),t.latex&&(i.latex=WC(t.latex)),t.hasOwnProperty("stringFillOpacity")?i.fillOpacity=t.stringFillOpacity:t.hasOwnProperty("fillOpacity")?i.fillOpacity=t.fillOpacity+"":delete i.fillOpacity,i.slider&&t.slider&&t.slider.newLoopMode&&(i.slider=__dcg_shared_module_exports__['Z'](i.slider),i.slider.loopMode=t.slider.newLoopMode,delete i.slider.newLoopMode),i.residualVariable&&(i.residualVariable=WO(i.residualVariable)),i.regressionParameters){i.regressionParameters={};for(let o in t.regressionParameters){let n=WO(o),a=t.regressionParameters[o];i.regressionParameters[n]=a}}return t.clickableInfo&&(i.clickableInfo=I6(t.clickableInfo)),i}else if(t.type==="table")return Aoe(t);return t});return{version:8,randomSeed:r.randomSeed||Xp(),graph:r.graph,expressions:{list:e}}}function Loe(r,e,t){if(r.verticalLabel)switch(delete e.verticalLabel,t?e.labelAngle="90":e.labelAngle="\\frac{\\pi}{2}",r.labelOrientation){case"above":e.labelOrientation="right";break;case"below":e.labelOrientation="left";break;case"left":e.labelOrientation="above";break;case"right":e.labelOrientation="below";break}r.extendedLabelOrientation&&(e.labelOrientation=r.extendedLabelOrientation,delete e.extendedLabelOrientation)}function Poe(r,e){if(r.vizProps)switch(r.vizProps.dotplotSize){case"small":e.pointSize="9";break;case"large":e.pointSize="20";break}if(r.vizProps){let t={...r.vizProps};delete t.dotplotSize,Object.keys(t).length?e.vizProps=t:delete e.vizProps}}function jO(r){return r.filter(({assignment:e,expression:t})=>!!e&&!!t)}function YO(r){return r.map(({assignment:e,expression:t})=>`${e}\\to ${t}`).join(",")||""}function XO(r){let e=JSON.stringify(r),t=/_(\d)|_\{(\d+)\}/g,i,o={};for(;(i=t.exec(e))!==null;){let n=i[1]!==void 0?i[1]:i[2];o[n]=!0}return o}function JO(r,e){for(let t=e+1;;t++)if(!r[t])return t}function A6(r){let e=JSON.stringify(r),t=/"(\d+)"/g,i,o={};for(;(i=t.exec(e))!==null;){let n=i[1]!==void 0?i[1]:i[2];o[n]=!0}return o}function V6(r,e){for(let t=e+1;;t++)if(!r[t])return t}function _oe(r){if(/^\d+$/.test(r)){let e=parseInt(r,10);return e===0?"\\infty":""+Math.round(1e3/e)}else return`\\frac{1000}{${r}}`}function Ooe(r,e){let t={handlerLatex:r,playing:!0,open:!0};return e!==void 0&&(t.minStepLatex=_oe(e)),t}function QO(r){if(r.version!==8)throw new Error(`Unexpected version: ${r.version}`);var e=!1;r.graph&&r.graph.degreeMode&&(e=!0);let t=r.expressions.ticker||jy,i=0,o,n=0,a,s=[];for(let l of r.expressions.list)switch(l.type){case"expression":{let c={...l};Loe(l,c,e),Poe(l,c);let d;if(l.clickableInfo&&l.clickableInfo.rules){let{rules:p,...g}=l.clickableInfo,h=g,f=jO(p),y=YO(f);if(f.length>1){o||(o=XO(r)),i=JO(o,i),a||(a=A6(r)),n=V6(a,n);let x=`A_{${i}}`;h.latex=x,d={type:"expression",id:""+n,latex:`${x}=${y}`},l.folderId!==void 0&&(d.folderId=l.folderId)}else h.latex=y;c.clickableInfo=h}c.clickableInfo&&c.clickableInfo.enabled&&c.hidden&&(c.clickableInfo.enabled=!1),s.push(c),d&&s.push(d);break}case"image":{if(l.clickableInfo&&l.clickableInfo.rules){let c={...l},{rules:d,...p}=l.clickableInfo,g=p,h=jO(d),f=YO(h),y;if(h.length>1){o||(o=XO(r)),i=JO(o,i),a||(a=A6(r)),n=V6(a,n);let x=`A_{${i}}`;g.latex=x,y={type:"expression",id:""+n,latex:`${x}=${f}`},l.folderId!==void 0&&(y.folderId=l.folderId)}else g.latex=f;c.clickableInfo=g,s.push(c),y&&s.push(y)}else s.push(l);break}case"simulation":{let c;if(l.clickableInfo&&l.clickableInfo.rules){let p=jO(l.clickableInfo.rules);c=YO(p)}else c="";if(l.isPlaying&&c!==""){o||(o=XO(r)),i=JO(o,i);let p=`A_{${i}}`;c=`${p}=${c}`,t=Ooe(p,l.fps)}let d={type:"expression",id:l.id,latex:c};l.folderId!==void 0&&(d.folderId=l.folderId),s.push(d);break}default:s.push(l);break}return{version:9,randomSeed:r.randomSeed||Xp(),graph:r.graph,expressions:{list:s,ticker:t}}}function L6(r){r.clickableInfo&&(r.description===void 0&&r.clickableInfo.description!==void 0&&(r.description=r.clickableInfo.description),delete r.clickableInfo.description,Object.keys(r.clickableInfo).length===0&&delete r.clickableInfo)}function Roe(r){switch(r.labelSize){case"small":r.labelSize="0.85";break;case"medium":r.labelSize="1";break;case"large":r.labelSize="1.35";break;default:break}}function Foe(r){let e=0,t=/^[0-9]+$/;for(var i=r.length-1;i>=0;i--){var o=r[i];let n=o.id;if(t.test(n)){let a=parseInt(n,10);a>e&&(e=a)}if(o.type==="table"&&o.columns){for(let a=o.columns.length-1;a>=0;a--)if(n=o.columns[a].id,!!n&&t.test(n)){let s=parseInt(n,10);s>e&&(e=s)}}}return e}function ZO(r){if(r.version!==9)throw new Error(`Unexpected version: ${r.version}`);let e=[],t={},i=Foe(r.expressions.list);for(let n of r.expressions.list)switch(n.type){case"expression":{let l={...n};L6(l),Roe(l),e.push(l);break}case"image":{let l={...n};L6(l);let c=l.description;(c===void 0||c==="")&&l.draggable&&l.center!==void 0&&l.center!==""&&(t[l.center]===void 0?t[l.center]=[l]:t[l.center].push(l)),e.push(l);break}case"table":let a={...n};if(!a.columns||!ul(a.columns[0].latex)){e.push(a);break}let s=a.columns[0].latex;for(let l=1;l<a.columns.length;l++){let c=a.columns[l];if(!c.lines||!Od(c.latex,s))continue;delete c.lines,i++;let d={type:"expression",latex:"y="+Dk(c.latex,s,"x"),id:`${i}`};c.color&&(d.color=c.color),c.lineStyle&&(d.lineStyle=c.lineStyle),c.lineWidth&&(d.lineWidth=c.lineWidth),c.lineOpacity&&(d.lineOpacity=c.lineOpacity),e.push(d)}e.push(a);break;default:e.push(n);break}for(let n of e){if(n.type!=="expression"||n.latex===void 0||n.latex===""||n.latex.indexOf("=")===-1||n.dragMode===void 0||n.dragMode==="NONE"||n.label===void 0||n.label==="")continue;let a=n.latex.slice(0,n.latex.indexOf("=")),s=t[a];if(s!==void 0)for(let l of s)l.description=n.label}return{...r,version:10,expressions:{...r.expressions,list:e}}}function Noe(r){let e=/[ \\]*=[ \\]*\\operatorname\{(dilation|reflection|rotation|translation)\}\\left\(/g;return r.type!=="expression"||!r.latex||(r.latex=r.latex.replace(e,(t,i)=>{switch(i){case"dilation":return"\\left(x\\right)=\\operatorname{dilate}\\left(x,";case"rotation":return"\\left(x\\right)=\\operatorname{rotate}\\left(x,";case"reflection":return"\\left(x\\right)=\\operatorname{reflect}\\left(x,";case"translation":return"\\left(x\\right)=\\operatorname{translate}\\left(x,";default:return""}})),r}function Boe(r,e){var t;if(r.type==="image"&&r.folderId&&!r.draggable&&!((t=r.clickableInfo)!=null&&t.enabled)&&e.has(r.folderId)&&r.disableGraphInteractions!==!1){let i={...r};return i.disableGraphInteractions=!0,i}else return r}function Uoe(r){var a;if(r.type!=="expression")return r;let e={...r};var t=(a=(r.latex||"").split("=")[0])==null?void 0:a.trim();let i=r.parametricDomain3Du,o=r.parametricDomain3Dv,n=r.parametricDomain;return t==="r"||(t==="z"?(i&&(e.parametricDomain3Dr={...i}),o&&(e.polarDomain={...o})):t==="\\rho"?(i&&(e.polarDomain={...i}),o&&(e.parametricDomain3Dphi={...o})):r.polarDomain||n&&(e.parametricDomain3Du={...n},e.parametricDomain3Dv={...n})),e}function e2(r){if(r.version!==10)throw new Error(`Unexpected version: ${r.version}`);let e={...r.graph};delete e.projectorMode;let t={...r.expressions},i=[],o=new Set;for(let n of t.list)n.type==="folder"&&n.collapsed&&o.add(n.id);for(let n of t.list)switch(n.type){case"expression":{if((e==null?void 0:e.product)==="geometry-calculator"){let a={...n};Noe(a),i.push(a)}else if((e==null?void 0:e.product)==="graphing-3d"){let a=Uoe(n);i.push(a)}else i.push(n);break}case"image":{i.push(Boe(n,o));break}default:i.push(n)}return t.list=i,{...r,version:11,graph:e,expressions:t}}function t2(r){if(r.version!==11)throw new Error(`Unexpected version: ${r.version}`);return{...r,version:12}}function P6(r){return{...r,version:11}}var r2=[w6,v6,E6,S6,k6,G6,M6,HO,$O,QO,ZO,e2,t2];var ed=12;function Wd(r){if(r.version>ed)return typeof console!="undefined"&&console.warn&&console.warn("Loading saved state with version "+r.version+" but last known version is "+ed+". States saved in a newer version of the calculator may not load correctly in an older version of the calculator."),HT(r);if(r.hasOwnProperty("version")&&!r2[r.version])return typeof console!="undefined"&&console.warn&&console.warn("State has invalid version "+r.version+". If a version is present, it should be a non-negative integer less than or equal to "+ed+"."),HT(r);for(r.hasOwnProperty("version")||(r=r2[0](r));r.version<ed;)r=r2[r.version+1](r);return HT(r)}function zoe(r){return P6(r)}function _6(r){return zoe(Wd(r))}function O6(r){let e=Wd(r);var t={},i=e.graph.degreeMode,o=e.randomSeed;let n=e.graph.product==="graphing"?"graphing":"geometry";function a(l){switch(l.type){case void 0:case"expression":{let d=__dcg_shared_module_exports__['td'](__dcg_shared_module_exports__['pd'](l,{is3d:!1}));t[d.id]=d}break;case"table":{let d=JG(XG(l));t[d.id]=d}break;case"image":{let d=pG(dG(l));t[d.id]=d;break}case"folder":case"text":break;default:return l}}for(var s of e.expressions.list)a(s);if(e.version>=10&&e.expressions.ticker){let l="dcg_ticker_guid_internal",c={...wG(e.expressions.ticker),id:l};t[l]=xG(c)}return{setExpression(l){a(l)},getChangeSet(){return{statements:t,isCompleteState:!0,degreeMode:i,globalRandomSeed:o,evaluationMode:n}}}}function jT(r,e){switch(r.type){case"Mul":case"DotMul":case"CrossMul":case"Div":case"Prime":case"Call":case"ImplicitCall":case"Dot":case"Pipes":case"Sqrt":case"Nthroot":case"Frac":case"Derivative":case"Integral":case"EmptyIntegral":case"Sum":case"Product":case"Piecewise":case"Paren":case"Juxt":case"Superscript":case"Bang":case"Index":case"Comparator":case"ComparatorChain":case"Tilde":case"Pos":case"Neg":case"Add":case"Sub":case"List":case"Seq":case"Colon":case"Ellipsis":case"PercentOf":case"RightArrow":case"For":case"With":{let i=0;for(let o of r.args)i+=jT(o,e);return i}case"Decimal":return e===void 0||parseFloat(r.val)===e?1:0;case"MixedNumber":{if(e===void 0)return 3;let i=0;return parseFloat(r.whole)===e&&(i+=1),parseFloat(r.num)===e&&(i+=1),parseFloat(r.den)===e&&(i+=1),i}case"Letter":case"EmptyPiecewise":case"Cmd":case"EmptyRangeEnd":return 0;case"Subscript":return jT(r.args[0],e);default:throw`Unexpected surface node ${r.type}.`}}function R6(r){let e=r.length,t=new Array(e),i=new Array(e+1),o=0;for(let s=0;s<e;s++){let l;if(r[i[o]]<r[s])l=o+1;else{let c=1,d=o-1;for(;c<=d;){let p=Math.ceil((c+d)/2);r[i[p]]<r[s]?c=p+1:d=p-1}l=c}t[s]=i[l-1],i[l]=s,l>o&&(o=l)}let n=new Array(o),a=i[o];for(let s=o-1;s>=0;s--)n[s]=r[a],a=t[a];return n}function N6(r,e){return YT(r,e,0)}function YT(r,e,t){let i={};for(let o in r){if(!r.hasOwnProperty(o))continue;if(!e.hasOwnProperty(o)){i[o]={d:1};continue}let n=r[o],a=e[o],s=Koe(n,a,t,o);s&&(i[o]=s)}for(let o in e)e.hasOwnProperty(o)&&!r.hasOwnProperty(o)&&(i[o]={s:e[o]});return i}function Koe(r,e,t,i){if(__dcg_shared_module_exports__['G'](r)&&__dcg_shared_module_exports__['G'](e)){if(t===1&&i==="list"||t===2&&i==="columns")return Hoe(r,e);if(!__dcg_shared_module_exports__['E'](r,e))return{s:e}}else if(__dcg_shared_module_exports__['H'](r)&&__dcg_shared_module_exports__['H'](e)){let o=YT(r,e,qoe(t,i));if(!__dcg_shared_module_exports__['F'](o))return{e:o}}else if(!__dcg_shared_module_exports__['E'](r,e))return{s:e}}function qoe(r,e){return r===0&&e==="expressions"?1:3}function Hoe(r,e){let t={},i={};for(let s=0;s<r.length;s++){if(i[r[s].id]!==void 0)return{s:e};i[r[s].id]=s}let o={};for(let s=0;s<e.length;s++){if(o[e[s].id]!==void 0)return{s:e};o[e[s].id]=s}let n=Woe(r,e,i),a=0;for(let s=0;s<r.length;s++){let l=r[s];if(!n[l.id])t[s]={d:1};else{let c=o[l.id],d=e[c],p={};if(a!==c&&(p.a=e.slice(a,c).map(g=>F6(r,i,g))),!__dcg_shared_module_exports__['E'](l,d)){let g=l.type==="table"&&d.type==="table";p.e=YT(l,d,g?2:3)}__dcg_shared_module_exports__['F'](p)||(t[s]=p),a=c+1}}if(a<e.length&&(t[r.length]={a:e.slice(a,e.length).map(s=>F6(r,i,s))}),!__dcg_shared_module_exports__['F'](t))return{l:t}}function F6(r,e,t){if(e[t.id]){let i=r[e[t.id]],o={f:e[t.id]};return __dcg_shared_module_exports__['E'](i,t)||(o.e=YT(i,t,3)),{m:o}}return{s:t}}function Woe(r,e,t){let i={},o=e.filter(a=>t[a.id]!==void 0).map(a=>t[a.id]),n=R6(o);for(let a of n)i[r[a].id]=!0;return i}function U6(r,e){let t=__dcg_shared_module_exports__['Z'](r);return XT(t,e)}function XT(r,e){for(let t of __dcg_shared_module_exports__['B'](e)){let i=e[t];joe(i)?r[t]=i.s:Yoe(i)?delete r[t]:Xoe(i)?r[t]=$oe(r[t],i.l):Joe(i)&&(r[t]=XT(r[t],i.e))}return r}function $oe(r,e){let t=[];for(let o=0;o<r.length;o++){let n=e[o];n&&n.a&&t.push(...B6(r,n.a)),n&&n.e?t.push(XT(r[o],n.e)):(!n||!n.d)&&t.push(r[o])}let i=e[r.length];return i&&i.a&&t.push(...B6(r,i.a)),t}function B6(r,e){let t=[];for(let i of e)if(Qoe(i))t.push(i.s);else if(Zoe(i)){let o=r[i.m.f];i.m.e?t.push(XT(o,i.m.e)):t.push(o)}return t}function joe(r){return r.hasOwnProperty("s")}function Yoe(r){return r.hasOwnProperty("d")}function Xoe(r){return r.hasOwnProperty("l")}function Joe(r){return r.hasOwnProperty("e")}function Qoe(r){return r.hasOwnProperty("s")}function Zoe(r){return r.hasOwnProperty("m")}function z6(r){return r.location==="expression"||r.location==="object"?`${r.location}:${r.id}:${r.path}`:`${r.location}:${r.path}`}function i2(r){let e=()=>new Error(`Invalid key: ${r}`),t=r.split(":"),i=t[0];if(!i||i!="expression"&&i!="settings"&&i!="object")throw e();if(i=="settings"){if(t.length!=2)throw e();return{location:i,path:t[1]}}if(t.length!=3)throw e();return{location:i,id:t[1],path:t[2]}}function JT(r,e,t){if(!r)return;let i=e.split("."),o=r;for(let n=0;n<i.length;n++){let a=i[n];if(!o[a])break;n==i.length-1&&typeof o[a]=="string"?o[a]=t:o=o[a]}}function o2(r,e){return(t,i,o,n)=>{if(t){let a=z6({...e,path:i});r[a]={value:t,type:o,context:n}}}}function ene(r){var i,o;let e={},t=o2(e,{location:"expression",id:r.id});switch(r.type){case"expression":t(r.label,"label","interpolated-string","expression-list-expression-label"),t(r.description,"description","string","expression-list-expression-clickable-description");break;case"image":t(r.image_url,"image_url","image","expression-list-image-url"),t(r.description,"description","string","expression-list-image-clickable-description"),t((i=r.clickableInfo)==null?void 0:i.hoveredImage,"clickableInfo.hoveredImage","image","expression-list-image-clickable-hovered"),t((o=r.clickableInfo)==null?void 0:o.depressedImage,"clickableInfo.depressedImage","image","expression-list-image-clickable-depressed");break;case"text":t(r.text,"text","string","expression-list-note-text");break;case"folder":t(r.title,"title","string","expression-list-folder-title");break}return e}function tne(r){let e={},t=o2(e,{location:"settings"});return t(r.graph.xAxisLabel,"xAxisLabel","string","settings-xaxis-label"),t(r.graph.yAxisLabel,"yAxisLabel","string","settings-yaxis-label"),e}function rne(r){let e={},t=o2(e,{location:"object",id:r.id});return t(r.label,"label","string","geometry-object-label"),r.type==="image"&&t(r.url,"url","image","geometry-object-image-url"),e}function K6(r){let e={};if(r.type=="graph"){let t=r.graphState.expressions.list;for(let o of t){let n=ene(o);for(let a in n)e[a]=n[a]}let i=tne(r.graphState);for(let o in i)e[o]=i[o]}else{let t=r.geometryState.objects;for(let i in t){let o=rne(t[i]);for(let n in o)e[n]=o[n]}}return e}function q6(r,e,t){var o;let i=__dcg_shared_module_exports__['Z'](r);if(t==="graph"){let n={},a=(o=i.expressions)==null?void 0:o.list,s=Array.isArray(a)?a:[];for(let l of s)n[l.id]=l;for(let l in e){let c=i2(l);c.location=="expression"?JT(n[c.id],c.path,e[l].value):JT(i.graph,c.path,e[l].value)}}else if(i.objects)for(let n in e){let a=i2(n);a.location=="object"&&JT(i.objects[a.id],a.path,e[n].value)}return i}function H6(r){return r==="<="?"\\le ":r===">="?"\\ge ":r}function mi(r){switch(r.type){case"Comparator":return Ka(r.args,H6(r.symbol));case"ComparatorChain":{let n="";for(let a=0;a<r.symbols.length;a++)n+=mi(r.args[a])+H6(r.symbols[a]);return n+=mi(r.args[r.args.length-1]),n}case"Tilde":return Ka(r.args,"~");case"Pos":return"+"+mi(r.args[0]);case"Neg":return"-"+mi(r.args[0]);case"Add":return Ka(r.args,"+");case"Sub":return Ka(r.args,"-");case"Mul":return Ka(r.args,"*");case"DotMul":return Ka(r.args,"\\cdot ");case"CrossMul":return Ka(r.args,"\\times ");case"Div":return Ka(r.args,"/");case"Bang":return mi(r.args[0])+"!";case"Call":let e=a2(r.args);return e?e.script+"\\left("+e.arg+"\\right)":mi(r.args[0])+"\\left("+mi(r.args[1])+"\\right)";case"Paren":return"\\left("+mi(r.args[0])+"\\right)";case"List":return"\\left["+r.args.map(mi).join(",")+"\\right]";case"Pipes":return"\\left|"+mi(r.args[0])+"\\right|";case"Index":return mi(r.args[0])+"\\left["+mi(r.args[1])+"\\right]";case"Subscript":return Ka(r.args,"_",!0);case"Superscript":return Ka(r.args,"^",!0);case"Prime":if(r.args[0].type==="Call"){let n=a2(r.args[0].args);return n?n.script+n2(r.nprimes)+"\\left("+n.arg+"\\right)":mi(r.args[0].args[0])+n2(r.nprimes)+"\\left("+mi(r.args[0].args[1])+"\\right)"}return mi(r.args[0])+n2(r.nprimes);case"Seq":return r.args.map(mi).join(",");case"Sqrt":return"\\sqrt"+$C(mi(r.args[0]));case"Nthroot":return"\\sqrt["+mi(r.args[0])+"]"+$C(mi(r.args[1]));case"Frac":return"\\frac{"+mi(r.args[0])+"}{"+mi(r.args[1])+"}";case"Derivative":return"\\frac{d}{d"+mi(r.args[0])+"}"+mi(r.args[1]);case"Integral":case"EmptyIntegral":if(r.args[0].type!=="Cmd")throw new Error("Expected first argument of an integral to be the variable");let t="d"+r.args[0].val;if(r.args.length===3)return jC("int",r.args[1],r.args[2])+t;let i=mi(r.args[3]);return jC("int",r.args[1],r.args[2])+i+t;case"Sum":return W6(r.args,"sum");case"Product":return W6(r.args,"prod");case"Piecewise":return"\\{"+mi(r.args[0])+"\\}";case"EmptyPiecewise":return"\\{\\}";case"Colon":return Ka(r.args,":");case"Ellipsis":return Ka(r.args,"...");case"For":return Ka(r.args,"\\for ");case"With":return Ka(r.args,"\\with ");case"Dot":return Ka(r.args,".");case"PercentOf":return Ka(r.args,"\\% \\of ");case"RightArrow":return Ka(r.args,"->");case"Juxt":return Ka(r.args,r.args[0].type==="Cmd"?" ":"");case"ImplicitCall":{let n=a2(r.args);return n?n.script+n.arg:Ka(r.args,"")}case"MixedNumber":return r.whole+"\\frac{"+r.num+"}{"+r.den+"}";case"Letter":case"Decimal":case"Alphanumeric":return r.val;case"Cmd":return"\\"+r.val;case"EmptyRangeEnd":return"EmptyRangeEnd";case"Err":throw r.error;default:return r}}function $C(r){return r.length>1?"{"+r+"}":r}function jC(r,e,t){let i=$C(mi(e));if(t){let o=$C(mi(t));return`\\${r}_${i}^${o}`}return`\\${r}_${i}`}function Ka(r,e,t=!1){let i=mi(r[0]),o=t?$C(mi(r[1])):mi(r[1]);return i+e+o}function W6(r,e){let t=mi(r[0]);return jC(e,r[1],r[2])+t}function n2(r){let e="";for(let t=0;t<r;t++)e+="'";return e}function $6(r){return r.type==="Cmd"&&r.val==="logbase"}function a2(r){let e=r[1],t;if(r[1].type==="Seq"&&r[1].args.length===2&&(e=r[1].args[1],t=r[1].args[0]),r[0].type==="Superscript"&&$6(r[0].args[0]))return{script:jC("log",e,r[0].args[1]),arg:t?mi(t):""};if($6(r[0]))return{script:jC("log",e),arg:t?mi(t):""}}function j6(r){let e=l2.parse(r.latex);if(e.type=="Err")return;let t=ka(e);for(;t.type==="Paren";)t=t.args[0];return Jp(t)?{latex:r.latex}:{latex:mi(t)}}function ine(r){return r.isPseudoSurfaceNode}function Jp(r){switch(r.type){case"Letter":case"Decimal":case"Cmd":return r.val==="0";case"Paren":return Jp(r.args[0]);default:return!1}}function Bg(r){switch(r.type){case"Letter":case"Decimal":case"Cmd":return r.val==="1";case"Paren":return Bg(r.args[0]);default:return!1}}function Y6(r){return r.type==="Neg"?Bg(r.args[0]):r.type==="Paren"?Y6(r.args[0]):!1}function QT(r){return{isPseudoSurfaceNode:!0,type:"Decimal",span:r,val:"0"}}function s2(r,e){return{isPseudoSurfaceNode:!0,type:"Neg",span:e,args:[r]}}function one(r,e){return{isPseudoSurfaceNode:!0,type:"Paren",span:e,args:[r]}}function Ql(r,e){return{...r,span:e}}function ka(r,e){let t;switch(r.type){case"Add":{let n=ka(r.args[0]),a=ka(r.args[1]);if(Jp(n))return Ql(a,r.span);if(Jp(a))return Ql(n,r.span);let s;if(a.type==="Neg"?s=ka(a.args[0]):a.type==="Paren"&&a.args[0].type==="Neg"&&(s=ka(a.args[0].args[0])),s!==void 0)return{isPseudoSurfaceNode:!0,type:"Sub",span:r.span,args:[n,s]};t=[n,a];break}case"Sub":{let n=ka(r.args[0]),a=ka(r.args[1]);if(Jp(n))return s2(a,r.span);if(Jp(a))return Ql(n,r.span);let s;if(a.type==="Neg"?s=a.args[0]:a.type==="Paren"&&a.args[0].type==="Neg"&&(s=a.args[0].args[0]),s)return{isPseudoSurfaceNode:!0,type:"Add",span:r.span,args:[n,s]};t=[n,a];break}case"Mul":{let n=ka(r.args[0]),a=ka(r.args[1]);if(Bg(n))return Ql(a,r.span);if(Bg(a))return Ql(n,r.span);if(Jp(n)||Jp(a))return QT(r.span);t=[n,a];break}case"Juxt":{let n=ka(r.args[0],r),a=ka(r.args[1],r);if(Bg(n))return Ql(a,r.span);if(Bg(a))return Ql(n,r.span);if(Y6(n))return s2(a,r.span);if(Jp(n)||Jp(a))return QT(r.span);if(n.type==="Neg"){let s={...r,type:"Juxt",isPseudoSurfaceNode:!0,args:[n.args[0],a]};return s2(s,r.span)}t=[n,a];break}case"Frac":case"Div":{let n=ka(r.args[0]),a=ka(r.args[1]);if(Bg(a))return Ql(n,r.span);t=[n,a];break}case"Superscript":let i=ka(r.args[0]),o=ka(r.args[1]);if(Bg(o))return Ql(i,r.span);(e==null?void 0:e.type)==="Juxt"&&e.args[0].type==="Decimal"&&i.type==="Decimal"&&(i=one(i,i.span)),t=[i,o];break;case"Paren":{let n=ka(r.args[0]);if((e==null?void 0:e.type)!=="Juxt"){if(__dcg_shared_module_exports__['xc'](n))return Ql(n,r.span);let a="args"in n?n.args:void 0;if((!a||a.length<=1)&&n.type!=="Neg")return Ql(n,r.span)}t=[n];break}case"Pos":{let n=ka(r.args[0]);return Ql(n,r.span)}case"Neg":{let n=ka(r.args[0]),a="args"in n?n.args[0]:void 0;if(n.type==="Paren"&&a&&a.type==="Neg"&&a.args[0])return Ql(ka(a.args[0]),r.span);if(n.type==="Neg"&&a)return Ql(a,r.span);t=[n];break}case"Cmd":case"Letter":case"Decimal":case"MixedNumber":case"EmptyRangeEnd":case"EmptyPiecewise":case"ComparatorChain":return{...r,isPseudoSurfaceNode:!0};default:t=r.args.map(n=>ine(n)?n:n.type==="Alphanumeric"?{...n,isPseudoSurfaceNode:!0}:ka(n))}return{...r,isPseudoSurfaceNode:!0,args:t}}var nne={version:ed,randomSeed:"",graph:{viewport:{xmin:-10,ymin:-13.25,xmax:10,ymax:13.25}},expressions:{list:[{id:"1",type:"expression"}]}},Ug=nne;function ane(r){return{...r,version:"0"}}var X6=ane;var sne={centerX:0,centerY:0,size:15},lne={scale:1,unit:"",visible:!1,showLegend:!1};function cne(r){let e=r.objects||{},t=__dcg_shared_module_exports__['Z'](e);for(let i in t){let o=t[i];o.label&&(o.showLabel=!0)}return{version:"1",objects:t,viewport:r.viewport||sne,customTools:r.customTools||{},grid:r.grid||lne}}var J6=cne;function dne(r){return(r.type==="point"||r.type==="glider")&&!r.draggable}function pne(r){let e=r.objects||{},t=__dcg_shared_module_exports__['Z'](e),i=__dcg_shared_module_exports__['Z'](r.grid);for(let o in t){let n=t[o];dne(n)&&(n.draggable=!0),n.type==="angle"&&n.showLabel&&!n.label&&(n.label="{angle}"),n.type==="segment"&&n.showLabel&&!n.label&&(n.label="{length}")}return i.unit="",i.scale=1,{version:"2",objects:t,viewport:r.viewport,customTools:r.customTools||{},grid:i}}var Q6=pne;function c2(r){return r&&(r.type==="circle"||r.type==="compass")}function une(r){let e=__dcg_shared_module_exports__['Z'](r.objects||{});for(let t in e){let i=e[t];if(i.type==="point")i.y=-i.y;else if(i.type==="glider"){let o=e[i.parents.host];c2(o)&&(i.t=-i.t)}else if(i.type==="intersection"){let o=e[i.parents.host1],n=e[i.parents.host2];c2(o)&&c2(n)&&(i.negRoot=!i.negRoot)}}return{version:"3",objects:e,viewport:r.viewport,customTools:r.customTools||{},graphSettings:{showGrid:!!(r.grid||{}).visible,showAxes:!1,showAxisNumbers:!1}}}var Z6=une;function hne(r){let e=__dcg_shared_module_exports__['Z'](r.objects||{});for(let t in e){let i=e[t];i.draggable===!1&&(i.locked=!0),delete i.draggable}return{...r,version:"4",objects:e}}var eW=hne;var ZT=[X6,J6,Q6,Z6,eW],gne="4";function d2(r){let e=parseInt(gne,10),t=parseInt(r.version||"0",10);for(t>e&&typeof console!="undefined"&&console.warn&&console.warn(`Loading saved state with version ${t}, but last known version is ${e}. States saved in a newer version of the geometry tool may not load correctly in older versions of the tool.`),ZT[t]||typeof console!="undefined"&&console.warn&&console.warn(`State has invalid version: ${t}. If a version is present, it should be a non-negative integer less than or equal to ${e}.`),t===0&&(r=ZT[0](r));t<e;)t+=1,ZT[t]&&(r=ZT[t](r));return r}var mne=!1;function Vf(r,e){var t=e[r];return t.type==="transformed-object"?Vf(t.parents.object,e):t.type}function tW(r){switch(r){case"circle":case"compass":case"arc":return!0}return!1}function fne(r,e,t){var i=Vf(e,t);if(i==="circle"||i==="compass"){let o=r/(2*Math.PI);return o<0?o+1:o}return r}function rW(r){switch(r){case"scaled-rotation":case"vector":return!0}return!1}function bne(r){switch(r){case"point":case"midpoint":case"glider":case"intersection":case"polygon":return"P";case"line":case"segment":case"ray":case"vector":case"parallel":case"perpendicular":return"L";case"circle":case"compass":return"C";case"arc":case"angle":return"A";case"image":return"I";case"dilation":case"rotation":case"translation":case"reflection":case"scaled-rotation":return"T";case"transformed-object":return"T";default:return r}}function fh(r){let e=!mne,t=d2(r),i={},o={},n=S=>{if(o.hasOwnProperty(S))return o[S];let v=Vf(S,t.objects);if(e&&!rW(v)){let P=i.token||1;i.token=P+1;let _="\\token{"+P+"}";return o[S]=_,_}let M=bne(v),A=i[M]||1;i[M]=A+1;let I=M+"_{"+A+"}";return o[S]=I,I};function a(S){let v=i[S]||1;return i[S]=v+1,S+"_{"+v+"}"}let s=(S,v,M)=>n(S)+"=\\operatorname{"+v+"}\\left("+M.map(n).join(",")+"\\right)",l=S=>`\\operatorname{segment}\\left(${S}.\\operatorname{start},${S}.\\operatorname{end}\\right)`,{centerX:c,centerY:d,size:p}=t.viewport;p*=1.25;let g=1,h=p/(1+g),f=h*g,y={version:11,randomSeed:"",expressions:{list:[]},graph:{product:"geometry-calculator",viewport:{xmin:c-h,xmax:c+h,ymin:d-f,ymax:d+f},showGrid:!1,showXAxis:!1,showYAxis:!1,squareAxes:!0,degreeMode:!0}};t.graphSettings.showGrid&&(y.graph.showGrid=!0,y.graph.xAxisMinorSubdivisions=1,y.graph.yAxisMinorSubdivisions=1,y.graph.xAxisStep=1,y.graph.yAxisStep=1);let x=y.expressions.list,E=[],C=[];for(let S in t.objects){let v=t.objects[S],M=Vf(v.id,t.objects),A={id:v.id,type:"expression",color:v.color,hidden:!!v.hidden};if(e&&!rW(M)&&(A.folderId=__dcg_shared_module_exports__['jd']),v.locked&&(A.dragMode="NONE"),!v.hidden&&v.label&&v.showLabel){if(A.label=v.label,A.showLabel=!0,M==="segment"&&v.label.indexOf("{length}")!==-1)if(v.label==="{length}")A.label="";else{let I=a("l"),P=I+"=\\operatorname{round}\\left(\\operatorname{length}\\left("+n(v.id)+"\\right),2\\right)";C.push({id:"len-"+A.id,type:"expression",latex:P}),A.label=A.label.replace(/\{length\}/g,"${"+I+"}")}if(M==="angle"&&v.label.indexOf("{angle}")!==-1)if(v.label==="{angle}")A.label="";else{let I=a("a"),P=I+"=\\operatorname{round}\\left("+n(v.id)+"\\right)";C.push({id:"angle-"+A.id,type:"expression",latex:P}),A.label=A.label.replace(/\{angle}/g,"${"+I+"}\xB0")}if(M==="polygon"&&v.label.indexOf("{area}")!==-1)if(v.label==="{area}")A.label="";else{let I=a("a"),P=I+"=\\operatorname{round}\\left(\\operatorname{area}\\left("+n(v.id)+"\\right),2\\right)";C.push({id:"area-"+A.id,type:"expression",latex:P}),A.label=A.label.replace(/\{area\}/g,"${"+I+"}")}if(M==="polygon"&&v.label.indexOf("{perimeter}")!==-1){let I=a("p"),P=I+"=\\operatorname{round}\\left(\\operatorname{perimeter}\\left("+n(v.id)+"\\right),2\\right)";C.push({id:"perim-"+A.id,type:"expression",latex:P}),A.label=A.label.replace(/\{perimeter\}/g,"${"+I+"}")}}switch(v.type){case"point":{let T=v.x===null?0:v.x,B=v.y===null?0:v.y;A.latex=n(v.id)+"=\\left("+__dcg_shared_module_exports__['Oc'](T)+","+__dcg_shared_module_exports__['Oc'](B)+"\\right)";break}case"glider":{let T=Vf(v.parents.host,t.objects),B=n(v.parents.host);T==="vector"&&(B=l(B)),A.latex=n(v.id)+"=\\operatorname{glider}\\left("+B+","+__dcg_shared_module_exports__['Oc'](fne(v.t,v.parents.host,t.objects))+"\\right)";break}case"intersection":let I=Vf(v.parents.host1,t.objects),P=Vf(v.parents.host2,t.objects),_=n(v.parents.host1),U=n(v.parents.host2);I==="vector"&&(_=l(_)),P==="vector"&&(U=l(U));let Y=v.negRoot;(tW(I)&&!tW(P)||P==="arc")&&(Y=!Y);let R=Y?[_,U]:[U,_];A.latex=n(S)+"=\\operatorname{intersection}\\left("+R.join(",")+"\\right)";break;case"midpoint":A.latex=s(v.id,v.type,[v.parents.straight]);break;case"circle":A.latex=s(v.id,v.type,[v.parents.point1,v.parents.point2]);break;case"arc":A.latex=s(v.id,v.type,[v.parents.point1,v.parents.point2,v.parents.point3]);break;case"compass":A.latex=s(v.id,"circle",[v.parents.center,v.parents.straight]);break;case"line":case"segment":case"ray":case"vector":A.latex=s(v.id,v.type,[v.parents.point1,v.parents.point2]);break;case"parallel":case"perpendicular":A.latex=s(v.id,v.type,[v.parents.straight,v.parents.point]);break;case"polygon":A.latex=s(v.id,v.type,v.parents.points);break;case"angle":A.latex=s(v.id,v.type,[v.parents.point1,v.parents.point2,v.parents.point3]);break;case"transformed-object":A.latex=n(v.id)+"="+n(v.parents.transformation)+"\\left("+n(v.parents.object)+"\\right)";break;case"dilation":A.latex=n(v.id)+"\\left(x\\right)=\\operatorname{dilate}\\left(x,"+n(v.parents.center)+","+(v.scaleFactor||"0/0")+"\\right)";break;case"reflection":A.latex=n(v.id)+"\\left(x\\right)=\\operatorname{reflect}\\left(x,"+n(v.parents.straight)+"\\right)";break;case"translation":A.latex=n(v.id)+"\\left(x\\right)=\\operatorname{translate}\\left(x,"+n(v.parents.from)+","+n(v.parents.to)+"\\right)";break;case"rotation":A.latex=n(v.id)+"\\left(x\\right)=\\operatorname{rotate}\\left(x,"+n(v.parents.center)+","+(v.angle||"0/0")+"\\right)";break;case"scaled-rotation":let H=n(v.parents.center),O=n(v.parents.from),q=n(v.parents.to);A.latex=n(v.id)+`\\left(x\\right)=\\operatorname{rotate}\\left(\\operatorname{dilate}\\left(x,${H},\\frac{\\left|${q}-${H}\\right|}{\\left|${O}-${H}\\right|}\\right),${H},\\operatorname{directedangle}\\left(${O},${H},${q}\\right)\\right)`;break;case"image":break;default:return v}A.latex&&(A.folderId===__dcg_shared_module_exports__['jd']?E.push(A):C.push(A))}return x.push({type:"folder",id:__dcg_shared_module_exports__['jd'],title:"geometry",secret:!0}),x.push.apply(x,E),x.push.apply(x,C),y}function yne(r,e){return r==null&&(r=""),__dcg_shared_module_exports__['Ec'](r,e)}function xne(r){if(r!=null)try{let e=__dcg_shared_module_exports__['wc'](r);return __dcg_shared_module_exports__['Dc'](e)}catch(e){let t=e instanceof iW.Base?e.getInputSpan():void 0;t||(t=__dcg_shared_module_exports__['mb'](r,0,r.length));let i={...__dcg_shared_module_exports__['zc'](),originalError:e};return __dcg_shared_module_exports__['yc'](t,i)}}var wne={parse:yne},l2={parse:xne},vne={countNumbers:jT},Cne=__dcg_shared_module_exports__['Id'],Ene=__dcg_shared_module_exports__['cc'],Sne=__dcg_shared_module_exports__['kb'],iW=__dcg_shared_module_exports__['jc'],Dne={graphing:new __dcg_shared_module_exports__['ud']({enableGeometry:!1,enable3d:!1,beta3d:!1,scales:void 0}),scientific:new __dcg_shared_module_exports__['Hd']({singleExpression:!1}),fourFunction:new __dcg_shared_module_exports__['Gd']({singleExpression:!1})},kne=Ug,Gne=Vx;var{Switch:oW}=zr.Components,Qp=class extends zr.Class{template(){return zr.createElement(oW,{key:()=>this.getLatex().indexOf("\\token")>=0},e=>e?zr.createElement($p,{identifier:()=>this.getIdentifier(),insideMQ:()=>!1,controller:()=>this.props.controller(),insideGroup:()=>!1,putInTabOrder:()=>!1}):zr.createElement("span",null,zr.createElement(lt,{config:this.const({}),latex:()=>this.getLatex()})))}getLatex(){return this.props.latex()||"unknown"}getIdentifier(){let e=this.props.latex();return e?__dcg_shared_module_exports__['zb'].latexToIdentifier(e):""}},t1=class extends zr.Class{init(){this.controller=this.props.controller()}template(){return zr.createElement(oW,{key:this.bindFn(this.getTransformationType)},e=>{switch(e){case"translate":return this.getParents().length===1?zr.createElement("div",null,zr.const("Translate by"),zr.const(" "),zr.createElement(Qp,{controller:this.props.controller,latex:()=>this.getParents()[0]})):zr.createElement("div",null,zr.const("Translate from"),zr.const(" "),zr.createElement(Qp,{controller:this.props.controller,latex:()=>this.getParents()[0]}),zr.const(" "),zr.const("to"),zr.const(" "),zr.createElement(Qp,{controller:this.props.controller,latex:()=>this.getParents()[1]}));case"reflect":return zr.createElement("div",null,zr.const("Reflect over"),zr.const(" "),zr.createElement(Qp,{controller:this.props.controller,latex:()=>this.getParents()[0]}));case"dilate":return zr.createElement("div",null,zr.const("Dilate at"),zr.const(" "),zr.createElement(Qp,{controller:this.props.controller,latex:()=>this.getParents()[0]}),zr.const(" by "),zr.createElement(Qp,{controller:this.props.controller,latex:()=>this.getRawParentLatex(2)}));case"rotate":return zr.createElement("div",null,zr.const("Rotate around"),zr.const(" "),zr.createElement(Qp,{controller:this.props.controller,latex:()=>this.getParents()[0]}),zr.const(" by "),zr.createElement(Qp,{controller:this.props.controller,latex:()=>this.getRawParentLatex(2)+(this.controller.getGraphSettings().degreeMode?"\xB0":"")}));case void 0:return zr.createElement("span",null)}})}getParents(){let e=this.getGeometry();return!e||!e.call?[]:e&&e.call?e.call.parents.map(t=>__dcg_shared_module_exports__['zb'].geoParentToLatex(t)):[]}getRawParentLatex(e){var a;var t=(a=this.props.model())==null?void 0:a.latex;if(!t)return"";let o=__dcg_shared_module_exports__['Ec'](t)._expression;if(!o)return"";let n=o.args[e];return!n||!n.getInputString?"":n.getInputString()||""}getGeometry(){var e;return(e=this.props.model())==null?void 0:e.formula.geometry}getTransformationType(){var i;let e=this.getGeometry(),t=(i=e==null?void 0:e.call)==null?void 0:i.symbol;switch(t){case"translate":case"dilate":case"reflect":case"rotate":return t}}};var nW={translate:!0,reflect:!0,dilate:!0,rotate:!0},ITe={selection:!0,point:!0,line:!0,segment:!0,ray:!0,vector:!0,circle:!0,arc:!0,parallel:!0,perpendicular:!0,midpoint:!0,polygon:!0,compass:!0,angle:!0,directedangle:!0,"box-selection":!0,"expression-edit":!0,...nW},Px=Object.keys(nW);var jo=__dcg_shared_module_exports__['e'](te());var{Each:aW,If:Tne}=jo.Components,r1=class extends jo.Class{init(){this.controller=this.props.controller(),this.focusOrder=this.getTransformationFocusLocations(),this.cacheExistingTransformations()}willUpdate(){this.cacheExistingTransformations()}handleTap(e,t){e.handle(),e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"select-geo-tool",tool:t,focusGraphPaper:e.device==="keyboard"})}template(){return jo.createElement("div",{class:()=>({"dcg-generic-options-menu":!0,"dcg-options-menu":!0,"dcg-multi-select-transformations-menu":!0}),role:jo.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-transformations-menu")},jo.createElement("div",{onKeydown:this.bindFn(this.handleKeydown),class:jo.const("dcg-new-transformations-container"),role:jo.const("menu"),"aria-orientation":jo.const("horizontal"),"aria-label":()=>this.controller.s("graphing-calculator-label-new-transformation")},aW(()=>this.getTransformations(),{item:e=>jo.createElement("button",{class:()=>({"dcg-new-transformation":!0,"dcg-disabled":!this.controller.isGeoToolEnabled(e),"dcg-will-be-hidden-or-disabled":this.controller.toolWillBeHiddenOrDisabled(e)}),tabindex:()=>this.getTransformations().indexOf(e)===0?0:-1,role:jo.const("menuitemradio"),manageFocus:()=>ft({controller:this.controller,location:{type:"geo-basic-tool",tool:e}}),"dcg-geo-tool":this.const(e),onTap:t=>this.handleTap(t,e)},jo.createElement("i",{class:()=>this.getTransformationIcon(e)}),()=>this.getTransformationName(e))})),jo.createElement(Tne,{predicate:()=>this.cachedExistingTransformations.length>0},()=>jo.createElement("div",{class:jo.const("dcg-transformation-header")},()=>this.controller.s("graphing-calculator-label-recent-transformations"))),jo.createElement("div",{role:jo.const("group"),class:jo.const("dcg-existing-transformations-container"),"aria-label":()=>this.controller.s("graphing-calculator-label-recent-transformations")},aW(()=>this.cachedExistingTransformations,{item:e=>jo.createElement("div",{class:jo.const("dcg-existing-transformation"),role:jo.const("button"),tabindex:jo.const("0"),onTap:()=>this.applyTransformation(e),onPointerOut:t=>this.onPointerOut(t,e),onPointerOver:t=>this.onPointerOver(t,e),willUnmount:()=>this.onImplicitMouseOut(e)},jo.createElement(t1,{controller:this.props.controller,model:()=>e})),key:e=>e.id})))}handleKeydown(e){let t=Be(e);if(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||t!=="Left"&&t!=="Right"&&t!=="Home"&&t!=="End")return;let i=this.controller.getFocusLocation();if(!i)return;let o=__dcg_shared_module_exports__['w'](this.focusOrder,i);if(o===-1)return;e.preventDefault(),e.stopPropagation();let n=o;t==="Left"?n=Math.max(0,o-1):t==="Right"?n=Math.min(this.focusOrder.length-1,o+1):t==="Home"?n=0:t==="End"&&(n=this.focusOrder.length-1),n!==o&&this.controller.dispatch({type:"set-focus-location",location:this.focusOrder[n]})}computeExistingTransformations(){var t,i;let e=[];for(let o of this.controller.getAllItemModels()){if(o.type!=="expression"||!this.controller.isItemInGeoFolder(o.id))continue;let n=(t=o.formula.geometry)==null?void 0:t.call;if(!n||!__dcg_shared_module_exports__['oc'](n.symbol))continue;let a=(i=o.formula.typed_constant_value)==null?void 0:i.valueType;a!==void 0&&__dcg_shared_module_exports__['ib'](a,__dcg_shared_module_exports__['Ta'])&&e.push(o)}return e.reverse()}cacheExistingTransformations(){this.cachedExistingTransformations=this.computeExistingTransformations()}getTransformations(){return Px.filter(e=>this.controller.isGeoToolVisible(e))}getTransformationIcon(e){switch(e){case"dilate":return"dcg-icon-dilation";case"reflect":return"dcg-icon-reflection";case"rotate":return"dcg-icon-rotation";case"translate":return"dcg-icon-vector"}}getTransformationName(e){switch(e){case"dilate":return this.controller.s("graphing-calculator-text-geometry-tool-dilate-display-name");case"reflect":return this.controller.s("graphing-calculator-text-geometry-tool-reflect-display-name");case"rotate":return this.controller.s("graphing-calculator-text-geometry-tool-rotate-display-name");case"translate":return this.controller.s("graphing-calculator-text-geometry-tool-translate-display-name")}}getTransformationFocusLocations(){let e=[];return this.getTransformations().forEach(t=>{e.push({type:"geo-basic-tool",tool:t})}),e}onPointerOver(e,t){var o;if(e.pointerType!=="mouse")return;let i=(o=mn(t))==null?void 0:o.identifier;i&&(this.currentlyActiveTokenIdentifier=i,this.controller.dispatch({type:"set-active-token",identifier:this.currentlyActiveTokenIdentifier,style:"hovered"}))}onPointerOut(e,t){var o;if(e.pointerType!=="mouse")return;let i=(o=mn(t))==null?void 0:o.identifier;i&&this.currentlyActiveTokenIdentifier&&this.currentlyActiveTokenIdentifier===i&&(this.controller.dispatch({type:"unset-active-token",identifier:this.currentlyActiveTokenIdentifier,style:"hovered"}),this.currentlyActiveTokenIdentifier=void 0)}onImplicitMouseOut(e){var i;let t=(i=mn(e))==null?void 0:i.identifier;t&&this.currentlyActiveTokenIdentifier&&this.currentlyActiveTokenIdentifier===t&&this.controller.runAfterDispatch(()=>{let o=this.currentlyActiveTokenIdentifier;o&&(this.currentlyActiveTokenIdentifier=void 0,this.controller.dispatch({type:"unset-active-token",identifier:o,style:"hovered"}))})}applyTransformation(e){var i;if(!((i=e.formula.geometry)!=null&&i.identifier))return;let t=__dcg_shared_module_exports__['ub'](e.formula.geometry.identifier);this.controller.dispatch({type:"apply-transformation-to-selected",assignmentLatex:t})}};var Ox=__dcg_shared_module_exports__['e'](te());qt();var sW='a, input, button:not([disabled]), textarea, select [role="textbox"], [tabindex="0"], [role="button"], [role="link"], summary',_x=class{constructor({closeMenu:e,focusIcon:t,getIconSelector:i,getContainerEl:o,isIconFocused:n}){this.globalKeyDownListener=e=>{let t=Be(e);if(t===rn){e.preventDefault(),e.stopPropagation(),this.focusIcon(),this.closeMenu();return}if(t==="Tab"&&!e.altKey&&!e.ctrlKey&&!e.metaKey){if(this.isIconFocused()){e.shiftKey?this.focusLastOption():this.focusFirstOption(),e.preventDefault(),e.stopPropagation();return}if(this.isLastOptionViewFocused()&&!e.shiftKey){this.focusIcon(),e.preventDefault(),e.stopPropagation();return}if(this.isFirstOptionViewFocused()&&e.shiftKey){this.focusIcon(),e.preventDefault(),e.stopPropagation();return}}};this.tapListener=e=>{let t=this.getContainerEl();if(!t)return;let{target:i}=e,o=this.getIconSelector();if(o&&i.closest(o))return;if(t.contains(i)){if(!i.matches(sW))return;let{first:a,last:s}=this.getDOMTabStops();a===i?this.focusFirstOption():s===i&&this.focusLastOption();return}Array.from(document.querySelectorAll(".dcg-keypad,.dcg-show-keypad-container")).some(a=>a.contains(i))||this.closeMenu()};this.closeMenu=e,this.getContainerEl=o,this.getIconSelector=i,this.isIconFocused=n,this.focusIcon=t}isFirstOptionViewFocused(){let{first:e}=this.getDOMTabStops();return e!==void 0&&e.matches(":focus")}focusFirstOption(){let{first:e}=this.getDOMTabStops();e!==void 0&&e.focus()}focusLastOption(){let{last:e}=this.getDOMTabStops();e!==void 0&&e.focus()}isLastOptionViewFocused(){let{last:e}=this.getDOMTabStops();return e!==void 0&&e.matches(":focus")}getDOMTabStops(){let e=this.getContainerEl();if(e===void 0)return{};let t=Array.from(e.querySelectorAll(sW));return{first:t.find(i=>Zu(i)),last:[...t.reverse()].find(i=>Zu(i))}}};var td=class extends Ox.Class{init(){this.controller=this.props.controller()}template(){return Ox.createElement("div",{class:Ox.const("dcg-options-menu-container"),didMount:this.bindFn(this.didMountView),didUnmount:this.bindFn(this.didUnmountView)},this.children)}didMount(){this.props.openAriaAlert&&Te(this.props.openAriaAlert())}willUnmount(){this.props.closeAriaAlert&&Te(this.props.closeAriaAlert())}didMountView(e){this.focusHelper=new _x({isIconFocused:()=>this.isIconModelFocused(),focusIcon:()=>this.focusIcon(),getContainerEl:()=>this.openView,closeMenu:()=>this.hideOptions(),getIconSelector:()=>{var t;return`[dcg-open-menu-guid="${(t=this.controller.getOpenItemMenu())==null?void 0:t.guid}"]`}}),this.guid=__dcg_shared_module_exports__['K']("dcg-dropdown-menu"),this.openView=e,this.positionMenu(),this.moveFocusIfAppropriate(),this.attachKeyDownListeners(),this.attachTapListener()}isIconModelFocused(){let e=this.controller.getFocusLocation();return __dcg_shared_module_exports__['E'](e,this.props.menuButtonFocusLocation())}attachKeyDownListeners(){this.props.shouldHandleTabAndEscape()&&document.addEventListener("keydown",this.focusHelper.globalKeyDownListener)}attachTapListener(){ie(document.body).on(`dcg-tapstart.${this.guid}`,this.focusHelper.tapListener)}didUnmountView(){document.removeEventListener("keydown",this.focusHelper.globalKeyDownListener),ie(document.body).off(`.${this.guid}`),this.openView=void 0}moveFocusIfAppropriate(){this.shouldMoveFocusToFirstOption()?this.focusHelper.focusFirstOption():this.shouldMoveFocusToLastOption()&&this.focusHelper.focusLastOption()}hideOptions(){this.controller.dispatch({type:"close-item-settings-menu"})}getRootEl(){return this.controller.findEl(this.props.rootElSelector())}positionMenu(){let e=this.controller.getOpenMenuIcon();if(!e||!this.openView)return;let t=this.getRootEl();if(!t)return;let i=t.getBoundingClientRect(),o=e.getBoundingClientRect(),n={top:o.top-i.top,left:o.left-i.left};aa(this.openView,{top:n.top+"px",left:n.left+"px",display:"block"})}focusIcon(){this.controller.focusOpenMenuIcon()}shouldMoveFocusToFirstOption(){if(this.props.focusOnOpen)return this.props.focusOnOpen()==="first";if(this.openView&&this.openView.matches(":focus-within"))return!1;let e=this.controller.getOpenItemMenu();return(e==null?void 0:e.type)===this.props.menuType()&&!!(e!=null&&e.focusFirstOption)}shouldMoveFocusToLastOption(){return this.props.focusOnOpen?this.props.focusOnOpen()==="last":!1}};var{If:YC,Switch:Mne}=nr.Components,i1=class extends nr.Class{init(){this.controller=this.props.controller(),this.focusOrder=[{type:"geo-header-back-link"},{type:"multi-select-delete-icon"},{type:"multi-select-show-hide-icon"},{type:"multi-select-transformations-icon"},{type:"multi-select-more-icon"}]}template(){return nr.createElement("div",{class:nr.const("dcg-multi-select-header dcg-animate-in-after-initial-load"),onKeydown:this.bindFn(this.handleKeydown),role:nr.const("toolbar"),"aria-label":this.bindFn(this.getSelectedCountString)},nr.createElement(Mx,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-geometry-deselect-all"),controller:this.props.controller,message:this.bindFn(this.getSelectedCountString),onBack:this.bindFn(this.onDone)}),nr.createElement(YC,{predicate:()=>this.hasSelectedAndEditableItems()},()=>nr.createElement($e,{tooltip:this.bindFn(this.getDeleteItemString)},nr.createElement("span",{"aria-label":this.bindFn(this.getDeleteItemString),role:nr.const("button"),tabindex:nr.const("-1"),handleEvent:nr.const("true"),class:nr.const("dcg-multi-select-icon-button dcg-delete-btn"),onTap:this.bindFn(this.deleteSelected),manageFocus:this.const(ft({controller:this.controller,location:{type:"multi-select-delete-icon"}}))},nr.createElement("i",{class:nr.const("dcg-icon-trashcan"),"aria-hidden":nr.const("true")})))),nr.createElement(Mne,{key:this.bindFn(this.getSelectedItemsKey)},()=>nr.createElement(YC,{predicate:()=>this.hasSelectedAndEditableItems()},()=>nr.createElement("div",{class:()=>({"dcg-btn-outline":!0,"dcg-show-hide-btn":!0,"dcg-any-visible-objects":this.anyVisible()}),handleEvent:nr.const("true"),tabindex:nr.const("-1"),role:nr.const("button"),onTap:this.bindFn(this.toggleItemsVisible),manageFocus:this.const(ft({controller:this.controller,location:{type:"multi-select-show-hide-icon"}}))},nr.createElement("div",{"aria-hidden":()=>!this.anyVisible()},()=>this.controller.s("graphing-calculator-text-geometry-hide-objects",{count:new on(this.getSelectedCount())})),nr.createElement("div",{"aria-hidden":this.bindFn(this.anyVisible)},()=>this.controller.s("graphing-calculator-text-geometry-show-objects",{count:new on(this.getSelectedCount())}))))),nr.createElement(YC,{predicate:()=>this.controller.isSomeTransformToolVisible()},()=>nr.createElement("div",{class:()=>({"dcg-btn-outline":!0,"dcg-transformations-button":!0,"dcg-transformations-open":this.isTransformationsMenuOpen()}),handleEvent:nr.const("true"),tabindex:nr.const("-1"),role:nr.const("button"),"dcg-open-menu-guid":()=>XC(),onTap:this.bindFn(this.toggleTransformationsMenu),manageFocus:this.const(ft({controller:this.controller,location:{type:"multi-select-transformations-icon"}}))},this.bindFn(this.getTransformationsString),nr.createElement("i",{class:nr.const("dcg-icon-caret-down"),"aria-hidden":nr.const("true")}))),nr.createElement($e,{tooltip:this.bindFn(this.getMoreString)},nr.createElement("span",{"aria-label":this.bindFn(this.getMoreString),role:nr.const("button"),tabindex:nr.const("-1"),handleEvent:nr.const("true"),"aria-expanded":this.bindFn(this.isMoreMenuOpen),class:nr.const("dcg-multi-select-icon-button dcg-more-options"),"dcg-open-menu-guid":()=>Lf(),manageFocus:this.const(ft({controller:this.controller,location:{type:"multi-select-more-icon"}})),onTap:this.bindFn(this.toggleMoreMenu)},nr.createElement(FT,null))),nr.createElement(YC,{predicate:this.bindFn(this.isTransformationsMenuOpen)},()=>nr.createElement(td,{controller:this.props.controller,shouldHandleTabAndEscape:this.const(!0),menuType:this.const("multi-select-transformations"),menuButtonFocusLocation:this.const({type:"multi-select-transformations-icon"}),rootElSelector:this.const(".dcg-multi-select-header")},nr.createElement(r1,{controller:this.props.controller}))),nr.createElement(YC,{predicate:this.bindFn(this.isMoreMenuOpen)},()=>nr.createElement(td,{controller:this.props.controller,shouldHandleTabAndEscape:this.const(!0),menuType:this.const("multi-select-more"),menuButtonFocusLocation:this.const({type:"multi-select-more-icon"}),rootElSelector:this.const(".dcg-multi-select-header")},nr.createElement(qT,{controller:this.props.controller}))))}handleKeydown(e){let t=Be(e);if(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||t!=="Left"&&t!=="Right"&&t!=="Home"&&t!=="End")return;let i=this.controller.getFocusLocation();if(!i)return;let o=__dcg_shared_module_exports__['w'](this.focusOrder,i);if(o===-1)return;e.preventDefault(),e.stopPropagation();let n=o;t==="Left"?n=Math.max(0,o-1):t==="Right"?n=Math.min(this.focusOrder.length-1,o+1):t==="Home"?n=0:t==="End"&&(n=this.focusOrder.length-1),n!==o&&this.controller.dispatch({type:"set-focus-location",location:this.focusOrder[n]})}getSelectedCountString(){return this.controller.getGrapherDimensions().width<450?"":this.controller.s("graphing-calculator-text-geometry-selected-objects",{count:new on(this.getSelectedCount())})}getSelectedAndEditableItems(){return this.controller.getAllSelectedItems().filter(t=>!this.controller.isItemReadonly(t.id))}hasSelectedAndEditableItems(){return this.getSelectedAndEditableItems().length>0}getDeleteItemString(){let e=this.getSelectedCount(),t=this.getSelectedAndEditableItems().length;return e-t>0?this.controller.s("graphing-calculator-text-geometry-delete-selected-unlocked-objects",{count:new on(t)}):this.controller.s("graphing-calculator-text-geometry-delete-selected-objects",{count:new on(t)})}getMoreString(){return this.controller.s("graphing-calculator-text-geometry-multi-select-more-dropdown")}getTransformationsString(){return this.controller.s("graphing-calculator-text-geometry-multi-select-transform")}getSelectedItemsKey(){let e=this.controller.getAllSelectedItems();return __dcg_shared_module_exports__['m'](e,"id").join("-")}toggleItemsVisible(){this.anyVisible()?this.hideSelected():this.showSelected()}anyVisible(){let e=this.controller.getAllSelectedItems();return __dcg_shared_module_exports__['k'](e,t=>!ls(t))}isFolderMenuOpen(){return this.controller.isItemSettingsMenuOpen(Ine())}isMoreMenuOpen(){return this.controller.isItemSettingsMenuOpen(Lf())}isTransformationsMenuOpen(){return this.controller.isItemSettingsMenuOpen(XC())}toggleMoreMenu(){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"multi-select-more",guid:Lf(),focusFirstOption:!0}})}toggleTransformationsMenu(){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"multi-select-transformations",guid:XC(),focusFirstOption:!0}})}getSelectedCount(){return this.controller.getAllSelectedItems().length}hideSelected(){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"visible",value:!1}})}showSelected(){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"visible",value:!0}})}onDone(){this.controller.dispatch({type:"set-none-selected"})}deleteSelected(){this.controller.dispatch({type:"delete-all-selected-items"})}};function Ine(){return"**multi-select-folder**"}function Lf(){return"**multi-select-more**"}function XC(){return"**multi-select-transformations**"}var Pf=class{constructor(){this.displayName="graphing-calculator-text-geometry-tool-box-selection-display-name";this.toolType="selection";this.icon=[{type:"stroked-path",color:"#aaa",path:[35,35,51,35,51,51,35,51,35,35]},{type:"filled-polygon",color:"#000",path:[50,50,63.5,62,58.25,62.75,62,72.5,59.75,74,55.25,64.25,50.75,68,50,50]}]}getNumberInputLatex(){return""}clearTentativeOutputs(){}canNextInputBePoint(){return!1}getAllValidNextInputTypes(){return __dcg_shared_module_exports__['ab'].filter(e=>this.isValidNextInputType(e))}isValidNextInputType(e){return e!==__dcg_shared_module_exports__['Ta']}getNonPointInputType(){}getHint(){return""}getExpressionEditHint(e){return this.getHint()}onNumberInput(e){}onMove(e){return!0}onFocus(e){}tryCommitResults(){return{committed:void 0}}shouldUseJitEdges(){return!1}shouldHighlightRelevantObjects(){return!1}};function lW(r,e){return r===void 0?e===void 0:!(e===void 0||r.calcId!==e.calcId||r.listIndex!==e.listIndex||r.polygonEdge!==e.polygonEdge)}var o1=class{constructor(e){this.poiController=e,this.controller=e.controller,this.grapher=e.manager}getKeyboardAttention(){return this.objectUnderAttention}setKeyboardAttention(e){this.objectUnderAttention=e}findNonGeometryTabTargetsInGraph(){let e=this.controller.getGrapher3d();if(e)return e.getOrderedTabTargets();let t=this.grapher.imageLayer.getOrderedTabTargets(),i=this.grapher.clickableObjectsLayer.getOrderedTabTargets(),o=this.grapher.movablePointsLayer.getOrderedTabTargets();return t.concat(i).concat(o)}findTabbableObjectsForCurrentTool(e){let t=e==null?void 0:e.calcId,i={};this.controller.isGeometry()&&this.controller.getGeoModel().getAllChoosableDefsUnordered({mode:"tab"}).forEach(g=>{var f;i[g.calcId]||(i[g.calcId]=[]);let h={calcId:g.calcId,listIndex:g.listIndex,polygonEdge:(f=g.polygonEdgeInfo)==null?void 0:f.edgeNumber,geoDef:{...g}};i[g.calcId].push(h)});let o=this.controller.getGeoModel().getCurrentTool();(!this.controller.isGeometry()||o.isValidNextInputType(__dcg_shared_module_exports__['ta']))&&this.findNonGeometryTabTargetsInGraph().filter(p=>!(o instanceof Pf&&this.controller.isClickableId(p.calcId))).forEach(p=>{var h;let g=(h=p.listIndex)!=null?h:0;if(!i[p.calcId])i[p.calcId]=[];else if(g&&!(!this.controller.isGeometry()||this.controller.canExpandListForItem(p.calcId)))return;i[p.calcId][g]?i[p.calcId][g].description=p.description:i[p.calcId].push(p)});let n=[],a=-1,s=!1,l=this.controller.getGrapher3d(),c=l?l.getSketchOrder():this.grapher.getSketchOrder();for(let d=0;d<c.length;d++){let p=c[d];p===t&&(a=n.length);let g=i[p];if(g){g.sort((h,f)=>h.listIndex!==f.listIndex?h.listIndex===void 0?-1:f.listIndex===void 0?1:h.listIndex-f.listIndex:h.polygonEdge!==f.polygonEdge?h.polygonEdge===void 0?-1:f.polygonEdge===void 0?1:h.polygonEdge-f.polygonEdge:0);for(let h of g)p===t&&(s||(a=n.length),lW(h,e)&&(s=!0)),n.push(h)}}return{targets:n,currentTabIndex:a,currentIsTabbable:s}}findNextObjFromKeyboard(e,t){let{targets:i,currentIsTabbable:o,currentTabIndex:n}=this.findTabbableObjectsForCurrentTool(t);if(!i.length)return;if(n===-1)return e==="next"?{wrapped:!1,target:i[0]}:{wrapped:!1,target:i[i.length-1]};let a=!1,s=n;return e==="prev"?s-=1:o&&(s+=1),s===-1?(a=!0,s=i.length-1):s>=i.length&&(a=!0,s=0),{wrapped:a,target:i[s]}}focusNextObjFromKeyboard(e={}){let t={allowWrapping:!0,selectNonClickables:!1,direction:"next"},{direction:i,allowWrapping:o,selectNonClickables:n}={...t,...e},a=this.findNextObjFromKeyboard(i,this.getKeyboardAttention());return!a||!o&&a.wrapped?(n&&this.controller.dispatch({type:"set-none-selected"}),!1):(a.wrapped&&this.controller.isVirtualMouseAllowed()?this.resetBackToGeoKeyboardPt():(n&&(this.controller.isClickableId(a.target.calcId)||!this.controller.isGeoItem(a.target.calcId)?this.controller.dispatch({type:"set-none-selected"}):this.controller.dispatch({type:"set-selected-id",id:a.target.calcId})),this.updateKeyboardAttention(a.target,{describe:!0})),!0)}updateKeyboardAttention(e,t){let i=this.getKeyboardAttention();lW(e,i)||(this.setKeyboardAttention(e),this.controller.isGeometry()&&this.controller.getGeoModel().onFocus(e==null?void 0:e.geoDef),this.poiController.moveGeoKeyboardPtToFocusedItem(t),t.describe&&this.poiController.describeFocusedItem({includeDetails:!0}))}clearAttentionIfNotTabbable(){let{currentIsTabbable:e}=this.findTabbableObjectsForCurrentTool(this.getKeyboardAttention());e||this.updateKeyboardAttention(void 0,{describe:!1})}handleGrapherGainedFocus(){if(this.controller.getGeoModel().speakCurrentGeoToolHint(),this.controller.isVirtualMouseAllowed())this.resetBackToGeoKeyboardPt();else{let t=this.findTabbableObjectsForCurrentTool(void 0).targets;t.length?(this.setKeyboardAttention(void 0),this.updateKeyboardAttention(t[0],{describe:!0})):Te(this.controller.s("graphing-calculator-narration-geometry-no-tool-inputs"))}}resetBackToGeoKeyboardPt(){this.updateKeyboardAttention(void 0,{describe:!0}),this.poiController.geoKeyboardPt.x=this.poiController.geoKeyboardPt.lastArrowedX,this.poiController.geoKeyboardPt.y=this.poiController.geoKeyboardPt.lastArrowedY,this.poiController.handleGeoKeyboardPtMove()}};function p2(r,e){if(r.indexOf("\\idref_{")===0){let t=r.indexOf("}"),i=r.slice(8,t);return e(i)+r.slice(t+1)}else return r}function u2(r,e,t){var a;let i=s=>t?s.map(l=>p2(l,t)):s;switch(r.type){case"point-reference":return{latex:`${r.id}=${r.parents[0]}`,color:r.color};case"point":var{x:o,y:n}=r;return{latex:r.id+"=\\left("+__dcg_shared_module_exports__['Nc'](o)+","+__dcg_shared_module_exports__['Nc'](n)+"\\right)",color:r.color};case"glider":return{latex:r.id+"=\\operatorname{glider}\\left("+i(r.parents)[0]+","+__dcg_shared_module_exports__['Nc'](r.t)+"\\right)",color:r.color};case"polygon":{let d="";return!e&&r.connectBorder&&(d=","+r.parents[0]),{latex:r.id+"=\\operatorname{"+r.type+"}\\left("+i(r.parents).join(",")+d+"\\right)",color:r.color}}case"circle":case"arc":case"compass":case"segment":case"line":case"ray":case"parallel":case"perpendicular":case"intersection":case"midpoint":return{latex:r.id+"=\\operatorname{"+r.type+"}\\left("+i(r.parents).join(",")+"\\right)",color:r.color};case"vector-copy":{let[d,p]=i(r.parents);return{latex:`${r.id}=\\operatorname{translate}\\left(${d},${d}.\\operatorname{start},${p}\\right)`,color:r.color}}case"vector":return{latex:r.id+"=\\operatorname{"+r.type+"}\\left("+i(r.parents).join(",")+"\\right)",color:r.color};case"vector-endpoint":return{latex:`${r.id}=${i(r.parents)[0]}.\\operatorname{${r.location}}`,color:r.color};case"translate":case"reflect":case"dilate":case"rotate":{let d=r.type==="dilate"||r.type==="rotate"?[...i([r.parents[0]]),r.parents[1]]:i(r.parents);return{latex:`${r.id}\\left(x\\right)=\\operatorname{${r.type}}\\left(x,${d.join(",")}\\right)`,color:r.color}}case"angle":case"directedangle":return{showAngleLabel:(a=r.showAngleLabel)!=null?a:!0,latex:r.id+"=\\operatorname{"+r.type+"}\\left("+i(r.parents).join(",")+"\\right)",color:r.color};case"angles":case"directedangles":return{showAngleLabel:e,latex:r.id+"=\\operatorname{"+r.type+"}\\left("+i(r.parents).join(",")+"\\right)"+(r.listAccess!==void 0?"\\left["+r.listAccess+"\\right]":""),color:r.color};case"polygon-segment":return{latex:r.id+"="+i(r.parents)[0]+(r.listAccess!==void 0?"\\left["+r.listAccess+"\\right]":"")+".\\operatorname{segments}\\left["+(r.edgeNumber+1)+"\\right]",color:r.color};case"slider":return{latex:r.latex,color:r.color,sliderInfo:r.sliderInfo};case"expression-edit-preview-latex":return r.rhsLatex===""?void 0:{showAngleLabel:r.rhsLatex.trim().startsWith("\\operatorname{angle}\\left("),latex:r.id+"="+r.rhsLatex,color:r.color};default:return r}}function h2(r,e){__dcg_shared_module_exports__['db'](r.valueType)?r.value.forEach((t,i)=>{let o=__dcg_shared_module_exports__['eb'](r.valueType);if(__dcg_shared_module_exports__['jb'](o))throw new Error("Programming error: unexpected lambda type");e({valueType:o,value:t},i+1)}):e(r,void 0)}function _f(r,e){let{controller:t,expandLists:i=!0}=r;t.getAllItemModels().concat(t.getAllToolPreviewItems()).forEach(n=>{var p;if(!Xc(n))return;let a=n.formula.typed_constant_value,s=n.formula.geometry,l=s.identifier,c=l?__dcg_shared_module_exports__['ub'](l):"\\idref_{"+n.id+"}",d=!t.getItemModel(n.id);i&&t.canExpandListForItem(n.id)?h2(a,(g,h)=>{var x;let f=c+(h===void 0?"":"\\left["+h+"\\right]"),y={calcId:n.id,data:s,hidden:!n.shouldGraph,isGraphableAndInteractive:!!((x=n.formula)!=null&&x.is_graphable)&&!r.controller.shouldIgnoreGraphInteractions(n),assignment:c,listIndex:h!==void 0?h-1:void 0,typedRuntimeValue:g,referenceLatex:f};e(y,d)}):e({calcId:n.id,data:s,hidden:!n.shouldGraph,isGraphableAndInteractive:!!((p=n.formula)!=null&&p.is_graphable)&&!r.controller.shouldIgnoreGraphInteractions(n),assignment:c,listIndex:void 0,typedRuntimeValue:a,referenceLatex:c},d)})}function Ane(r,e){switch(r.valueType){case __dcg_shared_module_exports__['za']:return{valueType:__dcg_shared_module_exports__['va'],value:r.value[e]};case __dcg_shared_module_exports__['Ia']:return{valueType:__dcg_shared_module_exports__['Ha'],value:r.value[e]};case __dcg_shared_module_exports__['Ga']:return{valueType:__dcg_shared_module_exports__['Fa'],value:r.value[e]};case __dcg_shared_module_exports__['Oa']:return{valueType:__dcg_shared_module_exports__['Na'],value:r.value[e]};case __dcg_shared_module_exports__['Wa']:return{valueType:__dcg_shared_module_exports__['Va'],value:r.value[e]};case __dcg_shared_module_exports__['Ma']:return{valueType:__dcg_shared_module_exports__['La'],value:r.value[e]};case __dcg_shared_module_exports__['Ea']:return{valueType:__dcg_shared_module_exports__['Da'],value:r.value[e]};case __dcg_shared_module_exports__['Ka']:return{valueType:__dcg_shared_module_exports__['Ja'],value:r.value[e]};case __dcg_shared_module_exports__['Qa']:return{valueType:__dcg_shared_module_exports__['Pa'],value:r.value[e]};case __dcg_shared_module_exports__['Sa']:return{valueType:__dcg_shared_module_exports__['Ra'],value:r.value[e]};case __dcg_shared_module_exports__['Ba']:case __dcg_shared_module_exports__['xa']:case __dcg_shared_module_exports__['wa']:case __dcg_shared_module_exports__['Ua']:case __dcg_shared_module_exports__['ya']:case __dcg_shared_module_exports__['Xa']:case __dcg_shared_module_exports__['Ca']:case __dcg_shared_module_exports__['Aa']:case __dcg_shared_module_exports__['Za']:throw new Error("Programming Error: unexpected type "+__dcg_shared_module_exports__['cb'](r.valueType));default:throw r.valueType,new Error("Programming Error: expected a list type but found "+__dcg_shared_module_exports__['cb'](r.valueType))}}function g2(r,e){return{...r,referenceLatex:r.assignment+"\\left["+e+"\\right]",typedRuntimeValue:Ane(r.typedRuntimeValue,e),listIndex:e}}function n1(r){switch(r){case __dcg_shared_module_exports__['va']:return"Point";case __dcg_shared_module_exports__['Ha']:return"Circle";case __dcg_shared_module_exports__['Ja']:return"Arc";case __dcg_shared_module_exports__['Da']:return"Polygon";case __dcg_shared_module_exports__['La']:return"Line";case __dcg_shared_module_exports__['Fa']:return"Segment";case __dcg_shared_module_exports__['Na']:return"Ray";case __dcg_shared_module_exports__['Va']:return"Vector";case __dcg_shared_module_exports__['Pa']:return"Angle";case __dcg_shared_module_exports__['Ra']:return"Angle"}}function cW(r){if(!r)return;let e=r.typedRuntimeValue;return n1(e.valueType)}function a1(r){if(!r)return 0;if(r.type==="image"&&r.listIndex)return r.listIndex;if("poi"in r)return r.poi.pointIdxOnBranch;if("branchInfo"in r&&r.branchInfo.sketch){let e=r.branchInfo.branch,t=r.branchInfo.sketch.branches[e];return"listIndex"in t&&t.listIndex||0}return 0}var Lne=0,s1=class r{constructor(e,t){this.geoKeyboardPt={x:NaN,y:NaN,lastArrowedX:NaN,lastArrowedY:NaN};this.grapherIsPressed=!1;this.canceledGeoToolplayWhilePressed=!1;this.manager=e,this.controller=e.controller,this.keyboardAttentionManager=new o1(this),this.graphSettings=t,this.elt=this.manager.elt,this.id=Lne++,!(!this.graphSettings.config.graphpaper||this.graphSettings.config.disableMouseInteractions)&&(this.addTouchEventHandlers(),this.addHoverEventHandler(),this.addKeydownEventHandler(),this.addManualUnhoverListener(),this.addGeoEventHandlers())}remove(){this.removeAllGlobalMouseListeners(),this.removeManualUnhoverListener(),this.removeAllGeoListeners(),this.removeHoverEventHandler()}addGlobalMouseListener(e,t){let i=e.split(" ");for(let o of i){let n=o+".dcg-poiController-"+this.id;ie(document).on(n,t)}}removeAllGeoListeners(){ie(document).off(".dcg-poiController-geo-"+this.id)}removeAllGlobalMouseListeners(){ie(document).off(".dcg-poiController-"+this.id)}getToleranceByDevice(e){return e==="touch"?20:10}addGeoEventHandlers(){let e="keydown.dcg-poiController-geo-"+this.id,t="keyup.dcg-poiController-geo-"+this.id,i=e+" "+t;ie(document).on(i,o=>{this.controller.isGeoToolActive()&&this.handleGeoShiftKeyChange(o.shiftKey)}),ie(document).on("mouseleave.dcg-poiController-geo-"+this.id,()=>{if(this.controller.isGeoToolActive()&&!this.grapherIsPressed){let o=this.controller.getGeoModel();o.onMouseAction("move",{pt:{x:NaN,y:NaN},shift:!1,tolerance:0}),o.onPreviewChange()}}),ie(document).on("dcg-tapend.dcg-poiController-geo-"+this.id,o=>{this.controller.isGeoToolActive()&&this.handleGeoTapEnd(o)})}removeHoverEventHandler(){ie(document).off(".dcg-poiController-global-hover-"+this.id)}addHoverEventHandler(){let e="dcg-tapmove.dcg-poiController-global-hover-"+this.id;ie(document).on(e,t=>{var S;let i=t;if(this.controller.isGeoToolActive()&&this.handleGeoTapMove(i)||(this.lastGeoMouseEvent=void 0,i.device==="touch"))return;let o=document.elementFromPoint(i.clientX,i.clientY),n=!!o&&!!o.closest(".dcg-grapher"),a=(S=this.controller.getGrapher3d())==null?void 0:S.webglLayer,s=this.manager.poiLabelsLayer,l=this.getMouseRelativeToGrapher(i),c=this.getToleranceByDevice(i.device);a&&(a==null||a.setMouse(n?l:void 0));let d;n&&(d=this.getFeatureUnderPoint(l,c)),!!((i==null?void 0:i.originalEvent)||i).buttons&&(d=void 0);let p;if(d&&d.type==="movable-point"){let v=d.poi,M=v&&v.getMovablePoint();p=M&&M.id}let g,h=0;d&&d.isClickable&&!this.isBoxSelectActive(i)&&!this.manager.movablePointsLayer.isMovingPoint()&&!this.manager.traceLayer.isTracing()&&(g=d.model,h=a1(d));let f=this.manager.clickableObjectsLayer,y={};g&&(y[g.id]={listIndexes:h===void 0?void 0:{[h]:!0}}),f.setHoveredObjects(y);let x;d&&"poi"in d&&d.poi&&(!d.poi.isAttachedToPlottedPoint()||d.poi.hasInteractiveLabel())&&(x=d.poi),x!==s.getHoveredPOI()&&(this.controller.isTraceEnabled()?s.setHoveredPOI(x):s.setHoveredPOI(void 0),this.controller.requestRedrawGraph());let E=!1;if(d&&d.type==="image"){let v=Nd(d.model),M=d.isClickable;E=v&&!M}let C=!1;d&&d.type==="draggable-label"&&(C=!0),E||C?this.manager.setLayerClass("extraMoveCursor","dcg-mouse-over-movable-point"):this.manager.setLayerClass("extraMoveCursor",""),this.manager.movablePointsLayer.setHoveredPointId(p)})}addManualUnhoverListener(){let e=()=>{let t=this.manager;t.poiLabelsLayer.setHoveredPOI(void 0),t.clickableObjectsLayer.setHoveredObjects({}),this.controller.requestRedrawGraph()};ie(window).on("blur.dcg-poiController-"+this.id,e),ie(this.elt).on("mouseleave",e)}removeManualUnhoverListener(){ie(window).off(".dcg-poiController-"+this.id)}getPickResults(e,t){let i=t.webglLayer,{x:o,y:n}=this.getMouseRelativeToGrapher(e);return i.setMouse({x:o,y:n}),i.pickAtMouseAndReadResults(),i.getPickResult()}isClickable(e){let t=this.controller.getItemModel(e);return Ly(t)}add3DTouchEventHandlers(e){let t=e.elt;if(!t)return;let i=e.webglLayer;ie(t).on("dcg-tapstart",o=>{if(o.touches.length>1)return;let n=this.getPickResults(o,e);if(n!=null&&n.id){let{id:a,index:s}=n;this.isClickable(a)?(i.setPressedAction({id:a,index:s}),o.stopPropagation(),o.preventDefault()):this.controller.dispatch({type:"set-selected-id",id:a})}}),ie(t).on("dcg-tapend dcg-tapcancel",()=>{let o=i.getPressedAction();o&&(i.setPressedAction(void 0),this.controller.dispatch({type:"clickable-item-clicked",id:o.id,listIndex:o.index})),i.isTrackingPressedAction=!1}),ie(t).on("dcg-tapmove",o=>{if(i.isTrackingPressedAction){let n=this.getPickResults(o,e);if(n!=null&&n.id){let{id:a,index:s}=n;this.isClickable(a)?i.setPressedAction({id:a,index:s}):i.setPressedAction(void 0)}else i.setPressedAction(void 0)}})}addTouchEventHandlers(){ie(this.elt).on("touchstart",e=>{let t=e;if(!this.isViewportLocked()){t.target.matches("input, textarea")||t.preventDefault();return}let i=this.getMouseRelativeToGrapher(t),o=this.getToleranceByDevice(t.device),n=this.getFeatureUnderPoint(i,o);n&&(n.type==="image"&&!Na(n.model)&&!Nd(n.model)||n.type==="sketch-branch"&&this.graphSettings.config.onlyTraceSelected&&!n.sketch.selected||t.target.matches("input, textarea")||t.preventDefault())}),ie(this.elt).on("dcg-tapstart",e=>{let t=e;if(this.controller.isGeoToolActive()&&this.handleGeoTapStart(t)){t.handle();return}let i=this.getMouseRelativeToGrapher(t),o=this.getToleranceByDevice(t.device),n=this.getFeatureUnderPoint(i,o);if(!n){this.isBoxSelectActive(t)||this.controller.dispatch({type:"set-none-selected"}),this.isBoxSelectActive(t)?this.startBoxSelect(t):this.manager.viewportController.beginPanning(t);return}if(n.isClickable&&!this.isBoxSelectActive(t)){let l="model"in n&&n.model;l?this.manager.clickableObjectsLayer.setPressedObject({id:l.id,listIndex:a1(n)}):this.manager.clickableObjectsLayer.setPressedObject(void 0)}else this.manager.clickableObjectsLayer.setPressedObject(void 0);if(n.type==="editable-label"){t.handle();return}else pi();if(n.type==="draggable-label"){this.startMovingPoints({poiUnderMouse:void 0,evt:t,points:[{type:"draggable-label",label:n.label,model:n.model,startScreenPt:i}]}),t.handle();return}if(n.type==="clickable-label"&&t.handle(),n.type==="image"&&Nd(n.model)&&!this.isBoxSelectActive(t)){let l=!!n.isClickable;if(this.startMovingPoints({poiUnderMouse:void 0,evt:t,points:[{type:"image",image:n.model,startScreenPt:i,shouldDelayUntilRealMove:l}]}),!l){t.handle();return}}let a=!1,s=n.model;if(this.controller.isGeometry()&&s&&s.type==="expression"&&s.formula.geometry){!this.isBoxSelectActive(t)&&!this.controller.isItemSelected(s.id)&&this.controller.dispatch({type:"set-none-selected"});let l;"poi"in n&&(l=n.poi),a=this.startReverseDrag(s.id,t,l),a&&n.type!=="static-point"&&this.manager.clickableObjectsLayer.setPressedObject({id:s.id,listIndex:a1(n)})}if(n.type==="movable-point"&&(t.handle(),t.handle("do-not-clear-poi-labels"),!a)){this.startMovingPoints({poiUnderMouse:n.poi,evt:t,points:[{type:"poi",poi:n.poi,startScreenPt:i}]});return}if(n.type==="static-point"&&!n.isClickable){let l=n.poi;if(this.controller.isGeometry()){if(l&&l.hasInteractiveLabel()){this._togglePOIUnderPoint(i,o)&&t.handle("do-not-clear-poi-labels");return}}else if(l){this._togglePOIUnderPoint(i,o)&&t.handle("do-not-clear-poi-labels");return}(!n.sketch.selected||this.isBoxSelectActive(t))&&n.model&&this.selectItemIfNotSecret(n.model.id,this.isBoxSelectActive(t));return}if(!a&&this._togglePOIUnderPoint(i,o)){t.handle(),t.handle("do-not-clear-poi-labels");return}if(!a&&n.type==="sketch-branch"&&!n.isClickable){let l=!this.controller.isTraceEnabled();if(this.graphSettings.config.onlyTraceSelected){if(t.handle("do-not-clear-poi-labels"),!l&&n.sketch.selected&&!this.isBoxSelectActive(t)){this.startTracingBranch(n,i),t.handle();return}}else{let c=!this.controller.isListEnabled();if(l&&c||(this.selectItemIfNotSecret(n.sketch.id,this.isBoxSelectActive(t)),l))return;this.startTracingBranch(n,i),t.handle(),t.handle("do-not-clear-poi-labels");return}}this.addGlobalMouseListener("dcg-tapmove",l=>{this.manager.clickableObjectsLayer.isAnObjectPressed()?i=this.getMouseRelativeToGrapher(l):(this.removeAllGlobalMouseListeners(),this.manager.viewportController.beginPanning(l))}),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",l=>{this.removeAllGlobalMouseListeners();let c=this.manager.clickableObjectsLayer.getPressedObject(),d=c&&c.id;this.manager.clickableObjectsLayer.setPressedObject(void 0);let p=this.getFeatureUnderPoint(i,o);if(p&&p.isClickable){let g="model"in p&&p.model;g&&g.id===d&&!l.wasHandled("dragged-clickable-object")&&!this.isBoxSelectActive(l)&&this.controller.dispatch({type:"clickable-item-clicked",id:g.id,listIndex:a1(p)});return}if(!a){if(p&&p.type==="sketch-branch"&&(!p.sketch.selected||this.isBoxSelectActive(l))){this.selectItemIfNotSecret(p.model.id,this.isBoxSelectActive(l));return}if(p&&(p.type==="movable-point"||p.type==="static-point")){(!p.sketch.selected||this.isBoxSelectActive(l))&&p.model&&this.selectItemIfNotSecret(p.model.id,this.isBoxSelectActive(l));return}if(p&&p.type==="image"){this.selectItemIfNotSecret(p.model.id,this.isBoxSelectActive(l));return}}})})}isBoxSelectActive(e){if(!this.controller.isMultiSelectEnabled())return!1;let t=this.controller.getActiveTool();return t==="selection"&&e.shiftKey||t==="box-selection"}isViewportLocked(){return this.graphSettings.config.lockViewport||this.graphSettings.userLockedViewport}addKeydownEventHandler(){ie(this.elt).on("keydown",e=>{var s,l,c;let t=e;if(this.manager.getAudioTrace().getAudioTraceActive())return;let i=this.manager.movablePointsLayer.getPOIUnderAttention(),o=this.manager.imageLayer.getFocusedImage(),n=Be(t),a=ji(t);if((n==="Up"||n==="Down"||n==="Left"||n==="Right")&&this.controller.isGraphPaperFocused()){t.stopPropagation(),t.preventDefault();let d=this.keyboardAttentionManager.getKeyboardAttention();if(d&&this.controller.shouldAllowMovingPointsWithKeyboard()){let p=o?o.centerId:d.calcId;if(!p)return;let g=this.getDraggablePointOrAncestors(p);this.movePointsFromKeyboard(g,t),this.controller.getEvaluator().notifyWhenSynced(()=>{this.describeFocusedItem({includeDetails:!0})})}else this.controller.isVirtualMouseAllowed()&&(this.keyboardAttentionManager.updateKeyboardAttention(void 0,{describe:!1}),this.moveGeoPointFromKeyboard(t))}else if(n==="Tab"&&this.controller.isGraphPaperFocused()){let d=t.shiftKey?"prev":"next",p=this.keyboardAttentionManager.getKeyboardAttention();if(!(this.controller.getActiveTool()!=="selection")&&!p&&d==="prev")return;this.handleTabEvent(d,t)}else if((n==="Enter"||n==="Space")&&this.controller.isGraphPaperFocused()&&this.controller.getActiveTool()==="selection"){let d=this.keyboardAttentionManager.getKeyboardAttention();if(d){let p=this.controller.getItemModel(d.calcId);if(p&&!this.isBoxSelectActive(t)){let g=p.type==="expression"&&cs(p),h=p.type==="image"&&mf(p);(g||h)&&this.controller.dispatch({type:"clickable-item-clicked",id:d.calcId,listIndex:d.listIndex})}}t.preventDefault(),t.stopPropagation();return}else if(this.controller.isGeometry()&&this.controller.isGraphPaperFocused()){let d=!1;if(t.ctrlKey&&t.shiftKey&&!t.altKey&&!t.metaKey){let p;if(a==="O"?p={type:"multi-select-more",guid:Lf(),focusFirstOption:!0,previousFocusLocation:{type:"graph-paper"}}:a==="A"&&(p={type:"multi-select-transformations",guid:XC(),focusFirstOption:!0,previousFocusLocation:{type:"graph-paper"}}),p){t.preventDefault(),t.stopPropagation();let g=this.keyboardAttentionManager.getKeyboardAttention();this.controller.getActiveTool()!=="box-selection"&&g&&this.controller.getItemModel(g.calcId)&&this.controller.dispatch({type:"set-selected-id",id:g.calcId}),this.controller.dispatch({type:"toggle-item-settings-menu",menu:p})}}else if(!t.altKey&&!t.ctrlKey&&!t.metaKey){if(n==="Enter"||n==="Space")if(t.preventDefault(),this.controller.getActiveTool()!=="selection"&&t.stopPropagation(),this.controller.getActiveTool()==="box-selection"){let p=((s=this.keyboardAttentionManager.getKeyboardAttention())==null?void 0:s.calcId)||"";this.controller.isClickableId(p)&&(p=""),this.selectItemIfNotSecret(p,!0),this.describeFocusedItem({includeDetails:!1})}else{let p=this.keyboardAttentionManager.getKeyboardAttention();p!=null&&p.geoDef?this.tapGeoObjectFromKeyboard(p.geoDef,t):this.tapGeoPointFromKeyboard(t)}else if(a==="?")t.preventDefault(),t.stopPropagation(),this.controller.getGeoModel().speakCurrentGeoToolHint();else if(a==="D")t.preventDefault(),t.stopPropagation(),this.describeFocusedItem({includeDetails:!0});else if(n==="Backspace"||n==="Del"){t.preventDefault(),t.stopPropagation();let p=this.keyboardAttentionManager.getKeyboardAttention();this.controller.getActiveTool()!=="box-selection"&&p&&this.controller.getItemModel(p.calcId)&&this.controller.dispatch({type:"set-selected-id",id:p.calcId}),this.controller.dispatch({type:"delete-all-selected-items"}),d=!0}else if(a==="-"||a==="="){t.preventDefault(),t.stopPropagation();let p=this.controller.getAllVisibleGeoToolbarItems(),g=p.findIndex(h=>(h==null?void 0:h.current)===this.controller.getActiveTool());for(let h=1;h<p.length;h++){let f=g+(a==="-"?-h:h);f<0&&(f=p.length+f),f>p.length-1&&(f=f-p.length);let y=(l=p[f])==null?void 0:l.current;if(this.selectGeoTool(y)){d=!0;break}}}else if(a==="["||a==="]"){t.preventDefault(),t.stopPropagation();let g=this.controller.getAllVisibleGeoToolbarItems().find(y=>(y==null?void 0:y.current)===this.controller.getActiveTool());if(!g)return;let h=g.dropdown||[g.current];if(h.length===0)return;let f=h.indexOf(g.current);for(let y=1;y<h.length;y++){let x=f+(a==="["?-y:y);x<0&&(x=h.length+x),x>h.length-1&&(x=x-h.length);let E=h[x];if(this.selectGeoTool(E)){d=!0;break}}}else if(!t.shiftKey&&a!==void 0&&a>="0"&&a<="9"){let p=(c=this.controller.getAllVisibleGeoToolbarItems()[t.which-49])==null?void 0:c.current;d=this.selectGeoTool(p)}}d&&this.handleGeoKeyboardPtMove()}else i&&(a==="X"||a==="Y"||a==="L"||a==="C")?this.speakPoint(i,a):o&&(a==="X"||a==="Y"||a==="L")&&this.manager.imageLayer.speakImageAttribute(o,a)})}selectGeoTool(e){return e?this.controller.isGeoToolEnabled(e)?(this.controller.dispatch({type:"select-geo-tool",tool:e}),!0):(Te(this.controller.s("graphing-calculator-narration-geometry-tool-disabled",{tool:this.controller.getGeoModel().getDisplayNameForTool(e)})),!1):!1}getMouseRelativeToGrapher(e){let t=this.elt.getBoundingClientRect(),i=e.touches?e.touches[0]:e,o=i.clientX-t.left,n=i.clientY-t.top;return{x:o,y:n}}_getStyledPointRadiusAdjustments(){return{radiusMultiplier:this.graphSettings.getHighlightPropertyMultiplier("pointLineWidth",!1),selectedRadiusMultiplier:this.graphSettings.getHighlightPropertyMultiplier("pointLineWidth",!0)}}_getStyledPointRadiusForPOI(e,t){let i=e.getPointSize()/2,o=e.isSelected()?t.selectedRadiusMultiplier:t.radiusMultiplier;return i*o}handleTabEvent(e,t){let i=this.controller.getActiveTool()!=="selection";if(this.keyboardAttentionManager.focusNextObjFromKeyboard({direction:e,allowWrapping:i,selectNonClickables:this.controller.getActiveTool()==="selection"})){t==null||t.preventDefault(),t==null||t.stopPropagation();return}else if(!i){this.keyboardAttentionManager.updateKeyboardAttention(void 0,{describe:!1}),e==="prev"&&(t==null||t.preventDefault(),t==null||t.stopPropagation(),this.manager.speakGrapherFocusAriaLabel());return}}_getDistanceFromStyledPOI(e,t){let i=this._getStyledPointRadiusForPOI(e,t.adjustments),o=Math.max(0,t.tolerance-i),n=t.projection.map_pt(e),a=__dcg_shared_module_exports__['da'](n.x-t.screenPt.x,n.y-t.screenPt.y),s=Math.max(0,a-i);if(s<=o)return s}_getClosestPoint(e,t,i){let o=1/0,n,a={projection:this.manager.getProjection(),adjustments:this._getStyledPointRadiusAdjustments(),screenPt:t,tolerance:i};for(let s of e){let l=this._getDistanceFromStyledPOI(s,a);l!==void 0&&l<=o&&(o=l,n=s)}return n}findIdsThatIntersectBox(e){let t={},i=this.manager.getSketchOrder();for(let o=i.length-1;o>=0;o--){let n=i[o],a=this.controller.getItemModel(n);if(a&&!this.controller.shouldIgnoreGraphInteractions(a)){if(a.type==="expression"){let s=this.manager.getGraphSketch(n);if(!s||cs(a)||this.controller.isItemNotSelectableBecauseItsSecret(n))continue;let l=s.branches;if(!l||!l.length)continue;for(let c=0;c<l.length;c++)if(this.doesBoxIntersectBranch(l[c],e)){t[a.id]=!0;break}}else if(a.type==="image"){let s=this.manager.getGraphImage(n);if(!s)continue;r.doesBoxIntersectAnyImage(s,e)&&(t[a.id]=!0)}}}return this.manager.poiDotsLayer.getDrawnPOI().forEach(o=>{let n=o.sketch.id,a=this.controller.getItemModel(n);a&&this.controller.shouldIgnoreGraphInteractions(a)||a&&a.type==="expression"&&cs(a)||this.controller.isItemNotSelectableBecauseItsSecret(n)||o.isBareLabel()||(o.isMovable()||o.isAttachedToPlottedPoint())&&r.doesBoxIntersectPOI(o,e)&&(t[n]=!0)}),t}_getStyledLineAdjustments(){return{thicknessMultiplier:this.graphSettings.getHighlightPropertyMultiplier("graphLineWidth",!1),selectedThicknessMultiplier:this.graphSettings.getHighlightPropertyMultiplier("graphLineWidth",!0)}}_getStyledLineThicknessForBranch(e,t,i){let o=Math.max(0,"lineWidth"in e&&e.lineWidth||0)/2;return t?o*i.selectedThicknessMultiplier:o*i.thicknessMultiplier}_getDistanceFromStyledBranch(e,t,i,o){let n=this._getStyledLineThicknessForBranch(e,t,o.adjustments),a=this.calculateDistanceFromBranch(e,o.screenPt,o.projection,i),s=Math.max(0,a-n),l=Math.max(0,o.tolerance-n);if(s<=l)return s}getFeatureUnderPoint(e,t){var S;let i=this.manager.poiLabelsLayer,o=this.manager.getProjection();if(this.manager.scaleAxis)return;let n=i.getInteractiveLabelUnderPoint(e);if(n&&!this.controller.shouldIgnoreGraphInteractions(n.model))switch(n.type){case"editable":return{type:"editable-label",model:n.model,isClickable:void 0};case"draggable":return{type:"draggable-label",label:n.label,model:n.model,isClickable:void 0};case"clickable":return{type:"clickable-label",model:n.model,poi:n.poi,isClickable:!0}}let a=this.manager.getSketchOrder(),s={},l=1,c,d={adjustments:this._getStyledLineAdjustments(),projection:o,screenPt:e,tolerance:t};for(let v=a.length-1;v>=0;v--){let M=a[v],A=this.controller.getItemModel(M),I=l;if(s[M]=I,!!A&&!this.controller.shouldIgnoreGraphInteractions(A)){if(A.type==="expression"){let P=this.manager.getGraphSketch(M);if(!P)continue;let _=P.branches;if(!_||!_.length)continue;if(P.showHighlight&&!this.controller.isGeometry()&&(I=-1/0,s[M]=I),!c||c.stackingContext>=I){let U=cs(A);for(let Y=0;Y<_.length;Y++){let R=_[Y],H=this._getDistanceFromStyledBranch(R,P.showHighlight,U,d);if(H!==void 0){let O=!1;c?(I<c.stackingContext||I===c.stackingContext&&H<c.distance-3.5)&&(O=!0):O=!0,O&&(c={type:"sketch-branch",model:A,sketch:P,distance:H,stackingContext:I,branchInfo:{id:P.id,branch:Y,sketch:P}})}}}}else if(A.type==="image"){let P=this.manager.getGraphImage(M);if(!P)continue;let _=this.getImageInfoUnderMouse(P,o.pixelsToMath.mapPoint(e),t);if(!_)continue;P.foreground?(l+=1,I=l,s[M]=I,l+=1):(I=1/0,s[M]=I),(!c||c.stackingContext>I)&&(c={type:"image",model:P,distance:0,stackingContext:I,listIndex:_.listIndex})}}}let p=[],g=[],h=[],f=[],y=c?c.stackingContext:1/0;this.manager.poiDotsLayer.getDrawnPOI().forEach(v=>{var I;if(v.isBareLabel())return;let M=v.sketch.id,A=this.controller.getItemModel(M);if(!(A&&this.controller.shouldIgnoreGraphInteractions(A))){if(!A&&v.sketch.branches.length>0){let P=v.sketch.branches[0].tableId,_=P!==void 0?this.controller.getItemModel(P):void 0,U=(_==null?void 0:_.type)==="table"&&jn(_,M);if(U&&this.controller.shouldIgnoreGraphInteractions(U))return}if(v.isMovable()){let P=A&&A.type==="expression"&&((I=A.formula.geometry)==null?void 0:I.call);P&&P.symbol==="glider"?p.push(v):g.push(v)}else v.isAttachedToPlottedPoint()?s[v.sketch.id]<=y&&h.push(v):f.push(v)}});let x=this._getClosestPoint(p,e,t);if(x||(x=this._getClosestPoint(g,e,t)),x)return{type:"movable-point",poi:x,isClickable:void 0,sketch:x.sketch,model:this.controller.getItemModel(x.sketch.id)};let E=this._getClosestPoint(f,e,t);if(E)return{type:"poi",poi:E,isClickable:!1,model:void 0};let C=this._getClosestPoint(h,e,t);if(C){let v=this.controller.getItemModel(C.sketch.id);return v&&v.type==="expression"&&cs(v)?{type:"static-point",poi:C,sketch:C.sketch,isClickable:!0,model:v}:{type:"static-point",poi:C,isClickable:!1,sketch:C.sketch,model:v}}if(c){if(c.type==="sketch-branch"){let v=(S=c.model.formula.typed_constant_value)==null?void 0:S.valueType;return{type:"sketch-branch",branchInfo:c.branchInfo,sketch:c.sketch,model:c.model,isClickable:cs(c.model),isTraceable:!(this.controller.isGeometry()&&v&&__dcg_shared_module_exports__['fb'](v)),isSelected:this.controller.isItemSelected(c.sketch.id),selectionId:this.controller.isItemSelectable(c.model.id)?c.model.id:void 0}}else if(c.type==="image")return{type:"image",model:c.model,isClickable:mf(c.model),listIndex:c.listIndex,isSelected:this.controller.isItemSelected(c.model.id),selectionId:this.controller.isItemSelectable(c.model.id)?c.model.id:void 0}}}_togglePOIUnderPoint(e,t){if(!this.controller.isTraceEnabled())return;let i=this.getFeatureUnderPoint(e,t);if(!i||i.isClickable)return!1;let o="poi"in i&&i.poi;return!o||o.isBareLabel()?!1:(this.manager.poiLabelsLayer.isOpenPOI(o)?(this.manager.poiLabelsLayer.closePOI(o),this.manager.poiLabelsLayer.setHoveredPOI(void 0)):(this.manager.poiLabelsLayer.openPOI(o),this.speakPoint(o)),this.controller.requestRedrawGraph(),!0)}getImageInfoUnderMouse(e,t,i){if(!e)return;let o=e.formula;if(!o)return;let n=o.dimensions;if(!(!n.x||!n.y||!n.width||!n.height||!n.radianAngle||!e.shouldGraph))for(let a=n.x.length-1;a>=0;a--){let s=n.x[a],l=n.y[a],c=n.radianAngle[a],d=s+Math.cos(c)*(t.x-s)-Math.sin(c)*(t.y-l),p=l+Math.sin(c)*(t.x-s)+Math.cos(c)*(t.y-l),g=.5*Math.abs(n.width[a]),h=.5*Math.abs(n.height[a]);if(d>s-g&&d<s+g&&p>l-h&&p<l+h)return{listIndex:a}}}doesBoxIntersectBranch(e,t){let i=!1,o=!1;switch(e.graphMode){case 5:case 8:case 2:break;case 6:i=!0;break;case 1:o=!0;break;case 18:case 17:case 19:case 24:return OT(t,{x1:e.segments[0][0],y1:e.segments[0][1],x2:e.segments[0][2],y2:e.segments[0][3],extendStart:e.graphMode===18,extendEnd:e.graphMode!==17});case 20:return h6(t,{x:e.segments[0][0],y:e.segments[0][1],radius:e.segments[0][2]});case 21:case 23:{let[a,s]=e.segments[0],[l,c,d]=e.graphMode===21?this.getBoxIntersectArgsForArc(e):this.getBoxIntersectArgsForAngleMarker(e),p=(d-c)/2+c;return u6(t,{x0:a+l*Math.cos(c),y0:s+l*Math.sin(c),x1:a+l*Math.cos(p),y1:s+l*Math.sin(p),x2:a+l*Math.cos(d),y2:s+l*Math.sin(d)})}default:return!1}let n=e.segments;for(let a=0;a<n.length;a++){let s=n[a];if(i){let l=s;s=[];for(let c=0;c<l.length;c+=2){let d=l[c],p=l[c+1];s.push(p*Math.cos(d),p*Math.sin(d))}}else if(o){let l=s;s=[];for(let c=0;c<l.length;c+=2)s.push(l[c+1],l[c])}if(g6(t,s))return!0}return!1}getBoxIntersectArgsForArc(e){return[e.segments[0][2],e.segments[0][3],e.segments[0][4]]}getBoxIntersectArgsForAngleMarker(e){let t=e.segments[0][3],i=this.manager.getProjection(),o=Lg(t,i),n=i.pixelsToMath.dangerouslyGetXScaleFactor(),a=i.pixelsToMath.dangerouslyGetYScaleFactor();return[Math.abs(Math.min(n,a))*o,e.segments[0][2],e.segments[0][2]+t]}static doesBoxIntersectAnyImage(e,t){let i=e.formula;if(!i)return;let o=i.dimensions;if(!(!o.x||!o.y||!o.width||!o.height||!o.radianAngle||!e.shouldGraph)){for(let n=o.x.length-1;n>=0;n--)if(m6(t,{width:o.width[n],height:o.height[n],angle:o.radianAngle[n],center:{x:o.x[n],y:o.y[n]}}))return!0;return!1}}static doesBoxIntersectPOI(e,t){return t.left<=e.x&&e.x<=t.right&&t.top<=e.y&&e.y<=t.bottom}calculateDistanceFromBranch(e,t,i,o){let n=this.controller.isGeometry()&&e.graphMode===7;if(o||n){let l=[t.x,t.y],c=kO(i,e);for(let d of c)if(__dcg_shared_module_exports__['ra'](d,l))return 0}if(e.graphMode===7)return 1/0;let s=r.getBranchesDistanceInfo(e,t,i,o,this.controller.isGeometry());return s?s.minDistance:1/0}static getBranchesDistanceInfo(e,t,i,o,n){let a=t.x,s=t.y,{mathToPixels:l,pixelsToMath:c}=i;switch(e.graphMode){case 5:if(!n&&!o)return;break;case 8:if(!o)return;break;case 6:if(!o)return;break;case 2:case 1:break;case 23:{let[E,C,S,v]=e.segments[0],M=l.dangerouslyGetXScaleFactor(),A=l.dangerouslyGetYScaleFactor(),[I,P]=c.mapCoordinatePair([a,s]),_=Lg(v,i),U=_/M,Y=1/0,R=P-C,H=I-E,O=Math.atan2(R,H);if(__dcg_shared_module_exports__['ba'](O,S,v))__dcg_shared_module_exports__['da'](R*A,H*M)<=_+7&&(Y=0);else{let q=__dcg_shared_module_exports__['ga'](I,P,E+U*Math.cos(S),C+U*Math.sin(S),E,C),w=__dcg_shared_module_exports__['ga'](I,P,E+U*Math.cos(S+v),C+U*Math.sin(S+v),E,C),T=__dcg_shared_module_exports__['da'](M*(q[0]-I),A*(q[1]-P)),B=__dcg_shared_module_exports__['da'](M*(w[0]-I),A*(w[1]-P));Y=Math.min(T,B)}return{closestPoint:{x:a,y:s},minDistance:Y,secondDistance:Y}}break;case 18:case 17:case 19:case 24:{if(!e.segments.length)return null;let E=l.mapX(e.segments[0][0]),C=l.mapY(e.segments[0][1]),S=l.mapX(e.segments[0][2]),v=l.mapY(e.segments[0][3]),M=e.graphMode===18,A=e.graphMode===18||e.graphMode===19,I=__dcg_shared_module_exports__['ha'](a,s,E,C,S,v,M,A);if(!I)return null;let P=__dcg_shared_module_exports__['da'](I[0]-a,I[1]-s);return{closestPoint:{x:I[0],y:I[1]},minDistance:P,secondDistance:P}}case 21:case 20:{let E=e.segments[0][0],C=e.segments[0][1],S=e.segments[0][2],v=e.graphMode===21?e.segments[0][3]:0,M=e.graphMode===21?e.segments[0][4]:Math.PI*2,A=__dcg_shared_module_exports__['ia'](c.mapX(a),c.mapY(s),E,C,S,v,M);if(!A)return null;let I=l.mapCoordinatePair(A),P=__dcg_shared_module_exports__['da'](I[0]-a,I[1]-s);return{closestPoint:{x:I[0],y:I[1]},minDistance:P,secondDistance:P}}default:return}let d=1/0,p=1/0,g,h;for(let E=0;E<e.segments.length;E++){let C=e.segments[E];for(let S=0;S<C.length-3;S+=2){let v=C[S],M=C[S+1],A=C[S+2],I=C[S+3];if(e.graphMode===6){let q=M,w=v;v=q*Math.cos(w),M=q*Math.sin(w);let T=I,B=A;A=T*Math.cos(B),I=T*Math.sin(B)}e.graphMode===1&&([v,M]=[M,v],[A,I]=[I,A]);let[P,_]=l.mapCoordinatePair([v,M]),[U,Y]=l.mapCoordinatePair([A,I]),R=__dcg_shared_module_exports__['ga'](0,0,P-a,_-s,U-a,Y-s),H=__dcg_shared_module_exports__['da'](R[0],R[1]);R[e.graphMode===1?1:0]<0?H<d&&(d=H,g=R):H<p&&(p=H,h=R)}}let f=d<p?g:h;if(!f)return;let y=f[0]+a,x=f[1]+s;return{closestPoint:{x:y,y:x},minDistance:Math.min(d,p),secondDistance:Math.max(d,p)}}static getBranchesTracePoint(e,t,i,o){let n,a=i.pixelsToMath.mapPoint(t);switch(e.graphMode){case 20:case 21:{let _=e.graphMode===21?e.segments[0][3]:0,U=e.graphMode===21?e.segments[0][4]:Math.PI*2;n=__dcg_shared_module_exports__['ia'](a.x,a.y,e.segments[0][0],e.segments[0][1],e.segments[0][2],_,U);break}case 18:case 19:case 17:n=__dcg_shared_module_exports__['ha'](a.x,a.y,e.segments[0][0],e.segments[0][1],e.segments[0][2],e.segments[0][3],e.graphMode===18,e.graphMode!==17);break}if(n)return{x:n[0],y:n[1]};if(!e)return;let s="compiled"in e&&e.compiled,l=s&&s.fn;if(!l)return;let c=this.getBranchesDistanceInfo(e,t,i,!1,o);if(!c)return;let{mathToPixels:d,pixelsToMath:p}=i,g,h;e.graphMode===2?(h="x",g="y"):(h="y",g="x",d=new __dcg_shared_module_exports__['_c'](d.yScale,d.xScale),p=d.inverse());let f=Math.pow(c.minDistance/c.secondDistance,2),y=c.closestPoint[h]*(1-f)+t[h]*f,x=.5,E=.5,C=d.mapY(l(p.mapX(y-x))),S=d.mapY(l(p.mapX(y))),v=d.mapY(l(p.mapX(y+x))),M=x*Math.min(1,E/Math.abs(C-S)),A=x*Math.min(1,E/Math.abs(v-S));isFinite(M)||(M=x),isFinite(A)||(A=x);let I=Yi(p.mapX(y-M),p.mapX(y+A)),P=l(I);if(!isFinite(d.mapY(P))){let _=d.mapX(I)-x,U=d.mapX(I)+x,Y=p.mapX(_),R=p.mapX(U),H=l(Y),O=l(R),q=d.mapY(H),w=d.mapY(O);Math.abs(q-t[g])<Math.abs(w-t[g])?P=H:P=O}return{x:e.graphMode===2?I:P,y:e.graphMode===2?P:I}}getPointInfo(e){switch(e.type){case"movable-point":case"static-labeled-point":return pW(e);case"poi":return pW(e.poi.getMovablePoint());case"movable-point-parent":return{calcId:e.id,isReverseDrag:!0};case"image":return{calcId:e.image.formula.center_reference_id,isReverseDrag:!1};case"draggable-label":return{calcId:e.model.id,isReverseDrag:!1};default:return e}}getDraggablePointOrAncestors(e){var s,l;if(!this.controller.isGeometry()){let c=this.controller.getItemModel(e);return c&&c.type==="expression"&&aG(c)&&((l=(s=c.formula)==null?void 0:s.typed_constant_value)==null?void 0:l.valueType)===__dcg_shared_module_exports__['va']&&mo(c)!=="NONE"?[{type:"movable-point-parent",id:e,x:c.formula.typed_constant_value.value[0],y:c.formula.typed_constant_value.value[1],shouldDelayUntilRealMove:!0}]:[]}let t=[e].concat(this.controller.getAllSelectedItems().map(c=>c.id).filter(c=>c!==e)),i=!1,o={},n=[];_f({controller:this.controller},(c,d)=>{if(!d&&c.typedRuntimeValue.valueType===__dcg_shared_module_exports__['va']&&c.data.isMovablePoint){let[p,g]=c.typedRuntimeValue.value;o[c.calcId]={id:c.calcId,value:{x:p,y:g}}}});let a=this.controller.getGeoModel().getComputedBoard().computeReversibilityLineages(t);for(let c in a){let d=o[c];if(!d){i=!0;break}n.push({type:"movable-point-parent",id:c,x:d.value.x,y:d.value.y,shouldDelayUntilRealMove:!0,transformations:a[c]})}return i?[]:n}getFeatureCenterMathPoint(e){switch(e.type){case"poi":return e.poi;case"movable-point-parent":let t={x:e.x,y:e.y};if(e.transformations){let i=__dcg_shared_module_exports__['_b'](e.transformations.forward,[t.x,t.y]);t={x:i[0],y:i[1]}}return t;case"image":return{x:e.image.formula.dimensions.x[0],y:e.image.formula.dimensions.y[0]};case"draggable-label":return{x:e.label.x,y:e.label.y}}}startReverseDrag(e,t,i){let o=this.getMouseRelativeToGrapher(t),n=this.getDraggablePointOrAncestors(e).map(a=>({...a,startScreenPt:o}));return n.length>0?(this.startMovingPoints({poiUnderMouse:i,evt:t,points:n}),!0):!1}startMovingPoints(e){let t=e.evt,i=e.points,o=!1,n=!1,a=i.map(this.getPointInfo),s=this.controller;function l(){n=!0,s.dispatch({type:"start-moving-points",points:a})}let c=!1;for(let f of i)if(f.shouldDelayUntilRealMove){c=!0;break}c||l();let d;e.poiUnderMouse&&e.poiUnderMouse.isMovable()&&(d=e.poiUnderMouse.getMovablePoint().id),this.manager.movablePointsLayer.setPressedPointId(d);let p=i.map(f=>{let y=this.manager.getProjection().map_pt(this.getFeatureCenterMathPoint(f));return{x:f.startScreenPt.x-y.x,y:f.startScreenPt.y-y.y}}),g,h=()=>{if(!g)return;o=!0,n||l();let f=this.manager.getProjection(),y=this.getMouseRelativeToGrapher(g);g=void 0,this.controller.dispatch({type:"on-move-points",points:i.map(this.getPointInfo),screenPts:p.map(function(x){return{x:y.x-x.x,y:y.y-x.y}}),transform:i.map(x=>x.type==="movable-point-parent"?x.transformations:void 0),previousScreenPts:i.map(x=>x.startScreenPt),projection:f})};this.manager.registerMovablePointListener(h),this.addGlobalMouseListener("dcg-tapmove",f=>{g=f}),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",f=>{if(h(),this.manager.deregisterMovablePointListener(),this.removeAllGlobalMouseListeners(),this.manager.movablePointsLayer.setPressedPointId(void 0),n&&(f.handle("dragged-clickable-object"),this.controller.dispatch({type:"stop-moving-points",points:i.map(this.getPointInfo)})),!o){let y=this.getMouseRelativeToGrapher(t),x=this.getToleranceByDevice(t.device),E=this.getFeatureUnderPoint(y,x);if(E&&E.type==="movable-point")if(this.controller.isGeometry())(!E.sketch.selected||this.isBoxSelectActive(f))&&E.model&&this.selectItemIfNotSecret(E.model.id,this.isBoxSelectActive(f));else return;else if(E&&E.type==="sketch-branch"){let C=E.model;C&&C.formula.geometry&&!E.isClickable&&(!E.sketch.selected||this.isBoxSelectActive(f))&&this.selectItemIfNotSecret(E.model.id,this.isBoxSelectActive(f))}}})}startTracingBranch(e,t){if(!e.isTraceable)return;let i=e.branchInfo;this.manager.markLabelsDirty(),this.lastScreenPt=t;let o=this.manager.getProjection(),a=i.sketch.branches[i.branch],s=r.getBranchesTracePoint(a,t,o,this.controller.isGeometry());s&&this.speakPoint(s),this.manager.traceLayer.setTraceInfo({pt:s,branchInfo:i}),this.controller.requestRedrawGraph(),this.addGlobalMouseListener("dcg-tapmove",this.handleTraceUpdate.bind(this)),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",this.stopTracingBranch.bind(this))}stopTracingBranch(e){this.manager.markLabelsDirty();let t=this.manager.poiLabelsLayer.getHoveredPOI();t&&!this.manager.poiLabelsLayer.isOpenPOI(t)&&(this.manager.poiLabelsLayer.openPOI(t),this.speakPoint(t),this.controller.requestRedrawGraph()),this.lastScreenPt=void 0,this.manager.traceLayer.setTraceInfo(void 0),this.controller.requestRedrawGraph(),this.removeAllGlobalMouseListeners()}handleTraceUpdate(e){if(!this.manager.traceLayer.traceInfo)return;let t=this.manager.getProjection(),i;if(e)i=this.getMouseRelativeToGrapher(e),this.lastScreenPt=i,this.manager.markLabelsDirty();else if(this.lastScreenPt)i=this.lastScreenPt;else return;let o=1/0,n=-1,a=this.manager.traceLayer.traceInfo,s=this.manager.graphSketches[a.branchInfo.sketch.id];if(!s)return;a.branchInfo.sketch=s;let l=a.branchInfo.sketch.branches;for(let p=0;p<l.length;p++){let g=this.calculateDistanceFromBranch(l[p],i,t,!1);g<o&&(n=p,o=g)}let c=l[n],d=c?r.getBranchesTracePoint(c,i,t,this.controller.isGeometry()):void 0;d&&this.speakPoint(d),this.manager.traceLayer.traceInfo.branchInfo.branch=n,this.manager.traceLayer.traceInfo.pt=d,this.controller.requestRedrawGraph()}hasNonlinearMoveStrategy(e){if(!e||e.type!=="movable-point-parent")return!1;let t=this.controller.getItemModel(e.id);if(!t||t.type!=="expression"||!t.formula)return!1;let i=t.formula.move_strategy;return!i||!i[0]?!1:i[0].type==="updateSliderNonlinear"}movePointsFromKeyboard(e,t){if(!t)return;let i=this.manager.getProjection(),o=e.map(h=>{let{x:f,y}=i.map_pt(this.getFeatureCenterMathPoint(h));return{x:f,y}}),n=0,a=0,s=Be(t),l=(i.pixelCoordinates.right-i.pixelCoordinates.left)/40,c=(i.pixelCoordinates.bottom-i.pixelCoordinates.top)/40,d=s==="Up"||s==="Down"?c:l;d=t.shiftKey?d*5:d;let p,g;if(s==="Up"?(g="y",a-=d,p=t.shiftKey?"bigup":"up"):s==="Down"?(g="y",a+=d,p=t.shiftKey?"bigdown":"down"):s==="Left"?(g="x",n-=d,p=t.shiftKey?"bigdown":"down"):s==="Right"&&(g="x",n+=d,p=t.shiftKey?"bigup":"up"),p){let h=o.map(({x:y,y:x})=>({x:y+n,y:x+a})),f;g==="x"||e.some(y=>this.hasNonlinearMoveStrategy(y))?f={x:p}:g==="y"&&(f={y:p}),this.controller.dispatch({type:"on-move-points",points:e.map(y=>this.getPointInfo(y)),screenPts:h,previousScreenPts:o,transform:e.map(y=>y.type==="movable-point-parent"?y.transformations:void 0),projection:i,keyboardDirection:f})}}getGeoKeyboardPt(){return this.initGeoKeyboardPt(),this.geoKeyboardPt}setGeoKeyboardPt(e){this.geoKeyboardPt={...this.geoKeyboardPt,x:e.x,y:e.y},e.fromArrowKeys&&(this.geoKeyboardPt.lastArrowedX=e.x,this.geoKeyboardPt.lastArrowedY=e.y),this.controller.requestRedrawGraph()}initGeoKeyboardPt(){if(!isNaN(this.geoKeyboardPt.x)&&!isNaN(this.geoKeyboardPt.y))return;let e=this.manager.getProjection();if(!e)return;let t=e.viewport,i=Qc(e),o=i.minorStepX,n=i.minorStepY,a=Math.round((t.xmin+t.xmax)/2/o)*o,s=Math.round((t.ymin+t.ymax)/2/n)*n;this.setGeoKeyboardPt({x:a,y:s})}moveGeoPointFromKeyboard(e){if(!e)return;this.initGeoKeyboardPt();let t=this.manager.getProjection();if(!t)return;let i=t.viewport,o=Qc(t),n=o.minorStepX/4,a=o.minorStepY/4,s=this.geoKeyboardPt.x,l=this.geoKeyboardPt.y,c=Be(e);if(c==="Down"?e.ctrlKey?l=i.ymin:l=Math.max(Math.round((l-a)/a)*a,i.ymin):c==="Up"?e.ctrlKey?l=i.ymax:l=Math.min(Math.round((l+a)/a)*a,i.ymax):c==="Left"?e.ctrlKey?s=i.xmin:s=Math.max(Math.round((s-n)/n)*n,i.xmin):c==="Right"&&(e.ctrlKey?s=i.xmax:s=Math.min(Math.round((s+n)/n)*n,i.xmax)),s!==this.geoKeyboardPt.x||l!==this.geoKeyboardPt.y){this.setGeoKeyboardPt({x:s,y:l,fromArrowKeys:!0}),this.handleGeoKeyboardPtMove(e),Kt(AT(this.controller,this.geoKeyboardPt.x,this.geoKeyboardPt.y));let d=this.manager.clickableObjectsLayer.getHoveredObjects();for(let p in d){let g=this.controller.getItemModel(p);g!==void 0&&Kt(this.controller.s("graphing-calculator-narration-geometry-near-item",{item:nn(g,this.controller,{includeDetails:!1,depth:1})}))}Te()}}handleGeoKeyboardPtMove(e){this.initGeoKeyboardPt();let t=this.controller.getGeoModel(),i=!!(e&&e.shiftKey);t.onMouseAction("move",{pt:this.geoKeyboardPt,shift:i,tolerance:this.getToleranceByDevice("keyboard")}),t.onPreviewChange()}tapGeoObjectFromKeyboard(e,t){var a;let i=this.controller.getGeoModel(),o=i.getCurrentTool();if(!o)return;o.onFocus(e);let n=o.tryCommitResults();n.committed&&this.controller.dispatch({type:"commit-geo-objects",shiftKey:t.shiftKey,...n}),i.updateNextObjectId(i.controller.findLastTokenNumber()+1),i.clearHoveredObjects(),i.onPreviewChange(),this.speakGeoReleaseAction(this.controller.getActiveTool(),(a=o.getSpec)==null?void 0:a.call(o),n.committed),this.keyboardAttentionManager.clearAttentionIfNotTabbable()}tapGeoPointFromKeyboard(e){var l;this.initGeoKeyboardPt();let t=this.controller.getGeoModel(),i=this.controller.getActiveTool(),o=t.getCurrentTool(),n=(l=o.getSpec)==null?void 0:l.call(o),a=!!e.shiftKey,s=t.onMouseAction("release",{pt:this.geoKeyboardPt,shift:a,tolerance:this.getToleranceByDevice("keyboard")});s.committed&&this.controller.dispatch({type:"commit-geo-objects",shiftKey:e.shiftKey,...s}),t.onMouseAction("move",{pt:this.geoKeyboardPt,shift:a,tolerance:this.getToleranceByDevice("keyboard")}),t.onPreviewChange(),this.speakGeoReleaseAction(i,n,s.committed),this.keyboardAttentionManager.clearAttentionIfNotTabbable()}speakGeoReleaseAction(e,t,i){var o;if(i!==void 0){let n=Object.keys(i);if(!n.length||!t)return;let a="";if(e==="point"||e==="expression-edit"){for(let s in i){let l=i[s];if(l){if(l.type==="point-reference"){a=this.controller.s("graphing-calculator-text-geometry-tool-point-display-name");break}else if(l.type==="intersection"){a=this.controller.s("graphing-calculator-text-geometry-intersection");break}else if(l.type==="glider"){a=this.controller.s("graphing-calculator-text-geometry-glider");break}else if(l.type==="vector-endpoint"){l.location==="start"?a=this.controller.s("graphing-calculator-text-geometry-tool-vector-start-point-display-name"):a=this.controller.s("graphing-calculator-text-geometry-tool-vector-end-point-display-name");break}}}a===""&&(a=this.controller.s("graphing-calculator-text-geometry-tool-point-display-name"))}else{let s=(o=t.outputs[0])==null?void 0:o.type;switch(s){case"arc":a=this.controller.s("graphing-calculator-text-geometry-tool-arc-display-name");break;case"circle":a=this.controller.s("graphing-calculator-text-geometry-tool-circle-display-name");break;case"line":a=this.controller.s("graphing-calculator-text-geometry-tool-line-display-name");break;case"segment":a=this.controller.s("graphing-calculator-text-geometry-tool-segment-display-name");break;case"ray":a=this.controller.s("graphing-calculator-text-geometry-tool-ray-display-name");break;case"vector-copy":a=this.controller.s("graphing-calculator-text-geometry-tool-vector-copy-display-name");break;case"vector":a=this.controller.s("graphing-calculator-text-geometry-tool-vector-display-name");break;case"parallel":a=this.controller.s("graphing-calculator-text-geometry-tool-parallel-display-name");break;case"perpendicular":a=this.controller.s("graphing-calculator-text-geometry-tool-perpendicular-display-name");break;case"midpoint":a=this.controller.s("graphing-calculator-text-geometry-tool-midpoint-display-name");break;case"polygon":a=this.controller.s("graphing-calculator-text-geometry-tool-polygon-display-name");break;case"angle":a=this.controller.s("graphing-calculator-text-geometry-tool-angle-display-name");break;case"directedangle":a=this.controller.s("graphing-calculator-text-geometry-tool-directed-angle-display-name");break;case"reflect":a=this.controller.s("graphing-calculator-text-geometry-tool-reflect-display-name");break;case"translate":a=this.controller.s("graphing-calculator-text-geometry-tool-translate-display-name");break;case"dilate":a=this.controller.s("graphing-calculator-text-geometry-tool-dilate-display-name");break;case"rotate":a=this.controller.s("graphing-calculator-text-geometry-tool-rotate-display-name");break;case"vector-endpoint":case"expression-edit-preview-latex":case"point":case"intersection":case"glider":case"slider":case"angles":case"directedangles":case"compass":case"polygon-segment":case"point-reference":case void 0:a=this.controller.s("shared-calculator-narration-item-unknown");break;default:let l=s;throw new Error("Exhaustive Check failed"+l)}}n.length===1?Te(this.controller.s("graphing-calculator-narration-geometry-added-object-type",{type:a})):a!=="graphing-calculator-text-geometry-point"?n.length===2?Te(this.controller.s("graphing-calculator-narration-geometry-added-object-type-and-point",{type:a})):Te(this.controller.s("graphing-calculator-narration-geometry-added-object-type-and-points",{type:a,points:n.length-1})):Te(this.controller.s("graphing-calculator-narration-geometry-added-points",{points:n.length}))}else this.controller.getGeoModel().speakCurrentGeoToolHint()}describeFocusedItem(e){let t=this.keyboardAttentionManager.getKeyboardAttention(),i=this.controller.getItemModel((t==null?void 0:t.calcId)||"");this.controller.getEvaluator().notifyWhenSynced(()=>{var o,n;if(!this.controller.isGeometry()&&i&&i.type==="image"&&((o=this.manager.imageLayer.getFocusedImage())==null?void 0:o.id)===i.id){this.manager.imageLayer.speakAriaAlert();return}i&&((n=this.manager.movablePointsLayer.getPOIUnderAttention())==null?void 0:n.sketch.id)===i.id&&this.manager.movablePointsLayer.speakAriaAlert()||Te(nn(i,this.controller,{includeDetails:e.includeDetails,description:t==null?void 0:t.description,poi:this.manager.movablePointsLayer.getPOIUnderAttention(),listIndex:t==null?void 0:t.listIndex,polygonEdge:t==null?void 0:t.polygonEdge,includeSelectionState:this.controller.isGeometry()&&(this.controller.getActiveTool()==="box-selection"||this.controller.getActiveTool()==="selection")}))})}getPointFromFocusedItem(){var d;let e=this.keyboardAttentionManager.getKeyboardAttention(),t=this.controller.getItemModel((e==null?void 0:e.calcId)||"");if(!t||t.type!=="expression"||!t.latex)return;let i=t.formula.typed_constant_value;if(!i||!this.manager.getProjection())return;let n=i.valueType,a=i.value;if(__dcg_shared_module_exports__['db'](i.valueType)){let p=e==null?void 0:e.listIndex;p&&(n=__dcg_shared_module_exports__['eb'](n),a=a[p])}let s=e==null?void 0:e.polygonEdge;if(n===__dcg_shared_module_exports__['Da']&&s!==void 0&&s>=0&&a.length>s){let p=a[s],g=a[(s+1)%a.length];n=__dcg_shared_module_exports__['Fa'],a=[p,g]}let l=NaN,c=NaN;return n===__dcg_shared_module_exports__['va']?(l=a[0],c=a[1]):n===__dcg_shared_module_exports__['La']||n===__dcg_shared_module_exports__['Na']||n===__dcg_shared_module_exports__['Fa']?(l=(a[0][0]+a[1][0])/2,c=(a[0][1]+a[1][1])/2):n===__dcg_shared_module_exports__['Va']?(l=a[1][0]+a[0][0]/2,c=a[1][1]+a[0][1]/2):(d=a[0])!=null&&d.length&&(l=a[0][0],c=a[0][1]),{x:l,y:c}}moveGeoKeyboardPtToFocusedItem(e){let t=this.getPointFromFocusedItem();if(!t)return;let{x:i,y:o}=t,n=this.keyboardAttentionManager.getKeyboardAttention();this.controller.getGeoModel().setObjectHovered({calcId:(n==null?void 0:n.calcId)||"",listIndex:void 0}),!isNaN(i)&&!isNaN(o)?(this.setGeoKeyboardPt({x:i,y:o}),this.controller.isVirtualMouseAllowed()&&e.describe&&Te(this.controller.s("graphing-calculator-narration-geometry-moved-to-coordinates",{x:ps(this.controller,i),y:us(this.controller,o)}))):this.controller.isVirtualMouseAllowed()&&e.describe&&Te(this.controller.s("graphing-calculator-narration-geometry-unable-to-move"))}speakPoint(e,t){if(!(!e||!this.manager.getAudioTrace()||!this.manager.getProjection()))switch(t){case"X":Te(ps(this.controller,e.x));break;case"Y":Te(us(this.controller,e.y));break;case"L":"ariaLabel"in e&&e.ariaLabel?Te(e.ariaLabel):Te(this.controller.s("graphing-calculator-narration-poi-graph-point"));break;case"C":"sketch"in e&&Te(vf(this.controller,e.sketch.color))}}selectItemIfNotSecret(e,t){this.controller.isItemNotSelectableBecauseItsSecret(e)||(!this.controller.isMultiSelectEnabled()||!t?this.controller.dispatch({type:"set-selected-id",id:e}):this.controller.dispatch({type:"toggle-selected-with-multi-select",id:e}))}convertTouchEventToMathPoint(e){let{clientX:t,clientY:i}=e.changedTouches[0],o=this.manager.elt.getBoundingClientRect();return this.controller.getGeoModel().convertCanvasPixelsToPoint({x:t-o.left,y:i-o.top})}handleGeoTapStart(e){let t=this.controller.getGeoModel();this.grapherIsPressed=!0,this.canceledGeoToolplayWhilePressed=!1;let i=!!e.shiftKey,o=this.convertTouchEventToMathPoint(e);return this.lastGeoMouseEvent={...o,shift:i},t.onMouseAction("move",{pt:o,shift:i,tolerance:this.getToleranceByDevice(e.device)}).handled?(dW(e)?this.handleGeoTapMove(e):(t.onPreviewChange(),this.updateGeoHoveredObjects()),t.getToolMode()==="expression-edit"&&e.preventDefault(),!0):!1}handleGeoShiftKeyChange(e){let t=this.lastGeoMouseEvent;if(!t||t.shift===e)return;t.shift=e;let i=this.controller.getGeoModel();i.onMouseAction("move",{pt:{x:t.x,y:t.y},shift:t.shift,tolerance:this.getToleranceByDevice("mouse")}),i.onPreviewChange()}handleGeoTapMove(e){let t=this.controller.getGeoModel(),i;if(!(e.target&&e.target.closest(".dcg-geometry-toolbar-view"))&&(this.isEventWithinInstance(e)||this.grapherIsPressed)){let n=this.convertTouchEventToMathPoint(e),a=!!e.shiftKey;this.lastGeoMouseEvent={...n,shift:a},i=t.onMouseAction("move",{pt:n,shift:a,tolerance:this.getToleranceByDevice(e.device)}).handled}else this.lastGeoMouseEvent=void 0,t.onMouseAction("move",{pt:{x:NaN,y:NaN},shift:!1,tolerance:0}),i=!0;return t.onPreviewChange(),i}replayGeoTapMove(){let e=this.controller.getGeoModel(),t=this.lastGeoMouseEvent;t&&(e.onMouseAction("move",{pt:{x:t.x,y:t.y},shift:t.shift,tolerance:this.getToleranceByDevice("mouse")}),e.onPreviewChange())}handleGeoTapEnd(e){var s;if(!this.grapherIsPressed)return;let t=this.controller.getGeoModel();this.grapherIsPressed=!1,this.lastGeoMouseEvent=void 0;let i=this.canceledGeoToolplayWhilePressed?{committed:void 0}:t.onMouseAction("release",{pt:this.convertTouchEventToMathPoint(e),shift:!!e.shiftKey,tolerance:this.getToleranceByDevice(e.device)});this.canceledGeoToolplayWhilePressed=!1,i.committed&&this.controller.dispatch({type:"commit-geo-objects",shiftKey:e.shiftKey,...i}),this.isEventWithinInstance(e)&&dW(e)?this.handleGeoTapMove(e):t.onPreviewChange();let o=this.controller.getActiveTool(),n=t.getCurrentTool(),a=(s=n.getSpec)==null?void 0:s.call(n);this.speakGeoReleaseAction(o,a,i.committed),t.getToolMode()==="expression-edit"&&e.preventDefault()}isEventWithinInstance(e){return e.target?this.manager.elt.contains(e.target):!1}updateGeoHoveredObjects(){let e=this.controller.getGeoModel(),t={};e.getHoveredItems().forEach(i=>{let o;if("tokenId"in i){let n=this.controller.getGeoTokenInfoFromIdentifier(__dcg_shared_module_exports__['wb'](i.tokenId));o=n&&n.calcId}else o=i.calcId;if(o!==void 0){let n=t[o];n?i.listIndex===void 0?n.listIndexes=void 0:n.listIndexes!==void 0&&(n.listIndexes[i.listIndex]=!0):t[o]={listIndexes:i.listIndex===void 0?void 0:{[i.listIndex]:!0}}}}),this.manager.clickableObjectsLayer.setHoveredObjects(t)}cancelGeoToolplay(){this.canceledGeoToolplayWhilePressed=this.grapherIsPressed,this.updateGeoHoveredObjects()}startBoxSelect(e){let t={};this.controller.getAllSelectedItems().forEach(n=>t[n.id]=!0);let i=this.manager.getProjection().reverse_map_pt(this.getMouseRelativeToGrapher(e)),o;this.addGlobalMouseListener("dcg-tapmove",n=>{o=this.manager.getProjection().reverse_map_pt(this.getMouseRelativeToGrapher(n));let a={left:Math.min(i.x,o.x),top:Math.min(i.y,o.y),right:Math.max(i.x,o.x),bottom:Math.max(i.y,o.y)};this.manager.setBoxSelectRectangle(a);let s=this.findIdsThatIntersectBox(a);this.controller.dispatch({type:"set-all-selected-ids",ids:{...t,...s}})}),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",n=>{this.removeAllGlobalMouseListeners(),this.manager.setBoxSelectRectangle(void 0),o||this.controller.dispatch({type:"set-none-selected"})})}};function dW(r){return r.device==="mouse"}function pW(r){return{calcId:r.sketch.id,isReverseDrag:!1,scaleFactor:r.type==="movable-point"?r.scaleFactor:void 0,tableInfo:r.type==="movable-point"?r.tableInfo:void 0}}qt();var js=class js{constructor(e=0,t=0,i=1,o=i){this.tx=e,this.ty=t,this.sx=i,this.sy=o}toJSON(){return{tx:this.tx,ty:this.ty,sx:this.sx,sy:this.sy}}compose(e){return new js(this.sx*e.tx+this.tx,this.sy*e.ty+this.ty,this.sx*e.sx,this.sy*e.sy)}translate(e,t){let i=t===void 0?e.x:t.x-e.x,o=t===void 0?e.y:t.y-e.y;return new js(this.tx+i,this.ty+o,this.sx,this.sy)}scale(e,t){return js.scale(e,t).compose(this)}scaleAtPoint(e,t,i=t){return js.scaleAtPoint(e,t,i).compose(this)}mapX(e){return this.sx*e+this.tx}mapY(e){return this.sy*e+this.ty}mapPoint(e){return{x:this.mapX(e.x),y:this.mapY(e.y)}}mapRect(e){return{left:this.mapX(e.left),right:this.mapX(e.right),bottom:this.mapY(e.bottom),top:this.mapY(e.top)}}};js.scale=function(e,t=e){return new js(0,0,e,t)},js.translate=function(e,t){return new js().translate(e,t)},js.scaleAtPoint=function(e,t,i=t){return i===void 0&&(i=t),new js(e.x*(1-t),e.y*(1-i),t,i)},js.fromRects=function(e,t){let i=(t.right-t.left)/(e.right-e.left),o=(t.top-t.bottom)/(e.top-e.bottom);return new js(t.left-i*e.left,t.bottom-o*e.bottom,i,o)},js.fromJSON=function(e){return new js(e.tx,e.ty,e.sx,e.sy)};var zg=js;var wl=class{constructor(e,t,i){this.screen=e,this.viewport=t,this.settings=i,this.mathCoordinates=__dcg_shared_module_exports__['Zc'](t),this.pixelCoordinates=__dcg_shared_module_exports__['Yc'](e),this.updateScalePairs()}updateScalePairs(){let{xAxisScale:e,yAxisScale:t}=this.settings;this.mathToPixels=__dcg_shared_module_exports__['_c'].fromRects(this.mathCoordinates,this.pixelCoordinates,{xAxisScale:e,yAxisScale:t}),this.pixelsToMath=this.mathToPixels.inverse()}mapx(e){return this.mathToPixels.mapX(e)}mapy(e){return this.mathToPixels.mapY(e)}reverse_mapx(e){return this.pixelsToMath.mapX(e)}reverse_mapy(e){return this.pixelsToMath.mapY(e)}mapAlongAxis(e,t){switch(t){case"x":return this.mapx(e);case"y":return this.mapy(e);default:{let i=t;throw new Error(`Unknown axis: ${i}`)}}}reverseMapAlongAxis(e,t){switch(t){case"x":return this.reverse_mapx(e);case"y":return this.reverse_mapy(e);default:{let i=t;throw new Error(`Unknown axis: ${i}`)}}}map_pt(e){return this.mathToPixels.mapPoint(e)}map_xy_pairs(e){for(var t=[],i=0;i<e.length;i+=2)t.push(this.mapx(e[i])),t.push(this.mapy(e[i+1]));return t}reverse_map_pt(e){return this.pixelsToMath.mapPoint(e)}coordsAreOnscreen(e,t,i=0){return e>-i&&t>-i&&e<this.screen.width+i&&t<this.screen.height+i}closestPointOnScreen(e){let t=this.pixelCoordinates;return{x:Math.min(Math.max(e.x,t.left),t.right),y:Math.min(Math.max(e.y,t.top),t.bottom)}}};var{log10:l1}=Math;function m2(r,e){var t=e.x-r.x,i=e.y-r.y,o=.5*(r.x+e.x),n=.5*(r.y+e.y),a=.5*__dcg_shared_module_exports__['da'](t,i);return{center:$d(o,n),radius:a}}function uW(r,e){var t={x:2*r.x-e.x,y:2*r.y-e.y};return m2(e,t)}function hW(r,e){for(var t=[],i=0;i<r.length;i++)t.push($d(r[i].pageX-e.left,r[i].pageY-e.top));return t}function $d(r,e){return{x:r,y:e}}function gW(r){return $d(.5*(r.left+r.right),.5*(r.bottom+r.top))}var One=0,c1=class{constructor(e,t){this.s=uc(()=>this.grapher.settings.config.language);this.grapher=e,this.elt=e.elt,this.id=One++,this.controller=t,this.isScalingEnabled=!1,this.mousePt=$d(0,0),this.lastScrollZoom=Date.now(),this.preventScrollZoom=!1,this.addMouseWheelEventHandler(),this.addTouchEventHandler()}remove(){ie(window).off(".viewportcontroller-"+this.id)}getViewport(){return this.grapher.getProjection().viewport}getProjection(){return this.grapher.getProjection()}isViewportLocked(){var e=this.getProjection().settings;return e.config.lockViewport||e.userLockedViewport}updateMouse(e){var t=this.elt.getBoundingClientRect();this.mousePt=$d(e.clientX-t.left,e.clientY-t.top)}updateScaleAxis(){this.isMouseInViewport()&&(this.isMouseNearYAxis()?this.grapher.scaleAxis="y":this.isMouseNearXAxis()?this.grapher.scaleAxis="x":this.grapher.scaleAxis="both"),this.updateCursor(),this.controller.requestRedrawGraph()}updateCursor(){this.elt.classList.toggle("dcg-scale-horizontal",this.grapher.scaleAxis==="x"),this.elt.classList.toggle("dcg-scale-vertical",this.grapher.scaleAxis==="y"),this.elt.classList.toggle("dcg-scale-both",this.grapher.scaleAxis==="both")}isMouseNearOrigin(){var e=this.getProjection(),t=e.mathToPixels.mapPoint($d(0,0));return Math.abs(this.mousePt.x-t.x)<50&&Math.abs(this.mousePt.y-t.y)<50}isMouseNearXAxis(){var e=this.getProjection(),t=e.pixelCoordinates,i=e.mathToPixels.mapY(0);return i=Math.min(Math.max(t.top,i),t.bottom),Math.abs(this.mousePt.y-i)<40&&e.settings.showXAxis}isMouseNearYAxis(){var e=this.getProjection(),t=e.pixelCoordinates,i=e.mathToPixels.mapX(0);return i=Math.min(Math.max(t.left,i),t.right),Math.abs(this.mousePt.x-i)<40&&e.settings.showYAxis}isMouseInViewport(){var e=this.getProjection(),t=e.mathCoordinates,i=e.pixelsToMath.mapPoint(this.mousePt);return i.x>=t.left&&i.x<=t.right&&i.y>=t.bottom&&i.y<=t.top}_setViewportWithoutCancellingAnimation(e){if(e.isValid(this.controller.getAxisScaleSettings())&&!e.equals(this.getViewport())){var i=this.getProjection();this.grapher._setProjection(new wl(i.screen,e,i.settings))}}setViewport(e){this.cancelAnimation(),this._setViewportWithoutCancellingAnimation(e)}setScreen(e){var t=this.getProjection();let i=t.settings.squareAxes?t.viewport.squareYAxis(e,t.settings):t.viewport;var o=new wl(e,i,t.settings);this.grapher._setProjection(o)}getTransformedViewport(e){let{pixelCoordinates:t,mathCoordinates:i,settings:o}=this.getProjection(),{xAxisScale:n,yAxisScale:a}=o,s=e.mapRect(t);var l=__dcg_shared_module_exports__['_c'].fromRectsInverse(i,s,{xAxisScale:n,yAxisScale:a}).mapRect(t);return new di(l.left,l.right,l.bottom,l.top)}transformViewport(e){this.setViewport(this.getTransformedViewport(e)),(this.grapher.scaleAxis==="x"||this.grapher.scaleAxis==="y")&&this.controller.markSquareAxesAfterUserEditedViewport()}animateToViewport(e){this.cancelAnimation();let t=this.getProjection(),i=t.viewport,o=t.mathToPixels;var n=0,a,s=l=>{a||(a=l);var c=(l-a)/500;if(n+=c,n<1){this.__animationTimeout=requestAnimationFrame(s);let d=o.interpolateX(i.xmin,e.xmin,n),p=o.interpolateX(i.xmax,e.xmax,n),g=o.interpolateY(i.ymin,e.ymin,n),h=o.interpolateY(i.ymax,e.ymax,n);this._setViewportWithoutCancellingAnimation(new di(d,p,g,h)),this.grapher.debounceUserRequestedViewportChange()}else this.setViewport(di.fromObject(e)),this.grapher.debounceUserRequestedViewportChange(),this.controller.markSquareAxesAfterUserEditedViewport()};this.__animationTimeout=requestAnimationFrame(s)}cancelAnimation(){cancelAnimationFrame(this.__animationTimeout)}addMouseWheelEventHandler(){var e=!1,t,i;ie(window).on("scroll.viewportcontroller-"+this.id,function(a){e=!0}),ie(window).on("wheel.viewportcontroller-"+this.id,function(a){t=a.clientX,i=a.clientY}),ie(window).on("mousemove.viewportcontroller-"+this.id,function(a){if(e){var s=a.clientX-t,l=a.clientY-i,c=s*s+l*l;c<100||(e=!1)}});var o=0,n=a=>{let s=a.originalEvent;if(s.deltaX===0&&s.deltaY===0)return;var l=Date.now();let c=l-this.lastScrollZoom;if(this.preventScrollZoom&&c>50&&(this.preventScrollZoom=!1),this.lastScrollZoom=l,this.preventScrollZoom)return;var d=this.getProjection();if(this.isViewportLocked())return;var p=d.mathToPixels;if(e)return;s.preventDefault(),this.updateMouse(s);var g=p.mapPoint($d(0,0));let f=(s.deltaY===0?-s.deltaX:-s.deltaY)>0?1:-1;var y=this.isMouseNearOrigin()&&f>0?g:this.mousePt;if(o>0)return;o+=1,requestAnimationFrame(function(){o--});let{xAxisScale:x,yAxisScale:E}=d.settings,C=.0625;(x==="logarithmic"||E==="logarithmic")&&c<25&&(C*=Math.max(10,c)/25);var S=f>0?1+C:1/(1+C),v=this.grapher.scaleAxis,M=v==="x"||v==="both"||!v?S:1,A=v==="y"||v==="both"||!v?S:1;let I=zg.scaleAtPoint(y,M,A),P=this.getTransformedViewport(I);f==-1&&this.tooBig(P)||f==1&&this.tooSmall(P)||(this.transformViewport(I),this.grapher.debounceUserRequestedViewportChange())};ie(this.elt).on("wheel",n)}applyPanTouchChanges(e,t){if(!this.isViewportLocked()&&!this.isScalingEnabled){var i=$d(t[0].x-e[0].x,t[0].y-e[0].y);this.transformViewport(zg.translate(i)),this.grapher.debounceUserRequestedViewportChange()}}chooseDragScaleCenter(){var e=this.getProjection(),t=e.pixelCoordinates,i=e.mathToPixels.mapX(0),o=e.mathToPixels.mapY(0);return i=Math.min(Math.max(t.left,i),t.right),o=Math.min(Math.max(t.top,o),t.bottom),$d(i,o)}applyScaleTouchChanges(e,t){if(this.isViewportLocked())return;var i=this.grapher.scaleAxis,o,n;if(e.length===2&&t.length===2)o=m2(e[0],e[1]),n=m2(t[0],t[1]);else if(t.length===1){var a=this.chooseDragScaleCenter();o=uW(a,e[0]),n=uW(a,t[0])}else return;var s=n.radius/o.radius,l=i==="y"?1:s,c=i==="x"?1:s,d=zg.scaleAtPoint(o.center,l,c).translate(o.center,n.center);let p=this.getTransformedViewport(d);s<1&&this.tooBig(p)||s>1&&this.tooSmall(p)||(this.transformViewport(d),this.grapher.debounceUserRequestedViewportChange())}addTouchEventHandler(){var e=[],t=!1,i=!0,o=!0,n=h=>{t||this.isViewportLocked()||(this.updateMouse(h.originalEvent),this.isScalingEnabled&&this.updateScaleAxis())};ie(window).on("mousemove.viewportcontroller-"+this.id,n),this.beginPanning=h=>{var f=this.getProjection();if(!this.isViewportLocked()&&!t&&h.touches.length===h.changedTouches.length){t=!0,this.grapher.isDragging=!0,this.updateMouse(h);var y=f.mathToPixels.mapPoint($d(0,0)),x=this.grapher.scaleAxis;(x==="x"||x==="both")&&(i=this.mousePt.x>y.x),(x==="y"||x==="both")&&(o=this.mousePt.y>y.y),this.controller.dispatch({type:"grapher/drag-start"}),ie(document).on("dcg-tapmove.graphdrag",p),ie(document).on("dcg-tapstart.graphdrag dcg-tapend.graphdrag dcg-tapcancel.graphdrag",g)}};var a=h=>{if(!(h.length<2)){var f=this.grapher.getProjection(),y=f.pixelCoordinates,x=f.mathToPixels.mapX(0),E=f.mathToPixels.mapY(0),C=40;x=Math.min(Math.max(y.left,x),y.right),E=Math.min(Math.max(y.top,E),y.bottom);var S=h[1].x-h[0].x,v=h[1].y-h[0].y;return Math.abs(h[0].x-x)<C&&Math.abs(h[1].x-x)<C&&Math.abs(v)>3*Math.abs(S)&&f.settings.showYAxis?"y":Math.abs(h[0].y-E)<C&&Math.abs(h[1].y-E)<C&&Math.abs(S)>3*Math.abs(v)&&f.settings.showXAxis?"x":"both"}},s=h=>(this.grapher.scaleAxis||(this.grapher.scaleAxis=a(h)),this.grapher.scaleAxis),l=()=>{this.grapher.scaleAxis&&(this.grapher.scaleAxis=void 0,this.controller.requestRedrawGraph(),this.updateCursor())},c=()=>{this.isScalingEnabled=!1,this.preventScrollZoom=!0,l()},d=h=>h.altKey||h.ctrlKey||h.metaKey,p=h=>{let f=h;if(t&&!this.isViewportLocked()){var y=hW(f.touches,go(this.elt));if(e.length===2&&y.length===2)s(y),this.applyScaleTouchChanges(e,y);else if(e.length===1&&this.isScalingEnabled){this.updateMouse(f);var x=this.grapher.scaleAxis,E=this.getProjection(),C=E.mathToPixels.mapPoint($d(0,0)),S,v,M=5,A=i?1:-1,I=o?1:-1;if((x==="x"||x==="both")&&(S=this.mousePt.x>C.x+M*A),(x==="y"||x==="both")&&(v=this.mousePt.y>C.y+M*I),x==="x"&&i!==S||x==="y"&&o!==v||x==="both"&&i!==S&&o!==v)return;this.applyScaleTouchChanges(e,y)}else l();e.length===1&&this.applyPanTouchChanges(e,y),this.controller.dispatch({type:"grapher/drag-move"}),e=y}},g=h=>{let f=h;t&&(this.cancelAnimation(),e=hW(f.touches,go(this.elt)),f.touches.length===0&&(t=!1,this.grapher.isDragging=!1,ie(document).off(".graphdrag"),this.grapher.debounceUserRequestedViewportChange(),this.controller.dispatch({type:"grapher/drag-end"})),(f.touches.length===0||f.touches.length===1&&!this.isScalingEnabled)&&l())};ie(window).on("keydown.viewportcontroller-"+this.id,h=>{this.controller.isGeoToolActive()||this.isViewportLocked()||(Be(h)===Kv&&!d(h)&&this.shouldAllowShiftScaling()?(this.isScalingEnabled=!0,this.grapher.scaleAxis||this.updateScaleAxis()):c())}),ie(window).on("keyup.viewportcontroller-"+this.id+" blur.viewportcontroller-"+this.id,c)}shouldAllowShiftScaling(){return!this.controller.isGeometry()}zoom(e){var t=this.getProjection().pixelCoordinates;if(e==="in"){let o=this.getTransformedViewport(zg.scaleAtPoint(gW(t),2));this.tooSmall(o)||this.animateToViewport(o),Te(this.s("graphing-calculator-narration-viewport-zoom-in"))}else if(e==="out"){let o=this.getTransformedViewport(zg.scaleAtPoint(gW(t),.5));this.tooBig(o)||this.animateToViewport(o),Te(this.s("graphing-calculator-narration-viewport-zoom-out"))}else if(e==="square"){var i=this.getSquareViewport();this.getProjection().settings.setProperty("squareAxes",!0),this.animateToViewport(i),Te(this.s("graphing-calculator-narration-viewport-zoom-square"))}else e==="default"&&this.setDefaultViewport()}tooBig(e){let t=this.getProjection(),{xAxisScale:i,yAxisScale:o}=t.settings,{xmin:n,xmax:a,ymin:s,ymax:l}=e;return i==="logarithmic"&&l1(a)-l1(n)>60||o==="logarithmic"&&l1(l)-l1(s)>60||this.controller.isGeometry()&&a-n>1e5}tooSmall(e){let{xmin:t,xmax:i}=e;return this.controller.isGeometry()&&i-t<1e-4}zoomSquareImmediately(){this.setViewport(this.getSquareViewport())}zoomCustom(e){this.animateToViewport(e),Te(this.s("graphing-calculator-narration-viewport-updated"))}setDefaultViewport(){let e=this.controller.getDefaultViewport();this.animateToViewport(e),Te(this.s("graphing-calculator-narration-viewport-default"))}isDefaultViewportRestored(){let e=this.getProjection(),{xAxisScale:t,yAxisScale:i}=e.settings,o=t==="linear",n=i==="linear",a=e.viewport,s=this.controller.getDefaultViewport(),l=o?a.xmax-a.xmin:Math.log(a.xmax/a.xmin),c=n?a.ymax-a.ymin:Math.log(a.ymax/a.ymin),d=o?a.xmin-s.xmin:Math.log(a.xmin/s.xmin),p=o?a.xmax-s.xmax:Math.log(a.xmax/s.xmax),g=n?a.ymin-s.ymin:Math.log(a.ymin/s.ymin),h=n?a.ymax-s.ymax:Math.log(a.ymax/s.ymax),f=.025;return Math.abs(d/l)<f&&Math.abs(p/l)<f&&Math.abs(g/c)<f&&Math.abs(h/c)<f}getSquareViewport(){let e=this.getProjection();return e.settings.lastChangedAxis==="y"?e.viewport.squareXAxis(e.screen,e.settings):e.viewport.squareYAxis(e.screen,e.settings)}};var dE=__dcg_shared_module_exports__['e'](te());qt();var Ec=class{constructor(e,t){this.width=e,this.height=t}};var Rx=class{constructor(e,t){this.is3d=!1;this.color="#000000",this.style="normal",this.showPOI=!1,this.showHighlight=!1,this.selected=!1,this.tokenHovered=!1,this.tokenSelected=!1,this.labels=[],this.id=e,this.branches=t!==void 0?t:[],this.getPOI().forEach(i=>{i.type===1008&&this.labels.push({type:"poi",poi:i})}),t.forEach((i,o)=>{if(i.graphMode===22){if(i.objectType===17){let n=new gh(0,0,1008,this,o,0,!1);this.labels.push({id:"label-"+e+"-"+(i.listIndex||0),type:"segment",poi:n,segments:i.segments[0],text:i.labels&&i.labels[0]||""})}else if(i.objectType===16){let n=new gh(0,0,1008,this,o,0,!1);this.labels.push({id:"label-"+e+"-"+(i.listIndex||0),type:"polygon",poi:n,segments:i.segments[0],text:i.labels&&i.labels[0]||""})}else if(i.objectType===23){let n=new gh(0,0,1008,this,o,0,!1);this.labels.push({id:"label-"+e+"-"+(i.listIndex||0),type:"angle",poi:n,segments:i.segments[0],text:i.labels&&i.labels[0]||""})}}})}getPOI(){if(this.__cachedPOI)return this.__cachedPOI;this.__cachedPOI=[],this.__cachedPOIIds={};for(let e=0;e<this.branches.length;e++){let t=this.branches[e];if(t.graphMode===1||t.graphMode===2){let i=t.poi;i.zeros&&this._pushPOI(i.zeros,e,1002),i.intercept&&this._pushPOI(i.intercept,e,1003),i.extrema&&this._pushPOI(i.extrema,e,1004),i.intersections&&this._pushPOI(i.intersections,e,1001)}else if(t.graphMode===3||t.graphMode===4){let i=t.poi,o=t.graphMode===3&&t.interactiveLabel===!0;if(t.showLabel===!0||o){let n=t.nakedLabel;i.defined&&this._pushPOI(i.defined,e,1008,n)}else i.defined&&this._pushPOI(i.defined,e,1006)}}return this.__cachedPOI}getBranchPOI(e){return this.getPOI().filter(t=>t.branch===e)}getMovablePoints(){if(this.__cachedMovablePoints)return this.__cachedMovablePoints;this.__cachedMovablePoints=[];let e=this.branches[0];if(e&&e.segments.length===1&&e.graphMode===4){let t=e.segments[0];for(let i=0;i<t.length;i++){let o;e.tableId&&(o={tableId:e.tableId,columnId:this.id,rowIndex:e.movablePointInfo[i].index,dragX:e.movablePointInfo[i].dragX,dragY:e.movablePointInfo[i].dragY});let n=e.scaleFactors?e.scaleFactors[0][i]:void 0,a=o?o.rowIndex:i,s=e.segments.length===1&&e.labels&&e.labels[i]?e.labels[i]:void 0,l=e.hasOwnProperty("pointOpacity")?e.pointOpacity:1,c=e.pointSize!==void 0?e.pointSize:8;this.__cachedMovablePoints.push({type:"movable-point",id:"movable:["+this.id+","+a+"]",listIndex:a,sketch:this,color:this.color,pointOpacity:l,pointSize:c,tableInfo:o,scaleFactor:n,x:t[i][0],y:t[i][1],label:s,ariaLabel:s&&la(s)})}}return this.__cachedMovablePoints}getMovablePointByIndex(e){return this.getMovablePoints()[e]}getStaticLabeledPoints(){if(this.__cachedStaticLabeledPoints)return this.__cachedStaticLabeledPoints;let e=this.branches[0];return this.__cachedStaticLabeledPoints=[],this.getPOI().forEach(t=>{if(t.type!==1006&&t.type!==1008||e.graphMode!==3)return;var i=e.showLabel;let o=t.getLabel();!i&&o===""||this.__cachedStaticLabeledPoints.push({type:"static-labeled-point",id:"static["+this.id+","+t.id+"]",listIndex:t.pointIdxOnBranch,x:t.x,y:t.y,sketch:t.sketch,label:o,ariaLabel:o!==""?la(o):void 0})}),this.__cachedStaticLabeledPoints}_pushPOI(e,t,i,o=!1){for(let n=0,a=e.x.length;n<a;n++){let s=new gh(e.x[n],e.y[n],i,this,t,n,o);e.intersects&&(s.intersects=e.intersects[n]),this.__cachedPOI.push(s),this.__cachedPOIIds[s.id]=s}}updateIntersections(e){for(let i=0,o=this.branches.length;i<o;i++){let n=this.branches[i];n.graphMode!==15&&n.graphMode!==22&&(n.poi.intersections=e[i])}let t=this.__cachedPOI;this.__cachedPOI=[],t.forEach(i=>{i.type!==1001?this.__cachedPOI.push(i):delete this.__cachedPOIIds[i.id]});for(let i=0;i<this.branches.length;i++){let o=this.branches[i];if(o.graphMode===1||o.graphMode===2){let n=o.poi;n.intersections&&this._pushPOI(n.intersections,i,1001)}}}getPOIById(e){return this.__cachedPOIIds[e]}updateFrom(e){if(!e)return;this.showPOI=e.showPOI,this.showHighlight=e.showHighlight,this.selected=e.selected,this.tokenSelected=e.tokenSelected,this.tokenHovered=e.tokenHovered;let t=this.branches[0].graphMode;if(t===3||t===4){let i=!0;for(let o=0;o<this.__cachedPOI.length;o++){let n=e.__cachedPOI[o],a=this.__cachedPOI[o];if(!n||n.type!==a.type){i=!1;break}}if(i)for(let o=0;o<this.__cachedPOI.length;o++){let n=e.__cachedPOI[o],a=this.__cachedPOI[o];delete this.__cachedPOIIds[a.id],this.__cachedPOIIds[n.id]=a,a.id=n.id}}}};var Fx=class{constructor(e,t){this.is3d=!0;this.color="#000000",this.showHighlight=!1,this.selected=!1,this.id=e,this.branches=t!==void 0?t:[]}updateFrom(e){e&&(this.showHighlight=e.showHighlight,this.selected=e.selected)}};function mW(r){return r.is3d}function Sc(r,e){if(mW(e)||r.isGeoUIActive()&&r.getAllToolPreviewItems().filter(i=>i.id===e.id).length>0)return!1;for(let t of e.branches)if(jd(t))return!0;return!1}function jd(r){if(r)switch(r.graphMode){case 8:case 5:case 6:return pr("audioTraceSimult")&&r.segments.length>0;case 1:case 2:case 3:case 4:return r.segments.length>0;default:return!1}}function fW(r){for(let e=0;e<r.branches.length;e++)if(jd(r.branches[e]))return e;return 0}function JC(r,e){let t=0;for(let i=0;i<=e;i++)jd(r.branches[i])&&(t+=1);return t}function bW(r){switch(r.graphMode){case 1:case 2:case 3:case 4:return!0;default:return!1}}function yW(r,e){switch(e){case 2:case 8:case 5:case 6:case 3:case 4:return{independentMin:r.xmin,independentMax:r.xmax,dependentMin:r.ymin,dependentMax:r.ymax};case 1:return{independentMin:r.ymin,independentMax:r.ymax,dependentMin:r.xmin,dependentMax:r.xmax};default:throw f2(e)}}function f2(r){return`Unexpected graph mode. Received ${r}`}function b2(r){let e=Math.random()*2-1;return(r+.2*e)/1.02}function xW(r,e){if(r===1)return e.y;if(r===2||r===8||r===5||r===6)return e.x;throw f2(r)}function wW(r,e){let t=([i,o])=>{let n=e!=null&&e.degreeMode?i*Math.PI/180:i;return[o*Math.cos(n),o*Math.sin(n)]};return __dcg_shared_module_exports__['t'](__dcg_shared_module_exports__['y'](r,2).map(i=>t(i)),!0)}function y2(r,e,t){let i=Ig(r,e.mathToPixels,t),o=rH(i,{xmin:0,xmax:e.screen.width,ymin:0,ymax:e.screen.height}),n=e.pixelsToMath;return t===gx&&(n=new __dcg_shared_module_exports__['_c'](n.yScale,n.xScale)),o.map(s=>Ig(s,n,t))}function vW(r,e){return r[0]-e[0]}function CW(r){switch(r.graphMode){case 2:case 3:case 4:return{independent:r.x,dependent:r.y};case 1:return{independent:r.y,dependent:r.x};default:throw f2(r.graphMode)}}var Fne=.1;function x2(r){return r<0?Fne:0}function Nne(r,e,t){return{x:r.x,y:r.y,branch:r.branch,reportedBranch:t,type:r.type,graphMode:e,intersects:r.intersects}}var Nx=101,h1=class{constructor(e,t,i){this.grapher=i,this.controller=e,this.audiograph=t,this.reset()}reset(){this.currentPoint=void 0,this.resetToFirstBranch(),this.sampledPoints=[],this.pois=[],this.independent=0}resetToFirstBranch(){let e=this.getCurrentSketch();this.branch=e?fW(e):0}getBranchPoints(e){let t=[];if(e>=0)for(let i of this.getSampledPoints())i.branch===e&&t.push(i);return t}resetTracePoint(){this.grapher.traceLayer.setTraceInfo(void 0),this.grapher.traceLayer.setTraceLine(void 0),this.drawTracePoint(this.getCurrentPoint())}drawTracePoint(e){let t=this.getCurrentSketch();if(!e||!t)return;let i=t.branches[this.branch];if(!i||i.graphMode===3)return;let n={x:e.x,y:e.y},a={branchInfo:{branch:e.branch,id:t.id,sketch:t},pt:n};__dcg_shared_module_exports__['E'](a,this.grapher.traceLayer.getTraceInfo())||(this.grapher.traceLayer.setTraceInfo(a),this.controller.requestRedrawGraph())}drawTraceLine(e,t){if(e===void 0||!t)return;let i=this.getCurrentSketch();t===1?this.grapher.traceLayer.setTraceLine({x:void 0,y:e,color:i==null?void 0:i.color}):this.grapher.traceLayer.setTraceLine({x:e,y:void 0,color:i==null?void 0:i.color})}moveToOrigin(){let e=this.getCurrentSketch();if(!e||!Sc(this.controller,e))return;let t=e.branches[this.branch];if(!jd(t))return;let i=t.graphMode;if(i===2)this.setIndependent("x",0);else if(i===1)this.setIndependent("y",0);else if(i===3){let o=this.getSortedPOI()[0];this.setIndependent("x",o?o.x:0)}}getCurrentSketch(){let e,t=this.getSelectedItem();if(t){let i=this.audiograph.getFocusedCell();if(t.type==="table"){if(i&&(e=this.getGraphSketchForTableCell(t,i)),!e){for(let o of t.columnModels)if(e=this.grapher.getGraphSketch(o.id),e!==void 0)break}}else e=this.grapher.getGraphSketch(t.id)}return e}getFirstTraceableSketch(e){let t,i=this.controller.getItemCount(),o=this.controller.shouldAudioTraceReverseExpressions();for(let n=0;n<i;n++){let a=o?i-1-n:n,s=this.controller.getItemModelByIndex(a);if(s&&this.canTrace(s)){if(s.type==="table"){let l;l=this.audiograph.getFocusedCell(),l||(l=o?this.prevTableColumn(s):this.nextTableColumn(s)),l&&(this.audiograph.setFocusedCell(l),t=this.getGraphSketchForTableCell(s,l))}else t=this.grapher.getGraphSketch(s.id);if(t){e&&e.selectAssociatedExpression&&this.controller.dispatch({type:"set-selected-index",index:a});break}}}return t}canTrace(e){if(e.type==="image"||e.type==="text")return!1;let t;if(e.type==="expression"&&e.shouldGraph)t=this.grapher.getGraphSketch(e.id);else if(e.type==="table"){for(let i of e.columnModels)if(i.shouldGraph){t=this.grapher.getGraphSketch(i.id);break}}return t?Sc(this.controller,t):!1}getTraceableExpressionCount(){let e=0,t=this.controller.getItemCount();for(let i=0;i<t;i++){let o=this.controller.getItemModelByIndex(i);o&&this.canTrace(o)&&e++}return e}computeStepSizes(){let e=this.grapher.getProjection().viewport;if(!e)return;let t=e.xmin,i=e.xmax,o=e.ymin,n=e.ymax,a=this.getCurrentSketch();if(!a||!Sc(this.controller,a))return;let s=a.branches[this.branch];if(!jd(s))return;let l=s.graphMode;if(l===2)this.independent<t?this.independent=t:this.independent>i&&(this.independent=i);else if(l===1)this.independent<o?this.independent=o:this.independent>n&&(this.independent=n);else if(l===3){let c,d;this.independent<t?(d=this.getSortedPOI()[0],this.independent=d&&d.x!==void 0?d.x:0):this.independent>i&&(c=this.getSortedPOI(),d=c[c.length-1],this.independent=d&&d.x!==void 0?d.x:0)}}getPoint(e,t){let i,o=this.getCurrentSketch();if(!o||!Sc(this.controller,o))return i;let n,a,s,l=0,c=o.branches[e];if(!c)return;let d=JC(o,e);"compiled"in c&&c.compiled&&(s=c.compiled.fn),a=c.graphMode;let p=this.grapher.getProjection(),{mathToPixels:g,pixelsToMath:h,screen:f}=p;if(a===2||a===8){let y=h.mapX(g.mapX(t)+f.width/(Nx-1));n=this.getInterveningPOIs(t,y,e,a)[0],(!n||n.x!==t||n.branch!==e)&&(n=void 0,l=s?s(t):0),n?i={x:n.x,y:n.y,type:n.type,typeChain:n.typeChain,branch:n.branch,reportedBranch:d,graphMode:a,intersects:n.intersects}:s&&(i={x:t,y:l,branch:e,reportedBranch:d,graphMode:a})}else if(a===1){let y=h.mapY(g.mapY(t)-f.height/(Nx-1));n=this.getInterveningPOIs(t,y,e,a)[0],(!n||n.y!==t||n.branch!==e)&&(n=void 0,l=s?s(t):0),n?i={x:n.x,y:n.y,type:n.type,typeChain:n.typeChain,branch:n.branch,reportedBranch:d,graphMode:a,intersects:n.intersects}:s&&(i={y:t,x:l,branch:e,reportedBranch:d,graphMode:a})}else if(a===3){let y=h.mapX(g.mapX(t)+f.width/(Nx-1));n=this.getInterveningPOIs(t,y,e,a)[0],n&&n.x===t&&n.branch===e?i={x:n.x,y:n.y,type:n.type,typeChain:n.typeChain,branch:n.branch,reportedBranch:d,graphMode:a,intersects:n.intersects}:i={x:t,y:NaN,branch:e,reportedBranch:d,graphMode:a}}return i}getSampledPoints(){return this.sampledPoints.length===0&&this.updateSampledPoints(),this.sampledPoints}updateSampledPoints(){let e=this.getCurrentSketch();if(!e||!Sc(this.controller,e))return;let t=[],i=this.grapher.getProjection(),o=i.viewport;for(let n=0;n<e.branches.length;n++){let a=e.branches[n];if(!jd(a))continue;let s=a.graphMode,l=0,c=0,d=[],p;if(s===2||s===3)l=o.xmin,c=o.xmax,p=(g,h,f)=>i.mathToPixels.interpolateX(g,h,f);else if(s===1)l=o.ymin,c=o.ymax,p=(g,h,f)=>i.mathToPixels.interpolateY(g,h,f);else continue;for(let g=0;g<Nx;g++){let h=p(l,c,g/(Nx-1)),f=__dcg_shared_module_exports__['ob'](h).value,y=p(l,c,(g+1)/(Nx-1)),x=__dcg_shared_module_exports__['ob'](y).value,E=this.getInterveningPOIs(f,x,n,s);if(E.length>0)d.push.apply(d,E);else{let C=this.getPoint(n,f);C&&d.push(C)}}t.push.apply(t,this.removeDuplicates(d,s))}this.sampledPoints=t}getCurrentPoint(){return this.currentPoint||this.updateCurrentPoint(),this.currentPoint}updateCurrentPoint(e){if(e){this.currentPoint=e;let t=e.graphMode;t===2||t===3?this.independent=e.x!==void 0?e.x:0:t===1&&(this.independent=e.y!==void 0?e.y:0),this.branch=e.branch}else this.currentPoint=this.getPoint(this.branch,this.independent)}prevPoint(){this.moveToPoint(-1)}nextPoint(){this.moveToPoint(1)}firstPoint(){let e=this.getSampledPoints();e.length>0&&this.updateCurrentPoint(e[0])}lastPoint(){let e=this.getSampledPoints();e.length>0&&this.updateCurrentPoint(e[e.length-1])}moveToPoint(e){let t=this.getCurrentPoint();if(!t)return;if(t.graphMode===3){this.moveToPOI(e);return}let i=this.getSampledPoints(),o=this.getClosestPointIndexOnSameBranch(i,t);if(o!==-1){let n=o+e;n<=0?(n=0,Kt(this.controller.s("graphing-calculator-narration-audio-trace-first-point"))):n>=i.length-1&&(n=i.length-1,Kt(this.controller.s("graphing-calculator-narration-audio-trace-last-point")));let a=i[n];this.updateCurrentPoint(a)}}canMoveToPrevPoint(){let e=this.getCurrentPoint();if(!e)return!1;if(e.graphMode===3)return this.canMoveToPrevPOI();let t=this.getSampledPoints(),i=this.getClosestPointIndexOnSameBranch(t,e);return i!==-1&&i>0}canMoveToNextPoint(){let e=this.getCurrentPoint();if(!e)return!1;if(e.graphMode===3)return this.canMoveToNextPOI();let t=this.getSampledPoints(),i=this.getClosestPointIndexOnSameBranch(t,e);return i!==-1&&i<t.length-1}prevPOI(){this.moveToPOI(-1)}nextPOI(){this.moveToPOI(1)}getSortedPOI(){return(!this.pois||this.pois.length===0)&&this.updatePOI(),this.pois}updatePOI(){let e=[],t,i=[],o=this.getCurrentSketch();if(!(!o||!Sc(this.controller,o))){for(let n=0;n<o.branches.length;n++){let a=o.branches[n];if(!a)continue;let s=JC(o,n),l=a.graphMode;if(i=[],t=o.getBranchPOI(n),t.length>0){l===2||l===3?i=__dcg_shared_module_exports__['q'](t,"x"):l===1&&(i=__dcg_shared_module_exports__['q'](t,"y"));let c=[];for(let d of i)c.push(Nne(d,l,s));e.push.apply(e,this.removeDuplicates(c,l))}}this.pois=e}}removeDuplicates(e,t){let i=[];for(let o of e){if(o={...o},o.graphMode=t,i.length===0){i.push(o);continue}let n=i[i.length-1];__dcg_shared_module_exports__['ob'](n.x).value===__dcg_shared_module_exports__['ob'](o.x).value&&__dcg_shared_module_exports__['ob'](n.y).value===__dcg_shared_module_exports__['ob'](o.y).value&&n.branch===o.branch?(n.typeChain||(n.typeChain=n.type!==void 0?[n.type]:[]),o.type!==void 0&&n.typeChain.indexOf(o.type)===-1&&n.typeChain.push(o.type),o.type===1001&&o.intersects&&n.intersects===void 0&&(n.intersects=o.intersects)):i.push(o)}return i}getInterveningPOIs(e,t,i,o){let n=[],a=this.getSortedPOI(),s=NaN;for(let l of a)l&&((o===2||o===3)&&!isNaN(l.x)?s=l.x:o===1&&!isNaN(l.y)&&(s=l.y),l.branch===i&&!isNaN(s)&&(e<=s&&s<t||t<=s&&s<e)&&n.push(l));return e>t?n.reverse():n}setIndependent(e,t){let i=this.getSampledPoints();for(let n of i)if(n&&n.hasOwnProperty(e)&&n[e]===t){if(e==="x"){this.independent=n.x!==void 0?n.x:0,this.updateCurrentPoint();return}else if(e==="y"){this.independent=n.y!==void 0?n.y:0,this.updateCurrentPoint();return}}let o=!0;if(i.length>0){let n=Math.floor((i.length-1)/2),a=i[n];a&&(e==="x"?(this.independent=a.x!==void 0?a.x:0,o=!1):e==="y"&&(this.independent=a.y!==void 0?a.y:0,o=!1))}o&&(this.independent=0),this.resetToFirstBranch(),this.updateCurrentPoint()}moveToPOI(e){if(!this.getCurrentPoint())return;let i=this.getSampledPoints(),o=this.getPOIIndexByDirection(e);o===-1?Kt(this.controller.s("graphing-calculator-narration-audio-trace-no-more-pois")):this.updateCurrentPoint(i[o])}getPOIIndexByDirection(e){let t=this.getCurrentPoint();if(!t)return-1;let i=this.getSampledPoints(),o=this.getClosestPointIndexOnSameBranch(i,t),n=-1;if(o!==-1){let a=t.graphMode,s=e===1?i.length-1:0;for(let l=o;l!==s+e;l+=e){let c=i[l];if(((a===2||a===3)&&t.x!==c.x||a===1&&t.y!==c.y)&&c.type!==void 0){n=l;break}}}return n}canMoveToPrevPOI(){return this.getPOIIndexByDirection(-1)!==-1}canMoveToNextPOI(){return this.getPOIIndexByDirection(1)!==-1}getClosestPointIndexOnSameBranch(e,t){let i=-1,o=1/0;if(e.length>0&&t){let n=t.graphMode;for(let a=0;a<e.length;a++){let s=e[a];if(t.branch!==s.branch)continue;let l;n===2||n===3?l=Math.abs(s.x-t.x):l=Math.abs(s.y-t.y),l<o&&(i=a,o=l)}}return i}prevCurve(){this.controller.shouldAudioTraceReverseExpressions()?this.curveDown():this.curveUp()}nextCurve(){this.controller.shouldAudioTraceReverseExpressions()?this.curveUp():this.curveDown()}curveUp(){let e=this.getSelectedItem();if(!e)return;let t=this.prevTableColumn(e);if(t)this.audiograph.setFocusedCell(t);else{let i=e.index,o=this.findPrevTraceableIndex({index:i,focusTableCell:!0});if(o!==-1){let n=this.controller.getItemModelByIndex(o);n&&this.controller.dispatch({type:"set-selected-id",id:n.id})}}(t||this.getSelectedItem()!==e)&&this.audiograph.enterAudioTrace()}curveDown(){let e=this.getSelectedItem();if(!e)return;let t=this.nextTableColumn(e);if(t)this.audiograph.setFocusedCell(t);else{let i=e.index,o=this.findNextTraceableIndex({index:i,focusTableCell:!0});if(o!==-1){let n=this.controller.getItemModelByIndex(o);n&&this.controller.dispatch({type:"set-selected-id",id:n.id})}}(t||this.getSelectedItem()!==e)&&this.audiograph.enterAudioTrace()}canMoveToPrevCurve(){let e=this.getSelectedItem();return e?this.controller.shouldAudioTraceReverseExpressions()?this.findNextTraceableIndex({index:e.index,focusTableCell:!1})!==-1:this.findPrevTraceableIndex({index:e.index,focusTableCell:!1})!==-1:!1}canMoveToNextCurve(){let e=this.getSelectedItem();return e?this.controller.shouldAudioTraceReverseExpressions()?this.findPrevTraceableIndex({index:e.index,focusTableCell:!1})!==-1:this.findNextTraceableIndex({index:e.index,focusTableCell:!1})!==-1:!1}findPrevTraceableIndex(e){let t=e.index,i;do{t--,i=this.controller.getItemModelByIndex(t);let o=i&&this.prevTableColumn(i);if(o)return e.focusTableCell&&this.audiograph.setFocusedCell(o),t}while(i&&!this.canTrace(i));return i?t:-1}findNextTraceableIndex(e){let t=e.index,i;do{t++,i=this.controller.getItemModelByIndex(t);let o=i&&this.nextTableColumn(i);if(o)return e.focusTableCell&&this.audiograph.setFocusedCell(o),t}while(i&&!this.canTrace(i));return i?t:-1}prevTableColumn(e){return this.tableColumn(e,-1)}nextTableColumn(e){return this.tableColumn(e,1)}tableColumn(e,t){let i;if(e&&e.type==="table"){let o=this.audiograph.getFocusedCell(),n,a,s;t===-1?(n=o?Math.max(o.location.column-1,0):NaN,a=o&&o.tableId===e.id&&!isNaN(n)?n:e.columnModels.length-1,s=0):(n=o?Math.min(o.location.column+1,e.columnModels.length-1):NaN,a=o&&o.tableId===e.id&&!isNaN(n)?n:0,s=e.columnModels.length-1);let l=(s-a)/t;if(isFinite(l)&&l>=0)for(let c=a;c!==s;c+=t){let d=e.columnModels[c];if(d!=null&&d.shouldGraph&&this.grapher.getGraphSketch(d.id)){i={tableId:e.id,location:{column:c,row:0}};break}}}return i}getGraphSketchForTableCell(e,t){if(!e||e.type!=="table"||!t)return;let i=e.columnModels[t.location.column];if(i)return this.grapher.getGraphSketch(i.id)}getSelectedItemId(){let e=this.controller.getSelectedItem();return e&&e.type==="folder"?eT(e):e==null?void 0:e.id}getSelectedItem(){let e=this.controller.getSelectedItem();if(e&&e.type==="folder"){var t=eT(e);return t===void 0?void 0:this.controller.getItemModel(t)}return e}};qt();function QC(r){var M;let e=r.getGrapher();if(!e)return"";let t=e.viewportController.getViewport(),i=e.getProjection(),{showGrid:o,showXAxis:n,xAxisNumbers:a,showYAxis:s,yAxisNumbers:l,xAxisLabel:c,yAxisLabel:d}=e.settings,p=!1,g="",h=!1,f=[],y=Ua(__dcg_shared_module_exports__['zb'].value(t.xmin,Mf(i,t.xmin)).latex),x=Ua(__dcg_shared_module_exports__['zb'].value(t.xmax,Mf(i,t.xmax)).latex),E=Ua(__dcg_shared_module_exports__['zb'].value(t.ymin,IT(i,t.ymin)).latex),C=Ua(__dcg_shared_module_exports__['zb'].value(t.ymax,IT(i,t.ymax)).latex),S=t.zmin?Ua(__dcg_shared_module_exports__['zb'].value(t.zmin).latex):"",v=t.zmax?Ua(__dcg_shared_module_exports__['zb'].value(t.zmax).latex):"";if(r.is3dProduct()){let{xmin:A,xmax:I,ymin:P,ymax:_,zmin:U,zmax:Y}=t,{showAxis3D:R,showNumbers3D:H,showPlane3D:O}=e.settings;A===P&&A===U&&I===_&&I===Y&&R?(n=s=p=!1,f.push(r.s("graphing-calculator-narration-audio-trace-description-visible-xyz-axis-range",{xmin:y,xmax:x}))):(n=s=p=R,c=d=g="",a=l=h=H,o=n&&O)}if(n&&(a&&c!==""?f.push(r.s("graphing-calculator-narration-audio-trace-description-visible-x-axis-range-and-label",{xmin:y,xmax:x,label:c})):a&&c===""?f.push(r.s("graphing-calculator-narration-audio-trace-description-visible-x-axis-range",{xmin:y,xmax:x})):!a&&c!==""?f.push(r.s("graphing-calculator-narration-audio-trace-description-visible-x-axis-and-label",{label:c})):!a&&c===""&&f.push(r.s("graphing-calculator-narration-audio-trace-description-visible-x-axis"))),s&&(l&&d!==""?f.push(r.s("graphing-calculator-narration-audio-trace-description-visible-y-axis-range-and-label",{ymin:E,ymax:C,label:d})):l&&d===""?f.push(r.s("graphing-calculator-narration-audio-trace-description-visible-y-axis-range",{ymin:E,ymax:C})):!l&&d!==""?f.push(r.s("graphing-calculator-narration-audio-trace-description-visible-y-axis-and-label",{label:d})):!l&&d===""&&f.push(r.s("graphing-calculator-narration-audio-trace-description-visible-y-axis"))),p&&(h&&g!==""?f.push(r.s("graphing-calculator-narration-audio-trace-description-visible-z-axis-range-and-label",{zmin:S,zmax:v,label:g})):h&&g===""?f.push(r.s("graphing-calculator-narration-audio-trace-description-visible-z-axis-range",{zmin:S,zmax:v})):!h&&g!==""?f.push(r.s("graphing-calculator-narration-audio-trace-description-visible-z-axis-and-label",{label:g})):!h&&g===""&&f.push(r.s("graphing-calculator-narration-audio-trace-description-visible-z-axis"))),o&&f.push(r.s("graphing-calculator-narration-audio-trace-description-visible-grid")),r.is3dProduct()&&f.push(Bne(r)),!r.isGeometry()&&!r.is3dProduct()){let A=(M=r.getGrapher())==null?void 0:M.graphSketches,I=0;for(let P in A)Sc(r,A[P])&&(I+=1);f.push(r.s("graphing-calculator-narration-audio-trace-traceable-curves",{sketchCount:new on(I)}))}return f.join(" ").trim()}function Bne(r){return""}var EW=__dcg_shared_module_exports__['f']("//tQxAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAAIAAAHVwAgICAgICAgICAgICBAQEBAQEBAQEBAQEBgYGBgYGBgYGBgYGBggICAgICAgICAgICAoKCgoKCgoKCgoKCgoMDAwMDAwMDAwMDAwODg4ODg4ODg4ODg4OD///////////////8AAAA5TEFNRTMuOThyAaUAAAAALmcAABRAJAiwQgAAQAAAB1cctrbdAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/7UMQAAAjsKyK0YYABp52xtx8wAgAgBd34IAhAgnsECEe7QIAAgsPxACDgcBAEHQfD/g+D4PggCAIf///ghLny4Pg+D5+sHz/wf+XPwfB8H3iMHwfwffUCYPvz/Y7Hg/H4/H4/H4HAwADcoDwAP7XfuAFtXrhzjsjOXP8iCYM4IBVoH2DGAhQR2hm5vikA2IVEPX9nQaITi6IiLCKX/fxcg/DdGmS5BP7fIGQ0hw7DQi5Q//8midImXygdJ0tlz/1NAgXIANV6MA2Vy2y27jv/+1LEBIALOHOTvGGAMXWhbnTxGZ+LOa2FNMsDtj9/jUmPqqqARrNvlVjDDoGZqq0T11A0DVqeEnlQk8q4sVEp0FcqdxLoEJ0RPYWvIlQkbGA0Anw6VJJgqRKw1NJaAXkR4ag0/FwCCABbbdbJA0fzVgdvgvu5Px6Rwiv3VllZVDREqmWntLyBDka3sz951iTve+ddHP0/M3P/+ydU4zbqOZOeop5jfu1kwk8VezPeGc1hRMbWrJNv6SO/fH0Mc15KYvKqAAAAdrdsrbBDuBpp4v/7UsQGgguVE2ekjNP5aSBo6YSNgKAQUoCZEBJK8q73G/nhJFFmLY5dNc4b7gjBRyEs5yjJokY9TBoU/pXQBglyNjeiA87V8vkzaw019YTu2fxY0t6gteLMI37f9fYw7UVnWoE4NJOSpQBu3GfVAIVACgw+IikZZAnB7UKlLGnha4PDbIhsBhk4RYmlE2hYZ8NrQ5HnyEUvZxDyVG1hM33ZZH0OlrJV5///3/51qTGtJgxhREVLEfoO1w6686eRAAAAUicksbA1qegZCe2AuEgJ//tSxAkCDF0XSaw8ailyn+l1h4w1BvVY04S56fYY5nGkBZHMGLBjHDUMlORG4wcCT9R6RB+3vM8jVMU1hmlOoXIOMKqotE2HxWYNJq/7EZ2l63NJ+Z2aTA4Yq+7t0PhOxCz9WP1mA3DJZZGDkRfq+qFAGwhwHUAVqBfDiMUlypaMWApR1VoWLChfUpJzkBDMCTf85UZr6jyHa1psZnTS5iKatTVKcX/Ker9zMvM1T0okGyiQcreJbU1tc+Yj/ms3395FBIADkjlkjbAZNdiwgRD/+1LEBwAL8Tdbp6Rh+XmT6XWHjCx5U4sTCtlUidNtS9I7oUx7oxdIZlOghkIQYzB0vxtMs6QgCg4WMVakQMM5HRfrsdIEftM0yfOHnNGkiPRMoWCKSsxsChat8/vYw4c4t+CMMB5AAAAXZrftWiEVdbSgnURZoWvK2KhK9GfCkIGnQKxIqbYJ0JCNFJ3St1wuUNRLW4Kw5VhLVGrmgYKhhRe1qzzC7SqFFyjJlIqXcPD6gw//epZ9bwQFw+s+rdVAFtzl0AAAA3I3JK0QJxtCHv/7UsQGAApAM0WssGFpSCKqNYMMvgZph6CwIhKEt0yEiMwFKpnDBBajVc5jbTM7KayRt3I43h8Ag05kd9AtqO0bItmf/+Aevzf7dx28sK0hvP//3/izNwf1pfEAgANutuOJACSqWvuW+SKNLQSpOQKsrX3XxnZxy2Rus0Q1irPy9Mkg4kZGJFRQUax4R+jsACwavqYd2bmRX/6VnKrLk2Z2VGYwQNCIEasJh7/oBScAAMtBNgBWssKw0uCAgKkVpJirpZyBklUCwqaSIkW6BgIY//tSxBIDSYw3Km0kSoEzi9KAliSw9QNAydBqoFQVEQNBwiJYiBWdDqxiwVBUGqg6JgaBoGj3//////huVcFQsIRoPjBXLBGA8AkCwOhcD4KAmFAtEYcR6E8gD2OAXJ2N//uSJVZVJNRdh0gkLCwuKioqz4sLC3//////4sLC31ioqKpAoqKirOgFqkxBTUUzLjk4LjKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+1LEIwPAAAGkAAAAIAAANIAAAASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqg==");as();var qg=.075,Ji=.0015,SW=.02,DW=125,kW=330,GW=2e3,zne=27.5,Kne=4186,w2=.04,v2=.2,TW=25;function MW(r){return r<2e3?.002:.005}function qne(r){return{segments:r.clippedSegments.length,totalPoints:r.clippedSegments.map(e=>e.length).reduce((e,t)=>e+t,0),graphMode:r.graphMode,duration:r.duration,discrete:r.discrete}}var ZC=class{constructor(e,t){this.audioContext=e.audioContext,this.audioContext&&(this.oscillator=this.audioContext.createOscillator(),this.oscillator.setPeriodicWave(e.getBaseWaveform()),this.firstHarmonic=this.audioContext.createOscillator(),this.firstHarmonic.setPeriodicWave(e.getFirstHarmonicWaveform()),this.firstHarmonicGain=this.audioContext.createGain(),this.firstHarmonicGain.gain.value=0,this.pan=this.audioContext.createStereoPanner(),this.pan.pan.value=0,this.gain=this.audioContext.createGain(),this.gain.gain.value=0,this.oscillatorGain=this.audioContext.createGain(),this.oscillatorGain.gain.value=.5,this.oscillatorGain.connect(this.gain),this.oscillator.connect(this.oscillatorGain),this.firstHarmonic.connect(this.firstHarmonicGain),this.firstHarmonicGain.connect(this.gain),this.gain.connect(this.pan),this.pan.connect(t),this.oscillator.start(),this.firstHarmonic.start(),this.brownNoiseGain=this.audioContext.createGain(),this.brownNoiseGain.gain.value=0,this.brownNoiseSource=this.audioContext.createBufferSource(),this.brownNoiseSource.buffer=e.brownNoiseSample,this.brownNoiseSource.loop=!0,this.brownNoiseSource.start(),this.brownNoiseSource.connect(this.brownNoiseGain),this.brownNoiseGain.connect(this.pan))}stop(e){let t=Math.max(this.audioContext.currentTime,e);this.gain.gain.setTargetAtTime(0,t,Ji),this.brownNoiseGain.gain.setTargetAtTime(0,t,Ji),setTimeout(()=>{this.oscillator.stop(),this.firstHarmonic.stop(),this.brownNoiseSource.stop(),this.pan.disconnect()},1e3*(2*Ji+Math.max(0,e-this.audioContext.currentTime))+1)}};function Hne(r){if(r.length<=2)return[r];let e=__dcg_shared_module_exports__['y'](r,2),t=0,i=[[e[0]]],o=e[0][0]<e[1][0];for(let n=1;n<e.length;n++)i[t].push(e[n]),n<e.length-1&&o!==e[n][0]<e[n+1][0]&&(o=!o,t++,i[t]=[e[n]]);return i.map(n=>__dcg_shared_module_exports__['t'](n))}function Wne(r){let e=__dcg_shared_module_exports__['y'](r,2);return e.sort((t,i)=>t[0]-i[0]),__dcg_shared_module_exports__['t'](e)}var g1=class{constructor({controller:e,agNavigator:t,audioEnabled:i}){this.isPlayingOneBranch=!1;this.FREQ_MIN=DW;this.FREQ_MAX=GW;this.FREQ_BASE=kW;e&&(this.controller=e),this.audioContextManager=new Gy,this.audioGraphNavigator=t,this.audioEnabled=i,this.screenDuration=5,this.audioVolume=.5}getBaseWaveform(){var i;let e=new Float32Array([0,1,0,.25]),t=new Float32Array([1,0,.25,0]);return(i=this.audioContext)==null?void 0:i.createPeriodicWave(e,t)}getFirstHarmonicWaveform(){var i;let e=new Float32Array([0,0,0,.25,0,0,0,0]),t=new Float32Array([1,0,1,0,.25,0,.3,0]);return(i=this.audioContext)==null?void 0:i.createPeriodicWave(e,t)}async prepareSynthesizer(){if(!this.audioEnabled()||!this.audioContextManager||!this.audioGraphNavigator)return;try{this.audioContext=(await this.audioContextManager.getResumedAudioContext()).audioContext,this.playbackSupported=!0}catch(i){this.playbackSupported=!1;return}this.audioContext.destination.disconnect(),this.mainGainNode=this.audioContext.createGain(),this.mainGainNode.gain.value=this.audioVolume,this.mainGainNode.connect(this.audioContext.destination);let e=this.audioContext.sampleRate*this.screenDuration;this.brownNoiseSample=this.audioContext.createBuffer(1,e,this.audioContext.sampleRate);let t=b2(0);for(let i=0;i<e;i++)t=b2(t),this.brownNoiseSample.getChannelData(0)[i]=t;if(!this.poiBufferSample)try{this.poiBufferSample=await this.audioContext.decodeAudioData(EW.buffer.slice(0))}catch(i){Ii(i)}Tk()}releaseAudio(){var e;this.stop(),(e=this.audioContextManager)==null||e.suspend()}synthesizePoint(e,t,i,o){let{gain:n,brownNoiseGain:a,oscillator:s,firstHarmonic:l,firstHarmonicGain:c,pan:d}=o,p=this.mapDependentToFrequency(t);if(!(!this.viewportBounds||!p)){if(t<this.viewportBounds.dependentMin||t>this.viewportBounds.dependentMax){a.gain.setTargetAtTime(w2,i,Ji),a.gain.setTargetAtTime(0,i+qg,Ji);return}s.frequency.setValueAtTime(p,i),l.frequency.setValueAtTime(p,i),n.gain.setTargetAtTime(1,i,Ji),e>0&&c.gain.setTargetAtTime(.15,i,Ji),a.gain.setTargetAtTime(x2(t),i,Ji),d.pan.setTargetAtTime(this.getPanValueFromIndependent(e),i,Ji),n.gain.setTargetAtTime(0,i+qg,Ji),c.gain.setTargetAtTime(0,i+qg,Ji),a.gain.setTargetAtTime(0,i+qg,Ji)}}playPoint(e){!bW(e)||!this.audioContextManager||(this.setupScales(e.graphMode),this.prepareSynthesizer().then(()=>{let t=new ZC(this,this.mainGainNode);this.turnMainGainOn();let i=this.audioContext.currentTime,{independent:o,dependent:n}=CW(e);if(!this.mapDependentToFrequency(n)||!this.viewportBounds){t.stop(i);return}if(this.synthesizePoint(o,n,i,t),e.intersects){let a=this.audioContext.createBufferSource();a.connect(t.gain),a.buffer=this.poiBufferSample;try{a==null||a.start(this.audioContext.currentTime)}catch(s){}}t.stop(i+qg+Ji)}))}playCurrentSketch(e="sequential"){this.audioContextManager&&this.prepareSynthesizer().then(()=>{this.isPlaying=!0,this.isPlayingOneBranch=!1,this.controller.runAfterDispatch(()=>this.controller.dispatch({type:"render"})),this.prepareToPlay(e),this.startPlayingTime=this.audioContext.currentTime+Ji,this.currentPlayLoopStartTime=this.startPlayingTime,this.lagLoggingData||(this.lagLoggingData={startPlayingTime:this.startPlayingTime,branchCount:this.branches.length,branchInfo:this.branches.map(t=>qne(t)),branchIteratorStartTimes:[],branchIteratorRunTimes:[],branchIteratorCallCount:0,branchLags:[],screenDuration:this.screenDuration}),e==="sequential"?(this.currentPlayLoopBranchIndex=0,this.playBranchIterators=[this.playBranch(this.currentPlayLoopBranchIndex,this.currentPlayLoopStartTime)],this.lagLoggingData&&(this.lagLoggingData.proposedDuration=this.branches.reduce((t,i)=>{var o;return t+((o=i.duration)!=null?o:0)},0)),this.sequentialPlayLoop()):e==="simultaneous"&&(this.playBranchIterators=this.branches.map((t,i)=>this.playBranch(i,this.currentPlayLoopStartTime)),this.playBranchIterators.push(this.playBlankSpace(this.currentPlayLoopStartTime)),this.simultaneousPlayLoop())})}stop(){var o,n,a,s,l,c;Mk(),clearTimeout(this.timeoutId),this.isPlaying=!1,this.startPlayingTime=void 0;let e=(o=this.audioContext)==null?void 0:o.currentTime;if(!e)return;this.lagLoggingData&&(this.lagLoggingData.actualDuration=e-this.lagLoggingData.startPlayingTime,this.lagLoggingData.stopPlayingTime=e,(a=(n=this.controller).logEvent)==null||a.call(n,{category:"audio-trace",action:"stop-graph"}),this.lagLoggingData=void 0);let t=(s=this.playBranchIterators)==null?void 0:s.map(d=>d.next()).filter(d=>!d.done);t==null||t.forEach(d=>{var p,g;return(g=(p=d.value).synthStopCallback)==null?void 0:g.call(p,e)}),this.playBranchIterators=[],(l=this.mainGainNode)==null||l.gain.cancelScheduledValues(e),(c=this.mainGainNode)==null||c.gain.setTargetAtTime(0,e,Ji);let i=this.mainGainNode;setTimeout(()=>i.disconnect(),1e3*2*Ji+1),this.controller.runAfterDispatch(()=>this.controller.dispatch({type:"render"}))}getGraphMode(){if(this.branches)return this.currentPlayLoopBranchIndex!==void 0?this.branches[this.currentPlayLoopBranchIndex].graphMode:this.branches[0].graphMode}playBranchByIndex(e){this.audioContext&&this.prepareSynthesizer().then(()=>{this.prepareToPlay("simultaneous"),this.isPlayingOneBranch=!0,this.isPlaying=!0,this.startPlayingTime=this.audioContext.currentTime+Ji,this.currentPlayLoopStartTime=this.startPlayingTime,this.currentPlayLoopBranchIndex=e,this.branches[0].graphMode===8||this.branches[0].graphMode==5||this.branches[0].graphMode==6?(this.playBranchIterators=this.branches.map((t,i)=>this.playBranch(i,this.currentPlayLoopStartTime)),this.playBranchIterators.push(this.playBlankSpace(this.currentPlayLoopStartTime))):this.playBranchIterators=[this.playBranch(e,this.startPlayingTime)],this.simultaneousPlayLoop()})}getPlaybackSupported(){return this.playbackSupported}getIsPlaying(){return this.isPlaying}getAudioSpeed(){return this.screenDuration*10}setAudioSpeed(e){this.screenDuration=e/10}getAudioVolume(){return this.audioVolume}setAudioVolume(e){var t;this.audioVolume=e,(t=this.mainGainNode)==null||t.gain.setTargetAtTime(this.audioVolume,0,Ji)}getCurrentIndependentValue(){var i,o;if(!this.getIsPlaying()||this.startPlayingTime===void 0)return;if(this.isPlayingOneBranch)return(o=(i=this.branches[this.currentPlayLoopBranchIndex]).mapTimeToIndependent)==null?void 0:o.call(i,this.audioContext.currentTime-this.startPlayingTime);let e=this.audioContext.currentTime-this.startPlayingTime,t=0;for(let n of this.branches)if(!(!n.duration||!n.mapIndependentToTime||!n.mapTimeToIndependent)){if(e-t>=n.duration){t+=n.duration;continue}return n.mapTimeToIndependent(e-t)}}getCurrentBranchIndex(){if(!this.getIsPlaying()||this.startPlayingTime===void 0)return;if(this.isPlayingOneBranch)return this.currentPlayLoopBranchIndex;let e=this.audioContext.currentTime-this.startPlayingTime,t=0;for(let i=0;i<this.branches.length;i++){let o=this.branches[i];if(o.duration){if(e-t>=o.duration){t+=o.duration;continue}return i}}}preprocessBranch(e,t){switch(e.graphMode){case 8:case 5:case 6:let i=[],o=e.segments;if(e.graphMode===6){let n=this.controller.getViewState();o=o.map(a=>wW(a,n))}for(let n of o){let s=y2(n,t,Ef);i.push(...s.filter(l=>l.length>2))}return i=__dcg_shared_module_exports__['t'](i.map(n=>Hne(n).map(a=>Wne(a))),!0),i.sort((n,a)=>n[0]-a[0]),i.map(n=>({graphMode:e.graphMode,discrete:!1,poi:e.poi,clippedSegments:[n]})).filter(n=>n.clippedSegments.length>0);case 2:case 1:{let n=[];for(let a of e.segments){let s=e.graphMode===2?Ef:gx,l=y2(a,t,s);n.push(...l.filter(c=>c.length>2))}return n.sort((a,s)=>a[0]-s[0]),{graphMode:e.graphMode,discrete:!1,clippedSegments:n,poi:e.poi}}case 3:case 4:{let{viewport:n}=t,a=e.segments[0].slice();a.sort(vW);let s=[],l=[];for(let c of a)s.push(c[0],c[1]),c[0]>=n.xmin&&c[0]<=n.xmax&&c[1]>=n.ymin&&c[1]<=n.ymax&&l.push(c[0],c[1]);return{graphMode:2,discrete:!0,clippedSegments:[l],poi:void 0}}default:throw new Error(`Unimplemented graph mode: ${e.graphMode}`)}}turnMainGainOn(){var e,t;(e=this.mainGainNode)==null||e.gain.cancelScheduledValues(0),(t=this.mainGainNode)==null||t.gain.setTargetAtTime(this.audioVolume,0,Ji)}getPanValueFromIndependent(e){if(!this.independentScale)return 0;let t=__dcg_shared_module_exports__['Wc'](this.independentScale,e)/this.screenDuration;return __dcg_shared_module_exports__['Cb'](2*t-1,-1,1)}setupScales(e){this.projection=this.controller.get2dProjection(),this.viewportBounds=yW(this.projection.viewport,e);let t=e===1?this.projection.settings.yAxisScale:this.projection.settings.xAxisScale,i=e===1?this.projection.settings.xAxisScale:this.projection.settings.yAxisScale;this.independentScale=__dcg_shared_module_exports__['Vc'](t,[this.viewportBounds.independentMin,this.viewportBounds.independentMax],[0,this.screenDuration]),this.dependentScale=__dcg_shared_module_exports__['Vc'](i,[this.viewportBounds.dependentMin,this.viewportBounds.dependentMax],[0,1]),this.viewportBounds.dependentMax<=Kne&&this.viewportBounds.dependentMin>=zne&&this.viewportBounds.dependentMax-this.viewportBounds.dependentMin>=1e3?(this.FREQ_MIN=this.viewportBounds.dependentMin,this.FREQ_MAX=this.viewportBounds.dependentMax,this.FREQ_BASE=void 0):(this.FREQ_MIN=DW,this.FREQ_MAX=GW,this.FREQ_BASE=kW)}densifyBranches(){this.branches.map(e=>{if(e.discrete)return e;let t=this.independentScale,i=this.dependentScale;return!t||!i||!e.clippedSegments||(e.clippedSegments=e.clippedSegments.map(o=>{let n=[];for(let a=0;a<o.length;a+=2){let s=this.mapDependentToFrequency(o[a+1]),l=this.mapDependentToFrequency(o[a+3]);if(n.push(o[a]),n.push(o[a+1]),s&&l&&isFinite(s)&&isFinite(l)&&Math.abs((l-s)/s)>=MW(Math.min(l,s))){let c=Math.ceil(Math.abs((l-s)/s)/MW(Math.min(l,s)));for(let d=1;d<c;d++)n.push(__dcg_shared_module_exports__['Xc'](t.type,o[a],o[a+2],d*1/c)),n.push(__dcg_shared_module_exports__['Xc'](i.type,o[a+1],o[a+3],d*1/c))}}return n})),e})}setupToPlayBranches(e){if(!this.audioGraphNavigator||!this.audioContext||!this.mainGainNode)return;let t=this.audioGraphNavigator.getCurrentSketch();if(!t)return;let i=this.controller.get2dProjection();if(this.branches=__dcg_shared_module_exports__['t'](t.branches.filter(o=>jd(o)).map(o=>this.preprocessBranch(o,i))).filter(o=>o.clippedSegments.length>0),!!this.branches.length)if(this.setupScales(this.branches[0].graphMode),this.densifyBranches(),e==="simultaneous"){let o=Math.min(...this.branches.map(c=>c.clippedSegments[0][0])),n=Math.max(...this.branches.map(c=>c.clippedSegments.slice(-1)[0].slice(-2)[0])),a=this.mapIndependentToTime(n)-this.mapIndependentToTime(o),s=__dcg_shared_module_exports__['Vc'](this.branches[0].graphMode===1?this.projection.settings.yAxisScale:this.projection.settings.xAxisScale,[o,n],[0,a]),l=__dcg_shared_module_exports__['Vc'](this.branches[0].graphMode===1?this.projection.settings.yAxisScale:this.projection.settings.xAxisScale,[0,a],[o,n]);this.branches.forEach(c=>{c.duration=c.discrete?a+qg:a,c.mapIndependentToTime=d=>__dcg_shared_module_exports__['Wc'](s,d),c.mapTimeToIndependent=d=>__dcg_shared_module_exports__['Wc'](l,d)})}else this.branches.forEach(o=>{let n=o.clippedSegments[0][0],a=o.clippedSegments.slice(-1)[0].slice(-2)[0];o.discrete?o.duration=o.clippedSegments.reduce((c,d)=>c+d.length/2,0)*(qg+SW):o.duration=this.mapIndependentToTime(a)-this.mapIndependentToTime(n);let s=__dcg_shared_module_exports__['Vc'](this.branches[0].graphMode===1?this.projection.settings.yAxisScale:this.projection.settings.xAxisScale,[n,a],[0,o.duration]),l=__dcg_shared_module_exports__['Vc'](this.branches[0].graphMode===1?this.projection.settings.yAxisScale:this.projection.settings.xAxisScale,[0,o.duration],[n,a]);o.mapIndependentToTime=c=>__dcg_shared_module_exports__['Wc'](s,c),o.mapTimeToIndependent=c=>__dcg_shared_module_exports__['Wc'](l,c)})}prepareToPlay(e){this.setupToPlayBranches(e),this.turnMainGainOn(),clearInterval(this.timeoutId)}sequentialPlayLoop(){var i,o,n,a,s;let e=this.audioContext.currentTime,t=(i=this.playBranchIterators[0])==null?void 0:i.next();if(this.lagLoggingData&&(this.lagLoggingData.branchIteratorCallCount++,this.audioContext.currentTime-e>0&&(this.lagLoggingData.branchIteratorStartTimes.push(e),this.lagLoggingData.branchIteratorRunTimes.push(this.audioContext.currentTime-e))),!!t){if(t.done)if(((o=t.value)==null?void 0:o.duration)!==void 0&&(this.currentPlayLoopStartTime=((n=t.value.startTime)!=null?n:this.currentPlayLoopStartTime)+t.value.duration),this.currentPlayLoopBranchIndex<this.branches.length-1)this.currentPlayLoopBranchIndex++,this.playBranchIterators[0]=this.playBranch(this.currentPlayLoopBranchIndex,this.currentPlayLoopStartTime),this.sequentialPlayLoop();else{(a=this.mainGainNode)==null||a.gain.cancelScheduledValues(this.currentPlayLoopStartTime),(s=this.mainGainNode)==null||s.gain.setTargetAtTime(0,this.currentPlayLoopStartTime,Ji),clearTimeout(this.timeoutId),this.timeoutId=setTimeout(()=>this.stop(),1e3*(Math.max(this.currentPlayLoopStartTime-this.audioContext.currentTime,0)+Ji));return}this.timeoutId=setTimeout(()=>this.sequentialPlayLoop(),TW)}}simultaneousPlayLoop(){var t,i;let e=this.playBranchIterators.map(o=>o.next());if(e.every(o=>o.done)){let o=this.currentPlayLoopStartTime+Math.max(...e.map(n=>{var a;return(a=n.value)!=null&&a.duration&&isFinite(n.value.duration)?n.value.duration:0}));(t=this.mainGainNode)==null||t.gain.cancelScheduledValues(o),(i=this.mainGainNode)==null||i.gain.setTargetAtTime(0,o,Ji),this.timeoutId=setTimeout(()=>this.stop(),1e3*(Math.max(o-this.audioContext.currentTime,0)+Ji))}else this.timeoutId=setTimeout(()=>this.simultaneousPlayLoop(),TW)}*playBlankSpace(e){let t=Math.max(this.audioContext.currentTime,e),i=new ZC(this,this.mainGainNode),{oscillator:o,pan:n,brownNoiseGain:a,gain:s}=i;o.stop(),s.gain.setTargetAtTime(1,t,Ji);let l=this.branches.map(p=>{if(p.mapIndependentToTime)return[p.clippedSegments[0][0],p.clippedSegments.slice(-1)[0].slice(-2)[0]]}).filter(p=>!!p),c=[];for(l.sort((p,g)=>p[0]-g[0]);l.length>0;){let p=l[0];l=l.filter(g=>g[1]>p[1]),l.filter(g=>g[0]<=p[1]).length===0&&c.push([p[1],Math.min(...l.map(g=>g[0]))])}c=c.filter(p=>isFinite(p[0])&&isFinite(p[1]));let d=p=>{i.stop(p)};for(let p of c){let g=t+this.mapIndependentToTime(p[0]),h=t+this.mapIndependentToTime(p[1]);for(;g>this.audioContext.currentTime+v2;)yield{synthStopCallback:d};a.gain.setTargetAtTime(w2,g,Ji),a.gain.setTargetAtTime(0,h,Ji),n.pan.setValueAtTime(this.getPanValueFromIndependent(p[0]),g),n.pan.linearRampToValueAtTime(this.getPanValueFromIndependent(p[1]),h)}return{duration:0}}mapDiscreteSegmentIndexToTime(e){return e/2*(qg+SW)}*playBranch(e,t){var y,x,E,C;let i=this.branches[e];if(!(i!=null&&i.duration)||!(i!=null&&i.mapIndependentToTime))return{duration:0};let o=Math.max(this.audioContext.currentTime,t),n=new ZC(this,this.mainGainNode),a=i.clippedSegments,s=S=>{n.stop(S)},{oscillator:l,gain:c,firstHarmonic:d,firstHarmonicGain:p,pan:g,brownNoiseGain:h}=n;if(i.poi&&i.poi.intersections&&this.poiBufferSample){let S=xW(i.graphMode,i.poi.intersections);for(let v of S){let M=this.audioContext.createBufferSource();M.connect(c),M.buffer=this.poiBufferSample;try{M==null||M.start(o+i.mapIndependentToTime(v))}catch(A){}}}let f=o;for(let S=0;S<a.length;S++){let v=a[S];for(let M=0;M<v.length;M+=2){let A=M===0,I=M+2>=v.length,P=i.discrete?f+this.mapDiscreteSegmentIndexToTime(M):o+i.mapIndependentToTime(v[M]),_=this.mapDependentToFrequency(v[M+1]);for(;P>this.audioContext.currentTime+v2;)yield{synthStopCallback:s,duration:void 0};if(i.discrete){this.synthesizePoint(v[M],v[M+1],f+this.mapDiscreteSegmentIndexToTime(M),n);continue}if(P<this.audioContext.currentTime-v2&&this.lagLoggingData&&this.lagLoggingData.branchLags.push({branchIndex:e,segmentIndex:S,pos:M,nextTime:P,proposedStartTime:t,lagAmount:this.audioContext.currentTime-P,currentTime:this.audioContext.currentTime}),A&&(p.gain.cancelScheduledValues(P),h.gain.cancelScheduledValues(P),c.gain.setTargetAtTime(1,P,Ji)),_!==void 0&&isFinite(_)){l.frequency.linearRampToValueAtTime(_,P),d.frequency.linearRampToValueAtTime(_,P);let U=P;if(M>=2&&v[M-2]<=0!=v[M]<=0){let O=v[M-2],q=v[M];U=o+i.mapIndependentToTime(__dcg_shared_module_exports__['Xc']((x=(y=this.independentScale)==null?void 0:y.type)!=null?x:"linear",O,q,Math.abs(q)/(Math.abs(q)+Math.abs(O))))}p.gain.setTargetAtTime(v[M]>0?.15:0,U,Ji);let R=P;if(M>=2&&v[M+1]<=0!=v[M-1]<=0){let O=v[M-2],q=v[M],w=v[M-1],T=v[M+1];R=o+i.mapIndependentToTime(__dcg_shared_module_exports__['Xc']((C=(E=this.independentScale)==null?void 0:E.type)!=null?C:"linear",O,q,Math.abs(w)/(Math.abs(w)+Math.abs(T))))}h.gain.setTargetAtTime(x2(v[M+1]),R,Ji)}I&&(c.gain.setTargetAtTime(0,P,Ji),S<i.clippedSegments.length-1&&h.gain.setTargetAtTime(w2,P,Ji)),M===0?g.pan.setValueAtTime(this.getPanValueFromIndependent(v[M]),P):g.pan.linearRampToValueAtTime(this.getPanValueFromIndependent(v[M]),P)}f+=this.mapDiscreteSegmentIndexToTime(v.length)}return i.duration=Math.max(0,i.duration,this.audioContext.currentTime-t),n.stop(o+i.duration),{duration:i.duration,startTime:o}}mapIndependentToTime(e){return this.independentScale?__dcg_shared_module_exports__['Wc'](this.independentScale,e):0}mapDependentToFrequency(e){if(!this.dependentScale)return;let t=__dcg_shared_module_exports__['Wc'](this.dependentScale,e);if(this.FREQ_BASE)return Math.min(Math.max(this.FREQ_BASE*Math.pow(2,t),this.FREQ_MIN),this.FREQ_MAX);{let i=this.FREQ_MAX-this.FREQ_MIN;return Math.min(Math.max(this.FREQ_MIN+i*t,this.FREQ_MIN),this.FREQ_MAX)}}};var eE=[{speed:1600,displayedSpeed:"1/32 x"},{speed:1200,displayedSpeed:"1/24 x"},{speed:800,displayedSpeed:"1/16 x"},{speed:400,displayedSpeed:"1/8 x"},{speed:200,displayedSpeed:"1/4 x"},{speed:100,displayedSpeed:"1/2 x"},{speed:50,displayedSpeed:"1 x"},{speed:25,displayedSpeed:"2 x"},{speed:12.5,displayedSpeed:"4 x"},{speed:6.25,displayedSpeed:"8 x"}],m1=class{constructor(e,t){this.grapher=t,this.controller=e,this.audioTraceActive=!1,this.wasFocusInExpressionsView=!1,this.focusedCell=void 0,this.sliderTraceActive=!1,this.sliderIndex=0,this.sliderArray=[],this.lastSpokenBranch=1,this.agNavigator=new h1(e,this,this.grapher),this.agSynthesizer=new g1({controller:e,agNavigator:this.agNavigator,audioEnabled:()=>this.controller.getAudio()}),this.audioSpeedIndex=6,this.agSynthesizer.releaseAudio()}remove(){}handleKeydown(e){let t=e.altKey&&!e.metaKey&&!e.ctrlKey&&!e.shiftKey;t&&ji(e)==="S"?this.agNavigator.getSelectedItem()&&(this.audioTraceActive||this.isFocusInExpressionsView())&&(e.preventDefault(),e.stopPropagation(),this.describeCurve()):t&&ji(e)==="G"?(this.audioTraceActive||this.isFocusInExpressionsView())&&(e.preventDefault(),e.stopPropagation(),this.describeAxes()):t&&ji(e)==="T"?(e.preventDefault(),e.stopPropagation(),this.toggleAudioTrace()):this.audioTraceActive&&(this.sliderTraceActive?this.sliderTraceKeydown(e):(this.stopAnimations(),this.audioTraceKeydown(e)))}sliderTraceKeydown(e){let t=e.altKey||e.metaKey,i=!t&&!e.ctrlKey&&!e.shiftKey;i&&Be(e)===kp||ji(e)==="J"?(e.preventDefault(),e.stopPropagation(),this.decrementSliderValue()):i&&Be(e)===Gp||ji(e)==="L"?(e.preventDefault(),e.stopPropagation(),this.incrementSliderValue()):i&&Be(e)===ly?(e.preventDefault(),e.stopPropagation(),this.decrementBigSliderValue()):i&&Be(e)===sy?(e.preventDefault(),e.stopPropagation(),this.incrementBigSliderValue()):!t&&(Be(e)===hn||!e.shiftKey&&Be(e)===cl||ji(e)==="K")?(e.preventDefault(),e.stopPropagation(),this.nextSlider()):!t&&(Be(e)===un||e.shiftKey&&Be(e)===cl||ji(e)==="I")?(e.preventDefault(),e.stopPropagation(),this.prevSlider()):i&&Be(e)===cg||ji(e)==="U"?(e.preventDefault(),e.stopPropagation(),this.sliderMin()):i&&Be(e)===Dp||ji(e)==="N"?(e.preventDefault(),e.stopPropagation(),this.sliderMax()):this.audioTraceKeydown(e)}audioTraceKeydown(e){let t=e.altKey||e.metaKey,i=t&&!e.ctrlKey&&!e.shiftKey,o=!t&&!e.ctrlKey&&!e.shiftKey,n=ji(e);if(Be(e)===un&&i)e.preventDefault(),e.stopPropagation(),On(),this.agNavigator.prevCurve();else if(Be(e)===hn&&i)e.preventDefault(),e.stopPropagation(),On(),this.agNavigator.nextCurve();else if(o&&Be(e)===kp||Be(e)===un||n==="J")e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"keypad/audio-trace",command:"previous-point"});else if(o&&Be(e)===Gp||Be(e)===hn||n==="L")e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"keypad/audio-trace",command:"next-point"});else if(!t&&(Be(e)===ly||!e.shiftKey&&Be(e)===cl||n==="I"))e.preventDefault(),e.stopPropagation(),this.reportAndMoveToNextPOI();else if(!t&&(Be(e)===sy||e.shiftKey&&Be(e)===cl||n==="K"))e.preventDefault(),e.stopPropagation(),this.reportAndMoveToPrevPOI();else if(o&&Be(e)===cg||n==="U")e.preventDefault(),e.stopPropagation(),this.reportAndMoveToFirstPoint();else if(o&&Be(e)===Dp||n==="N")e.preventDefault(),e.stopPropagation(),this.reportAndMoveToLastPoint();else if(o&&n==="X")e.preventDefault(),e.stopPropagation(),this.reportX();else if(o&&n==="P")e.preventDefault(),e.stopPropagation(),this.reportPOICount();else if(o&&n==="Y")e.preventDefault(),e.stopPropagation(),this.reportY();else if(o&&n==="T")e.preventDefault(),e.stopPropagation(),this.reportType();else if(o&&n==="B")e.preventDefault(),e.stopPropagation(),this.reportBranch();else if(o&&n==="O")e.preventDefault(),e.stopPropagation(),this.reportAndMoveToOrigin();else if(o&&n==="H")e.preventDefault(),e.stopPropagation(),this.hearGraph();else if(o&&typeof n=="string"&&n>="0"&&n<="9"){if(e.preventDefault(),e.stopPropagation(),On(),!this.controller.getAudio()){Te(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"));return}this.agSynthesizer.stop();let a=this.agNavigator.getCurrentSketch();if(a){let s;e.which===48?s=9:s=e.which-49;let l=s,c=-1;for(let d=0;d<a.branches.length;d++)if(jd(a.branches[d])&&(l-=1),l<0){c=d;break}c>=0?this.agSynthesizer.getPlaybackSupported()?(this.agSynthesizer.playBranchByIndex(c),this.grapher.traceLayer.setTraceInfo(void 0),this.graphAnimationTimeoutId=requestAnimationFrame(()=>this.animateCurrentSketchLine())):Te(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-play")):Te(this.controller.s("graphing-calculator-narration-audio-trace-branch-not-found",{branch:s+1}))}else Te(this.controller.s("graphing-calculator-narration-audio-trace-description-no-curve-selected"))}else t&&typeof n=="string"&&n>="1"&&n<="5"?(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-audio-trace-speed",speed:parseInt(n,10)+3})):!e.altKey&&!e.ctrlKey&&!e.metaKey&&n==="V"?(e.preventDefault(),e.stopPropagation(),this.controller.getAudio()?e.shiftKey?this.controller.dispatch({type:"keypad/audio-trace",command:"volume-down"}):this.controller.dispatch({type:"keypad/audio-trace",command:"volume-up"}):Te(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-play"))):o&&n==="A"?(e.preventDefault(),e.stopPropagation(),On(),this.queueAnimatingPoints(!0),Te()):o&&n==="S"&&this.controller.isListEnabled()?(e.preventDefault(),e.stopPropagation(),this.toggleSliderTrace()):o&&n==="C"?(e.preventDefault(),e.stopPropagation(),this.reportColor()):o&&this.exitAudioTrace();this.controller.dispatch({type:"render"})}describeCurve(){On();let e=this.agNavigator.getCurrentSketch();if(!e){Te(this.controller.s("graphing-calculator-narration-audio-trace-description-no-curve-selected"));return}Kt(this.controller.s("graphing-calculator-narration-audio-trace-description-color",{color:vf(this.controller,e.color)}));let t=JC(e,e.branches.length-1);t>1&&Kt(this.controller.s("graphing-calculator-narration-audio-trace-description-branch-count",{branches:t}));let i=!1,o=!1;for(let a of e.branches)if(t===1&&a.segments.length>0&&a.hasOwnProperty("operator")){if(a.graphMode===2){if(a.operator===">"||a.operator===">="){Kt(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-above"));break}else if(a.operator==="<"||a.operator==="<="){Kt(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-below"));break}}else if(a.graphMode===1){if(a.operator===">"||a.operator===">="){Kt(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-right"));break}else if(a.operator==="<"||a.operator==="<="){Kt(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-left"));break}}}else t>1&&(a.graphMode===2||a.graphMode===1?(a.operator==="<"||a.operator==="<="||a.operator===">"||a.operator===">=")&&(i=!0):a.graphMode===7&&(o=!0));i&&o&&Kt(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-in-regions"));let n=e.getPOI();if(n.length>0){let a=[];for(let s of n)a[s.type]===void 0?a[s.type]=1:a[s.type]+=1;a.forEach((s,l)=>{l===1001?Kt(s===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-intersection"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-intersections",{count:s})):l===1002?Kt(s===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-root"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-roots",{count:s})):l===1003?Kt(s===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-intercept"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-intercepts",{count:s})):l===1004?Kt(s===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-extremum"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-extrema",{count:s})):l===1008&&Kt(s===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-label"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-labels",{count:s}))})}Te()}describeAxes(){On(),Te(QC(this.controller))}queueCoordinates(e,t,i=!1){if(!this.grapher.getProjection().viewport||!e)return;let n=this.agNavigator.getCurrentSketch();(e.hasOwnProperty("branch")&&n&&n.branches.length>1&&this.lastSpokenBranch!==e.reportedBranch||t==="branch")&&typeof e.reportedBranch=="number"&&Kt(this.controller.s("graphing-calculator-narration-audio-trace-property-branch-number",{branch:e.reportedBranch})),this.lastSpokenBranch=e.reportedBranch?e.reportedBranch:e.branch+1,e.hasOwnProperty("type")&&!t?Kt(this.controller.s("graphing-calculator-narration-audio-trace-property-type-before-coordinates",{type:this.describePOI(e)})):t==="type"&&Kt(this.describePOI(e)),(!t||t==="x")&&Kt(ps(this.controller,e.x)),(!t||t==="y")&&Kt(us(this.controller,e.y)),i&&Te()}describePOI(e){if(e.typeChain){let t=[];for(let i=0;i<e.typeChain.length;i++)t.push(this.poiTypeToText(e,i));return t.join(", ")}else return this.poiTypeToText(e)}poiTypeToText(e,t){switch(t&&e.typeChain?e.typeChain[t]:e.type){case 1001:let o=this.getIntersectingCurves(e);return o!==""?this.controller.s("graphing-calculator-narration-audio-trace-point-type-intersection-with-curves",{curves:o}):this.controller.s("graphing-calculator-narration-audio-trace-point-type-intersection");case 1002:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-root");case 1003:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-intercept");case 1004:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-extremum");case 1006:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-definition");case 1007:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-trace");case 1008:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-label");default:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-not-a-poi")}}getIntersectingCurves(e){return!e||!e.intersects?"":this.getExpressionAriaLabel(e.intersects)}getExpressionAriaLabel(e){let t=this.controller.getItemModel(e);return t?t.type==="expression"&&t.label?la(t.label):t.type==="table"&&this.focusedCell?this.controller.s("graphing-calculator-narration-audio-trace-expression-with-column",{index:t.displayIndex,column:this.focusedCell.location.column+1}):Ui(t,"describe"):""}exitAudioTrace(e){if(this.audioTraceActive){if(this.audioTraceActive=!1,this.controller.isKeypadEnabled()&&this.controller.dispatch({type:"keypad/123"}),e||(e=this.controller.s("graphing-calculator-text-audio-trace-off")),this.controller.dispatch({type:"toast/close"}),this.wasFocusInExpressionsView){let t=this.agNavigator.getSelectedItem();(!t||!this.controller.isItemSelectable(t.id))&&(t=this.controller.getFirstFullyVisibleItem()),t&&this.controller.isItemSelectable(t.id)&&this.controller.dispatch({type:"move-focus-to-item",id:t.id,where:t.type==="table"&&this.focusedCell!==void 0?{location:"cell",...this.focusedCell.location}:"end"})}this.wasFocusInExpressionsView=!1,this.focusedCell=void 0,this.stopAnimations(),this.sliderTraceActive=!1,this.sliderIndex=0,this.agSynthesizer.stop(),this.agSynthesizer.releaseAudio(),this.agNavigator.reset(),this.lastSpokenBranch=1,this.grapher.traceLayer.setTraceInfo(void 0),this.grapher.traceLayer.setTraceLine(void 0),this.controller.requestRedrawGraph(),Te(e),this.resumeAnimations()}}isFocusInExpressionsView(){return!!this.controller.getFocusedItem()}canAudioTraceCurrentExp(){let e=this.agNavigator.getSelectedItem();return e?e.type==="table"?!!this.agNavigator.getCurrentSketch():this.agNavigator.canTrace(e):!1}enterAudioTrace(e){var a;let t=this.agNavigator.getSelectedItem(),i=t&&t.type!=="table"&&!this.agNavigator.canTrace(t)?this.getExpressionAriaLabel(t.id):void 0,o=!1;this.audioTraceActive||(this.wasFocusInExpressionsView=this.isFocusInExpressionsView(),t&&i&&Kt(this.controller.s("graphing-calculator-narration-audio-trace-unsupported-expression",{expression:i})),o=!!i||!this.wasFocusInExpressionsView);let n;if(o)n=this.agNavigator.getFirstTraceableSketch({selectAssociatedExpression:!0});else if(!i){if(t&&t.type==="expression"&&t.formula&&t.formula.error)return this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-narration-audio-trace-description-no-curve-selected")}});if(t&&t.type==="table"){let s=ds(t);(!this.focusedCell||this.focusedCell.tableId!==t.id||s&&(s.column!==this.focusedCell.location.column||s.row!==this.focusedCell.location.row))&&(this.focusedCell=s!==void 0?{tableId:t.id,location:s}:void 0)}else this.focusedCell=void 0;n=this.agNavigator.getCurrentSketch()}if(!n){this.agNavigator.reset(),this.lastSpokenBranch=1,this.exitAudioTrace(),n=this.agNavigator.getCurrentSketch();let s=n==null?void 0:n.branches[0].graphMode;return s===8&&!pr("audioTraceSimult")?(this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-audio-trace-no-implicit-support")}})):s===5&&!pr("audioTraceSimult")?(this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-audio-trace-no-parametric-support")}})):s===6&&!pr("audioTraceSimult")?(this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-audio-trace-no-polar-support")}})):this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-narration-audio-trace-description-no-curve-selected")}})}if((a=this.controller.toneController)==null||a.handleAction({type:"mute-global"}),this.agNavigator.reset(),this.agNavigator.computeStepSizes(),this.lastSpokenBranch=1,this.grapher.traceLayer.clearOpenedPOI(),this.controller.requestRedrawGraph(),!this.audioTraceActive&&(this.controller.isKeypadEnabled()||this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-audio-trace-on"),noAria:!0,onHide:()=>this.exitAudioTrace(),hideAfter:0}}),i&&n&&Kt(this.controller.s("graphing-calculator-narration-audio-trace-tracing-different-expression",{expression:this.getExpressionAriaLabel(this.focusedCell?this.focusedCell.tableId:n.id)})),Kt(this.controller.s("graphing-calculator-text-audio-trace-on")),this.controller.getAudio()||Kt(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled")),this.pauseAnimations(),this.queueAnimatingPoints(!1),this.agSynthesizer.prepareSynthesizer(),(!e||!e.fromKeypad)&&(Kt(this.controller.s("graphing-calculator-narration-audio-trace-instructions-use-arrow-keys")),this.controller.getAudio()&&Kt(this.controller.s("graphing-calculator-narration-audio-trace-instructions-hear-graph")),this.agNavigator.getTraceableExpressionCount()>1&&(Ti?Kt(this.controller.s("graphing-calculator-narration-audio-trace-instructions-expression-navigation-mac")):Kt(this.controller.s("graphing-calculator-narration-audio-trace-instructions-expression-navigation-windows"))),Ti?Kt(this.controller.s("graphing-calculator-narration-audio-trace-instructions-disable-mac")):Kt(this.controller.s("graphing-calculator-narration-audio-trace-instructions-disable-windows"))),this.wasFocusInExpressionsView)){let s=this.controller.findEl(".dcg-graph-outer");s&&(ie(s).one("focusin",()=>{setTimeout(()=>{Te()},0)}),this.controller.dispatch({type:"set-focus-location",location:{type:"graph-paper"}}))}this.agNavigator.moveToOrigin(),Kt(this.getExpressionAriaLabel(n.id)),this.reportAudioTrace({playSound:!1}),this.wasFocusInExpressionsView||Te(),this.audioTraceActive=!0,this.controller.isKeypadEnabled()&&this.controller.dispatch({type:"keypad/audio"})}checkIfSelectedItemChanged(e){this.lastSelectedId!==e&&(this.lastSelectedId=e,this.audioTraceActive&&(e?(Kt(this.getExpressionAriaLabel(e)),this.exitSliderTrace(),this.agNavigator.updatePOI(),this.agNavigator.moveToOrigin(),this.reportAudioTrace(),Te()):this.exitAudioTrace()))}pauseAnimations(){this.sliderArray.length=0,this.controller.getAllModelsWithSliders().forEach(t=>{t.slider.isPlaying&&(this.controller.dispatch({type:"set-slider-isplaying",id:t.id,isPlaying:!1}),this.sliderArray.push(t))})}resumeAnimations(){if(this.sliderArray.length!==0){for(let e=0;e<this.sliderArray.length;e++){let t=this.sliderArray[e];t.slider.isPlaying!==!0&&this.controller.dispatch({type:"set-slider-isplaying",id:t.id,isPlaying:!0})}this.sliderArray.length=0}}stopAnimations(){this.controller.getAllModelsWithSliders().forEach(t=>{t.slider.isPlaying&&this.controller.dispatch({type:"set-slider-isplaying",id:t.id,isPlaying:!1})})}getAnimatingVars(){let e=[];for(let t=0;t<this.sliderArray.length;t++)e.push('"'+sa(this.sliderArray[t])+'"');return e}hasActiveSliders(){let e=this.controller.getAllModelsWithSliders();for(let t=0;t<e.length;t++)if(e[t].slider.isPlaying)return!0;return!1}queueAnimatingPoints(e){this.sliderArray.length===1?Kt(this.controller.s("graphing-calculator-narration-audio-trace-one-slider-paused")):this.sliderArray.length>1?Kt(this.controller.s("graphing-calculator-narration-audio-trace-multiple-sliders-paused",{sliders:this.sliderArray.length})):e&&Kt(this.controller.s("graphing-calculator-narration-audio-trace-no-sliders-paused"))}queueSliderLatex(){this.hasActiveSliders()||this.agSynthesizer.stop();let e=this.getSelectedSlider();e?Kt(e.latex):Kt(this.controller.s("graphing-calculator-narration-audio-trace-slider-value-unknown"))}getSelectedSlider(){let e=this.controller.getAllModelsWithSliders();return this.sliderIndex<=e.length-1?e[this.sliderIndex]:null}incrementSliderValue(){this.adjustSlider("up")}decrementSliderValue(){this.adjustSlider("down")}incrementBigSliderValue(){this.adjustSlider("bigup")}decrementBigSliderValue(){this.adjustSlider("bigdown")}nextSlider(){this.adjustSlider("next")}prevSlider(){this.adjustSlider("prev")}sliderMin(){this.adjustSlider("min")}sliderMax(){this.adjustSlider("max")}adjustSlider(e){let t=this.getSelectedSlider();if(!t){Kt(this.controller.s("graphing-calculator-narration-audio-trace-cannot-change-slider-value"));return}let i=t.latex,o=this.controller.getAllModelsWithSliders().length;switch(e){case"up":case"down":case"bigup":case"bigdown":case"min":case"max":this.controller.dispatch({type:"adjust-slider-by-keyboard",id:t.id,adjustment:e}),this.queueSliderLatex(),Te();break;case"next":this.sliderIndex++,this.sliderIndex>=o&&(Kt(this.controller.s("graphing-calculator-narration-audio-trace-last-slider")),this.sliderIndex=o-1),this.queueSliderLatex(),Te();return;case"prev":this.sliderIndex--,this.sliderIndex<0&&(Kt(this.controller.s("graphing-calculator-narration-audio-trace-first-slider")),this.sliderIndex=0),this.queueSliderLatex(),Te();return}!t.slider.isPlaying&&i!==t.latex&&(this.queueSliderLatex(),Te())}toggleAudioTrace(){this.audioTraceActive?this.exitAudioTrace():this.enterAudioTrace()}toggleSliderTrace(){this.sliderTraceActive?this.exitSliderTrace():this.enterSliderTrace()}enterSliderTrace(){if(this.sliderTraceActive)return;this.sliderIndex=0,this.controller.getAllModelsWithSliders().length!==0?(Kt(this.controller.s("graphing-calculator-narration-slider-trace-on")),this.queueSliderLatex(),this.sliderTraceActive=!0):(Kt(this.controller.s("graphing-calculator-narration-slider-trace-no-sliders")),this.sliderTraceActive=!1),Te()}exitSliderTrace(){this.sliderTraceActive&&(Kt(this.controller.s("graphing-calculator-narration-slider-trace-off")),this.sliderTraceActive=!1,this.sliderIndex=0,Te())}recomputePoints(){!this.audioTraceActive||this.agSynthesizer.getIsPlaying()||(this.agNavigator.updatePOI(),this.agNavigator.updateSampledPoints(),this.agNavigator.updateCurrentPoint(),this.agNavigator.resetTracePoint(),this.agNavigator.computeStepSizes())}reportAndMoveToPrevPoint(){On(),this.agNavigator.prevPoint(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToNextPoint(){On(),this.agNavigator.nextPoint(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToOrigin(){On(),this.agNavigator.moveToOrigin(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToPrevPOI(){On(),this.agNavigator.prevPOI(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToNextPOI(){On(),this.agNavigator.nextPOI(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToFirstPoint(){On(),this.agNavigator.firstPoint(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToLastPoint(){On(),this.agNavigator.lastPoint(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportX(){On(),this.reportAudioTrace({propToSpeak:"x",playSound:!1})}reportY(){On(),this.reportAudioTrace({propToSpeak:"y",playSound:!1})}reportColor(){On();let e=this.agNavigator.getCurrentSketch();e?Kt(vf(this.controller,e.color)):Kt(this.controller.s("graphing-calculator-narration-color-unknown")),Te()}reportPOICount(){On();let e=this.agNavigator.getCurrentSketch(),t=e?e.getPOI().length:0;Te(this.controller.s("graphing-calculator-narration-audio-trace-poi-count",{x:t}))}reportType(){On(),this.reportAudioTrace({propToSpeak:"type",playSound:!1})}reportBranch(){On(),this.reportAudioTrace({propToSpeak:"branch",playSound:!1})}describePoint(){On(),this.reportAudioTrace({playSound:!1}),Te()}playCurrentPoint(){let e=this.agNavigator.getCurrentPoint();e&&this.agSynthesizer.playPoint(e)}reportAudioTrace(e){let t=this.agNavigator.getCurrentPoint();if(!t)return;let i=e&&e.propToSpeak,o=this.controller.getAudio()&&this.agSynthesizer.getPlaybackSupported()&&(e&&e.playSound!==void 0?e.playSound:!0),n=e&&e.speakCoordinates!==void 0?e.speakCoordinates:!0;this.agSynthesizer.stop(),o&&this.playCurrentPoint(),n&&(this.queueCoordinates(t,i),setTimeout(function(){Te()},i?0:100))}adjustPlaybackSpeed(e){if(!this.controller.getAudio()){Te(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"));return}if(e<0||e>=eE.length)return;this.audioSpeedIndex=e;let t=eE[e];return this.agSynthesizer.setAudioSpeed(t.speed),Te(this.controller.s("graphing-calculator-narration-audio-trace-playback-speed",{speed:t.displayedSpeed}))}speedUp(){this.adjustPlaybackSpeed(this.audioSpeedIndex+1)}speedDown(){this.adjustPlaybackSpeed(this.audioSpeedIndex-1)}adjustVolume(e){if(On(),!this.controller.getAudio()){Te(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"));return}let t=this.agSynthesizer.getAudioVolume(),i=e==="up"?Math.min(100,Math.round((t+.1)*100)):Math.max(0,Math.round((t-.1)*100));this.agSynthesizer.setAudioVolume(i/100),this.playCurrentPoint(),Te(this.controller.s("graphing-calculator-narration-audio-trace-volume",{volume:i}))}getFocusedCell(){return this.focusedCell}setFocusedCell(e){this.focusedCell=e}getAudioTraceActive(){return this.audioTraceActive}isAudioTracing(){return!!this.agSynthesizer&&this.agSynthesizer.getIsPlaying()}handleEvaluatorChange(e){}hearGraph(){var e,t;if(On(),!this.controller.getAudio()){Te(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"));return}if(this.agSynthesizer.getPlaybackSupported()){this.agSynthesizer.stop();let i=this.agNavigator.getCurrentSketch();if((t=(e=this.controller).logEvent)==null||t.call(e,{category:"audio-trace",action:"hear-graph"}),i&&Sc(this.controller,i)){let o=pr("audioTraceSimult")?"simultaneous":"sequential";this.agSynthesizer.playCurrentSketch(o),o==="simultaneous"?(this.grapher.traceLayer.setTraceInfo(void 0),requestAnimationFrame(()=>this.animateCurrentSketchLine())):(this.grapher.traceLayer.setTraceLine(void 0),requestAnimationFrame(()=>this.animateCurrentSketchPoint()))}else Te(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-trace-this-expression"))}else Te(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-play"))}animateCurrentSketchPoint(){if(this.graphAnimationTimeoutId&&cancelAnimationFrame(this.graphAnimationTimeoutId),this.graphAnimationTimeoutId=requestAnimationFrame(()=>this.animateCurrentSketchPoint()),!this.agSynthesizer.getIsPlaying())return;let e=this.agSynthesizer.getCurrentIndependentValue(),t=this.agSynthesizer.getCurrentBranchIndex();e!==void 0&&t!==void 0&&this.agNavigator.drawTracePoint(this.agNavigator.getPoint(t,e))}animateCurrentSketchLine(){if(this.graphAnimationTimeoutId&&cancelAnimationFrame(this.graphAnimationTimeoutId),this.graphAnimationTimeoutId=requestAnimationFrame(()=>this.animateCurrentSketchLine()),!this.agSynthesizer.getIsPlaying())return;let e=this.agSynthesizer.getCurrentIndependentValue();e!==void 0&&this.agNavigator.drawTraceLine(e,this.agSynthesizer.getGraphMode())}stopGraph(){this.agSynthesizer.stop(),this.graphAnimationTimeoutId&&cancelAnimationFrame(this.graphAnimationTimeoutId)}getAudioSpeedIndex(){return this.audioSpeedIndex}getAudioVolume(){var e;return(e=this.agSynthesizer.getAudioVolume())!=null?e:.5}};var tu={};__dcg_shared_module_exports__['d'](tu,{UnicodeBraille:()=>As,latexToNemeth:()=>bh,latexToUeb:()=>yh,nemethToLatex:()=>z2,uebToLatex:()=>K2,version:()=>Lse});var qW=Object.defineProperty,$ne=Object.getOwnPropertyNames,IW=Object.getOwnPropertySymbols,jne=Object.prototype.hasOwnProperty,Yne=Object.prototype.propertyIsEnumerable,AW=(r,e,t)=>e in r?qW(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Bx=(r,e)=>{for(var t in e||(e={}))jne.call(e,t)&&AW(r,t,e[t]);if(IW)for(var t of IW(e))Yne.call(e,t)&&AW(r,t,e[t]);return r},Ux=(r=>typeof __dcg_shared_module_exports__['a']!="undefined"?__dcg_shared_module_exports__['a']:typeof Proxy!="undefined"?new Proxy(r,{get:(e,t)=>(typeof __dcg_shared_module_exports__['a']!="undefined"?__dcg_shared_module_exports__['a']:e)[t]}):r)(function(r){if(typeof __dcg_shared_module_exports__['a']!="undefined")return __dcg_shared_module_exports__['a'].apply(this,arguments);throw new Error('Dynamic require of "'+r+'" is not supported')}),A2=(r,e)=>function(){return e||(0,r[$ne(r)[0]])((e={exports:{}}).exports,e),e.exports},V2=(r,e)=>{for(var t in e)qW(r,t,{get:e[t],enumerable:!0})},Xne=A2({"generated/latex.jison.js"(r,e){"use strict";var t=function(){var i=function(R,H,O,q){for(O=O||{},q=R.length;q--;O[R[q]]=H);return O},o=[1,13],n=[1,14],a=[1,15],s=[1,16],l=[1,17],c=[1,21],d=[1,18],p=[1,19],g=[1,20],h=[1,22],f=[1,23],y=[1,28],x=[1,30],E=[1,31],C=[1,32],S=[1,33],v=[1,29],M=[5,21,27,38],A=[5,19,21,22,23,24,25,26,27,28,32,33,34,35,36,37,38],I=[5,10,12,13,14,19,21,22,23,24,25,26,27,28,32,33,34,35,36,37,38],P=[5,10,19,21,22,23,24,25,26,27,28,32,33,34,35,36,37,38],_={trace:function(){},yy:{},symbols_:{error:2,sentence:3,group:4,EOF:5,level:6,expression:7,subscript:8,superscript:9,_:10,atom:11,"^":12,"PRIMES^":13,PRIMES:14,delimited_group:15,typeform:16,frac:17,radical:18,LEFT:19,delimiter:20,RIGHT:21,FRAC:22,OPERATOR_NAME:23,MATHRM:24,TEXT:25,RADICAL_OPTARG:26,CLOSE_OPTARG:27,RADICAL:28,curly_group:29,greek:30,command:31,SYMBOL:32,DELIMITER:33,DELIMITER_COMMAND:34,GREEK:35,COMMAND:36,"{":37,"}":38,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",10:"_",12:"^",13:"PRIMES^",14:"PRIMES",19:"LEFT",21:"RIGHT",22:"FRAC",23:"OPERATOR_NAME",24:"MATHRM",25:"TEXT",26:"RADICAL_OPTARG",27:"CLOSE_OPTARG",28:"RADICAL",32:"SYMBOL",33:"DELIMITER",34:"DELIMITER_COMMAND",35:"GREEK",36:"COMMAND",37:"{",38:"}"},productions_:[0,[3,2],[3,1],[4,3],[4,2],[4,1],[4,2],[4,1],[6,2],[6,2],[6,1],[6,1],[8,2],[9,2],[9,2],[9,1],[7,1],[7,1],[7,1],[7,1],[7,1],[15,5],[15,4],[17,3],[16,2],[16,2],[16,2],[18,4],[18,3],[18,2],[18,2],[11,1],[11,1],[11,1],[11,1],[11,1],[20,1],[20,1],[30,1],[31,1],[29,3],[29,2]],performAction:function(H,O,q,w,T,B,de){var F=B.length-1;switch(T){case 1:return B[F-1];case 2:return w.group();case 3:this.$=w.group(B[F-2],B[F-1],B[F]);break;case 4:case 6:this.$=w.group(B[F-1],B[F]);break;case 5:case 7:this.$=w.group(B[F]);break;case 8:this.$=w.level({_:w.group(B[F-1]),"^":w.group(B[F])});break;case 9:this.$=w.level({_:w.group(B[F]),"^":w.group(B[F-1])});break;case 10:this.$=w.level({"^":w.group(B[F])});break;case 11:this.$=w.level({_:w.group(B[F])});break;case 12:case 13:this.$=B[F];break;case 14:this.$=w.processPrimes(B[F-1],B[F]);break;case 15:this.$=w.processPrimes(B[F],w.group());break;case 21:this.$=w.group(B[F-3],B[F-2],B[F]);break;case 22:this.$=w.group(B[F-2],B[F]);break;case 23:this.$=w.fraction(w.group(B[F-1]),w.group(B[F]));break;case 24:this.$=w.typeform("operator_name",w.group(B[F]));break;case 25:this.$=w.typeform("mathrm",w.group(B[F]));break;case 26:this.$=w.typeform("text",w.group(B[F]));break;case 27:this.$=w.radical(B[F],w.group(B[F-2]));break;case 28:this.$=w.radical(w.group(B[F]),w.group());break;case 29:case 30:this.$=w.radical(w.group(B[F]));break;case 35:case 36:this.$=w.terminal(B[F]);break;case 37:case 39:this.$=w.command(B[F]);break;case 38:this.$=w.greek(B[F]);break;case 40:this.$=B[F-1];break;case 41:this.$=w.group();break}},table:[{3:1,4:2,5:[1,3],6:4,7:5,8:6,9:7,10:o,11:12,12:n,13:a,14:s,15:8,16:9,17:10,18:11,19:l,20:25,22:c,23:d,24:p,25:g,26:h,28:f,29:24,30:26,31:27,32:y,33:x,34:E,35:C,36:S,37:v},{1:[3]},{5:[1,34]},{1:[2,2]},i(M,[2,5],{15:8,16:9,17:10,18:11,11:12,29:24,20:25,30:26,31:27,7:35,19:l,22:c,23:d,24:p,25:g,26:h,28:f,32:y,33:x,34:E,35:C,36:S,37:v}),i(M,[2,7],{6:4,7:5,8:6,9:7,15:8,16:9,17:10,18:11,11:12,29:24,20:25,30:26,31:27,4:36,10:o,12:n,13:a,14:s,19:l,22:c,23:d,24:p,25:g,26:h,28:f,32:y,33:x,34:E,35:C,36:S,37:v}),i(A,[2,11],{9:37,12:n,13:a,14:s}),i(A,[2,10],{8:38,10:o}),i(I,[2,16]),i(I,[2,17]),i(I,[2,18]),i(I,[2,19]),i(I,[2,20]),{11:39,20:25,29:24,30:26,31:27,32:y,33:x,34:E,35:C,36:S,37:v},{11:40,20:25,29:24,30:26,31:27,32:y,33:x,34:E,35:C,36:S,37:v},{11:41,20:25,29:24,30:26,31:27,32:y,33:x,34:E,35:C,36:S,37:v},i(P,[2,15]),{20:42,33:x,34:E},{11:43,20:25,29:24,30:26,31:27,32:y,33:x,34:E,35:C,36:S,37:v},{11:44,20:25,29:24,30:26,31:27,32:y,33:x,34:E,35:C,36:S,37:v},{11:45,20:25,29:24,30:26,31:27,32:y,33:x,34:E,35:C,36:S,37:v},{11:46,20:25,29:24,30:26,31:27,32:y,33:x,34:E,35:C,36:S,37:v},{4:47,6:4,7:5,8:6,9:7,10:o,11:12,12:n,13:a,14:s,15:8,16:9,17:10,18:11,19:l,20:25,22:c,23:d,24:p,25:g,26:h,27:[1,48],28:f,29:24,30:26,31:27,32:y,33:x,34:E,35:C,36:S,37:v},{11:49,17:50,20:25,22:c,29:24,30:26,31:27,32:y,33:x,34:E,35:C,36:S,37:v},i(I,[2,31]),i(I,[2,32]),i(I,[2,33]),i(I,[2,34]),i(I,[2,35]),{4:51,6:4,7:5,8:6,9:7,10:o,11:12,12:n,13:a,14:s,15:8,16:9,17:10,18:11,19:l,20:25,22:c,23:d,24:p,25:g,26:h,28:f,29:24,30:26,31:27,32:y,33:x,34:E,35:C,36:S,37:v,38:[1,52]},i(I,[2,36]),i(I,[2,37]),i(I,[2,38]),i(I,[2,39]),{1:[2,1]},i(M,[2,4],{6:4,7:5,8:6,9:7,15:8,16:9,17:10,18:11,11:12,29:24,20:25,30:26,31:27,4:53,10:o,12:n,13:a,14:s,19:l,22:c,23:d,24:p,25:g,26:h,28:f,32:y,33:x,34:E,35:C,36:S,37:v}),i(M,[2,6]),i(A,[2,8]),i(A,[2,9]),i([5,12,13,14,19,21,22,23,24,25,26,27,28,32,33,34,35,36,37,38],[2,12]),i(P,[2,13]),i(P,[2,14]),{4:54,6:4,7:5,8:6,9:7,10:o,11:12,12:n,13:a,14:s,15:8,16:9,17:10,18:11,19:l,20:25,21:[1,55],22:c,23:d,24:p,25:g,26:h,28:f,29:24,30:26,31:27,32:y,33:x,34:E,35:C,36:S,37:v},i(I,[2,24]),i(I,[2,25]),i(I,[2,26]),{11:56,20:25,29:24,30:26,31:27,32:y,33:x,34:E,35:C,36:S,37:v},{27:[1,57]},{11:58,20:25,29:24,30:26,31:27,32:y,33:x,34:E,35:C,36:S,37:v},i(I,[2,29]),i(I,[2,30]),{38:[1,59]},i(I,[2,41]),i(M,[2,3]),{21:[1,60]},{20:61,33:x,34:E},i(I,[2,23]),{11:62,20:25,29:24,30:26,31:27,32:y,33:x,34:E,35:C,36:S,37:v},i(I,[2,28]),i(I,[2,40]),{20:63,33:x,34:E},i(I,[2,22]),i(I,[2,27]),i(I,[2,21])],defaultActions:{3:[2,2],34:[2,1]},parseError:function(H,O){if(O.recoverable)this.trace(H);else{var q=new Error(H);throw q.hash=O,q}},parse:function(H){var O=this,q=[0],w=[],T=[null],B=[],de=this.table,F="",j=0,pe=0,le=0,ne=2,X=1,ae=B.slice.call(arguments,1),J=Object.create(this.lexer),ge={yy:{}};for(var be in this.yy)Object.prototype.hasOwnProperty.call(this.yy,be)&&(ge.yy[be]=this.yy[be]);J.setInput(H,ge.yy),ge.yy.lexer=J,ge.yy.parser=this,typeof J.yylloc=="undefined"&&(J.yylloc={});var Ee=J.yylloc;B.push(Ee);var Le=J.options&&J.options.ranges;typeof ge.yy.parseError=="function"?this.parseError=ge.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function Se(Tr){q.length=q.length-2*Tr,T.length=T.length-Tr,B.length=B.length-Tr}for(var et=function(){var Tr;return Tr=J.lex()||X,typeof Tr!="number"&&(Tr=O.symbols_[Tr]||Tr),Tr},Z,W,De,Ne,me,ve,Pe={},He,ot,Ge,Et;;){if(De=q[q.length-1],this.defaultActions[De]?Ne=this.defaultActions[De]:((Z===null||typeof Z=="undefined")&&(Z=et()),Ne=de[De]&&de[De][Z]),typeof Ne=="undefined"||!Ne.length||!Ne[0]){var Oe="";Et=[];for(He in de[De])this.terminals_[He]&&He>ne&&Et.push("'"+this.terminals_[He]+"'");J.showPosition?Oe="Parse error on line "+(j+1)+`:
`+J.showPosition()+`
Expecting `+Et.join(", ")+", got '"+(this.terminals_[Z]||Z)+"'":Oe="Parse error on line "+(j+1)+": Unexpected "+(Z==X?"end of input":"'"+(this.terminals_[Z]||Z)+"'"),this.parseError(Oe,{text:J.match,token:this.terminals_[Z]||Z,line:J.yylineno,loc:Ee,expected:Et})}if(Ne[0]instanceof Array&&Ne.length>1)throw new Error("Parse Error: multiple actions possible at state: "+De+", token: "+Z);switch(Ne[0]){case 1:q.push(Z),T.push(J.yytext),B.push(J.yylloc),q.push(Ne[1]),Z=null,W?(Z=W,W=null):(pe=J.yyleng,F=J.yytext,j=J.yylineno,Ee=J.yylloc,le>0&&le--);break;case 2:if(ot=this.productions_[Ne[1]][1],Pe.$=T[T.length-ot],Pe._$={first_line:B[B.length-(ot||1)].first_line,last_line:B[B.length-1].last_line,first_column:B[B.length-(ot||1)].first_column,last_column:B[B.length-1].last_column},Le&&(Pe._$.range=[B[B.length-(ot||1)].range[0],B[B.length-1].range[1]]),ve=this.performAction.apply(Pe,[F,pe,j,ge.yy,Ne[1],T,B].concat(ae)),typeof ve!="undefined")return ve;ot&&(q=q.slice(0,-1*ot*2),T=T.slice(0,-1*ot),B=B.slice(0,-1*ot)),q.push(this.productions_[Ne[1]][0]),T.push(Pe.$),B.push(Pe._$),Ge=de[q[q.length-2]][q[q.length-1]],q.push(Ge);break;case 3:return!0}}return!0}},U=function(){var R={EOF:1,parseError:function(O,q){if(this.yy.parser)this.yy.parser.parseError(O,q);else throw new Error(O)},setInput:function(H,O){return this.yy=O||this.yy||{},this._input=H,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var H=this._input[0];this.yytext+=H,this.yyleng++,this.offset++,this.match+=H,this.matched+=H;var O=H.match(/(?:\r\n?|\n).*/g);return O?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),H},unput:function(H){var O=H.length,q=H.split(/(?:\r\n?|\n)/g);this._input=H+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-O),this.offset-=O;var w=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),q.length-1&&(this.yylineno-=q.length-1);var T=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:q?(q.length===w.length?this.yylloc.first_column:0)+w[w.length-q.length].length-q[0].length:this.yylloc.first_column-O},this.options.ranges&&(this.yylloc.range=[T[0],T[0]+this.yyleng-O]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(H){this.unput(this.match.slice(H))},pastInput:function(){var H=this.matched.substr(0,this.matched.length-this.match.length);return(H.length>20?"...":"")+H.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var H=this.match;return H.length<20&&(H+=this._input.substr(0,20-H.length)),(H.substr(0,20)+(H.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var H=this.pastInput(),O=new Array(H.length+1).join("-");return H+this.upcomingInput()+`
`+O+"^"},test_match:function(H,O){var q,w,T;if(this.options.backtrack_lexer&&(T={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(T.yylloc.range=this.yylloc.range.slice(0))),w=H[0].match(/(?:\r\n?|\n).*/g),w&&(this.yylineno+=w.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:w?w[w.length-1].length-w[w.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+H[0].length},this.yytext+=H[0],this.match+=H[0],this.matches=H,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(H[0].length),this.matched+=H[0],q=this.performAction.call(this,this.yy,this,O,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),q)return q;if(this._backtrack){for(var B in T)this[B]=T[B];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var H,O,q,w;this._more||(this.yytext="",this.match="");for(var T=this._currentRules(),B=0;B<T.length;B++)if(q=this._input.match(this.rules[T[B]]),q&&(!O||q[0].length>O[0].length)){if(O=q,w=B,this.options.backtrack_lexer){if(H=this.test_match(q,T[B]),H!==!1)return H;if(this._backtrack){O=!1;continue}else return!1}else if(!this.options.flex)break}return O?(H=this.test_match(O,T[w]),H!==!1?H:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var O=this.next();return O||this.lex()},begin:function(O){this.conditionStack.push(O)},popState:function(){var O=this.conditionStack.length-1;return O>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(O){return O=this.conditionStack.length-1-Math.abs(O||0),O>=0?this.conditionStack[O]:"INITIAL"},pushState:function(O){this.begin(O)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(O,q,w,T){var B=T;switch(w){case 0:break;case 1:return this.begin("optarg"),26;break;case 2:return this.popState(),27;break;case 3:return 23;case 4:return 24;case 5:return 25;case 6:return 28;case 7:return 22;case 8:return 13;case 9:return 14;case 10:return 12;case 11:return 10;case 12:return 19;case 13:return 21;case 14:return 34;case 15:return 33;case 16:return 37;case 17:return 38;case 18:return 32;case 19:return 32;case 20:return 32;case 21:return 35;case 22:return 35;case 23:return 36;case 24:return 32;case 25:return 5}},rules:[/^(?:\s+)/,/^(?:(\\sqrt)\s*\[)/,/^(?:\])/,/^(?:(\\operatorname))/,/^(?:(\\mathrm))/,/^(?:(\\text))/,/^(?:(\\sqrt))/,/^(?:(\\frac))/,/^(?:'+\^)/,/^(?:'+)/,/^(?:\^)/,/^(?:[_])/,/^(?:(\\left))/,/^(?:(\\right))/,/^(?:(\\langle|\\rangle|\\vert|\\Vert))/,/^(?:\[|\]|\\\{|\\\}|\(|\)|\||\\\|)/,/^(?:\{)/,/^(?:\})/,/^(?:\\(infty))/,/^(?:\\(int))/,/^(?:!)/,/^(?:\\(alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|omicron|pi|rho|sigma|tau|xi|upsilon|phi|chi|psi|omega))/,/^(?:\\(Alpha|Beta|Gamma|Delta|Epsilon|Zeta|Eta|Theta|Iota|Kappa|Lambda|Mu|Nu|Omicron|Pi|Rho|Sigma|Tau|Xi|Upsilon|Phi|Chi|Psi|Omega))/,/^(?:\\[A-Za-z]+)/,/^(?:\\.|.)/,/^(?:$)/],conditions:{optarg:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],inclusive:!0},INITIAL:{rules:[0,1,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],inclusive:!0}}};return R}();_.lexer=U;function Y(){this.yy={}}return Y.prototype=_,_.Parser=Y,new Y}();typeof Ux!="undefined"&&typeof r!="undefined"&&(r.parser=t,r.Parser=t.Parser,r.parse=function(){return t.parse.apply(t,arguments)},r.main=function(){},typeof e!="undefined"&&Ux.main===e&&r.main(process.argv.slice(1)))}}),HW=A2({"generated/nemeth-to-latex.jison.js"(r,e){"use strict";var t=function(){var i=function(ve,Pe,He,ot){for(He=He||{},ot=ve.length;ot--;He[ve[ot]]=Pe);return He},o=[1,11],n=[1,12],a=[1,13],s=[1,71],l=[1,72],c=[1,70],d=[1,38],p=[1,39],g=[1,60],h=[1,61],f=[1,62],y=[1,63],x=[1,64],E=[1,65],C=[1,66],S=[1,67],v=[1,68],M=[1,69],A=[1,40],I=[1,34],P=[1,35],_=[1,36],U=[1,37],Y=[1,41],R=[1,42],H=[1,43],O=[1,44],q=[1,45],w=[1,46],T=[1,47],B=[1,48],de=[1,49],F=[1,50],j=[1,51],pe=[1,52],le=[1,53],ne=[1,54],X=[1,17],ae=[1,55],J=[1,56],ge=[1,57],be=[1,58],Ee=[1,59],Le=[5,12,13,14,18,24,25],Se=[5,11,12,13,14,15,17,18,20,21,23,24,25,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,83],et=[1,76],Z=[5,11,12,13,14,15,17,18,20,21,23,24,25,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,78,79,80,81,83],W=[5,11,12,13,14,15,17,18,20,21,23,24,25,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83],De={trace:function(){},yy:{},symbols_:{error:2,sentence:3,group:4,EOF:5,element:6,index_element:7,modified_expression:8,radical:9,primes:10,OPEN_MODEXP:11,MODEXP_UNDER:12,MODEXP_OVER:13,CLOSE_MODEXP:14,RADICAL_INDEX:15,index_group:16,OPEN_RADICAL:17,CLOSE_RADICAL:18,level:19,LEVEL:20,BASELINE:21,frac:22,OPEN_FRAC:23,SLASH:24,CLOSE_FRAC:25,subscript_head:26,number:27,atom:28,command:29,greek:30,letter:31,comma:32,period:33,space:34,operation:35,comparison:36,level_with_comparison:37,ellipsis:38,colon:39,infinity:40,integral:41,factorial:42,ampersand:43,question_mark:44,bracket:45,",":46,".":47,"[":48,"{":49,"(":50,"]":51,"}":52,")":53,LANGLE:54,RANGLE:55,PIPE:56,DOUBLE_PIPE:57,SPACE:58,COMMAND:59,GREEK:60,LETTER:61,CAPITAL_LETTER:62,"+":63,"-":64,CDOT:65,TIMES:66,"*":67,"/":68,DIV:69,PERCENT_OF:70,PERCENT:71,TO:72,COMPARISON:73,LEVEL_WITH_COMPARISON:74,ELLIPSIS:75,COLON:76,NUMBER:77,INFINITY:78,INTEGRAL:79,FACTORIAL:80,"&":81,PRIMES:82,"?":83,unknown:84,UNKNOWN:85,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",11:"OPEN_MODEXP",12:"MODEXP_UNDER",13:"MODEXP_OVER",14:"CLOSE_MODEXP",15:"RADICAL_INDEX",17:"OPEN_RADICAL",18:"CLOSE_RADICAL",20:"LEVEL",21:"BASELINE",23:"OPEN_FRAC",24:"SLASH",25:"CLOSE_FRAC",46:",",47:".",48:"[",49:"{",50:"(",51:"]",52:"}",53:")",54:"LANGLE",55:"RANGLE",56:"PIPE",57:"DOUBLE_PIPE",58:"SPACE",59:"COMMAND",60:"GREEK",61:"LETTER",62:"CAPITAL_LETTER",63:"+",64:"-",65:"CDOT",66:"TIMES",67:"*",68:"/",69:"DIV",70:"PERCENT_OF",71:"PERCENT",72:"TO",73:"COMPARISON",74:"LEVEL_WITH_COMPARISON",75:"ELLIPSIS",76:"COLON",77:"NUMBER",78:"INFINITY",79:"INTEGRAL",80:"FACTORIAL",81:"&",82:"PRIMES",83:"?",85:"UNKNOWN"},productions_:[0,[3,2],[3,1],[4,2],[4,1],[6,1],[6,1],[6,2],[6,1],[8,7],[8,6],[8,5],[8,6],[8,5],[8,5],[8,4],[8,4],[8,3],[8,4],[8,4],[8,4],[8,4],[8,3],[8,3],[8,2],[9,5],[9,4],[9,4],[9,3],[9,3],[9,2],[19,1],[19,1],[22,5],[22,4],[22,4],[22,3],[16,2],[16,1],[7,3],[7,2],[7,2],[7,3],[7,2],[7,2],[7,1],[7,1],[7,1],[26,1],[26,1],[26,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[32,1],[33,1],[45,1],[45,1],[45,1],[45,1],[45,1],[45,1],[45,1],[45,1],[45,1],[45,1],[34,1],[29,1],[30,1],[31,1],[31,1],[35,1],[35,1],[35,1],[35,1],[35,1],[35,1],[35,1],[35,1],[35,1],[35,1],[36,1],[37,1],[38,1],[39,1],[27,1],[40,1],[41,1],[42,1],[43,1],[10,1],[44,1],[84,1]],performAction:function(Pe,He,ot,Ge,Et,Oe,Tr){var Q=Oe.length-1;switch(Et){case 1:return Oe[Q-1];case 2:return Ge.group();case 3:case 37:case 41:case 43:case 44:this.$=Ge.group(Oe[Q-1],Oe[Q]);break;case 4:case 38:this.$=Ge.group(Oe[Q]);break;case 7:this.$=Ge.group(Oe[Q-1],Oe[Q]);break;case 9:this.$=Ge.modified_expression(Oe[Q-5],Oe[Q-3],Oe[Q-1]);break;case 10:this.$=Ge.modified_expression(Oe[Q-4],Oe[Q-2]);break;case 11:this.$=Ge.modified_expression(Oe[Q-3],Oe[Q-1]);break;case 12:this.$=Ge.modified_expression(Oe[Q-4],Ge.group(),Oe[Q-1]);break;case 13:this.$=Ge.modified_expression(Oe[Q-3],Ge.group(),Oe[Q-1]);break;case 14:this.$=Ge.modified_expression(Oe[Q-3],Ge.group(),Ge.group());break;case 15:case 16:this.$=Ge.modified_expression(Oe[Q-2],Ge.group());break;case 17:this.$=Ge.modified_expression(Oe[Q-1]);break;case 18:case 19:case 22:case 23:case 24:this.$=Ge.modified_expression(Ge.group());break;case 20:case 21:Ge.warnOrError("Multi-level modified expressions are not supported."),this.$=Ge.modified_expression(Ge.group());break;case 25:this.$=Ge.radical(Oe[Q-1],Oe[Q-3]);break;case 26:this.$=Ge.radical(Oe[Q-1],Ge.group());break;case 27:this.$=Ge.radical(Ge.group(),Oe[Q-2]);break;case 28:this.$=Ge.radical(Ge.group(),Ge.group());break;case 29:this.$=Ge.radical(Oe[Q-1]);break;case 30:this.$=Ge.radical(Ge.group());break;case 31:this.$=Ge.level(Oe[Q]);break;case 32:this.$=Ge.baseline();break;case 33:this.$=Ge.fraction(Oe[Q-3],Oe[Q-1]);break;case 34:this.$=Ge.fraction(Oe[Q-2],Ge.group());break;case 35:this.$=Ge.fraction(Ge.group(),Oe[Q-1]);break;case 36:this.$=Ge.fraction(Ge.group(),Ge.group());break;case 39:this.$=Ge.group(Ge.simple_subscript(Oe[Q-2],Oe[Q]),Oe[Q-1]);break;case 40:this.$=Ge.simple_subscript(Oe[Q-1],Oe[Q]);break;case 42:Ge.warnOrError("Illegal use of Nemeth primes"),this.$=Ge.group(Ge.simple_subscript(Oe[Q-2],Oe[Q-1]),Oe[Q]);break;case 67:this.$=Ge.terminal(",");break;case 68:this.$=Ge.terminal(".");break;case 69:this.$=Ge.terminal("[");break;case 70:this.$=Ge.terminal("\\{");break;case 71:this.$=Ge.terminal("(");break;case 72:this.$=Ge.terminal("]");break;case 73:this.$=Ge.terminal("\\}");break;case 74:this.$=Ge.terminal(")");break;case 75:this.$=Ge.terminal("\\langle ");break;case 76:this.$=Ge.terminal("\\rangle ");break;case 77:this.$=Ge.terminal("|");break;case 78:this.$=Ge.terminal("\\|");break;case 79:this.$=Ge.terminal(" ");break;case 80:this.$=Ge.command(Oe[Q].toLowerCase());break;case 81:this.$=Ge.terminal(Ge.greek(Oe[Q]));break;case 82:this.$=Ge.terminal(Oe[Q].toLowerCase());break;case 83:this.$=Ge.terminal(Oe[Q].toUpperCase());break;case 84:this.$=Ge.terminal("+");break;case 85:this.$=Ge.terminal("-");break;case 86:this.$=Ge.terminal("\\cdot ");break;case 87:this.$=Ge.terminal("\\times ");break;case 88:this.$=Ge.terminal("*");break;case 89:this.$=Ge.terminal("/");break;case 90:this.$=Ge.terminal("\\div ");break;case 91:this.$=Ge.terminal("\\%\\operatorname{of}");break;case 92:this.$=Ge.terminal("\\%");break;case 93:this.$=Ge.terminal("\\to ");break;case 94:this.$=Ge.comparison(Oe[Q].trim());break;case 95:this.$=Ge.level_with_comparison(Oe[Q].trim());break;case 96:this.$=Ge.terminal("\\ldots ");break;case 97:this.$=Ge.terminal(":");break;case 98:this.$=Ge.terminal(Oe[Q]);break;case 99:this.$=Ge.terminal("\\infty ");break;case 100:this.$=Ge.terminal("\\int ");break;case 101:this.$=Ge.terminal("!");break;case 102:this.$=Ge.terminal("\\&");break;case 103:this.$=Ge.primes(Oe[Q]);break;case 104:this.$=Ge.terminal("?");break}},table:[{3:1,4:2,5:[1,3],6:4,7:5,8:6,9:7,11:o,15:n,17:a,19:33,20:s,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:d,47:p,48:g,49:h,50:f,51:y,52:x,53:E,54:C,55:S,56:v,57:M,58:A,59:I,60:P,61:_,62:U,63:Y,64:R,65:H,66:O,67:q,68:w,69:T,70:B,71:de,72:F,73:j,74:pe,75:le,76:ne,77:X,78:ae,79:J,80:ge,81:be,83:Ee},{1:[3]},{5:[1,73]},{1:[2,2]},i(Le,[2,4],{6:4,7:5,8:6,9:7,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,22:32,19:33,4:74,11:o,15:n,17:a,20:s,21:l,23:c,46:d,47:p,48:g,49:h,50:f,51:y,52:x,53:E,54:C,55:S,56:v,57:M,58:A,59:I,60:P,61:_,62:U,63:Y,64:R,65:H,66:O,67:q,68:w,69:T,70:B,71:de,72:F,73:j,74:pe,75:le,76:ne,77:X,78:ae,79:J,80:ge,81:be,83:Ee}),i(Se,[2,5]),i(Se,[2,6]),i(Se,[2,8],{10:75,82:et}),i(Z,[2,45],{10:77,27:78,77:X,82:et}),i(Se,[2,46],{10:79,82:et}),i(Se,[2,47],{10:80,82:et}),{4:81,6:4,7:5,8:6,9:7,11:o,12:[1,83],13:[1,82],14:[1,84],15:n,17:a,19:33,20:s,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:d,47:p,48:g,49:h,50:f,51:y,52:x,53:E,54:C,55:S,56:v,57:M,58:A,59:I,60:P,61:_,62:U,63:Y,64:R,65:H,66:O,67:q,68:w,69:T,70:B,71:de,72:F,73:j,74:pe,75:le,76:ne,77:X,78:ae,79:J,80:ge,81:be,83:Ee},{7:87,16:85,17:[1,86],19:33,20:s,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:d,47:p,48:g,49:h,50:f,51:y,52:x,53:E,54:C,55:S,56:v,57:M,58:A,59:I,60:P,61:_,62:U,63:Y,64:R,65:H,66:O,67:q,68:w,69:T,70:B,71:de,72:F,73:j,74:pe,75:le,76:ne,77:X,78:ae,79:J,80:ge,81:be,83:Ee},{4:88,6:4,7:5,8:6,9:7,11:o,15:n,17:a,18:[1,89],19:33,20:s,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:d,47:p,48:g,49:h,50:f,51:y,52:x,53:E,54:C,55:S,56:v,57:M,58:A,59:I,60:P,61:_,62:U,63:Y,64:R,65:H,66:O,67:q,68:w,69:T,70:B,71:de,72:F,73:j,74:pe,75:le,76:ne,77:X,78:ae,79:J,80:ge,81:be,83:Ee},i(W,[2,48]),i(W,[2,49]),i(W,[2,50]),i(W,[2,98]),i(W,[2,51]),i(W,[2,52]),i(W,[2,53]),i(W,[2,54]),i(W,[2,55]),i(W,[2,56]),i(W,[2,57]),i(W,[2,58]),i(W,[2,59]),i(W,[2,60]),i(W,[2,61]),i(W,[2,62]),i(W,[2,63]),i(W,[2,64]),i(W,[2,65]),i(W,[2,66]),i(W,[2,80]),i(W,[2,81]),i(W,[2,82]),i(W,[2,83]),i(W,[2,67]),i(W,[2,68]),i(W,[2,79]),i(W,[2,84]),i(W,[2,85]),i(W,[2,86]),i(W,[2,87]),i(W,[2,88]),i(W,[2,89]),i(W,[2,90]),i(W,[2,91]),i(W,[2,92]),i(W,[2,93]),i(W,[2,94]),i(W,[2,95]),i(W,[2,96]),i(W,[2,97]),i(W,[2,99]),i(W,[2,100]),i(W,[2,101]),i(W,[2,102]),i(W,[2,104]),i(W,[2,69]),i(W,[2,70]),i(W,[2,71]),i(W,[2,72]),i(W,[2,73]),i(W,[2,74]),i(W,[2,75]),i(W,[2,76]),i(W,[2,77]),i(W,[2,78]),{4:90,6:4,7:5,8:6,9:7,11:o,15:n,17:a,19:33,20:s,21:l,22:32,23:c,24:[1,91],26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:d,47:p,48:g,49:h,50:f,51:y,52:x,53:E,54:C,55:S,56:v,57:M,58:A,59:I,60:P,61:_,62:U,63:Y,64:R,65:H,66:O,67:q,68:w,69:T,70:B,71:de,72:F,73:j,74:pe,75:le,76:ne,77:X,78:ae,79:J,80:ge,81:be,83:Ee},i(W,[2,31]),i(W,[2,32]),{1:[2,1]},i(Le,[2,3]),i(Se,[2,7]),i(Se,[2,103]),i(Z,[2,41],{27:92,77:X}),i(Se,[2,40],{10:93,82:et}),i(Se,[2,43]),i(Se,[2,44]),{12:[1,94],13:[1,95],14:[1,96]},{12:[1,97],13:[1,98],14:[1,99]},{12:[1,101],13:[1,100],14:[1,102]},i(Se,[2,24]),{17:[1,103]},{4:104,6:4,7:5,8:6,9:7,11:o,15:n,17:a,18:[1,105],19:33,20:s,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:d,47:p,48:g,49:h,50:f,51:y,52:x,53:E,54:C,55:S,56:v,57:M,58:A,59:I,60:P,61:_,62:U,63:Y,64:R,65:H,66:O,67:q,68:w,69:T,70:B,71:de,72:F,73:j,74:pe,75:le,76:ne,77:X,78:ae,79:J,80:ge,81:be,83:Ee},{7:87,16:106,17:[2,38],19:33,20:s,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:d,47:p,48:g,49:h,50:f,51:y,52:x,53:E,54:C,55:S,56:v,57:M,58:A,59:I,60:P,61:_,62:U,63:Y,64:R,65:H,66:O,67:q,68:w,69:T,70:B,71:de,72:F,73:j,74:pe,75:le,76:ne,77:X,78:ae,79:J,80:ge,81:be,83:Ee},{18:[1,107]},i(W,[2,30]),{24:[1,108]},{4:109,6:4,7:5,8:6,9:7,11:o,15:n,17:a,19:33,20:s,21:l,22:32,23:c,25:[1,110],26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:d,47:p,48:g,49:h,50:f,51:y,52:x,53:E,54:C,55:S,56:v,57:M,58:A,59:I,60:P,61:_,62:U,63:Y,64:R,65:H,66:O,67:q,68:w,69:T,70:B,71:de,72:F,73:j,74:pe,75:le,76:ne,77:X,78:ae,79:J,80:ge,81:be,83:Ee},i(Se,[2,39]),i(Se,[2,42]),{4:111,6:4,7:5,8:6,9:7,11:o,13:[1,112],14:[1,113],15:n,17:a,19:33,20:s,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:d,47:p,48:g,49:h,50:f,51:y,52:x,53:E,54:C,55:S,56:v,57:M,58:A,59:I,60:P,61:_,62:U,63:Y,64:R,65:H,66:O,67:q,68:w,69:T,70:B,71:de,72:F,73:j,74:pe,75:le,76:ne,77:X,78:ae,79:J,80:ge,81:be,83:Ee},{4:114,6:4,7:5,8:6,9:7,11:o,14:[1,115],15:n,17:a,19:33,20:s,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:d,47:p,48:g,49:h,50:f,51:y,52:x,53:E,54:C,55:S,56:v,57:M,58:A,59:I,60:P,61:_,62:U,63:Y,64:R,65:H,66:O,67:q,68:w,69:T,70:B,71:de,72:F,73:j,74:pe,75:le,76:ne,77:X,78:ae,79:J,80:ge,81:be,83:Ee},i(Se,[2,17]),{14:[1,116]},{14:[1,117]},i(Se,[2,22]),{14:[1,118]},{14:[1,119]},i(Se,[2,23]),{4:120,6:4,7:5,8:6,9:7,11:o,15:n,17:a,18:[1,121],19:33,20:s,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:d,47:p,48:g,49:h,50:f,51:y,52:x,53:E,54:C,55:S,56:v,57:M,58:A,59:I,60:P,61:_,62:U,63:Y,64:R,65:H,66:O,67:q,68:w,69:T,70:B,71:de,72:F,73:j,74:pe,75:le,76:ne,77:X,78:ae,79:J,80:ge,81:be,83:Ee},{18:[1,122]},i(W,[2,28]),{17:[2,37]},i(W,[2,29]),{4:123,6:4,7:5,8:6,9:7,11:o,15:n,17:a,19:33,20:s,21:l,22:32,23:c,25:[1,124],26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:d,47:p,48:g,49:h,50:f,51:y,52:x,53:E,54:C,55:S,56:v,57:M,58:A,59:I,60:P,61:_,62:U,63:Y,64:R,65:H,66:O,67:q,68:w,69:T,70:B,71:de,72:F,73:j,74:pe,75:le,76:ne,77:X,78:ae,79:J,80:ge,81:be,83:Ee},{25:[1,125]},i(W,[2,36]),{13:[1,126],14:[1,127]},{4:128,6:4,7:5,8:6,9:7,11:o,14:[1,129],15:n,17:a,19:33,20:s,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:d,47:p,48:g,49:h,50:f,51:y,52:x,53:E,54:C,55:S,56:v,57:M,58:A,59:I,60:P,61:_,62:U,63:Y,64:R,65:H,66:O,67:q,68:w,69:T,70:B,71:de,72:F,73:j,74:pe,75:le,76:ne,77:X,78:ae,79:J,80:ge,81:be,83:Ee},i(Se,[2,16]),{14:[1,130]},i(Se,[2,15]),i(Se,[2,18]),i(Se,[2,20]),i(Se,[2,19]),i(Se,[2,21]),{18:[1,131]},i(W,[2,27]),i(W,[2,26]),{25:[1,132]},i(W,[2,34]),i(W,[2,35]),{4:133,6:4,7:5,8:6,9:7,11:o,14:[1,134],15:n,17:a,19:33,20:s,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:d,47:p,48:g,49:h,50:f,51:y,52:x,53:E,54:C,55:S,56:v,57:M,58:A,59:I,60:P,61:_,62:U,63:Y,64:R,65:H,66:O,67:q,68:w,69:T,70:B,71:de,72:F,73:j,74:pe,75:le,76:ne,77:X,78:ae,79:J,80:ge,81:be,83:Ee},i(Se,[2,11]),{14:[1,135]},i(Se,[2,14]),i(Se,[2,13]),i(W,[2,25]),i(W,[2,33]),{14:[1,136]},i(Se,[2,10]),i(Se,[2,12]),i(Se,[2,9])],defaultActions:{3:[2,2],73:[2,1],106:[2,37]},parseError:function(Pe,He){if(He.recoverable)this.trace(Pe);else{var ot=new Error(Pe);throw ot.hash=He,ot}},parse:function(Pe){var He=this,ot=[0],Ge=[],Et=[null],Oe=[],Tr=this.table,Q="",ke=0,Ue=0,xe=0,ct=2,it=1,li=Oe.slice.call(arguments,1),Mt=Object.create(this.lexer),Bo={yy:{}};for(var Di in this.yy)Object.prototype.hasOwnProperty.call(this.yy,Di)&&(Bo.yy[Di]=this.yy[Di]);Mt.setInput(Pe,Bo.yy),Bo.yy.lexer=Mt,Bo.yy.parser=this,typeof Mt.yylloc=="undefined"&&(Mt.yylloc={});var Br=Mt.yylloc;Oe.push(Br);var ni=Mt.options&&Mt.options.ranges;typeof Bo.yy.parseError=="function"?this.parseError=Bo.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function Uo(Dr){ot.length=ot.length-2*Dr,Et.length=Et.length-Dr,Oe.length=Oe.length-Dr}for(var al=function(){var Dr;return Dr=Mt.lex()||it,typeof Dr!="number"&&(Dr=He.symbols_[Dr]||Dr),Dr},Xt,he,Qe,We,nt,St,vt={},Lt,Rt,or,zt;;){if(Qe=ot[ot.length-1],this.defaultActions[Qe]?We=this.defaultActions[Qe]:((Xt===null||typeof Xt=="undefined")&&(Xt=al()),We=Tr[Qe]&&Tr[Qe][Xt]),typeof We=="undefined"||!We.length||!We[0]){var Sr="";zt=[];for(Lt in Tr[Qe])this.terminals_[Lt]&&Lt>ct&&zt.push("'"+this.terminals_[Lt]+"'");Mt.showPosition?Sr="Parse error on line "+(ke+1)+`:
`+Mt.showPosition()+`
Expecting `+zt.join(", ")+", got '"+(this.terminals_[Xt]||Xt)+"'":Sr="Parse error on line "+(ke+1)+": Unexpected "+(Xt==it?"end of input":"'"+(this.terminals_[Xt]||Xt)+"'"),this.parseError(Sr,{text:Mt.match,token:this.terminals_[Xt]||Xt,line:Mt.yylineno,loc:Br,expected:zt})}if(We[0]instanceof Array&&We.length>1)throw new Error("Parse Error: multiple actions possible at state: "+Qe+", token: "+Xt);switch(We[0]){case 1:ot.push(Xt),Et.push(Mt.yytext),Oe.push(Mt.yylloc),ot.push(We[1]),Xt=null,he?(Xt=he,he=null):(Ue=Mt.yyleng,Q=Mt.yytext,ke=Mt.yylineno,Br=Mt.yylloc,xe>0&&xe--);break;case 2:if(Rt=this.productions_[We[1]][1],vt.$=Et[Et.length-Rt],vt._$={first_line:Oe[Oe.length-(Rt||1)].first_line,last_line:Oe[Oe.length-1].last_line,first_column:Oe[Oe.length-(Rt||1)].first_column,last_column:Oe[Oe.length-1].last_column},ni&&(vt._$.range=[Oe[Oe.length-(Rt||1)].range[0],Oe[Oe.length-1].range[1]]),St=this.performAction.apply(vt,[Q,Ue,ke,Bo.yy,We[1],Et,Oe].concat(li)),typeof St!="undefined")return St;Rt&&(ot=ot.slice(0,-1*Rt*2),Et=Et.slice(0,-1*Rt),Oe=Oe.slice(0,-1*Rt)),ot.push(this.productions_[We[1]][0]),Et.push(vt.$),Oe.push(vt._$),or=Tr[ot[ot.length-2]][ot[ot.length-1]],ot.push(or);break;case 3:return!0}}return!0}},Ne=function(){var ve={EOF:1,parseError:function(He,ot){if(this.yy.parser)this.yy.parser.parseError(He,ot);else throw new Error(He)},setInput:function(Pe,He){return this.yy=He||this.yy||{},this._input=Pe,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var Pe=this._input[0];this.yytext+=Pe,this.yyleng++,this.offset++,this.match+=Pe,this.matched+=Pe;var He=Pe.match(/(?:\r\n?|\n).*/g);return He?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),Pe},unput:function(Pe){var He=Pe.length,ot=Pe.split(/(?:\r\n?|\n)/g);this._input=Pe+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-He),this.offset-=He;var Ge=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),ot.length-1&&(this.yylineno-=ot.length-1);var Et=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:ot?(ot.length===Ge.length?this.yylloc.first_column:0)+Ge[Ge.length-ot.length].length-ot[0].length:this.yylloc.first_column-He},this.options.ranges&&(this.yylloc.range=[Et[0],Et[0]+this.yyleng-He]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(Pe){this.unput(this.match.slice(Pe))},pastInput:function(){var Pe=this.matched.substr(0,this.matched.length-this.match.length);return(Pe.length>20?"...":"")+Pe.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var Pe=this.match;return Pe.length<20&&(Pe+=this._input.substr(0,20-Pe.length)),(Pe.substr(0,20)+(Pe.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var Pe=this.pastInput(),He=new Array(Pe.length+1).join("-");return Pe+this.upcomingInput()+`
`+He+"^"},test_match:function(Pe,He){var ot,Ge,Et;if(this.options.backtrack_lexer&&(Et={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(Et.yylloc.range=this.yylloc.range.slice(0))),Ge=Pe[0].match(/(?:\r\n?|\n).*/g),Ge&&(this.yylineno+=Ge.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:Ge?Ge[Ge.length-1].length-Ge[Ge.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+Pe[0].length},this.yytext+=Pe[0],this.match+=Pe[0],this.matches=Pe,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(Pe[0].length),this.matched+=Pe[0],ot=this.performAction.call(this,this.yy,this,He,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),ot)return ot;if(this._backtrack){for(var Oe in Et)this[Oe]=Et[Oe];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var Pe,He,ot,Ge;this._more||(this.yytext="",this.match="");for(var Et=this._currentRules(),Oe=0;Oe<Et.length;Oe++)if(ot=this._input.match(this.rules[Et[Oe]]),ot&&(!He||ot[0].length>He[0].length)){if(He=ot,Ge=Oe,this.options.backtrack_lexer){if(Pe=this.test_match(ot,Et[Oe]),Pe!==!1)return Pe;if(this._backtrack){He=!1;continue}else return!1}else if(!this.options.flex)break}return He?(Pe=this.test_match(He,Et[Ge]),Pe!==!1?Pe:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var He=this.next();return He||this.lex()},begin:function(He){this.conditionStack.push(He)},popState:function(){var He=this.conditionStack.length-1;return He>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(He){return He=this.conditionStack.length-1-Math.abs(He||0),He>=0?this.conditionStack[He]:"INITIAL"},pushState:function(He){this.begin(He)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(He,ot,Ge,Et){var Oe=Et;switch(Ge){case 0:return this.begin("modexp"),11;break;case 1:return 21;case 2:return this.begin("modexp"),11;break;case 3:return 12;case 4:return 13;case 5:return this.popState(),14;break;case 6:return 63;case 7:return 64;case 8:return 65;case 9:return 66;case 10:return 67;case 11:return 68;case 12:return 69;case 13:return 54;case 14:return 48;case 15:return 49;case 16:return 50;case 17:return 55;case 18:return 51;case 19:return 52;case 20:return 53;case 21:return 57;case 22:return 56;case 23:return 76;case 24:return 70;case 25:return 71;case 26:return 72;case 27:return 74;case 28:return 74;case 29:return 74;case 30:return 74;case 31:return 74;case 32:return 74;case 33:return 74;case 34:return 74;case 35:return 74;case 36:return 73;case 37:return 74;case 38:return 74;case 39:return 73;case 40:return 73;case 41:return 73;case 42:return 73;case 43:return 73;case 44:return 73;case 45:return 73;case 46:return 73;case 47:return 73;case 48:return 73;case 49:return 75;case 50:return 20;case 51:return 47;case 52:return 21;case 53:return 82;case 54:return 60;case 55:return 15;case 56:return this.begin("radical"),17;break;case 57:return this.popState(),18;break;case 58:return 18;case 59:return 79;case 60:return 81;case 61:return 80;case 62:return 59;case 63:return 59;case 64:return ot.yytext=this.matches[1],77;break;case 65:return 23;case 66:return 24;case 67:return 25;case 68:return ot.yytext=this.matches[1],62;break;case 69:return 61;case 70:return 78;case 71:return 83;case 72:return 46;case 73:return 47;case 74:return 58;case 75:return 5;case 76:return 85}},rules:[/^(?:"(?=[^>\]]+%))/,/^(?:")/,/^(?:"(?=[^>\]]+\]|[^>\]]+%))/,/^(?:%)/,/^(?:<)/,/^(?:\])/,/^(?:[+])/,/^(?:[-])/,/^(?:[*])/,/^(?:[@][*])/,/^(?:[@][\#])/,/^(?:[_][/])/,/^(?:[.][/])/,/^(?:[.][.][(])/,/^(?:[@][(])/,/^(?:[.][(])/,/^(?:[(])/,/^(?:[.][.][)])/,/^(?:[@][)])/,/^(?:[.][)])/,/^(?:[)])/,/^(?:[\\][\\])/,/^(?:[\\])/,/^(?:[_][3])/,/^(?:[@][0][O][F][ ]?)/,/^(?:[@][0])/,/^(?:[ ][$]O[ ])/,/^(?:[ ][\^;]+[.]K[ ])/,/^(?:[\^;]+[=])/,/^(?:[ ][\^;]+[/][.]K[ ])/,/^(?:[ ][\^;]+[@][:][@][:][ ])/,/^(?:[ ][\^;]+["]K[:][ ])/,/^(?:[ ][\^;]+[.]1[:][ ])/,/^(?:[ ][\^;]+["]K[ ])/,/^(?:[ ][\^;]+[.]1[ ])/,/^(?:[ ][\^;]+[/][$][L][ ])/,/^(?:[ ][.]K[ ])/,/^(?:[ ][\^;]+[/]?[$][L][ ])/,/^(?:[ ][\^;]+[$]P[ ])/,/^(?:[=])/,/^(?:[ ][/][.]K[ ])/,/^(?:[ ][@][:][@][:][ ])/,/^(?:[ ]["]K[:][ ])/,/^(?:[ ][.]1[:][ ])/,/^(?:[ ]["]K[ ])/,/^(?:[ ][.]1[ ])/,/^(?:[@][:])/,/^(?:[ ][/]?[$][L][ ])/,/^(?:[ ][$]P[ ])/,/^(?:[ ]['][']['][ ])/,/^(?:[\^;]+)/,/^(?:[.]["])/,/^(?:["])/,/^(?:[']+)/,/^(?:[.][,]?[ABGDEZ\?\:IKLMNXOPRSTUYF\&W])/,/^(?:[.]*[<])/,/^(?:[.]*[>])/,/^(?:[.]*\])/,/^(?:[.]*\])/,/^(?:!)/,/^(?:[_]&)/,/^(?:&)/,/^(?:(ARC)?(SIN|COS|TAN|CSC|SEC|COT)(H)?)/,/^(?:(ARG|DET|EXP|IM|INF|LIM|LN|LOG|MAX|MIN|MOD|RE|SUP))/,/^(?:#?(\d*\.?\d+))/,/^(?:[,]*[?])/,/^(?:[,]*[/])/,/^(?:[,]*#)/,/^(?:[,]([A-Z]))/,/^(?:[A-Z])/,/^(?:[,][=])/,/^(?:[_][8])/,/^(?:[,][ ]?)/,/^(?:[.])/,/^(?:[ ])/,/^(?:$)/,/^(?:.)/],conditions:{radical:{rules:[0,1,2,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76],inclusive:!0},modexp:{rules:[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76],inclusive:!0},INITIAL:{rules:[2,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76],inclusive:!0}}};return ve}();De.lexer=Ne;function me(){this.yy={}}return me.prototype=De,De.Parser=me,new me}();typeof Ux!="undefined"&&typeof r!="undefined"&&(r.parser=t,r.Parser=t.Parser,r.parse=function(){return t.parse.apply(t,arguments)},r.main=function(){},typeof e!="undefined"&&Ux.main===e&&r.main(process.argv.slice(1)))}}),WW=A2({"generated/ueb-to-latex.jison.js"(r,e){"use strict";var t=function(){var i=function(Tr,Q,ke,Ue){for(ke=ke||{},Ue=Tr.length;Ue--;ke[Tr[Ue]]=Q);return ke},o=[1,15],n=[1,16],a=[1,17],s=[1,36],l=[1,18],c=[1,37],d=[1,38],p=[1,14],g=[1,46],h=[1,47],f=[1,39],y=[1,40],x=[1,41],E=[1,56],C=[1,42],S=[1,43],v=[1,44],M=[1,45],A=[1,54],I=[1,55],P=[1,57],_=[1,58],U=[1,59],Y=[1,60],R=[1,61],H=[1,62],O=[1,63],q=[1,64],w=[1,65],T=[1,66],B=[1,67],de=[1,68],F=[1,69],j=[1,70],pe=[1,71],le=[1,72],ne=[1,73],X=[1,74],ae=[1,75],J=[1,76],ge=[1,77],be=[1,48],Ee=[1,49],Le=[1,50],Se=[1,51],et=[1,52],Z=[1,78],W=[1,53],De=[5,14,18,19,29,52,53,54],Ne=[5,10,13,14,15,18,19,29,52,53,54],me=[5,10,13,14,15,17,18,19,21,23,24,28,29,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89],ve=[1,86],Pe=[1,87],He=[1,88],ot=[10,13,15,17,21,23,24,28,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89],Ge={trace:function(){},yy:{},symbols_:{error:2,sentence:3,group:4,EOF:5,expression_group:6,delimited_expression:7,level:8,radical:9,LEVEL:10,basic_token:11,bracketed_expression:12,RADICAL_WITH_INDEX:13,CLOSE_RADICAL:14,RADICAL:15,frac:16,OPEN_FRAC:17,OVER:18,CLOSE_FRAC:19,simple_frac:20,NUMBER:21,NUMBER_FRAC_DENOMINATOR:22,NUMBER_FRAC_NUMERATOR_BAD:23,NUMBER_FRAC_DENOMINATOR_BAD:24,atom:25,lbracket:26,rbracket:27,OPEN_GROUP:28,CLOSE_GROUP:29,command:30,greek:31,letter:32,comma:33,period:34,colon:35,infinity:36,integral:37,factorial:38,ampersand:39,question_mark:40,bracket:41,space:42,operation:43,comparison:44,ellipsis:45,primes:46,",":47,".":48,"[":49,"{":50,"(":51,"]":52,"}":53,")":54,SPACE:55,COMMAND:56,GREEK:57,CAPITAL_LETTER:58,LETTER:59,PIPE:60,DOUBLE_PIPE:61,"+":62,"-":63,CDOT:64,TIMES:65,"*":66,DIV:67,SLASH:68,PERCENT_OF:69,PERCENT:70,TO:71,"=":72,NEQ:73,"<":74,">":75,LEQ:76,APPROX:77,GEQ:78,TILDE:79,PARALLEL:80,PERPENDICULAR:81,ELLIPSIS:82,COLON:83,INFINITY:84,INTEGRAL:85,FACTORIAL:86,"&":87,PRIMES:88,"?":89,unknown:90,UNKNOWN:91,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",10:"LEVEL",13:"RADICAL_WITH_INDEX",14:"CLOSE_RADICAL",15:"RADICAL",17:"OPEN_FRAC",18:"OVER",19:"CLOSE_FRAC",21:"NUMBER",22:"NUMBER_FRAC_DENOMINATOR",23:"NUMBER_FRAC_NUMERATOR_BAD",24:"NUMBER_FRAC_DENOMINATOR_BAD",28:"OPEN_GROUP",29:"CLOSE_GROUP",47:",",48:".",49:"[",50:"{",51:"(",52:"]",53:"}",54:")",55:"SPACE",56:"COMMAND",57:"GREEK",58:"CAPITAL_LETTER",59:"LETTER",60:"PIPE",61:"DOUBLE_PIPE",62:"+",63:"-",64:"CDOT",65:"TIMES",66:"*",67:"DIV",68:"SLASH",69:"PERCENT_OF",70:"PERCENT",71:"TO",72:"=",73:"NEQ",74:"<",75:">",76:"LEQ",77:"APPROX",78:"GEQ",79:"TILDE",80:"PARALLEL",81:"PERPENDICULAR",82:"ELLIPSIS",83:"COLON",84:"INFINITY",85:"INTEGRAL",86:"FACTORIAL",87:"&",88:"PRIMES",89:"?",91:"UNKNOWN"},productions_:[0,[3,2],[3,1],[4,3],[4,2],[4,1],[4,2],[4,1],[7,1],[7,1],[8,2],[8,2],[8,2],[9,4],[9,3],[9,3],[9,2],[9,4],[9,3],[9,2],[16,5],[16,4],[16,4],[16,3],[16,2],[20,2],[20,1],[20,1],[11,1],[11,1],[11,1],[6,2],[6,2],[6,1],[6,1],[12,3],[12,2],[12,3],[12,2],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[33,1],[34,1],[26,1],[26,1],[26,1],[27,1],[27,1],[27,1],[42,1],[30,1],[31,1],[32,1],[32,1],[41,1],[41,1],[43,1],[43,1],[43,1],[43,1],[43,1],[43,1],[43,1],[43,1],[43,1],[43,1],[44,1],[44,1],[44,1],[44,1],[44,1],[44,1],[44,1],[44,1],[44,1],[44,1],[45,1],[35,1],[36,1],[37,1],[38,1],[39,1],[46,1],[40,1],[90,1]],performAction:function(Q,ke,Ue,xe,ct,it,li){var Mt=it.length-1;switch(ct){case 1:return it[Mt-1];case 2:return xe.group();case 3:case 35:this.$=xe.group(it[Mt-2],it[Mt-1],it[Mt]);break;case 4:case 6:case 31:case 32:case 36:this.$=xe.group(it[Mt-1],it[Mt]);break;case 5:case 7:case 33:case 34:this.$=xe.group(it[Mt]);break;case 10:case 11:case 12:this.$=xe.basic_level(it[Mt-1],xe.group(it[Mt]));break;case 13:case 17:this.$=xe.radical(it[Mt-1],xe.group(it[Mt-2]));break;case 14:case 15:this.$=xe.radical(xe.group(),xe.group(it[Mt-1]));break;case 16:this.$=xe.radical(xe.group(),xe.group());break;case 18:this.$=xe.radical(it[Mt-1]);break;case 19:this.$=xe.radical(xe.group());break;case 20:this.$=xe.fraction(it[Mt-3],it[Mt-1]);break;case 21:this.$=xe.fraction(it[Mt-2],xe.group());break;case 22:this.$=xe.fraction(xe.group(),it[Mt-1]);break;case 23:case 24:this.$=xe.fraction(xe.group(),xe.group());break;case 25:this.$=xe.fraction(xe.group(xe.terminal(xe.to_number(it[Mt-1]))),xe.group(xe.terminal(xe.to_number(it[Mt]))));break;case 26:this.$=xe.fraction(xe.group(xe.terminal(xe.to_number(it[Mt]))),xe.group());break;case 27:this.$=xe.fraction(xe.group(),xe.group(xe.terminal(xe.to_number(it[$01]))));break;case 37:this.$=xe.group(it[Mt-1]);break;case 38:this.$=xe.group();break;case 39:this.$=xe.terminal(xe.to_number(it[Mt]));break;case 57:this.$=xe.terminal(",");break;case 58:this.$=xe.terminal(".");break;case 59:this.$=xe.terminal("[");break;case 60:this.$=xe.terminal("\\{");break;case 61:this.$=xe.terminal("(");break;case 62:this.$=xe.terminal("]");break;case 63:this.$=xe.terminal("\\}");break;case 64:this.$=xe.terminal(")");break;case 65:this.$=xe.terminal(" ");break;case 66:this.$=xe.command("\\"+it[Mt].trim().toLowerCase());break;case 67:this.$=xe.terminal(xe.greek(it[Mt]));break;case 68:this.$=xe.terminal(it[Mt].toUpperCase());break;case 69:this.$=xe.terminal(it[Mt].toLowerCase());break;case 70:this.$=xe.terminal("|");break;case 71:this.$=xe.terminal("\\|");break;case 72:this.$=xe.terminal("+");break;case 73:this.$=xe.terminal("-");break;case 74:this.$=xe.terminal("\\cdot ");break;case 75:this.$=xe.terminal("\\times ");break;case 76:this.$=xe.terminal("*");break;case 77:this.$=xe.terminal("\\div ");break;case 78:this.$=xe.terminal("/");break;case 79:this.$=xe.terminal("\\%\\operatorname{of}");break;case 80:this.$=xe.terminal("\\%");break;case 81:this.$=xe.terminal("\\to ");break;case 82:this.$=xe.terminal("=");break;case 83:this.$=xe.terminal("\\neq ");break;case 84:this.$=xe.terminal("<");break;case 85:this.$=xe.terminal(">");break;case 86:this.$=xe.terminal("\\leq ");break;case 87:this.$=xe.terminal("\\approx ");break;case 88:this.$=xe.terminal("\\geq ");break;case 89:this.$=xe.terminal("\\sim ");break;case 90:this.$=xe.terminal("\\parallel ");break;case 91:this.$=xe.terminal("\\perp ");break;case 92:this.$=xe.terminal("\\ldots ");break;case 93:this.$=xe.terminal(":");break;case 94:this.$=xe.terminal("\\infty ");break;case 95:this.$=xe.terminal("\\int ");break;case 96:this.$=xe.terminal("!");break;case 97:this.$=xe.terminal("\\&");break;case 98:this.$=xe.primes(it[Mt]);break;case 99:this.$=xe.terminal("?");break}},table:[{3:1,4:2,5:[1,3],6:4,7:5,8:8,9:9,10:o,11:6,12:7,13:n,15:a,16:11,17:s,20:12,21:l,23:c,24:d,25:10,26:13,28:p,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:g,48:h,49:f,50:y,51:x,55:E,56:C,57:S,58:v,59:M,60:A,61:I,62:P,63:_,64:U,65:Y,66:R,67:H,68:O,69:q,70:w,71:T,72:B,73:de,74:F,75:j,76:pe,77:le,78:ne,79:X,80:ae,81:J,82:ge,83:be,84:Ee,85:Le,86:Se,87:et,88:Z,89:W},{1:[3]},{5:[1,79]},{1:[2,2]},i(De,[2,5],{8:8,9:9,7:80,10:o,13:n,15:a}),i(De,[2,7],{6:4,7:5,11:6,12:7,8:8,9:9,25:10,16:11,20:12,26:13,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,4:81,10:o,13:n,15:a,17:s,21:l,23:c,24:d,28:p,47:g,48:h,49:f,50:y,51:x,55:E,56:C,57:S,58:v,59:M,60:A,61:I,62:P,63:_,64:U,65:Y,66:R,67:H,68:O,69:q,70:w,71:T,72:B,73:de,74:F,75:j,76:pe,77:le,78:ne,79:X,80:ae,81:J,82:ge,83:be,84:Ee,85:Le,86:Se,87:et,88:Z,89:W}),i(Ne,[2,33],{11:6,12:7,25:10,16:11,20:12,26:13,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,6:82,17:s,21:l,23:c,24:d,28:p,47:g,48:h,49:f,50:y,51:x,55:E,56:C,57:S,58:v,59:M,60:A,61:I,62:P,63:_,64:U,65:Y,66:R,67:H,68:O,69:q,70:w,71:T,72:B,73:de,74:F,75:j,76:pe,77:le,78:ne,79:X,80:ae,81:J,82:ge,83:be,84:Ee,85:Le,86:Se,87:et,88:Z,89:W}),i(Ne,[2,34],{11:6,12:7,25:10,16:11,20:12,26:13,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,6:83,17:s,21:l,23:c,24:d,28:p,47:g,48:h,49:f,50:y,51:x,55:E,56:C,57:S,58:v,59:M,60:A,61:I,62:P,63:_,64:U,65:Y,66:R,67:H,68:O,69:q,70:w,71:T,72:B,73:de,74:F,75:j,76:pe,77:le,78:ne,79:X,80:ae,81:J,82:ge,83:be,84:Ee,85:Le,86:Se,87:et,88:Z,89:W}),i(me,[2,8]),i(me,[2,9]),i(me,[2,28]),i(me,[2,29]),i(me,[2,30]),{4:84,6:4,7:5,8:8,9:9,10:o,11:6,12:7,13:n,15:a,16:11,17:s,20:12,21:l,23:c,24:d,25:10,26:13,27:85,28:p,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:g,48:h,49:f,50:y,51:x,52:ve,53:Pe,54:He,55:E,56:C,57:S,58:v,59:M,60:A,61:I,62:P,63:_,64:U,65:Y,66:R,67:H,68:O,69:q,70:w,71:T,72:B,73:de,74:F,75:j,76:pe,77:le,78:ne,79:X,80:ae,81:J,82:ge,83:be,84:Ee,85:Le,86:Se,87:et,88:Z,89:W},{4:89,6:4,7:5,8:8,9:9,10:o,11:6,12:7,13:n,15:a,16:11,17:s,20:12,21:l,23:c,24:d,25:10,26:13,28:p,29:[1,90],30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:g,48:h,49:f,50:y,51:x,55:E,56:C,57:S,58:v,59:M,60:A,61:I,62:P,63:_,64:U,65:Y,66:R,67:H,68:O,69:q,70:w,71:T,72:B,73:de,74:F,75:j,76:pe,77:le,78:ne,79:X,80:ae,81:J,82:ge,83:be,84:Ee,85:Le,86:Se,87:et,88:Z,89:W},{9:93,11:91,12:92,13:n,15:a,16:11,17:s,20:12,21:l,23:c,24:d,25:10,26:13,28:p,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:g,48:h,49:f,50:y,51:x,55:E,56:C,57:S,58:v,59:M,60:A,61:I,62:P,63:_,64:U,65:Y,66:R,67:H,68:O,69:q,70:w,71:T,72:B,73:de,74:F,75:j,76:pe,77:le,78:ne,79:X,80:ae,81:J,82:ge,83:be,84:Ee,85:Le,86:Se,87:et,88:Z,89:W},{11:94,12:95,14:[1,96],16:11,17:s,20:12,21:l,23:c,24:d,25:10,26:13,28:p,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:g,48:h,49:f,50:y,51:x,55:E,56:C,57:S,58:v,59:M,60:A,61:I,62:P,63:_,64:U,65:Y,66:R,67:H,68:O,69:q,70:w,71:T,72:B,73:de,74:F,75:j,76:pe,77:le,78:ne,79:X,80:ae,81:J,82:ge,83:be,84:Ee,85:Le,86:Se,87:et,88:Z,89:W},{4:97,6:4,7:5,8:8,9:9,10:o,11:6,12:7,13:n,14:[1,98],15:a,16:11,17:s,20:12,21:l,23:c,24:d,25:10,26:13,28:p,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:g,48:h,49:f,50:y,51:x,55:E,56:C,57:S,58:v,59:M,60:A,61:I,62:P,63:_,64:U,65:Y,66:R,67:H,68:O,69:q,70:w,71:T,72:B,73:de,74:F,75:j,76:pe,77:le,78:ne,79:X,80:ae,81:J,82:ge,83:be,84:Ee,85:Le,86:Se,87:et,88:Z,89:W},i(me,[2,39],{22:[1,99]}),i(me,[2,40]),i(me,[2,41]),i(me,[2,42]),i(me,[2,43]),i(me,[2,44]),i(me,[2,45]),i(me,[2,46]),i(me,[2,47]),i(me,[2,48]),i(me,[2,49]),i(me,[2,50]),i(me,[2,51]),i(me,[2,52]),i(me,[2,53]),i(me,[2,54]),i(me,[2,55]),i(me,[2,56]),{4:100,6:4,7:5,8:8,9:9,10:o,11:6,12:7,13:n,15:a,16:11,17:s,18:[1,101],19:[1,102],20:12,21:l,23:c,24:d,25:10,26:13,28:p,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:g,48:h,49:f,50:y,51:x,55:E,56:C,57:S,58:v,59:M,60:A,61:I,62:P,63:_,64:U,65:Y,66:R,67:H,68:O,69:q,70:w,71:T,72:B,73:de,74:F,75:j,76:pe,77:le,78:ne,79:X,80:ae,81:J,82:ge,83:be,84:Ee,85:Le,86:Se,87:et,88:Z,89:W},i(me,[2,26]),i(me,[2,27]),i(ot,[2,59]),i(ot,[2,60]),i(ot,[2,61]),i(me,[2,66]),i(me,[2,67]),i(me,[2,68]),i(me,[2,69]),i(me,[2,57]),i(me,[2,58]),i(me,[2,93]),i(me,[2,94]),i(me,[2,95]),i(me,[2,96]),i(me,[2,97]),i(me,[2,99]),i(me,[2,70]),i(me,[2,71]),i(me,[2,65]),i(me,[2,72]),i(me,[2,73]),i(me,[2,74]),i(me,[2,75]),i(me,[2,76]),i(me,[2,77]),i(me,[2,78]),i(me,[2,79]),i(me,[2,80]),i(me,[2,81]),i(me,[2,82]),i(me,[2,83]),i(me,[2,84]),i(me,[2,85]),i(me,[2,86]),i(me,[2,87]),i(me,[2,88]),i(me,[2,89]),i(me,[2,90]),i(me,[2,91]),i(me,[2,92]),i(me,[2,98]),{1:[2,1]},i(De,[2,4],{6:4,7:5,11:6,12:7,8:8,9:9,25:10,16:11,20:12,26:13,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,4:103,10:o,13:n,15:a,17:s,21:l,23:c,24:d,28:p,47:g,48:h,49:f,50:y,51:x,55:E,56:C,57:S,58:v,59:M,60:A,61:I,62:P,63:_,64:U,65:Y,66:R,67:H,68:O,69:q,70:w,71:T,72:B,73:de,74:F,75:j,76:pe,77:le,78:ne,79:X,80:ae,81:J,82:ge,83:be,84:Ee,85:Le,86:Se,87:et,88:Z,89:W}),i(De,[2,6]),i(Ne,[2,31]),i(Ne,[2,32]),{27:104,52:ve,53:Pe,54:He},i(me,[2,36]),i(me,[2,62]),i(me,[2,63]),i(me,[2,64]),{29:[1,105]},i(me,[2,38]),i(me,[2,10]),i(me,[2,11]),i(me,[2,12]),{4:106,6:4,7:5,8:8,9:9,10:o,11:6,12:7,13:n,14:[1,107],15:a,16:11,17:s,20:12,21:l,23:c,24:d,25:10,26:13,28:p,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:g,48:h,49:f,50:y,51:x,55:E,56:C,57:S,58:v,59:M,60:A,61:I,62:P,63:_,64:U,65:Y,66:R,67:H,68:O,69:q,70:w,71:T,72:B,73:de,74:F,75:j,76:pe,77:le,78:ne,79:X,80:ae,81:J,82:ge,83:be,84:Ee,85:Le,86:Se,87:et,88:Z,89:W},{4:109,6:4,7:5,8:8,9:9,10:o,11:6,12:7,13:n,14:[1,108],15:a,16:11,17:s,20:12,21:l,23:c,24:d,25:10,26:13,28:p,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:g,48:h,49:f,50:y,51:x,55:E,56:C,57:S,58:v,59:M,60:A,61:I,62:P,63:_,64:U,65:Y,66:R,67:H,68:O,69:q,70:w,71:T,72:B,73:de,74:F,75:j,76:pe,77:le,78:ne,79:X,80:ae,81:J,82:ge,83:be,84:Ee,85:Le,86:Se,87:et,88:Z,89:W},i(me,[2,16]),{14:[1,110]},i(me,[2,19]),i(me,[2,25]),{18:[1,111]},{4:112,6:4,7:5,8:8,9:9,10:o,11:6,12:7,13:n,15:a,16:11,17:s,19:[1,113],20:12,21:l,23:c,24:d,25:10,26:13,28:p,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:g,48:h,49:f,50:y,51:x,55:E,56:C,57:S,58:v,59:M,60:A,61:I,62:P,63:_,64:U,65:Y,66:R,67:H,68:O,69:q,70:w,71:T,72:B,73:de,74:F,75:j,76:pe,77:le,78:ne,79:X,80:ae,81:J,82:ge,83:be,84:Ee,85:Le,86:Se,87:et,88:Z,89:W},i(me,[2,24]),i(De,[2,3]),i(me,[2,35]),i(me,[2,37]),{14:[1,114]},i(me,[2,15]),i(me,[2,14]),{14:[1,115]},i(me,[2,18]),{4:116,6:4,7:5,8:8,9:9,10:o,11:6,12:7,13:n,15:a,16:11,17:s,19:[1,117],20:12,21:l,23:c,24:d,25:10,26:13,28:p,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:g,48:h,49:f,50:y,51:x,55:E,56:C,57:S,58:v,59:M,60:A,61:I,62:P,63:_,64:U,65:Y,66:R,67:H,68:O,69:q,70:w,71:T,72:B,73:de,74:F,75:j,76:pe,77:le,78:ne,79:X,80:ae,81:J,82:ge,83:be,84:Ee,85:Le,86:Se,87:et,88:Z,89:W},{19:[1,118]},i(me,[2,23]),i(me,[2,13]),i(me,[2,17]),{19:[1,119]},i(me,[2,21]),i(me,[2,22]),i(me,[2,20])],defaultActions:{3:[2,2],79:[2,1]},parseError:function(Q,ke){if(ke.recoverable)this.trace(Q);else{var Ue=new Error(Q);throw Ue.hash=ke,Ue}},parse:function(Q){var ke=this,Ue=[0],xe=[],ct=[null],it=[],li=this.table,Mt="",Bo=0,Di=0,Br=0,ni=2,Uo=1,al=it.slice.call(arguments,1),Xt=Object.create(this.lexer),he={yy:{}};for(var Qe in this.yy)Object.prototype.hasOwnProperty.call(this.yy,Qe)&&(he.yy[Qe]=this.yy[Qe]);Xt.setInput(Q,he.yy),he.yy.lexer=Xt,he.yy.parser=this,typeof Xt.yylloc=="undefined"&&(Xt.yylloc={});var We=Xt.yylloc;it.push(We);var nt=Xt.options&&Xt.options.ranges;typeof he.yy.parseError=="function"?this.parseError=he.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function St(wo){Ue.length=Ue.length-2*wo,ct.length=ct.length-wo,it.length=it.length-wo}for(var vt=function(){var wo;return wo=Xt.lex()||Uo,typeof wo!="number"&&(wo=ke.symbols_[wo]||wo),wo},Lt,Rt,or,zt,Sr,Dr,ki={},Hn,Mn,qi,io;;){if(or=Ue[Ue.length-1],this.defaultActions[or]?zt=this.defaultActions[or]:((Lt===null||typeof Lt=="undefined")&&(Lt=vt()),zt=li[or]&&li[or][Lt]),typeof zt=="undefined"||!zt.length||!zt[0]){var pn="";io=[];for(Hn in li[or])this.terminals_[Hn]&&Hn>ni&&io.push("'"+this.terminals_[Hn]+"'");Xt.showPosition?pn="Parse error on line "+(Bo+1)+`:
`+Xt.showPosition()+`
Expecting `+io.join(", ")+", got '"+(this.terminals_[Lt]||Lt)+"'":pn="Parse error on line "+(Bo+1)+": Unexpected "+(Lt==Uo?"end of input":"'"+(this.terminals_[Lt]||Lt)+"'"),this.parseError(pn,{text:Xt.match,token:this.terminals_[Lt]||Lt,line:Xt.yylineno,loc:We,expected:io})}if(zt[0]instanceof Array&&zt.length>1)throw new Error("Parse Error: multiple actions possible at state: "+or+", token: "+Lt);switch(zt[0]){case 1:Ue.push(Lt),ct.push(Xt.yytext),it.push(Xt.yylloc),Ue.push(zt[1]),Lt=null,Rt?(Lt=Rt,Rt=null):(Di=Xt.yyleng,Mt=Xt.yytext,Bo=Xt.yylineno,We=Xt.yylloc,Br>0&&Br--);break;case 2:if(Mn=this.productions_[zt[1]][1],ki.$=ct[ct.length-Mn],ki._$={first_line:it[it.length-(Mn||1)].first_line,last_line:it[it.length-1].last_line,first_column:it[it.length-(Mn||1)].first_column,last_column:it[it.length-1].last_column},nt&&(ki._$.range=[it[it.length-(Mn||1)].range[0],it[it.length-1].range[1]]),Dr=this.performAction.apply(ki,[Mt,Di,Bo,he.yy,zt[1],ct,it].concat(al)),typeof Dr!="undefined")return Dr;Mn&&(Ue=Ue.slice(0,-1*Mn*2),ct=ct.slice(0,-1*Mn),it=it.slice(0,-1*Mn)),Ue.push(this.productions_[zt[1]][0]),ct.push(ki.$),it.push(ki._$),qi=li[Ue[Ue.length-2]][Ue[Ue.length-1]],Ue.push(qi);break;case 3:return!0}}return!0}},Et=function(){var Tr={EOF:1,parseError:function(ke,Ue){if(this.yy.parser)this.yy.parser.parseError(ke,Ue);else throw new Error(ke)},setInput:function(Q,ke){return this.yy=ke||this.yy||{},this._input=Q,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var Q=this._input[0];this.yytext+=Q,this.yyleng++,this.offset++,this.match+=Q,this.matched+=Q;var ke=Q.match(/(?:\r\n?|\n).*/g);return ke?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),Q},unput:function(Q){var ke=Q.length,Ue=Q.split(/(?:\r\n?|\n)/g);this._input=Q+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-ke),this.offset-=ke;var xe=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),Ue.length-1&&(this.yylineno-=Ue.length-1);var ct=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:Ue?(Ue.length===xe.length?this.yylloc.first_column:0)+xe[xe.length-Ue.length].length-Ue[0].length:this.yylloc.first_column-ke},this.options.ranges&&(this.yylloc.range=[ct[0],ct[0]+this.yyleng-ke]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(Q){this.unput(this.match.slice(Q))},pastInput:function(){var Q=this.matched.substr(0,this.matched.length-this.match.length);return(Q.length>20?"...":"")+Q.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var Q=this.match;return Q.length<20&&(Q+=this._input.substr(0,20-Q.length)),(Q.substr(0,20)+(Q.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var Q=this.pastInput(),ke=new Array(Q.length+1).join("-");return Q+this.upcomingInput()+`
`+ke+"^"},test_match:function(Q,ke){var Ue,xe,ct;if(this.options.backtrack_lexer&&(ct={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(ct.yylloc.range=this.yylloc.range.slice(0))),xe=Q[0].match(/(?:\r\n?|\n).*/g),xe&&(this.yylineno+=xe.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:xe?xe[xe.length-1].length-xe[xe.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+Q[0].length},this.yytext+=Q[0],this.match+=Q[0],this.matches=Q,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(Q[0].length),this.matched+=Q[0],Ue=this.performAction.call(this,this.yy,this,ke,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),Ue)return Ue;if(this._backtrack){for(var it in ct)this[it]=ct[it];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var Q,ke,Ue,xe;this._more||(this.yytext="",this.match="");for(var ct=this._currentRules(),it=0;it<ct.length;it++)if(Ue=this._input.match(this.rules[ct[it]]),Ue&&(!ke||Ue[0].length>ke[0].length)){if(ke=Ue,xe=it,this.options.backtrack_lexer){if(Q=this.test_match(Ue,ct[it]),Q!==!1)return Q;if(this._backtrack){ke=!1;continue}else return!1}else if(!this.options.flex)break}return ke?(Q=this.test_match(ke,ct[xe]),Q!==!1?Q:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var ke=this.next();return ke||this.lex()},begin:function(ke){this.conditionStack.push(ke)},popState:function(){var ke=this.conditionStack.length-1;return ke>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(ke){return ke=this.conditionStack.length-1-Math.abs(ke||0),ke>=0?this.conditionStack[ke]:"INITIAL"},pushState:function(ke){this.begin(ke)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(ke,Ue,xe,ct){var it=ct;switch(xe){case 0:this.begin("captext");return;case 1:return 58;case 2:return this.popState(),58;break;case 3:return 62;case 4:return 63;case 5:return 64;case 6:return 65;case 7:return 66;case 8:return 67;case 9:return 49;case 10:return 50;case 11:return 51;case 12:return 52;case 13:return 53;case 14:return 54;case 15:return 73;case 16:return 76;case 17:return 77;case 18:return 78;case 19:return 72;case 20:return 74;case 21:return 75;case 22:return 79;case 23:return 69;case 24:return 70;case 25:return 71;case 26:return 82;case 27:return 13;case 28:return 15;case 29:return 14;case 30:return 10;case 31:return 28;case 32:return 29;case 33:return 85;case 34:return 86;case 35:return 87;case 36:return 17;case 37:return 18;case 38:return 19;case 39:return 80;case 40:return 81;case 41:return 84;case 42:return Ue.yytext=this.matches[1],21;break;case 43:return Ue.yytext=this.matches[1],22;break;case 44:return Ue.yytext=this.matches[1],24;break;case 45:return 68;case 46:return 47;case 47:return 48;case 48:return 88;case 49:return 61;case 50:return 60;case 51:return 83;case 52:return 56;case 53:return 56;case 54:return 57;case 55:return Ue.yytext=this.matches[1],58;break;case 56:return 59;case 57:return;case 58:return 89;case 59:return;case 60:return 55;case 61:return 5;case 62:return 91}},rules:[/^(?:([,][,])(?=[A-Z]))/,/^(?:[A-Z](?=[A-Z]))/,/^(?:[A-Z])/,/^(?:["][6])/,/^(?:["][-])/,/^(?:["][4])/,/^(?:["][8])/,/^(?:["][9])/,/^(?:["][/])/,/^(?:[.][<])/,/^(?:[_][<])/,/^(?:["][<])/,/^(?:[.][>])/,/^(?:[_][>])/,/^(?:["][>])/,/^(?:["][7][@][:])/,/^(?:[_][@][<])/,/^(?:[\^][9])/,/^(?:[_][@][>])/,/^(?:["][7])/,/^(?:[@][<])/,/^(?:[@][>])/,/^(?:[@][9])/,/^(?:[.][0][O][F][ ]?)/,/^(?:[.][0])/,/^(?:[:][O])/,/^(?:[4][4][4])/,/^(?:[%][9])/,/^(?:[%])/,/^(?:[\+])/,/^(?:[95]+(?=.))/,/^(?:[<])/,/^(?:[>])/,/^(?:!)/,/^(?:[6])/,/^(?:[@]&)/,/^(?:[(])/,/^(?:[.][/])/,/^(?:[)])/,/^(?:#[L])/,/^(?:#-)/,/^(?:#=)/,/^(?:#([A-J4]+))/,/^(?:[/]([A-J4]+))/,/^(?:[#][/]([A-J4]+))/,/^(?:[_]?[/])/,/^(?:[1])/,/^(?:[4])/,/^(?:[7]+)/,/^(?:[_][\\][_][\\])/,/^(?:[_][\\])/,/^(?:[3])/,/^(?:(ARC)?(SIN|COS|TAN|CSC|SEC|COT)(H)?)/,/^(?:(ARG|DET|EXP|IM|INF|LIM|LN|LOG|MAX|MIN|MOD|RE|SUP))/,/^(?:[,]?[.][ABGDEZ\?\:IKLMNXOPRSTUYF\&W])/,/^(?:[,]([A-Z]))/,/^(?:[A-Z])/,/^(?:[,]['])/,/^(?:[8])/,/^(?:[;])/,/^(?:[ ])/,/^(?:$)/,/^(?:.)/],conditions:{captext:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62],inclusive:!0},INITIAL:{rules:[0,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62],inclusive:!0}}};return Tr}();Ge.lexer=Et;function Oe(){this.yy={}}return Oe.prototype=Ge,Ge.Parser=Oe,new Oe}();typeof Ux!="undefined"&&typeof r!="undefined"&&(r.parser=t,r.Parser=t.Parser,r.parse=function(){return t.parse.apply(t,arguments)},r.main=function(){},typeof e!="undefined"&&Ux.main===e&&r.main(process.argv.slice(1)))}}),L2=["abs","ans","arccosh","arccot","arccoth","arccsc","arccsch","arcsec","arcsech","arcsinh","arctanh","binomialdist","boxplot","cdf","ceil","corr","cov","csch","distance","dotplot","erf","floor","gcf","histogram","IndependentTTest","iTTest","ittest","lcm","length","mad","mcd","mcm","mean","median","midpoint","mod","nCr","normaldist","nPr","pdf","poissondist","polygon","quantile","quartile","random","round","sech","sign","signum","sgn","stdDev","stddev","stdDevP","stddevp","stdev","stdevp","tdist","total","TScore","TScore","Tscore","tscore","tscore","TTest","ttest","var","variance","varp"],S1=L2,Jne=jW(L2),P2;function $W(r){let e=!1,t=0,i="",o="";for(let n of r)if(n.type==="terminal"&&/[A-Za-z]/.test(n.value))i+=n.value,t++;else break;return o=i.replace(P2,"\\operatorname{$1}"),e=t>0&&o!==i,{modified:e,terminalCount:t,value:o}}function _2(r){return S1.indexOf(r.toLowerCase())!==-1}function D1(r){if(!Array.isArray(r))throw new Error("Operator names must be an array, got "+typeof r);for(let e of r)if(typeof e!="string")throw new Error("Operator names must be strings, found "+typeof e);S1=r,Qne()}function k1(){S1=L2,P2=Jne}function Qne(){P2=jW(S1)}function jW(r){let e=r.sort((t,i)=>i.length-t.length||i.localeCompare(t)).join("|");return new RegExp("("+e+")","g")}var YW={};V2(YW,{command:()=>O2,fraction:()=>tae,greek:()=>Zne,group:()=>R2,level:()=>JW,processPrimes:()=>eae,radical:()=>rae,terminal:()=>XW,typeform:()=>QW});function XW(r){return{type:"terminal",value:r}}function O2(r){return{type:"command",value:r}}function Zne(r){return{type:"greek",value:r}}function JW(r){return{subscript:r._,superscript:r["^"],type:"level"}}function eae(r,e){let t=[],i=r.match(/'+/);if(i!==null){let o=i[0].length;for(let n=0;n<o;n++)t.push(O2("\\prime"))}return R2(t,e)}function tae(r,e){return{type:"fraction",numerator:r,denominator:e}}function QW(r,e){return{name:r,type:"typeform",value:e}}function rae(r,e){return{type:"radical",index:e,radicand:r}}function R2(...r){return Array.prototype.concat.apply([],r)}var f1={"~":"\\ ","\\,":"\\ ","\\:":"\\ ","\\;":"\\ ","\\!":"\\ "},VW={"\\Vert":"\\|","\\ge":"\\geq","\\le":"\\leq","\\vert":"|"},iae={"\\space":!0};function Hg(r){let e=[];for(let t=0;t<r.length;t++){let i=r[t];switch(i.type){case"command":let o=i.value.slice(1).trim();VW.hasOwnProperty(i.value)?e.push(O2(VW[i.value])):_2(o)?e.push(QW("operator_name",oae(o))):iae[i.value]||e.push(i);break;case"level":let n={subscript:i.subscript&&i.subscript.length>0?Hg(i.subscript):void 0,superscript:i.superscript&&i.superscript.length>0?Hg(i.superscript):void 0,type:i.type};(n.subscript||n.superscript)&&e.push(n);break;case"fraction":e.push({denominator:Hg(i.denominator),numerator:Hg(i.numerator),type:i.type});break;case"radical":e.push({index:i.index?Hg(i.index):void 0,radicand:Hg(i.radicand),type:i.type});break;case"terminal":nae(r.slice(t))?(e.push({type:"command",value:"\\ldots"}),t+=2):e.push({type:i.type,value:f1.hasOwnProperty(i.value)?f1[i.value]:i.value});break;case"typeform":e.push(i);break;case"greek":e.push({type:i.type,value:f1.hasOwnProperty(i.value)?f1[i.value]:i.value});break;default:throw new Error(`Unexpected item:
`+JSON.stringify({group:r,item:i}))}}return e}function oae(r){let e=[];for(let t of r)e.push(XW(t));return e}function nae(r){let e=0;for(let t=0;t<Math.min(3,r.length);t++){let i=r[t];i.type==="terminal"&&i.value==="."&&e++}return e===3}function F2(r){if(!r.hash)throw r;return{_diagnostic:{expected:r.hash.expected,message:r.message,text:r.hash.text,token:r.hash.token},location:r.hash.loc}}var ZW=Xne();ZW.parser.yy=YW;function e7(r){try{return{isError:!1,value:ZW.parser.parse(r)}}catch(e){return{isError:!0,error:F2(e)}}}function aae(r){return r.isError}function sae(r,e){return aae(r)?r:{isError:!1,value:e(r.value)}}function zx(r,e){let t=sae(r,e);return r.warnings&&(t.warnings=r.warnings),t}function lae(r){return zx(e7(r),e=>xae(Hg(e)))}var LW={"!":"&","*":"@#",",":", ","/":"_/",":":"_3","<":' "K ',"=":" .K ",">":" .1 ","?":"_8","[":"@(","\\ ":" ","\\%":"@0","\\&":"_&","\\,":" ","\\infty":",=","\\int":"!","\\{":".(","\\|":"\\\\","\\}":".)","]":"@)","|":"\\"};function C2(r){return/^[a-z]$/.test(r.value)?r.value.toUpperCase():/^[A-Z]$/.test(r.value)?","+r.value:/^[0-9.]$/.test(r.value)||/^[+\-()]$/.test(r.value)?r.value:LW.hasOwnProperty(r.value)?LW[r.value]:"[terminal: "+r.value+"]"}var PW={"\\Vert":"\\\\","\\cdot":"*","\\div":"./","\\ge":" .1: ","\\geq":" .1: ","\\langle":"..(","\\ldots":" ''' ","\\le":' "K: ',"\\leq":' "K: ',"\\ne":" /.K ","\\neq":" /.K ","\\approx":" @:@: ","\\nparallel":" /$L ","\\parallel":" $L ","\\perp":" $P ","\\prime":"'","\\prod":".,P","\\rangle":"..)","\\sim":"@:","\\sum":".,S","\\times":"@*","\\to":" $O ","\\vert":"\\"},_W={"\\Alpha":".,A","\\Beta":".,B","\\Chi":".,&","\\Delta":".,D","\\Epsilon":".,E","\\Eta":".,:","\\Gamma":".,G","\\Iota":".,I","\\Kappa":".,K","\\Lambda":".,L","\\Mu":".,M","\\Nu":".,N","\\Omega":".,W","\\Omicron":".,O","\\Phi":".,F","\\Pi":".,P","\\Psi":".,Y","\\Rho":".,R","\\Sigma":".,S","\\Tau":".,T","\\Theta":".,?","\\Upsilon":".,U","\\Xi":".,X","\\Zeta":".,Z","\\alpha":".A","\\beta":".B","\\chi":".&","\\delta":".D","\\epsilon":".E","\\eta":".:","\\gamma":".G","\\iota":".I","\\kappa":".K","\\lambda":".L","\\mu":".M","\\nu":".N","\\omega":".W","\\omicron":".O","\\phi":".F","\\pi":".P","\\psi":".Y","\\rho":".R","\\sigma":".S","\\tau":".T","\\theta":".?","\\upsilon":".U","\\xi":".X","\\zeta":".Z"};function OW(r){return PW.hasOwnProperty(r.value)?PW[r.value]:r.value.slice(1).toUpperCase()+" "}function cae(r){return _W.hasOwnProperty(r.value)?_W[r.value]:r.value.slice(1).toUpperCase()+" "}function dae(r){return r.value==="\\space"}function pae(r,e){return r.isStartOfLine&&/^-?$/.test(e)||/\s-?$/.test(e)||r.wasFraction}function uae(r){return r.value==="\\sum"||r.value==="\\prod"}function hae(r,e){if(e>=r.length)return!1;let t=r[e];if(t.type==="terminal"){if(/^[0-9]$/.test(t.value))return!0;if(t.value!=="."||e+1>=r.length)return!1;if(t=r[e+1],t.type==="terminal")return/^[0-9]$/.test(t.value)}return!1}function $g(r,e){let t="",i=r.levelIndicator,o=0,n=!1;for(let a=0;a<e.length;a++){hae(e,a)&&(i===""&&/[A-Z]$/.test(t)?t+=Zp(i):pae(r,t)&&(t+="#"));let s=e[a],l=a<e.length-1?e[a+1]:null;switch(s.type!=="level"&&i!==r.levelIndicator&&(E2(s)?i="":(r.wasModifiedExpression&&r.levelIndicator===""?r=Dc(r,{wasModifiedExpression:!1}):t+=Zp(r.levelIndicator),i=r.levelIndicator)),s.type){case"terminal":!r.wasModifiedExpression&&i!==""&&E2(s)?t+=" "+Zp(i)+C2(s).trim()+" ":t+=C2(s),s.value==="."&&l&&(l.type==="terminal"&&/^[^_\d,]/.test(C2(l))||l.type==="greek")&&(t+='"'),r=Dc(r,{wasFraction:!1,wasRomanCommand:!1});break;case"command":if(!dae(s)){let h=uae(s);h&&(t+='"'),!h&&i!==""&&E2(s)?t+=" "+Zp(i)+OW(s).trim()+" ":t+=OW(s),r=Dc(r,{wasFraction:!1,wasModifiedExpression:h,wasRomanCommand:!0})}break;case"greek":t+=cae(s),r=Dc(r,{wasFraction:!1});break;case"fraction":let c=gae(r,s);t+=c.value,o=Math.max(o,c.fractionLevel),r=Dc(r,{wasFraction:!0,wasRomanCommand:!1});break;case"radical":let d=mae(r,s);t+=d.value,o=Math.max(o,d.fractionLevel),r=Dc(r,{wasFraction:!1,wasRomanCommand:!1});break;case"level":!r.wasModifiedExpression&&r.wasRomanCommand?(n=/\s$/.test(t),n&&(t=t.replace(/\s$/,""))):n=!1;let p=t.length>0&&/[A-Za-z]/.test(t[t.length-1])===!0,g=fae(r,p,n,s);t+=g.value,i=g.levelIndicator,r=Dc(r,{wasFraction:!1,wasRomanCommand:!1});break;case"typeform":t+=$g(r,s.value).value,s.name==="operator_name"&&(t+=" "),r=Dc(r,{wasFraction:!1,wasModifiedExpression:!1,wasRomanCommand:!1});break}}return{fractionLevel:o,levelIndicator:i,value:t}}function gae(r,e){r=Dc(r,{isStartOfLine:!1});let t=$g(r,e.numerator),i=$g(r,e.denominator),o=Math.max(t.fractionLevel,i.fractionLevel),n="";for(let s=0;s<o;s++)n+=",";let a=n+"?"+t.value;return t.levelIndicator!==r.levelIndicator&&(a+=Zp(r.levelIndicator)),/\.$/.test(t.value)&&(a+='"'),a+=n+"/"+i.value,i.levelIndicator!==r.levelIndicator&&(a+=Zp(r.levelIndicator)),/\.$/.test(i.value)&&(a+='"'),a+=n+"#",{fractionLevel:o+1,value:a}}function mae(r,e){let t=r.radicalLevel,i="",o="";for(let a=0;a<t;a++)o+=".";if(e.index){i+=o+"<";let a=$g(Dc(r,{isStartOfLine:!1}),e.index);i+=a.value,/\.$/.test(a.value)&&(i+='"'),a.levelIndicator!==r.levelIndicator&&(i+=Zp(r.levelIndicator)),i+=">"}else i+=o+">";let n=$g(Dc(r,{isStartOfLine:!1,radicalLevel:t+1}),e.radicand);return i+=n.value,/\.$/.test(n.value)&&(i+='"'),n.levelIndicator!==r.levelIndicator&&(i+=Zp(r.levelIndicator)),i+=o+"]",{fractionLevel:n.fractionLevel,value:i}}function fae(r,e,t,i){let o=r.levelIndicator,n="",a=bae(i.superscript);if(n+=a,i.subscript){r.wasModifiedExpression&&(n+="%"),o=r.levelIndicator+";";let s=$g(Dc(r,{isStartOfLine:!1,levelIndicator:o}),i.subscript);e&&/^[0-9]*(\.|\,)?[0-9]+$/.test(s.value)&&o.length<=1?o=r.levelIndicator:!r.wasModifiedExpression&&i.subscript[0]&&i.subscript[0].type!=="level"&&(n+=Zp(o)),n+=s.value,/\.$/.test(s.value)&&(n+='"')}if(i.superscript){r.wasModifiedExpression&&(n+="<"),o=r.levelIndicator+"^";let s=$g(Dc(r,{isStartOfLine:!1,levelIndicator:o}),i.superscript.slice(a.length));!r.wasModifiedExpression&&i.superscript[0]&&i.superscript[0].type!=="level"&&s.value!==""&&(n+=Zp(o)),n+=s.value,/\.$/.test(s.value)&&(n+='"')}return r.wasModifiedExpression?n+="]":r.wasRomanCommand&&t&&(n+=" ",o=o.slice(0,o.length-1)),{levelIndicator:o,value:n}}function bae(r){let e="";if(r)for(let t of r)if(t.type==="command"&&t.value==="\\prime")e+="'";else break;return e}function Zp(r){return r||'"'}function yae(){return{isStartOfLine:!0,levelIndicator:"",radicalLevel:0,wasFraction:!1,wasModifiedExpression:!1,wasRomanCommand:!1}}function Dc(r,e){return Bx(Bx({},r),e)}function E2(r){return r.type==="terminal"||r.type==="command"?/^<|>|\=|\\leq?|\\geq?|\\neq?$/.test(r.value):!1}function xae(r){let e=yae();return $g(e,r).value}function wae(r){return zx(e7(r),e=>Vae(Hg(e)))}var RW={"!":"6","(":'"<',")":'">',"*":'"9',"+":'"6',",":"1","-":'"-',".":"4","/":"_/",":":"3","<":"@<","=":'"7',">":"@>","?":"8","[":".<","\\ ":" ","\\%":".0","\\&":"@&","\\,":" ","\\infty":"#=","\\int":"!","\\{":"_<","\\|":"_\\_\\","\\}":"_>","]":".>","|":"_\\"};function vae(r,e,t){let i="",o=e.value,n=t&&t.type==="terminal"?t.value:"";return t7(o,r)&&(i+=";"),/^[\D]/.test(o)&&(r=eu(r,{wasNumber:!1})),/^[a-z]$/.test(o)?r.capsLock?(r=eu(r,{capsLock:!1}),i+=",'"+o.toUpperCase()):i+=o.toUpperCase():/^[A-Z]$/.test(o)?r.capsLock?i+=o:/[A-Z]/.test(n)?(r=eu(r,{capsLock:!0}),i+=",,"+o):i+=","+o:(r=eu(r,{capsLock:!1}),/^[0-9.]$/.test(o)?i+=kae(o):RW.hasOwnProperty(o)?i+=RW[o]:i+="[terminal: "+o+"]"),{value:i,ctx:r}}var FW={"\\Vert":"_\\_\\","\\cdot":'"4',"\\div":'"/',"\\ge":"_@>","\\geq":"_@>","\\langle":"@<","\\ldots":"444","\\le":"_@<","\\leq":"_@<","\\ne":'"7@:',"\\neq":'"7@:',"\\approx":"^9","\\parallel":"#L","\\perp":"#-","\\prime":"7","\\prod":",.P","\\rangle":"@>","\\sim":"@9","\\sum":",.S","\\times":'"8',"\\to":":O","\\vert":"_\\"},NW={"\\Alpha":",.A","\\Beta":",.B","\\Chi":",.&","\\Delta":",.D","\\Epsilon":",.E","\\Eta":",.:","\\Gamma":",.G","\\Iota":",.I","\\Kappa":",.K","\\Lambda":",.L","\\Mu":",.M","\\Nu":",.N","\\Omega":",.W","\\Omicron":",.O","\\Phi":",.F","\\Pi":",.P","\\Psi":",.Y","\\Rho":",.R","\\Sigma":",.S","\\Tau":",.T","\\Theta":",.?","\\Upsilon":",.U","\\Xi":",.X","\\Zeta":",.Z","\\alpha":".A","\\beta":".B","\\chi":".&","\\delta":".D","\\epsilon":".E","\\eta":".:","\\gamma":".G","\\iota":".I","\\kappa":".K","\\lambda":".L","\\mu":".M","\\nu":".N","\\omega":".W","\\omicron":".O","\\phi":".F","\\pi":".P","\\psi":".Y","\\rho":".R","\\sigma":".S","\\tau":".T","\\theta":".?","\\upsilon":".U","\\xi":".X","\\zeta":".Z"};function Cae(r,e){let t;return FW.hasOwnProperty(r.value)?t=FW[r.value]:t=r.value.slice(1).toUpperCase()+" ",t7(t,e)&&(t=";"+t),/^[\D]/.test(t)&&(e=eu(e,{wasNumber:!1})),{value:t,ctx:e}}function Eae(r){return NW.hasOwnProperty(r.value)?NW[r.value]:r.value.slice(1).toUpperCase()+" "}function Sae(r){return r.value==="\\space"}function Dae(r,e){if(e<r.length){let t=r[e];if(t.type==="terminal"){if(/^\d$/.test(t.value))return!0;if(t.value!=="."||e+1>=r.length)return!1;if(t=r[e+1],t.type==="terminal")return/^\d$/.test(t.value)}}return!1}function kae(r){let e="";for(let i of r)i===","?e+="1":i==="."?e+="4":i==="0"?e+="J":e+=String.fromCharCode(64+Number(i));return e}function jg(r,e){let t,i,o="",n=!0;for(let a=0;a<e.length;a++){Dae(e,a)?(r=eu(r,{wasNumber:!0}),n&&(o+="#",n=!1)):n=!0;let s=e[a];switch(s.type){case"terminal":let l=a<e.length-1?e[a+1]:void 0;t=vae(r,s,l),r=t.ctx,o+=t.value,o[o.length-1]===" "&&(n=!0);break;case"command":Sae(s)||(i=Cae(s,r),r=i.ctx,o+=i.value,o[o.length-1]===" "&&(n=!0));break;case"greek":o+=Eae(s),o[o.length-1]===" "&&(n=!0);break;case"fraction":let c=Gae(r,s);o+=c.value,r=c.ctx,n=!1;break;case"radical":let d=Tae(r,s);o+=d.value,n=!0;break;case"level":let p=Mae(r,s);o+=p.value,r=p.ctx,n=!0;break;case"typeform":let g=jg(r,s.value).value;o+=g,/(ARC)?(SIN|COS|TAN|CSC|SEC|COT)(H)?/.test(g)&&(o+=" ");break}}return{ctx:r,value:o}}function t7(r,e){return e.wasNumber&&/^[A-Ja-j]/.test(r)}function Gae(r,e){let t=jg(r,e.numerator),i=jg(r,e.denominator),o;return k2(t.value)&&k2(i.value)?(r=eu(r,{wasNumber:!0}),o=t.value+"/"+i.value.slice(1)):(r=eu(r,{wasNumber:!1}),o="("+t.value+"./"+i.value+")"),{ctx:r,value:o}}function k2(r){return/^\#[A-J41]+$/.test(r)}function Tae(r,e){let t="%",i=jg(r,e.radicand);if(e.index){let o=jg(r,R2(JW({"^":e.index})));t+=o.value,/\#[A-J]$/.test(o.value)&&/^[A-J]/.test(i.value)&&(t+=";")}return t+=i.value+"+",{ctx:r,value:t}}function Mae(r,e){let t="",i=Iae(e.superscript);t+=i;let o;if(e.subscript){let n=jg(r,e.subscript);UW(e.subscript,n.value,0)?o="<"+BW(n.value)+">":o=n.value,r=eu(r,{wasNumber:n.ctx.wasNumber}),o!==""&&(t+="5"+o)}if(e.superscript){let n=jg(r,e.superscript.slice(i.length));UW(e.superscript,n.value,i.length)?o="<"+BW(n.value)+">":o=n.value,r=eu(r,{wasNumber:n.ctx.wasNumber}),(i===""||o!=="")&&(t+="9"+o)}return{ctx:r,value:t}}function BW(r){return/^;/.test(r)?r.slice(1):r}function Iae(r){let e="";if(r)for(let t of r)if(t.type==="command"&&t.value==="\\prime")e+="7";else break;return e}function UW(r,e,t){let i=r[0],o=(e.match(/\</g)||[]).length,n=/^["|\.|_]?\</.test(e),a=(e.match(/\>/g)||[]).length,s=/["|\.|_]?\>$/.test(e);return!k2(e)&&r.length-t>1&&o===0&&a===0||o>0&&a>0&&(!n||!s)||o>1||a>1||i&&i.type==="typeform"}function Aae(){return{capsLock:!1,wasNumber:!1}}function eu(r,e){return Bx(Bx({},r),e)}function Vae(r){let e=Aae();return jg(e,r).value}var G2={};V2(G2,{baseline:()=>Rae,command:()=>Pae,comparison:()=>Oae,expression:()=>zae,fraction:()=>Nae,greek:()=>qae,group:()=>Hae,level:()=>N2,level_with_comparison:()=>_ae,modified_expression:()=>Bae,primes:()=>Fae,radical:()=>Uae,simple_subscript:()=>Kae,terminal:()=>Lae});function Lae(r){return{type:"terminal",value:r}}function Pae(r){return{type:"command",value:"\\"+r.trim()+" "}}var r7={'"K':"<",'"K:':"\\leq ",$L:"\\parallel ",$O:"\\to ",$P:"\\perp ",".1":">",".1:":"\\geq ",".K":"=","@:@:":"\\approx","/$L":"\\nparallel ","/.K":"\\neq ","=":"=","@:":"\\sim "};function _ae(r){let e=/[\^;]+/.exec(r),t=e?e.toString():"",i=r.slice(N2.length);return{type:"level_with_comparison",level:t,value:r7[i]}}function Oae(r){return{type:"comparison",value:r7[r]}}function N2(r){return{type:"level",value:r}}function Rae(){return N2("")}function Fae(r){return{type:"primes",value:r}}function Nae(r,e){return{type:"fraction",numerator:r,denominator:e}}function Bae(r,e,t){return{type:"modified_expression",expression:r,under:e,over:t}}function Uae(r,e){return{type:"radical",value:r,index:e}}function zae(r){return{type:"expression",value:r}}function Kae(r,e){return{type:"simple_subscript",base:r,subscript:e}}var zW={".&":"\\chi",".,&":"\\Chi",".,:":"\\Eta",".,?":"\\Theta",".,A":"\\Alpha",".,B":"\\Beta",".,D":"\\Delta",".,E":"\\Epsilon",".,F":"\\Phi",".,G":"\\Gamma",".,I":"\\Iota",".,K":"\\Kappa",".,L":"\\Lambda",".,M":"\\Mu",".,N":"\\Nu",".,O":"\\Omicron",".,P":"\\prod",".,R":"\\Rho",".,S":"\\sum",".,T":"\\Tau",".,U":"\\Upsilon",".,W":"\\Omega",".,X":"\\Xi",".,Y":"\\Psi",".,Z":"\\Zeta",".:":"\\eta",".?":"\\theta",".A":"\\alpha",".B":"\\beta",".D":"\\delta",".E":"\\epsilon",".F":"\\phi",".G":"\\gamma",".I":"\\iota",".K":"\\kappa",".L":"\\lambda",".M":"\\mu",".N":"\\nu",".O":"\\omicron",".P":"\\pi",".R":"\\rho",".S":"\\sigma",".T":"\\tau",".U":"\\upsilon",".W":"\\omega",".X":"\\xi",".Y":"\\psi",".Z":"\\zeta"};function qae(r){if(zW.hasOwnProperty(r))return zW[r]+" ";throw new Error("Unknown Greek letter")}function Hae(...r){return Array.prototype.concat.apply([],r)}var B2=HW(),v1=B2.parser.lexer,Rf=Object.create(v1),Wae=Rf,rE=B2.parser.terminals_,Yn=B2.parser.symbols_;Rf.setInput=function(r,e){this.delimiterStack=[],this.outputQueue=[],this.canAcceptPrimes=!1,v1.setInput.call(this,r,e)};Rf.lex=function(){let r=-1;if(!this)return r;if(this.outputQueue.length)return this.outputQueue.shift();let e=v1.lex.call(this);for(;rE[e]==="UNKNOWN"||!this.canAcceptPrimes&&rE[e]==="PRIMES";)this.warn(),e=v1.lex.call(this);this.canAcceptPrimes=!0;let t,i,o=this.delimiterStack?this.delimiterStack[this.delimiterStack.length-1]:-1;switch(rE[e]){case"OPEN_FRAC":case"OPEN_MODEXP":this.delimiterStack.push(e),this.canAcceptPrimes=!1;break;case"RADICAL_INDEX":o===Yn.RADICAL_INDEX&&(this.delimiterStack.pop(),this.pushCloseTokens(o)),this.delimiterStack.push(e),this.canAcceptPrimes=!1;break;case"OPEN_RADICAL":o===Yn.RADICAL_INDEX&&this.delimiterStack.pop(),this.delimiterStack.push(e),this.canAcceptPrimes=!1;break;case"SLASH":for(t=!1;this.delimiterStack.length;)if(i=this.delimiterStack.pop()||-1,i===Yn.OPEN_FRAC){t=!0;break}else this.pushCloseTokens(i);t||this.pushOpenTokens(e),this.delimiterStack.push(e),this.canAcceptPrimes=!1;break;case"CLOSE_FRAC":for(t=!1;this.delimiterStack.length;)if(i=this.delimiterStack.pop()||-1,i===Yn.SLASH){t=!0;break}else if(i===Yn.OPEN_FRAC){this.addMissingToken(Yn.SLASH),t=!0;break}else this.pushCloseTokens(i);if(!t)return this.warn(),this.canAcceptPrimes=!1,this.lex();break;case"CLOSE_RADICAL":for(t=!1;this.delimiterStack.length;)if(i=this.delimiterStack.pop()||-1,i===Yn.OPEN_RADICAL){t=!0;break}else if(i===Yn.RADICAL_INDEX){t=!0,this.addMissingToken(Yn.OPEN_RADICAL);break}else this.pushCloseTokens(i);t||this.pushOpenTokens(e);break;case"CLOSE_MODEXP":for(t=!1;this.delimiterStack.length;)if(i=this.delimiterStack.pop()||-1,i===Yn.OPEN_MODEXP){t=!0;break}else this.pushCloseTokens(i);t||this.pushOpenTokens(e);break;case"EOF":for(;this.delimiterStack.length;)i=this.delimiterStack.pop()||-1,this.pushCloseTokens(i);break}return this.outputQueue.push(e),r=this.outputQueue.shift()||-1,r};Rf.warn=function(){this.yylloc&&this.yy.warnings.push({location:this.yylloc})};Rf.addMissingToken=function(r){this.outputQueue.push(r),this.warn()};Rf.pushCloseTokens=function(r){switch(rE[r]){case"OPEN_FRAC":this.addMissingToken(Yn.SLASH),this.addMissingToken(Yn.CLOSE_FRAC);break;case"SLASH":this.addMissingToken(Yn.CLOSE_FRAC);break;case"RADICAL_INDEX":this.addMissingToken(Yn.OPEN_RADICAL),this.addMissingToken(Yn.CLOSE_RADICAL);break;case"OPEN_RADICAL":this.addMissingToken(Yn.CLOSE_RADICAL);break;case"OPEN_MODEXP":this.addMissingToken(Yn.CLOSE_MODEXP);break}};Rf.pushOpenTokens=function(r){switch(rE[r]){case"SLASH":this.addMissingToken(Yn.OPEN_FRAC);break;case"CLOSE_FRAC":this.addMissingToken(Yn.OPEN_FRAC),this.addMissingToken(Yn.SLASH);break;case"CLOSE_RADICAL":this.addMissingToken(Yn.OPEN_RADICAL);break;case"CLOSE_MODEXP":this.addMissingToken(Yn.OPEN_MODEXP);break}};var $ae=HW();function jae(r,e){e||(e={});let t=$ae.parser,i=Object.create(t);i.yy=G2,i.yy.warnOrError=n=>{i.parseError(n,{recoverable:!1})};let o=Object.create(t);o.yy=Bx({warnings:[]},G2),o.yy.warnOrError=n=>{o.yy.warnings.push(n)},o.lexer=Wae,e.strict?t=i:t=o;try{return{isError:!1,value:t.parse(r),warnings:t.yy.warnings||[]}}catch(n){return{error:F2(n),isError:!0}}}function Wg(r,e){let t="",i=e,o="",n=!1,a="",s="",l=Yae(r);for(let c=0;c<r.length;c++){let d=r[c],p=c+1<r.length?r[c+1]:null;switch(d.type){case"terminal":let g=$W(r.slice(c));g.value!==""?(t+=g.value,c+=g.terminalCount-1,n=n||g.modified):d.value===" "?(n?(o=a,t+=tE(i,o),i=o):t+="\\ ",n=!1):(l[c]===x1?t+="\\left":l[c]===T2&&(t+="\\right"),t+=d.value);break;case"comparison":o="",t+=tE(i,o),i=o,n=!1,t+=d.value;break;case"level_with_comparison":t+=tE(i,d.level),i=d.level,n=!1,t+=d.value;break;case"command":let h=d.value.slice(1).trim();p&&p.type==="terminal"&&/[a-z]/.test(p.value)?(t+=h,n=!1):_2(h)?(t+="\\operatorname{"+h+"}",n=!0):(t+=d.value,n=!0),a=i;break;case"expression":t+=d.value;break;case"fraction":t+=Zae(d.numerator,d.denominator,i);break;case"modified_expression":t+=Wg(d.expression,i)+" ",d.under&&(t+="_{"+Wg(d.under,i)+"}"),d.over&&(t+="^{"+Wg(d.over,i)+"}");break;case"radical":t+="\\sqrt",d.index&&(t+="["+Wg(d.index,i)+"]"),t+="{"+Wg(d.value,i)+"}";break;case"simple_subscript":i===""?(t+=d.base.value+"_{"+d.subscript.value+"}",d.base.type==="command"&&(n=!0,a=i)):t+=d.base.value+d.subscript.value;break;case"level":t+=tE(i,d.value,s),i=d.value,d.value==="^"&&s!==""&&(s="");break;case"primes":p&&p.type==="level"&&p.value===";"?s=d.value:i!==""?(t+=Array(d.value.length+1).join("\\prime "),s=""):(t+=d.value,s="");break}}return t+=tE(i,e)+s,t.replace(/([^\\])( )$/,"$1")}var x1=1,T2=-1,b1=0,S2=2;function Yae(r){let e=[],t=[];for(let i=0;i<r.length;i++){let o=r[i];if(Xae(o))e.push({direction:x1,index:i}),t.push(b1);else if(Jae(o)){for(;e.length&&e[e.length-1].direction===S2;)e.pop();if(e.length){let n=e.pop();if(n){let a=n.index;t[a]=x1,t.push(T2)}}else t.push(b1)}else if(Qae(o))if(e.length&&e[e.length-1].direction===S2){let n=e.pop();if(n){let a=n.index;t[a]=x1,t.push(T2)}}else e.push({direction:S2,index:i}),t.push(b1);else t.push(b1)}return t}function Xae(r){return r.type==="terminal"?/^(\\langle |\[|\(|\\{)$/.test(r.value):!1}function Jae(r){return r.type==="terminal"?/^(\\rangle |\]|\)|\\})$/.test(r.value):!1}function Qae(r){return r.type==="terminal"?/^(\\\||\|)$/.test(r.value):!1}function Zae(r,e,t){return"\\frac{"+Wg(r,t)+"}{"+Wg(e,t)+"}"}function tE(r,e,t){let i="",o,n,a,s=Math.max(r.length,e.length);for(o=0;o<s&&r[o]===e[o];o++);for(n=r.length-1;n>=o;n--)i+="}";for(a=o;a<e.length;a++)e[a]==="^"&&(t&&(i+=t),i+="^{"),e[a]===";"&&(i+="_{");return i}function ese(r){return Wg(r,"")}function tse(r,e){return e&&e.operatorNames?D1(e.operatorNames):k1(),zx(jae(r,e),ese)}var U2=WW(),C1=U2.parser.lexer,Ff=Object.create(C1),rse=Ff,E1=U2.parser.terminals_,qa=U2.parser.symbols_;Ff.setInput=function(r,e){this.delimiterStack=[],this.outputQueue=[],C1.setInput.call(this,r,e)};Ff.lex=function(){let r=-1;if(this.outputQueue.length)return this.outputQueue.shift();let e=C1.lex.call(this);for(;E1[e]==="UNKNOWN";)this.warn(),e=C1.lex.call(this);let t,i,o=this.delimiterStack?this.delimiterStack[this.delimiterStack.length-1]:-1;switch(E1[e]){case"OPEN_FRAC":this.delimiterStack.push(e);break;case"OPEN_GROUP":this.delimiterStack.push(e);break;case"RADICAL_WITH_INDEX":o===qa.RADICAL_WITH_INDEX&&(this.delimiterStack.pop(),this.pushCloseTokens(o)),this.delimiterStack.push(e);break;case"RADICAL":o===qa.RADICAL_WITH_INDEX&&this.delimiterStack.pop(),this.delimiterStack.push(e);break;case"OVER":for(t=!1;this.delimiterStack.length;)if(i=this.delimiterStack.pop()||-1,i===qa.OPEN_FRAC){t=!0;break}else this.pushCloseTokens(i);t||this.pushOpenTokens(e),this.delimiterStack.push(e);break;case"CLOSE_FRAC":for(t=!1;this.delimiterStack.length;)if(i=this.delimiterStack.pop()||-1,i===qa.OVER){t=!0;break}else if(i===qa.OPEN_FRAC){this.outputQueue.push(qa.OVER),t=!0;break}else this.pushCloseTokens(i);t||this.pushOpenTokens(e);break;case"CLOSE_GROUP":for(t=!1;this.delimiterStack.length;)if(i=this.delimiterStack.pop()||-1,i===qa.OPEN_GROUP){t=!0;break}else this.pushCloseTokens(i);t||this.pushOpenTokens(e);break;case"CLOSE_RADICAL":for(t=!1;this.delimiterStack.length;)if(i=this.delimiterStack.pop()||-1,i===qa.RADICAL||i===qa.RADICAL_WITH_INDEX){t=!0;break}else this.pushCloseTokens(i);t||this.pushOpenTokens(e);break;case"EOF":for(;this.delimiterStack.length;)i=this.delimiterStack.pop()||-1,this.pushCloseTokens(i);break}return this.outputQueue.push(e),r=this.outputQueue.shift()||-1,r};Ff.warn=function(){this.yylloc&&this.yy.warnings.push({location:this.yylloc})};Ff.addMissingToken=function(r){this.outputQueue.push(r),this.warn()};Ff.pushCloseTokens=function(r){switch(E1[r]){case"OPEN_FRAC":this.addMissingToken(qa.OVER),this.addMissingToken(qa.CLOSE_FRAC);break;case"OVER":this.addMissingToken(qa.CLOSE_FRAC);break;case"OPEN_GROUP":this.addMissingToken(qa.CLOSE_GROUP);break;case"RADICAL_WITH_INDEX":case"RADICAL":this.addMissingToken(qa.CLOSE_RADICAL);break}};Ff.pushOpenTokens=function(r){switch(E1[r]){case"OVER":this.addMissingToken(qa.OPEN_FRAC);break;case"CLOSE_FRAC":this.addMissingToken(qa.OPEN_FRAC),this.addMissingToken(qa.OVER);break;case"CLOSE_GROUP":this.addMissingToken(qa.OPEN_GROUP);break;case"CLOSE_RADICAL":this.addMissingToken(qa.RADICAL);break}};var M2={};V2(M2,{basic_level:()=>nse,bracketed_level:()=>ase,command:()=>ose,expression:()=>dse,fraction:()=>lse,greek:()=>use,group:()=>pse,primes:()=>sse,radical:()=>cse,terminal:()=>ise,to_number:()=>hse});function ise(r){return{type:"terminal",value:r}}function ose(r){return{type:"command",value:r}}function nse(r,e){return{type:"basic_level",level:r,value:e}}function ase(r,e,t,i){return{type:"bracketed_level",level:r,lbrack:e,value:t,rbrack:i}}function sse(r){return{type:"primes",value:r.length>0?Array(r.length+1).join("'"):""}}function lse(r,e){return{type:"fraction",numerator:r,denominator:e}}function cse(r,e){return{type:"radical",value:r,index:e}}function dse(r){return{type:"expression",value:r}}function pse(...r){return Array.prototype.concat.apply([],r)}var KW={",.&":"\\Chi",",.:":"\\Eta",",.?":"\\Theta",",.A":"\\Alpha",",.B":"\\Beta",",.D":"\\Delta",",.E":"\\Epsilon",",.F":"\\Phi",",.G":"\\Gamma",",.I":"\\Iota",",.K":"\\Kappa",",.L":"\\Lambda",",.M":"\\Mu",",.N":"\\Nu",",.O":"\\Omicron",",.P":"\\prod",",.R":"\\Rho",",.S":"\\sum",",.T":"\\Tau",",.U":"\\Upsilon",",.W":"\\Omega",",.X":"\\Xi",",.Y":"\\Psi",",.Z":"\\Zeta",".&":"\\chi",".:":"\\eta",".?":"\\theta",".A":"\\alpha",".B":"\\beta",".D":"\\delta",".E":"\\epsilon",".F":"\\phi",".G":"\\gamma",".I":"\\iota",".K":"\\kappa",".L":"\\lambda",".M":"\\mu",".N":"\\nu",".O":"\\omicron",".P":"\\pi",".R":"\\rho",".S":"\\sigma",".T":"\\tau",".U":"\\upsilon",".W":"\\omega",".X":"\\xi",".Y":"\\psi",".Z":"\\zeta"};function use(r){if(KW.hasOwnProperty(r))return KW[r]+" ";throw new Error("Unknown Greek letter")}function hse(r){let e="";for(let i of r)i==="4"?e+=".":i==="J"?e+="0":e+=i.charCodeAt(0)-64;return e}var gse=WW();function mse(r,e){e||(e={});let t=gse.parser,i=Object.create(t);i.yy=M2;let o=Object.create(t);o.yy=Bx({warnings:[]},M2),o.lexer=rse,e.strict?t=i:t=o;try{return{isError:!1,value:t.parse(r),warnings:t.yy.warnings||[]}}catch(n){return{error:F2(n),isError:!0}}}function Of(r,e){let t="",i=!1,o="",n=fse(r);for(let a=0;a<r.length;a++){let s=r[a],l=a+1<r.length?r[a+1]:null;switch(s.type){case"terminal":let c=$W(r.slice(a));c.value!==""?(t+=c.value,a+=c.terminalCount-1):s.value===" "&&!i?t+="\\ ":(n[a]===w1?t+="\\left":n[a]===I2&&(t+="\\right"),t+=s.value),i=!1;break;case"command":let d=s.value.slice(1).trim();l&&l.type==="terminal"&&/[a-z]/.test(l.value)?(t+=d,i=!1):_2(d)?(t+="\\operatorname{"+d+"}",i=!0):(t+=s.value,i=!0);break;case"expression":t+=s.value;break;case"fraction":t+=wse(s.numerator,s.denominator);break;case"radical":t+="\\sqrt",s.index&&(t+="["+Of(s.index)+"]"),t+="{"+Of(s.value)+"}";break;case"basic_level":t+=vse(s.level,s.value,o),s.level==="9"&&(o="");break;case"bracketed_level":t+=Cse(s.level,s.lbrack,s.value,s.rbrack,o),s.level==="9"&&(o="");break;case"primes":l&&(l.type==="basic_level"||l.type==="bracketed_level")&&l.level==="5"?o=s.value:e&&e!==""?(t+=Array(s.value.length+1).join("\\prime "),o=""):(t+=s.value,o="");break}}return t+=o,t.replace(/([^\\])( )$/,"$1")}var w1=1,I2=-1,y1=0,D2=2;function fse(r){let e=[],t=[];for(let i=0;i<r.length;i++){let o=r[i];if(bse(o))e.push({direction:w1,index:i}),t.push(y1);else if(yse(o)){for(;e.length&&e[e.length-1].direction===D2;)e.pop();if(e.length){let n=e.pop();if(n){let a=n.index;t[a]=w1,t.push(I2)}}else t.push(y1)}else if(xse(o))if(e.length&&e[e.length-1].direction===D2){let n=e.pop();if(n){let a=n.index;t[a]=w1,t.push(I2)}}else e.push({direction:D2,index:i}),t.push(y1);else t.push(y1)}return t}function bse(r){return r.type==="terminal"?/^(\\langle |\[|\(|\\{)$/.test(r.value):!1}function yse(r){return r.type==="terminal"?/^(\\rangle |\]|\)|\\})$/.test(r.value):!1}function xse(r){return r.type==="terminal"?/^(\\\||\|)$/.test(r.value):!1}function wse(r,e){return"\\frac{"+Of(r)+"}{"+Of(e)+"}"}function vse(r,e,t){let i="",o="{"+Of(e,r)+"}";return r==="9"?i+=t+"^"+o:r==="5"&&(i+="_"+o),i}function Cse(r,e,t,i,o){let n="",a="{"+e+Of(t,r)+i+"}";return r==="9"?n+=o+"^"+a:r==="5"&&(n+="_"+a),n}var Ese=Of;function Sse(r,e){return e&&e.operatorNames?D1(e.operatorNames):k1(),zx(mse(r,e),t=>Ese(t,""))}var i7=` A1B'K2L@CIF/MSP"E3H9O6R^DJG>NTQ,*5<-U8V.%[$+X!&;:4\\0Z7(_?W]#Y)=`,o7=10240;function Dse(r){return String.fromCharCode(o7+r)}function kse(r){return r.charCodeAt(0)-o7}function Gse(r){return i7[r]}function Tse(r){return i7.indexOf(r)}function Mse(r){let e="";for(let t of r)e+=Dse(Tse(t));return e}function n7(r){let e="";for(let t of r)e+=Gse(kse(t));return e}function Ise(r){return n7(r).replace(/[@-^]/g,e=>String.fromCharCode(e.charCodeAt(0)+32))}function Ase(r){let e="";if(r)for(let t of r){let i=t.charCodeAt(0);96<=i&&i<=127&&(i-=32,t=String.fromCharCode(i)),32<=i&&i<=95&&(t=Mse(t),i=t.charCodeAt(0)),10305<=i&&i<=10495&&(i=10240+(i-1024)%64,t=String.fromCharCode(i)),10240<=i&&i<=10304?e+=t:e+="\u2800"}return e}function Vse(r){for(let e=0;e<r.length;e++){let t=r.charCodeAt(e);if(t<10240||t>10304)return!1}return!0}function a7(r){if(!Vse(r))throw new Error("EncodingError: Expected input to be six-dot unicode braille characters.")}function z2(r,e){return a7(r),tse(As.toBrailleAscii(r),e)}function bh(r,e){return e&&e.operatorNames?D1(e.operatorNames):k1(),zx(lae(r),As.coerceToSixDotCells)}function K2(r,e){return a7(r),Sse(As.toBrailleAscii(r),e)}function yh(r,e){return e&&e.operatorNames?D1(e.operatorNames):k1(),zx(wae(r),As.coerceToSixDotCells)}var As={coerceToSixDotCells:Ase,toBrailleAscii:n7,toExpandedBrailleAscii:Ise},Lse="1.0.3";var Pse=10240;function _se(r,e,t,i,o){let{dotSpacing:n}=r,a=1+n;var s=o.charCodeAt(0)-Pse;s&1&&e.fillRect(t,i,1,1),s&2&&e.fillRect(t,i+a,1,1),s&4&&e.fillRect(t,i+2*a,1,1),s&8&&e.fillRect(t+a,i,1,1),s&16&&e.fillRect(t+a,i+a,1,1),s&32&&e.fillRect(t+a,i+2*a,1,1)}function M1(r,e){let{x:t,y:i,width:o,height:n}=e,a=r.getImageData(t,i,o,n).data;for(let s=3;s<a.length;s+=4)if(a[s]!==0)return!1;return!0}function Ose(r,e){let{x:t,y:i,width:o,height:n}=e,a=r.getImageData(t,i,o,n).data;for(let s=3;s<a.length;s+=4)if(a[s]===0)return!1;return!0}function q2(r,e,t,i,o){return M1(e,A1(r,t,i,o))}function Rse(r,e,t,i,o){let{dotSpacing:n}=r,a=3+2*n;for(var s=0;s<o.length;s++)_se(r,e,t+a*s,i,o[s])}function wh(r,e){let{dotSpacing:t}=r;return(2+t)*e.length+(1+t)*(e.length-1)}function I1(r,e){let{dotSpacing:t}=r;return 3+2*t}function A1(r,e,t,i){let{cellPadding:o}=r;return{x:e-o,y:t-o,width:wh(r,i)+2*o,height:I1(r,i)+2*o}}function G1(r,e){if(!r)return e;let t=Math.min(r.x,e.x),i=Math.min(r.y,e.y),o=Math.max(r.x+r.width,e.x+e.width)-t,n=Math.max(r.y+r.height,e.y+e.height)-i;return{x:t,y:i,width:o,height:n}}function s7(r,e,t){return Math.min(Math.max(r,e),t)}function iE(r,e,t,i,o){return{x:s7(t,0,e.canvas.width-wh(r,o)),y:s7(i,0,e.canvas.height-I1(r,o))}}function oE(r,e,t,i,o){let n=e.fillStyle;e.fillStyle="white";let a=A1(r,t,i,o);e.fillRect(a.x,a.y,a.width,a.height),e.fillStyle="black",Rse(r,e,t,i,o),e.fillStyle=n}function H2(r,e,t,i){let{cellPadding:o}=r;return{x:Math.round(e-(wh(r,i)+o)),y:t}}function Fse(r){return r.replace(/\u283C(?!$)/g,"")}function xh(r,e){let t=e==="nemeth"?bh(r):yh(r);return t.isError?"":Fse(t.value)}function qx(r,e){return e>=0?r*Math.pow(10,e):r/Math.pow(10,-e)}function c7(r,e,t,i){let[o,n]=t,a=Math.ceil(Math.log(n-o)/Math.LN10)-1,s=a,l=5,c=15;e:for(let p=a;a-p<4;p--)for(let g of[5,2,1]){let h=qx(g,p),f=Math.floor(o/h)+1,y=Math.ceil(n/h)-1;var d=Math.abs(i(h)-i(0));let x=xh(String(qx(f*g,p)),e),E=xh(String(qx(y*g,p)),e);if(d<wh(r,x)+wh(r," ")||d<wh(r,E)+wh(r," ")||y-f>=c)break e;s=p,l=g}return{int:l,exp:s}}function d7(r,e,t){return c7(r,e,[t.viewport.xmin,t.viewport.xmax],i=>t.mapx(i))}function Nse(r,e,t){return t.viewport.isSquare(t.screen,{xAxisScale:t.settings.xAxisScale,yAxisScale:t.settings.yAxisScale})?d7(r,e,t):c7(r,e,[t.viewport.ymin,t.viewport.ymax],i=>t.mapy(i))}function l7(r,e){let{int:t,exp:i}=r,[o,n]=e,a=Math.ceil(o/qx(t,i)),s=Math.floor(n/qx(t,i)),l=[];for(var c=a;c<=s;c++)l.push(qx(c*t,i));return l}function Bse(r,e,t){return{x:l7(d7(r,e,t),[t.viewport.xmin,t.viewport.xmax]),y:l7(Nse(r,e,t),[t.viewport.ymin,t.viewport.ymax])}}function p7(r,e,t,i,o){if(t.margins===void 0||e===void 0)return;let n=Use(i),a=t.margins,s={...e.settings},l=s.showGrid&&zse(i),c=!!s.showXAxis,d=!!s.showYAxis,p=!!s.xAxisNumbers,g=s.xAxisArrowMode,h=!!s.yAxisNumbers,f=s.yAxisArrowMode,y=n.graphLineWidth,x={showGrid:!1,xAxisNumbers:!1,xAxisArrowMode:"NONE",yAxisNumbers:!1,yAxisArrowMode:"NONE",showXAxis:!1,showYAxis:!1,graphLineWidth:y,pointLineWidth:2.5,curveOpacity:1,globalCurveColor:"#000",disableFill:!0};for(let T in x)e.settings[T]=x[T];let E=r.width-a.right-a.left,C=r.height-a.top-a.bottom,S=new Ec(E,C),v=e.getProjection().viewport;e.settings.squareAxes&&(v=v.squareCrop(S,e.settings));let M=new wl(S,v,e.settings),A=r.getContext("2d"),I=document.createElement("canvas");I.width=E,I.height=C;let P=I.getContext("2d"),_=document.createElement("canvas");_.width=E,_.height=C;let U=_.getContext("2d"),Y=document.createElement("canvas");Y.width=E,Y.height=C;let R=Y.getContext("2d"),H=document.createElement("canvas");H.width=E,H.height=C;let O=H.getContext("2d"),q=document.createElement("canvas");q.width=E,q.height=C;let w=q.getContext("2d");if(A!==null&&O!==null&&P!==null&&R!==null&&w!==null&&U!==null){e.settings.disableFill=!0,e.screenshotToCanvas(H,{width:E,height:C,targetPixelRatio:1,transparentBackground:!0}),e.settings.disableFill=!1,e.screenshotToCanvas(I,{width:E,height:C,targetPixelRatio:1,transparentBackground:!0}),A.fillStyle="white",A.fillRect(0,0,r.width,r.height);let T=Math.round(M.mapx(0)),B=Math.round(M.mapy(0)),de=s.xAxisLabel!==""?s.xAxisLabel.replace(/ /g,"\\ "):"x",F=s.yAxisLabel!==""?s.yAxisLabel.replace(/ /g,"\\ "):"y",j=1;if(c&&M.coordsAreOnscreen(E-6,B-8,0)){let ne={...n,cellPadding:n.cellPadding+j},X=2+2*I1(ne,de),ae=E-2,J=B-X,ge=xh(de,o);({x:ae,y:J}=H2(ne,ae,J,ge)),{x:ae,y:J}=iE(ne,P,ae,J,ge),oE(ne,w,ae,J,ge)}if(d&&M.coordsAreOnscreen(T+4,1,0)){let ne={...n,cellPadding:n.cellPadding+j},X=T+4,ae=1,J=xh(F,o);({x:X,y:ae}=iE(ne,P,X,ae,J)),oE(ne,w,X,ae,J)}let{x:pe,y:le}=Bse(n,o,M);if(c){let ne;for(let X of pe){if(X===0&&d)continue;let ae=Math.round(M.mapx(X));if(!(ae<2||ae>M.screen.width-2)&&p){let J=wh(n,xh("-1",o))-wh(n,xh("1",o)),ge=X<0?J+1:1,be=ae-ge,Ee=B+4,Le=xh(""+X,o);({x:be,y:Ee}=iE(n,w,be,Ee,Le)),q2(n,O,be,Ee,Le)&&(oE(n,w,be,Ee,Le),ne=G1(ne,A1(n,be,Ee,Le)))}}n.embossPatternInequalities&&ne&&(ne=G1(ne,{x:0,y:B,width:E,height:0}),R.fillStyle="white",R.fillRect(ne.x,ne.y,ne.width,ne.height))}if(d){let ne;for(let X of le){if(X===0&&c)continue;let ae=Math.round(M.mapy(X));if(ae<2||ae>M.screen.height-2)continue;let J=-Math.ceil(I1(n," ")/2);if(h){let ge=T-4,be=ae+J,Ee=xh(""+X,o);({x:ge,y:be}=H2(n,ge,be,Ee)),{x:ge,y:be}=iE(n,w,ge,be,Ee),q2(n,O,ge,be,Ee)&&(oE(n,w,ge,be,Ee),ne=G1(ne,A1(n,ge,be,Ee)))}}n.embossPatternInequalities&&ne&&(ne=G1(ne,{x:T,y:0,width:0,height:C}),R.fillStyle="white",R.fillRect(ne.x,ne.y,ne.width,ne.height))}if(c&&d){let ne=T-2,X=B+2,ae=xh(p||h?"0":"o",o);({x:ne,y:X}=H2(n,ne,X,ae)),M.coordsAreOnscreen(ne,X,0)&&({x:ne,y:X}=iE(n,w,ne,X,ae),q2(n,O,ne,X,ae)&&oE(n,w,ne,X,ae))}for(let ne of pe){let X=Math.round(M.mapx(ne));X<2||X>M.screen.width-2||d&&ne===0||l&&nE(R,"white",X-1,0,C,3)}for(let ne of le){let X=Math.round(M.mapy(ne));X<2||X>M.screen.height-2||c&&ne===0||l&&aE(R,"white",X-1,0,E,3)}c&&aE(R,"white",B-3,0,E,7),d&&nE(R,"white",T-3,0,C,7);for(let ne of pe){let X=Math.round(M.mapx(ne));X<2||X>M.screen.width-2||d&&ne===0||(l?nE(R,T1(i),X,0,C):c&&nE(R,T1(i),X,B-3,B+2))}for(let ne of le){let X=Math.round(M.mapy(ne));X<2||X>M.screen.height-2||c&&ne===0||(l?aE(R,T1(i),X,0,E):d&&aE(R,T1(i),X,T-3,T+2))}if(c&&aE(R,Kx(i),B,0,E),d&&nE(R,Kx(i),T,0,C),f!=="NONE"&&(Wse(R,Kx(i),T,0),f==="BOTH"&&Hse(R,Kx(i),T,C-1)),g!=="NONE"&&(Kse(R,Kx(i),E-1,B),g==="BOTH"&&qse(R,Kx(i),0,B)),n.embossPatternInequalities)for(let ne=0;ne<E;ne+=6)for(let X=0;X<C;X+=6){let ae={x:ne,y:X,width:3,height:3};Ose(P,ae)&&M1(R,ae)&&M1(O,ae)&&M1(w,ae)&&$se(U,"black",ne,X)}n.embossPatternInequalities||A.drawImage(I,a.left,a.top),A.drawImage(Y,a.left,a.top),A.drawImage(H,a.left,a.top),A.drawImage(q,a.left,a.top),n.embossPatternInequalities&&A.drawImage(_,a.left,a.top)}for(let T in x)e.settings[T]=s[T]}function Use(r){if(r==="etc8"||r==="etc11")return{dotSpacing:0,cellPadding:1,graphLineWidth:1.75,embossPatternInequalities:!0};if(r==="vpmax8"||r==="vpmax11")return{dotSpacing:1,cellPadding:2,graphLineWidth:1,embossPatternInequalities:!1};{let e=r;throw new Error(`Unexpected embosser model ${e}`)}}function zse(r){if(r==="etc8"||r==="etc11")return!1;if(r==="vpmax8"||r==="vpmax11")return!0;{let e=r;throw new Error(`Unexpected embosser model ${e}`)}}function Kx(r){switch(r){case"vpmax8":case"vpmax11":return"rgb(145, 145, 145)";case"etc8":case"etc11":return"rgb(0, 0, 0)";default:let e=r;throw new Error("Unexpected embosser model: "+e)}}function T1(r){switch(r){case"vpmax8":case"vpmax11":return"rgb(219, 219, 219)";case"etc8":case"etc11":return"rgb(0, 0, 0)";default:let e=r;throw new Error("Unexpected embosser model: "+e)}}function nE(r,e,t,i,o,n=1){let a=r.fillStyle;r.fillStyle=e,r.fillRect(t-1,i,n,o-i),r.fillStyle=a}function aE(r,e,t,i,o,n=1){let a=r.fillStyle;r.fillStyle=e,r.fillRect(i,t-1,o-i,n),r.fillStyle=a}function Kse(r,e,t,i){let o=r.fillStyle;r.fillStyle=e;for(var n=-2;n<=2;n++)r.fillRect(t-Math.abs(n),i-1+n,1,1);r.fillStyle=o}function qse(r,e,t,i){let o=r.fillStyle;r.fillStyle=e;for(var n=-2;n<=2;n++)r.fillRect(t+Math.abs(n),i-1+n,1,1);r.fillStyle=o}function Hse(r,e,t,i){let o=r.fillStyle;r.fillStyle=e;for(var n=-2;n<=2;n++)r.fillRect(t-1+n,i-Math.abs(n),1,1);r.fillStyle=o}function Wse(r,e,t,i){let o=r.fillStyle;r.fillStyle=e;for(var n=-2;n<=2;n++)r.fillRect(t-1+n,i+Math.abs(n),1,1);r.fillStyle=o}function $se(r,e,t,i){let o=r.fillStyle;r.fillStyle=e,r.fillRect(t+1,i,1,1),r.fillRect(t,i+1,1,1),r.fillRect(t+1,i+1,1,1),r.fillRect(t+2,i+1,1,1),r.fillRect(t+1,i+2,1,1),r.fillStyle=o}var Yg={};Yg.vpmax8={width:170,height:220,margins:{left:5,top:15,right:5,bottom:50},name:r=>r.s("graphing-calculator-label-braille-size-vpmax8")};Yg.vpmax11={width:230,height:220,margins:{left:15,top:15,right:5,bottom:5},name:r=>r.s("graphing-calculator-label-braille-size-vpmax11")};Yg.etc8={width:96,height:96,margins:{left:5,top:15,right:0,bottom:0},name:r=>r.s("graphing-calculator-label-braille-size-etc8")};Yg.etc11={width:132,height:134,margins:{left:10,top:15,right:5,bottom:5},name:r=>r.s("graphing-calculator-label-braille-size-etc11")};var sE=class{constructor(e){this.grapher=e,this.controller=this.grapher.controller,this.renderedTabTargetOrder=[],this.renderedTabTargets={}}redrawToCtx(e,t,i){let{ctx:o,projection:n}=e;this.renderedTabTargets={},this.renderedTabTargetOrder=[],Ms(o,"background-images"),(i===void 0||i.length<__dcg_shared_module_exports__['s'](t))&&(i=__dcg_shared_module_exports__['B'](t));for(let s of i){let l=t[s];l&&l.shouldGraph&&!l.foreground&&cT(e,l,this.grapher.clickableObjectsLayer,{currentKeyboardAttention:this.controller.get2dPOIController().keyboardAttentionManager.getKeyboardAttention(),cacheRenderedSvgs:this.controller.getGraphSettings().config.cacheRenderedSvgs});var a=this.controller.getItemModel(s);if(a&&a.type==="image"&&a.shouldGraph&&Nd(a)){let c=a.formula.dimensions;if(!c||!c.x||!c.y||!c.width||!c.height||!c.radianAngle)continue;for(let d=0;d<c.x.length;d++)if(isFinite(c.x[d])&&isFinite(c.y[d])&&isFinite(c.width[d])&&isFinite(c.height[d])&&isFinite(c.radianAngle[d])){this.renderedTabTargetOrder.push(s),this.renderedTabTargets[s]={id:s,description:this.getComputedDescription(a,d),x:c.x[d],y:c.y[d],radianAngle:c.radianAngle[d],width:c.width[d],height:c.height[d],widthScale:Math.abs(n.mapx(1)-n.mapx(0)),heightScale:Math.abs(n.mapy(1)-n.mapy(0)),screenX:n.mapx(c.x[d]),screenY:n.mapy(c.y[d]),centerId:a.formula.center_reference_id,selected:Na(a)};break}}}Is(o),this.speakAriaAlert()}getOrderedTabTargets(){return this.getTabIndex()===-1?[]:this.renderedTabTargetOrder.map(e=>{var i;let t=this.renderedTabTargets[e];return{calcId:t.id,listIndex:void 0,polygonEdge:void 0,description:this.controller.isGeometry()||(i=this.getAriaAlert({id:t.id,includeUsageInstructions:!0}))==null?void 0:i.completeMessage}})}getStyle(e){var t=this.renderedTabTargets[e];if(!t)return;let{screenX:i,screenY:o,radianAngle:n,width:a,height:s,widthScale:l,heightScale:c}=t,d=c/l,p=a*l,g=s*c/d,h=i-p/2,f=o-g/2;var y=`translate(${h}px, ${f}px)`,x=n?` rotate(${n}rad)`:"",E=d===1?"":` scale(1,${d})`;return{position:"absolute",top:0,left:0,transform:y+E+x,width:p+"px",height:g+"px"}}getTabIndex(){if(this.controller.getActiveTool()!=="selection")return-1;var e=this.grapher.settings;return e.config.graphpaper&&e.config.enableTabindex?0:-1}getAriaHidden(){var e=this.grapher.settings;return!e.config.graphpaper}getComputedDescription(e,t){let i=e.formula&&e.formula.computed_description&&e.formula.computed_description[t];return i&&i!==""?la(i):this.grapher.getAudioTrace().getExpressionAriaLabel(e.id)}getAriaLabel(e){var t=this.getAriaAlert({id:e,includeUsageInstructions:!1});return t&&t.completeMessage}speakAriaAlert(){if(this.controller.isGeometry())return;let e=this.getFocusedImage();if(!e){this.lastAriaAlert=void 0;return}let t=e.id,i=this.getAriaAlert({id:t,lastAriaAlert:this.lastAriaAlert,includeUsageInstructions:!0});this.lastAriaAlert=i,i&&i.completeMessage&&Te(i.completeMessage)}getAriaAlert(e){let{id:t,lastAriaAlert:i,includeUsageInstructions:o}=e;if(t){var n=this.controller.getItemModel(t);if(!(!n||n.type!=="image")){var a=this.renderedTabTargets[t];if(a){i&&i.id!==t&&(i=void 0);var s=i==null?void 0:i.label,l=a.description,c=s!==l,d=!!(i!=null&&i.selected),p=a.selected,g=d!==p,h=i&&i.coordX,f=i&&i.coordY,y=a.x,x=a.y,E=y!==h||x!==f,C=this.grapher.getProjection(),S=ps(this.controller,y),v=us(this.controller,x),M=`${S} ${v}`,A=l,I=o?this.controller.s("graphing-calculator-narration-movable-point-suffix-usage-instructions"):"",P=this.isImageFullyVisible(n,C)?"":this.controller.s("graphing-calculator-narration-draggable-image-off-screen-prompt"),_;return i?c||!E&&g?_=A+P:E?_=M+P:_="":_=this.controller.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:A,x:S,y:v})+I+P,{id:t,coordX:y,coordY:x,label:l,completeMessage:_}}}}}getFocusedImage(){let e=this.grapher.poiController.keyboardAttentionManager.getKeyboardAttention();return e?this.renderedTabTargets[e.calcId]:void 0}speakImageAttribute(e,t){if(e){var i=this.grapher.getAudioTrace();if(i){var o=this.grapher.getProjection();if(o)switch(t){case"X":Te(ps(this.controller,e.x));break;case"Y":Te(us(this.controller,e.y));break;case"L":Te(e.description);break}}}}hasNonlinearMoveStrategy(e){if(!e)return!1;var t=this.controller.getItemModel(e);if(!t||t.type!=="expression"||!t.formula)return!1;var i=t.formula.move_strategy;return!i||!i[0]?!1:i[0].type==="updateSliderNonlinear"}isImageFullyVisible(e,t){let i=e.formula.dimensions;if(!i||!i.x||!i.y)return!1;for(let o=0;o<i.x.length;o++)if(!t.coordsAreOnscreen(t.mapx(i.x[o]),t.mapy(i.y[o])))return!1;return!0}};function W2(r,e){return`${r}_dcg_delim_${e}`}var lE=class{constructor(e){this.hoveredObjects={},this.grapher=e,this.controller=this.grapher.controller,this.renderedTabTargetOrder=[],this.renderedTabTargets={}}getOrderedTabTargets(){return this.renderedTabTargetOrder.map(e=>{let t=this.renderedTabTargets[e];return{calcId:t.id,listIndex:t.listIndex,polygonEdge:void 0,description:t.description}})}redraw(){this.renderedTabTargets={},this.renderedTabTargetOrder=[];let e=this.grapher.getSketchOrder();for(let t of e){let i=this.controller.getItemModel(t);if(!i)continue;let o=this.grapher.getGraphSketch(t),n=this.grapher.getGraphImage(t);if(o&&i.type==="expression"&&cs(i))for(let a=0;a<o.branches.length;a++){let s=o.branches[a];if(!s.segments||s.segments.length===0)continue;let l=0;s.graphMode===3||s.graphMode===4?o.getBranchPOI(a).forEach(c=>{l=c.pointIdxOnBranch||0,isFinite(c.x)&&isFinite(c.y)&&this.addTabTarget(i,l)}):(l="listIndex"in s&&s.listIndex!==void 0?s.listIndex:0,s.segments.length>0&&this.addTabTarget(i,l))}else if(n&&n.shouldGraph&&i.type==="image"&&mf(i)){let a=i.formula&&i.formula.dimensions;if(!a||!a.x||!a.y||!a.width||!a.height||!a.radianAngle)continue;for(let s=0;s<a.x.length;s++)isFinite(a.x[s])&&isFinite(a.y[s])&&isFinite(a.width[s])&&isFinite(a.height[s])&&isFinite(a.radianAngle[s])&&this.addTabTarget(i,s)}}Object.keys(this.hoveredObjects).length||this.pressedObject?this.grapher.setLayerClass("clickableObjects","dcg-mouse-over-clickable-object"):this.grapher.setLayerClass("clickableObjects",void 0)}addTabTarget(e,t){let i=W2(e.id,t);this.renderedTabTargetOrder.indexOf(i)!==-1||this.renderedTabTargets[i]!==void 0||(this.renderedTabTargetOrder.push(i),this.renderedTabTargets[i]={type:e.type,id:e.id,listIndex:t,description:this.getComputedDescription(e,t)})}getTabIndex(e){if(this.controller.getActiveTool()!=="selection"||!this.renderedTabTargets[e])return-1;let i=this.grapher.settings;return!i.config.graphpaper||!i.config.enableTabindex?-1:0}getAriaHidden(){return!this.grapher.settings.config.graphpaper}getCachedDescription(e){return this.renderedTabTargets[e].description}getComputedDescription(e,t){let i=e.formula&&e.formula.computed_description&&e.formula.computed_description[t];return i&&i!==""?la(i):this.grapher.getAudioTrace().getExpressionAriaLabel(e.id)}getModelId(e){let t=this.renderedTabTargets[e];return t?t.id:""}getListIndex(e){let t=this.renderedTabTargets[e];if(t)return t.listIndex}isKeyboardFocused(e,t){if(!e)return!1;let i=this.grapher.poiController.keyboardAttentionManager.getKeyboardAttention(),o=i==null?void 0:i.calcId;return e===o&&(t===void 0||t===(i==null?void 0:i.listIndex))}shouldDrawHovered(e,t,i){if(!t)return!1;if(this.isKeyboardFocused(t,i))return!0;let{translationPreviewVectorParents:o,rotationPreviewAngleMarkerParents:n}=e.transformationPreviewParentData;if(o.has(t)||n.has(t)&&!this.controller.isToolPreviewItem(t))return!0;if(this.isAnObjectPressed()&&!this.isObjectPressed(t))return!1;let a=this.getHoveredObjectById(t);return a?a.listIndexes===void 0||i===void 0?!0:!!a.listIndexes[i]:!1}setHoveredObjects(e){__dcg_shared_module_exports__['E'](e,this.hoveredObjects)||(this.hoveredObjects=e,this.requestRedrawNextFrame())}getHoveredObjects(){let e=this.grapher.poiController.keyboardAttentionManager.getKeyboardAttention();if(e){let t=__dcg_shared_module_exports__['Z'](this.hoveredObjects),i=t[e.calcId],o=e.listIndex||0;return i?i.listIndexes?i.listIndexes[o]=!0:i.listIndexes={[o]:!0}:(i={listIndexes:{[o]:!0}},t[e.calcId]=i),t}else return this.hoveredObjects}getHoveredObjectById(e){return this.getHoveredObjects()[e]}shouldDrawPressed(e,t){if(!e)return!1;let i=this.pressedObject;return!i||i.id!==e?!1:t===void 0?!0:i.listIndex===t}isObjectPressed(e){return e===void 0?!1:!!(this.pressedObject&&this.pressedObject.id===e)}setPressedObject(e){!e&&!this.pressedObject||e&&this.pressedObject&&e.id===this.pressedObject.id&&e.listIndex===this.pressedObject.listIndex||(this.pressedObject=e,this.requestRedrawNextFrame())}getPressedObject(){return this.pressedObject}isAnObjectPressed(){return!!this.pressedObject}requestRedrawNextFrame(){this.controller.requestRedrawGraph()}shouldDrawGhosted(e){if(!e)return!1;let t=this.controller.getItemModel(e);return!t||t.type!=="expression"?!1:ls(t)}};Rc();var fi=class{constructor(e){this.model=e;this.s=e.s}createOutput(){return this.model.createCustomToolOutput(this.getSpec())}clearTentativeOutputs(){let e=this.getSpec();var t={},i=this.model.getNonObjectsState().ui.currentTool.idMap;for(let o in i){let n=i[o];!this.model.isObjectALockedToolInput(n)&&this.model.isObjectUncommitted(n)&&(t[o]=n)}this.model.deleteObjectsAndRememberReusableId(t),this.model.tentativelyMatchToolInput(e,""),this.createOutput()}didLockInput(e){var n;let{currentTool:t}=this.model.getNonObjectsState().ui,i=t.inputIndex,o=e.inputs[i];o&&(n=o.numberInputInfo)!=null&&n.defaultLatex&&!t.idMap[o.id]&&this.onNumberInput(o.numberInputInfo.defaultLatex)}shouldReferenceSpecificItemInList(e,t){return!t}getExpandedReferenceForDef(e,t){return this.shouldReferenceSpecificItemInList(e,t)?e.referenceLatex:e.assignment}getListIndexForHover(e,t){if(this.shouldReferenceSpecificItemInList(e,t))return e.listIndex}_getOrCreatePoint(e,t,i){var c,d;let o=this.model.getOrCreatePointNearMouse(e,i);if(o.type==="def")return{createdNew:!1,def:o.def,reference:this.getExpandedReferenceForDef(o.def,t),previewOnly:!1};let n=this.createPointDefinition(o.spec,t),a=o.spec.type==="point-reference"?o.spec.targetSpec.parentDefs:o.spec.parentDefs,s=0;for(let p=0;p<a.length;p++){let g=a[p];if(g.polygonEdgeInfo){let h=this.model.createToolInputDependency({type:"polygon-segment",parents:[(c=g.polygonEdgeInfo)==null?void 0:c.polygonDef.referenceLatex],edgeNumber:((d=g.polygonEdgeInfo)==null?void 0:d.edgeNumber)||0},this.getSpec(),s);n.parents[p]=h,s+=1,this.model.setObjectHovered({tokenId:h,listIndex:void 0})}else this.model.setObjectHovered({calcId:g.calcId,listIndex:this.getListIndexForHover(g,t)})}return{createdNew:!0,def:void 0,reference:this.model._createInputObject(n),previewOnly:n.type==="point"&&n.previewOnly}}_isReadyToCommit(){return this.model.getNonObjectsState().ui.currentTool.inputIndex>=this.getSpec().inputs.length}_getFirstMissingInput(){let{inputIndex:e}=this.model.getNonObjectsState().ui.currentTool;return this.getSpec().inputs[e]}canNextInputBePoint(){let e=this._getFirstMissingInput();return e&&e.type==="point"?!0:!!(e&&e.type==="union"&&e.valueTypes.indexOf(__dcg_shared_module_exports__['va'])!==-1)}getNonPointInputType(){let e=this._getFirstMissingInput();if(!(!e||e.type==="point"))return e.type==="union"?e:e.type}isValidNextInputType(e){if(this.canNextInputBePoint()&&__dcg_shared_module_exports__['gb'](e,__dcg_shared_module_exports__['va']))return!0;let t=this._getFirstMissingInput();if(!t)return!1;let i=[];if(t.type==="union")i=t.valueTypes;else{let o=t.type;switch(o){case"point":i=[__dcg_shared_module_exports__['va']];break;case"straight":i=[...__dcg_shared_module_exports__['hb']];break;case"angle":i=[__dcg_shared_module_exports__['Pa'],__dcg_shared_module_exports__['Ra']];break;case"arc":i=[__dcg_shared_module_exports__['Ja']];break;case"circle":i=[__dcg_shared_module_exports__['Ha']];break;case"polygon":i=[__dcg_shared_module_exports__['Da']];break;case"segment":i=[__dcg_shared_module_exports__['Fa']];break;case"vector":i=[__dcg_shared_module_exports__['Va']];break;default:return o}}return t.numberInputInfo&&i.push(__dcg_shared_module_exports__['ua']),i.some(o=>__dcg_shared_module_exports__['gb'](e,o))}getAllValidNextInputTypes(){return __dcg_shared_module_exports__['ab'].filter(e=>this.isValidNextInputType(e))}getHint(){let e=this._getFirstMissingInput();return e?e.hint!==void 0?this.s(e.hint):this.s("graphing-calculator-text-geometry-select-hint",{type:e.type}):""}getSpecIdToLockIn(e,t){let i=e.inputs[t];if(i)return i.id}tryCommitResults(){if(this.model.attemptLockToolInputIn(this.getSpec()),this._isReadyToCommit()){let e=this.model.getUncommittedObjects();for(let i in e)e[i].type==="expression-edit-preview-latex"&&delete e[i];let t={...this.model.getNonObjectsState().ui.currentTool.idMap};return this.model.commitObjects(),this.model.deselectAllObjects(),this.model.cancelToolplay(),{committed:e,toolIdToLatex:t}}return{committed:void 0}}tentativelyAddInput({target:e,pointInfo:t},i){var n,a;let o;if(e)if(e.polygonEdgeInfo){let s=this.model.createToolInputDependency({type:"polygon-segment",parents:[(n=e.polygonEdgeInfo)==null?void 0:n.polygonDef.referenceLatex],edgeNumber:((a=e.polygonEdgeInfo)==null?void 0:a.edgeNumber)||0},this.getSpec(),0);this.model.setObjectHovered({tokenId:s,listIndex:void 0}),o=s}else o=this.getExpandedReferenceForDef(e,i),this.model.setObjectHovered({calcId:e.calcId,listIndex:this.getListIndexForHover(e,i)});else t&&(o=t.reference,t!=null&&t.def&&!t.createdNew&&!t.previewOnly&&this.model.setObjectHovered({calcId:t.def.calcId,listIndex:this.getListIndexForHover(t.def,i)}));o&&this.model.tentativelyMatchToolInput(this.getSpec(),o)}onFocus(e){this.clearTentativeOutputs(),e&&this.tentativelyAddInput({target:e},!1),this.createOutput()}onMove(e){this.clearTentativeOutputs();let t=this.canNextInputBePoint(),i=this.getNonPointInputType(),o=!1;if(i){let n=this.model.getObjectDefUnderMouse(e.pt,e.tolerance);n&&this.model.objectIsInstanceOf(n,i)&&(this.tentativelyAddInput({target:n},e.shift),o=!0)}if(!o&&t){let n=this._getOrCreatePoint(e.pt,e.shift,e.tolerance);o=!n.previewOnly,this.isDegenerateInput(n.reference)?n.def&&this.model.setObjectHovered({calcId:n.def.calcId,listIndex:this.getListIndexForHover(n.def,e.shift)}):this.tentativelyAddInput({pointInfo:n},e.shift)}return this.createOutput(),o}isDegenerateInput(e){return!!this.model.getNonObjectsState().ui.currentTool.lockedIds[e]}getNumberInputLatex(){let e=this.getSpec(),{inputIndex:t,idMap:i}=this.model.getNonObjectsState().ui.currentTool,o=e.inputs[t];return o!=null&&o.numberInputInfo&&i[`${o.id}-number`]||""}onNumberInput(e){this.clearTentativeOutputs();let t=this.getSpec();this.model.storeNumberInputLatex(t,e),this.createOutput()}createPointDefinition(e,t){let i=e.parentDefs,o;switch(e.type){case"point-reference":{o={type:"point-reference",parents:[this.getExpandedReferenceForDef(i[0],t)]};break}default:{let n=i.map(a=>this.getExpandedReferenceForDef(a,t));o={...e,parents:n}}}return o}shouldUseJitEdges(){return!0}shouldHighlightRelevantObjects(){return!0}};function V1(r,e){if(typeof e=="object")return e.valueTypes.some(t=>__dcg_shared_module_exports__['gb'](r,t));switch(e){case"point":return r===__dcg_shared_module_exports__['va'];case"straight":return r===__dcg_shared_module_exports__['La']||r===__dcg_shared_module_exports__['Na']||r===__dcg_shared_module_exports__['Fa']||r===__dcg_shared_module_exports__['Va'];case"angle":return r===__dcg_shared_module_exports__['Pa']||r===__dcg_shared_module_exports__['Ra'];case"arc":return r===__dcg_shared_module_exports__['Ja'];case"circle":return r===__dcg_shared_module_exports__['Ha'];case"polygon":return r===__dcg_shared_module_exports__['Da'];case"segment":return r===__dcg_shared_module_exports__['Fa'];case"vector":return r===__dcg_shared_module_exports__['Va'];default:return e}}var $2="graphing-calculator-text-geometry-tool-vector-hint-start",u7="graphing-calculator-text-geometry-tool-vector-hint-end",h7="graphing-calculator-text-geometry-tool-vector-copy-hint-end",cE=class extends fi{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-vector-display-name",this.toolName="vector",this.toolType="simple",this.icon=[{type:"stroked-path",path:[32,68,65,35],lineWidth:"large",arrow:!0},{type:"point",x:32,y:68},{type:"point",x:68,y:32}]}getExpressionEditHint(t){return t===0?this.s($2):this.firstInputIsVector()?this.s(h7):this.s(u7)}firstInputIsVector(){let{idMap:t}=this.model.getNonObjectsState().ui.currentTool,i=t[1],o=i&&this.model.findDefsForInputId(i)[0];return o&&o.typedRuntimeValue.valueType===__dcg_shared_module_exports__['Va']}getSpec(){return this.firstInputIsVector()?{inputs:[{type:"union",valueTypes:[__dcg_shared_module_exports__['va'],__dcg_shared_module_exports__['Va']],id:"1",hint:$2},{type:"point",id:"2",hint:h7}],outputs:[{id:"3",type:"vector-copy",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}:{inputs:[{type:"union",valueTypes:[__dcg_shared_module_exports__['va'],__dcg_shared_module_exports__['Va']],id:"1",hint:$2},{type:"point",id:"2",hint:u7}],outputs:[{id:"3",type:"vector",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};function Yse(r){return Array.isArray(r)&&r.length===2&&r.every(e=>Array.isArray(e)&&e.length===2&&e.every(t=>!Array.isArray(t)&&!isNaN(t)))}function Nf(r){if(!Yse(r))return __dcg_shared_module_exports__['lb'](__dcg_shared_module_exports__['Va']);let e=r[1][0],t=r[1][1],i=r[1][0]+r[0][0],o=r[1][1]+r[0][1];return[[e,t],[i,o]]}var Yd=class extends fi{generateDefaultName(){return"does not matter"}};var g7="graphing-calculator-text-geometry-tool-rotation-hint-center",Xse="graphing-calculator-text-geometry-tool-rotation-hint-angle",Jse="graphing-calculator-text-geometry-tool-rotation-hint-angle-start",Qse="graphing-calculator-text-geometry-tool-rotation-hint-angle-vertex",Zse="graphing-calculator-text-geometry-tool-rotation-hint-angle-end",Bf=class extends Yd{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-rotate-display-name",this.toolName="rotation",this.toolType="transformation"}getMode(){let{idMap:t}=this.model.getNonObjectsState().ui.currentTool;return t["2-number"]?"number":"directed-angle"}getExpressionEditHint(t){return t===0?this.s(g7):this.s(Xse)}onNumberInput(t){super.onNumberInput(t),this.clearTentativeOutputs()}onMove(t){return this.getMode()==="number"&&this.model.getNonObjectsState().ui.currentTool.inputIndex===1?!1:super.onMove(t)}getSpecIdToLockIn(t,i){if(i===1){let o=t.inputs[i];return this.getMode()==="number"?`${o.id}-number`:o.id}return super.getSpecIdToLockIn(t,i)}isDegenerateInput(t){let{inputIndex:i,idMap:o}=this.model.getNonObjectsState().ui.currentTool;return this.getMode()==="directed-angle"&&i>0&&o[1]===t?o[1]===o[3]&&i===3:super.isDegenerateInput(t)}getPartialAnglePreviewInfo(){let{inputIndex:t,idMap:i}=this.model.getNonObjectsState().ui.currentTool;if(t>0){let o=this.model.findDefsForInputId(i[1])[0];if(!o)return;let n=[o.typedRuntimeValue],a=this.model.findDefsForInputId(i[2])[0],s=this.model.findDefsForInputId(i[3])[0];if(a&&s&&n.push(a.typedRuntimeValue,s.typedRuntimeValue),o)return{id:i["angle-output"],type:"rotation-with-incomplete-angle",args:n}}}getSpec(){let t={inputs:[{type:"point",id:"1",hint:g7},{type:"union",valueTypes:[__dcg_shared_module_exports__['va'],__dcg_shared_module_exports__['Ra']],id:"2",hint:Jse,numberInputInfo:{defaultLatex:"",sliderInfo:{value:this.model.controller.isDegreeMode()?"90":"1.57079632679",min:"0",max:this.model.controller.isDegreeMode()?"360":"2\\pi"}}}],outputs:[]},i={id:"number-output",type:"rotate",hidden:this.getMode()!=="number",name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2-number"}]};if(this.getMode()==="directed-angle"){let{idMap:o,inputIndex:n}=this.model.getNonObjectsState().ui.currentTool;n>1&&delete t.inputs[1].numberInputInfo;let a=o[2],s=!1,l=a&&this.model.findDefsForInputId(a)[0];s=!!(l&&l.typedRuntimeValue.valueType==__dcg_shared_module_exports__['va']),s?(t.inputs.push({type:"point",id:"3",hint:Qse},{type:"point",id:"4",hint:Zse}),t.outputs.push({id:"directed-angle",type:"directedangle",hidden:!1,showAngleLabel:!1,parents:[{type:"reference-input",id:"2"},{type:"reference-input",id:"3"},{type:"reference-input",id:"4"}]},{id:"angle-output",type:"rotate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"directed-angle"}]})):t.outputs.push({id:"angle-output",type:"rotate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]})}else t.outputs.push(i);return t}};var ele=tn().reflectionArc,tle=14,m7=2.5,rle=40,ile=15,ole=.75,nle=1;function Xg(r){return r.valueType===__dcg_shared_module_exports__['va']?r.value:r.valueType===__dcg_shared_module_exports__['za']?r.value[0]:void 0}function ale(r){return r.valueType===__dcg_shared_module_exports__['Va']?r.value:r.valueType===__dcg_shared_module_exports__['Wa']?r.value[0]:void 0}function sle(r){return r.valueType===__dcg_shared_module_exports__['La']||r.valueType===__dcg_shared_module_exports__['Na']||r.valueType===__dcg_shared_module_exports__['Fa']||r.valueType===__dcg_shared_module_exports__['Va']?{segment:r.valueType===__dcg_shared_module_exports__['Fa'],value:r.value}:r.valueType===__dcg_shared_module_exports__['Ma']||r.valueType===__dcg_shared_module_exports__['Oa']||r.valueType===__dcg_shared_module_exports__['Ga']||r.valueType===__dcg_shared_module_exports__['Wa']?{segment:r.valueType===__dcg_shared_module_exports__['Ga'],value:r.value[0]}:void 0}function f7(r){return r.valueType===__dcg_shared_module_exports__['ua']?r.value:r.valueType===__dcg_shared_module_exports__['xa']?r.value[0]:void 0}function b7(r){return r.valueType===__dcg_shared_module_exports__['Ra']?r.value:r.valueType===__dcg_shared_module_exports__['Sa']?r.value[0]:void 0}var L1=class{constructor(e){this.controller=e.controller}getTransformationPreviewInfoFromItem(e,t){var n;if(e.type!=="expression"||e.hidden)return;let{translationsWithVisibleVectorParent:i}=t.transformationPreviewParentData;if(i.has(e.id))return;let o=(n=e.formula.geometry)==null?void 0:n.transformation_preview_info;if(o)return{...o,id:e.id}}getInprogressTransformation(e){let t=this.controller.getAllToolPreviewItems();for(let o of t){let n=this.getTransformationPreviewInfoFromItem(o,e);if(n)return n}let i=this.controller.getGeoModel().getCurrentTool();if(i instanceof Bf)return i.getPartialAnglePreviewInfo()}getHoveredOrSelectedTransformations(e){let t=this.controller.getAllSelectedItems(),i=this.controller.getHoveredOrFocusedTokenIdentifier(),o=i?this.controller.getItemsByIdentifier(i)[0]:void 0;o&&!t.some(a=>a.id===o.id)&&t.push(o);let n=[];return t.forEach(a=>{if(a.type!=="expression")return;let s=this.getTransformationPreviewInfoFromItem(a,e);s&&n.push(s)}),n}drawTranslationPreview(e,t,i,o){let n=t.mapx(i[0]),a=t.mapy(i[1]),s=t.mapx(o[0]),l=t.mapy(o[1]);e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=5,e.moveTo(n,a),e.lineTo(s,l),Kd(e,n,a,s,l,20),e.stroke(),e.restore()}drawReflectionPreview(e,t,i){let o=i.value,n=i.segment,[a,s,l,c]=Df([o[0][0],o[0][1],o[1][0],o[1][1]],t,18).clipped,d=(a+l)/2,p=(s+c)/2;if(n){let[C,S,v,M]=Df([o[0][0],o[0][1],o[1][0],o[1][1]],t,17).clipped;d=(C+v)/2,p=(S+M)/2}if(isNaN(d)&&isNaN(p))return;let g=40,h=g/__dcg_shared_module_exports__['da'](a-l,s-c),f=d+(c-s)*h,y=p-(l-a)*h,x=d-(c-s)*h,E=p+(l-a)*h;if(e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=4,e.moveTo(a,s),e.lineTo(l,c),ele){let C=Math.atan2(y-p,f-d),S=g,v=g*.7;e.moveTo(f,y),e.ellipse(d,p,S,v,C,0,Math.PI,!1);let M=.35,A=C+Math.PI/2+M,I=C+Math.PI/2-M;Kd(e,f+Math.cos(A),y+Math.sin(A),f,y,10),Kd(e,x+Math.cos(I),E+Math.sin(I),x,E,10)}else e.moveTo(f,y),e.lineTo(x,E),Kd(e,d,p,f,y,10),Kd(e,d,p,x,E,10);e.stroke(),e.restore()}drawDilationPreview(e,t,i,o){e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=3;let n=o<.6||o>1.4&&o<2?6:10,a=t.pixelsToMath.mapX(25)-t.pixelsToMath.mapX(0);[[a,0],[0,a],[-a,0],[0,-a]].forEach(s=>{let l=[i[0]+s[0],i[1]+s[1]],c=__dcg_shared_module_exports__['_b'](__dcg_shared_module_exports__['Xb'](i,o),l),[d,p]=t.map_xy_pairs(l),[g,h]=t.map_xy_pairs(c);e.moveTo(d,p),e.lineTo(g,h),Kd(e,d,p,g,h,n)}),e.stroke(),e.restore()}drawRotationPreview(e,t,i,o,n,a){if(this.drawRotationCenterPreview(e,t,i),!(n===void 0||!isFinite(n))){if(a!==void 0&&a!==0&&isFinite(a)){if(o&&o[0]===i[0]&&o[1]===i[1])return;this.drawFullRotationAngle(e,t,i,n,a,!1)}else if(o){this.drawPlaceholderRotationAngle(e,t,o,n);return}}}drawFullRotationAngle(e,t,i,o,n,a){e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=m7;let s=rle,l=-o,c=-n,d,p;if(a){let E=Df([i[0],i[1],i[0]+Math.cos(o),i[1]+Math.sin(o)],t,19).clipped;d=E[0],p=E[1];let C=Df([i[0],i[1],i[0]+Math.cos(o+n),i[1]+Math.sin(o+n)],t,19).clipped;e.moveTo(d,p),e.lineTo(E[2],E[3]),e.moveTo(d,p),e.lineTo(C[2],C[3]);let S=s*Math.abs(c),v=.5*(1-ole)*S,M=Math.min(v,ile),A=(c>0?1:-1)*M/s;l+=A,c-=2*A}else[d,p]=t.map_xy_pairs(i);let g=c<=0,h=d+s*Math.cos(l),f=p+s*Math.sin(l),y=d+s*Math.cos(l+c),x=p+s*Math.sin(l+c);e.moveTo(h,f),e.arc(d,p,s,l,l+c,g),GO(e,y,x,l,c,10,s),e.stroke(),e.restore()}drawPlaceholderRotationAngle(e,t,i,o){e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=nle;let n=-o,[a,s]=t.map_xy_pairs(i);e.moveTo(a,s);let l=1.5*Lg(0,t);e.lineTo(a+l*Math.cos(n),s+l*Math.sin(n)),e.stroke(),e.restore()}drawRotationCenterPreview(e,t,i){let[o,n]=t.map_xy_pairs(i);e.save(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=m7,e.beginPath(),e.arc(o,n,tle,0,2*Math.PI),e.stroke(),e.restore()}redrawToCtx(e){let{ctx:t,projection:i}=e,o=this.getInprogressTransformation(e),n=this.getHoveredOrSelectedTransformations(e);o&&n.push(o);for(let a=0;a<n.length;a++){let s=n[a],l=s.args;switch(s.type){case"translate":if(l.length===2){let c=Xg(l[0]),d=Xg(l[1]);c&&d&&this.drawTranslationPreview(t,i,c,d)}else if(l.length===1){let c=ale(l[0]);if(c){let[d,p]=Nf(c);this.drawTranslationPreview(t,i,d,p)}}break;case"reflect":{let c=sle(l[0]);c&&this.drawReflectionPreview(t,i,c)}break;case"dilate":{let c=Xg(l[0]),d=f7(l[1]);c&&d!==void 0&&isFinite(d)&&d!==1&&this.drawDilationPreview(t,i,c,d)}break;case"rotate":{let c=Xg(l[0]);if(!c)return;let d=f7(l[1]),p=b7(l[1]),g,h;if(d!==void 0)h=this.controller.isDegreeMode()?d*Math.PI/180:d,g=0;else if(p)g=p[1],h=p[2],e.transformationPreviewParentData.rotationsWithVisibleAndCenteredAngle.has(s.id)&&(h=void 0);else return;this.drawRotationPreview(t,i,c,p?p[0]:void 0,g,h)}break;case"rotation-with-incomplete-angle":{let c=Xg(l[0]);if(!c)return;let d,p;if(l.length>=3){let g=Xg(l[1]);if(d=Xg(l[2]),!c||!g||!d)return;let h=g[0]-d[0],f=g[1]-d[1];p=Math.atan2(f,h)}this.drawRotationPreview(t,i,c,d,p,void 0)}}}}};function y7(r){var c,d,p,g,h,f,y,x,E,C;let e=new Set,t=new Set,i=new Set,o=new Set,n={},a={};for(let S of[...r.getAllItemModels(),...r.getAllToolPreviewItems()]){if(S.type!=="expression"||ls(S))continue;let v=S.formula.typed_constant_value;if(!v)continue;if(__dcg_shared_module_exports__['ib'](v.valueType,__dcg_shared_module_exports__['Va'])){let A=(c=mn(S))==null?void 0:c.identifier;A&&(n[A]=S.id)}let M=b7(v);if(M){let A=(d=mn(S))==null?void 0:d.identifier;A&&(a[A]={id:S.id,value:M})}}let s=r.getHoveredOrFocusedTokenIdentifier(),l=[...r.getAllItemModels().filter(S=>{var v;if(r.isItemSelected(S.id))return!0;if(S.type==="expression"&&s){let M=(v=mn(S))==null?void 0:v.identifier;return s===M}return!1}),...r.getAllToolPreviewItems()];for(let S of l){if(S.type!=="expression")continue;let v=S.formula.geometry,M=v==null?void 0:v.transformation_preview_info;if(((p=v==null?void 0:v.call)==null?void 0:p.symbol)==="translate"&&(M==null?void 0:M.args.length)===1&&__dcg_shared_module_exports__['ib'](M.args[0].valueType,__dcg_shared_module_exports__['Va'])){let A=(f=(h=(g=S.formula.geometry)==null?void 0:g.call)==null?void 0:h.parents)==null?void 0:f[0];if(!A)continue;let I=n[A[0]];I&&(e.add(S.id),t.add(I))}if(((y=v==null?void 0:v.call)==null?void 0:y.symbol)==="rotate"&&(M!=null&&M.args)&&(M==null?void 0:M.args.length)>1&&__dcg_shared_module_exports__['ib'](M.args[1].valueType,__dcg_shared_module_exports__['Ra'])){let A=(C=(E=(x=S.formula.geometry)==null?void 0:x.call)==null?void 0:E.parents)==null?void 0:C[1];if(!A)continue;let I=a[A[0]];if(!I)continue;o.add(I.id);let P=Xg(M.args[0]);if(!P)continue;I.value[0][0]===P[0]&&I.value[0][1]===P[1]&&i.add(S.id)}}return{translationsWithVisibleVectorParent:e,translationPreviewVectorParents:t,rotationsWithVisibleAndCenteredAngle:i,rotationPreviewAngleMarkerParents:o}}var{floor:Uf,ceil:zf,round:lle,log10:P1,log2:x7,abs:Qg}=Math,Jg=r=>YD?`rgba(255,255,255,${r})`:`rgba(0,0,0,${r})`,R1=class{redrawToCtx(e,t){let{ctx:i,projection:o}=e;Ms(i,"graphpaper");let n=o.settings.showGrid&&!o.settings.threeDMode;if(o.settings.polarMode&&n){let a=IH(o);Ms(i,"grid"),this.drawPolarGrid(i,o,a),Is(i),Ms(i,"axis"),this.drawAxes(i,o,t);let s=this.drawPolarStepNumbers(i,o,a);this.drawLabels(i,o,s),Is(i)}else{let a=Qc(o),s=j2(o);n&&(Ms(i,"grid"),this.drawCartesianGrid(i,o,a,s),Is(i));let l=!n&&!o.settings.threeDMode;Ms(i,"axis"),o.settings.threeDMode||this.drawAxes(i,o,t);let c=this.drawCartesianStepNumbers(i,o,a,l,s);this.drawLabels(i,o,c),Is(i)}Is(i)}addTextShadow(e,t){let{threeDMode:i,showPlane3D:o}=t.settings;e.strokeStyle=t.settings.getBackgroundColor({invertWhite:i}),e.lineWidth=3,i&&(!o||t.settings.invertedColors)&&(e.lineWidth=1.5),e.miterLimit=2}drawPolarGrid(e,t,i){e.save();let o=t.settings.minorAxisOpacity,a=1-(1-t.settings.majorAxisOpacity)/(1-o),s=__dcg_shared_module_exports__['ka'](t.mapx(0)),l=__dcg_shared_module_exports__['ka'](t.mapy(0)),c=t.screen.height/(t.viewport.ymax-t.viewport.ymin),d=t.screen.width/(t.viewport.xmax-t.viewport.xmin),p=c/d,g=d/c,h=l/p,f=t.viewport.smallestR(),y=t.viewport.largestR(),x=i.minorStepR*Math.max(1,Math.floor(f/i.minorStepR)),E=i.majorStepR*Math.max(1,Math.floor(f/i.majorStepR));e.lineWidth=1,e.strokeStyle=Jg(o);for(let S of Vs(x,y,i.minorStepR)){Po(e,"dcg-svg-minor-gridline"),e.beginPath(),fo(e),e.scale(1,p);let v=t.mapx(S)-s;e.moveTo(s+v,h),e.arc(s,h,v,0,2*Math.PI),e.scale(1,g),e.stroke()}let C=f>0?5:15;for(let S of Vs(0,359,C)){if((S===0||S===180)&&t.settings.showXAxis||(S===90||S===270)&&t.settings.showYAxis)continue;Po(e,"dcg-svg-minor-gridline"),e.beginPath(),fo(e),e.moveTo(s,l);let v=t.mapx(y*Math.cos(S*Math.PI/180)),M=t.mapy(y*Math.sin(S*Math.PI/180));e.lineTo(__dcg_shared_module_exports__['ka'](v),__dcg_shared_module_exports__['ka'](M)),e.stroke()}e.lineWidth=1,e.strokeStyle=Jg(a);for(let S of Vs(E,y,i.majorStepR)){Po(e,"dcg-svg-major-gridline"),e.beginPath(),fo(e),e.scale(1,p);let v=t.mapx(S)-s;e.moveTo(s+v,h),e.arc(s,h,v,0,2*Math.PI),e.scale(1,g),e.stroke()}e.restore()}drawCartesianGrid(e,t,i,o=j2(t)){e.save();let{xmin:n,xmax:a,ymin:s,ymax:l}=t.viewport,c=t.screen.width,d=t.screen.height,p=d,g=0;t.settings.restrictGridToFirstQuadrant&&(n=0,s=0,p=t.mapy(0),g=t.mapx(0));let h=t.settings.minorAxisOpacity*o.x.unitOpacity,f=t.settings.minorAxisOpacity*o.y.unitOpacity,y=t.settings.majorAxisOpacity;e.lineWidth=1;let x=O=>{if(O===0&&t.settings.showYAxis)return;let q=__dcg_shared_module_exports__['ka'](t.mapx(O));q===__dcg_shared_module_exports__['ka'](0)||q===__dcg_shared_module_exports__['ka'](c)||(e.beginPath(),e.moveTo(q,0),e.lineTo(q,p),e.stroke())},E=O=>{if(O===0&&t.settings.showXAxis)return;let q=__dcg_shared_module_exports__['ka'](t.mapy(O));q===__dcg_shared_module_exports__['ka'](0)||q===__dcg_shared_module_exports__['ka'](d)||(e.beginPath(),e.moveTo(g,q),e.lineTo(c,q),e.stroke())};Po(e,"dcg-svg-minor-gridline");let{majorStepX:C,majorStepY:S,minorStepX:v,minorStepY:M}=i,A=t.settings.xAxisScale==="logarithmic",I=t.settings.yAxisScale==="logarithmic",P=A?o.x.minor:Vs(n,a,v),_=I?o.y.minor:Vs(s,l,M);e.strokeStyle=Jg(h);for(let O of P)x(O);e.strokeStyle=Jg(f);for(let O of _)E(O);fo(e);let U=1-(1-y)/(1-h),Y=1-(1-y)/(1-f);Po(e,"dcg-svg-major-gridline");let R=A?o.x.major:Vs(n,a,C),H=I?o.y.major:Vs(s,l,S);e.strokeStyle=Jg(U);for(let O of R)x(O);e.strokeStyle=Jg(Y);for(let O of H)E(O);fo(e),e.restore()}drawAxes(e,t,i){let o=t.settings.axisLineOffset,n=t.settings.axisOpacity,a=`rgba(127,205,230,${n.toString()})`,s=Jg(n),l=t.settings.xAxisArrowMode,c=t.settings.yAxisArrowMode,d=t.settings.showXAxis,p=t.settings.showYAxis,g=1,h=Math.round(t.mapx(0))-o,f=Math.round(t.mapy(0))-o,y=t.screen.height,x=t.screen.width;function E(v,M,A){e.save();let I=Math.PI/12,P=8*Math.max(e.lineWidth,1.5);e.lineJoin="round",e.fillStyle=s,e.strokeStyle=s,e.beginPath(),e.moveTo(v,M),e.lineTo(v+Math.cos(A-I)*P,M+Math.sin(A-I)*P),e.lineTo(v+Math.cos(A+I)*P,M+Math.sin(A+I)*P),e.lineTo(v,M),e.lineTo(v+Math.cos(A-I)*P,M+Math.sin(A-I)*P),e.stroke(),e.fill(),e.restore()}let C=y,S=0;t.settings.restrictGridToFirstQuadrant&&(C=f,S=h,l==="BOTH"&&(l="POSITIVE"),c==="BOTH"&&(c="POSITIVE")),p&&(Ms(e,"yaxis"),t.settings.takingScreenshot&&_C(e,t.settings.yAxisLabel||"Y axis"),e.save(),Po(e,"dcg-svg-axis-line"),e.lineWidth=t.settings.axisLineWidth*(i==="y"?g:1),e.strokeStyle=i==="y"?a:s,c==="BOTH"?(e.beginPath(),e.moveTo(h,2*t.settings.axisLineWidth),e.lineTo(h,y-2*t.settings.axisLineWidth),e.stroke(),E(h,y-t.settings.axisLineWidth,3*Math.PI/2),E(h,t.settings.axisLineWidth,Math.PI/2)):c==="POSITIVE"?(e.beginPath(),e.moveTo(h,2*t.settings.axisLineWidth),e.lineTo(h,C),e.stroke(),E(h,t.settings.axisLineWidth,Math.PI/2)):(e.beginPath(),e.moveTo(h,0),e.lineTo(h,C),e.stroke()),fo(e),e.restore(),Is(e)),d&&(Ms(e,"xaxis"),t.settings.takingScreenshot&&_C(e,t.settings.xAxisLabel||"X axis"),e.save(),Po(e,"dcg-svg-axis-line"),e.lineWidth=t.settings.axisLineWidth*(i==="x"?g:1),e.strokeStyle=i==="x"?a:s,l==="BOTH"?(e.beginPath(),e.moveTo(2*t.settings.axisLineWidth,f),e.lineTo(x-2*t.settings.axisLineWidth,f),e.stroke(),E(t.settings.axisLineWidth,f,0),E(x-t.settings.axisLineWidth,f,Math.PI)):l==="POSITIVE"?(e.beginPath(),e.lineTo(S,f),e.lineTo(x-2*t.settings.axisLineWidth,f),e.stroke(),E(x-t.settings.axisLineWidth,f,Math.PI)):(e.beginPath(),e.lineTo(S,f),e.lineTo(x,f),e.stroke()),fo(e),e.restore(),Is(e))}drawPolarStepNumbers(e,t,i){e.save();let o=t.settings.showGrid,n=t.settings.xAxisNumbers&&t.settings.showXAxis,a=t.settings.yAxisNumbers&&t.settings.showYAxis,s=o&&t.settings.polarNumbers,l=t.viewport.largestR(),c=t.viewport.smallestR(),d=t.viewport.xmin,p=t.viewport.xmax,g=t.viewport.ymin,h=t.viewport.ymax,f=t.screen.width,y=t.screen.height,x={left:3,right:f-3,top:3,bottom:y-3},E=t.settings.labelHangingColor,C=t.settings.getTextColor(),S=t.settings.labelSize,v=S;this.addTextShadow(e,t),e.fillStyle=C;function M(w,T,B){let de=Math.sqrt(w*w-T*T);g<=de&&de<=h&&B.push({x:t.mapx(T),y:t.mapy(de)}),g<=-de&&-de<=h&&B.push({x:t.mapx(T),y:t.mapy(-de)})}function A(w,T,B){let de=Math.sqrt(w*w-T*T);d<=de&&de<=p&&B.push({x:t.mapx(de),y:t.mapy(T)}),d<=-de&&-de<=p&&B.push({x:t.mapx(-de),y:t.mapy(T)})}let I=t.mapx(0),P=t.mapy(0),_=g<=0&&0<=h,U=d<=0&&0<=p,Y=_&&n,R=U&&a,H="";if(!Y&&!R&&o){let w=Qg(I),T=Qg(I-f),B=Qg(P),de=Qg(P-y),F,j,pe,le;w<=T?(F="left",pe=w):(F="right",pe=T),B<=de?(j="top",le=B):(j="bottom",le=de),n&&a?H=pe<=le?F:j:a?H=F:n&&(H=j)}let O={left:0,right:f,top:P-1,bottom:P+1},q={left:I-1,right:I+1,top:0,bottom:y};for(let w of Vs(0,l,i.majorStepR)){let T=[],B=[],de=[],F=new Hs(__dcg_shared_module_exports__['ob'](w,l),S),j=F.getRect();switch(w>0?(R&&g<=w&&w<=h&&B.push({x:I-j.right-5,y:t.mapy(w)}),R&&g<=-w&&-w<=h&&B.push({x:I-j.right-5,y:t.mapy(-w)}),Y&&d<=w&&w<=p&&T.push({x:t.mapx(w),y:P-j.top+3}),Y&&d<=-w&&-w<=p&&T.push({x:t.mapx(-w),y:P-j.top+3})):R&&!n&&g<=w&&w<=h?B.push({x:I-j.right-5,y:t.mapy(w)}):Y&&!a&&d<=w&&w<=p&&T.push({x:t.mapx(w),y:P-j.top+3}),H){case"top":A(w,h,de);break;case"bottom":A(w,g,de);break;case"left":M(w,d,de);break;case"right":M(w,p,de);break}T.forEach(function(pe){pe=F.clampBoundsWithinRect(pe,x),F.drawCenteredAt(e,pe,"dcg-svg-axis-value"),_1(O,F.getRectWhenCenteredAt(pe))}),B.forEach(function(pe){pe=F.clampBoundsWithinRect(pe,x),F.drawCenteredAt(e,pe,"dcg-svg-axis-value"),_1(q,F.getRectWhenCenteredAt(pe))}),de.forEach(function(pe){pe=F.clampBoundsWithinRect(pe,x),F.drawCenteredAt(e,pe,"dcg-svg-axis-value")})}if(s){let w=Math.ceil(c/i.majorStepR),T=Math.floor(l/i.majorStepR),de=Math.ceil((w+T)/2)*i.majorStepR,F=c>0?15:30;for(let j of Vs(0,359,F)){let pe;t.settings.degreeMode?pe=j.toString()+"\xB0":pe=__dcg_shared_module_exports__['ob'](j*Math.PI/180,2*Math.PI).string;let le=e.measureText(pe).width/2,ne=de/1.05,X=ne*Math.cos(j*Math.PI/180),ae=ne*Math.sin(j*Math.PI/180);if(X<d||X>p||ae<g||ae>h)continue;let J=t.mapx(X),ge=t.mapy(ae);j===0||j===180?ge-=v:(j===90||j===270)&&(J+=le+3);let be=__dcg_shared_module_exports__['Cb'](J,3+le,f-3-le),Ee=__dcg_shared_module_exports__['Cb'](ge,3+v,y-3-v);Ee=Hs.computeBaselineFromCenter(Ee,S),Po(e,"dcg-svg-polar-axis-value"),e.save(),fo(e),e.fillStyle=E,Hs.setCtxFontSize(e,S),e.strokeText(pe,be,Ee),e.fillText(pe,be,Ee),e.restore()}}return e.restore(),{x:O,y:q}}drawLabels(e,t,i){let o=t.viewport.xmin,n=t.viewport.xmax,a=t.viewport.ymin,s=t.viewport.ymax,l=t.screen.width,c=t.screen.height,d=(n-o)/l,p=(s-a)/c,g=t.settings.getTextColor(),h=t.mapx(0),f=t.mapy(0),y=t.settings.labelSize,x=15,E=t.settings.showXAxis&&t.settings.xAxisLabel,C=t.settings.showYAxis&&t.settings.yAxisLabel,S=i.x,v=i.y;if(E&&S){Po(e,"dcg-svg-axis-label"),e.save(),fo(e),e.fillStyle=g;let M;if(e.__xLabelOffset&&t.settings.isViewportTransient&&O1(e.__xLabelOffset.xscale,d)&&O1(e.__xLabelOffset.yscale,p)&&(M={x:e.__xLabelOffset.x+h,y:e.__xLabelOffset.y+f}),this._setAxisLabelFont(e,E,y,t),!M){let A=e.measureText(E).width,I=l-A-x,P=y;S.bottom+P<c?M={x:I,y:S.bottom+P}:M={x:I,y:S.top-P/2},e.__xLabelOffset={x:M.x-h,y:M.y-f,xscale:d,yscale:p}}e.strokeText(E,M.x,M.y),e.fillText(E,M.x,M.y),e.restore()}else e.__xLabelPosition=null;if(C&&v){Po(e,"dcg-svg-axis-label"),e.save(),fo(e),e.fillStyle=g;let M;if(e.__yLabelOffset&&t.settings.isViewportTransient&&O1(e.__yLabelOffset.xscale,d)&&O1(e.__yLabelOffset.yscale,p)&&(M={x:e.__yLabelOffset.x+h,y:e.__yLabelOffset.y+f}),this._setAxisLabelFont(e,C,y,t),!M){let A=e.measureText(C).width,I=y,P=A+5;if(!this._isShortMathyLabel(C)){let U=A;A=I,I=U,P=A*.5}let _=0+x+I;v.left-A>0?M={x:v.left-P,y:_}:M={x:v.right+A,y:_},e.__yLabelOffset={x:M.x-h,y:M.y-f,xscale:d,yscale:p}}e.translate(M.x,M.y),this._isShortMathyLabel(C)||e.rotate(-Math.PI/2),e.strokeText(C,0,0),e.fillText(C,0,0),e.restore()}else e.__yLabelPosition=null}_isShortMathyLabel(e){return e.trim().match(/^([a-zA-Z]?)\(?([a-zA-Z]?)\)?$/)}_setAxisLabelFont(e,t,i,o){this.addTextShadow(e,o),this._isShortMathyLabel(t)?e.font="italic "+Math.round(i*1.4)+"px Times":e.font=Math.round(i*1.2)+"px Arial"}drawCartesianStepNumbers(e,t,i,o,n=j2(t)){e.save();let{showXAxis:a,showYAxis:s}=t.settings,l=a&&t.settings.xAxisNumbers,c=s&&t.settings.yAxisNumbers,{xmin:d,xmax:p,ymin:g,ymax:h}=t.viewport,f=t.screen.width,y=t.screen.height,x={left:3,top:3,right:f-3,bottom:y-3};t.settings.restrictGridToFirstQuadrant&&(d=0,g=0);let E=t.settings.getTextColor({invertBlack:t.settings.threeDMode}),C=t.settings.threeDMode?E:t.settings.labelHangingColor,S=t.mapx(0),v=t.mapy(0),M=t.settings.labelSize;this.addTextShadow(e,t);let A={left:0,right:f,top:v-1,bottom:v+1},I={left:S-1,right:S+1,top:0,bottom:y};if(t.settings.threeDMode&&!t.settings.showNumbers3D)return{x:A,y:I};let P=5,_=!1;if(a&&s&&(l||c)){_=!0,e.fillStyle=E;let O=new Hs(__dcg_shared_module_exports__['ob'](0,1),M);O.drawCenteredAt(e,{x:S-O.getRect().right-P,y:v-O.getRect().top+P},"dcg-svg-axis-value")}let{majorStepX:U,majorStepY:Y}=i,R=[],H=[];if(l){let O=t.settings.xAxisScale==="logarithmic",q=O?n.x.label:Vs(d,p,U);for(let w of q){let T=O?void 0:p-d,B=__dcg_shared_module_exports__['ob'](w,T,O),de=new Hs(B,M);de.getString()==="0"&&_||R.push(de)}}if(c){let O=t.settings.yAxisScale==="logarithmic",q=O?n.y.label:Vs(g,h,Y);for(let w of q){let T=O?void 0:h-g,B=__dcg_shared_module_exports__['ob'](w,T,O),de=new Hs(B,M);de.getString()==="0"&&_||H.push(de)}}if(o){e.save(),Po(e,"dcg-svg-tickmark");let O=t.settings.axisLineOffset,q=t.settings.axisOpacity,w=Jg(q);e.lineWidth=t.settings.axisLineWidth,e.strokeStyle=w;let T=Math.round(t.mapy(0))-O,B=Math.round(t.mapx(0))-O,de=Math.round(2*e.lineWidth)-O;e.beginPath(),R.forEach(function(F){let j=Math.round(t.mapx(F.getValue()))-O;e.moveTo(j,T-de),e.lineTo(j,T+de)}),H.forEach(function(F){let j=Math.round(t.mapy(F.getValue()))-O;e.moveTo(B-de,j),e.lineTo(B+de,j)}),e.stroke(),fo(e),e.restore()}return R.forEach(function(O){let q={x:t.mapx(O.getValue())-.5*O.getMinusWidth(),y:v-O.getRect().top+P},w=O.clampBoundsWithinRect(q,x);e.fillStyle=q.y===w.y||t.settings.yAxisScale==="logarithmic"?E:C;let T="dcg-svg-axis-value";q.x!==w.x&&(T+=" dcg-svg-offcenter-axis-value"),O.drawCenteredAt(e,w,T),_1(A,O.getRectWhenCenteredAt(w)),fo(e)}),H.forEach(function(O){let q={x:S-P-O.getRect().right,y:t.mapy(O.getValue())},w=O.clampBoundsWithinRect(q,x);e.fillStyle=q.x===w.x||t.settings.xAxisScale==="logarithmic"?E:C;let T="dcg-svg-axis-value";q.y!==w.y&&(T+=" dcg-svg-offcenter-axis-value"),O.drawCenteredAt(e,w,T),_1(I,O.getRectWhenCenteredAt(w)),fo(e)}),e.restore(),{x:A,y:I}}};function Vs(r,e,t){let i=Math.ceil(r/t),o=Math.floor(e/t);if(!cle({nmin:i,nmax:o}))return[];let n=[];for(var a=i;a<=o;a++)n.push(a*t);return n}var cle=({nmin:r,nmax:e})=>isFinite(e-r)&&e-r<=1e4;function j2(r){return{x:w7("x",r),y:w7("y",r)}}function w7(r,e){let t=new Set,i=new Set,o=new Set,n=1;function a(le){return S?e.mapx(le):e.mapy(le)}function s(le,ne){return Qg(a(ne)-a(le))}let l=(le,ne)=>{let X=le*ne,ae=(le+1)*ne;if(X<v&&ae<v||X>M&&ae>M)return;let J=le>=5?s(7*ne,8*ne):le>=2?s(3*ne,4*ne):s(ne,2*ne),ge=J/s(X,ae);if(J<40)return;let be={settings:{pixelsPerLabel:e.settings.pixelsPerLabel*ge,labelSize:e.settings.labelSize,xAxisNumber:e.settings.xAxisNumbers,yAxisNumber:e.settings.yAxisNumbers},screen:{width:J,height:J},viewport:{xmin:X,ymin:X,xmax:ae,ymax:ae}},{minorStepX:Ee,majorStepX:Le}=Qc(be),Se=Math.max(X,v),et=Math.min(ae,M);for(let Z=Uf(Se/Ee);Z<zf(et/Ee);Z++)o.add(Z*Ee);for(let Z=Uf(Se/Le);Z<zf(et/Le);Z++){let W=Z*Le;W<=X||W>=ae||(i.add(W),t.add(W))}},c={label:[],major:[],minor:[],unitOpacity:1},{xAxisScale:d,yAxisScale:p,pixelsPerLabel:g}=e.settings,{xmin:h,xmax:f,ymin:y,ymax:x}=e.viewport,{width:E,height:C}=e.screen,S=r==="x",[v,M]=S?[h,f]:[y,x],A=S?E:C,I=S?d:p,P=e.settings.xAxisMinorSubdivisions!==0;if(I!=="logarithmic")return c;let _=Uf(P1(v)),U=zf(P1(M)),Y=zf(P1(M)-P1(v)),R=s(10**_,10**(_+1)),H=15,O=100,q=R>H,w=[];R>6.25*g&&(w=[2,3,4,6,8]),R>12*g&&(w=[2,3,4,5,6,7,8]),R>14*g&&(w=[2,3,4,5,6,7,8,9]);let T=w.length!=0;if(H<=R&&R<=O&&(n=Math.sqrt((R-H)/(O-H))),!isFinite(Y))return c;let B=Uf(A/g),de=Math.max(1,2**lle(x7(Y/B)));for(let le=zf(_/de);le<=Uf(U/de);le++)t.add(10**(le*de));i=new Set([...t]);let F=Uf(A/H),j=Math.max(1,2**zf(x7(Y/F)));for(let le=zf(_/j);le<=Uf(U/j);le++)(q?i:o).add(10**(le*j));if(q)for(let le=_;le<U;le++){let ne=10**le;for(let X of w)t.add(X*ne);if(T){for(let X=2;X<=9;X++)i.add(X*ne);for(let X=1;X<=9;X++)l(X,ne)}else for(let X=2;X<=9;X++)o.add(X*ne)}P&&(o=new Set);let pe=S?e.reverse_mapx(a(v)+g/4):e.reverse_mapy(a(v)-2*e.settings.labelSize);return{label:[...t].filter(le=>pe<=le&&le<=M),major:[...i].filter(le=>v<=le&&le<=M),minor:[...o].filter(le=>v<=le&&le<=M),unitOpacity:n}}function _1(r,e){e.left<r.left&&(r.left=e.left),e.right>r.right&&(r.right=e.right),e.top<r.top&&(r.top=e.top),e.bottom>r.bottom&&(r.bottom=e.bottom)}function O1(r,e){let t=Qg(r),i=Qg(e);return Qg(t-i)<=(t<i?i:t)*1e-4}var ru=__dcg_shared_module_exports__['e'](te()),F1=class extends ru.Class{template(){return ru.createElement("div",{class:ru.const("dcg-calculator-api-container"),style:()=>({width:this.props.width(),height:this.props.height(),position:"fixed",left:"0px",top:"0px"})},ru.createElement("div",{class:ru.const("dcg-container")},ru.createElement("div",{class:ru.const("dcg-grapher"),style:()=>({"font-size":this.props.concreteFontSize()})})))}};var Ys=__dcg_shared_module_exports__['e'](te());var{If:dle}=Ys.Components,N1=class extends Ys.Class{init(){this.grapher=this.props.grapher(),this.controller=this.grapher.controller,this.width=0,this.height=0,this.pixelRatio=0}getDevicePixelRatio(){return window.devicePixelRatio||1}template(){return Ys.createElement("div",{class:Ys.const("dcg-graph-outer"),didMount:e=>this.rootNode=e,manageFocus:this.const(ft({controller:this.controller,location:{type:"graph-paper"}}))},Ys.createElement("div",{tabindex:()=>this.getShiftTabElementTabIndex(),onFocus:()=>{let e=this.rootNode.getAttribute("aria-label")||"";this.rootNode.setAttribute("aria-label",""),this.rootNode.focus(),this.rootNode.setAttribute("aria-label",e),this.controller.get2dPOIController().handleTabEvent("prev")}}),Ys.createElement(dle,{predicate:()=>this.isIOSAndIframe()},()=>Ys.createElement("div",{style:Ys.const("width:1px; height:.5px; pointer-events:none; opacity: 0;"),"aria-hidden":Ys.const("true")},Ys.const("text"))),Ys.createElement("canvas",{class:Ys.const("dcg-graph-inner"),didMount:e=>{this.canvasNode=e,this.ctx=this.canvasNode.getContext("2d"),this.resize(0,0)},style:()=>({position:"relative",display:"block",outline:"none","-webkit-transform":this.isIOSAndIframe()?"translate3d(0,-.25px,0)":void 0})}))}getShiftTabElementTabIndex(){var t;return((t=this.rootNode)==null?void 0:t.getAttribute("tabindex"))!=="0"||this.controller.getActiveTool()!=="selection"||this.rootNode===document.activeElement?"-1":"0"}isIOSAndIframe(){return Fc&&Qu}resize(e,t,i){var o;i=i||this.getDevicePixelRatio(),!(e===this.width&&t===this.height&&i===this.pixelRatio)&&(this.width=e,this.height=t,this.canvasNode.style.width=e+"px",this.canvasNode.style.height=t+"px",this.canvasNode.setAttribute("width",""+e*i),this.canvasNode.setAttribute("height",""+t*i),this.pixelRatio=i,this.ctx=this.canvasNode.getContext("2d"),(o=this.ctx)==null||o.scale(i,i),this.update())}getAriaLabel(e){let t=[],{graphDescription:i}=this.grapher.settings.config;if(this.grapher.type==="3d"&&this.controller.is3dProduct())i!==void 0?t.push(i):(t.push(`${this.controller.s("graphing-calculator-narration-3d-graphpaper-label")}.`),t.push(QC(this.controller)));else if(this.grapher.type==="2d"&&!this.controller.is3dProduct()){let o=this.grapher.getAudioTrace();if(!o)return"";i!==void 0?t.push(i):(t.push(`${this.controller.s("graphing-calculator-narration-graphpaper-label")}.`),t.push(QC(this.controller)),e>0&&(o.getAudioTraceActive()||o.agNavigator.getFirstTraceableSketch({selectAssociatedExpression:!1})!==void 0&&(Ti?t.push(this.controller.s("graphing-calculator-narration-audio-instructions-enter-audio-trace-mac")):t.push(this.controller.s("graphing-calculator-narration-audio-instructions-enter-audio-trace-windows")))))}if(t.length)return t.join(" ").trim()}updateAria(e,t){let i=this.getAriaLabel(t);i!==void 0?(this.rootNode.setAttribute("role","img"),this.rootNode.setAttribute("aria-roledescription",this.controller.s("graphing-calculator-narration-graphpaper-label")),this.rootNode.setAttribute("aria-label",i),this.rootNode.setAttribute("aria-hidden",!e||!this.grapher.settings.config.graphpaper?"true":"false"),this.rootNode.setAttribute("tabindex",e&&this.grapher.settings.config.graphpaper&&this.grapher.settings.config.enableTabindex?"0":"-1")):["role","aria-roledescription","aria-label","aria-hidden","tabindex"].forEach(n=>this.rootNode.removeAttribute(n)),this.update()}speakAriaLabelAgain(){let e=this.rootNode.getAttribute("aria-label");e&&Te(e)}};var v7=__dcg_shared_module_exports__['e'](te());var Y2=class{constructor(e){this._layerClasses={};this._classLayers={};this.elt=e.elt,this.settings=e.settings,this.controller=e.controller,this.evaluator=e.evaluator,this.elt.style.overflow="hidden"}classLayers(e){var t,i;return(i=(t=this._classLayers)[e])!=null?i:t[e]=new Set}setLayerClass(e,t){var i=this._layerClasses[e];if(this._layerClasses[e]=t,i!==t){if(i){let o=this.classLayers(i);o.delete(e),o.size===0&&this.elt.classList.remove(i)}t&&(this.classLayers(t).add(e),this.elt.classList.add(t))}}},X2=class extends Y2{constructor(e){super(e),this.canvasLayer=v7.mountToNode(N1,this.elt,{grapher:()=>this}),this.elt.appendChild(this.canvasLayer.rootNode)}getImageData(e,t,i,o){var n;return(n=this.canvasLayer.ctx)==null?void 0:n.getImageData(e,t,i,o)}_setIsVisible(e){e!==this.isVisible&&(this.isVisible=e,e?this.controller.requestRedrawGraph():this.canvasLayer.resize(0,0))}getIsVisible(){return this.isVisible}},J2=class extends X2{setSketchOrder(e){__dcg_shared_module_exports__['E'](this.__sketchOrder,e)||(this.__sketchOrder=e,this.controller.requestRedrawGraph())}getSketchOrder(){return this.__sketchOrder}},Q2=class extends J2{constructor(t){super(t);this.__redrawRequested=!1;this.events=new Yr}redrawAllLayers(){this.__redrawRequested=!0}redrawAllLayersSynchronously(){return this._redrawAllLayers()}notifyAfterRedraw(t){if(!this.__redrawRequested)t();else{this.notifyAfterRedraw_i?this.notifyAfterRedraw_i++:this.notifyAfterRedraw_i=1;let i="redraw.notifyAfterRedraw"+this.notifyAfterRedraw_i;this.events.observeEvent(i,()=>{this.events.unobserveEvent(i),t()})}}},Z2=class extends Q2{getUserRequestedViewport(){return this._lastUserRequestedViewport}setUserRequestedViewport(e){this._lastUserRequestedViewportUpdateToken||(this._lastUserRequestedViewportUpdateToken=0),this._lastUserRequestedViewportUpdateToken+=1,this._lastUserRequestedViewport=__dcg_shared_module_exports__['Z'](e),this._afterViewportChange()}getCurrentViewport(){return this.viewportController.getViewport().toObject()}debounceUserRequestedViewportChange(){this.__debouncedViewportCommit||(this.__debouncedViewportCommit=__dcg_shared_module_exports__['A']((i,o)=>{if(!this.isDragging&&this._lastUserRequestedViewportUpdateToken===o){if(this._lastUserRequestedViewport){var n=di.fromObject(this._lastUserRequestedViewport),a=this.computeConcreteViewport(n);if(a.equals(i))return}this.controller.dispatch({type:"commit-user-requested-viewport",viewport:i})}},1e3));let e=this.getCurrentViewport();this.__debouncedViewportCommit(e,this._lastUserRequestedViewportUpdateToken)}},eR=class extends Z2{getState(e){let t={...this.getCurrentViewport()};this.controller.is3dProduct()||(delete t.zmin,delete t.zmax);let i={viewport:t};return this.settings.stateProperties.forEach(o=>{o!=="randomSeed"&&(!this.controller.is3dProduct()&&CU(o)||(i[o]=this.settings[o]))}),e.stripDefaults&&(i=__dcg_shared_module_exports__['ad'](Uc,i)),i}getUndoRedoDiffState(){let e=this.getUndoRedoFullState();return e.speed3D!==0&&delete e.worldRotation3D,e}getUndoRedoFullState(){let e={};return this.settings.stateProperties.forEach(t=>{e[t]=this.settings[t]}),e.viewport=this.getUserRequestedViewport(),e}},Hx=class extends eR{};function ple(){return new Ec(1024,768)}function C7(r){let{xAxisScale:e,yAxisScale:t}=r;return new di(...e==="linear"?[-Ag,Ag]:[10**-Vg,10**Vg],...t==="linear"?[-Ag,Ag]:[10**-Vg,10**Vg])}var Kf=class r extends Hx{constructor(t,i,o,n){super({elt:t,settings:i,controller:o,evaluator:n});this.type="2d";this.__screenRequested3D=new Ec(768,768);this.lastActiveToken={selected:void 0,hovered:void 0};let a=ple(),s=C7(i).squareYAxis(a,i);this.setUserRequestedViewport(s),this.__projection=new wl(a,s,i),this.markLabelsDirty=__dcg_shared_module_exports__['A'](()=>{this.evaluator.notifyWhenSynced(()=>{this.poiLabelsLayer.markLabelsDirty(),this.controller.requestRedrawGraph()})},300),this.poiController=new s1(this,i),this.viewportController=new c1(this,this.controller),this.showPOIDots=!0,this.graphSketches={},this.graphImages={},this.audioGraph=new m1(o,this),this.boxSelectLayer=new bT;var l=document.createElement("div");this.elt.appendChild(l),this.imageLayer=new sE(this),this.gridLayer=new R1,this.poiDotsLayer=new fT(this.controller),this.graphsLayer=new qp(this.controller,this.settings,p=>this.audioGraph.getExpressionAriaLabel(p)),this.transformationPreviewLayer=new L1(this),this.clickableObjectsLayer=new lE(this),this.movablePointsLayer=new KC(this);var c=document.createElement("div");this.elt.appendChild(c),this.poiLabelsLayer=dE.mountToNode(kx,c,{grapher:()=>this});var d=document.createElement("div");this.elt.appendChild(d),this.geoKeyboardCursorLayer=dE.mountToNode(yT,d,{grapher:()=>this}),this.traceLayer=this.poiLabelsLayer,this.scaleAxis=void 0}privateGetGridLayer(){return this.gridLayer}static copyGraphProperties(t,i){t=__dcg_shared_module_exports__['cd'](Uc,t);let o={...t};delete o.viewport;let n=i.validateSettings(o);for(let a in n)i.setProperty(a,n[a]);return t}remove(){this.elt.remove(),this.poiController.remove(),this.viewportController.remove(),this.audioGraph.remove()}tick(t){this.__redrawRequested&&this._redrawAllLayers(),this.__movablePointListener&&this.__movablePointListener()}registerMovablePointListener(t){this.__movablePointListener=t}deregisterMovablePointListener(){this.__movablePointListener=void 0}clear(){this.graphSketches={},this.graphImages={}}getGraphSketch(t){return this.graphSketches[t]}getGraphImage(t){return this.graphImages[t]}addGraphSketch(t){this.graphSketches[t.id]=t}removeGraphSketch(t){delete this.graphSketches[t]}addGraphImage(t){t.imageObj.width&&t.imageObj.height?(this.graphImages[t.id]=t,this.controller.requestRedrawGraph()):ie(t.imageObj).on("load.calc_load",()=>this.addGraphImage(t))}removeGraphImage(t){let i=this.graphImages[t];i&&ie(i.imageObj).off("load.calc_load"),delete this.graphImages[t],this.controller.requestRedrawGraph()}setBoxSelectRectangle(t){this.boxSelectRectangle=t,this.controller.requestRedrawGraph()}getProjection(){return this.__projection}_setProjection(t){this.__projection=t,this.controller.requestRedrawGraph()}getAudioTrace(){return this.audioGraph}getDefaultViewport(){let t=this.getProjection();return C7(this.settings).squareYAxis(t.screen,this.settings)}_updateScreenSize(t,i){if(t<=0||i<=0)return;let n=this.getProjection().screen;if(n.width===t&&n.height===i)return;let a=new Ec(t,i);this.viewportController.setScreen(a)}update(){let{top:t,left:i,width:o,height:n}=this.controller.computeMajorLayout().grapher,a=this.controller.isGraphPaperFocused()&&!this.poiController.keyboardAttentionManager.getKeyboardAttention()&&!this.controller.getSelectedGeoExpression()&&!this.geoKeyboardCursorLayer.showCursor()&&!this.controller.inAudioTraceMode();this.elt.classList.toggle("dcg-grapher-focused",a),this.controller.isThreeDMode()&&({width:o,height:n}=this.__screenRequested3D),o>0&&n>0?(this._setIsVisible(!0),this._updateScreenSize(o,n),aa(this.elt,{position:"absolute",left:i+"px",top:t+"px",width:o+"px",height:n+"px"})):this._setIsVisible(!1)}setActiveToken(t,i){var o=this.lastActiveToken[i];this.lastActiveToken[i]=t;var n=t&&this.getGraphSketch(t),a=o&&this.getGraphSketch(o);a!==n&&(a&&(i==="selected"?a.tokenSelected=!1:i==="hovered"&&(a.tokenHovered=!1)),n&&(i==="selected"?n.tokenSelected=!0:i==="hovered"&&(n.tokenHovered=!0))),this.controller.requestRedrawGraph()}deselectSketch(t){let i=this.getGraphSketch(t);i&&(i.selected=!1,i.showPOI=!1,i.showHighlight=!1)}selectSketch(t){let i=this.getGraphSketch(t);i&&(i.selected=!0,i.showPOI=this.controller.isTraceEnabled(),i.showHighlight=!0)}updateSketch(t,i){let o=this.getGraphSketch(t);if(!i.length){this.removeGraphSketch(t);return}let n=new Rx(t,i);i[0].graphMode!==15&&(n.color=i[0].color,i[0].style&&(n.style=i[0].style)),o&&n.updateFrom(o);let a=!!this.controller.getPropagatedSelectedIds()[t];n.selected=a,n.tokenHovered=t===String(this.lastActiveToken.hovered),n.tokenSelected=t===String(this.lastActiveToken.selected),n.showPOI=a&&this.controller.isTraceEnabled(),n.showHighlight=a,this.addGraphSketch(n)}updateIntersections(t,i){let o=this.getGraphSketch(t);o&&o.updateIntersections(i)}_clear(){let i=this.getProjection().screen;this.canvasLayer.resize(i.width,i.height),this.canvasLayer.ctx&&(this.canvasLayer.ctx.clearRect(0,0,i.width,i.height),this.controller.isThreeDMode()?this.controller.getInvertedColors()||(this.canvasLayer.ctx.fillStyle="rgba(255,255,255,0.001961)",this.canvasLayer.ctx.fillRect(0,0,i.width,i.height)):YD&&(this.controller.getInvertedColors()||(this.canvasLayer.ctx.fillStyle="rgb(0,0,0)",this.canvasLayer.ctx.fillRect(0,0,i.width,i.height))))}isDrawingPlaneFor3dMode(){return this.controller.showPlane3D()||this.controller.showNumbers3D()}createDrawContext(){if(this.canvasLayer.ctx)return{ctx:this.canvasLayer.ctx,projection:this.getProjection(),transformationPreviewParentData:y7(this.controller)}}_redrawAllLayers(){if(this.update(),!this.isVisible&&!this.isDrawingPlaneFor3dMode())return;this.__redrawRequested=!1;let t=Date.now();this._clear();let i=this.createDrawContext();this.audioGraph.recomputePoints(),this._recomputeClickableObjects(),this._redrawImageLayer(i),this._redrawGridLayer(i),this._redrawGraphsLayer(i),this._redrawPointsAndLabels(i),this._redrawTransformationPreviewLayer(i),this._redrawBoxSelectLayer(i),this._redrawGeoKeyboardCursorLayer(),this._updateCanvasLayerAria(),this.events.triggerEvent("redraw",Date.now()-t);let o=this.controller.getGrapher3d();this.isDrawingPlaneFor3dMode()&&o&&o.webglLayer.updatePlaneMap()}_redrawGridLayer(t){t&&this.gridLayer.redrawToCtx(t,this.scaleAxis)}_recomputeClickableObjects(){this.clickableObjectsLayer.redraw()}_redrawGraphsLayer(t){t&&this.graphsLayer.redrawToCtx(t,this.graphSketches,this.graphImages,this.__sketchOrder,this.poiLabelsLayer,this.clickableObjectsLayer)}_redrawTransformationPreviewLayer(t){t&&this.transformationPreviewLayer.redrawToCtx(t)}_redrawBoxSelectLayer(t){t&&this.boxSelectLayer.redrawToCtx(t,this.boxSelectRectangle)}_redrawGeoKeyboardCursorLayer(){this.geoKeyboardCursorLayer.update()}_updateCanvasLayerAria(){let t=0;for(let i in this.graphSketches)Sc(this.controller,this.graphSketches[i])&&(t+=1);this.canvasLayer.updateAria(this.isVisible,t)}_redrawPointsAndLabels(t){if(!t)return;let i=[];this.controller.isThreeDMode()||this.movablePointsLayer.redraw(t,i),this.showPOIDots&&!this.controller.isThreeDMode()&&this.poiDotsLayer.redrawToCtx(t,this.graphSketches,this.poiLabelsLayer,this.clickableObjectsLayer,this.__sketchOrder);let o=this.elt.getBoundingClientRect();if(this.controller.isThreeDMode())this.poiLabelsLayer.drawForScreenshot(t,t.ctx,this.size(),i);else{let n=this.controller.findEl(".dcg-overgraph-pillbox-elements"),a=this.controller.findEl(".dcg-graphpaper-branding");__dcg_shared_module_exports__['g']([n,a],s=>{if(!s)return;let l=s.getBoundingClientRect();i.push({left:l.left-o.left,top:l.top-o.top,right:l.right-o.left,bottom:l.bottom-o.top})}),this.poiLabelsLayer.redraw(t,this.size(),i)}}size(){let t=this.canvasLayer.ctx;if(!t)return{width:0,height:0};let i=t.canvas.getBoundingClientRect();return{width:i.width,height:i.height}}_redrawImageLayer(t){t&&(this.controller.isThreeDMode()||this.imageLayer.redrawToCtx(t,this.graphImages,this.__sketchOrder))}_parseScreenshotOpts(t){return tR(t,this.settings,this.getProjection().screen)}_syncScreenshotReturnCanvas(t){var i=document.createElement("canvas");if(t&&t.braille){let{embosserModel:o,brailleMode:n}=t.braille,a=Yg[o];i.width=a.width,i.height=a.height,p7(i,this,a,o,n)}else{let o=this._parseScreenshotOpts(t);i.width=o.width*o.targetPixelRatio,i.height=o.height*o.targetPixelRatio,this.screenshotToCanvas(i,t)}return i}screenshot(t){let i=this._syncScreenshotReturnCanvas(t),o=[],n=i.getContext("2d"),a=this.makeScreenshotProjection(t);return this.movablePointsLayer.drawForScreenshot(n,a,o,!!(t&&t.showMovablePoints)),i.toDataURL("image/png")}asyncScreenshot(t,i){let o=!1;!t.transparentBackground&&t.showLabels&&(t=__dcg_shared_module_exports__['Z'](t),t.transparentBackground=!0,o=!0);let n=this._syncScreenshotReturnCanvas(t),a=n.getContext("2d"),s=n,l=a;t&&t.format==="svg"&&(o=!1,t.transparentBackground&&(t=__dcg_shared_module_exports__['Z'](t),t.transparentBackground=!1),l=new TH(n.width,n.height),s={getContext:()=>l,width:n.width,height:n.height},this.screenshotToCanvas(s,t));let c=this.makeScreenshotProjection(t),d=[];if(this.movablePointsLayer.drawForScreenshot(l,c,d,!!(t&&t.showMovablePoints)),t.showLabels){var p=c.screen.width,g=c.screen.height,h=c.settings.labelSize||15,f=1;(p<200||g<200)&&(f=.9);let y=h*f+"px",x=document.createElement("div");x.classList.add("dcg-calculator-screenshot-labels-container"),dE.mountToNode(F1,x,{concreteFontSize:()=>y,width:()=>`${c.screen.width}px`,height:()=>`${c.screen.height}px`}),document.body.append(x);let E=dE.mountToNode(kx,x.querySelector(".dcg-grapher"),{grapher:()=>this}),C={width:c.screen.width,height:c.screen.height};E.drawForScreenshot({projection:c,ctx:a,transformationPreviewParentData:{translationPreviewVectorParents:new Set,translationsWithVisibleVectorParent:new Set,rotationPreviewAngleMarkerParents:new Set,rotationsWithVisibleAndCenteredAngle:new Set}},l,C,d),x.remove()}o&&(l.globalCompositeOperation="destination-over",l.fillStyle="#FFF",l.fillRect(0,0,s.width,s.height)),t&&t.format==="svg"?i(l.getSerializedSvg()):i(s.toDataURL("image/png"))}makeScreenshotProjection(t){let{width:i,height:o,settings:n}=this._parseScreenshotOpts(t),a=new Ec(i,o),s=this.getProjection().viewport;return this.settings.squareAxes&&(s=s.squareCrop(a,this.settings)),new wl(a,s,n)}screenshotToCanvas(t,i){let o=this._parseScreenshotOpts(i),{targetPixelRatio:n,transparentBackground:a}=o,s=t.getContext("2d");s.scale(n,n);let l=this.makeScreenshotProjection(i);l.settings.takingScreenshot=!0,Ms(s,"background"),Po(s,"dcg-svg-background"),a?s.clearRect(0,0,l.screen.width,l.screen.height):(s.fillStyle="white",s.fillRect(0,0,l.screen.width,l.screen.height)),fo(s),Is(s);let c={ctx:s,projection:l,transformationPreviewParentData:{translationPreviewVectorParents:new Set,translationsWithVisibleVectorParent:new Set,rotationPreviewAngleMarkerParents:new Set,rotationsWithVisibleAndCenteredAngle:new Set}};this.imageLayer.redrawToCtx(c,this.graphImages,this.__sketchOrder),this.gridLayer.redrawToCtx(c),this.graphsLayer.redrawToCtx(c,this.graphSketches,this.graphImages,this.__sketchOrder,this.poiLabelsLayer,this.clickableObjectsLayer,i)}speakGrapherFocusAriaLabel(){this.canvasLayer.speakAriaLabelAgain()}_afterViewportChange(){}setGrapherState(t,i){if((!i||!i.doNotClear)&&this.clear(),t=r.copyGraphProperties(t,this.settings),"viewport"in t){let o=di.fromObject(t.viewport);this.setUserRequestedViewport(o);let n=this.computeConcreteViewport(o);this.viewportController.setViewport(n)}this.controller.requestRedrawGraph()}computeConcreteViewport(t){let i=this.getProjection().screen;return this.settings.squareAxes&&!t.isSquare(i,this.controller.getAxisScaleSettings())?t.squareYAxis(i,this.settings):t}setCanvasSizeFor3D(t,i){this.__screenRequested3D=new Ec(t,i)}getCanvasNode(){return this.canvasLayer.canvasNode}};function tR(r,e,t){let i,o,n,a,s,l;return r?(i=r.width||r.height||t.width,o=r.height||r.width||t.height,n=r.targetPixelRatio||1,n<1&&(n=1),a=(i<256||o<256)&&!r.preserveAxisNumbers,s=ih.fromObject(r.settings||e),l=!!r.transparentBackground):(i=t.width,o=t.height,n=1,a=!1,s=ih.fromObject(e),l=!1),a&&(s.setProperty("xAxisNumbers",!1),s.setProperty("yAxisNumbers",!1),s.setProperty("polarNumbers",!1)),{width:i,height:o,targetPixelRatio:n,settings:s,transparentBackground:l}}var pE=class{constructor(){this.displayName="graphing-calculator-text-geometry-tool-selection-display-name";this.toolType="selection";this.icon=[{type:"filled-polygon",color:"#000",path:[40,30,58,46,51,47,56,60,53,62,47,49,41,54,40,30]}]}getNumberInputLatex(){return""}clearTentativeOutputs(){}canNextInputBePoint(){return!1}getAllValidNextInputTypes(){return __dcg_shared_module_exports__['ab'].filter(e=>this.isValidNextInputType(e))}isValidNextInputType(e){return e!==__dcg_shared_module_exports__['Ta']}getNonPointInputType(){}getHint(){return""}getExpressionEditHint(e){return this.getHint()}onNumberInput(e){}onMove(e){return!0}onFocus(e){}tryCommitResults(){return{committed:void 0}}shouldUseJitEdges(){return!1}shouldHighlightRelevantObjects(){return!1}};var E7="graphing-calculator-text-geometry-tool-point-hint",uE=class extends fi{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-point-display-name",this.toolName="point",this.toolType="simple",this.icon=[{type:"point",x:50,y:50,size:"large"}]}getExpressionEditHint(t){return this.s(E7)}getSpec(){return{inputs:[{type:"point",id:"1",hint:E7}],outputs:[]}}};var S7="graphing-calculator-text-geometry-tool-line-hint-start",D7="graphing-calculator-text-geometry-tool-line-hint-end",hE=class extends fi{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-line-display-name",this.toolType="simple",this.toolName="line",this.icon=[{type:"stroked-path",path:[78,22,22,78],lineWidth:"large"},{type:"point",x:68,y:32},{type:"point",x:32,y:68}]}getExpressionEditHint(t){return t===0?this.s(S7):this.s(D7)}getSpec(){return{inputs:[{type:"point",id:"1",hint:S7},{type:"point",id:"2",hint:D7}],outputs:[{id:"3",type:"line",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var k7="graphing-calculator-text-geometry-tool-segment-hint-start",G7="graphing-calculator-text-geometry-tool-segment-hint-end",gE=class extends fi{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-segment-display-name",this.toolName="segment",this.toolType="simple",this.icon=[{type:"stroked-path",path:[68,32,32,68],lineWidth:"large"},{type:"point",x:68,y:32},{type:"point",x:32,y:68}]}getExpressionEditHint(t){return t===0?this.s(k7):this.s(G7)}getSpec(){return{inputs:[{type:"point",id:"1",hint:k7},{type:"point",id:"2",hint:G7}],outputs:[{id:"3",type:"segment",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var T7="graphing-calculator-text-geometry-tool-ray-hint-start",M7="graphing-calculator-text-geometry-tool-ray-hint-end",mE=class extends fi{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-ray-display-name",this.toolName="ray",this.toolType="simple",this.icon=[{type:"stroked-path",path:[78,22,32,68],lineWidth:"large"},{type:"point",x:68,y:32},{type:"point",x:32,y:68}]}getExpressionEditHint(t){return t===0?this.s(T7):this.s(M7)}getSpec(){return{inputs:[{type:"point",id:"1",hint:T7},{type:"point",id:"2",hint:M7}],outputs:[{id:"3",type:"ray",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var I7="graphing-calculator-text-geometry-tool-circle-hint-center",A7="graphing-calculator-text-geometry-tool-circle-hint-radius",fE=class extends fi{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-circle-display-name",this.toolName="circle",this.toolType="simple",this.icon=[{type:"circle",x:50,y:50,radius:26},{type:"point",x:50,y:50},{type:"point",x:68,y:32}]}getExpressionEditHint(t){return t===0?this.s(I7):this.s(A7)}getSpec(){return{inputs:[{type:"point",id:"1",hint:I7},{type:"point",id:"2",hint:A7}],outputs:[{id:"3",type:"circle",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var V7="graphing-calculator-text-geometry-tool-arc-hint-1",L7="graphing-calculator-text-geometry-tool-arc-hint-2",P7="graphing-calculator-text-geometry-tool-arc-hint-3",bE=class extends fi{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-arc-display-name",this.toolName="arc",this.toolType="complex";let i=50,o=80,n=80,a=-3,s=-2.6,l=-1.7;this.icon=[{type:"arc",x:o,y:n,radius:i,startAngle:a,endAngle:l},{type:"point",x:o+i*Math.cos(a),y:n+i*Math.sin(a)},{type:"point",x:o+i*Math.cos(s),y:n+i*Math.sin(s)},{type:"point",x:o+i*Math.cos(l),y:n+i*Math.sin(l)}]}getExpressionEditHint(t){return t===0?this.s(V7):t===1?this.s(L7):this.s(P7)}getSpec(){return{inputs:[{type:"point",id:"1",hint:V7},{type:"point",id:"2",hint:L7},{type:"point",id:"3",hint:P7}],outputs:[{id:"4",type:"arc",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"},{type:"reference-input",id:"3"}]}]}}};var _7="graphing-calculator-text-geometry-tool-parallel-hint-straight-line",O7="graphing-calculator-text-geometry-tool-parallel-hint-point",yE=class extends fi{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-parallel-display-name",this.toolName="parallel",this.toolType="complex",this.icon=[{type:"stroked-path",color:"light",path:[25,50,75,30],lineWidth:"large"},{type:"stroked-path",path:[25,70,75,50],lineWidth:"large"},{type:"point",x:50,y:60,size:"medium"}]}getExpressionEditHint(t){return t===0?this.s(_7):this.s(O7)}getSpec(){return{inputs:[{type:"straight",id:"1",hint:_7},{type:"point",id:"2",hint:O7}],outputs:[{id:"3",type:"parallel",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var R7="graphing-calculator-text-geometry-tool-perpendicular-hint-straight-line",F7="graphing-calculator-text-geometry-tool-perpendicular-hint-point",xE=class extends fi{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-perpendicular-display-name",this.toolName="perpendicular",this.toolType="complex",this.icon=[{type:"stroked-path",color:"light",path:[40,25,60,75],lineWidth:"large"},{type:"stroked-path",path:[25,60,75,40],lineWidth:"large"},{type:"point",x:50,y:50,size:"medium"}]}getExpressionEditHint(t){return t===0?this.s(R7):this.s(F7)}getSpec(){return{inputs:[{type:"straight",id:"1",hint:R7},{type:"point",id:"2",hint:F7}],outputs:[{id:"3",type:"perpendicular",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var rR="graphing-calculator-text-geometry-tool-midpoint-hint",wE=class extends fi{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-midpoint-display-name",this.toolName="midpoint",this.toolType="simple",this.icon=[{type:"stroked-path",path:[32,32,68,68]},{type:"point",x:50,y:50,size:"large"},{type:"point",x:32,y:32,size:"medium"},{type:"point",x:68,y:68,size:"medium"}]}getExpressionEditHint(t){return this.getHint()}canNextInputBePoint(){return!0}getNonPointInputType(){let{inputIndex:t}=this.model.getNonObjectsState().ui.currentTool;if(t===0)return"segment"}getSpec(){let{idMap:t}=this.model.getNonObjectsState().ui.currentTool,i=this.model.getUncommittedObjects(),o=t[1],n=!1;if(i[o]&&ule(i[o]))n=!0;else{let a=o&&this.model.findDefsForInputId(o)[0];n=!!(a&&a.typedRuntimeValue.valueType==__dcg_shared_module_exports__['va'])}return n?{inputs:[{type:"union",valueTypes:[__dcg_shared_module_exports__['va'],__dcg_shared_module_exports__['Fa']],id:"1",hint:rR},{type:"point",id:"2",hint:rR}],outputs:[{id:"midpoint-output",type:"midpoint",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}:{inputs:[{type:"segment",id:"1",hint:rR}],outputs:[{id:"midpoint-output",type:"midpoint",hidden:!1,parents:[{type:"reference-input",id:"1"}]}]}}};function ule(r){switch(r.type){case"point":case"intersection":case"glider":case"point-reference":case"midpoint":case"vector-endpoint":return!0;case"polygon":case"circle":case"arc":case"compass":case"segment":case"line":case"ray":case"vector":case"vector-copy":case"parallel":case"perpendicular":case"translate":case"reflect":case"dilate":case"rotate":case"angle":case"directedangle":case"angles":case"directedangles":case"polygon-segment":case"slider":case"expression-edit-preview-latex":return!1;default:return r}}var hle="graphing-calculator-text-geometry-tool-polygon-hint-first-point",N7="graphing-calculator-text-geometry-tool-polygon-hint-next-point",gle="graphing-calculator-text-geometry-tool-polygon-hint-finish-point",vE=class extends fi{constructor(t){super(t);this.model=t;this.addExtraPoint=!1;this.mouseOverFirstPoint=!1;this.mouseOverLastPoint=!1;this.displayName="graphing-calculator-text-geometry-tool-polygon-display-name",this.toolName="polygon",this.toolType="complex",this.icon=[{type:"filled-polygon",path:[55,30,30,30,35,70,70,60,55,30]},{type:"stroked-path",path:[55,30,30,30,35,70,70,60,55,30]},{type:"point",x:55,y:30},{type:"point",x:30,y:30},{type:"point",x:35,y:70},{type:"point",x:70,y:60}]}clearTentativeOutputs(){let t=this.addExtraPoint;this.addExtraPoint=!0,super.clearTentativeOutputs(),this.addExtraPoint=t}getHint(){let t=this.model.getNonObjectsState().ui.currentTool.inputIndex;return t===0?this.s(hle):t<3?this.s(N7):this.s(gle)}getExpressionEditHint(t){return this.s(N7)}canNextInputBePoint(){return!0}isDegenerateInput(t){return!1}getSpec(){let{inputIndex:t}=this.model.getNonObjectsState().ui.currentTool,i=t;this.addExtraPoint&&(i+=1),i<2&&(i=2);let o={inputs:[],outputs:[]},n=[];for(let a=0;a<i;a++){let s=a.toString();n.push({type:"reference-input",id:s}),o.inputs.push({type:"point",id:s})}return o.outputs.push({id:"polygon",type:"polygon",hidden:!1,parents:n,connectBorder:this.mouseOverFirstPoint}),o}tryCommitResults(){let t=this.getSpec();if(this.model.attemptLockToolInputIn(t),this.addExtraPoint=!1,!this.mouseOverFirstPoint&&!this.mouseOverLastPoint)return{committed:void 0};if(this._isReadyToCommit()){this.mouseOverFirstPoint=!1,this.mouseOverLastPoint=!1;let i=this.model.getUncommittedObjects(),o={...this.model.getNonObjectsState().ui.currentTool.idMap};return this.model.commitObjects(),this.model.deselectAllObjects(),this.model.cancelToolplay(),{committed:i,toolIdToLatex:o}}return{committed:void 0}}tentativelyAddInput({target:t,pointInfo:i},o){this.mouseOverFirstPoint=!1,this.mouseOverLastPoint=!1,this.addExtraPoint=!1;let n=t?this.getExpandedReferenceForDef(t,o):i==null?void 0:i.reference,{idMap:a,inputIndex:s}=this.model.getNonObjectsState().ui.currentTool;if(this.mouseOverFirstPoint=a[0]===n,this.mouseOverLastPoint=a[s-1]===n,!this.mouseOverFirstPoint&&!this.mouseOverLastPoint)this.addExtraPoint=!0;else{t||(t=i==null?void 0:i.def),t&&this.model.setObjectHovered({calcId:t.calcId,listIndex:this.getListIndexForHover(t,o)});return}super.tentativelyAddInput({target:t,pointInfo:i},o)}onMove(t){let i=this.model.getObjectDefUnderMouse(t.pt,t.tolerance);if(i){let o=this.getExpandedReferenceForDef(i,t.shift),{idMap:n,inputIndex:a}=this.model.getNonObjectsState().ui.currentTool;this.mouseOverFirstPoint=n[0]===o,this.mouseOverLastPoint=n[a-1]===o}return this.addExtraPoint=!this.mouseOverFirstPoint&&!this.mouseOverLastPoint,super.onMove(t)}};var mle="graphing-calculator-text-geometry-tool-compass-hint-segment",fle="graphing-calculator-text-geometry-tool-compass-hint-center",CE=class extends fi{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-compass-display-name",this.toolName="compass",this.toolType="complex",this.icon=[{type:"stroked-path",path:[50,50,75,50]},{type:"circle",x:50,y:50,radius:25}]}getExpressionEditHint(t){return this.getHint()}getSpec(){return{inputs:[{type:"segment",id:"1",hint:mle},{type:"point",id:"2",hint:fle}],outputs:[{id:"3",type:"circle",hidden:!1,parents:[{type:"reference-input",id:"2"},{type:"reference-input",id:"1"}]}]}}};var B7="graphing-calculator-text-geometry-tool-angle-hint-1",U7="graphing-calculator-text-geometry-tool-angle-hint-2",z7="graphing-calculator-text-geometry-tool-angle-hint-3",K7="graphing-calculator-text-geometry-tool-angles-hint-1",qf=class extends fi{constructor(t){super(t);this.model=t;this.toolType="complex",this.displayName="graphing-calculator-text-geometry-tool-angle-display-name",this.toolName="angle",this.angleType="angle",this.anglesType="angles",this.icon=[{type:"stroked-path",path:[40,30,30,70,70,70],color:"#CCC"},{type:"angle",x:30,y:70,radius:20,startAngle:-1.325817,deltaAngle:1.325817,isDirected:!1},{type:"point",x:30,y:70},{type:"point",x:40,y:30},{type:"point",x:70,y:70}]}canNextInputBePoint(){return!0}shouldReferenceSpecificItemInList(t,i){return __dcg_shared_module_exports__['ib'](t.typedRuntimeValue.valueType,__dcg_shared_module_exports__['Da'])?!0:super.shouldReferenceSpecificItemInList(t,i)}getNonPointInputType(){let{inputIndex:t}=this.model.getNonObjectsState().ui.currentTool;if(t===0)return"polygon"}getExpressionEditHint(t){return t===0?this.s(B7):t===1?this.s(U7):this.s(z7)}getSpec(){let{inputIndex:t,idMap:i}=this.model.getNonObjectsState().ui.currentTool,o=i[1];if(!t&&!o)return{inputs:[{type:"polygon",id:"1",hint:K7}],outputs:[{id:"2",type:this.anglesType,listAccess:void 0,hidden:!1,parents:[{type:"reference-input",id:"1"}]}]};let n=[];if(o&&this.model.findDefsForInputId(o).forEach(s=>{let l=s.typedRuntimeValue;if(l.valueType===__dcg_shared_module_exports__['Da']){let c=l.value.length;c>0&&n.push({referenceLatex:s.referenceLatex,sides:c})}}),n.length){let a=[],s=2;return n.forEach(l=>{for(var c=0;c<l.sides;c++)a.push({id:s+"",type:this.anglesType,listAccess:c+1,hidden:!1,parents:[{type:"hardcoded",id:l.referenceLatex}]}),s+=1}),{inputs:[{type:"polygon",id:"1",hint:K7}],outputs:a}}return{inputs:[{type:"point",id:"1",hint:B7},{type:"point",id:"2",hint:U7},{type:"point",id:"3",hint:z7}],outputs:[{id:"4",type:this.angleType,hidden:!1,showAngleLabel:!0,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"},{type:"reference-input",id:"3"}]}]}}};var EE=class extends qf{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-directedangle-display-name",this.toolName="directedangle",this.angleType="directedangle",this.anglesType="directedangles",this.icon=[{type:"stroked-path",path:[40,30,30,70,70,70],color:"#CCC"},{type:"angle",x:30,y:70,radius:20,isDirected:!0,startAngle:-1.325817,deltaAngle:1.325817},{type:"stroked-path",path:[35,50,41,50,37,55,35,50],color:"#000",lineWidth:"medium"},{type:"point",x:30,y:70},{type:"point",x:40,y:30},{type:"point",x:70,y:70}]}};var q7="graphing-calculator-text-geometry-tool-reflection-hint-choose-line",SE=class extends Yd{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-reflect-display-name",this.toolName="reflection",this.toolType="transformation"}getExpressionEditHint(t){return this.s(q7)}getSpec(){return{inputs:[{type:"straight",id:"1",hint:q7}],outputs:[{id:"2",type:"reflect",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"}]}]}}};var iR="graphing-calculator-text-geometry-tool-translation-hint-from-with-vector",H7="graphing-calculator-text-geometry-tool-translation-hint-to",DE=class extends Yd{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-translate-display-name",this.toolName="translation",this.toolType="transformation"}getExpressionEditHint(t){return t===0?this.s(iR):this.s(H7)}firstInputIsVector(){let{idMap:t}=this.model.getNonObjectsState().ui.currentTool,i=t[1],o=i&&this.model.findDefsForInputId(i)[0];return o&&o.typedRuntimeValue.valueType===__dcg_shared_module_exports__['Va']}getSpec(){return this.firstInputIsVector()?{inputs:[{type:"union",valueTypes:[__dcg_shared_module_exports__['va'],__dcg_shared_module_exports__['Va']],id:"1",hint:iR}],outputs:[{id:"3",type:"translate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"}]}]}:{inputs:[{type:"union",valueTypes:[__dcg_shared_module_exports__['va'],__dcg_shared_module_exports__['Va']],id:"1",hint:iR},{type:"point",id:"2",hint:H7}],outputs:[{id:"3",type:"translate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var W7="graphing-calculator-text-geometry-tool-dilation-hint-center",$7="graphing-calculator-text-geometry-tool-dilation-hint-scale-factor",kE=class extends Yd{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-dilate-display-name",this.toolName="dilation",this.toolType="transformation"}getExpressionEditHint(t){return t===0?this.s(W7):this.s($7)}getSpecIdToLockIn(t,i){return i===1?"2-number":super.getSpecIdToLockIn(t,i)}getSpec(){return{inputs:[{type:"point",id:"1",hint:W7},{type:"union",valueTypes:[],id:"2",hint:$7,numberInputInfo:{defaultLatex:"2",sliderInfo:{value:"2",min:"0",max:"5"}}}],outputs:[{id:"3",type:"dilate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2-number"}]}]}}};var Zg=class extends fi{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-expression-edit-display-name",this.toolType="custom",this.toolName="expression-edit"}getHint(){let t=this.model.controller.getValidCursorContext();if((t==null?void 0:t.type)!=="expression-arguments"||!t.functionSymbol)return this.getGenericHint();let i=this.model.getTool(t.functionSymbol);if(!i)return this.getGenericHint();let o=t.argIndex;return t.positionWithinArg==="end"&&(o+=1),i.getExpressionEditHint(o)}getGenericHint(){let t=this.getAllValidNextInputTypes();if(t.some(o=>o===__dcg_shared_module_exports__['ta']||o===__dcg_shared_module_exports__['wa']))return Pn("graphing-calculator-text-geometry-tool-expression-edit-generic-hint-any-object");let i=t.filter(o=>!(__dcg_shared_module_exports__['db'](o)&&t.find(n=>__dcg_shared_module_exports__['eb'](o)===n))).map(o=>Mp(__dcg_shared_module_exports__['cb'](o),Yv()));return i.length===0?Pn("graphing-calculator-text-geometry-tool-expression-edit-generic-hint-0"):i.length===1?Pn("graphing-calculator-text-geometry-tool-expression-edit-generic-hint-1",{type:i[0]}):i.length===2?Pn("graphing-calculator-text-geometry-tool-expression-edit-generic-hint-2",{type1:i[0],type2:i[1]}):Pn("graphing-calculator-text-geometry-tool-expression-edit-generic-hint-many",{types:i.join(", ")})}getExpressionEditHint(t){return this.getHint()}getSpec(){let t=this.model.controller.getSelectedItem(),i=oR(this.model.controller.getValidCursorContext());return!i||!t||t.type!=="expression"?{inputs:[],outputs:[]}:{inputs:[{type:"union",valueTypes:i,id:"1"}],outputs:[{type:"expression-edit-preview-latex",rhsLatex:this.buildPreviewLatex(),hidden:!1,color:t.color,id:"2",parents:[]}]}}onMove(t){super.onMove(t);let{idMap:i,inputIndex:o}=this.model.getNonObjectsState().ui.currentTool,n=this.getSpec().inputs[o];return!!(n&&i[n.id])}buildPreviewLatex(){let t="",i="",o=this.model.controller.getValidCursorContext();if((o==null?void 0:o.type)==="empty")return"";(o==null?void 0:o.type)==="expression-arguments"&&((o==null?void 0:o.positionWithinArg)==="end"?t=",":(o==null?void 0:o.positionWithinArg)==="start"&&(i=","));let n=this.model.getNonObjectsState().ui.currentTool.idMap,a=t+n[1]+i,s=this.model.controller.getSelectedItem();if((s==null?void 0:s.type)!=="expression")return"";let l=Ze.getFocusedMathquill(),c=l==null?void 0:l.selection();if((c==null?void 0:c.latex)!==s.latex)return"";let d=s.latex.slice(0,c.startIndex)+a+s.latex.slice(c.endIndex);return mn(s)?d.slice(s.latex.indexOf("=")+1):d}canNextInputBePoint(){let t=this.model.controller.getValidCursorContext();if((t==null?void 0:t.type)!=="expression-arguments"||t.expressionType!=="FunctionCall"&&t.expressionType!=="List")return!1;let i=oR(t);if(!i)return!1;let o=!1;for(let n of i){if(__dcg_shared_module_exports__['ib'](n,__dcg_shared_module_exports__['ta']))return!1;__dcg_shared_module_exports__['ib'](n,__dcg_shared_module_exports__['va'])&&(o=!0)}return o}shouldHighlightRelevantObjects(){let t=this.model.controller.getValidCursorContext();if((t==null?void 0:t.type)==="empty")return!1;let i=oR(t);return!(!i||i.some(o=>__dcg_shared_module_exports__['ib'](o,__dcg_shared_module_exports__['ta']))||i.every(o=>__dcg_shared_module_exports__['ib'](o,__dcg_shared_module_exports__['ua'])||__dcg_shared_module_exports__['ib'](o,__dcg_shared_module_exports__['Pa'])||__dcg_shared_module_exports__['ib'](o,__dcg_shared_module_exports__['Ra'])))}};function oR(r){if((r==null?void 0:r.type)==="empty")return[__dcg_shared_module_exports__['Pa'],__dcg_shared_module_exports__['Ra'],__dcg_shared_module_exports__['Qa'],__dcg_shared_module_exports__['Sa'],__dcg_shared_module_exports__['Va']];let e=(r==null?void 0:r.type)==="expression-arguments"?r.allowedTypesForInsertedArg:r==null?void 0:r.allowedTypes;return e==null?void 0:e.filter(t=>!__dcg_shared_module_exports__['ib'](t,__dcg_shared_module_exports__['_a']))}var ble={selection:pE,point:uE,line:hE,segment:gE,ray:mE,vector:cE,circle:fE,arc:bE,parallel:yE,perpendicular:xE,midpoint:wE,polygon:vE,compass:CE,angle:qf,directedangle:EE,reflect:SE,translate:DE,rotate:Bf,dilate:kE,"box-selection":Pf,"expression-edit":Zg},nR=ble;function yle(r,e){var a;if(e.typedRuntimeValue.valueType===__dcg_shared_module_exports__['Ta']||e.typedRuntimeValue.valueType===__dcg_shared_module_exports__['Ua'])return[];let t=e.data.call;if(!t||!t.parents)return[];let i=t.symbol,o=t.parents.map(Wx),n;switch(i){case"circle":{let[s,l]=o,c=l&&((a=r[l])==null?void 0:a.typedRuntimeValue.valueType);c&&__dcg_shared_module_exports__['ib'](c,__dcg_shared_module_exports__['Fa'])?n=[s]:n=[s,l];break}case"apply":{n=[o[1]];break}case"parallel":case"perpendicular":{n=[o[1]];break}case"polygon":{n=o.every(s=>s!==void 0)?o:[];break}default:n=o}return n.filter(Y7)}var xle=[[1,0],[0,0],!1],GE=class GE{constructor(e,t){let i=(e==null?void 0:e.list)||[];t&&(i=i.concat(t)),this.list=i;let o=(e==null?void 0:e.forward)||xle;t&&(o=__dcg_shared_module_exports__['Yb'](o,t.value)),this.forward=o,this.inverse=__dcg_shared_module_exports__['Zb'](o)}add(e){return new GE(this,e)}equals(e){if(this.list.length!==e.list.length)return!1;for(let t=this.list.length-1;t>=0;t--){let i=this.list[t],o=e.list[t];if(!__dcg_shared_module_exports__['E'](i,o))return!1}return!0}isCompletelyRigid(){return this.list.length===0}};GE.COMPLETELY_RIGID=new GE(void 0);var B1=GE;function wle(r){var i,o;let e={},t={};for(let n in r){let a=r[n];if(!a)continue;for(let l of((i=a.data.call)==null?void 0:i.parents)||[]){let c=Wx(l);c&&(e[c]||(e[c]=[]),(o=e[c])==null||o.push(a.assignment))}let s=yle(r,a);t[a.assignment]=s}return{parentToChildren:e,childToReversibilityParents:t}}function j7(r){let e=[],t={},i,o=1,n=2;function a(s){var l;t[s]!==n&&(t[s]=o,(l=r[s])==null||l.forEach(a),t[s]=n,e.unshift(s))}for(let s in r)t[s]===i&&a(s);return e}function aR(r,e){var p,g,h,f,y,x,E,C,S,v;let t={},i={},o={},n={},a={};for(let M of e)a[M]=!0,o[M]=B1.COMPLETELY_RIGID;let{parentToChildren:s,childToReversibilityParents:l}=wle(r);for(let M of j7(l)){let A=r[M];if(!A)continue;let I=(p=A.data.call)==null?void 0:p.symbol,P=(((g=A.data.call)==null?void 0:g.parents)||[]).map(Wx).filter(Y7);if(o[A.assignment])if(A.typedRuntimeValue.valueType===__dcg_shared_module_exports__['va']&&!I)t[A.assignment]=o[A.assignment];else if(I==="glider"&&P.length&&!a[P[0]])i[A.assignment]=o[A.assignment];else{let _=o[A.assignment];if(I==="apply"){let Y=(h=r[P[0]])==null?void 0:h.typedRuntimeValue;if((Y==null?void 0:Y.valueType)===__dcg_shared_module_exports__['Ua'])return{};if((Y==null?void 0:Y.valueType)!==__dcg_shared_module_exports__['Ta'])continue;_=_.add(Y)}let U=(f=l[A.assignment])!=null?f:[];for(let Y of U)o[Y]?_.equals(o[Y])||(o[Y]=B1.COMPLETELY_RIGID,n[Y]=!0):o[Y]=_}}let c={};for(let M in o)c[M]=!0;for(let M of j7(s))if(c[M]){for(let A of s[M]||[])c[A]=!0;if(o[M]){let A=l[M]||[];for(let I of A)n[I]&&(n[M]=!0)}}for(let M in i){let I=(((x=(y=r[M])==null?void 0:y.data.call)==null?void 0:x.parents)||[]).map(Wx)[0];I&&c[I]&&(n[I]=!0)}for(let M in r){if(!c[M])continue;let A=r[M],I=(E=A==null?void 0:A.data.call)==null?void 0:E.symbol,P=(((C=A==null?void 0:A.data.call)==null?void 0:C.parents)||[]).map(Wx);if(I==="apply"&&o[M]){let _=P[1],U=P[0];if(!_||!U)continue;let Y=(((v=(S=r[U])==null?void 0:S.data.call)==null?void 0:v.parents)||[]).map(Wx),R=Y.some(O=>O&&c[O]);if(o[M].isCompletelyRigid()&&o[_].isCompletelyRigid()||R){n[_]=!0;for(let O of Y)O&&(n[O]=!0)}}}let d=[];for(let M in n)a[M]||d.push(M);return d.length?aR(r,e.concat(d)):{...t,...i}}function Wx(r){return r?__dcg_shared_module_exports__['ub'](r[0]):void 0}function Y7(r){return r!==void 0}var TE=class{constructor(){this._nextId=0;this._defs={}}clear(){this._nextId=0,this._defs={}}add(e,t){let i;t?(i=e.assignment,e.listIndex!==void 0&&(i+="\\left["+e.listIndex+"\\right]")):i="**geo-internal-id-"+this._nextId++,this._defs[i]=e}computeReversibilityLineages(e){var s;let t=this.buildAssignmentMap(),i={};for(let l in t){let c=t[l];c&&(i[c.calcId]=c)}let o=[];for(let l of e){let c=i[l];if(!c)return{};o.push(c.assignment)}let n=aR(this.buildAssignmentMap(),o),a={};for(let l in n){let c=(s=t[l])==null?void 0:s.calcId;c&&(a[c]=n[l])}return a}buildAssignmentMap(){let e={};for(let t in this._defs){let i=this._defs[t];i&&(e[i.assignment]=i)}return e}getDepthValues(){var c,d;var e={},t={};let i=this.buildAssignmentMap();for(let p in i){let g=i[p];if(!g)continue;let h=__dcg_shared_module_exports__['wb'](g.assignment),f=[],y=[];(c=g.data.call)!=null&&c.parents?y=(d=g.data.call)==null?void 0:d.parents:g.data.assignmentRhsReference&&(y=[g.data.assignmentRhsReference]),y.forEach(x=>{let E=x&&x[0];E&&(f.push(E),t[E]||(t[E]=[]),t[E].push(__dcg_shared_module_exports__['wb'](h)))}),e[h]=f}let o=p=>{if(n[p]!==void 0)return n[p];var g=-1,h=e[p]||[];for(let y=0;y<h.length;y++){let x=o(h[y]);x>g&&(g=x)}let f=g+1;return n[p]=f,f};var n={};for(var a in e)n[a]=o(a);var s={},l={};for(var a in t){let g=n[a],h=1/0;t[a].forEach(f=>{let y=n[f];y>g&&(g=y),y<h&&(h=y)}),s[a]=g,l[a]=h}return{createdDepth:n,lastReferencedDepth:s,firstReferencedDepth:l}}};function X7(r,e,t){let o=.5/(2*t*e);return Yi(r-o,r+o)}function ME(r,e,t,i,o=0){let n=__dcg_shared_module_exports__['fa'](r.x,r.y,0,t[0],t[1],0,i[0],i[1],0);o&&(n+=o);let s=.5/(__dcg_shared_module_exports__['Eb'](t,i)*e);return Yi(n-s,n+s)}function Xd(r,e){for(let t of e)t&&(t.min!==void 0&&r<t.min?r=t.min:t.max!==void 0&&r>t.max&&(r=t.max));return r}function U1(r,e,t,i){if(!t)return 0;var o=r.mapx(1)-r.mapx(0);switch(t.valueType){case __dcg_shared_module_exports__['Ha']:{let a=e.x-t.value[0][0],s=e.y-t.value[0][1],l=Math.atan2(s,a)/(2*Math.PI);l<0&&(l+=1),l=X7(l,o,t.value[1]);let c=Xd(0,[i]),d=Xd(1,[i]);if(l>=c&&l<=d)return l;{let p=__dcg_shared_module_exports__['Kb'](t.value,c),g=__dcg_shared_module_exports__['Kb'](t.value,d),h=__dcg_shared_module_exports__['Eb'](p,[e.x,e.y]),f=__dcg_shared_module_exports__['Eb'](g,[e.x,e.y]);return h<=f?c:d}}case __dcg_shared_module_exports__['Ja']:{let a=__dcg_shared_module_exports__['Nb'](t.value);if(!a)return 0;if(a.type==="segment"){let s=ME(e,o,a.start,a.end);return Xd(s,[{min:0,max:1},i])}else if(a.type==="rays"){let s=__dcg_shared_module_exports__['Eb'](a.start1,[e.x,e.y]),l=__dcg_shared_module_exports__['Eb'](a.start2,[e.x,e.y]),c=!i||i.min===void 0?-1/0:i.min,d=!i||i.max===void 0?1/0:i.max;return s<l?c>0?d>=1?1:c:Xd(-ME(e,o,a.start1,a.end1),[{min:void 0,max:0},i]):d<1?c<=0?0:d:Xd(ME(e,o,a.start2,a.end2,1),[{min:1,max:void 0},i])}else if(a.type=="arc"){let[s,l]=a.center,{radius:c,startAngle:d}=a,p=__dcg_shared_module_exports__['Gb'](t.value),g=e.x-s,h=e.y-l,f=__dcg_shared_module_exports__['aa'](Math.atan2(h,g),d,p);if(f>=0&&f<=1)f=X7(f,o,c);else{let E=PT(e,{x:s+c*Math.cos(d),y:l+c*Math.sin(d)}),C=PT(e,{x:s+c*Math.cos(d+p),y:l+c*Math.sin(d+p)});E<=C?f=0:f=1}let y=Xd(0,[i]),x=Xd(1,[i]);if(f>=y&&f<=x)return f;{let E=__dcg_shared_module_exports__['Lb'](t.value,y),C=__dcg_shared_module_exports__['Lb'](t.value,x),S=__dcg_shared_module_exports__['Eb'](E,[e.x,e.y]),v=__dcg_shared_module_exports__['Eb'](C,[e.x,e.y]);return S<=v?y:x}}return Xd(0,[i])}case __dcg_shared_module_exports__['Na']:case __dcg_shared_module_exports__['Fa']:case __dcg_shared_module_exports__['La']:{let a=ME(e,o,t.value[0],t.value[1]);return Xd(a,[{min:t.valueType===__dcg_shared_module_exports__['La']?void 0:0,max:t.valueType!==__dcg_shared_module_exports__['Fa']?void 0:1},i])}case __dcg_shared_module_exports__['Da']:{let a=t.value,s=1/0,l=Xd(0,[i]),c=i&&i.min!==void 0?i.min:-1/0,d=i&&i.max!==void 0?i.max:1/0,p=Math.floor(Math.max(c,0)),g=Math.ceil(Math.min(d,a.length));for(let h=p;h<g;h++){let f=a[h],y=a[(h+1)%a.length],x=Xd(ME(e,o,f,y,h),[{min:h,max:h+1},i]),E=__dcg_shared_module_exports__['Mb'](t.value,x),C=__dcg_shared_module_exports__['Eb'](E,[e.x,e.y]);C<s&&(s=C,l=x)}return l}case __dcg_shared_module_exports__['va']:case __dcg_shared_module_exports__['Pa']:case __dcg_shared_module_exports__['Ra']:case __dcg_shared_module_exports__['Ta']:case __dcg_shared_module_exports__['Va']:return 0;default:return t}}function J7(r,e){switch(r.valueType){case __dcg_shared_module_exports__['Ha']:return __dcg_shared_module_exports__['Kb'](r.value,e);case __dcg_shared_module_exports__['Ja']:return __dcg_shared_module_exports__['Lb'](r.value,e);case __dcg_shared_module_exports__['Na']:return __dcg_shared_module_exports__['Jb'](r.value,e);case __dcg_shared_module_exports__['Fa']:return __dcg_shared_module_exports__['Ib'](r.value,e);case __dcg_shared_module_exports__['La']:return __dcg_shared_module_exports__['Hb'](r.value,e);case __dcg_shared_module_exports__['Da']:return __dcg_shared_module_exports__['Mb'](r.value,e);case __dcg_shared_module_exports__['va']:case __dcg_shared_module_exports__['Pa']:case __dcg_shared_module_exports__['Ra']:case __dcg_shared_module_exports__['Ta']:case __dcg_shared_module_exports__['Va']:return[NaN,NaN];default:return r}}function vle(r,e){if(!e)return!1;let{left:t,right:i,top:o,bottom:n}=r.pixelCoordinates,{x:a,y:s}=e.mathPoint;if(e.transform){let l=e.model.formula.typed_constant_value;if((l==null?void 0:l.valueType)!==__dcg_shared_module_exports__['va'])throw new Error(`Expected movable point to be a Point but found ${l?__dcg_shared_module_exports__['bb'](l.valueType):void 0} instead`);a=a!=null?a:l.value[0],s=s!=null?s:l.value[1],[a,s]=__dcg_shared_module_exports__['_b'](e.transform.forward,[a,s])}if(a!==void 0){let l=r.mathToPixels.mapX(a);if(l<t-.5||l>i+.5)return!1}if(s!==void 0){let l=r.mathToPixels.mapY(s);if(l<o-.5||l>n+.5)return!1}return!0}function Q7(r,e){if(e.length===1&&!vle(r,e[0]))return!1;let t=!1;for(let i of e){if(i.newPointLatex){let o=i.model.latex;gl(i.model,i.newPointLatex),t=t||o!==i.model.latex}for(let o in i.sliderUpdates){let{value:n,model:a}=i.sliderUpdates[o];i.commitSliderSoftLimits&&Oy(a);let s=a.latex;Ak(a,n),t=t||s!==a.latex}}return t}function Z7({projection:r,transform:e,controller:t,strategy:i,mode:o,clampToViewport:n}){var v;let a=t.getItemModel(i.id);if(!a||a.type!=="expression")throw new Error(`Programming error: updateSliderNonlinear move strategy should point to an expression item, but found ${a==null?void 0:a.type}`);let s=o==="up"||o==="bigup",l=((v=a.slider)==null?void 0:v.step)!==""&&(s&&!a.slider.hardMax||!s&&!a.slider.hardMin);i.compiled.fn||__dcg_shared_module_exports__['ic'](i.compiled);let c=i.compiled.fn;e&&(c=M=>__dcg_shared_module_exports__['_b'](e.forward,i.compiled.fn(M)));let d=M=>{let[A,I]=c(M);return{x:A,y:I}=r.mathToPixels.mapPoint({x:A,y:I}),[A,I]},p=hl(a),[g,h]=d(p),f=C_(a,o,{ignoreSoftLimits:l}),y=f,[x,E]=d(y),C=__dcg_shared_module_exports__['da'](x-g,E-h);if(C<1){let M=__dcg_shared_module_exports__['qa'](d,[g+(x-g)/C,h+(E-h)/C],y,y>p?y:i.min,y<p?y:i.max,1);if(M){let A=Yi(M[0],M[1]);(o==="bigup"||o==="bigdown")&&(A=p+(A-p)*5);let I=Yc(a,__dcg_shared_module_exports__['pa'](A,i.min,i.max),{ignoreSoftLimits:l}),[P,_]=d(I);__dcg_shared_module_exports__['da'](P-g,_-h)>C&&(f=I)}}n&&(f=t9(r,hl(a),f,c));let S=c(f);return{mathPoint:{x:S[0],y:S[1]},sliderUpdates:{[i.id]:{model:a,value:f}}}}function e9({controller:r,projection:e,transform:t,strategy:i,targetScreenPoint:o,clampToViewport:n}){let a={mathPoint:{},sliderUpdates:{}},s=r.getItemModel(i.id);if(!s||s.type!=="expression")throw new Error(`Programming error: updateSliderNonlinear move strategy should point to an expression item, but found ${s==null?void 0:s.type}`);i.compiled.fn||__dcg_shared_module_exports__['ic'](i.compiled);let l=i.compiled.fn;t&&(l=S=>__dcg_shared_module_exports__['_b'](t.forward,i.compiled.fn(S)));let c=S=>{let[v,M]=l(S);return{x:v,y:M}=e.mathToPixels.mapPoint({x:v,y:M}),[v,M]},d=i.initialValue,p=i.min,g=i.max,h=[o.x,o.y],f=__dcg_shared_module_exports__['qa'](c,h,d,p,g,1);if(!f)return a;let y=Yi(f[0],f[1]);p!==void 0&&y<p&&(y=p),g!==void 0&&y>g&&(y=g);let x=Yc(s,y,{ignoreSoftLimits:!0});n&&(x=t9(e,hl(s),x,l));let[E,C]=l(x);return a.mathPoint.x=E,a.mathPoint.y=C,a.sliderUpdates[s.id]={value:x,model:s},a}function lR({controller:r,projection:e,transform:t,strategy:i,targetScreenPoint:o}){let n=e.reverse_map_pt(o);if(t){let d=__dcg_shared_module_exports__['_b'](t.inverse,[n.x,n.y]);n={x:d[0],y:d[1]}}let a=i.type==="updateSliderForGlider"?{min:i.min,max:i.max}:void 0,s=U1(e,n,i.movesOn,a);if(!isFinite(s))return;let l=J7(i.movesOn,s),c={mathPoint:{x:l[0],y:l[1]},newPointLatex:void 0,sliderUpdates:{}};if(i.type==="updateGliderParameter"){let d=i.span;c.newPointLatex=d.input.slice(0,d.start)+__dcg_shared_module_exports__['Oc'](s)+d.input.slice(d.end)}else if(i.type==="updateSliderForGlider"){let d=r.getItemModel(i.id);d&&d.type==="expression"&&(c.sliderUpdates[d.id]={value:s,model:d})}return c}function t9(r,e,t,i){let o=d=>{let[p,g]=i(d);return r.mathToPixels.mapPoint({x:p,y:g})},n=({x:d,y:p})=>{let{left:g,right:h,top:f,bottom:y}=r.pixelCoordinates;return d>=g&&d<=h&&p>=f&&p<=y},a=e,s=o(e),l=t,c=o(t);if(n(c)||!n(s))return t;for(;;){let d=s.x-c.x,p=s.y-c.y;if(d*d+p*p<.5)break;let g=__dcg_shared_module_exports__['oa'](a,l);if(g===a||g===l){[a,l]=n(s)?[a,a]:[l,l];break}let h=o(g);n(h)!==n(s)?[l,c]=[g,h]:[a,s]=[g,h]}return Yi(a,l)}function cR({controller:r,projection:e,transform:t,formula:i,moveStrategy:o,dragMode:n,targetScreenPoint:a,clampToViewport:s}){if(t){let{x:h,y:f}=e.pixelsToMath.mapPoint(a),[y,x]=__dcg_shared_module_exports__['_b'](t.inverse,[h,f]);a=e.mathToPixels.mapPoint({x:y,y:x})}var l=e.pixelsToMath.mapRect({left:a.x-.5,right:a.x+.5,top:a.y+.5,bottom:a.y-.5}),c=[{min:l.left,max:l.right},{min:l.top,max:l.bottom}];let d={mathPoint:{},sliderUpdates:{}},[p,g]=o;if(p.type==="updateCoordinate"||g.type==="updateCoordinate"){let h=Cle(i,c,n);if(h){let{latex:f,x:y,y:x}=h;(y!==void 0||x!==void 0)&&(d.newPointLatex=f,d.mathPoint.x=y!=null?y:d.mathPoint.x,d.mathPoint.y=x!=null?x:d.mathPoint.y)}}for(let h of[0,1]){let f=o[h];if(sR(h,n)&&f.type==="updateSlider"){let y=r.getItemModel(f.id);if(!y||y.type!=="expression")continue;let[x,E]=f.coefficients,C=Yi(E*c[h].min+x,E*c[h].max+x),S=Yc(y,C,{ignoreSoftLimits:!0}),v=(S-x)/E;if(!s||t){d.mathPoint[h===0?"x":"y"]=v,d.sliderUpdates[y.id]={value:S,model:y};continue}let[M,A]=h===0?[e.mathCoordinates.left,e.mathCoordinates.right]:[e.mathCoordinates.bottom,e.mathCoordinates.top],I=v<M?M:v>A?A:void 0;I!==void 0&&Jc(y)===void 0?(d.mathPoint[h===0?"x":"y"]=I,d.sliderUpdates[y.id]={value:E*I+x,model:y}):(d.mathPoint[h===0?"x":"y"]=v,d.sliderUpdates[y.id]={value:S,model:y})}}return d}function Cle(r,e,t){if(!r.move_strategy)throw new Error("Programming error: expected move_strategy to be defined.");var i=Yi(e[0].min,e[0].max),o=Yi(e[1].min,e[1].max);let[n,a]=r.move_strategy,s=!1,l=!1,c,d="",p=0;if(n.type==="updateCoordinate"&&sR(0,t)&&(c=n.inputSpan.input,s=!0,d+=c.slice(p,n.inputSpan.start),d+=__dcg_shared_module_exports__['Oc'](i),p=n.inputSpan.end),a.type==="updateCoordinate"&&sR(1,t)&&(c=a.inputSpan.input,l=!0,d+=c.slice(p,a.inputSpan.start),d+=__dcg_shared_module_exports__['Oc'](o),p=a.inputSpan.end),c!==void 0)return d+=c.slice(p),{latex:d,x:s?i:void 0,y:l?o:void 0}}function sR(r,e){switch(e){case"X":return r===0;case"Y":return r===1;case"XY":return!0;default:return!1}}function r9(r,e,t){t.forEach(i=>{Ele(r,e,i)})}function i9(r,e,t,i,o,n,a){var d;let s=!1,l=e.length===1,c=[];for(let p=0;p<e.length;p++){let g=e[p];if(g.tableInfo){Dle(r,g,i[p],o),s=!0;continue}let h=r.getItemModel(g.calcId);if(h){if(h.type==="image")s=s||Tle(r,h,g,i[p],o);else if(h.type==="expression"){let f=Mle({controller:r,movedExpr:h,dragMode:(d=mo(h,{isReverseDrag:g.isReverseDrag}))!=null?d:"NONE",currentScreenPoint:t[p],targetScreenPoint:i[p],projection:o,transform:n&&n[p],isOnlyPoint:l,keyboardDirection:a});f&&c.push(f)}}}return s=s||Q7(o,c),s}function o9(r,e){e.forEach(t=>{Sle(r,t)})}function Ele(r,e,t){if(t.tableInfo){vi(e,void 0);let s=r.getItemModel(t.tableInfo.tableId);if(!s||s.type!=="table")return;yO(s,!0)}else{let s=r.getItemModel(t.calcId);if(!s||!(s.type==="expression"||s.type==="image")||!s.formula||!s.formula.move_strategy)return;for(var i=s.formula.move_strategy,o=0;o<i.length;o++){let l=i[o];if(i[o].type==="updateCoordinate"||i[o].type==="updateGliderParameter")s.type==="image"?eO(s,!0):s.type==="expression"&&k_(s,!0);else if(l.type==="updateSlider"||l.type==="updateSliderNonlinear"||l.type==="updateSliderForGlider"){var n=r.getItemModel(l.id);if(!n||n.type!=="expression")continue;var a;if(s.type==="expression"?a=mo(s,{isReverseDrag:t.isReverseDrag}):a=void 0,a==="NONE"||o===0&&a==="Y"||o===1&&a==="X")continue;pC(n,!0)}}}}function Sle(r,e){for(let t of r.getAllItemModels())t.type==="table"?t.draggingOnGraphpaper&&yO(t,!1):t.type==="expression"?(t.sliderDragging&&pC(t,!1),t.draggingOnGraphpaper&&k_(t,!1)):t.type==="image"&&t.draggingOnGraphpaper&&eO(t,!1)}function Dle(r,e,t,i){var o=e.tableInfo.tableId,n=e.tableInfo.rowIndex,a=e.tableInfo.columnId,s=e.tableInfo.dragX,l=e.tableInfo.dragY,c=r.getItemModel(o);if(!(!c||c.type!=="table")){var d=jn(c,a);if(d){var p=i.closestPointOnScreen(t),g=i.pixelsToMath.mapRect(n9(p,.5)),h={x:__dcg_shared_module_exports__['Nc'](Yi(g.left,g.right)),y:__dcg_shared_module_exports__['Nc'](Yi(g.top,g.bottom))};if(s&&ch(c,{row:n+1,column:0},h.x),l){let f=d.index;ch(c,{row:n+1,column:f},h.y)}}}}function n9(r,e){return{left:r.x-e,right:r.x+e,top:r.y+e,bottom:r.y-e}}function kle(r,e,t){if(t[0]===0&&t[1]===0)return{x:e.x,y:e.y,width:r.width,height:r.height};let i=Math.cos(r.radianAngle),o=Math.sin(r.radianAngle),n=e.x-r.x,a=e.y-r.y;if(t[0]===0)return{x:r.x,y:r.y,width:r.width,height:2*t[1]*(i*a+o*n)};if(t[1]===0)return{x:r.x,y:r.y,width:2*t[0]*(i*n-o*a),height:r.height};var s=2*(r.width*t[0]*(i*n-o*a)+r.height*t[1]*(o*n+i*a))/(r.width*r.width+r.height*r.height);return{x:r.x,y:r.y,width:s*r.width,height:s*r.height}}function Gle(r,e,t){let i=[{x:e.left,y:e.bottom},{x:e.left,y:e.top},{x:e.right,y:e.top},{x:e.right,y:e.bottom}],o=["x","y","width","height"],n={x:1/0,y:1/0,width:1/0,height:1/0},a={x:-1/0,y:-1/0,width:-1/0,height:-1/0};for(let s of i){let l=kle(r,s,t);for(let c of o)n[c]=Math.min(n[c],l[c]),a[c]=Math.max(a[c],l[c])}return{min:n,max:a}}function IE(r){return r===void 0?NaN:r[0]}function Tle(r,e,t,i,o){var B;var n=e.formula;if(!n||((B=n.move_strategy)==null?void 0:B.length)!==4)return!1;var a=n.dimensions,s={x:IE(a.x),y:IE(a.y),width:IE(a.width),height:IE(a.height),radianAngle:IE(a.radianAngle)},l=t.scaleFactor||[0,0],c=l[0]!==0&&l[1]!==0,d=o.closestPointOnScreen(i),p=o.pixelsToMath.mapRect(n9(d,c?.05:.5)),g=Gle(s,p,l),h=o.mathToPixels.mapRect({left:s.x-.5*s.width,right:s.x+.5*s.width,top:s.y-.5*s.height,bottom:s.y+.5*s.height}),f=Math.abs(h.right-h.left),y=Math.abs(h.bottom-h.top),x=o.mathToPixels.mapRect({left:g.min.x-.5*g.min.width,right:g.min.x+.5*g.min.width,top:g.min.y-.5*g.min.height,bottom:g.min.y+.5*g.min.height}),E=Math.abs(x.right-x.left),C=Math.abs(x.bottom-x.top);if(E<f&&E<1||C<y&&C<1)return!1;var S=["width","height","x","y"];let v=!1;for(var M=0;M<S.length;M++){var A=S[M],I=n.move_strategy[M];switch(I.type){case"updateCoordinate":var P=Yi(g.min[A],g.max[A]),_=I.inputSpan.input,U=__dcg_shared_module_exports__['Nc'](P);switch(A){case"width":case"height":jl(e,A,U);break;case"x":if(n.move_strategy[3].type==="updateCoordinate"){let F=n.move_strategy[3],j=Yi(g.min.y,g.max.y),pe=__dcg_shared_module_exports__['Nc'](j),le=_.slice(0,I.inputSpan.start)+U+_.slice(I.inputSpan.end,F.inputSpan.start)+pe+_.slice(F.inputSpan.end);jl(e,"center",le)}else{let F=_.slice(0,I.inputSpan.start)+U+_.slice(I.inputSpan.end);jl(e,"center",F)}break;case"y":if(n.move_strategy[2].type!=="updateCoordinate"){let F=_.slice(0,I.inputSpan.start)+U+_.slice(I.inputSpan.end);jl(e,"center",F)}break;default:return A}v=!0;break;case"updateSlider":var Y=r.getItemModel(I.id);if(!Y||Y.type!=="expression")continue;var R=I.coefficients[0],H=I.coefficients[1],O=H*g.min[A]+R,q=H*g.max[A]+R,w=Yi(O,q),T=Y.latex;Ak(Y,w),Y.latex!==T&&(v=!0);break}}return v}function Mle({controller:r,movedExpr:e,dragMode:t,currentScreenPoint:i,targetScreenPoint:o,projection:n,transform:a,isOnlyPoint:s,keyboardDirection:l}){var f,y;let c=e.formula;if(!c||((f=c.move_strategy)==null?void 0:f.length)!==2)return;let[d,p]=c.move_strategy;if(s&&d.type==="updateCoordinate"&&p.type==="updateCoordinate"){let x=n.reverse_map_pt(o),E=dR(n,x);E&&(o=n.map_pt(E))}let g=s?n.closestPointOnScreen(o):o;if(!l){let x;switch(d.type){case"updateSliderNonlinear":x=e9({controller:r,projection:n,transform:a,strategy:d,targetScreenPoint:g,clampToViewport:s});break;case"updateGliderParameter":case"updateSliderForGlider":x=lR({controller:r,projection:n,transform:a,strategy:d,targetScreenPoint:g});break;default:x=cR({controller:r,projection:n,transform:a,formula:c,moveStrategy:c.move_strategy,dragMode:t,targetScreenPoint:g,clampToViewport:s})}return x&&{...x,commitSliderSoftLimits:!1,transform:a,model:e}}let h;if(d.type==="updateSliderNonlinear"){if(!(l!=null&&l.x))return;h=Z7({projection:n,transform:a,controller:r,strategy:d,mode:l.x,clampToViewport:s})}else if(d.type==="updateGliderParameter"||d.type==="updateSliderForGlider")h=lR({controller:r,projection:n,transform:a,strategy:d,targetScreenPoint:g});else{let x=l.x?0:1,E=l.x?g.x-i.x:g.y-i.y,C=c.move_strategy[x];if(C.type==="updateSlider"){let S=r.getItemModel(C.id);if((S==null?void 0:S.type)!=="expression")throw new Error(`Programming error: updateSlider move strategy should point to an expression item, but found ${S==null?void 0:S.type}`);let v=Jc(S);if(v){let M=n.mathToPixels.mapPoint({x:0,y:0}),A=C.coefficients[1],I=Math.abs(x===0?n.mathToPixels.mapX(v/A)-M.x:n.mathToPixels.mapY(v/A)-M.y),P=Math.ceil(1/I);E=I*P*(E>0?1:-1);let _=(y=l.x)!=null?y:l.y;(_==="bigup"||_==="bigdown")&&(E*=5)}}h=cR({controller:r,projection:n,transform:a,formula:c,moveStrategy:c.move_strategy,dragMode:t,targetScreenPoint:{x:i.x+(x===0?E:0),y:i.y+(x===1?E:0)},clampToViewport:s})}return h&&{...h,commitSliderSoftLimits:!0,transform:a,model:e}}function dR(r,e){if(!r.settings.showGrid)return;let t=Qc(r),i=t.minorStepX,o=t.minorStepY,n=r.map_pt(e),a=Math.round(e.x/i)*i,s=Math.round(e.y/o)*o,l=5,c={x:a,y:s},d=r.map_pt(c);if(__dcg_shared_module_exports__['da'](d.x-n.x,d.y-n.y)<=l)return c}function l9(r,e){let t={i:0,x:NaN,y:NaN},i={i:1,x:NaN,y:NaN};if(!r||!e)return[t,i];let o=a9(r.typedRuntimeValue),n=a9(e.typedRuntimeValue);if(!o||!n)return[t,i];let a=s9(o,n);return t.x=a[0],t.y=a[1],a=s9(n,o),i.x=a[0],i.y=a[1],[t,i]}function a9(r){switch(r.valueType){case __dcg_shared_module_exports__['Fa']:case __dcg_shared_module_exports__['La']:case __dcg_shared_module_exports__['Na']:return{type:"straight",def:r.value};case __dcg_shared_module_exports__['Va']:return{type:"straight",def:Nf(r.value)};case __dcg_shared_module_exports__['Ha']:return{type:"circle",def:r.value};case __dcg_shared_module_exports__['Ja']:return{type:"arc",def:r.value}}}function s9(r,e){switch(r.type){case"straight":switch(e.type){case"straight":return __dcg_shared_module_exports__['Rb'](r.def,e.def);case"circle":return __dcg_shared_module_exports__['Pb'](r.def,e.def);case"arc":return __dcg_shared_module_exports__['Tb'](r.def,e.def)}case"circle":switch(e.type){case"straight":return __dcg_shared_module_exports__['Qb'](r.def,e.def);case"circle":return __dcg_shared_module_exports__['Ob'](r.def,e.def);case"arc":return __dcg_shared_module_exports__['Sb'](r.def,e.def)}case"arc":switch(e.type){case"straight":return __dcg_shared_module_exports__['Vb'](r.def,e.def);case"circle":return __dcg_shared_module_exports__['Ub'](r.def,e.def);case"arc":return __dcg_shared_module_exports__['Wb'](r.def,e.def)}}return[NaN,NaN]}var c9=[{key:"compass",objects:"Segment + Point"},{key:"midpoint",objects:"Segment"},{key:"parallel",objects:"Line + Point"},{key:"perpendicular",objects:"Line + Point"},{key:"image",objects:"2 Points"}];function Jd(r){return __dcg_shared_module_exports__['D'](r)}function Qd(r){this.setState(r)}Qd.prototype.setState=function(r){this.state=r};Qd.prototype.getState=function(){return this.state};Qd.prototype.set=function(r,e){if(arguments.length===1){this.state=r;return}else if(typeof r=="string"){this.state=Jd(this.state),this.state[r]=e;return}var t=r.length-2,i=r[t+1],o;this.state=o=Jd(this.state);for(var n=0;n<=t;n++){var a=r[n];o=o[a]=Jd(o[a])}o[i]=e};Qd.prototype.deepMutate=function(r,e){if(arguments.length===1){e=r,this.state=__dcg_shared_module_exports__['Z'](this.state),e(this.state);return}else if(typeof r=="string"){this.state=Jd(this.state),this.state[r]=__dcg_shared_module_exports__['Z'](this.state[r]),e(this.state[r]);return}for(var t=r.length-2,i=r[t+1],o=this.state=Jd(this.state),n=0;n<=t;n++){var a=r[n];o=o[a]=Jd(o[a])}o=o[i]=__dcg_shared_module_exports__['Z'](o[i]),e(o)};Qd.prototype.shallowMutate=function(r,e){if(arguments.length===1){e=r,this.state=Jd(this.state),e(this.state);return}else if(typeof r=="string"){this.state=Jd(this.state),this.state[r]=Jd(this.state[r]),e(this.state[r]);return}for(var t=r.length-1,i=this.state=Jd(this.state),o=0;o<=t;o++){var n=r[o];i=i[n]=Jd(i[n])}e(i)};Qd.areShallowEqual=function(r,e){};Qd.areDeepEqual=function(r,e){};function Hf(r){return r?!!(Ile(r)&&r!=="Vector"||r==="Circle"||r==="Arc"||r==="Polygon"):!1}function Ile(r){if(!r)return!1;switch(r){case"Line":case"Ray":case"Vector":case"Segment":return!0}return!1}as();var Ale=!0,Vle=!1,p9="**dcg_geo_tool_output_slider**";function Lle(){return{point:__dcg_shared_module_exports__['W'].PURPLE,line:__dcg_shared_module_exports__['W'].BLUE,circle:__dcg_shared_module_exports__['W'].GREEN,polygon:__dcg_shared_module_exports__['W'].BLUE,angle:__dcg_shared_module_exports__['W'].BLACK}}function Ple(r,e){let t=[],i=r.parents;for(let o=0;o<i.length;o++){let n=i[o];n.type==="hardcoded"?t[o]=n.id:t[o]=e[n.id]}return t}var AE=class{constructor(e){this._nextObjectId=0;this.clear(),this.controller=e,this.s=this.controller.s,this._tools={};for(let t in nR)this._tools[t]=new nR[t](this)}onPreviewChange(){var a;var e=this.controller.getToolPreviewJSONState(),t=this.getUncommittedObjects();if(this.getCurrentTool()instanceof Zg&&!this.controller.getValidCursorContext()){t={...t};for(let s in e){let l=e[s];l.type==="expression-edit-preview-latex"&&(t[s]=l)}}for(var o in t){var n=t[o];n.type==="polygon"&&this.isObjectHovered(n.parents[0])&&n.parents.push(n.parents[0])}__dcg_shared_module_exports__['E'](e,t)?this.controller.dispatch({type:"render"}):this.controller.dispatch({type:"set-tool-preview-state",state:t}),(a=this.controller.get2dPOIController())==null||a.updateGeoHoveredObjects()}peekNextObjectId(){return"\\token{"+this._nextObjectId.toString()+"}"}generateObjectId(){let e=this.peekNextObjectId();return this._nextObjectId+=1,e}updateNextObjectId(e){e>this._nextObjectId&&(this._nextObjectId=e)}clear(){let e={objects:{},ui:{currentTool:{name:"selection",idMap:{},reusableInputIdMap:{},lockedIds:{},inputIndex:0,outputHistory:{}},colors:Lle()},hoveredObjects:[],uncommittedIds:{},selectedIds:{},nextSelectionNumber:1,fadeAnimations:{},maxAnimationEndTime:0};this.store?this.store.set(e):this.store=new Qd(e)}onFocus(e){this.clearHoveredObjects(),this.getCurrentTool().onFocus(e),this.onPreviewChange()}onMouseAction(e,t){let i=this.getCurrentTool();if(i instanceof Zg&&!this.controller.getValidCursorContext())return{committed:void 0,handled:!1};switch(this.updateNextObjectId(this.controller.findLastTokenNumber()+1),this.clearHoveredObjects(),e){case"move":return{committed:void 0,handled:i.onMove(t)};case"release":i.onMove(t);let o=i.tryCommitResults();return o.committed?{...o,handled:!0}:{committed:void 0,handled:!1}}}getNonObjectsState(){return{...this.store.getState(),objects:void 0}}getCurrentTool(){return this.getTool(this.getToolMode())}getTool(e){return this._tools[e]}defaultColorForObject(e,t){switch(t.type){case"point":case"point-reference":case"midpoint":case"glider":case"intersection":case"vector-endpoint":return e.colors.point;case"line":case"segment":case"polygon-segment":case"ray":case"vector":case"vector-copy":case"perpendicular":case"parallel":return e.colors.line;case"circle":case"compass":case"arc":return e.colors.circle;case"polygon":return e.colors.polygon;case"angle":case"angles":case"directedangle":case"directedangles":return e.colors.angle;case"dilate":case"reflect":case"rotate":case"translate":return __dcg_shared_module_exports__['W'].GRAY;case"slider":return __dcg_shared_module_exports__['W'].BLACK;case"expression-edit-preview-latex":return t.color||__dcg_shared_module_exports__['W'].BLACK;default:return t}}_deselectAll(){this.store.shallowMutate(e=>{e.nextSelectionNumber=1,e.selectedIds={}})}_modifySelection(e){let t=this.getNonObjectsState().nextSelectionNumber;this.store.shallowMutate("selectedIds",i=>{for(let o in e)e[o]?i[o]||(i[o]=t,t+=1):delete i[o]}),this.store.set("nextSelectionNumber",t)}_addObjects(e){this.store.shallowMutate("objects",t=>{for(let i of e)t[i.id]=i})}_deleteObjects(e){if(!e.length)return;let t={};this.store.shallowMutate("objects",i=>{for(let o of e)t[o]=Vle,delete i[o]}),this._modifySelection(t),this.store.shallowMutate("uncommittedIds",i=>{for(let o of e)delete i[o]})}createCustomToolOutput(e){var n;this.generateIdsForNewToolOutputs(e);let{idMap:t}=this.getNonObjectsState().ui.currentTool,i=[],o=this.getNonObjectsState().ui;for(let a of e.outputs){let s={...a,id:t[a.id],color:this.defaultColorForObject(o,a),parents:Ple(a,t)};i.push(s)}for(let a of e.inputs)if((n=a.numberInputInfo)!=null&&n.sliderInfo){let s=a.numberInputInfo.sliderInfo,l=t[`${a.id}-number`];if(ul(l)){let c=c4(l);if(c&&c in __dcg_shared_module_exports__['cc'])continue;this.controller.getItemsByIdentifier(__dcg_shared_module_exports__['wb'](l)).length||i.push({type:"slider",latex:l+"="+s.value,sliderInfo:s,id:p9,parents:[],hidden:!1,color:"#000"})}}this._shouldNewObjectsBeMarkedUncommitted()&&this.store.shallowMutate("uncommittedIds",a=>{for(let s of i)a[s.id]=!0}),this._addObjects(i)}_getReusableIdForCurrentInput(e){let t=this.getCurrentTool();if(!t.getSpec)return;let{inputIndex:i,reusableInputIdMap:o}=this.getNonObjectsState().ui.currentTool,a=t.getSpec().inputs[i];if(!a)return;let s=a.id;return e!==void 0&&(s+="-"+e),o[s]}_createInputObject(e,t){let i,o=this._shouldNewObjectsBeMarkedUncommitted();o?i=this._getReusableIdForCurrentInput(t)||this.generateObjectId():i=this.generateObjectId(),o&&this.store.set(["uncommittedIds",i],!0);let n=this.defaultColorForObject(this.getNonObjectsState().ui,e),a={hidden:e.type==="point"&&!!e.previewOnly,...e,id:i,color:n};return this._addObjects([a]),i}attemptLockToolInputIn(e){let{inputIndex:t,idMap:i}=this.getNonObjectsState().ui.currentTool,o=this.getCurrentTool();if(!(o instanceof fi))return;let n=o.getSpecIdToLockIn(e,t);if(!n)return;let a=i[n];if(!a){this.getCurrentTool().canNextInputBePoint()||this.controller.dispatch({type:"select-geo-tool",tool:"selection"});return}let s=a&&this.store.getState().objects[a];if(s&&s.type==="point"&&s.previewOnly){this.controller.dispatch({type:"select-geo-tool",tool:"selection"});return}this.store.set(["ui","currentTool","inputIndex"],t+1),this.store.set(["ui","currentTool","lockedIds",a],!0);for(var l=0;l<2;l++){let c=n+"-"+l,d=i[c];d&&this.store.set(["ui","currentTool","lockedIds",d],!0)}o.didLockInput(e),this.updateFadeAnimations()}generateIdsForNewToolOutputs(e){let{idMap:t}=this.getNonObjectsState().ui.currentTool,i=!1,o={};for(let n of e.outputs)t[n.id]||(i=!0,o[n.id]=this.generateObjectId());i&&this.store.set(["ui","currentTool","idMap"],{...t,...o})}tentativelyMatchToolInput(e,t){let{currentTool:i}=this.getNonObjectsState().ui,o=i.inputIndex,n=e.inputs[o];if(!n)return;let a=n.id;this.store.set(["ui","currentTool","idMap",a],t)}storeNumberInputLatex(e,t){let{currentTool:i}=this.getNonObjectsState().ui,o=i.inputIndex,n=e.inputs[o];if(!(n!=null&&n.numberInputInfo))return;let a=n.id;this.store.set(["ui","currentTool","idMap",`${a}-number`],t)}createToolInputDependency(e,t,i){let o=this._createInputObject(e,i),{currentTool:n}=this.getNonObjectsState().ui,a=n.inputIndex,s=t.inputs[a];if(!s)throw Ii("geo tool could not find input in spec",{metaData:{fnArgs:{objectDef:e,toolSpec:t,depIndex:i},localVars:{newObjectId:o,currentTool:n,inputIndex:a,input:s},toolState:this.store.getState()}}),new Error("programming error: could not find input "+a+" in spec");let l=s.id;return this.store.set(["ui","currentTool","idMap",l+"-"+i],o),o}isObjectALockedToolInput(e){return!!this.getNonObjectsState().ui.currentTool.lockedIds[e]}isDegenerateInput(e){let t=this.getCurrentTool();return t instanceof fi?t.isDegenerateInput(e):!1}getEnabledAdditionalTools(){return c9.filter(e=>!0)}getAdditionalTools(){return this.getEnabledAdditionalTools()}isAnyAdditionalToolEnabled(){return this.getAdditionalTools().length>0}setObjectSelected(e){let t={};t[e]=Ale,this._modifySelection(t)}setObjectsSelected(e){__dcg_shared_module_exports__['g'](e,t=>{this.setObjectSelected(t)})}deleteSelectedObjects(){let e=this.getSelectedObjectIdsUnsorted();this._deleteObjects(e)}isObjectHovered(e){let t=this.getNonObjectsState().hoveredObjects;for(let i of t)if("calcId"in i&&i.calcId===e)return!0;return!1}isObjectUncommitted(e){return!!this.getNonObjectsState().uncommittedIds[e]}getUncommittedObjectIds(){return Object.keys(this.getNonObjectsState().uncommittedIds)}getUncommittedObjects(){let e={},t=this.store.getState().objects,i=this.getUncommittedObjectIds();for(let o of i)e[o]=t[o];return e}isValidNextInputType(e){let t=this.getCurrentTool(),i=t.getNonPointInputType();return e&&__dcg_shared_module_exports__['db'](e)&&(e=__dcg_shared_module_exports__['eb'](e)),!!(i&&e&&V1(e,i)||t.canNextInputBePoint()&&e&&V1(e,"point"))}recordCommittedOutput(e){this.store.shallowMutate(["ui","currentTool","outputHistory"],t=>{t[e]=!0})}updateFadeAnimations(){let e=this.controller.getAllItemModels(),t=Date.now(),i=-1/0;this.store.shallowMutate(["fadeAnimations"],o=>{var s,l;if(this.getCurrentTool().shouldHighlightRelevantObjects())for(let c of e){if(c.type!=="expression"||!c.latex)continue;let d=c.id,p=(s=c.formula)==null?void 0:s.geometry,g,h=p==null?void 0:p.valueType;p!=null&&p.unconstructable||this.controller.shouldIgnoreGraphInteractions(c)?g="fade-out":this.isValidNextInputType(__dcg_shared_module_exports__['va'])&&(Hf(n1(h))||__dcg_shared_module_exports__['db'](h)&&Hf(n1(__dcg_shared_module_exports__['eb'](h))))||h&&__dcg_shared_module_exports__['ib'](h,__dcg_shared_module_exports__['Da'])&&this.isValidNextInputType(__dcg_shared_module_exports__['Fa'])||this.isValidNextInputType(h)||this.store.getState().ui.currentTool.outputHistory[d]?g="fade-in":g="fade-out";let f=this.store.getState().fadeAnimations[d];if(f&&f.type!==g){let y=__dcg_shared_module_exports__['Cb'](t-f.start,0,150),x=t+y-150;o[d]={type:g,start:x},i=Math.max(i,x)}else if(g==="fade-out"){let y=(l=f==null?void 0:f.start)!=null?l:t;o[d]={type:"fade-out",start:y},i=Math.max(i,y)}}else{for(let c in o)o[c]={type:"fade-in",start:t-150};i=t-150}}),isFinite(i)&&this.store.set("maxAnimationEndTime",i+150)}getToolFadeOpacity(e){let t=this.controller.getItemModel(e);if((t==null?void 0:t.type)!=="expression")return 1;let i=this.store.getState().fadeAnimations[t.id];if(!i)return 1;let o=Date.now(),n=__dcg_shared_module_exports__['Cb']((o-i.start)/150,0,1),a=i.type==="fade-in"?.2:1,s=i.type==="fade-in"?1:.2;return a*(1-n)+s*n}isFading(){return Date.now()<=this.store.getState().maxAnimationEndTime}isObjectSelected(e){return!!this.getNonObjectsState().selectedIds[e]}getSelectedObjectIdsUnsorted(){return Object.keys(this.getNonObjectsState().selectedIds)}getSelectedObjectIdsSorted(){let e=this.getNonObjectsState().selectedIds,t=this.getSelectedObjectIdsUnsorted();return __dcg_shared_module_exports__['q'](t,o=>e[o])}deselectAllObjects(){this._deselectAll()}getToolMode(){return this.getNonObjectsState().ui.currentTool.name}setToolMode(e){let t=this.getToolMode();this.store.set(["ui","currentTool"],{name:e,idMap:{},reusableInputIdMap:{},lockedIds:{},inputIndex:0,outputHistory:e!==t?{}:this.store.getState().ui.currentTool.outputHistory}),this.updateFadeAnimations(),e!==t&&this.controller.isGraphPaperFocused()&&(Kt(this.getCurrentToolDisplayName()+"."),this.speakCurrentGeoToolHint())}resetToolMode(){this.setToolMode(this.getToolMode())}areAnyObjectsHovered(){return!!this.getNonObjectsState().hoveredObjects.length}setObjectHovered(e){this.store.deepMutate(t=>{t.hoveredObjects.push(e)})}objectIsInstanceOf(e,t){let i=e==null?void 0:e.typedRuntimeValue.valueType;if(i)return V1(i,t)}getSelectionBox(){return this.getTool("selection").getSelectionBox()}commitObjects(){this.store.set("uncommittedIds",{}),this.store.set("objects",{})}applyTransformation(e){}getProjection(){return this.controller.get2dProjection()}_getPixelsAwayFromDef(e,t,i){let o=i.typedRuntimeValue;switch(o.valueType){case __dcg_shared_module_exports__['va']:{let a=t.mapx(o.value[0]),s=t.mapy(o.value[1]);return __dcg_shared_module_exports__['da'](e.x-a,e.y-s)-6}case __dcg_shared_module_exports__['La']:case __dcg_shared_module_exports__['Fa']:case __dcg_shared_module_exports__['Na']:case __dcg_shared_module_exports__['Va']:{let n,a,s,l;if(o.valueType===__dcg_shared_module_exports__['Va']){let[[g,h],[f,y]]=Nf(o.value);n=t.mapx(g),s=t.mapy(h),a=t.mapx(f),l=t.mapy(y)}else n=t.mapx(o.value[0][0]),s=t.mapy(o.value[0][1]),a=t.mapx(o.value[1][0]),l=t.mapy(o.value[1][1]);let c=o.valueType===__dcg_shared_module_exports__['La'],d=o.valueType===__dcg_shared_module_exports__['La']||o.valueType===__dcg_shared_module_exports__['Na'],p=__dcg_shared_module_exports__['ha'](e.x,e.y,n,s,a,l,c,d);return p?__dcg_shared_module_exports__['da'](p[0]-e.x,p[1]-e.y):1/0}case __dcg_shared_module_exports__['Ha']:{let n=o.value[0][0],a=o.value[0][1],s=o.value[1],l=0,c=Math.PI*2,d=t.reverse_mapx(e.x),p=t.reverse_mapy(e.y),g=__dcg_shared_module_exports__['ia'](d,p,n,a,s,l,c);return g?t.screen.width/(t.viewport.xmax-t.viewport.xmin)*__dcg_shared_module_exports__['da'](g[0]-d,g[1]-p):1/0}case __dcg_shared_module_exports__['Ja']:{let n=__dcg_shared_module_exports__['Nb'](o.value);if(!n)return 1/0;let a=(s,l,c,d)=>{let p=t.mapx(s[0]),g=t.mapy(s[1]),h=t.mapx(l[0]),f=t.mapy(l[1]),y=__dcg_shared_module_exports__['ha'](e.x,e.y,p,g,h,f,c,d);return y?__dcg_shared_module_exports__['da'](y[0]-e.x,y[1]-e.y):1/0};if(n.type==="arc"){let s=t.reverse_mapx(e.x),l=t.reverse_mapy(e.y),c=__dcg_shared_module_exports__['ia'](s,l,n.center[0],n.center[1],n.radius,n.startAngle,n.endAngle);return c?t.screen.width/(t.viewport.xmax-t.viewport.xmin)*__dcg_shared_module_exports__['da'](c[0]-s,c[1]-l):1/0}else return n.type==="segment"?a(n.start,n.end,!1,!1):Math.min(a(n.start1,n.end1,!1,!0),a(n.start2,n.end2,!1,!0))}case __dcg_shared_module_exports__['Da']:{let n=[];return o.value.forEach(a=>{n.push(t.mapx(a[0]),t.mapy(a[1]))}),__dcg_shared_module_exports__['ra'](n,[e.x,e.y])?0:1/0}case __dcg_shared_module_exports__['Pa']:case __dcg_shared_module_exports__['Ra']:{let n=t.screen.width/(t.viewport.xmax-t.viewport.xmin),a=t.screen.height/(t.viewport.ymax-t.viewport.ymin),[[s,l],c,d]=o.value,p=Lg(d,t),g=p/n,h=t.reverse_mapx(e.x),f=t.reverse_mapy(e.y),y=1/0,x=f-l,E=h-s,C=Math.atan2(x,E);if(__dcg_shared_module_exports__['ba'](C,c,d))__dcg_shared_module_exports__['da'](x*a,E*n)<=p+7&&(y=0);else{let S=__dcg_shared_module_exports__['ga'](h,f,s+g*Math.cos(c),l+g*Math.sin(c),s,l),v=__dcg_shared_module_exports__['ga'](h,f,s+g*Math.cos(c+d),l+g*Math.sin(c+d),s,l),M=__dcg_shared_module_exports__['da'](n*(S[0]-h),a*(S[1]-f)),A=__dcg_shared_module_exports__['da'](n*(v[0]-h),a*(v[1]-f));y=Math.min(M,A)}return y}case __dcg_shared_module_exports__['Ta']:return 1/0;default:return 1/0}}getAllChoosableDefsUnordered(e){var g;if(!this.controller.isGeometry())return[];let t=[],i=e.mode==="tab",o=e.mode==="mouse",n=i&&this.controller.getActiveTool()==="box-selection",a=!1,s=!1,l=this.getCurrentTool();(g=l.isValidNextInputType)!=null&&g.call(l,__dcg_shared_module_exports__['va'])&&(a=!0),l.shouldUseJitEdges()&&(l.isValidNextInputType(__dcg_shared_module_exports__['Fa'])||l.isValidNextInputType(__dcg_shared_module_exports__['La'])||l.isValidNextInputType(__dcg_shared_module_exports__['Na']))&&(s=!0);let c=o&&a;c&&(s=!0);let{lockedIds:d,reusableInputIdMap:p}=this.store.getState().ui.currentTool;return _f({controller:this.controller},(h,f)=>{var x,E;if(!h.isGraphableAndInteractive)return;let y=h.assignment;for(let C in p)if(p[C]===y&&!d[y])return;if(!h.hidden&&!h.data.unconstructable&&!(this.getToolMode()==="expression-edit"&&((x=h.data)!=null&&x.depends_on_selected))&&!(n&&this.controller.isClickableId(h.calcId))&&!(i&&this.isDegenerateInput(h==null?void 0:h.assignment))&&!(i&&f)){if(h.typedRuntimeValue.valueType===__dcg_shared_module_exports__['Da'])if(h.typedRuntimeValue.value.length){if(s){let C=h;if(C.typedRuntimeValue.valueType===__dcg_shared_module_exports__['Da']){let S=C.typedRuntimeValue.value;for(let v=0;v<S.length;v++){let M=S[v],A=S[(v+1)%S.length],I=C.referenceLatex+".\\operatorname{segments}\\left["+(v+1)+"\\right]",P={calcId:C.calcId,listIndex:C.listIndex,hidden:C.hidden,isGraphableAndInteractive:!1,assignment:I,referenceLatex:I,data:C.data,typedRuntimeValue:{valueType:__dcg_shared_module_exports__['Fa'],value:[M,A]},polygonEdgeInfo:{edgeNumber:v,polygonDef:C}};t.push(P)}}}}else return;if(c&&!__dcg_shared_module_exports__['ib'](h.typedRuntimeValue.valueType,__dcg_shared_module_exports__['Da'])){t.push(h);return}if((E=l.isValidNextInputType)!=null&&E.call(l,h.typedRuntimeValue.valueType)){t.push(h);return}}}),t}_getObjectsUnderMouse(e,t){let i=this.getAllChoosableDefsUnordered({mode:"mouse"}),o=this.getProjection(),n=[];i.forEach(l=>{let c=this._getPixelsAwayFromDef(e,o,l),d=l.polygonEdgeInfo?-1:0;if(c<=t){let p={def:l,layerNumber:d,pixelsAway:c};n.push(p)}});let a=this.controller.get2dSketchOrder(),s={};for(let l=0;l<a.length;l++)s[a[l]]=l;return n.sort((l,c)=>{let d=c.layerNumber-l.layerNumber;if(d!==0)return d;let p=l.pixelsAway-c.pixelsAway;if(p!==0)return p;let g=s[l.def.calcId];return s[c.def.calcId]-g}),n}convertCanvasPixelsToPoint(e){return this.getProjection().reverse_map_pt(e)}convertPointToCanvasPixels(e){return this.getProjection().map_pt(e)}deleteObjectsAndRememberReusableId(e){for(let t in e)this._deleteObjects([e[t]]);this._deleteObjects([p9]),this.store.shallowMutate(["ui","currentTool"],t=>t.reusableInputIdMap=e)}getObjectDefUnderMouse(e,t){let i=this.convertPointToCanvasPixels(e),o=this._getObjectsUnderMouse(i,t)[0];return o&&o.def}getOrCreatePointNearMouse(e,t){let i=this.convertPointToCanvasPixels(e),o=this._getObjectsUnderMouse(i,t),n=[];for(let g of o){let h=g.def,f=cW(h);f==="Point"?n.push({def:h,type:f}):(Hf(f)||f==="Vector")&&n.push({def:h,type:f})}let{def:a,type:s}=n[0]||{},{def:l,type:c}=n[1]||{},d=this.controller.isGeoToolEnabled("point");if(s==="Point")return{type:"def",def:a};if(Hf(s)&&Hf(c)){let g=l9(a,l).map(h=>({x:h.x,y:h.y,i:h.i,pixelsFromPoint:u9(this.getProjection(),Rg(h.x-e.x,h.y-e.y))}));if(g.sort((h,f)=>h.pixelsFromPoint-f.pixelsFromPoint),g=g.filter(h=>h.pixelsFromPoint<5),g[0]){let h=g[0].i===0?[a,l]:[l,a],f=this.findIncidentPointDef(a,l);if(f!=null&&f.hidden){let y=!1,x;if(h2(f.typedRuntimeValue,(E,C)=>{let[S,v]=E.value,M=this.getProjection().mathToPixels.mapPoint({x:S,y:v});Rg(M.x-i.x,M.y-i.y)<t&&(y=!0,x=C)}),y)return x!==void 0&&(f=g2(f,x)),{type:"spec",spec:{type:"point-reference",targetSpec:{type:"intersection",parentDefs:h},parentDefs:[f]}}}return{type:"spec",spec:{type:"intersection",parentDefs:h}}}else if(d)return h9(this.getProjection(),e,a)}else{if(d&&Hf(s))return h9(this.getProjection(),e,a);if(s==="Vector"){let h=Nf(a.typedRuntimeValue.value).map((f,y)=>({index:y,point:{x:f[0],y:f[1]},pixelsFromPoint:u9(this.getProjection(),Rg(f[0]-e.x,f[1]-e.y))})).sort((f,y)=>f.pixelsFromPoint-y.pixelsFromPoint).filter(f=>f.pixelsFromPoint<5);if(h.length>0)return Ole(a,h[0].index===1?1:0)}}let p=_le(this.getProjection(),e);return{type:"spec",spec:{type:"point",x:p.x,y:p.y,parentDefs:[],previewOnly:!d}}}findIncidentPointDef(e,t){let i=e.typedRuntimeValue.valueType,o=t.typedRuntimeValue.valueType,n={};_f({controller:this.controller,expandLists:!1},s=>{if(s.data.identifier&&__dcg_shared_module_exports__['ib'](s.typedRuntimeValue.valueType,__dcg_shared_module_exports__['va'])){let l=s.data.identifier;n[l]=s}});let a=__dcg_shared_module_exports__['Fc']({getGeometryTree:s=>s.data.call,isPointOrListOfPoints:s=>__dcg_shared_module_exports__['ib'](s.typedRuntimeValue.valueType,__dcg_shared_module_exports__['va']),lookup:s=>n[s],resolvesTo:(s,l)=>s===l.data.identifier},e,i,t,o);if(a){let[s,l]=a,c=n[s];return l===void 0?c:g2(c,l)}}_shouldNewObjectsBeMarkedUncommitted(){return this.getToolMode()!=="selection"}clearHoveredObjects(){this.store.set("hoveredObjects",[])}getHoveredItems(){return this.store.getState().hoveredObjects}cancelToolplay(){this._deleteObjects(this.getUncommittedObjectIds()),this.clearHoveredObjects(),this.resetToolMode()}isToolplayActive(){return this.getNonObjectsState().ui.currentTool.inputIndex>0}getComputedBoard(){let e=new TE;return _f({controller:this.controller},(t,i)=>{e.add(t,i)}),e}findDefsForInputId(e){let t=[];return _f({controller:this.controller},i=>{(i.assignment===e||i.referenceLatex===e)&&t.push(i)}),t}isCreatingNewTransform(){return this.getCurrentTool().toolType==="transformation"}getCurrentToolDisplayName(){return this.controller.s(this.getCurrentTool().displayName)}isCurrentToolComplex(){return this.getCurrentTool().toolType==="complex"}isCurrentToolSingleUse(){return this.getCurrentTool().toolType==="transformation"}getIconInstructionsForTool(e){let t=this.getTool(e);return t?t.icon:[]}getDisplayNameForTool(e){let t=this.getTool(e);return t?this.controller.s(t.displayName):""}speakCurrentGeoToolHint(){Te(this.getCurrentTool().getHint())}};function _le(r,e){var t=dR(r,e);t&&(e=t);var i=.5/g9(r);return{x:Yi(e.x-i,e.x+i),y:Yi(e.y-i,e.y+i)}}function g9(r){return r.mapx(1)-r.mapx(0)}function u9(r,e){return g9(r)*e-6}function h9(r,e,t){var i=U1(r,e,t.typedRuntimeValue);return{type:"spec",spec:{type:"glider",t:i,parentDefs:[t]}}}function Ole(r,e){return{type:"spec",spec:{type:"vector-endpoint",location:e?"end":"start",parentDefs:[r]}}}function Rle(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}var Fle="ID_",iu=function(){function r(){Rle(this,r),this._callbacks={},this._isDispatching=!1,this._isHandled={},this._isPending={},this._lastID=1}return r.prototype.register=function(t){var i=Fle+this._lastID++;return this._callbacks[i]=t,i},r.prototype.unregister=function(t){this._callbacks[t]||VE(!1,"Dispatcher.unregister(...): `%s` does not map to a registered callback.",t),delete this._callbacks[t]},r.prototype.waitFor=function(t){this._isDispatching||VE(!1,"Dispatcher.waitFor(...): Must be invoked while dispatching.");for(var i=0;i<t.length;i++){var o=t[i];if(this._isPending[o]){this._isHandled[o]||VE(!1,"Dispatcher.waitFor(...): Circular dependency detected while waiting for `%s`.",o);continue}this._callbacks[o]||VE(!1,"Dispatcher.waitFor(...): `%s` does not map to a registered callback.",o),this._invokeCallback(o)}},r.prototype.dispatch=function(t){this._isDispatching&&VE(!1,"Dispatch.dispatch(...): Cannot dispatch in the middle of a dispatch."),this._startDispatching(t);try{for(var i in this._callbacks)this._isPending[i]||this._invokeCallback(i)}finally{this._stopDispatching()}},r.prototype.isDispatching=function(){return this._isDispatching},r.prototype._invokeCallback=function(t){this._isPending[t]=!0,this._callbacks[t](this._pendingPayload),this._isHandled[t]=!0},r.prototype._startDispatching=function(t){for(var i in this._callbacks)this._isPending[i]=!1,this._isHandled[i]=!1;this._pendingPayload=t,this._isDispatching=!0},r.prototype._stopDispatching=function(){delete this._pendingPayload,this._isDispatching=!1},r}();function VE(r,e,t,i,o,n,a,s){if(e===void 0)throw new Error("invariant requires an error message argument");if(!r){var l;if(e===void 0)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[t,i,o,n,a,s],d=0;l=new Error(e.replace(/%s/g,function(){return c[d++]})),l.name="Invariant Violation"}throw l.framesToPop=1,l}}var vh=class{constructor(e=100){this.clear(),this._sizeLimit=e}clear(){this._stack=[],this._stackPointer=-1}getState(){return this._stack[this._stackPointer]}serializeForBugsnag(){function e(t){try{return JSON.stringify(t,null,2)}catch(i){return"[[could not jsonify]]"}}return{currentState:e(this._stack[this._stackPointer]),undoState:e(this._stack[this._stackPointer-1]),redoState:e(this._stack[this._stackPointer+1])}}addState(e){this.canRedo()&&this._stack.splice(this._stackPointer+1),this._stack.push(e),this._stack.length>this._sizeLimit&&this._stack.shift(),this._stackPointer=this._stack.length-1}replaceState(e){this.canRedo()&&this._stack.splice(this._stackPointer+1),this.replaceInteriorState(e)}replaceInteriorState(e){this._stack.length===0?(this._stack.push(e),this._stackPointer=0):this._stack[this._stackPointer]=e}canUndo(){return this._stackPointer>0}canRedo(){return this._stackPointer<this._stack.length-1}undo(){this.canUndo()&&(this._stackPointer-=1)}redo(){this.canRedo()&&(this._stackPointer+=1)}};var pR=r=>({value:r.degreeMode?"30":"0.5",min:"0",max:r.degreeMode?"360":"2\\pi"}),m9={min:"0",max:"5",value:"1"},jx=r=>({min:"0",max:"1",value:`${r}`}),Ble={latex:void 0,polarDomainMin:void 0,polarDomainMax:void 0,parametricDomainMin:void 0,parametricDomainMax:void 0,parametricDomain3DuMin:void 0,parametricDomain3DuMax:void 0,parametricDomain3DvMin:void 0,parametricDomain3DvMax:void 0,parametricDomain3DrMin:void 0,parametricDomain3DrMax:void 0,parametricDomain3DphiMin:void 0,parametricDomain3DphiMax:void 0,clickableInfoLatex:void 0,colorLatex:void 0,tableColumnColorLatex:void 0,cdfMin:()=>({value:"0",min:"-10",max:"10"}),cdfMax:()=>({value:"0",min:"-10",max:"10"}),pointSize:()=>({value:8+"",min:"0",max:"20"}),movablePointSize:()=>({value:8+"",min:"0",max:"20"}),tableColumnPointSize:()=>({value:8+"",min:"0",max:"20"}),labelAngle:pR,labelSize:()=>({value:"1",min:"0",max:"5"}),lineWidth:()=>({value:2.5+"",min:"0",max:"10"}),resolution:()=>({value:"50",min:"2",max:"100",step:"1"}),tableColumnLineWidth:()=>({value:2.5+"",min:"0",max:"10"}),fillOpacity:()=>({value:.4+"",min:"0",max:"1"}),lineOpacity:()=>({value:1+"",min:"0",max:"1"}),tableColumnLineOpacity:()=>jx(1),pointOpacity:()=>jx(1),tableColumnPointOpacity:()=>jx(1),sliderMin:void 0,sliderMax:void 0,sliderStep:void 0,residualVariable:void 0,tableHeader:void 0,tableCellValue:void 0,imageOpacity:()=>({value:"1",min:"0",max:"1"}),imageCenter:void 0,imageHeight:()=>({value:"10",min:"-10",max:"10"}),imageWidth:()=>({value:"10",min:"-10",max:"10"}),imageAngle:pR,tickerMinStep:()=>({value:"0",min:"0"}),tickerHandler:void 0},f9={tone:{paramBounds:r=>r===0?{value:"440",min:"110",max:"880"}:jx(.5)},glider:{paramBounds:r=>{if(r!==0)return jx(.5)}},dilate:{paramBounds:r=>{if(!(r<2))return{value:"2",min:"0",max:"5"}}},rotate:{paramBounds:(r,e)=>{if(!(r<2))return pR(e)}},circle:{paramBounds:r=>{if(r===1)return m9}},normaldist:{paramBounds:r=>{if(r===0)return{min:"-5",max:"5",value:"0"};if(r===1)return m9}},rgb:{paramBounds:r=>({value:"0",min:"0",max:"255",step:"1"})},hsv:{paramBounds:r=>r===0?{value:"0",min:"0",max:"360",step:"1"}:jx(.5)}};function y9(r,e,t){var i=r.map(function(a){return{location:a.location,parsed:__dcg_shared_module_exports__['Ec'](a.latex)}}),o={};for(let a of e)for(let s of i){var n=Ule(a,s,t);n&&n.length&&(o[a]=n[0])}return o}function Ule(r,{parsed:e,location:t},i){if(e.type==="Identifier"&&e._symbol===r){let n=Ble[t];return n?[n(i)]:void 0}e.type==="Assignment"&&(e=e._expression);let o=[];switch(e.type){case"FunctionCall":{let n=e._symbol;if(f9.hasOwnProperty(n)){let a=f9[n];e.args.forEach(function(s,l){if(s.type==="Identifier"&&s._symbol===r){var c=a.paramBounds(l,i);c&&o.push(c)}})}break}default:return}return o}function Xn(r,e,t){let i=Kle(r,e,t);Vi(r,i)}function Vi(r,e){if(r.focusLocation=e,!e||(e.type==="ticker"&&(r.getListModel().ticker.playing=!1,vi(r.getListModel(),void 0)),e.type==="settings"||e.type==="generic-menu"||e.type==="editable-label"||e.type==="add-item-btn"||e.type==="add-expression-btn"||e.type==="add-note-btn"||e.type==="add-table-btn"||e.type==="add-folder-btn"||e.type==="add-ticker-btn"||e.type==="add-image-btn"||e.type==="edit-list-toggle"||e.type==="hide-expression-list-btn"||e.type==="show-expression-list-btn"||e.type==="zoom-in-btn"||e.type==="zoom-restore-btn"||e.type==="search-expressions"||e.type==="replace-expressions"||e.type==="ticker"||e.type==="geo-token"||e.type==="geo-show-constructions-icon"||e.type==="geo-basic-tool"||e.type==="geo-basic-tool-menu-item"||e.type==="multi-select-more-icon"||e.type==="multi-select-transformations-icon"||e.type==="geo-header-back-link"||e.type==="multi-select-delete-icon"||e.type==="multi-select-show-hide-icon"||e.type==="new-transformation-number"||e.type==="label-points-icon"||e.type==="graph-paper"||e.type==="quest"||e.type==="global-mute-button"))return;let t=r.getItemModel(e.id);if(e.type==="expression-menu"){vi(r.getListModel(),void 0);return}else vi(r.getListModel(),t);t&&t.type==="expression"&&$l(t,!1)}function Kle(r,e,t){let i=r.getItemModel(e);if(!i)return;let o=r.isInEditListMode()||r.isItemReadonly(i.id);switch(i.type){case"expression":return{type:o?"readonly-expression":i.type,id:e};case"folder":case"text":return{type:i.type,id:e};case"table":{let a={row:1,column:0},s=!1;return t&&(t.location==="cell"?a={row:t.row,column:t.column}:t==="end"?a={row:bc(i),column:0}:t==="start"?a={row:0,column:0}:t==="container"&&(s=!0)),s?{type:"table-container",id:e}:{type:i.type,id:e,location:a}}case"image":return{type:i.type,id:e,location:"name"};default:return i}}function x9(r){var e=r.getSelectedItem();if(e&&e.type==="expression"&&!e.readonly){Xn(r,e.id);return}if(e&&e.type==="table"&&r.focusLocation&&!e.readonly)return;var t=r.getFirstFullyVisibleItem();let i=r.getListModel();for(;t&&(t.type!=="expression"||t.readonly);)t=yf(i,t.index);if(t){Xn(r,t.id);return}let o=r.createItemModel({type:"expression",id:r.generateId(),color:r.getNextColor()});Bd(r.getListModel(),o),Xn(r,o.id)}function w9(r){let e=r.focusLocation;if(e&&!(e.type==="settings"||e.type==="generic-menu"||e.type==="editable-label"||e.type==="add-item-btn"||e.type==="add-expression-btn"||e.type==="add-note-btn"||e.type==="add-table-btn"||e.type==="add-ticker-btn"||e.type==="add-folder-btn"||e.type==="add-image-btn"||e.type==="edit-list-toggle"||e.type==="hide-expression-list-btn"||e.type==="show-expression-list-btn"||e.type==="zoom-in-btn"||e.type==="zoom-restore-btn"||e.type==="search-expressions"||e.type==="replace-expressions"||e.type==="ticker"||e.type==="geo-token"||e.type==="geo-show-constructions-icon"||e.type==="geo-basic-tool"||e.type==="geo-basic-tool-menu-item"||e.type==="multi-select-more-icon"||e.type==="multi-select-transformations-icon"||e.type==="geo-header-back-link"||e.type==="multi-select-delete-icon"||e.type==="multi-select-show-hide-icon"||e.type==="new-transformation-number"||e.type==="label-points-icon"||e.type==="graph-paper"||e.type==="quest"||e.type==="global-mute-button"))return r.getItemModel(e.id)}function Yx(r,e,t){Vi(r,{type:"table",id:e,location:t})}function C9(r,e,t){var i=r.getItemModel(e);if(!i||i.type!=="table")return;let o=i;var n=ds(o),a=n?n.row:-1,s=n?n.column:-1,l=o.columnModels,c=bc(o),d=l.length,p=(x,E)=>{x===-1?hR(r):x>c?gR(r):(E===-1?(E=d-1,x--):E===d&&(x++,E=0),Yx(r,e,{row:x,column:E}))},g=x=>{c>2&&Sq(o,a-1),Yx(r,e,{row:x,column:s})},h=x=>{s===0||d<=2||(Dq(o,s),Yx(r,e,{row:a,column:x}))};let f=!!o.columnModels[0].disabled;switch(t){case"Left":p(a,s-1);break;case"Right":p(a,s+1);break;case"Up":p(a-1,s);break;case"Down":p(a+1,s);break;case"Enter":if(a>=c)return bR(r);if(s>0||f)return p(a+1,s);if(a===c-1){let x=kq(o,a);bO(o,a);for(var y=0;y<x.length;y++)ch(o,{row:a+1,column:y},x[y]);Yx(r,e,{row:a+1,column:s});return}bO(o,a),Yx(r,e,{row:a+1,column:s});break;case"Backspace":a===0?s===0?mR(r):s===d-1||s===1&&d===3?p(0,s-1):h(s-1):s!==0?p(a,s-1):a===c||f?p(a-1,s):g(a-1);break;case"Delete":a===0?s===0?fR(r):s<d-1&&h(s):a>=c||f||g(a);break}}function hR(r){if(r.inAudioTraceMode())return;let e=r.getFocusLocation();if((e==null?void 0:e.type)==="ticker"&&r.getExpressionSearchOpen())return Vi(r,{type:"search-expressions"});var t=r.getSelectedItem();if(!t)return;if(VG(r.getListModel())){if(t=r.getSelectedItem(),!t)return;Xn(r,t.id,"end")}else r.getTickerVisible()?Vi(r,{type:"ticker",location:"handler"}):r.getExpressionSearchOpen()&&Vi(r,{type:"search-expressions"})}function gR(r){if(r.inAudioTraceMode())return;let e=r.getFocusLocation();if((e==null?void 0:e.type)==="search-expressions"&&r.getTickerVisible())return Vi(r,{type:"ticker",location:"handler"});if((e==null?void 0:e.type)==="ticker"||(e==null?void 0:e.type)==="search-expressions"){let i=tx(r.getListModel());if(i)return Xn(r,i.id,"start")}if(!LG(r.getListModel())&&!r.isInEditListMode()){let i=r.createItemModel({type:"expression",id:r.generateId(),color:r.getNextColor()});Bd(r.getListModel(),i),vi(r.getListModel(),i)}var t=r.getSelectedItem();t&&Xn(r,t.id,"start")}function mR(r){if(r.isInEditListMode())return;var e=r.getSelectedItem();if(!e||r.getItemCount()===1&&e.type==="expression")return;var t=e.type==="text";let i=bl(e);if(i){let o=r.getNumberOfItemsInFolder(i.id);if(e.index===i.index+o){Ba(e,"");return}}if(yR(r,{moveSelection:!0}),t&&ll&&Qu){vi(r.getListModel(),void 0);return}e=r.getSelectedItem(),e&&Xn(r,e.id,"end")}function fR(r){if(!r.isInEditListMode()){var e=r.getSelectedItem();e&&(r.getItemCount()===1&&e.type==="expression"||(xR(r,{moveSelection:!0}),e=r.getSelectedItem(),e&&Xn(r,e.id,"start")))}}function bR(r){if(!r.isInEditListMode()){var e=r.getSelectedItem();if(e){if(e.type==="text"&&ll&&Qu){pi(),vi(r.getListModel(),void 0);return}if(TC(e).length&&r.areSlidersEnabled())return r.createSlidersForItem(e.id,TC(e).concat(""));var t=r.createItemModel({type:"expression",id:r.generateId(),color:r.getNextColor()}),i=e.index+1;e.type==="folder"&&e.collapsed&&(i+=r.getNumberOfItemsInFolder(e.id)),fc(r.getListModel(),t,i),vi(r.getListModel(),t),e.type==="folder"&&!e.collapsed?Ba(t,e.id):e.type!=="folder"&&e.folderId&&Ba(t,e.folderId),e=r.getSelectedItem(),e&&Xn(r,e.id)}}}function yR(r,{moveSelection:e}){let t=r.getSelectedItem(),i=r.getListModel();if(!t||r.isItemReadonly(t.id))return;let o=bf(i,t.index);if(r._removeExpressionSynchronously(t),e){if(!o){let n=tx(i);n&&(o=n)}vi(i,o)}else vi(i,void 0)}function xR(r,{moveSelection:e}){let t=r.getSelectedItem(),i=r.getListModel();if(!t||r.isItemReadonly(t.id))return;let o=yf(i,t.index);if(r._removeExpressionSynchronously(t),e){if(!o){let n=TG(i);n&&(o=n)}vi(i,o)}else vi(i,void 0)}function Hle(r){switch(r){case"histogram":case"dotplot":return 12;case"boxplot":return 40}return 1/0}function Wle(r){return r==="boxplot"||r==="dotplot"||r=="histogram"}function $le(r){return r==="boxplot"?3:.5}function jle(r,e){if(r.type==="dotplot"||r.type==="histogram"){let o=Math.max(1,r.xmax-r.xmin)*80/(r.binWidth?r.binWidth:1),n=.5*(e.screen.width-o)/o;return Math.max(.2,n)}return .5}function Yle(r,e,t){r=__dcg_shared_module_exports__['Z'](r);let i=1.2;return e&&r.xmax<0&&r.xmin<0&&r.xmax/(r.xmin-r.xmax)<i&&(r.xmax=0),e&&r.xmax>0&&r.xmin>0&&r.xmin/(r.xmax-r.xmin)<i&&(r.xmin=0),t&&r.ymax<0&&r.ymin<0&&r.ymax/(r.ymin-r.ymax)<i&&(r.ymax=0),t&&r.ymax>0&&r.ymin>0&&r.ymin/(r.ymax-r.ymin)<i&&(r.ymin=0),r}function Xle(r,e,t,i){let o=r.type,n=jle(r,e),a=$le(o),s,l,c,d;if(r.xmin===r.xmax&&(t?(r.xmin-=.5,r.xmax+=.5):(r.xmin*=.5,r.xmax/=.5)),r.ymin===r.ymax&&(i?(r.ymin-=.5,r.ymax+=.5):(r.ymin*=.5,r.ymax/=.5)),t){let p=(r.xmax-r.xmin)*n;s=r.xmin-p,l=r.xmax+p}else{let p=(r.xmax/r.xmin)**n;s=r.xmin/p,l=r.xmax*p}if(i){let p=(r.ymax-r.ymin)*a;c=r.ymin-p,d=r.ymax+p}else{let p=(r.ymax/r.ymin)**a;c=r.ymin/p,d=r.ymax*p}if(Wle(o)){let p=e.screen.height/e.screen.width,g=(l-s)*p;if(g>r.ymax-r.ymin&&g<Hle(o)*(r.ymax-r.ymin)){let h=.5*(r.ymax+r.ymin);d=h+.5*g,c=h-.5*g}}return{xmin:s,xmax:l,ymin:c,ymax:d}}function wR(r,e){var t=LE(r,e);if(!t)return!1;let{xAxisScale:i,yAxisScale:o}=e.settings;if(!di.fromObject(t).isValid({xAxisScale:i,yAxisScale:o}))return!1;var a=e.mapx(t.xmin),s=e.mapx(t.xmax),l=e.mapy(t.ymin),c=e.mapy(t.ymax),d=10,p=Math.abs(a)<=d&&Math.abs(c)<=d&&Math.abs(s-e.screen.width)<=d&&Math.abs(l-e.screen.height)<=d;return!p}function LE(r,e){let t=1/0,i=-1/0,o=1/0,n=-1/0,a=0,s=r.length,l=e.settings.xAxisScale==="linear",c=e.settings.yAxisScale==="linear";for(let d=0;d<s;d++){let p=Yle(r[d],l,c);if(!isFinite(p.xmax-p.xmin)||!isFinite(p.ymax-p.ymin)){a+=1;continue}if(!l&&!(p.xmax>0&&p.xmin>0)||!c&&!(p.ymax>0&&p.ymin>0)){a+=1;continue}let g=Xle(p,e,l,c);g.xmin<t&&(t=g.xmin),g.xmax>i&&(i=g.xmax),g.ymin<o&&(o=g.ymin),g.ymax>n&&(n=g.ymax)}if(a!==s)return{xmin:t,xmax:i,ymin:o,ymax:n}}function E9(r){switch(r){case"letters":return"capitalLetters";case"noQwertyLetters":return"noQwertyCapitalLetters";case"noQwertyCapitalLetters":return"noQwertyLetters";default:return"letters"}}function S9(r){switch(r){case"mainNumbers":return"mainNumbers3D";default:return r}}function vR(r){return{keypadMinimized:!OP,keypadLayout:"mainNumbers",keypadFunctionsOpen:!1,graphSettingsOpen:!1,addExpressionOpen:!1,expressionsVisible:!!r.expressions,inEditListMode:!1,isFileDraggedOver:!1,expressionsHiddenTime:void 0}}var k9={xmin:"",xmax:"",xstep:"",ymin:"",ymax:"",ystep:"",zmin:"",zmax:""};function G9(r){return r in k9}function Jle(r){let e=r.split("\xD7");return(e.length>1&&e[0]==="1"?e.slice(1):e).join("\\cdot")}function Wf(r,e){let t=__dcg_shared_module_exports__['ob'](r,e),i="";if(t.mantissa)i=Jle(t.mantissa)+"^{"+t.superscript+"}";else{let o=t.string.split("/");o.length===2?o[0][0]==="-"?i="-\\frac{"+o[0].slice(1)+"}{"+o[1]+"}":i="\\frac{"+o[0]+"}{"+o[1]+"}":i=t.string}return i=i.replace(//,"\\pi"),i}function Qle(r,e){let t=e.xAxisScale==="linear"?r.xmax-r.xmin:void 0,i=e.yAxisScale==="linear"?r.ymax-r.ymin:void 0,o={xmin:Wf(r.xmin,t),xmax:Wf(r.xmax,t),ymin:Wf(r.ymin,i),ymax:Wf(r.ymax,i)};return r.zmin!==void 0&&r.zmax!==void 0&&(o.zmin=Wf(r.zmin,r.zmax-r.zmin),o.zmax=Wf(r.zmax,r.zmax-r.zmin)),o}function D9(r,e){return r===0?"":Wf(r,e)}function T9(r,e){return{...Qle(r,e.scales),xstep:D9(e.steps.xAxisStep,r.xmax-r.xmin),ystep:D9(e.steps.yAxisStep,r.ymax-r.ymin)}}function CR(){return{limitLatex:{...k9}}}qt();as();function M9(r){let e=[],t=r.getAllItemModels();for(let i of t){let o=r.getItemRootNodeById(i.id);o&&e.push(o)}return e}function ece(r){let e=r.getAllItemModels();for(let t=e.length-1;t>=0;t--){let i=e[t];if(i.dcgView)return i.id}}function I9(r,e){let t=M9(r),i=0,o=t.length-1;for(;i<=o;){let n=i+Math.floor((o-i)/2),a=t[n],s=a.getBoundingClientRect();if(s.top>e)o=n-1;else if(s.bottom<e)i=n+1;else return a}}function tce(r,e){let t=M9(r),i=0,o=t.length-1,n;for(;i<=o;){let a=i+Math.floor((o-i)/2),s=t[a];s.getBoundingClientRect().top>e?(o=a-1,n=s):i=a+1}return n}function A9(r,e){let t=_E(r);if(!t)return;if(e){let o=r.getItemRootNodeById(e);if(o){let n=o.getBoundingClientRect();if(n.height>0&&n.top<=t.top&&n.bottom>=t.top)return e}}let i=I9(r,t.top);return i?i.getAttribute("expr-id"):ER(r)}function V9(r,e){let t=_E(r);if(!t)return;let i=ece(r);if(!i)return;if(e){let n=r.getItemRootNodeById(e);if(n){let a=n.getBoundingClientRect();if(a.height>0&&a.top<=t.bottom&&a.bottom>=t.bottom||e===i&&a.bottom<=t.bottom)return e}}let o=I9(r,t.bottom);return o&&o.getAttribute("expr-id")||i}function ER(r){let e=_E(r);if(!e)return;let t=tce(r,e.top-2);if(t)return t.getAttribute("expr-id")}function PE(r){return r.findEl(".dcg-exppanel")}function _E(r){let e=PE(r);if(e)return e.getBoundingClientRect()}function L9(r){let e=r.findEl(".dcg-exppanel-container");if(!e)return;let t=e.getBoundingClientRect(),i=e.scrollTop;return t.top-i}function P9(r){let e=r.findEl(".dcg-expressionlist");if(!e)return;let t=e.getBoundingClientRect();return{width:t.width,height:t.height}}function _9(r){let e=PE(r);if(!e)return;let t=e.querySelector(".dcg-drag-container > *");if(!t)return;let i=t.getBoundingClientRect();return{width:i.width,height:i.height}}qt();var OE=class{constructor(e){this.active=!1,this.controller=e;let t=this.controller.getExppanelElt();t&&(this.exppanel=t)}startDragging(e){this.active=!0,this.mousePt=e,this.setupEventListeners()}applyDrag(){var S;let t=this.controller.getListModel().dragState;if(!t)return;this.scheduleUpdateScroll();let i=this.measureDOM(t);if(!i)return;let{floatingPreviewRect:o,dragState:n,visibleRects:a}=i,s=this.controller.getItemModel(n.firstItemId);if(!s)return;let l=s.index,c=a[0];if(c&&c.id!==s.id){let v=this.controller.getItemModel(c.id);v&&v.index>l&&(l=v.index-1)}let{cachedNamedAssignmentLatex:d,cachedTokenAssignmentLatex:p}=n;for(let{id:v,rect:M}of a){if(v===s.id)continue;let A=this.controller.getItemModel(v);if(!A)return;if(A.index<s.index){if(o.top<M.top+M.height/2){l=A.index;break}}else o.bottom>M.top+M.height/2&&(l=A.index,A.type==="folder"&&A.collapsed&&(l+=this.controller.getNumberOfItemsInFolder(A.id)))}let g,h;l>s.index?(g=l,h=l+1):l<s.index?(g=l-1,h=l):(g=l-1,h=l+1);let f=this.controller.getItemModelByIndex(g),y=this.controller.getItemModelByIndex(h),x="",E="";f&&(f.type==="folder"?x=f.id:x=f.folderId),y&&(y.type==="folder"?E=y.id:E=y.folderId);let C="";if(x&&(E===x?s.type==="folder"?l=s.index:C=x:s.type!=="folder"&&this.isPreviewTopContainedInFolder(i,x)&&(C=x)),s.type==="expression")if(n.renderType==="token"){if(t.renderType==="expression"&&(d=s.latex,this.controller.convertToTokenAssignment(s,p)),n.dragTarget.type==="token")l=n.dragTarget.originalIndex,C=((S=this.controller.getGeometryFolder())==null?void 0:S.id)||"";else if(n.dragTarget.type==="expression"){let v=this.controller.getGeometryFolder();if(v){let M=this.controller.getNumberOfItemsInFolder(v.id);s.type==="expression"&&s.folderId===v.id&&(M-=1),l=v.index+M+1,C=v.id}}}else n.renderType==="expression"&&t.renderType==="token"&&(p=s.latex,this.controller.convertToNamedAssignment(s,d));return{dragState:{...n,cachedNamedAssignmentLatex:d,cachedTokenAssignmentLatex:p},newIndex:l,folderId:C}}measureDOM(e){let t=L9(this.controller),i=P9(this.controller),o=_9(this.controller);if(t===void 0||!i||!o)return;let n=i.height,a=o.height,s=!1,l=this.controller.getExppanelElt(),c=l==null?void 0:l.querySelector(".dcg-template-expressioneach"),d=c==null?void 0:c.getBoundingClientRect();d&&d.top<=e.mousePt.y&&(s=!0);let p=!1,g=l==null?void 0:l.querySelector(".dcg-geo-show-constructions-pane"),h=g==null?void 0:g.getBoundingClientRect();h&&h.bottom>e.mousePt.y&&(p=!0);let f=!1;(e.dragTarget.type==="token"&&!s||e.dragTarget.type==="expression"&&p&&!s&&this.controller.canDraggedItemBeMovedIntoTokenPane())&&(f=!0);let y=e.grabOffset;f?y={x:o.width/2,y:o.height/2}:e.dragTarget.type==="token"&&(y={x:0,y:o.height/2});let x=e.mousePt.y-y.y+2,E=x-t;E=Math.max(E,-a/2),E=Math.min(E,n-a);let C=0;f&&(C=e.mousePt.x-y.x,C=Math.min(C,i.width-o.width-4),C=Math.max(C,0),E=Math.max(E,2));let S={left:C,top:x,bottom:x+a,height:a},v=this.controller.findFirstVisibleItem(),M=this.controller.findLastVisibleItem(),A=[];if(v&&M)for(var I=v.index;I<=M.index;I++){let P=this.controller.getItemModelByIndex(I);if(!P)continue;let _=this.controller.getItemRootNodeById(P.id);if(_&&P.id!==e.firstItemId){let U=_.getBoundingClientRect();A.push({id:P.id,rect:U})}}return{dragState:{...e,itemTop:E,itemLeft:C,renderType:f?"token":"expression"},floatingPreviewRect:S,visibleRects:A}}isPreviewTopContainedInFolder(e,t){let{visibleRects:i,floatingPreviewRect:o}=e;for(let{id:n,rect:a}of i)if(a.top<=o.top&&a.bottom>=o.top){let s=this.controller.getItemModel(n);if(!s)return!1;if(s.type==="folder"&&s.id===t||s.type!=="folder"&&s.folderId===t)return!0}return!1}scheduleUpdateScroll(){this.updateScrollScheduled||(this.updateScrollScheduled=!0,requestAnimationFrame(()=>{this.updateScroll(),this.updateScrollScheduled=!1}))}stop(){this.active=!1,this.tearDownEventListeners(),this.controller.dispatch({type:"stop-dragdrop"})}setupEventListeners(){ie(document).on("dcg-tapmove.dragdrop",e=>{this.mousePt.x=e.changedTouches[0].clientX,this.mousePt.y=e.changedTouches[0].clientY,this.controller.dispatch({type:"update-dragdrop",mousePt:this.mousePt})}),ie(document).on("dcg-tapend.dragdrop",e=>{this.stop(),e.handle("dragdrop")})}tearDownEventListeners(){ie(document).off(".dragdrop")}updateScroll(){if(this.active){var e=this.exppanel.getBoundingClientRect(),t=0;t=Math.min(t,this.mousePt.y-e.top),t=Math.max(t,this.mousePt.y-e.bottom+30),t=t*e.height/900,t&&(this.exppanel.scrollTop=this.exppanel.scrollTop+t)}}};var rce={loga:(r,e)=>{Ze.canAcceptText(r,e.capExpressionSize,"\\log_{}\\left(\\right)")&&(r.write("\\log_{}"),r.typedText("("),r.keystroke("Left"),r.keystroke("Down"))},nthroot:(r,e)=>{Ze.canAcceptText(r,e.capExpressionSize,"\\sqrt[]{}")&&(r.write("\\sqrt[]{}"),r.keystroke("Left"),r.keystroke("Left"))},ddx:(r,e)=>{Ze.canAcceptText(r,e.capExpressionSize,"\\frac{d}{dx}")&&r.write("\\frac{d}{dx}")},arcsin:(r,e)=>{Ze.canAcceptText(r,e.capExpressionSize,"\\sin^{-1}\\left(\\right)")&&(r.write("sin^{-1}"),r.typedText("("))},arccos:(r,e)=>{Ze.canAcceptText(r,e.capExpressionSize,"\\cos^{-1}\\left(\\right)")&&(r.write("cos^{-1}"),r.typedText("("))},arctan:(r,e)=>{Ze.canAcceptText(r,e.capExpressionSize,"\\tan^{-1}\\left(\\right)")&&(r.write("tan^{-1}"),r.typedText("("))},arcsec:(r,e)=>{Ze.canAcceptText(r,e.capExpressionSize,"\\sec^{-1}\\left(\\right)")&&(r.write("sec^{-1}"),r.typedText("("))},arccsc:(r,e)=>{Ze.canAcceptText(r,e.capExpressionSize,"\\csc^{-1}\\left(\\right)")&&(r.write("csc^{-1}"),r.typedText("("))},arccot:(r,e)=>{Ze.canAcceptText(r,e.capExpressionSize,"\\cot^{-1}\\left(\\right)")&&(r.write("cot^{-1}"),r.typedText("("))},"A^T":(r,e)=>{Ze.canAcceptText(r,e.capExpressionSize,"^{T}")&&(r.typedText("^T"),r.keystroke("Right"))},"A^-1":(r,e)=>{Ze.canAcceptText(r,e.capExpressionSize,"^{-1}")&&(r.typedText("^-1"),r.keystroke("Right"))},"A^2":(r,e)=>{Ze.canAcceptText(r,e.capExpressionSize,"^{2}")&&(r.typedText("^2"),r.keystroke("Right"))},"a^2":(r,e)=>{Ze.canAcceptText(r,e.capExpressionSize,"^{2}")&&(r.typedText("^2"),r.keystroke("Right"))},"a^3":(r,e)=>{Ze.canAcceptText(r,e.capExpressionSize,"^{3}")&&(r.typedText("^3"),r.keystroke("Right"))},"a/b":(r,e)=>{Ze.canAcceptText(r,e.capExpressionSize,"\\frac{}{}")&&(r.write("\\frac{}{}"),r.keystroke("Left"))},integral:(r,e)=>{Ze.canAcceptText(r,e.capExpressionSize,"\\int_{}^{}")&&r.cmd("integral")}};function Xx(r,e,t){rce[e](r,t)}function O9(r){if(!r)return;let e=[];for(let t of r.split(" ")){let i=t.indexOf("|"),o=i!==-1?t.slice(0,i):t;e.push(o)}return e}function Jx(r,e,t){let i=O9(t);return e==="nemeth"?bh(r,{operatorNames:i}):e==="ueb"?yh(r,{operatorNames:i}):{isError:!0,error:"Braille mode should be 'nemeth' or 'ueb'"}}function K1(r,e,t){let i=O9(t);return e==="nemeth"?z2(r,{operatorNames:i}):e==="ueb"?K2(r,{operatorNames:i}):{isError:!0,error:"Braille mode should be 'nemeth' or 'ueb'"}}var gs=__dcg_shared_module_exports__['e'](te());var Qx=__dcg_shared_module_exports__['e'](te());qt();var{Input:ice}=Qx.Components,$f=class extends Qx.Class{init(){this.ASCIICharacters=` A1B'K2L@CIF/MSP"E3H9O6R^DJG>NTQ,*5<-U8V.%[$+X!&;:4\\0Z7(_?W]#Y)=`,this.ASCIITable=[],this.HomeRowCharacters="FDSJKL",this.charCodes=[],this.sixKeyModel={keysDown:0,stickyKeysDown:0};let e;for(e=0;e<this.ASCIICharacters.length;e++)this.ASCIITable.push(this.ASCIICharacters.charCodeAt(e));for(e=0;e<this.HomeRowCharacters.length;e++)this.charCodes.push(this.HomeRowCharacters.charCodeAt(e))}template(){return Qx.createElement(ice,{class:this.const("dcg-braille-input dcg-do-blur"),tabindex:()=>this.props.tabindex?this.props.tabindex():0,readonly:()=>this.props.isStatic()?"true":void 0,autocomplete:this.const("off"),autocorrect:this.const("off"),autocapitalize:this.const("off"),spellcheck:this.const("false"),onKeydown:this.bindFn(this.onKeydown),onKeyup:this.bindFn(this.onKeyup),onInput:this.bindFn(this.props.onInput),value:()=>this.props.value(),"aria-label":()=>this.props.ariaLabel()||Kl(""),didMount:this.bindFn(this.didMount),didUnmount:this.bindFn(this.props.didUnmount),placeholder:()=>this.props.placeholder?this.props.placeholder():"",size:()=>this.props.size&&this.props.size()})}didMount(e){this.rootNode=e,ie(this.rootNode).on("focus",t=>{this.props.shouldFocus()||this.props.onFocusedChanged(!0,t.originalEvent||t)}).on("blur",t=>{this.props.shouldFocus()&&this.props.onFocusedChanged(!1,t.originalEvent||t)}),this.props.didMount(e),this.updateFocus()}didUpdate(){this.updateFocus()}updateFocus(){this.rootNode&&(this.props.shouldFocus()&&document.activeElement!==this.rootNode&&this.rootNode.focus(),!this.props.shouldFocus()&&document.activeElement===this.rootNode&&this.rootNode.blur())}onKeydown(e){let t=this.charCodes.indexOf(e.which);!this.props.isStatic()&&this.isSixKeyInput()&&!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&t!==-1?(this.sixKeyModel={...this.sixKeyModel,keysDown:this.addKey(this.sixKeyModel.keysDown,t),stickyKeysDown:this.addKey(this.sixKeyModel.stickyKeysDown,t)},e.preventDefault()):this.props.onKeydown&&this.props.onKeydown(e)}onKeyup(e){let t=this.charCodes.indexOf(e.which),i=!1;return!this.props.isStatic()&&this.isSixKeyInput()&&!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&t!==-1?(this.sixKeyModel={...this.sixKeyModel,keysDown:this.removeKey(this.sixKeyModel.keysDown,t)},this.sixKeyModel.keysDown===0&&(this.addCharacter(this.bitsToASCII(this.sixKeyModel.stickyKeysDown)),this.sixKeyModel={...this.sixKeyModel,stickyKeysDown:0})):i=!0,i||e.preventDefault(),i}addKey(e,t){return e|1<<t}removeKey(e,t){return e&~(1<<t)}bitsToASCII(e){return String.fromCharCode(this.ASCIITable[e])}addCharacter(e){this.rootNode&&!this.props.isStatic()&&(this.rootNode.setRangeText(e,this.rootNode.selectionStart,this.rootNode.selectionEnd,"end"),this.props.onInput(this.rootNode.value))}isSixKeyInput(){return typeof this.props.sixKeyInput=="function"&&this.props.sixKeyInput()}};var{If:kR}=gs.Components,_o=class extends gs.Class{init(){this.currentBrailleValue=this.getBrailleFromLatex(this.props.latex()),this.currentBrailleMode=this.props.mode(),this.hasTranslationError=!1,this.currentLatex=this.props.latex()}isFocused(){return this.brailleInput!==void 0&&document.activeElement==this.brailleInput}getBrailleShouldFocus(){return this.props.mode()!=="none"&&this.props.brailleShouldFocus&&this.props.brailleShouldFocus()}isStatic(){return!!this.props.isStatic&&this.props.isStatic()}isInline(){return!!this.props.isInline&&this.props.isInline()}hasError(){return!!this.props.hasError&&this.props.hasError()}willUpdate(){let e=this.currentLatex!==this.props.latex(),t=this.props.mode(),i=t!==this.currentBrailleMode&&t!=="none";this.isFocused()&&!e&&!i||(this.currentLatex=this.props.latex(),(i||!this.hasTranslationError||e||this.isStatic())&&(this.currentBrailleValue=this.getBrailleFromLatex(this.props.latex()),this.hasTranslationError=!1),this.currentBrailleMode=t)}onBrailleInput(e){if(!this.props.onBrailleInput)return;let t=this.getLatexFromBraille(e);this.hasTranslationError=t.isError;let i=this.props.capExpressionSize&&this.props.capExpressionSize();if(!t.isError&&i&&i.exceedsLimit(t.value)){i.onExpressionSizeExceeded();return}this.currentBrailleValue=e,t.isError||(this.currentLatex=t.value,this.props.onBrailleInput(t.value))}getBrailleFromLatex(e,t=!1){let i=Jx(e,this.props.mode(),this.props.operatorNames&&this.props.operatorNames());return i.isError?"":t?i.value:As.toExpandedBrailleAscii(i.value)}getLatexFromBraille(e){return K1(As.coerceToSixDotCells(e),this.props.mode(),this.props.operatorNames&&this.props.operatorNames())}getBrailleLabel(e){return this.getBrailleFromLatex(e.replace(/\s/,"\\ "))}shouldShowBraille(){let e=this.props.mode();return e==="nemeth"||e==="ueb"}isOverflowingLeft(){return this.brailleInput?this.brailleInput.scrollLeft>0:!1}isOverflowingRight(){if(!this.brailleInput)return!1;let e=this.brailleInput.getBoundingClientRect().width,t=this.brailleInput.scrollWidth,i=this.brailleInput.scrollLeft;return t>e+i+2}didMountBrailleInput(e){this.brailleInput=e}didUnmountBrailleInput(){this.brailleInput=void 0}handleBrailleFocusChanged(e,t){this.props.onBrailleFocusedChanged&&this.props.onBrailleFocusedChanged(e,t),this.brailleInput&&(e&&this.props.selectOnFocus&&this.props.selectOnFocus()&&this.brailleInput.select(),this.isStatic()&&this.brailleInput.scrollTo(0,0))}getTooltipText(){let e=this.props.placeholder&&!this.isFocused()?this.props.placeholder():"";return Kl(this.props.latex()||e)}template(){return gs.createElement("div",{class:gs.const("dcg-mathquill-wrapper")},gs.createElement(kR,{predicate:()=>this.shouldShowBraille()},()=>gs.createElement("div",{class:()=>({"dcg-mathquill-braille":!0,"dcg-focus":this.getBrailleShouldFocus(),"dcg-invalid":this.hasError(),"dcg-mathquill-static-braille":this.isStatic(),"dcg-mathquill-braille-overflow-left":this.isOverflowingLeft(),"dcg-mathquill-braille-overflow-right":this.isOverflowingRight()}),"data-dcg-label":()=>this.props.dataLabelAttributeValue?this.props.dataLabelAttributeValue():void 0},gs.createElement(Ix,{tooltip:()=>this.getTooltipText(),gravity:this.const("s"),delay:this.const(0),showOnTapstart:this.const(!0)},gs.createElement(kR,{predicate:()=>this.isInline()},()=>gs.createElement("span",{class:gs.const("dcg-inline-braille")},()=>Kl(this.getBrailleFromLatex(this.props.latex(),!0)))),gs.createElement(kR,{predicate:()=>!this.isInline()},()=>gs.createElement($f,{ariaLabel:()=>Kl(this.props.ariaLabel?this.getBrailleLabel(this.props.ariaLabel()):""),didMount:this.bindFn(this.didMountBrailleInput),didUnmount:this.bindFn(this.didUnmountBrailleInput),onFocusedChanged:this.bindFn(this.handleBrailleFocusChanged),shouldFocus:this.bindFn(this.getBrailleShouldFocus),onKeydown:this.props.onBrailleKeydown,onInput:this.bindFn(this.onBrailleInput),sixKeyInput:this.props.sixKeyInput,value:()=>this.currentBrailleValue,placeholder:()=>Kl(this.props.placeholder?this.getBrailleFromLatex(this.props.placeholder()):""),tabindex:()=>this.props.tabindex?this.props.tabindex():0,isStatic:this.bindFn(this.isStatic),size:()=>this.currentBrailleValue&&this.currentBrailleValue.length||1}))))),gs.createElement("div",{class:gs.const("dcg-typeset-math"),style:()=>({display:this.shouldShowBraille()&&!this.isInline()?"none":void 0}),"aria-hidden":()=>this.shouldShowBraille()},this.children))}};function vl(){if(!(!document.activeElement||!document.activeElement.classList.contains("dcg-braille-input")))return document.activeElement}function Zx(r){return!r||r.value===""}function oce(r){for(let e in r)return!1;return!0}function nce(r){var i;if(r.type!=="expression")return;let e=r.formula.assignment;return e||((i=r.formula.geometry)==null?void 0:i.identifier)}function ace(r){var t,i;let e={lookupIdentifier:{},lookupCalcId:{}};for(let o of r){let n={calcId:o.id,identifier:nce(o),referencesTheseIdentifiers:{},referencedByTheseCalcIds:{}};e.lookupCalcId[n.calcId]=n,n.identifier&&(e.lookupIdentifier[n.identifier]=n)}for(let o of r){let n=e.lookupCalcId[o.id];if(n){if(o.type==="expression"){o.folderId===__dcg_shared_module_exports__['jd']&&(n.isGarbageCollectable=!o.readonly,(o.latex.indexOf("\\operatorname{segments}")!==-1||Op(o))&&(n.deleteIfNotReferenced=!0));let a=(i=(t=o.formula.geometry)==null?void 0:t.call)==null?void 0:i.parents;a&&a.forEach(s=>{if(!s)return;let l=s[0];R9(e,n,l)})}Jy(o,a=>{var s=a.match(/(\\token{[0-9]+})/g);if(s)for(let l of s){let c=__dcg_shared_module_exports__['wb'](l);c!==n.identifier&&R9(e,n,c)}})}}return e}function R9(r,e,t){e.referencesTheseIdentifiers[t]=!0;let i=r.lookupIdentifier[t];i&&(i.referencedByTheseCalcIds[e.calcId]=!0)}function sce(r,e,t){var c;let i=[];for(let d of e){let p=r.lookupCalcId[d];if(p){i.push(p);var o=p.referencesTheseIdentifiers;for(let g in o){let h=r.lookupIdentifier[g];h&&delete h.referencedByTheseCalcIds[p.calcId]}}}var n={};for(let d in t)for(let p of t[d]){let g=r.lookupIdentifier[p];g&&delete g.referencedByTheseCalcIds[d],n[p]=!0}var a={};for(let d of i){let p=d.referencesTheseIdentifiers;for(let h in p)n[h]=!0;let g=d.identifier;if(g){var s=(c=r.lookupIdentifier[g])==null?void 0:c.referencedByTheseCalcIds;if(s)for(let h in s){let f=r.lookupCalcId[h];f&&f.isGarbageCollectable&&(a[h]=!0)}}}for(let d in n){let p=r.lookupIdentifier[d];if(p&&p.deleteIfNotReferenced){var l=p.referencedByTheseCalcIds;p.calcId&&p.isGarbageCollectable&&oce(l)&&(a[p.calcId]=!0)}}for(let d of i)delete r.lookupCalcId[d.calcId],d.identifier&&delete r.lookupIdentifier[d.identifier];return Object.keys(a)}function F9(r,e,t){var c,d;let i=r.getAllItemModels(),o=e.map(p=>p.id),n=ace(i.concat(e));var a={};let s={};for(let p in t){let{nextLatex:g}=t[p],h=r.getItemModel(p);if((h==null?void 0:h.type)!=="expression")continue;let f={};for(let x of((d=(c=h.formula.geometry)==null?void 0:c.call)==null?void 0:d.parents)||[]){if(!x)continue;let[E]=x;f[E]=!0}for(let x in f)Od(g,__dcg_shared_module_exports__['ub'](x))&&delete f[x];let y=Object.keys(f);y.length&&(s[p]=y)}let l=Object.keys(s).length>0;for(;o.length||l;){l=!1,o=sce(n,o,s);for(let p of o)a[p]=!0}return Object.keys(a)}var N9={version:ed,randomSeed:"",graph:{product:"graphing-3d",threeDMode:!0,viewport:{...__dcg_shared_module_exports__['kc']}},expressions:{list:[{id:"1",type:"expression"}]}};function q1(r){return/^\s*(https?:\/\/)?([-a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/calculator\/./.test(r)}function GR(r){return/^\s*(https?:\/\/)?([-a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/(geometry|geometry-beta)\/./.test(r)}function TR(r){return/^\s*(https?:\/\/)?([-a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/3d\/./.test(r)}function MR(r){return/^\s*(https?:\/\/)?([-a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/geometry-legacy\/./.test(r)}function B9(r){return q1(r)?"graphing":GR(r)?"geometry-calculator":MR(r)?"geometry":TR(r)?"graphing-3d":void 0}function U9(r,e){if(!r||!e)return"";switch(e){case"graphing":return`https://www.desmos.com/calculator/${r}`;case"geometry-calculator":return`https://www.desmos.com/geometry/${r}`;case"graphing-3d":return`https://www.desmos.com/3d/${r}`}}function z9(r){return/^\s*https?:\/\/([-a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/geo-states\/./.test(r)}var Yo=__dcg_shared_module_exports__['e'](te()),H1=class extends Yo.Class{template(){return Yo.createElement("form",{name:Yo.const("open_graph_on_web"),target:Yo.const("_blank"),method:Yo.const("POST"),action:()=>this.props.saveURL(),style:()=>({display:"none"})},Yo.createElement("input",{type:Yo.const("text"),name:Yo.const("is_open_on_web"),value:Yo.const("true")}),Yo.createElement("input",{type:Yo.const("text"),name:Yo.const("my_graphs"),value:Yo.const("false")}),Yo.createElement("input",{type:Yo.const("text"),name:Yo.const("is_update"),value:Yo.const("false")}),Yo.createElement("input",{type:Yo.const("text"),name:Yo.const("calc_state"),value:()=>this.props.stateData()}),Yo.createElement("input",{type:Yo.const("text"),name:Yo.const("thumb_data"),value:()=>this.props.thumbData()}))}};var K9,q9=(K9=new URLSearchParams(window.location.search).get("translucent-opacity"))!=null?K9:"0.8";var Xo=__dcg_shared_module_exports__['e'](te());var bn=__dcg_shared_module_exports__['e'](te());qt();qt();var ew=class extends Yr{constructor(){super(),this.dragging=!1,this.guid=__dcg_shared_module_exports__['K']("dragdrop-class")}_evt2pt(e){return{x:e.changedTouches[0].pageX-this._offsetPt.x,y:e.changedTouches[0].pageY-this._offsetPt.y}}_dispatch(e,t){if(this._destroyed)return;let i=this._evt2pt(t);this.triggerEvent(e,{x:i.x,y:i.y,dx:i.x-this._startPt.x,dy:i.y-this._startPt.y,evt:t})}destroy(){ie(document).off(`.${this.guid}`),this._destroyed=!0}startDrag(e,t={}){if(!this.dragging)return ie(document).on(`dcg-tapmove.${this.guid}`,i=>{(i.originalEvent||i).preventDefault(),cancelAnimationFrame(this.frameThrottle),this.frameThrottle=requestAnimationFrame(()=>this.doDrag(i))}),ie(document).on(`dcg-tapend.${this.guid} dcg-tapcancel.${this.guid}`,i=>this.endDrag(i)),this._offsetPt={x:0,y:0},t.origin&&(this._offsetPt={x:this._evt2pt(e).x-t.origin.x,y:this._evt2pt(e).y-t.origin.y}),this._startPt=this._evt2pt(e),this.setProperty("dragging",!0),this._dispatch("onGrab",e)}doDrag(e){this.dragging&&this._dispatch("onDrag",e)}endDrag(e){this.dragging&&(ie(document).off(`.${this.guid}`),this.doDrag(e),this.setProperty("dragging",!1),this._dispatch("onDrop",e))}};var{If:lce}=bn.Components,jf=class extends bn.Class{template(){return bn.createElement("div",{class:()=>({"dcg-slider-interior":!0,"dcg-disable-slider":this.shouldDisableSlider()}),didMount:this.bindFn(this.didMountRoot),onTapStart:this.bindFn(this.onStartDrag)},bn.createElement("div",{class:bn.const("dcg-track")},bn.createElement("div",{class:bn.const("dcg-ticks"),onMount:this.bindFn(this.didMountTickMarks)}),bn.createElement("div",{class:bn.const("dcg-graphic")})),bn.createElement(lce,{predicate:this.bindFn(this.shouldShowZeroMarker)},()=>bn.createElement("div",{class:bn.const("dcg-zeroMarker"),style:()=>({left:this.getZeroMarkerPercent()+"%"})})),bn.createElement("div",{class:()=>({"dcg-thumb":!0,"dcg-down":this.isDragging}),role:bn.const("slider"),tabindex:bn.const("0"),disablescroll:bn.const("true"),style:()=>({left:this.getThumbPercent()+"%"}),onKeyDown:this.bindFn(this.onKeyDown),"aria-label":this.props.ariaLabel,"aria-valuemin":()=>{var e,t;return(t=(e=this.props).ariaPercent)!=null&&t.call(e)?0:this.props.min()},"aria-valuemax":()=>{var e,t;return(t=(e=this.props).ariaPercent)!=null&&t.call(e)?100:this.props.max()},"aria-valuenow":()=>{var e,t;return(t=(e=this.props).ariaPercent)!=null&&t.call(e)?void 0:this.props.value()},"aria-valuetext":()=>{var e,t;return(t=(e=this.props).ariaPercent)!=null&&t.call(e)?`${Math.floor(this.getThumbPercent())}%`:void 0},manageFocus:this.buildFocusManager()},bn.createElement("div",{class:bn.const("dcg-graphic")}),bn.createElement("div",{class:bn.const("dcg-center")})))}willUnmount(){this.dragDrop.destroy()}didMountRoot(e){this.rootNode=e,this.dragDrop=new ew,this.isMounted=!0,this.dragDrop.observeEvent("onDrop",()=>{this.isDragging=!1,this.update(),this.props.onDrop&&this.props.onDrop()}),this.dragDrop.observeEvent("onGrab",()=>{this.isDragging=!0,this.update(),this.props.onGrab&&this.props.onGrab()}),this.dragDrop.observeEvent("onDrag",(t,i)=>{this.props.onDragUpdate(this.valueFromPixels(i.x))})}didMountTickMarks(e){this.tickMarksNode=e,this.renderTickMarks()}didUpdate(){this.renderTickMarks()}shouldDisableSlider(){return this.props.min()===this.props.max()}renderTickMarks(){if(this.tickMarksNode){var e=this.props.step(),t=this.props.min(),i=this.props.max(),o;if(e===void 0?o=0:o=100*e/(i-t),o<3&&(o=0),o>100&&(o=0),isNaN(o)&&(o=0),this.lastTickMarksPercent!==o){this.lastTickMarksPercent=o;var n="";if(o>0&&o<100)for(var a=o;a<100;a+=o)n+='<div class="dcg-tick" style="left:'+a+'%"></div>';this.tickMarksNode.innerHTML=n}}}shouldShowZeroMarker(){return this.props.min()<=0&&this.props.max()>=0}getZeroMarkerPercent(){var e=this.props.min(),t=this.props.max();return 100*(0-e)/(t-e)}getThumbPercent(){return 100*this.percentFromValue(this.props.value())}valueFromPixels(e){if(!this.isMounted)return 0;let t=this.props.min(),i=this.props.max(),o=this.rootNode.getBoundingClientRect().width,n=__dcg_shared_module_exports__['Cb'](e/o,0,1),a=t+(i-t)*n,s=(i-t)/o;return Yi(a-s,a+s)}percentFromValue(e){let t=this.props.min(),i=this.props.max();return __dcg_shared_module_exports__['Cb']((e-t)/(i-t),0,1)}pixelsFromValue(e){if(!this.isMounted)return 0;let t=this.percentFromValue(e);return this.rootNode.getBoundingClientRect().width*t}onKeyDown(e){switch(Be(e)){case un:this.props.onUpPress&&(this.props.onUpPress(),e.preventDefault());break;case hn:this.props.onDownPress&&(this.props.onDownPress(),e.preventDefault());break;case dl:this.props.onEnterPress&&(this.props.onEnterPress(),e.preventDefault());break;case rn:document.activeElement&&ie(document.activeElement).trigger("blur");break;case kp:this.props.onKeyboardUpdate("down"),e.preventDefault();break;case Gp:this.props.onKeyboardUpdate("up"),e.preventDefault();break;case ly:this.props.onKeyboardUpdate("bigdown"),e.preventDefault();break;case sy:this.props.onKeyboardUpdate("bigup"),e.preventDefault();break;case cg:this.props.onKeyboardUpdate("min"),e.preventDefault();break;case Dp:this.props.onKeyboardUpdate("max"),e.preventDefault();break}}onStartDrag(e){if(e.device==="keyboard"||!e.target)return;e.preventDefault(),pi();let t={x:0,y:0};e.target.closest(".dcg-thumb")?t.x=this.pixelsFromValue(this.props.value()):t.x=e.changedTouches[0].clientX-this.rootNode.getBoundingClientRect().left,this.dragDrop.startDrag(e,{origin:t})}buildFocusManager(){return!this.props.onFocusedChanged||!this.props.isFocused?this.const(void 0):this.const({shouldBeFocused:this.props.isFocused,onFocusedChanged:this.props.onFocusedChanged})}};var H9="155";var W9=0,IR=1,$9=2;var RE=0,Yf=1,Ls=2;var W1=0,em=1,FE=2,AR=3,VR=4,$1=5,ou=100,j9=101,Y9=102,X9=103,J9=104,j1=200,Y1=201,Q9=202,Z9=203,X1=204,J1=205,e$=206,t$=207,r$=208,i$=209,o$=210,n$=0,a$=1,s$=2,NE=3,l$=4,c$=5,d$=6,p$=7;var LR=300;var BE=1e3,Xf=1001,UE=1002,nu=1003,u$=1004;var PR=1005;var au=1006,h$=1007;var zE=1008;var Ha=1009,g$=1010,m$=1011,tw=1012,Q1=1013,Zd=1014,rd=1015,rw=1016,Z1=1017,eM=1018,su=1020,f$=1021,lu=1023,b$=1024,y$=1025,Ch=1026,tm=1027,x$=1028,tM=1029,w$=1030,rM=1031,iM=1033,oM=33776,nM=33777,aM=33778,sM=33779,_R=35840,OR=35841,RR=35842,FR=35843,v$=36196,NR=37492,BR=37496,UR=37808,zR=37809,KR=37810,qR=37811,HR=37812,WR=37813,$R=37814,jR=37815,YR=37816,XR=37817,JR=37818,QR=37819,ZR=37820,eF=37821,tF=36492,rF=36283,iF=36284,oF=36285,nF=36286;var iw="",ko="srgb",Zl="srgb-linear";var lM=7680;var C$=519,E$=512,S$=513,D$=514,k$=515,G$=516,T$=517,M$=518,I$=519,A$=35044;var aF="300 es",cM=1035,id=2e3,KE=2001;var Ae=class r{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}clone(){return new r(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}applyMatrix3(e){let t=this.x,i=this.y,o=this.z,n=e.elements;return this.x=n[0]*t+n[3]*i+n[6]*o,this.y=n[1]*t+n[4]*i+n[7]*o,this.z=n[2]*t+n[5]*i+n[8]*o,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,i=this.y,o=this.z,n=e.elements,a=1/(n[3]*t+n[7]*i+n[11]*o+n[15]);return this.x=(n[0]*t+n[4]*i+n[8]*o+n[12])*a,this.y=(n[1]*t+n[5]*i+n[9]*o+n[13])*a,this.z=(n[2]*t+n[6]*i+n[10]*o+n[14])*a,this}applyQuaternion(e){let t=this.x,i=this.y,o=this.z,n=e.x,a=e.y,s=e.z,l=e.w,c=l*t+a*o-s*i,d=l*i+s*t-n*o,p=l*o+n*i-a*t,g=-n*t-a*i-s*o;return this.x=c*l+g*-n+d*-s-p*-a,this.y=d*l+g*-a+p*-n-c*-s,this.z=p*l+g*-s+c*-a-d*-n,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}transformDirection(e){let t=this.x,i=this.y,o=this.z,n=e.elements;return this.x=n[0]*t+n[4]*i+n[8]*o,this.y=n[1]*t+n[5]*i+n[9]*o,this.z=n[2]*t+n[6]*i+n[10]*o,this.normalize()}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){return this.multiplyScalar(1/(this.length()||1))}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let i=e.x,o=e.y,n=e.z,a=t.x,s=t.y,l=t.z;return this.x=o*l-n*s,this.y=n*a-i*l,this.z=i*s-o*a,this}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,i=this.y-e.y,o=this.z-e.z;return t*t+i*i+o*o}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixColumn(e,t){let i=t*4,o=e.elements;return this.x=o[i],this.y=o[i+1],this.z=o[i+2],this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}};var rr=class r{constructor(e,t,i,o,n,a,s,l,c,d,p,g,h,f,y,x){this.isMatrix4=!0;this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,i,o,n,a,s,l,c,d,p,g,h,f,y,x)}set(e,t,i,o,n,a,s,l,c,d,p,g,h,f,y,x){let E=this.elements;return E[0]=e,E[4]=t,E[8]=i,E[12]=o,E[1]=n,E[5]=a,E[9]=s,E[13]=l,E[2]=c,E[6]=d,E[10]=p,E[14]=g,E[3]=h,E[7]=f,E[11]=y,E[15]=x,this}clone(){let e=new r,t=this.elements;for(let i=0;i<16;i++)e.elements[i]=t[i];return e}copy(e){let t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractRotation(e){let t=this.elements,i=e.elements,o=1/sF.setFromMatrixColumn(e,0).length(),n=1/sF.setFromMatrixColumn(e,1).length(),a=1/sF.setFromMatrixColumn(e,2).length();return t[0]=i[0]*o,t[1]=i[1]*o,t[2]=i[2]*o,t[3]=0,t[4]=i[4]*n,t[5]=i[5]*n,t[6]=i[6]*n,t[7]=0,t[8]=i[8]*a,t[9]=i[9]*a,t[10]=i[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,i=e.x,o=e.y,n=e.z,a=Math.cos(i),s=Math.sin(i),l=Math.cos(o),c=Math.sin(o),d=Math.cos(n),p=Math.sin(n);if(e.order==="XYZ"){let g=a*d,h=a*p,f=s*d,y=s*p;t[0]=l*d,t[4]=-l*p,t[8]=c,t[1]=h+f*c,t[5]=g-y*c,t[9]=-s*l,t[2]=y-g*c,t[6]=f+h*c,t[10]=a*l}else if(e.order==="YXZ"){let g=l*d,h=l*p,f=c*d,y=c*p;t[0]=g+y*s,t[4]=f*s-h,t[8]=a*c,t[1]=a*p,t[5]=a*d,t[9]=-s,t[2]=h*s-f,t[6]=y+g*s,t[10]=a*l}else if(e.order==="ZYX"){let g=a*d,h=a*p,f=s*d,y=s*p;t[0]=l*d,t[4]=f*c-h,t[8]=g*c+y,t[1]=l*p,t[5]=y*c+g,t[9]=h*c-f,t[2]=-c,t[6]=s*l,t[10]=a*l}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(cce,e,dce)}lookAt(e,t,i){let o=this.elements;return kc.subVectors(e,t),kc.lengthSq()===0&&(kc.z=1),kc.normalize(),rm.crossVectors(i,kc),rm.lengthSq()===0&&(Math.abs(i.z)===1?kc.x+=1e-4:kc.z+=1e-4,kc.normalize(),rm.crossVectors(i,kc)),rm.normalize(),dM.crossVectors(kc,rm),o[0]=rm.x,o[4]=dM.x,o[8]=kc.x,o[1]=rm.y,o[5]=dM.y,o[9]=kc.y,o[2]=rm.z,o[6]=dM.z,o[10]=kc.z,this}multiply(e){return this.multiplyMatrices(this,e)}multiplyMatrices(e,t){let i=e.elements,o=t.elements,n=this.elements,a=i[0],s=i[4],l=i[8],c=i[12],d=i[1],p=i[5],g=i[9],h=i[13],f=i[2],y=i[6],x=i[10],E=i[14],C=i[3],S=i[7],v=i[11],M=i[15],A=o[0],I=o[4],P=o[8],_=o[12],U=o[1],Y=o[5],R=o[9],H=o[13],O=o[2],q=o[6],w=o[10],T=o[14],B=o[3],de=o[7],F=o[11],j=o[15];return n[0]=a*A+s*U+l*O+c*B,n[4]=a*I+s*Y+l*q+c*de,n[8]=a*P+s*R+l*w+c*F,n[12]=a*_+s*H+l*T+c*j,n[1]=d*A+p*U+g*O+h*B,n[5]=d*I+p*Y+g*q+h*de,n[9]=d*P+p*R+g*w+h*F,n[13]=d*_+p*H+g*T+h*j,n[2]=f*A+y*U+x*O+E*B,n[6]=f*I+y*Y+x*q+E*de,n[10]=f*P+y*R+x*w+E*F,n[14]=f*_+y*H+x*T+E*j,n[3]=C*A+S*U+v*O+M*B,n[7]=C*I+S*Y+v*q+M*de,n[11]=C*P+S*R+v*w+M*F,n[15]=C*_+S*H+v*T+M*j,this}determinant(){let e=this.elements,t=e[0],i=e[4],o=e[8],n=e[12],a=e[1],s=e[5],l=e[9],c=e[13],d=e[2],p=e[6],g=e[10],h=e[14],f=e[3],y=e[7],x=e[11],E=e[15];return f*(+n*l*p-o*c*p-n*s*g+i*c*g+o*s*h-i*l*h)+y*(+t*l*h-t*c*g+n*a*g-o*a*h+o*c*d-n*l*d)+x*(+t*c*p-t*s*h-n*a*p+i*a*h+n*s*d-i*c*d)+E*(-o*s*d-t*l*p+t*s*g+o*a*p-i*a*g+i*l*d)}invert(){let e=this.elements,t=e[0],i=e[1],o=e[2],n=e[3],a=e[4],s=e[5],l=e[6],c=e[7],d=e[8],p=e[9],g=e[10],h=e[11],f=e[12],y=e[13],x=e[14],E=e[15],C=p*x*c-y*g*c+y*l*h-s*x*h-p*l*E+s*g*E,S=f*g*c-d*x*c-f*l*h+a*x*h+d*l*E-a*g*E,v=d*y*c-f*p*c+f*s*h-a*y*h-d*s*E+a*p*E,M=f*p*l-d*y*l-f*s*g+a*y*g+d*s*x-a*p*x,A=t*C+i*S+o*v+n*M;if(A===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let I=1/A;return e[0]=C*I,e[1]=(y*g*n-p*x*n-y*o*h+i*x*h+p*o*E-i*g*E)*I,e[2]=(s*x*n-y*l*n+y*o*c-i*x*c-s*o*E+i*l*E)*I,e[3]=(p*l*n-s*g*n-p*o*c+i*g*c+s*o*h-i*l*h)*I,e[4]=S*I,e[5]=(d*x*n-f*g*n+f*o*h-t*x*h-d*o*E+t*g*E)*I,e[6]=(f*l*n-a*x*n-f*o*c+t*x*c+a*o*E-t*l*E)*I,e[7]=(a*g*n-d*l*n+d*o*c-t*g*c-a*o*h+t*l*h)*I,e[8]=v*I,e[9]=(f*p*n-d*y*n-f*i*h+t*y*h+d*i*E-t*p*E)*I,e[10]=(a*y*n-f*s*n+f*i*c-t*y*c-a*i*E+t*s*E)*I,e[11]=(d*s*n-a*p*n-d*i*c+t*p*c+a*i*h-t*s*h)*I,e[12]=M*I,e[13]=(d*y*o-f*p*o+f*i*g-t*y*g-d*i*x+t*p*x)*I,e[14]=(f*s*o-a*y*o-f*i*l+t*y*l+a*i*x-t*s*x)*I,e[15]=(a*p*o-d*s*o+d*i*l-t*p*l-a*i*g+t*s*g)*I,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],o=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,o))}makeTranslation(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationAxis(e,t){let i=Math.cos(t),o=Math.sin(t),n=1-i,a=e.x,s=e.y,l=e.z,c=n*a,d=n*s;return this.set(c*a+i,c*s-o*l,c*l+o*s,0,c*s+o*l,d*s+i,d*l-o*a,0,c*l-o*s,d*l+o*a,n*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}compose(e,t,i){let o=this.elements,n=t._x,a=t._y,s=t._z,l=t._w,c=n+n,d=a+a,p=s+s,g=n*c,h=n*d,f=n*p,y=a*d,x=a*p,E=s*p,C=l*c,S=l*d,v=l*p,M=i.x,A=i.y,I=i.z;return o[0]=(1-(y+E))*M,o[1]=(h+v)*M,o[2]=(f-S)*M,o[3]=0,o[4]=(h-v)*A,o[5]=(1-(g+E))*A,o[6]=(x+C)*A,o[7]=0,o[8]=(f+S)*I,o[9]=(x-C)*I,o[10]=(1-(g+y))*I,o[11]=0,o[12]=e.x,o[13]=e.y,o[14]=e.z,o[15]=1,this}makePerspective(e,t,i,o,n,a,s=id){let l=this.elements,c=2*n/(t-e),d=2*n/(i-o),p=(t+e)/(t-e),g=(i+o)/(i-o),h,f;if(s===id)h=-(a+n)/(a-n),f=-2*a*n/(a-n);else if(s===KE)h=-a/(a-n),f=-a*n/(a-n);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+s);return l[0]=c,l[4]=0,l[8]=p,l[12]=0,l[1]=0,l[5]=d,l[9]=g,l[13]=0,l[2]=0,l[6]=0,l[10]=h,l[14]=f,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,o,n,a,s=id){let l=this.elements,c=1/(t-e),d=1/(i-o),p=1/(a-n),g=(t+e)*c,h=(i+o)*d,f,y;if(s===id)f=(a+n)*p,y=-2*p;else if(s===KE)f=n*p,y=-1*p;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+s);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-g,l[1]=0,l[5]=2*d,l[9]=0,l[13]=-h,l[2]=0,l[6]=0,l[10]=y,l[14]=-f,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){let t=this.elements,i=e.elements;for(let o=0;o<16;o++)if(t[o]!==i[o])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e,t=0){let i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}},sF=new Ae,cce=new Ae(0,0,0),dce=new Ae(1,1,1),rm=new Ae,dM=new Ae,kc=new Ae;var od=class r{constructor(e=0,t=0,i=0,o=1){this.isQuaternion=!0;this._x=e,this._y=t,this._z=i,this._w=o}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,o){return this._x=e,this._y=t,this._z=i,this._w=o,this._onChangeCallback(),this}clone(){return new r(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){let i=e._x,o=e._y,n=e._z,a=e._order,s=Math.cos,l=Math.sin,c=s(i/2),d=s(o/2),p=s(n/2),g=l(i/2),h=l(o/2),f=l(n/2);switch(a){case"XYZ":this._x=g*d*p+c*h*f,this._y=c*h*p-g*d*f,this._z=c*d*f+g*h*p,this._w=c*d*p-g*h*f;break;case"YXZ":this._x=g*d*p+c*h*f,this._y=c*h*p-g*d*f,this._z=c*d*f-g*h*p,this._w=c*d*p+g*h*f;break;case"ZYX":this._x=g*d*p-c*h*f,this._y=c*h*p+g*d*f,this._z=c*d*f-g*h*p,this._w=c*d*p+g*h*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t!==!1&&this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,i=t[0],o=t[4],n=t[8],a=t[1],s=t[5],l=t[9],c=t[2],d=t[6],p=t[10],g=i+s+p;if(g>0){let h=.5/Math.sqrt(g+1);this._w=.25/h,this._x=(d-l)*h,this._y=(n-c)*h,this._z=(a-o)*h}else if(i>s&&i>p){let h=2*Math.sqrt(1+i-s-p);this._w=(d-l)/h,this._x=.25*h,this._y=(o+a)/h,this._z=(n+c)/h}else if(s>p){let h=2*Math.sqrt(1+s-i-p);this._w=(n-c)/h,this._x=(o+a)/h,this._y=.25*h,this._z=(l+d)/h}else{let h=2*Math.sqrt(1+p-i-s);this._w=(a-o)/h,this._x=(n+c)/h,this._y=(l+d)/h,this._z=.25*h}return this._onChangeCallback(),this}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let i=e._x,o=e._y,n=e._z,a=e._w,s=t._x,l=t._y,c=t._z,d=t._w;return this._x=i*d+a*s+o*c-n*l,this._y=o*d+a*l+n*s-i*c,this._z=n*d+a*c+i*l-o*s,this._w=a*d-i*s-o*l-n*c,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let i=this._x,o=this._y,n=this._z,a=this._w,s=a*e._w+i*e._x+o*e._y+n*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=a,this._x=i,this._y=o,this._z=n,this;let l=1-s*s;if(l<=Number.EPSILON){let h=1-t;return this._w=h*a+t*this._w,this._x=h*i+t*this._x,this._y=h*o+t*this._y,this._z=h*n+t*this._z,this.normalize(),this._onChangeCallback(),this}let c=Math.sqrt(l),d=Math.atan2(c,s),p=Math.sin((1-t)*d)/c,g=Math.sin(t*d)/c;return this._w=a*p+this._w*g,this._x=i*p+this._x*g,this._y=o*p+this._y*g,this._z=n*p+this._z*g,this._onChangeCallback(),this}toArray(e,t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}};var ec=class{hasEventListener(e,t){if(this._listeners===void 0)return!1;let i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}removeEventListener(e,t){if(this._listeners===void 0)return;let o=this._listeners[e];if(o!==void 0){let n=o.indexOf(t);n!==-1&&o.splice(n,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let i=this._listeners[e.type];if(i!==void 0){e.target=this;let o=i.slice(0);for(let n=0,a=o.length;n<a;n++)o[n].call(this,e);e.target=null}}};var Xs=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];var pM=Math.PI/180,lF=180/Math.PI;function nd(){let r=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Xs[r&255]+Xs[r>>8&255]+Xs[r>>16&255]+Xs[r>>24&255]+"-"+Xs[e&255]+Xs[e>>8&255]+"-"+Xs[e>>16&15|64]+Xs[e>>24&255]+"-"+Xs[t&63|128]+Xs[t>>8&255]+"-"+Xs[t>>16&255]+Xs[t>>24&255]+Xs[i&255]+Xs[i>>8&255]+Xs[i>>16&255]+Xs[i>>24&255]).toLowerCase()}function Jf(r,e,t){return Math.max(e,Math.min(t,r))}function cF(r){return(r&r-1)===0&&r!==0}function qE(r,e){switch(e.constructor){case Float32Array:return r;case Uint32Array:return r/4294967295;case Uint16Array:return r/65535;case Uint8Array:return r/255;case Int32Array:return Math.max(r/2147483647,-1);case Int16Array:return Math.max(r/32767,-1);case Int8Array:return Math.max(r/127,-1);default:throw new Error("Invalid component type.")}}function ow(r,e){switch(e.constructor){case Float32Array:return r;case Uint32Array:return Math.round(r*4294967295);case Uint16Array:return Math.round(r*65535);case Uint8Array:return Math.round(r*255);case Int32Array:return Math.round(r*2147483647);case Int16Array:return Math.round(r*32767);case Int8Array:return Math.round(r*127);default:throw new Error("Invalid component type.")}}var V$=new rr,tc=class{constructor(e=0,t=0,i=0,o="XYZ"){this._x=e,this._y=t,this._z=i,this._order=o}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,o=this._order){return this._x=e,this._y=t,this._z=i,this._order=o,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){let o=e.elements,n=o[0],a=o[4],s=o[8],l=o[1],c=o[5],d=o[9],p=o[2],g=o[6],h=o[10];switch(t){case"XYZ":this._y=Math.asin(Jf(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-d,h),this._z=Math.atan2(-a,n)):(this._x=Math.atan2(g,c),this._z=0);break;case"YXZ":this._x=Math.asin(-Jf(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(s,h),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-p,n),this._z=0);break;case"ZYX":this._y=Math.asin(-Jf(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(g,h),this._z=Math.atan2(l,n)):(this._x=0,this._z=Math.atan2(-a,c));break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return V$.makeRotationFromQuaternion(e),this.setFromRotationMatrix(V$,t,i)}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}};var nw=class{constructor(){this.mask=1}enable(e){this.mask|=1<<e|0}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}};var Go=class r{constructor(e,t,i,o,n,a,s,l,c){this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,i,o,n,a,s,l,c)}set(e,t,i,o,n,a,s,l,c){let d=this.elements;return d[0]=e,d[1]=o,d[2]=s,d[3]=t,d[4]=n,d[5]=l,d[6]=i,d[7]=a,d[8]=c,this}copy(e){let t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}multiplyMatrices(e,t){let i=e.elements,o=t.elements,n=this.elements,a=i[0],s=i[3],l=i[6],c=i[1],d=i[4],p=i[7],g=i[2],h=i[5],f=i[8],y=o[0],x=o[3],E=o[6],C=o[1],S=o[4],v=o[7],M=o[2],A=o[5],I=o[8];return n[0]=a*y+s*C+l*M,n[3]=a*x+s*S+l*A,n[6]=a*E+s*v+l*I,n[1]=c*y+d*C+p*M,n[4]=c*x+d*S+p*A,n[7]=c*E+d*v+p*I,n[2]=g*y+h*C+f*M,n[5]=g*x+h*S+f*A,n[8]=g*E+h*v+f*I,this}invert(){let e=this.elements,t=e[0],i=e[1],o=e[2],n=e[3],a=e[4],s=e[5],l=e[6],c=e[7],d=e[8],p=d*a-s*c,g=s*l-d*n,h=c*n-a*l,f=t*p+i*g+o*h;if(f===0)return this.set(0,0,0,0,0,0,0,0,0);let y=1/f;return e[0]=p*y,e[1]=(o*c-d*i)*y,e[2]=(s*i-o*a)*y,e[3]=g*y,e[4]=(d*t-o*l)*y,e[5]=(o*n-s*t)*y,e[6]=h*y,e[7]=(i*l-c*t)*y,e[8]=(a*t-i*n)*y,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}equals(e){let t=this.elements,i=e.elements;for(let o=0;o<9;o++)if(t[o]!==i[o])return!1;return!0}toArray(e,t=0){let i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){let e=new r,t=this.elements;for(let i=0;i<9;i++)e.elements[i]=t[i];return e}};var Cl=new Ae,Ps=class{constructor(e,t,i=!1){this.isBufferAttribute=!0;if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=A$,this.updateRange={offset:0,count:-1},this.gpuType=rd,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)Cl.fromBufferAttribute(this,t),Cl.applyMatrix4(e),this.setXYZ(t,Cl.x,Cl.y,Cl.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Cl.fromBufferAttribute(this,t),Cl.applyNormalMatrix(e),this.setXYZ(t,Cl.x,Cl.y,Cl.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Cl.fromBufferAttribute(this,t),Cl.transformDirection(e),this.setXYZ(t,Cl.x,Cl.y,Cl.z);return this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=qE(t,this.array)),t}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=qE(t,this.array)),t}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=qE(t,this.array)),t}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=qE(t,this.array)),t}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=ow(t,this.array),i=ow(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,o){return e*=this.itemSize,this.normalized&&(t=ow(t,this.array),i=ow(i,this.array),o=ow(o,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=o,this}};var im=class extends Ps{constructor(e,t,i){super(new Uint16Array(e),t,i)}};var om=class extends Ps{constructor(e,t,i){super(new Uint32Array(e),t,i)}},ao=class extends Ps{constructor(e,t,i){super(new Float32Array(e),t,i)}};var pce=0,L$=new Ae,P$=new od,HE=new rr,dF=new Ae,pF=new Ae,uce=new Ae(1,0,0),hce=new Ae(0,1,0),gce=new Ae(0,0,1),mce={type:"added"},fce={type:"removed"},nm=class nm extends ec{constructor(){super();this.isObject3D=!0;Object.defineProperty(this,"id",{value:pce++}),this.uuid=nd(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=nm.DEFAULT_UP.clone();let t=new Ae,i=new tc,o=new od,n=new Ae(1,1,1);function a(){o.setFromEuler(i,!1)}function s(){i.setFromQuaternion(o,void 0,!1)}i._onChange(a),o._onChange(s),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:o},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new rr},normalMatrix:{value:new Go}}),this.matrix=new rr,this.matrixWorld=new rr,this.dcgModelMatrix=new rr,this.matrixAutoUpdate=nm.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=nm.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new nw,this.visible=!0,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}setPickingColorArray(t){this.pickingColorArray=t;let{repeatColorCounts:i,colors:o}=t,n=[];for(let a=0;a<i.length;a++){let s=o[a],l=i[a];for(let c=0;c<l;c++)n.push(...s)}this.geometry&&this.geometry.setAttribute("vertexPickingColor",new Ps(new Float32Array(n),4))}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}translateOnAxis(t,i){return L$.copy(t).applyQuaternion(this.quaternion),this.position.add(L$.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(uce,t)}translateY(t){return this.translateOnAxis(hce,t)}translateZ(t){return this.translateOnAxis(gce,t)}lookAt(t){dF.copy(t);let i=this.parent;this.updateWorldMatrix(!0,!1),pF.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?HE.lookAt(pF,dF,this.up):HE.lookAt(dF,pF,this.up),this.quaternion.setFromRotationMatrix(HE),i&&(HE.extractRotation(i.matrixWorld),P$.setFromRotationMatrix(HE),this.quaternion.premultiply(P$.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(mce)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let o=0;o<arguments.length;o++)this.remove(arguments[o]);return this}let i=this.children.indexOf(t);return i!==-1&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(fce)),this}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let o=0,n=this.children.length;o<n;o++){let s=this.children[o].getObjectByProperty(t,i);if(s!==void 0)return s}}getObjectsByProperty(t,i){let o=[];this[t]===i&&o.push(this);for(let n=0,a=this.children.length;n<a;n++){let s=this.children[n].getObjectsByProperty(t,i);s.length>0&&(o=o.concat(s))}return o}traverse(t){t(this);let i=this.children;for(let o=0,n=i.length;o<n;o++)i[o].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);let i=this.children;for(let o=0,n=i.length;o<n;o++)i[o].traverseVisible(t)}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);let i=this.children;for(let o=0,n=i.length;o<n;o++){let a=i[o];(a.matrixWorldAutoUpdate===!0||t===!0)&&a.updateMatrixWorld(t)}}updateWorldMatrix(t,i){let o=this.parent;if(t===!0&&o!==null&&o.matrixWorldAutoUpdate===!0&&o.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i===!0){let n=this.children;for(let a=0,s=n.length;a<s;a++){let l=n[a];l.matrixWorldAutoUpdate===!0&&l.updateWorldMatrix(!1,!0)}}}};nm.DEFAULT_UP=new Ae(0,1,0),nm.DEFAULT_MATRIX_AUTO_UPDATE=!0,nm.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var Rn=nm;var aw=class extends Rn{constructor(){super();this.isCamera=!0;this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new rr,this.projectionMatrix=new rr,this.projectionMatrixInverse=new rr,this.coordinateSystem=id}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,i){super.updateWorldMatrix(t,i),this.matrixWorldInverse.copy(this.matrixWorld).invert()}};var am=class extends aw{constructor(e=50,t=1,i=.1,o=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=o,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=lF*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(pM*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return lF*2*Math.atan(Math.tan(pM*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,o,n,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=o,this.view.width=n,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(pM*.5*this.fov)/this.zoom,i=2*t,o=this.aspect*i,n=-.5*o,a=this.view;if(a!==null&&a.enabled){let l=a.fullWidth,c=a.fullHeight;n+=a.offsetX*o/l,t-=a.offsetY*i/c,o*=a.width/l,i*=a.height/c}let s=this.filmOffset;s!==0&&(n+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+o,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}};var Sh=class extends aw{constructor(e=-1,t=1,i=1,o=-1,n=.1,a=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=o,this.near=n,this.far=a,this.updateProjectionMatrix()}setViewOffset(e,t,i,o,n,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=o,this.view.width=n,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,o=(this.top+this.bottom)/2,n=i-e,a=i+e,s=o+t,l=o-t;if(this.view!==null&&this.view.enabled){let c=(this.right-this.left)/this.view.fullWidth/this.zoom,d=(this.top-this.bottom)/this.view.fullHeight/this.zoom;n+=c*this.view.offsetX,a=n+c*this.view.width,s-=d*this.view.offsetY,l=s-d*this.view.height}this.projectionMatrix.makeOrthographic(n,a,s,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}};var Ht=class r{constructor(e=0,t=0){this.x=e,this.y=t}set(e,t){return this.x=e,this.y=t,this}clone(){return new r(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}applyMatrix3(e){let t=this.x,i=this.y,o=e.elements;return this.x=o[0]*t+o[3]*i+o[6],this.y=o[1]*t+o[4]*i+o[7],this}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){return this.multiplyScalar(1/(this.length()||1))}distanceTo(e){let t=this.x-e.x,i=this.y-e.y,o=t*t+i*i;return Math.sqrt(o)}equals(e){return e.x===this.x&&e.y===this.y}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}};var bce=0,uM=class{constructor(e){this.data=e;this.isSource=!0;this.uuid=nd();this.version=0;Object.defineProperty(this,"id",{value:bce++})}set needsUpdate(e){e===!0&&this.version++}};var cu=class{constructor(e,t,i){this.width=e;this.height=t;this.depth=i}},yce=0,sw=class sw extends ec{constructor(e,t=sw.DEFAULT_MAPPING,i=Xf,o=Xf,n=au,a=zE,s=lu,l=Ha,c=sw.DEFAULT_ANISOTROPY,d=iw){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:yce++}),this.uuid=nd(),this.name="",this.source=new uM(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=i,this.wrapT=o,this.magFilter=n,this.minFilter=a,this.anisotropy=c,this.format=s,this.internalFormat=null,this.type=l,this.offset=new Ht(0,0),this.repeat=new Ht(1,1),this.center=new Ht(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Go,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=d,this.userData={},this.version=0,this.onUpdate=void 0,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==LR)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case BE:e.x=e.x-Math.floor(e.x);break;case Xf:e.x=e.x<0?0:1;break;case UE:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case BE:e.y=e.y-Math.floor(e.y);break;case Xf:e.y=e.y<0?0:1;break;case UE:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}};sw.DEFAULT_ANISOTROPY=1,sw.DEFAULT_MAPPING=LR;var rc=sw;var Ga=class r{constructor(e=0,t=0,i=0,o=1){this.x=e,this.y=t,this.z=i,this.w=o}set(e,t,i,o){return this.x=e,this.y=t,this.z=i,this.w=o,this}clone(){return new r(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}};var hM=class extends ec{constructor(t=1,i=1,o={}){super();this.isRenderTarget=!0;this.width=t,this.height=i,this.depth=1,this.scissor=new Ga(0,0,t,i),this.scissorTest=!1,this.viewport=new Ga(0,0,t,i);let n=new cu(t,i,1);this.texture=new rc(n,o.mapping,o.wrapS,o.wrapT,o.magFilter,o.minFilter,o.format,o.type,o.anisotropy,o.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=o.generateMipmaps!==void 0?o.generateMipmaps:!1,this.texture.internalFormat=o.internalFormat!==void 0?o.internalFormat:null,this.texture.minFilter=o.minFilter!==void 0?o.minFilter:au,this.depthBuffer=o.depthBuffer!==void 0?o.depthBuffer:!0,this.stencilBuffer=o.stencilBuffer!==void 0?o.stencilBuffer:!1,this.depthTexture=o.depthTexture!==void 0?o.depthTexture:null,this.samples=o.samples!==void 0?o.samples:0}setSize(t,i,o=1){if(this.width!==t||this.height!==i||this.depth!==o){this.width=t,this.height=i,this.depth=o;let n=this.texture.image;n.width=t,n.height=i,n.depth=o,this.dispose()}this.viewport.set(0,0,t,i),this.scissor.set(0,0,t,i)}dispose(){this.dispatchEvent({type:"dispose"})}};var Qf=class{constructor(e=new Ae(1/0,1/0,1/0),t=new Ae(-1/0,-1/0,-1/0)){this.min=e,this.max=t}setFromBufferAttribute(e){this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0;for(let t=0,i=e.count;t<i;t++)uF.fromBufferAttribute(e,t),this.min.min(uF),this.max.max(uF);return this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}},uF=new Ae;var lw=new Ae,hF=new Ae,Dh=class{constructor(e=new Ae,t=-1){this.center=e,this.radius=t}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(hF.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(lw.copy(e.center).add(hF)),this.expandByPoint(lw.copy(e.center).sub(hF))),this)}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;lw.subVectors(e,this.center);let t=lw.lengthSq();if(t>this.radius*this.radius){let i=Math.sqrt(t),o=(i-this.radius)*.5;lw.multiplyScalar(o/i),this.center.add(lw),this.radius+=o}return this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}};function gM(r){for(let e=r.length-1;e>=0;--e)if(r[e]>=65535)return!0;return!1}function mM(r){return document.createElementNS("http://www.w3.org/1999/xhtml",r)}function xce(r){let e=r.getError();switch(e){case r.NO_ERROR:return"NO_ERROR";case r.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";case r.INVALID_ENUM:return"INVALID_ENUM";case r.INVALID_VALUE:return"INVALID_VALUE";case r.INVALID_OPERATION:return"INVALID_OPERATION";case r.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case r.OUT_OF_MEMORY:return"OUT_OF_MEMORY";default:return typeof e=="number"?e.toString(16):e}}function Ut(r,e,t){if(r==null){let i=`Expected ${e} to be defined and not null.`;throw t&&(i+=` GL Error: ${xce(t)}.`),new Error(i)}}var wce=0,cw=new rr,_$=new Qf,Zf=new Ae,Wa=class extends ec{constructor(){super();this.isBufferGeometry=!0;Object.defineProperty(this,"id",{value:wce++}),this.uuid=nd(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.groups=[],this.boundingSphere=null,this.userData={}}setIndex(t){return Array.isArray(t)?this.index=new(gM(t)?om:im)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,i){return this.attributes[t]=i,this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,i,o=0){this.groups.push({start:t,count:i,materialIndex:o})}applyMatrix4(t){let i=this.attributes.position;i!==void 0&&(i.applyMatrix4(t),i.needsUpdate=!0);let o=this.attributes.normal;if(o!==void 0){let a=new Go().getNormalMatrix(t);o.applyNormalMatrix(a),o.needsUpdate=!0}let n=this.attributes.tangent;return n!==void 0&&(n.transformDirection(t),n.needsUpdate=!0),this.boundingSphere!==null&&this.computeBoundingSphere(),this}rotateX(t){return cw.makeRotationX(t),this.applyMatrix4(cw),this}translate(t,i,o){return cw.makeTranslation(t,i,o),this.applyMatrix4(cw),this}scale(t,i,o){return cw.makeScale(t,i,o),this.applyMatrix4(cw),this}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Dh);let t=this.attributes.position;if(t){let i=this.boundingSphere.center;_$.setFromBufferAttribute(t),_$.getCenter(i);let o=0;for(let n=0,a=t.count;n<a;n++)Zf.fromBufferAttribute(t,n),o=Math.max(o,i.distanceToSquared(Zf));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeVertexNormals(){let t=this.index,i=this.getAttribute("position");if(i!==void 0){let o=this.getAttribute("normal");if(o===void 0)o=new Ps(new Float32Array(i.count*3),3),this.setAttribute("normal",o);else for(let h=0,f=o.count;h<f;h++)o.setXYZ(h,0,0,0);let n=new Ae,a=new Ae,s=new Ae,l=new Ae,c=new Ae,d=new Ae,p=new Ae,g=new Ae;if(t)for(let h=0,f=t.count;h<f;h+=3){let y=t.getX(h+0),x=t.getX(h+1),E=t.getX(h+2);n.fromBufferAttribute(i,y),a.fromBufferAttribute(i,x),s.fromBufferAttribute(i,E),p.subVectors(s,a),g.subVectors(n,a),p.cross(g),l.fromBufferAttribute(o,y),c.fromBufferAttribute(o,x),d.fromBufferAttribute(o,E),l.add(p),c.add(p),d.add(p),o.setXYZ(y,l.x,l.y,l.z),o.setXYZ(x,c.x,c.y,c.z),o.setXYZ(E,d.x,d.y,d.z)}else for(let h=0,f=i.count;h<f;h+=3)n.fromBufferAttribute(i,h+0),a.fromBufferAttribute(i,h+1),s.fromBufferAttribute(i,h+2),p.subVectors(s,a),g.subVectors(n,a),p.cross(g),o.setXYZ(h+0,p.x,p.y,p.z),o.setXYZ(h+1,p.x,p.y,p.z),o.setXYZ(h+2,p.x,p.y,p.z);this.normalizeNormals(),o.needsUpdate=!0}}normalizeNormals(){let t=this.attributes.normal;for(let i=0,o=t.count;i<o;i++)Zf.fromBufferAttribute(t,i),Zf.normalize(),t.setXYZ(i,Zf.x,Zf.y,Zf.z)}dispose(){this.dispatchEvent({type:"dispose"})}};var sm=class{constructor(){this.arcLengthDivisions=200;this.needsUpdate=!1}getPointAt(e,t){let i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){let t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){let t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],i,o=this.getPoint(0),n=0;t.push(0);for(let a=1;a<=e;a++)i=this.getPoint(a/e),n+=i.distanceTo(o),t.push(n),o=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let i=this.getLengths(),o=0,n=i.length,a;t?a=t:a=e*i[n-1];let s=0,l=n-1,c;for(;s<=l;)if(o=Math.floor(s+(l-s)/2),c=i[o]-a,c<0)s=o+1;else if(c>0)l=o-1;else{l=o;break}if(o=l,i[o]===a)return o/(n-1);let d=i[o],g=i[o+1]-d,h=(a-d)/g;return(o+h)/(n-1)}getTangent(e,t){let o=e-1e-4,n=e+1e-4;o<0&&(o=0),n>1&&(n=1);let a=this.getPoint(o),s=this.getPoint(n),l=t||new Ht;return l.copy(s).sub(a).normalize(),l}getTangentAt(e,t){let i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){let i=new Ae,o=[],n=[],a=[],s=new Ae,l=new rr;for(let g=0;g<=e;g++){let h=g/e,f=this.getTangentAt(h,new Ht);o[g]=new Ae(f.x,f.y,0)}n[0]=new Ae,a[0]=new Ae;let c=Number.MAX_VALUE,d=Math.abs(o[0].x),p=Math.abs(o[0].y);d<=c&&(c=d,i.set(1,0,0)),p<=c&&(c=p,i.set(0,1,0)),s.crossVectors(o[0],i).normalize(),n[0].crossVectors(o[0],s),a[0].crossVectors(o[0],n[0]);for(let g=1;g<=e;g++){if(n[g]=n[g-1].clone(),a[g]=a[g-1].clone(),s.crossVectors(o[g-1],o[g]),s.length()>Number.EPSILON){s.normalize();let h=Math.acos(Jf(o[g-1].dot(o[g]),-1,1));n[g].applyMatrix4(l.makeRotationAxis(s,h))}a[g].crossVectors(o[g],n[g])}if(t===!0){let g=Math.acos(Jf(n[0].dot(n[e]),-1,1));g/=e,o[0].dot(s.crossVectors(n[0],n[e]))>0&&(g=-g);for(let h=1;h<=e;h++)n[h].applyMatrix4(l.makeRotationAxis(o[h],g*h)),a[h].crossVectors(o[h],n[h])}return{tangents:o,normals:n,binormals:a}}};var eb=class extends sm{constructor(e=new Ht,t=new Ht){super(),this.v1=e,this.v2=t}getPoint(e,t=new Ht){let i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Ht){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}};var fM=class extends sm{constructor(){super(...arguments);this.curves=[];this.autoClose=!1}add(t){this.curves.push(t)}closePath(){let t=this.curves[0].getPoint(0),i=this.curves[this.curves.length-1].getPoint(1);t.equals(i)||this.curves.push(new eb(i,t))}getPoint(t,i){let o=t*this.getLength(),n=this.getCurveLengths(),a=0;for(;a<n.length;){if(n[a]>=o){let s=n[a]-o,l=this.curves[a],c=l.getLength(),d=c===0?0:1-s/c;return l.getPointAt(d,i)}a++}}getLength(){let t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=void 0,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let t=[],i=0;for(let o=0,n=this.curves.length;o<n;o++)i+=this.curves[o].getLength(),t.push(i);return this.cacheLengths=t,t}getSpacedPoints(t=40){let i=[];for(let o=0;o<=t;o++)i.push(this.getPoint(o/t));return this.autoClose&&i.push(i[0]),i}getPoints(t=12){let i=[],o;for(let n=0,a=this.curves;n<a.length;n++){let s=a[n],l=s instanceof eb?1:t,c=s.getPoints(l);for(let d=0;d<c.length;d++){let p=c[d];o&&o.equals(p)||(i.push(p),o=p)}}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i}};function vce(r,e){let t=1-r;return t*t*e}function Cce(r,e){return 2*(1-r)*r*e}function Ece(r,e){return r*r*e}function gF(r,e,t,i){return vce(r,e)+Cce(r,t)+Ece(r,i)}var bM=class extends sm{constructor(e=new Ht,t=new Ht,i=new Ht){super(),this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new Ht){let i=t,o=this.v0,n=this.v1,a=this.v2;return i.set(gF(e,o.x,n.x,a.x),gF(e,o.y,n.y,a.y)),i}};var tb=class extends fM{constructor(t){super();this.currentPoint=new Ht;t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let i=1,o=t.length;i<o;i++)this.lineTo(t[i].x,t[i].y);return this}moveTo(t,i){return this.currentPoint.set(t,i),this}lineTo(t,i){let o=new eb(this.currentPoint.clone(),new Ht(t,i));return this.curves.push(o),this.currentPoint.set(t,i),this}quadraticCurveTo(t,i,o,n){let a=new bM(this.currentPoint.clone(),new Ht(t,i),new Ht(o,n));return this.curves.push(a),this.currentPoint.set(o,n),this}};var dw=class extends tb{constructor(){super(...arguments);this.uuid=nd();this.holes=[]}getPointsHoles(t){let i=[];for(let o=0,n=this.holes.length;o<n;o++)i[o]=this.holes[o].getPoints(t);return i}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}};var er=class r{constructor(e){this.isColor=!0;if(e instanceof r)this.copy(e);else if(typeof e=="number")this.setHex(e);else if(typeof e=="string"){let{r:t,g:i,b:o}=__dcg_shared_module_exports__['S'](e);this.setRGB(t/255,i/255,o/255)}else this.r=1,this.g=1,this.b=1}setHex(e){return e=Math.floor(e),this.setRGB((e>>16&255)/255,(e>>8&255)/255,(e&255)/255),this}setRGB(e,t,i){return this.r=__dcg_shared_module_exports__['T'](e),this.g=__dcg_shared_module_exports__['T'](t),this.b=__dcg_shared_module_exports__['T'](i),this}clone(){let e=new r;return e.r=this.r,e.g=this.g,e.b=this.b,e}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}getRGB(e,t){t===ko?(e.r=__dcg_shared_module_exports__['U'](this.r),e.g=__dcg_shared_module_exports__['U'](this.g),e.b=__dcg_shared_module_exports__['U'](this.b)):(e.r=this.r,e.g=this.g,e.b=this.b)}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}};var R$={triangulate:function(r,e,t=2){let i=e&&e.length,o=i?e[0]*t:r.length,n=Sce(r,0,o,t,!0),a=[];if(!n||n.next===n.prev)return a;let s,l,c,d,p,g,h;if(i)throw new Error("EarCut does not support holes");if(r.length>80*t){s=c=r[0],l=d=r[1];for(let f=t;f<o;f+=t)p=r[f],g=r[f+1],p<s&&(s=p),g<l&&(l=g),p>c&&(c=p),g>d&&(d=g);h=Math.max(c-s,d-l),h=h!==0?32767/h:0}return Dce(n,a,t,s,l,h,0),a}};function Sce(r,e,t,i,o){let n,a;if(o===Ace(r,e,t,i)>0)for(n=e;n<t;n+=i)a=O$(n,r[n],r[n+1],a);else for(n=t-i;n>=e;n-=i)a=O$(n,r[n],r[n+1],a);return a&&Ice(a,a.next)&&(F$(a),a=a.next),a}function Dce(r,e,t,i,o,n,a){if(!r)return;!a&&n&&Tce(r,i,o,n);let s=r,l,c;for(;r.prev!==r.next;){if(l=r.prev,c=r.next,n?Gce(r,i,o,n):kce(r)){e.push(l.i/t|0),e.push(r.i/t|0),e.push(c.i/t|0),F$(r),r=c.next,s=c.next;continue}if(r=c,r===s)throw new Error("EarCut does not expect ear === stop")}}function kce(r){let e=r.prev,t=r,i=r.next;if(rb(e,t,i)>=0)return!1;let o=e.x,n=t.x,a=i.x,s=e.y,l=t.y,c=i.y,d=o<n?o<a?o:a:n<a?n:a,p=s<l?s<c?s:c:l<c?l:c,g=o>n?o>a?o:a:n>a?n:a,h=s>l?s>c?s:c:l>c?l:c,f=i.next;for(;f!==e;){if(f.x>=d&&f.x<=g&&f.y>=p&&f.y<=h&&WE(o,s,n,l,a,c,f.x,f.y)&&rb(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Gce(r,e,t,i){let o=r.prev,n=r,a=r.next;if(rb(o,n,a)>=0)return!1;let s=o.x,l=n.x,c=a.x,d=o.y,p=n.y,g=a.y,h=s<l?s<c?s:c:l<c?l:c,f=d<p?d<g?d:g:p<g?p:g,y=s>l?s>c?s:c:l>c?l:c,x=d>p?d>g?d:g:p>g?p:g,E=mF(h,f,e,t,i),C=mF(y,x,e,t,i),S=r.prevZ,v=r.nextZ;for(;S&&S.z>=E&&v&&v.z<=C;){if(S.x>=h&&S.x<=y&&S.y>=f&&S.y<=x&&S!==o&&S!==a&&WE(s,d,l,p,c,g,S.x,S.y)&&rb(S.prev,S,S.next)>=0||(S=S.prevZ,v.x>=h&&v.x<=y&&v.y>=f&&v.y<=x&&v!==o&&v!==a&&WE(s,d,l,p,c,g,v.x,v.y)&&rb(v.prev,v,v.next)>=0))return!1;v=v.nextZ}for(;S&&S.z>=E;){if(S.x>=h&&S.x<=y&&S.y>=f&&S.y<=x&&S!==o&&S!==a&&WE(s,d,l,p,c,g,S.x,S.y)&&rb(S.prev,S,S.next)>=0)return!1;S=S.prevZ}for(;v&&v.z<=C;){if(v.x>=h&&v.x<=y&&v.y>=f&&v.y<=x&&v!==o&&v!==a&&WE(s,d,l,p,c,g,v.x,v.y)&&rb(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function Tce(r,e,t,i){let o=r;do o.z===0&&(o.z=mF(o.x,o.y,e,t,i)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==r);o.prevZ.nextZ=void 0,o.prevZ=void 0,Mce(o)}function Mce(r){let e,t,i,o,n,a,s,l,c=1;do{for(t=r,r=void 0,n=void 0,a=0;t;){for(a++,i=t,s=0,e=0;e<c&&(s++,i=i.nextZ,!!i);e++);for(l=c;s>0||l>0&&i;)s!==0&&(l===0||!i||t.z<=i.z)?(o=t,t=t.nextZ,s--):(o=i,i=i.nextZ,l--),n?n.nextZ=o:r=o,o.prevZ=n,n=o;t=i}n.nextZ=void 0,c*=2}while(a>1);return r}function mF(r,e,t,i,o){return r=(r-t)*o|0,e=(e-i)*o|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r|e<<1}function WE(r,e,t,i,o,n,a,s){return(o-a)*(e-s)>=(r-a)*(n-s)&&(r-a)*(i-s)>=(t-a)*(e-s)&&(t-a)*(n-s)>=(o-a)*(i-s)}function rb(r,e,t){return(e.y-r.y)*(t.x-e.x)-(e.x-r.x)*(t.y-e.y)}function Ice(r,e){return r.x===e.x&&r.y===e.y}function O$(r,e,t,i){let o=new fF(r,e,t);return i?(o.next=i.next,o.prev=i,i.next.prev=o,i.next=o):(o.prev=o,o.next=o),o}function F$(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}var fF=class{constructor(e,t,i){this.i=e,this.x=t,this.y=i,this.z=0,this.prevZ=void 0,this.nextZ=void 0,this.steiner=!1}};function Ace(r,e,t,i){let o=0;for(let n=e,a=t-i;n<t;n+=i)o+=(r[a]-r[n])*(r[n+1]+r[a+1]),a=n;return o}var lm=class r{static area(e){let t=e.length,i=0;for(let o=t-1,n=0;n<t;o=n++)i+=e[o].x*e[n].y-e[n].x*e[o].y;return i*.5}static isClockWise(e){return r.area(e)<0}static triangulateShape(e,t){let i=[],o=[],n=[];N$(e),B$(i,e);let a=e.length;t.forEach(N$);for(let l=0;l<t.length;l++)o.push(a),a+=t[l].length,B$(i,t[l]);let s=R$.triangulate(i,o);for(let l=0;l<s.length;l+=3)n.push(s.slice(l,l+3));return n}};function N$(r){let e=r.length;e>2&&r[e-1].equals(r[0])&&r.pop()}function B$(r,e){for(let t=0;t<e.length;t++)r.push(e[t].x),r.push(e[t].y)}var yM=class{constructor(){this.color=new er;this.subPaths=[];this.currentPath=new tb}moveTo(e,t){return this.currentPath=new tb,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,i,o){return this.currentPath.quadraticCurveTo(e,t,i,o),this}toShapes(e=!1){function t(E){let C=[];for(let S=0,v=E.length;S<v;S++){let M=E[S],A=new dw;A.curves=M.curves,C.push(A)}return C}function i(E,C){let S=C.length,v=!1;for(let M=S-1,A=0;A<S;M=A++){let I=C[M],P=C[A],_=P.x-I.x,U=P.y-I.y;if(Math.abs(U)>Number.EPSILON){if(U<0&&(I=C[A],_=-_,P=C[M],U=-U),E.y<I.y||E.y>P.y)continue;if(E.y===I.y){if(E.x===I.x)return!0}else{let Y=U*(E.x-I.x)-_*(E.y-I.y);if(Y===0)return!0;if(Y<0)continue;v=!v}}else{if(E.y!==I.y)continue;if(P.x<=E.x&&E.x<=I.x||I.x<=E.x&&E.x<=P.x)return!0}}return v}let o=lm.isClockWise,n=this.subPaths;if(n.length===0)return[];let a,s,l,c=[];if(n.length===1)return s=n[0],l=new dw,l.curves=s.curves,c.push(l),c;let d=!o(n[0].getPoints());d=e?!d:d;let p=[],g=[],h=[],f=0,y;h[f]=[];for(let E=0,C=n.length;E<C;E++)if(s=n[E],y=s.getPoints(),a=o(y),a=e?!a:a,a){!d&&g[f]&&f++;let S={s:new dw,p:y};S.s.curves=s.curves,g[f]=S,d&&f++,h[f]=[]}else h[f].push({h:s,p:y[0]});if(!g[0])return t(n);if(g.length>1){let E=!1,C=0;for(let S=0,v=g.length;S<v;S++)p[S]=[];for(let S=0,v=g.length;S<v;S++){let M=h[S];for(let A=0;A<M.length;A++){let I=M[A],P=!0;for(let _=0;_<g.length;_++)i(I.p,g[_].p)&&(S!==_&&C++,P?(P=!1,p[_].push(I)):E=!0);P&&p[S].push(I)}}C>0&&E===!1&&(h=p)}let x;for(let E=0,C=g.length;E<C;E++){l=g[E].s,c.push(l),x=h[E];for(let S=0,v=x.length;S<v;S++)l.holes.push(x[S].h)}return c}};var du=class extends Wa{constructor(e=1,t=1,i=1,o=32,n=1,a=!1,s=0,l=Math.PI*2){super(),this.type="CylinderGeometry";let c=this;o=Math.floor(o),n=Math.floor(n);let d=[],p=[],g=[],h=[],f=0,y=[],x=i/2,E=0;C(),a===!1&&(e>0&&S(!0),t>0&&S(!1)),this.setIndex(d),this.setAttribute("position",new ao(p,3)),this.setAttribute("normal",new ao(g,3)),this.setAttribute("uv",new ao(h,2));function C(){let v=new Ae,M=new Ae,A=0,I=(t-e)/i;for(let P=0;P<=n;P++){let _=[],U=P/n,Y=U*(t-e)+e;for(let R=0;R<=o;R++){let H=R/o,O=H*l+s,q=Math.sin(O),w=Math.cos(O);M.x=Y*q,M.y=-U*i+x,M.z=Y*w,p.push(M.x,M.y,M.z),v.set(q,I,w).normalize(),g.push(v.x,v.y,v.z),h.push(H,1-U),_.push(f++)}y.push(_)}for(let P=0;P<o;P++)for(let _=0;_<n;_++){let U=y[_][P],Y=y[_+1][P],R=y[_+1][P+1],H=y[_][P+1];d.push(U,Y,H),d.push(Y,R,H),A+=6}c.addGroup(E,A,0),E+=A}function S(v){let M=f,A=new Ht,I=new Ae,P=0,_=v===!0?e:t,U=v===!0?1:-1;for(let R=1;R<=o;R++)p.push(0,x*U,0),g.push(0,U,0),h.push(.5,.5),f++;let Y=f;for(let R=0;R<=o;R++){let O=R/o*l+s,q=Math.cos(O),w=Math.sin(O);I.x=_*w,I.y=x*U,I.z=_*q,p.push(I.x,I.y,I.z),g.push(0,U,0),A.x=q*.5+.5,A.y=w*.5*U+.5,h.push(A.x,A.y),f++}for(let R=0;R<o;R++){let H=M+R,O=Y+R;v===!0?d.push(O,O+1,H):d.push(O+1,O,H),P+=3}c.addGroup(E,P,v===!0?1:2),E+=P}}};var xM=class extends du{constructor(e=1,t=1,i=32,o=1,n=!1,a=0,s=Math.PI*2){super(0,e,t,i,o,n,a,s),this.type="ConeGeometry"}};var $E=class extends Wa{constructor(e=1,t=1,i=1,o=1){super(),this.type="PlaneGeometry";let n=e/2,a=t/2,s=Math.floor(i),l=Math.floor(o),c=s+1,d=l+1,p=e/s,g=t/l,h=[],f=[],y=[],x=[];for(let E=0;E<d;E++){let C=E*g-a;for(let S=0;S<c;S++){let v=S*p-n;f.push(v,-C,0),y.push(0,0,1),x.push(S/s),x.push(1-E/l)}}for(let E=0;E<l;E++)for(let C=0;C<s;C++){let S=C+c*E,v=C+c*(E+1),M=C+1+c*(E+1),A=C+1+c*E;h.push(S,v,A),h.push(v,M,A)}this.setIndex(h),this.setAttribute("position",new ao(f,3)),this.setAttribute("normal",new ao(y,3)),this.setAttribute("uv",new ao(x,2))}};var wM=class extends Wa{constructor(e,t={}){super(),this.type="ExtrudeGeometry";let i=this,o=[],n=[];for(let s=0,l=e.length;s<l;s++){let c=e[s];a(c)}this.setAttribute("position",new ao(o,3)),this.setAttribute("uv",new ao(n,2)),this.computeVertexNormals();function a(s){let l=[],c=t.curveSegments!==void 0?t.curveSegments:12,d=t.steps!==void 0?t.steps:1,p=t.depth!==void 0?t.depth:1,g=t.bevelEnabled!==void 0?t.bevelEnabled:!0,h=t.bevelThickness!==void 0?t.bevelThickness:.2,f=t.bevelSize!==void 0?t.bevelSize:h-.1,y=t.bevelOffset!==void 0?t.bevelOffset:0,x=t.bevelSegments!==void 0?t.bevelSegments:3,E=t.UVGenerator!==void 0?t.UVGenerator:Vce;g||(x=0,h=0,f=0,y=0);let C=s.extractPoints(c),S=C.shape,v=C.holes;if(!lm.isClockWise(S)){S=S.reverse();for(let X=0,ae=v.length;X<ae;X++){let J=v[X];lm.isClockWise(J)&&(v[X]=J.reverse())}}let A=lm.triangulateShape(S,v),I=S;for(let X=0,ae=v.length;X<ae;X++){let J=v[X];S=S.concat(J)}function P(X,ae,J){return ae||console.error("THREE.ExtrudeGeometry: vec does not exist"),X.clone().addScaledVector(ae,J)}let _=S.length,U=A.length;function Y(X,ae,J){let ge,be,Ee,Le=X.x-ae.x,Se=X.y-ae.y,et=J.x-X.x,Z=J.y-X.y,W=Le*Le+Se*Se,De=Le*Z-Se*et;if(Math.abs(De)>Number.EPSILON){let Ne=Math.sqrt(W),me=Math.sqrt(et*et+Z*Z),ve=ae.x-Se/Ne,Pe=ae.y+Le/Ne,He=J.x-Z/me,ot=J.y+et/me,Ge=((He-ve)*Z-(ot-Pe)*et)/(Le*Z-Se*et);ge=ve+Le*Ge-X.x,be=Pe+Se*Ge-X.y;let Et=ge*ge+be*be;if(Et<=2)return new Ht(ge,be);Ee=Math.sqrt(Et/2)}else{let Ne=!1;Le>Number.EPSILON?et>Number.EPSILON&&(Ne=!0):Le<-Number.EPSILON?et<-Number.EPSILON&&(Ne=!0):Math.sign(Se)===Math.sign(Z)&&(Ne=!0),Ne?(ge=-Se,be=Le,Ee=Math.sqrt(W)):(ge=Le,be=Se,Ee=Math.sqrt(W/2))}return new Ht(ge/Ee,be/Ee)}let R=[];for(let X=0,ae=I.length,J=ae-1,ge=X+1;X<ae;X++,J++,ge++)J===ae&&(J=0),ge===ae&&(ge=0),R[X]=Y(I[X],I[J],I[ge]);let H=[],O,q=R.concat();for(let X=0,ae=v.length;X<ae;X++){let J=v[X];O=[];for(let ge=0,be=J.length,Ee=be-1,Le=ge+1;ge<be;ge++,Ee++,Le++)Ee===be&&(Ee=0),Le===be&&(Le=0),O[ge]=Y(J[ge],J[Ee],J[Le]);H.push(O),q=q.concat(O)}for(let X=0;X<x;X++){let ae=X/x,J=h*Math.cos(ae*Math.PI/2),ge=f*Math.sin(ae*Math.PI/2)+y;for(let be=0,Ee=I.length;be<Ee;be++){let Le=P(I[be],R[be],ge);F(Le.x,Le.y,-J)}for(let be=0,Ee=v.length;be<Ee;be++){let Le=v[be];O=H[be];for(let Se=0,et=Le.length;Se<et;Se++){let Z=P(Le[Se],O[Se],ge);F(Z.x,Z.y,-J)}}}let w=f+y;for(let X=0;X<_;X++){let ae=g?P(S[X],q[X],w):S[X];F(ae.x,ae.y,0)}for(let X=1;X<=d;X++)for(let ae=0;ae<_;ae++){let J=g?P(S[ae],q[ae],w):S[ae];F(J.x,J.y,p/d*X)}for(let X=x-1;X>=0;X--){let ae=X/x,J=h*Math.cos(ae*Math.PI/2),ge=f*Math.sin(ae*Math.PI/2)+y;for(let be=0,Ee=I.length;be<Ee;be++){let Le=P(I[be],R[be],ge);F(Le.x,Le.y,p+J)}for(let be=0,Ee=v.length;be<Ee;be++){let Le=v[be];O=H[be];for(let Se=0,et=Le.length;Se<et;Se++){let Z=P(Le[Se],O[Se],ge);F(Z.x,Z.y,p+J)}}}T(),B();function T(){let X=o.length/3;if(g){let ae=0,J=_*ae;for(let ge=0;ge<U;ge++){let be=A[ge];j(be[2]+J,be[1]+J,be[0]+J)}ae=d+x*2,J=_*ae;for(let ge=0;ge<U;ge++){let be=A[ge];j(be[0]+J,be[1]+J,be[2]+J)}}else{for(let ae=0;ae<U;ae++){let J=A[ae];j(J[2],J[1],J[0])}for(let ae=0;ae<U;ae++){let J=A[ae];j(J[0]+_*d,J[1]+_*d,J[2]+_*d)}}i.addGroup(X,o.length/3-X,0)}function B(){let X=o.length/3,ae=0;de(I,ae),ae+=I.length;for(let J=0,ge=v.length;J<ge;J++){let be=v[J];de(be,ae),ae+=be.length}i.addGroup(X,o.length/3-X,1)}function de(X,ae){let J=X.length;for(;--J>=0;){let ge=J,be=J-1;be<0&&(be=X.length-1);for(let Ee=0,Le=d+x*2;Ee<Le;Ee++){let Se=_*Ee,et=_*(Ee+1),Z=ae+ge+Se,W=ae+be+Se,De=ae+be+et,Ne=ae+ge+et;pe(Z,W,De,Ne)}}}function F(X,ae,J){l.push(X),l.push(ae),l.push(J)}function j(X,ae,J){le(X),le(ae),le(J);let ge=o.length/3,be=E.generateTopUV(i,o,ge-3,ge-2,ge-1);ne(be[0]),ne(be[1]),ne(be[2])}function pe(X,ae,J,ge){le(X),le(ae),le(ge),le(ae),le(J),le(ge);let be=o.length/3,Ee=E.generateSideWallUV(i,o,be-6,be-3,be-2,be-1);ne(Ee[0]),ne(Ee[1]),ne(Ee[3]),ne(Ee[1]),ne(Ee[2]),ne(Ee[3])}function le(X){o.push(l[X*3+0]),o.push(l[X*3+1]),o.push(l[X*3+2])}function ne(X){n.push(X.x),n.push(X.y)}}}},Vce={generateTopUV:function(r,e,t,i,o){let n=e[t*3],a=e[t*3+1],s=e[i*3],l=e[i*3+1],c=e[o*3],d=e[o*3+1];return[new Ht(n,a),new Ht(s,l),new Ht(c,d)]},generateSideWallUV:function(r,e,t,i,o,n){let a=e[t*3],s=e[t*3+1],l=e[t*3+2],c=e[i*3],d=e[i*3+1],p=e[i*3+2],g=e[o*3],h=e[o*3+1],f=e[o*3+2],y=e[n*3],x=e[n*3+1],E=e[n*3+2];return Math.abs(s-d)<Math.abs(a-c)?[new Ht(a,1-l),new Ht(c,1-p),new Ht(g,1-f),new Ht(y,1-E)]:[new Ht(s,1-l),new Ht(d,1-p),new Ht(h,1-f),new Ht(x,1-E)]}};var pw=class extends Rn{constructor(t,i=1){super();this.isLight=!0;this.type="Light",this.color=new er(t),this.intensity=i}dispose(){}};var cm=class extends pw{constructor(t,i){super(t,i);this.isDirectionalLight=!0;this.type="DirectionalLight",this.position.copy(Rn.DEFAULT_UP),this.updateMatrix(),this.target=new Rn}dispose(){}};var uw=class extends pw{constructor(t,i){super(t,i);this.isAmbientLight=!0;this.type="AmbientLight"}};function dm(r){let e={};for(let t in r){e[t]={};for(let i in r[t]){let o=r[t][i];o&&(o instanceof er||o instanceof Go||o instanceof rr||o instanceof Ht||o instanceof Ae||o instanceof Ga||o instanceof rc||o instanceof od)?o.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=o.clone():Array.isArray(o)?e[t][i]=o.slice():e[t][i]=o}}return e}function U$(r){let e=[];for(let t=0;t<r.length;t++)e.push(r[t].clone());return e}function z$(r){return r.getRenderTarget()===null?r.outputColorSpace:Zl}var Lce=0,ic=class extends ec{constructor(e){super(),Object.defineProperty(this,"id",{value:Lce++}),this.uuid=nd(),this.name="",this.type="Material",this.blending=em,this.side=RE,this.vertexColors=!1,this.useVertexPickingColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=X1,this.blendDst=J1,this.blendEquation=ou,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=NE,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=C$,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=lM,this.stencilZFail=lM,this.stencilZPass=lM,this.stencilWrite=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.userData={},this.version=0,this._alphaTest=0,this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="",this.fragmentShader="",this.wireframe=!1,this.lights=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}customProgramCacheKey(){return"no-custom-cache-key"}setValues(e){if(e!==void 0)for(let t in e){let i=t,o=e[i];if(o===void 0){console.warn(`THREE.Material: parameter '${i}' has value of undefined.`);continue}let n=this[i];if(n===void 0){console.warn(`THREE.Material: '${i}' is not a property of THREE.${this.type}.`);continue}n&&n.isColor?n.set(o):n&&n instanceof Ae&&o&&o instanceof Ae?n.copy(o):this[i]=o}}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.useVertexPickingColors=e.useVertexPickingColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.userData=JSON.parse(JSON.stringify(e.userData)),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=dm(e.uniforms),this.uniformsGroups=U$(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.lights=e.lights,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}};var kh=class{constructor(e=new Ae(1,0,0),t=0){this.isPlane=!0;this.normal=e,this.constant=t}setComponents(e,t,i,o){return this.normal.set(e,t,i),this.constant=o,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}distanceToPoint(e){return this.normal.dot(e)+this.constant}};var pm=class extends Ps{constructor(e,t,i=!1,o=1){super(e,t,i),this.meshPerAttribute=o}};var Fn=class extends Rn{constructor(e,t){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t}};var K$=new rr,q$=new Dh,Nn=class extends Fn{constructor(e,t,i){super(e,t),this.instanceMatrix=new pm(new Float32Array(i*16),16),this.instanceColor=new pm(new Float32Array(i*3),3),this.instancePickingColor=new pm(new Float32Array(i*4),4),this.count=i}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getPickingColorAt(e,t){let i=this.instancePickingColor.array;e=e*4,t[0]=i[e+0],t[1]=i[e+1],t[2]=i[e+2],t[3]=i[e+3]}setColorAt(e,t){t.toArray(this.instanceColor.array,e*3)}setPickingColorAt(e,t){let i=this.instancePickingColor.array;var o=e*4;i[o+0]=t[0],i[o+1]=t[1],i[o+2]=t[2],i[o+3]=t[3]}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}computeBoundingSphere(){var i,o;let e=this.geometry,t=this.count;this.boundingSphere||(this.boundingSphere=new Dh),e.boundingSphere||e.computeBoundingSphere(),(i=this.boundingSphere)==null||i.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,K$),q$.copy(e.boundingSphere).applyMatrix4(K$),(o=this.boundingSphere)==null||o.union(q$)}dispose(){this.dispatchEvent({type:"dispose"})}};var jE=new Dh,vM=class{constructor(e=new kh,t=new kh,i=new kh,o=new kh,n=new kh,a=new kh){this.planes=[e,t,i,o,n,a]}setFromProjectionMatrix(e,t=id){let i=this.planes,o=e.elements,n=o[0],a=o[1],s=o[2],l=o[3],c=o[4],d=o[5],p=o[6],g=o[7],h=o[8],f=o[9],y=o[10],x=o[11],E=o[12],C=o[13],S=o[14],v=o[15];if(i[0].setComponents(l-n,g-c,x-h,v-E).normalize(),i[1].setComponents(l+n,g+c,x+h,v+E).normalize(),i[2].setComponents(l+a,g+d,x+f,v+C).normalize(),i[3].setComponents(l-a,g-d,x-f,v-C).normalize(),i[4].setComponents(l-s,g-p,x-y,v-S).normalize(),t===id)i[5].setComponents(l+s,g+p,x+y,v+S).normalize();else if(t===KE)i[5].setComponents(s,p,y,S).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){let t=e.geometry;return t?(e instanceof Nn?(e.computeBoundingSphere(),jE.copy(e.boundingSphere).applyMatrix4(e.matrixWorld)):(t.boundingSphere||t.computeBoundingSphere(),jE.copy(t.boundingSphere),jE.applyMatrix4(e.dcgModelMatrix),jE.applyMatrix4(e.matrixWorld)),this.intersectsSphere(jE)):!1}intersectsSphere(e){let t=this.planes,i=e.center,o=-e.radius;for(let n=0;n<6;n++)if(t[n].distanceToPoint(i)<o)return!1;return!0}};var H$=new Ae,W$=new Ae,CM=class extends Rn{constructor(e,t){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,i=[0];for(let o=1,n=t.count;o<n;o++)H$.fromBufferAttribute(t,o-1),W$.fromBufferAttribute(t,o),i[o]=i[o-1],i[o]+=H$.distanceTo(W$);e.setAttribute("lineDistance",new ao(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}};var $$=new Ae,j$=new Ae,um=class extends CM{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,i=[];for(let o=0,n=t.count;o<n;o+=2)$$.fromBufferAttribute(t,o),j$.fromBufferAttribute(t,o+1),i[o]=o===0?0:i[o-1],i[o+1]=i[o]+$$.distanceTo(j$);e.setAttribute("lineDistance",new ao(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}};var hw=class extends Rn{constructor(){super(),this.isGroup=!0,this.type="Group"}};var oc=class extends hM{constructor(t=1,i=1,o={}){super(t,i,o);this.isWebGLRenderTarget=!0}};var EM=class{constructor(e){let t=new WeakMap;function i(l,c){let d=l.array,p=l.usage,g=e.createBuffer();e.bindBuffer(c,g),e.bufferData(c,d,p),l.onUploadCallback();let h;if(d instanceof Float32Array)h=e.FLOAT;else if(d instanceof Uint16Array)h=e.UNSIGNED_SHORT;else if(d instanceof Int16Array)h=e.SHORT;else if(d instanceof Uint32Array)h=e.UNSIGNED_INT;else if(d instanceof Int32Array)h=e.INT;else if(d instanceof Int8Array)h=e.BYTE;else if(d instanceof Uint8Array)h=e.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);return{buffer:g,type:h,bytesPerElement:d.BYTES_PER_ELEMENT,version:l.version}}function o(l,c,d){let p=c.array,g=c.updateRange;e.bindBuffer(d,l),g.count===-1?e.bufferSubData(d,0,p):(e.bufferSubData(d,g.offset*p.BYTES_PER_ELEMENT,p,g.offset,g.count),g.count=-1),c.onUploadCallback()}function n(l){return t.get(l)}function a(l){let c=t.get(l);c&&(e.deleteBuffer(c.buffer),t.delete(l))}function s(l,c){let d=t.get(l);d===void 0?t.set(l,i(l,c)):d.version<l.version&&(o(d.buffer,l,c),d.version=l.version)}this.get=n,this.remove=a,this.update=s}};var SM=new er(0),DM=class{constructor(e,t,i,o,n){let a=new er(0),s=o===!0?0:1;function l(d,p){let g=!1,h=p.isScene===!0?p.background:null;h===null?c(a,s):h&&h.isColor&&(c(h,1),g=!0),(e.autoClear||g)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil)}function c(d,p){d.getRGB(SM,z$(e)),t.buffers.color.setClear(SM.r,SM.g,SM.b,p,n)}this.getClearColor=function(){return a},this.setClearColor=function(d,p=1){a.copy(d),s=p,c(a,s)},this.getClearAlpha=function(){return s},this.setClearAlpha=function(d){s=d,c(a,s)},this.render=l}};var kM=class{constructor(e,t){let i=e.getParameter(e.MAX_VERTEX_ATTRIBS),o=!0,n={},a=f(null),s=a,l=!1;function c(R,H,O,q,w){let T=!1;if(o){let B=h(q,O,H);s!==B&&(s=B,p(s.object)),T=y(R,q,O,w),T&&x(R,q,O,w)}else{let B=H.wireframe===!0;(s.geometry!==q.id||s.program!==O.id||s.wireframe!==B)&&(s.geometry=q.id,s.program=O.id,s.wireframe=B,T=!0)}if(w!==null&&t.update(w,e.ELEMENT_ARRAY_BUFFER),(T||l)&&(l=!1,A(R,H,O,q),w!==null)){let B=t.get(w);Ut(B,"indexAttributes"),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,B.buffer)}}function d(){return e.createVertexArray()}function p(R){e.bindVertexArray(R)}function g(R){return e.deleteVertexArray(R)}function h(R,H,O){let q=O.wireframe===!0?"true":"false",w=n[R.id];w===void 0&&(w={},n[R.id]=w);let T=w[H.id];T===void 0&&(T={},w[H.id]=T);let B=T[q];return B===void 0&&(B=f(d()),T[q]=B),B}function f(R){let H=[],O=[],q=[];for(let w=0;w<i;w++)H[w]=0,O[w]=0,q[w]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:H,enabledAttributes:O,attributeDivisors:q,object:R,attributes:{},index:null}}function y(R,H,O,q){let w=s.attributes,T=H.attributes,B=0,de=O.getAttributes();for(let F in de)if(de[F].location>=0){let pe=w[F],le=T[F];if(le===void 0&&R instanceof Nn&&(F==="instanceMatrix"&&R.instanceMatrix&&(le=R.instanceMatrix),F==="instanceColor"&&R.instanceColor&&(le=R.instanceColor),F==="instancePickingColor"&&R.instancePickingColor&&(le=R.instancePickingColor)),pe===void 0||pe.attribute!==le||le&&pe.data!==le.data)return!0;B++}return s.attributesNum!==B||s.index!==q}function x(R,H,O,q){let w={},T=H.attributes,B=0,de=O.getAttributes();for(let F in de)if(de[F].location>=0){let pe=T[F];pe===void 0&&R instanceof Nn&&(F==="instanceMatrix"&&R.instanceMatrix&&(pe=R.instanceMatrix),F==="instanceColor"&&R.instanceColor&&(pe=R.instanceColor),F==="instancePickingColor"&&R.instancePickingColor&&(pe=R.instancePickingColor));let le={attribute:pe};pe&&"data"in pe&&pe.data&&(le.data=pe.data),w[F]=le,B++}s.attributes=w,s.attributesNum=B,s.index=q}function E(){let R=s.newAttributes;for(let H=0,O=R.length;H<O;H++)R[H]=0}function C(R){S(R,0)}function S(R,H){let O=s.newAttributes,q=s.enabledAttributes,w=s.attributeDivisors;O[R]=1,q[R]===0&&(e.enableVertexAttribArray(R),q[R]=1),w[R]!==H&&(e.vertexAttribDivisor(R,H),w[R]=H)}function v(){let R=s.newAttributes,H=s.enabledAttributes;for(let O=0,q=H.length;O<q;O++)H[O]!==R[O]&&(e.disableVertexAttribArray(O),H[O]=0)}function M(R,H,O,q,w,T,B){B===!0?e.vertexAttribIPointer(R,H,O,w,T):e.vertexAttribPointer(R,H,O,q,w,T)}function A(R,H,O,q){E();let w=q.attributes,T=O.getAttributes(),B=H.defaultAttributeValues;for(let de in T){let F=T[de];if(F.location>=0){let j=w[de];if(j===void 0&&R instanceof Nn&&(de==="instanceMatrix"&&R.instanceMatrix&&(j=R.instanceMatrix),de==="instanceColor"&&R.instanceColor&&(j=R.instanceColor),de==="instancePickingColor"&&R.instancePickingColor&&(j=R.instancePickingColor)),j!==void 0){let pe=j.normalized,le=j.itemSize,ne=t.get(j);if(ne===void 0)continue;let X=ne.buffer,ae=ne.type,J=ne.bytesPerElement,ge=ae===e.INT||ae===e.UNSIGNED_INT||j.gpuType===Q1;if(j instanceof pm){for(let be=0;be<F.locationSize;be++)S(F.location+be,j.meshPerAttribute);!(R instanceof Nn)&&q._maxInstanceCount===void 0&&(q._maxInstanceCount=j.meshPerAttribute*j.count)}else for(let be=0;be<F.locationSize;be++)C(F.location+be);e.bindBuffer(e.ARRAY_BUFFER,X);for(let be=0;be<F.locationSize;be++)M(F.location+be,le/F.locationSize,ae,pe,le*J,le/F.locationSize*be*J,ge)}else if(B!==void 0){let pe=B[de];if(pe!==void 0)switch(pe.length){case 2:e.vertexAttrib2fv(F.location,pe);break;case 3:e.vertexAttrib3fv(F.location,pe);break;case 4:e.vertexAttrib4fv(F.location,pe);break;default:e.vertexAttrib1fv(F.location,pe)}}}}v()}function I(){U();for(let R in n){let H=n[R];for(let O in H){let q=H[O];for(let w in q){let T=q[w];Ut(T,"state"),g(T.object),delete q[w]}delete H[O]}delete n[R]}}function P(R){if(n[R.id]===void 0)return;let H=n[R.id];for(let O in H){let q=H[O];for(let w in q){let T=q[w];Ut(T,"state"),g(T.object),delete q[w]}delete H[O]}delete n[R.id]}function _(R){for(let H in n){let O=n[H];if(Ut(O,"programMap"),O[R.id]===void 0)continue;let q=O[R.id];for(let w in q){let T=q[w];Ut(T,"state"),g(T.object),delete q[w]}delete O[R.id]}}function U(){Y(),l=!0,s!==a&&(s=a,p(s.object))}function Y(){a.geometry=null,a.program=null,a.wireframe=!1}this.setup=c,this.reset=U,this.resetDefaultState=Y,this.dispose=I,this.releaseStatesOfGeometry=P,this.releaseStatesOfProgram=_,this.initAttributes=E,this.enableAttribute=C,this.disableUnusedAttributes=v}};var GM=class{constructor(e,t){this.gl=e;this.info=t}setMode(e){this.mode=e}render(e,t){this.gl.drawArrays(this.mode,e,t),this.info.update(t,this.mode,1)}renderInstances(e,t,i){i!==0&&(this.gl.drawArraysInstanced(this.mode,e,t,i),this.info.update(t,this.mode,i))}};var TM=class{constructor(e,t,i){let o;function n(){if(o!==void 0)return o;if(t.has("EXT_texture_filter_anisotropic")===!0){let I=t.get("EXT_texture_filter_anisotropic");o=e.getParameter(I.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else o=0;return o||0}function a(I){if(I==="highp"){let P=e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT),_=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);if(P!==null&&P.precision>0&&_!==null&&_.precision>0)return"highp";I="mediump"}if(I==="mediump"){let P=e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT),_=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT);if(P!==null&&P.precision>0&&_!==null&&_.precision>0)return"mediump"}return"lowp"}let s=typeof WebGL2RenderingContext!="undefined"&&e.constructor.name==="WebGL2RenderingContext",l=i.precision!==void 0?i.precision:"highp",c=a(l);c!==l&&(console.warn("THREE.WebGLRenderer:",l,"not supported, using",c,"instead."),l=c);let d=s||t.has("WEBGL_draw_buffers"),p=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),g=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),h=e.getParameter(e.MAX_TEXTURE_SIZE),f=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),y=e.getParameter(e.MAX_VERTEX_ATTRIBS),x=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),E=e.getParameter(e.MAX_VARYING_VECTORS),C=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),S=g>0,v=s||t.has("OES_texture_float"),M=S&&v,A=s?e.getParameter(e.MAX_SAMPLES):0;this.isWebGL2=s,this.drawBuffers=d,this.getMaxAnisotropy=n,this.getMaxPrecision=a,this.precision=l,this.maxTextures=p,this.maxVertexTextures=g,this.maxTextureSize=h,this.maxCubemapSize=f,this.maxAttributes=y,this.maxVertexUniforms=x,this.maxVaryings=E,this.maxFragmentUniforms=C,this.vertexTextures=S,this.floatFragmentTextures=v,this.floatVertexTextures=M,this.maxSamples=A}};var MM=class{constructor(e){let t={};function i(o){if(t[o]!==void 0)return t[o];let n;switch(o){case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(o)}return t[o]=n,n}this.has=function(o){return i(o)!==null},this.init=function(){i("EXT_color_buffer_float"),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture")},this.get=function(o){let n=i(o);return n===null&&console.warn("THREE.WebGLRenderer: "+o+" extension not supported."),n}}};var gw=class extends Wa{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}};var IM=class{constructor(e,t,i,o){let n={},a=new WeakMap;function s(g){let h=g.target;h.index!==null&&t.remove(h.index);for(let y in h.attributes)t.remove(h.attributes[y]);h.removeEventListener("dispose",s),delete n[h.id];let f=a.get(h);f&&(t.remove(f),a.delete(h)),o.releaseStatesOfGeometry(h),h instanceof gw&&delete h._maxInstanceCount,i.memory.geometries--}function l(g,h){return n[h.id]===!0||(h.addEventListener("dispose",s),n[h.id]=!0,i.memory.geometries++),h}function c(g){let h=g.attributes;for(let f in h)t.update(h[f],e.ARRAY_BUFFER)}function d(g){let h=[],f=g.index,y=g.attributes.position,x=0;if(f!==null){let S=f.array;x=f.version;for(let v=0,M=S.length;v<M;v+=3){let A=S[v+0],I=S[v+1],P=S[v+2];h.push(A,I,I,P,P,A)}}else if(y!==void 0){let S=y.array;x=y.version;for(let v=0,M=S.length/3-1;v<M;v+=3){let A=v+0,I=v+1,P=v+2;h.push(A,I,I,P,P,A)}}else return;let E=new(gM(h)?om:im)(h,1);E.version=x;let C=a.get(g);C&&t.remove(C),a.set(g,E)}function p(g){let h=a.get(g);if(h){let y=g.index;y!==null&&h.version<y.version&&d(g)}else d(g);let f=a.get(g);return Ut(f,"attribute"),f}this.get=l,this.update=c,this.getWireframeAttribute=p}};var AM=class{constructor(e,t){this.gl=e;this.info=t}setMode(e){this.mode=e}setIndex(e){this.type=e.type,this.bytesPerElement=e.bytesPerElement}render(e,t){this.gl.drawElements(this.mode,t,this.type,e*this.bytesPerElement),this.info.update(t,this.mode,1)}renderInstances(e,t,i){i!==0&&(this.gl.drawElementsInstanced(this.mode,t,this.type,e*this.bytesPerElement,i),this.info.update(t,this.mode,i))}};var VM=class{constructor(e){this.gl=e;this.autoReset=!0;this.programs=null;this.memory={geometries:0,textures:0},this.render={frame:0,calls:0,triangles:0,points:0,lines:0}}update(e,t,i){let o=this.gl,n=this.render;switch(n.calls++,t){case o.TRIANGLES:n.triangles+=i*(e/3);break;case o.LINES:n.lines+=i*(e/2);break;case o.LINE_STRIP:n.lines+=i*(e-1);break;case o.LINE_LOOP:n.lines+=i*e;break;case o.POINTS:n.points+=i*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",t);break}}reset(){this.render.calls=0,this.render.triangles=0,this.render.points=0,this.render.lines=0}};var LM=class{constructor(e,t,i,o){let n=new WeakMap;function a(c){let d=o.render.frame,p=c.geometry,g=t.get(c,p);return n.get(g)!==d&&(t.update(g),n.set(g,d)),c instanceof Nn&&(c.hasEventListener("dispose",l)===!1&&c.addEventListener("dispose",l),n.get(c)!==d&&(i.update(c.instanceMatrix,e.ARRAY_BUFFER),c.instanceColor&&i.update(c.instanceColor,e.ARRAY_BUFFER),c.instancePickingColor&&i.update(c.instancePickingColor,e.ARRAY_BUFFER),n.set(c,d))),g}function s(){n=new WeakMap}function l(c){let d=c.target;d.removeEventListener("dispose",l),i.remove(d.instanceMatrix),d.instanceColor&&i.remove(d.instanceColor),d.instancePickingColor&&i.remove(d.instancePickingColor)}this.update=a,this.dispose=s}};var tj=new rc(new cu(0,0));function Pce(r){return typeof r[0]=="number"}function Gh(r){return!Array.isArray(r)&&"x"in r}var Y$=[],X$=[],J$=new Float32Array(16),Q$=new Float32Array(9),Z$=new Float32Array(4);function mw(r,e,t){if(Pce(r))return r;let i=e*t,o=Y$[i];if(o===void 0&&(o=new Float32Array(i),Y$[i]=o),e!==0){r[0].toArray(o,0);for(let n=1,a=0;n!==e;++n)a+=t,r[n].toArray(o,a)}return o}function Js(r,e){if(r.length!==e.length)return!1;for(let t=0,i=r.length;t<i;t++)if(r[t]!==e[t])return!1;return!0}function Qs(r,e){for(let t=0,i=e.length;t<i;t++)r[t]=e[t]}function _ce(r,e){let t=X$[e];t===void 0&&(t=new Int32Array(e),X$[e]=t);for(let i=0;i!==e;++i)t[i]=r.allocateTextureUnit();return t}function Oce(r,e){let t=this.cache;t[0]!==e&&(r.uniform1f(this.addr,e),t[0]=e)}function Rce(r,e){let t=this.cache;if(Gh(e))(t[0]!==e.x||t[1]!==e.y)&&(r.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Js(t,e))return;r.uniform2fv(this.addr,e),Qs(t,e)}}function Fce(r,e){let t=this.cache;if(Gh(e))(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(r.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e instanceof er)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(r.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Js(t,e))return;r.uniform3fv(this.addr,e),Qs(t,e)}}function Nce(r,e){let t=this.cache;if(Gh(e))(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(r.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Js(t,e))return;r.uniform4fv(this.addr,e),Qs(t,e)}}function Bce(r,e){let t=this.cache;if(Array.isArray(e)){if(Js(t,e))return;r.uniformMatrix2fv(this.addr,!1,e),Qs(t,e)}else{let i=e.elements;if(Js(t,i))return;Z$.set(i),r.uniformMatrix2fv(this.addr,!1,Z$),Qs(t,i)}}function Uce(r,e){let t=this.cache;if(Array.isArray(e)){if(Js(t,e))return;r.uniformMatrix3fv(this.addr,!1,e),Qs(t,e)}else{let i=e.elements;if(Js(t,i))return;Q$.set(i),r.uniformMatrix3fv(this.addr,!1,Q$),Qs(t,i)}}function zce(r,e){let t=this.cache;if(Array.isArray(e)){if(Js(t,e))return;r.uniformMatrix4fv(this.addr,!1,e),Qs(t,e)}else{let i=e.elements;if(Js(t,i))return;J$.set(i),r.uniformMatrix4fv(this.addr,!1,J$),Qs(t,i)}}function Kce(r,e){let t=this.cache;t[0]!==e&&(r.uniform1i(this.addr,e),t[0]=e)}function qce(r,e){let t=this.cache;if(Gh(e))(t[0]!==e.x||t[1]!==e.y)&&(r.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Js(t,e))return;r.uniform2iv(this.addr,e),Qs(t,e)}}function Hce(r,e){let t=this.cache;if(Gh(e))(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(r.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Js(t,e))return;r.uniform3iv(this.addr,e),Qs(t,e)}}function Wce(r,e){let t=this.cache;if(Gh(e))(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(r.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Js(t,e))return;r.uniform4iv(this.addr,e),Qs(t,e)}}function $ce(r,e){let t=this.cache;t[0]!==e&&(r.uniform1ui(this.addr,e),t[0]=e)}function jce(r,e){let t=this.cache;if(Gh(e))(t[0]!==e.x||t[1]!==e.y)&&(r.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Js(t,e))return;r.uniform2uiv(this.addr,e),Qs(t,e)}}function Yce(r,e){let t=this.cache;if(Gh(e))(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(r.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Js(t,e))return;r.uniform3uiv(this.addr,e),Qs(t,e)}}function Xce(r,e){let t=this.cache;if(Gh(e))(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(r.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Js(t,e))return;r.uniform4uiv(this.addr,e),Qs(t,e)}}function Jce(r,e,t){let i=this.cache,o=t.allocateTextureUnit();i[0]!==o&&(r.uniform1i(this.addr,o),i[0]=o),t.setTexture2D(e||tj,o)}function Qce(r){switch(r){case 5126:return Oce;case 35664:return Rce;case 35665:return Fce;case 35666:return Nce;case 35674:return Bce;case 35675:return Uce;case 35676:return zce;case 5124:case 35670:return Kce;case 35667:case 35671:return qce;case 35668:case 35672:return Hce;case 35669:case 35673:return Wce;case 5125:return $ce;case 36294:return jce;case 36295:return Yce;case 36296:return Xce;case 35678:case 36198:case 36298:case 36306:return Jce;case 35679:case 36299:case 36307:throw new Error("THREE.WebGLUniforms: sampler3D support is not implemented.");case 35680:case 36300:case 36308:throw new Error("THREE.WebGLUniforms: samplerCube support is not implemented.");case 36289:case 36303:case 36311:throw new Error("THREE.WebGLUniforms: sampler2DArray support is not implemented.")}throw new Error(`Unknown uniform type: ${r}`)}function Zce(r,e){r.uniform1fv(this.addr,e)}function ede(r,e){let t=mw(e,this.size,2);r.uniform2fv(this.addr,t)}function tde(r,e){let t=mw(e,this.size,3);r.uniform3fv(this.addr,t)}function rde(r,e){let t=mw(e,this.size,4);r.uniform4fv(this.addr,t)}function ide(r,e){let t=mw(e,this.size,4);r.uniformMatrix2fv(this.addr,!1,t)}function ode(r,e){let t=mw(e,this.size,9);r.uniformMatrix3fv(this.addr,!1,t)}function nde(r,e){let t=mw(e,this.size,16);r.uniformMatrix4fv(this.addr,!1,t)}function ade(r,e){r.uniform1iv(this.addr,e)}function sde(r,e){r.uniform2iv(this.addr,e)}function lde(r,e){r.uniform3iv(this.addr,e)}function cde(r,e){r.uniform4iv(this.addr,e)}function dde(r,e){r.uniform1uiv(this.addr,e)}function pde(r,e){r.uniform2uiv(this.addr,e)}function ude(r,e){r.uniform3uiv(this.addr,e)}function hde(r,e){r.uniform4uiv(this.addr,e)}function gde(r,e,t){let i=this.cache,o=e.length,n=_ce(t,o);Js(i,n)||(r.uniform1iv(this.addr,n),Qs(i,n));for(let a=0;a!==o;++a)t.setTexture2D(e[a]||tj,n[a])}function mde(r){switch(r){case 5126:return Zce;case 35664:return ede;case 35665:return tde;case 35666:return rde;case 35674:return ide;case 35675:return ode;case 35676:return nde;case 5124:case 35670:return ade;case 35667:case 35671:return sde;case 35668:case 35672:return lde;case 35669:case 35673:return cde;case 5125:return dde;case 36294:return pde;case 36295:return ude;case 36296:return hde;case 35678:case 36198:case 36298:case 36306:return gde;case 35679:case 36299:case 36307:throw new Error("THREE.WebGLUniforms: sampler3DArray support is not implemented.");case 35680:case 36300:case 36308:throw new Error("THREE.WebGLUniforms: samplerCube support is not implemented.");case 36289:case 36303:case 36311:throw new Error("THREE.WebGLUniforms: sampler2DArray support is not implemented.")}throw new Error(`Unrecognized uniform type: ${r}`)}var yF=class{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=Qce(t.type)}},xF=class{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=mde(t.type)}},PM=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){let o=this.seq;for(let n=0,a=o.length;n!==a;++n){let s=o[n];s.setValue(e,t[s.id],i)}}},bF=/(\w+)(\])?(\[|\.)?/g;function ej(r,e){r.seq.push(e),r.map[e.id]=e}function fde(r,e,t){let i=r.name,o=i.length;for(bF.lastIndex=0;;){let n=bF.exec(i),a=bF.lastIndex;Ut(n,"parseUniform match");let s=n[1],l=n[2]==="]",c=n[3];if(l&&(s=s|0),c===void 0||c==="["&&a+2===o){ej(t,c===void 0?new yF(s,r,e):new xF(s,r,e));break}else{let p=t.map[s];if(p===void 0&&(p=new PM(s),ej(t,p)),!(p instanceof PM))throw new Error(`THREE.WebGLUniforms: Programming error: expected ${s} to be a StructuredUniform`);t=p}}}var hm=class{constructor(e,t){this.seq=[],this.map={};let i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let o=0;o<i;++o){let n=e.getActiveUniform(t,o);Ut(n,"active info",e);let a=e.getUniformLocation(t,n.name);fde(n,a,this)}}setValue(e,t,i,o){let n=this.map[t];n!==void 0&&n.setValue(e,i,o)}setOptional(e,t,i,o){let n=t[i];n!==void 0&&this.setValue(e,i,n,o)}static upload(e,t,i,o){for(let n=0,a=t.length;n!==a;++n){let s=t[n],l=i[s.id];l.needsUpdate!==!1&&s.setValue(e,l.value,o)}}static seqWithValue(e,t){let i=[];for(let o=0,n=e.length;o!==n;++o){let a=e[o];a.id in t&&i.push(a)}return i}};function wF(r,e,t){let i=r.createShader(e);if(!i)throw new Error(`Error creating shader (type ${e}): ${t}`);return r.shaderSource(i,t),r.compileShader(i),i}var rj=`
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6

#define saturate( a ) clamp( a, 0.0, 1.0 )

float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }

#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif

struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};

struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};

struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
};

vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}

vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}

vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
`;var ij=`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}

vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
`;var oj=`
#ifdef USE_MAP
	diffuseColor *= texture2D( map, vMapUv );
#endif

#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif
`;var nj=`
#ifdef OPAQUE
  diffuseColor.a = 1.0;
#endif

gl_FragColor = vec4( outgoingLight, diffuseColor.a );
gl_FragColor = linearToOutputTexel( gl_FragColor );

#ifdef PREMULTIPLIED_ALPHA
	// Get get normal blending with premultipled, use with CustomBlending, OneFactor, OneMinusSrcAlphaFactor, AddEquation.
	gl_FragColor.rgb *= gl_FragColor.a;
#endif
`;var aj=`
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif

#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif

#if defined(USE_INSTANCING_PICKINGCOLOR) || defined (USE_VERTEX_PICKING_COLOR)
	varying vec4 vPickingColor;
#endif
`;var sj=`
#ifdef USE_MAP
	vMapUv = ( vec3( MAP_UV, 1 ) ).xy;
#endif

vec3 transformed = vec3( position );
vec4 mvPosition = vec4( transformed, 1.0 );

#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#else
	mvPosition = dcgModelMatrix * mvPosition;
#endif

mvPosition = modelViewMatrix * mvPosition;

gl_Position = projectionMatrix * mvPosition;

#ifdef USE_COLOR
	vColor = color;
#endif

#ifdef USE_INSTANCING_COLOR
  vColor = instanceColor;
#endif

#ifdef USE_INSTANCING_PICKINGCOLOR
	vPickingColor = instancePickingColor;
#endif

#ifdef USE_VERTEX_PICKING_COLOR
	vPickingColor = vertexPickingColor;
#endif

`;var lj=`
PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );

vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );

material.roughness = max( roughnessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.
material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );

#ifdef IOR
	material.ior = ior;
	float specularIntensityFactor = 1.0;
	vec3 specularColorFactor = vec3( 1.0 );
	material.specularF90 = 1.0;
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif

GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );

IncidentLight directLight;

#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif

#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
#endif

#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif

#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif

#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif
`;var cj=`
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];

vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}

vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}

vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}

#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif

struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;

	#ifdef IOR
		float ior;
	#endif
};

vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );

float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}

float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0; // avoid alpha = 0 with dotNH = 1
	return RECIPROCAL_PI * a2 / pow2( denom );
}

vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness ); // UE4's roughness
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}

vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}

void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	vec3 Fr = specularColor;
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619; // 1/21
	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}

void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}

void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}

void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}

#define RE_Direct RE_Direct_Physical
#define RE_IndirectDiffuse RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular	RE_IndirectSpecular_Physical
`;var dj=`
#ifdef USE_MAP
	varying vec2 vMapUv;
	uniform sampler2D map;
#endif

#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif

#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif

#if defined(USE_INSTANCING_PICKINGCOLOR) || defined(USE_VERTEX_PICKING_COLOR)
	varying vec4 vPickingColor;
#endif
`;var Ta={common:rj,colorspace_pars_fragment:ij,common_fragment_begin:oj,common_fragment_end:nj,common_pars_fragment:dj,common_pars_vertex:aj,common_vertex:sj,lights_fragment:lj,lights_pars_fragment:cj};as();var bde=0;function yde(r,e){if(r===null)throw new Error("Shader source is undefined.");let t=r.split(`
`),i=[],o=Math.max(e-6,0),n=Math.min(e+6,t.length);for(let a=o;a<n;a++){let s=a+1;i.push(`${s===e?">":" "} ${s}: ${t[a]}`)}return i.join(`
`)}function xde(r){switch(r){case Zl:return["Linear","( value )"];case ko:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",r),["Linear","( value )"]}}function pj(r,e,t){let i=r.getShaderParameter(e,r.COMPILE_STATUS),o=r.getShaderInfoLog(e);Ut(o,"shader info",r);let n=o.trim()||"";if(i&&n==="")return"";let a=/ERROR: 0:(\d+)/.exec(n);if(a){let s=parseInt(a[1]);return t.toUpperCase()+`

`+n+`

`+yde(r.getShaderSource(e),s)}else return n}function wde(r,e){let t=xde(e);return"vec4 "+r+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function vde(r){let e=[];for(let t in r){let i=r[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function Cde(r,e){let t={},i=r.getProgramParameter(e,r.ACTIVE_ATTRIBUTES);for(let o=0;o<i;o++){let n=r.getActiveAttrib(e,o);if(!n)throw new Error("THREE.WebGLProgram: Error fetching attribute info.");let a=n.name,s=1;n.type===r.FLOAT_MAT2&&(s=2),n.type===r.FLOAT_MAT3&&(s=3),n.type===r.FLOAT_MAT4&&(s=4),t[a]={type:n.type,location:r.getAttribLocation(e,a),locationSize:s}}return t}function uj(r){return r!==""}function hj(r,e){return r.replace(/NUM_DIR_LIGHTS/g,""+e.numDirLights)}var Ede=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function gj(r){return r.replace(Ede,Sde)}function Sde(r,e,t,i){let o="";for(let n=parseInt(e);n<parseInt(t);n++)o+=i.replace(/\[\s*i\s*\]/g,"[ "+n+" ]").replace(/UNROLLED_LOOP_INDEX/g,""+n);return o}function mj(r){let e="precision "+r.precision+` float;
precision `+r.precision+" int;";return r.precision==="highp"?e+=`
#define HIGH_PRECISION`:r.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:r.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}var _M=class{constructor(e,t,i,o){var v,M,A;let n=e.getContext(),a=i.defines,s=i.vertexShader,l=i.fragmentShader,c=vde(a),d=n.createProgram();if(!d)throw new Error("THREE.WebGLProgram: Unable to create program.");let p,g,h=i.glslVersion?"#version "+i.glslVersion+`
`:"";p=[mj(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,c,i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.instancingPickingColor?"#define USE_INSTANCING_PICKINGCOLOR":"",i.vertexPickingColor?"#define USE_VERTEX_PICKING_COLOR":"",i.map?"#define USE_MAP":"",i.mapUv?"#define MAP_UV "+i.mapUv:"",i.vertexColors?"#define USE_COLOR":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_PICKINGCOLOR","	attribute vec4 instancePickingColor;","#endif","#ifdef USE_VERTEX_PICKING_COLOR"," attribute vec4 vertexPickingColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif",`
`].filter(uj).join(`
`),g=[mj(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,c,i.map?"#define USE_MAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.vertexColors?"#define USE_COLOR":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.instancingPickingColor?"#define USE_INSTANCING_PICKINGCOLOR":"",i.vertexPickingColor?"#define USE_VERTEX_PICKING_COLOR":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.opaque?"#define OPAQUE":"",Ta.colorspace_pars_fragment,wde("linearToOutputTexel",i.outputColorSpace),`
`].filter(uj).join(`
`),s=hj(s,i),l=hj(l,i),s=gj(s),l=gj(l),h=`#version 300 es
`,p=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+p,g=["#define varying in",i.glslVersion===aF?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===aF?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+g;let f=h+p+s,y=h+g+l,x=wF(n,n.VERTEX_SHADER,f),E=wF(n,n.FRAGMENT_SHADER,y);if(n.attachShader(d,x),n.attachShader(d,E),i.index0AttributeName!==void 0&&n.bindAttribLocation(d,0,i.index0AttributeName),n.linkProgram(d),e.debug.checkShaderErrors){let I=(v=n.getProgramInfoLog(d))==null?void 0:v.trim(),P=(M=n.getShaderInfoLog(x))==null?void 0:M.trim(),_=(A=n.getShaderInfoLog(E))==null?void 0:A.trim();Ut(I,"program lob",n),Ut(P,"vertex log",n),Ut(_,"fragment log",n);let U=!0,Y=!0;if(n.getProgramParameter(d,n.LINK_STATUS)===!1)if(U=!1,typeof e.debug.onShaderError=="function")e.debug.onShaderError(n,d,x,E);else{let R=pj(n,x,"vertex"),H=pj(n,E,"fragment"),O=n.getError();console.error("THREE.WebGLProgram: Shader Error "+O+" - VALIDATE_STATUS "+n.getProgramParameter(d,n.VALIDATE_STATUS)+`

Program Info Log: `+I+`
`+R+`
`+H),O&&O!=1282||R||H||I?Ii("Shader error",{metaData:{glError:O,glProgramParameter:n.getProgramParameter(d,n.VALIDATE_STATUS),glProgramLog:I,glVertexErrors:R,glFragmentError:H,vertexShader:f,fragmentShader:y}}):Ii("WebGL program link failure with no error reported",{metaData:{vertexShader:f,fragmentShader:y}})}else I!==""?console.warn("THREE.WebGLProgram: Program Info Log:",I):(P===""||_==="")&&(Y=!1);Y&&(this.diagnostics={runnable:U,programLog:I,vertexShader:{log:P,prefix:p},fragmentShader:{log:_,prefix:g}})}n.deleteShader(x),n.deleteShader(E);let C;this.getUniforms=function(){return C===void 0&&(C=new hm(n,d)),C};let S;this.getAttributes=function(){return S===void 0&&(S=Cde(n,d)),S},this.destroy=function(){o.releaseStatesOfProgram(this),n.deleteProgram(d),this.program=void 0},this.type=i.shaderType,this.name=i.shaderName,this.id=bde++,this.cacheKey=t,this.usedTimes=1,this.program=d,this.vertexShader=x,this.fragmentShader=E}};var Dde=0,OM=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,i=e.fragmentShader,o=this._getShaderStage(t),n=this._getShaderStage(i),a=this._getShaderCacheForMaterial(e);return a.has(o)===!1&&(a.add(o),o.usedTimes++),a.has(n)===!1&&(a.add(n),n.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let i of t||[])i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){let t=this.shaderCache,i=t.get(e);return i===void 0&&(i=new vF(e),t.set(e,i)),i}},vF=class{constructor(e){this.id=Dde++,this.code=e,this.usedTimes=0}};var RM=class{constructor(e,t,i){let o=new nw,n=new OM,a=[],s=t.vertexTextures,l=t.precision;function c(C){return C===0?"uv":`uv${C}`}function d(C,S,v,M){var T,B,de,F;let A=M.geometry;C.precision!==null&&(l=t.getMaxPrecision(C.precision),l!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",l,"instead."));let I=C.vertexShader,P=C.fragmentShader;n.update(C);let _=n.getVertexShaderID(C),U=n.getFragmentShaderID(C),Y=e.getRenderTarget(),R=M instanceof Nn,H=!!A.attributes.uv1,O=!!A.attributes.uv2,q=!!A.attributes.uv3;return{shaderType:C.type,shaderName:C.name,vertexShader:I,fragmentShader:P,defines:C.defines,customVertexShaderID:_,customFragmentShaderID:U,glslVersion:C.glslVersion,precision:l,instancing:R,instancingColor:R&&!!M.instanceColor,instancingPickingColor:R&&!!M.instancePickingColor,vertexPickingColor:!!M.pickingColorArray,supportsVertexTextures:s,outputColorSpace:Y===null?e.outputColorSpace:Zl,map:!!C.map,opaque:C.transparent===!1&&C.blending===em,alphaTest:C.alphaTest>0,mapUv:!!C.map&&c(C.map.channel),vertexColors:C.vertexColors,vertexUv1s:H,vertexUv2s:O,vertexUv3s:q,numDirLights:S.directional.length,premultipliedAlpha:C.premultipliedAlpha,doubleSided:C.side===Ls,flipSided:C.side===Yf,index0AttributeName:C.index0AttributeName,extensionDerivatives:((T=C.extensions)==null?void 0:T.derivatives)===!0,extensionFragDepth:((B=C.extensions)==null?void 0:B.fragDepth)===!0,extensionDrawBuffers:((de=C.extensions)==null?void 0:de.drawBuffers)===!0,extensionShaderTextureLOD:((F=C.extensions)==null?void 0:F.shaderTextureLOD)===!0,rendererExtensionFragDepth:!0,rendererExtensionDrawBuffers:!0,rendererExtensionShaderTextureLod:!0,customProgramCacheKey:C.customProgramCacheKey()}}function p(C){let S=[];if(S.push(C.customVertexShaderID),S.push(C.customFragmentShaderID),C.defines!==void 0)for(let v in C.defines)S.push(v),S.push(C.defines[v]);return g(S,C),h(S,C),S.push(e.outputColorSpace),S.push(C.customProgramCacheKey),S.join()}function g(C,S){C.push(S.precision),C.push(S.outputColorSpace),C.push(S.mapUv),C.push(S.numDirLights)}function h(C,S){o.disableAll(),o.enable(0),S.instancing&&o.enable(2),S.instancingColor&&o.enable(3),S.instancingPickingColor&&o.enable(4),S.vertexPickingColor&&o.enable(5),S.supportsVertexTextures&&o.enable(1),S.alphaTest&&o.enable(10),S.vertexColors&&o.enable(11),S.vertexUv1s&&o.enable(13),S.vertexUv2s&&o.enable(14),S.vertexUv3s&&o.enable(15),C.push(o.mask),o.disableAll(),S.premultipliedAlpha&&o.enable(8),S.doubleSided&&o.enable(11),S.flipSided&&o.enable(12),S.opaque&&o.enable(17),C.push(o.mask)}function f(C,S){let v;for(let M=0,A=a.length;M<A;M++){let I=a[M];if(I.cacheKey===S){v=I,++v.usedTimes;break}}return v===void 0&&(v=new _M(e,S,C,i),a.push(v)),v}function y(C){if(--C.usedTimes===0){let S=a.indexOf(C);a[S]=a[a.length-1],a.pop(),C.destroy()}}function x(C){n.remove(C)}function E(){n.dispose()}this.getParameters=d,this.getProgramCacheKey=p,this.getUniforms=C=>C.uniforms,this.acquireProgram=f,this.releaseProgram=y,this.releaseShaderCache=x,this.programs=a,this.dispose=E}};var FM=class{constructor(){let e=new WeakMap;function t(a){let s=e.get(a);return s===void 0&&(s={},e.set(a,s)),s}function i(a){e.delete(a)}function o(a,s,l){e.get(a)[s]=l}function n(){e=new WeakMap}this.get=t,this.remove=i,this.update=o,this.dispose=n}};var NM=class{constructor(){let e=[],t=0,i=[],o=[];function n(){t=0,i.length=0,o.length=0}function a(p,g,h,f,y,x){let E=e[t];return E===void 0?(E={id:p.id,object:p,geometry:g,material:h,groupOrder:f,renderOrder:p.renderOrder,z:y,group:x},e[t]=E):(E.id=p.id,E.object=p,E.geometry=g,E.material=h,E.groupOrder=f,E.renderOrder=p.renderOrder,E.z=y,E.group=x),t++,E}function s(p,g,h,f,y,x){let E=a(p,g,h,f,y,x);h.transparent===!0?o.push(E):i.push(E)}function l(p,g,h,f,y,x){let E=a(p,g,h,f,y,x);h.transparent===!0?o.unshift(E):i.unshift(E)}function c(p,g){i.length>1&&i.sort(p||kde),o.length>1&&o.sort(g||Gde)}function d(){for(let p=t,g=e.length;p<g;p++){let h=e[p];if(h.id===null)break;h.id=null,h.object=null,h.geometry=null,h.material=null,h.group=null}}this.opaque=i,this.transparent=o,this.init=n,this.push=s,this.unshift=l,this.finish=d,this.sort=c}},BM=class{constructor(){let e=new WeakMap;function t(o,n){let a=e.get(o),s;return a===void 0?(s=new NM,e.set(o,[s])):n>=a.length?(s=new NM,a.push(s)):s=a[n],s}function i(){e=new WeakMap}this.get=t,this.dispose=i}};function kde(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.material.id!==e.material.id?r.material.id-e.material.id:r.z!==e.z?r.z-e.z:r.id-e.id}function Gde(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.z!==e.z?e.z-r.z:r.id-e.id}var CF=class{constructor(){this.lights={}}get(e){let t=this.lights,i=t[e.id];if(i!==void 0)return i;let o={direction:new Ae,color:new er};return t[e.id]=o,o}},Tde=0,UM=class{constructor(){let e=new CF;this.state={version:0,hash:{directionalLength:-1},ambient:[0,0,0],directional:[]};let t=this.state,i=new Ae;function o(a){let s=0,l=0,c=0,d=0;for(let g=0,h=a.length;g<h;g++){let f=a[g],y=f.color,x=f.intensity;if(f instanceof uw)s+=y.r*x,l+=y.g*x,c+=y.b*x;else if(f instanceof cm){let E=e.get(f);E.color.copy(f.color).multiplyScalar(f.intensity),t.directional[d]=E,d++}}t.ambient[0]=s,t.ambient[1]=l,t.ambient[2]=c;let p=t.hash;p.directionalLength!==d&&(t.directional.length=d,p.directionalLength=d,t.version=Tde++)}function n(a,s){let l=0,c=s.matrixWorldInverse;for(let d=0,p=a.length;d<p;d++){let g=a[d];if(g instanceof cm){let h=t.directional[l];h.direction.setFromMatrixPosition(g.matrixWorld),i.setFromMatrixPosition(g.target.matrixWorld),h.direction.sub(i),h.direction.transformDirection(c),l++}}}this.setup=o,this.setupView=n}};var zM=class{constructor(){let e=new UM,t=[];function i(){t.length=0}function o(s){t.push(s)}function n(){e.setup(t)}function a(s){e.setupView(t,s)}this.state={lightsArray:t,lights:e},this.init=i,this.pushLight=o,this.setupLights=n,this.setupLightsView=a}},KM=class{constructor(){let e=new WeakMap;this.get=function(i,o=0){let n=e.get(i),a;return n===void 0?(a=new zM,e.set(i,[a])):o>=n.length?(a=new zM,n.push(a)):a=n[o],a},this.dispose=function(){e=new WeakMap}}};var qM=class{constructor(e){function t(){let Q=!1,ke=new Ga,Ue=null,xe=new Ga(0,0,0,0);return{setMask:function(ct){Ue!==ct&&!Q&&(e.colorMask(ct,ct,ct,ct),Ue=ct)},setLocked:function(ct){Q=ct},setClear:function(ct,it,li,Mt,Bo){Bo===!0&&(ct*=Mt,it*=Mt,li*=Mt),ke.set(ct,it,li,Mt),xe.equals(ke)===!1&&(e.clearColor(ct,it,li,Mt),xe.copy(ke))},reset:function(){Q=!1,Ue=null,xe.set(-1,0,0,0)}}}function i(){let Q=!1,ke=null,Ue=null,xe=null;return{setTest:function(ct){ct?X(e.DEPTH_TEST):ae(e.DEPTH_TEST)},setMask:function(ct){ke!==ct&&!Q&&(e.depthMask(ct),ke=ct)},setFunc:function(ct){if(Ue!==ct){switch(ct){case n$:e.depthFunc(e.NEVER);break;case a$:e.depthFunc(e.ALWAYS);break;case s$:e.depthFunc(e.LESS);break;case NE:e.depthFunc(e.LEQUAL);break;case l$:e.depthFunc(e.EQUAL);break;case c$:e.depthFunc(e.GEQUAL);break;case d$:e.depthFunc(e.GREATER);break;case p$:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}Ue=ct}},setLocked:function(ct){Q=ct},setClear:function(ct){xe!==ct&&(e.clearDepth(ct),xe=ct)},reset:function(){Q=!1,ke=null,Ue=null,xe=null}}}function o(){let Q=!1,ke=null,Ue=null,xe=null,ct=null,it=null,li=null,Mt=null,Bo=null;return{setTest:function(Di){Q||(Di?X(e.STENCIL_TEST):ae(e.STENCIL_TEST))},setMask:function(Di){ke!==Di&&!Q&&(e.stencilMask(Di),ke=Di)},setFunc:function(Di,Br,ni){(Ue!==Di||xe!==Br||ct!==ni)&&(e.stencilFunc(Di,Br,ni),Ue=Di,xe=Br,ct=ni)},setOp:function(Di,Br,ni){(it!==Di||li!==Br||Mt!==ni)&&(e.stencilOp(Di,Br,ni),it=Di,li=Br,Mt=ni)},setLocked:function(Di){Q=Di},setClear:function(Di){Bo!==Di&&(e.clearStencil(Di),Bo=Di)},reset:function(){Q=!1,ke=null,Ue=null,xe=null,ct=null,it=null,li=null,Mt=null,Bo=null}}}let n=t(),a=i(),s=o(),l=new WeakMap,c=new WeakMap,d={},p={},g=new WeakMap,h=[],f=null,y=!1,x=null,E=null,C=null,S=null,v=null,M=null,A=null,I=!1,P=null,_=null,U=null,Y=null,R=null,H=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),O=!1,q=0,w=e.getParameter(e.VERSION);if(w.indexOf("WebGL")!==-1){let Q=/^WebGL (\d)/.exec(w);Ut(Q,"webgl version match",e),q=parseFloat(Q[1]),O=q>=1}else if(w.indexOf("OpenGL ES")!==-1){let Q=/^OpenGL ES (\d)/.exec(w);Ut(Q,"opengl es version match",e),q=parseFloat(Q[1]),O=q>=2}let T=null,B={},de=e.getParameter(e.SCISSOR_BOX),F=e.getParameter(e.VIEWPORT),j=new Ga().fromArray(de),pe=new Ga().fromArray(F);function le(Q,ke,Ue,xe){let ct=new Uint8Array(4),it=e.createTexture();e.bindTexture(Q,it),e.texParameteri(Q,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(Q,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let li=0;li<Ue;li++)Q===e.TEXTURE_3D||Q===e.TEXTURE_2D_ARRAY?(Ut(xe,"dimensions"),e.texImage3D(ke,0,e.RGBA,1,1,xe,0,e.RGBA,e.UNSIGNED_BYTE,ct)):e.texImage2D(ke+li,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,ct);return it}let ne={[e.TEXTURE_2D]:le(e.TEXTURE_2D,e.TEXTURE_2D,1),[e.TEXTURE_CUBE_MAP]:le(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),[e.TEXTURE_2D_ARRAY]:le(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),[e.TEXTURE_3D]:le(e.TEXTURE_3D,e.TEXTURE_3D,1,1)};n.setClear(0,0,0,1),a.setClear(1),s.setClear(0),X(e.DEPTH_TEST),a.setFunc(NE),Z(!1),W(IR),X(e.CULL_FACE),Se(W1);function X(Q){d[Q]!==!0&&(e.enable(Q),d[Q]=!0)}function ae(Q){d[Q]!==!1&&(e.disable(Q),d[Q]=!1)}function J(Q,ke){return p[Q]!==ke?(e.bindFramebuffer(Q,ke),p[Q]=ke,Q===e.DRAW_FRAMEBUFFER&&(p[e.FRAMEBUFFER]=ke),Q===e.FRAMEBUFFER&&(p[e.DRAW_FRAMEBUFFER]=ke),!0):!1}function ge(Q,ke){let Ue=h,xe=!1;Q?(Ut(ke,"framebuffer",e),Ue=g.get(ke),Ue===void 0&&(Ue=[],g.set(ke,Ue)),Ue[0]!==e.COLOR_ATTACHMENT0&&(Ue[0]=e.COLOR_ATTACHMENT0,xe=!0)):Ue[0]!==e.BACK&&(Ue[0]=e.BACK,xe=!0),xe&&e.drawBuffers(Ue)}function be(Q){return f!==Q?(Ut(Q,"program",e),e.useProgram(Q),f=Q,!0):!1}let Ee={[ou]:e.FUNC_ADD,[j9]:e.FUNC_SUBTRACT,[Y9]:e.FUNC_REVERSE_SUBTRACT,[X9]:e.MIN,[J9]:e.MAX},Le={[j1]:e.ZERO,[Y1]:e.ONE,[Q9]:e.SRC_COLOR,[X1]:e.SRC_ALPHA,[o$]:e.SRC_ALPHA_SATURATE,[r$]:e.DST_COLOR,[e$]:e.DST_ALPHA,[Z9]:e.ONE_MINUS_SRC_COLOR,[J1]:e.ONE_MINUS_SRC_ALPHA,[i$]:e.ONE_MINUS_DST_COLOR,[t$]:e.ONE_MINUS_DST_ALPHA};function Se(Q,ke,Ue,xe,ct,it,li,Mt){if(Q===W1){y===!0&&(ae(e.BLEND),y=!1);return}if(y===!1&&(X(e.BLEND),y=!0),Q!==$1){if(Q!==x||Mt!==I){if((E!==ou||v!==ou)&&(e.blendEquation(e.FUNC_ADD),E=ou,v=ou),Mt)switch(Q){case em:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case FE:e.blendFunc(e.ONE,e.ONE);break;case AR:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case VR:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Q);break}else switch(Q){case em:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case FE:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case AR:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case VR:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Q);break}C=null,S=null,M=null,A=null,x=Q,I=Mt}return}ct=ct||ke,it=it||Ue,li=li||xe,(ke!==E||ct!==v)&&(Ut(ke,"blendEquation"),Ut(ct,"blendEquationAlpha"),e.blendEquationSeparate(Ee[ke],Ee[ct]),E=ke,v=ct),(Ue!==C||xe!==S||it!==M||li!==A)&&(Ut(Ue,"blendSrc"),Ut(xe,"blendDst"),Ut(it,"blendSrcAlpha"),Ut(li,"blendDstAlpha"),e.blendFuncSeparate(Le[Ue],Le[xe],Le[it],Le[li]),C=Ue,S=xe,M=it,A=li),x=Q,I=!1}function et(Q,ke){Q.side===Ls?ae(e.CULL_FACE):X(e.CULL_FACE);let Ue=Q.side===Yf;ke&&(Ue=!Ue),Z(Ue),Q.blending===em&&Q.transparent===!1?Se(W1):Se(Q.blending,Q.blendEquation,Q.blendSrc,Q.blendDst,Q.blendEquationAlpha,Q.blendSrcAlpha,Q.blendDstAlpha,Q.premultipliedAlpha),a.setFunc(Q.depthFunc),a.setTest(Q.depthTest),a.setMask(Q.depthWrite),n.setMask(Q.colorWrite);let xe=Q.stencilWrite;s.setTest(xe),xe&&(s.setMask(Q.stencilWriteMask),s.setFunc(Q.stencilFunc,Q.stencilRef,Q.stencilFuncMask),s.setOp(Q.stencilFail,Q.stencilZFail,Q.stencilZPass)),Ne(Q.polygonOffset,Q.polygonOffsetFactor,Q.polygonOffsetUnits),Q.alphaToCoverage===!0?X(e.SAMPLE_ALPHA_TO_COVERAGE):ae(e.SAMPLE_ALPHA_TO_COVERAGE)}function Z(Q){P!==Q&&(Q?e.frontFace(e.CW):e.frontFace(e.CCW),P=Q)}function W(Q){Q!==W9?(X(e.CULL_FACE),Q!==_&&(Q===IR?e.cullFace(e.BACK):Q===$9?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):ae(e.CULL_FACE),_=Q}function De(Q){Q!==U&&(O&&e.lineWidth(Q),U=Q)}function Ne(Q,ke,Ue){Q?(X(e.POLYGON_OFFSET_FILL),(Y!==ke||R!==Ue)&&(Ut(ke,"factor"),Ut(Ue,"units"),e.polygonOffset(ke,Ue),Y=ke,R=Ue)):ae(e.POLYGON_OFFSET_FILL)}function me(Q){Q?X(e.SCISSOR_TEST):ae(e.SCISSOR_TEST)}function ve(Q){Q===void 0&&(Q=e.TEXTURE0+H-1),T!==Q&&(e.activeTexture(Q),T=Q)}function Pe(Q,ke,Ue){Ue===void 0&&(T===null?Ue=e.TEXTURE0+H-1:Ue=T);let xe=B[Ue];xe===void 0&&(xe={type:void 0,texture:void 0},B[Ue]=xe),(xe.type!==Q||xe.texture!==ke)&&(T!==Ue&&(e.activeTexture(Ue),T=Ue),e.bindTexture(Q,ke||ne[Q]),xe.type=Q,xe.texture=ke)}function He(){if(T===null)throw new Error("THREE.WebGLState: Trying to unbind a texture that was never bound");let Q=B[T];Q!==void 0&&Q.type!==void 0&&(e.bindTexture(Q.type,null),Q.type=void 0,Q.texture=void 0)}this.compressedTexImage2D=function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(ke){console.error("THREE.WebGLState:",ke)}},this.compressedTexImage3D=function(){try{e.compressedTexImage3D.apply(e,arguments)}catch(ke){console.error("THREE.WebGLState:",ke)}},this.texSubImage2D=function(){try{e.texSubImage2D.apply(e,arguments)}catch(ke){console.error("THREE.WebGLState:",ke)}},this.texSubImage3D=function(){try{e.texSubImage3D.apply(e,arguments)}catch(ke){console.error("THREE.WebGLState:",ke)}},this.compressedTexSubImage2D=function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(ke){console.error("THREE.WebGLState:",ke)}},this.compressedTexSubImage3D=function(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(ke){console.error("THREE.WebGLState:",ke)}},this.texStorage2D=function(){try{e.texStorage2D.apply(e,arguments)}catch(ke){console.error("THREE.WebGLState:",ke)}},this.texStorage3D=function(){try{e.texStorage3D.apply(e,arguments)}catch(ke){console.error("THREE.WebGLState:",ke)}},this.texImage2D=function(){try{e.texImage2D.apply(e,arguments)}catch(ke){console.error("THREE.WebGLState:",ke)}},this.texImage3D=function(){try{e.texImage3D.apply(e,arguments)}catch(ke){console.error("THREE.WebGLState:",ke)}};function ot(Q){j.equals(Q)===!1&&(e.scissor(Q.x,Q.y,Q.z,Q.w),j.copy(Q))}function Ge(Q){pe.equals(Q)===!1&&(e.viewport(Q.x,Q.y,Q.z,Q.w),pe.copy(Q))}function Et(Q,ke){let Ue=c.get(ke);Ue===void 0&&(Ue=new WeakMap,c.set(ke,Ue));let xe=Ue.get(Q);xe===void 0&&(xe=e.getUniformBlockIndex(ke,Q.name),Ue.set(Q,xe))}function Oe(Q,ke){let xe=c.get(ke).get(Q);l.get(ke)!==xe&&(e.uniformBlockBinding(ke,xe,Q.__bindingPointIndex),l.set(ke,xe))}function Tr(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),d={},T=null,B={},p={},g=new WeakMap,h=[],f=null,y=!1,x=null,E=null,C=null,S=null,v=null,M=null,A=null,I=!1,P=null,_=null,U=null,Y=null,R=null,j.set(0,0,e.canvas.width,e.canvas.height),pe.set(0,0,e.canvas.width,e.canvas.height),n.reset(),a.reset(),s.reset()}this.buffers={color:n,depth:a,stencil:s},this.enable=X,this.disable=ae,this.bindFramebuffer=J,this.drawBuffers=ge,this.useProgram=be,this.setBlending=Se,this.setMaterial=et,this.setFlipSided=Z,this.setCullFace=W,this.setLineWidth=De,this.setPolygonOffset=Ne,this.setScissorTest=me,this.activeTexture=ve,this.bindTexture=Pe,this.unbindTexture=He,this.updateUBOMapping=Et,this.uniformBlockBinding=Oe,this.scissor=ot,this.viewport=Ge,this.reset=Tr}};var fw=class extends rc{constructor(t,i,o,n,a,s,l,c,d,p){if(p=p!==void 0?p:Ch,p!==Ch&&p!==tm)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");o===void 0&&p===Ch&&(o=Zd),o===void 0&&p===tm&&(o=su);let g=new cu(t,i);super(g,n,a,s,l,c,p,o,d);this.isDepthTexture=!0;this.isDepthTexture=!0,this.image=g,this.magFilter=l!==void 0?l:nu,this.minFilter=c!==void 0?c:nu,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(t){return super.copy(t),this.compareFunction=t.compareFunction,this}};var HM=class{constructor(e,t,i,o,n,a,s){let l=n.maxTextures,c=n.maxTextureSize,d=n.maxSamples,p=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,g=typeof navigator=="undefined"?!1:/OculusBrowser/g.test(navigator.userAgent),h,f=new WeakMap,y=!1;try{y=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch(Z){}function x(Z,W){return y?new OffscreenCanvas(Z,W):mM("canvas")}function E(Z,W){let De=1;if((Z.width>W||Z.height>W)&&(De=W/Math.max(Z.width,Z.height)),De<1)if(typeof HTMLImageElement!="undefined"&&Z instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&Z instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&Z instanceof ImageBitmap){let Ne=Math.floor(De*Z.width),me=Math.floor(De*Z.height);h===void 0&&(h=x(Ne,me)),h.width=Ne,h.height=me;let ve=h.getContext("2d");if(Ut(ve,"2d context"),!(ve instanceof OffscreenCanvasRenderingContext2D||ve instanceof CanvasRenderingContext2D))throw new Error("Expected a 2d rendering context");return ve.drawImage(Z,0,0,Ne,me),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Z.width+"x"+Z.height+") to ("+Ne+"x"+me+")."),h}else return"data"in Z&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Z.width+"x"+Z.height+")."),Z;return Z}function C(Z){return cF(Z.width)&&cF(Z.height)}function S(Z){return Z.generateMipmaps&&Z.minFilter!==nu&&Z.minFilter!==au}function v(Z){e.generateMipmap(Z)}function M(Z,W,De,Ne,me=!1){if(Z!==null){if(e[Z]!==void 0)return e[Z];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Z+"'")}let ve=W;return W===e.RED&&(De===e.FLOAT&&(ve=e.R32F),De===e.HALF_FLOAT&&(ve=e.R16F),De===e.UNSIGNED_BYTE&&(ve=e.R8)),W===e.RED_INTEGER&&(De===e.UNSIGNED_BYTE&&(ve=e.R8UI),De===e.UNSIGNED_SHORT&&(ve=e.R16UI),De===e.UNSIGNED_INT&&(ve=e.R32UI),De===e.BYTE&&(ve=e.R8I),De===e.SHORT&&(ve=e.R16I),De===e.INT&&(ve=e.R32I)),W===e.RG&&(De===e.FLOAT&&(ve=e.RG32F),De===e.HALF_FLOAT&&(ve=e.RG16F),De===e.UNSIGNED_BYTE&&(ve=e.RG8)),W===e.RGBA&&(De===e.FLOAT&&(ve=e.RGBA32F),De===e.HALF_FLOAT&&(ve=e.RGBA16F),De===e.UNSIGNED_BYTE&&(ve=Ne===ko&&me===!1?e.SRGB8_ALPHA8:e.RGBA8),De===e.UNSIGNED_SHORT_4_4_4_4&&(ve=e.RGBA4),De===e.UNSIGNED_SHORT_5_5_5_1&&(ve=e.RGB5_A1)),(ve===e.R16F||ve===e.R32F||ve===e.RG16F||ve===e.RG32F||ve===e.RGBA16F||ve===e.RGBA32F)&&t.get("EXT_color_buffer_float"),ve}function A(Z,W){return S(Z)===!0?Math.log2(Math.max(W.width,W.height))+1:Z.mipmaps!==void 0&&Z.mipmaps.length>0?Z.mipmaps.length:1}function I(Z){let W=Z.target;W.removeEventListener("dispose",I),_(W)}function P(Z){let W=Z.target;W.removeEventListener("dispose",P),Y(W)}function _(Z){let W=o.get(Z);if(W.__webglInit===void 0)return;let De=Z.source,Ne=f.get(De);if(Ne){let me=Ne[W.__cacheKey];me.usedTimes--,me.usedTimes===0&&U(Z),Object.keys(Ne).length===0&&f.delete(De)}o.remove(Z)}function U(Z){let W=o.get(Z);e.deleteTexture(W.__webglTexture);let De=Z.source,Ne=f.get(De);Ut(Ne,"webglTextures"),delete Ne[W.__cacheKey],s.memory.textures--}function Y(Z){let W=Z.texture,De=o.get(Z),Ne=o.get(W);Ne.__webglTexture!==void 0&&(e.deleteTexture(Ne.__webglTexture),s.memory.textures--),Z.depthTexture&&Z.depthTexture.dispose();let me=De.__webglFramebuffer;if(Array.isArray(me))for(let ve=0;ve<me.length;ve++)e.deleteFramebuffer(me[ve]);else me&&e.deleteFramebuffer(me);if(De.__webglDepthbuffer&&e.deleteRenderbuffer(De.__webglDepthbuffer),De.__webglMultisampledFramebuffer&&e.deleteFramebuffer(De.__webglMultisampledFramebuffer),De.__webglColorRenderbuffer)for(let ve=0;ve<De.__webglColorRenderbuffer.length;ve++)De.__webglColorRenderbuffer[ve]&&e.deleteRenderbuffer(De.__webglColorRenderbuffer[ve]);De.__webglDepthRenderbuffer&&e.deleteRenderbuffer(De.__webglDepthRenderbuffer),o.remove(W),o.remove(Z)}let R=0;function H(){R=0}function O(){let Z=R;return Z>=l&&console.warn("THREE.WebGLTextures: Trying to use "+Z+" texture units while this GPU supports only "+l),R+=1,Z}function q(Z){let W=[];return W.push(Z.wrapS),W.push(Z.wrapT),W.push(Z.magFilter),W.push(Z.minFilter),W.push(Z.anisotropy),W.push(Z.internalFormat),W.push(Z.format),W.push(Z.type),W.push(Z.generateMipmaps),W.push(Z.premultiplyAlpha),W.push(Z.flipY),W.push(Z.unpackAlignment),W.push(Z.colorSpace),W.join()}function w(Z,W){let De=o.get(Z);if(Z.isRenderTargetTexture===!1&&Z.version>0&&De.__version!==Z.version)if(Z.image.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{pe(De,Z,W);return}i.bindTexture(e.TEXTURE_2D,De.__webglTexture,e.TEXTURE0+W)}let T={[BE]:e.REPEAT,[Xf]:e.CLAMP_TO_EDGE,[UE]:e.MIRRORED_REPEAT},B={[nu]:e.NEAREST,[u$]:e.NEAREST_MIPMAP_NEAREST,[PR]:e.NEAREST_MIPMAP_LINEAR,[au]:e.LINEAR,[h$]:e.LINEAR_MIPMAP_NEAREST,[zE]:e.LINEAR_MIPMAP_LINEAR},de={[E$]:e.NEVER,[I$]:e.ALWAYS,[S$]:e.LESS,[k$]:e.LEQUAL,[D$]:e.EQUAL,[M$]:e.GEQUAL,[G$]:e.GREATER,[T$]:e.NOTEQUAL};function F(Z,W){if(e.texParameteri(Z,e.TEXTURE_WRAP_S,T[W.wrapS]),e.texParameteri(Z,e.TEXTURE_WRAP_T,T[W.wrapT]),e.texParameteri(Z,e.TEXTURE_MAG_FILTER,B[W.magFilter]),e.texParameteri(Z,e.TEXTURE_MIN_FILTER,B[W.minFilter]),W.compareFunction&&(e.texParameteri(Z,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(Z,e.TEXTURE_COMPARE_FUNC,de[W.compareFunction])),t.has("EXT_texture_filter_anisotropic")===!0){let De=t.get("EXT_texture_filter_anisotropic");if(W.magFilter===nu||W.minFilter!==PR&&W.minFilter!==zE||W.type===rd&&t.has("OES_texture_float_linear")===!1)return;(W.anisotropy>1||o.get(W).__currentAnisotropy)&&(e.texParameterf(Z,De.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(W.anisotropy,n.getMaxAnisotropy())),o.get(W).__currentAnisotropy=W.anisotropy)}}function j(Z,W){let De=!1;Z.__webglInit===void 0&&(Z.__webglInit=!0,W.addEventListener("dispose",I));let Ne=W.source,me=f.get(Ne);me===void 0&&(me={},f.set(Ne,me));let ve=q(W);if(ve!==Z.__cacheKey){me[ve]===void 0&&(me[ve]={texture:e.createTexture()||void 0,usedTimes:0},s.memory.textures++,De=!0),me[ve].usedTimes++;let Pe=Z.__cacheKey?me[Z.__cacheKey]:void 0;Pe!==void 0&&(me[Z.__cacheKey].usedTimes--,Pe.usedTimes===0&&U(W)),Z.__cacheKey=ve,Z.__webglTexture=me[ve].texture}return De}function pe(Z,W,De){let Ne=e.TEXTURE_2D,me=j(Z,W),ve=W.source;i.bindTexture(Ne,Z.__webglTexture,e.TEXTURE0+De);let Pe=o.get(ve);if(ve.version!==Pe.__version||me===!0){i.activeTexture(e.TEXTURE0+De),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,W.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,W.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,W.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE);let He=E(W.image,c);He=et(W,He);let ot=C(He),Ge=a.convert(W.format,W.colorSpace),Et=a.convert(W.type),Oe=M(W.internalFormat,Ge,Et,W.colorSpace);F(Ne,W);let Tr,Q=W.mipmaps,ke=Pe.__version===void 0||me===!0,Ue=A(W,He);if(W instanceof fw)Oe=e.DEPTH_COMPONENT,W.type===rd?Oe=e.DEPTH_COMPONENT32F:W.type===Zd?Oe=e.DEPTH_COMPONENT24:W.type===su?Oe=e.DEPTH24_STENCIL8:Oe=e.DEPTH_COMPONENT16,W.format===Ch&&Oe===e.DEPTH_COMPONENT&&W.type!==tw&&W.type!==Zd&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),W.type=Zd,Et=a.convert(W.type)),W.format===tm&&Oe===e.DEPTH_COMPONENT&&(Oe=e.DEPTH_STENCIL,W.type!==su&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),W.type=su,Et=a.convert(W.type))),ke&&i.texStorage2D(e.TEXTURE_2D,1,Oe,He.width,He.height);else if(Q.length>0&&ot){ke&&i.texStorage2D(e.TEXTURE_2D,Ue,Oe,Q[0].width,Q[0].height);for(let xe=0,ct=Q.length;xe<ct;xe++)Tr=Q[xe],i.texSubImage2D(e.TEXTURE_2D,xe,0,0,Ge,Et,Tr);W.generateMipmaps=!1}else{if(ke&&i.texStorage2D(e.TEXTURE_2D,Ue,Oe,He.width,He.height),He instanceof cu)throw new Error("Texture does not have any image data to upload.");i.texSubImage2D(e.TEXTURE_2D,0,0,0,Ge,Et,He)}S(W)&&v(Ne),Pe.__version=ve.version,W.onUpdate&&W.onUpdate(W)}Z.__version=W.version}function le(Z,W,De,Ne,me,ve){if(!Z||Array.isArray(Z))throw new Error("THREE.WebGLTextures: expected non-array framebuffer");let Pe=a.convert(De.format,De.colorSpace),He=a.convert(De.type),ot=M(De.internalFormat,Pe,He,De.colorSpace);if(!o.get(W).__hasExternalTextures){let Et=Math.max(1,W.width>>ve),Oe=Math.max(1,W.height>>ve);i.texImage2D(me,ve,ot,Et,Oe,0,Pe,He,null)}if(i.bindFramebuffer(e.FRAMEBUFFER,Z),Se(W))p.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,Ne,me,o.get(De).__webglTexture,0,Le(W));else if(me===e.TEXTURE_2D||me>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&me<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z){let Et=o.get(De).__webglTexture;Ut(Et,"webglTexture"),e.framebufferTexture2D(e.FRAMEBUFFER,Ne,me,Et,ve)}i.bindFramebuffer(e.FRAMEBUFFER,null)}function ne(Z,W,De){if(e.bindRenderbuffer(e.RENDERBUFFER,Z||null),W.depthBuffer&&!W.stencilBuffer){let Ne=e.DEPTH_COMPONENT16;if(De||Se(W)){let me=W.depthTexture;me&&me.isDepthTexture&&(me.type===rd?Ne=e.DEPTH_COMPONENT32F:me.type===Zd&&(Ne=e.DEPTH_COMPONENT24));let ve=Le(W);Se(W)?p.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,ve,Ne,W.width,W.height):e.renderbufferStorageMultisample(e.RENDERBUFFER,ve,Ne,W.width,W.height)}else e.renderbufferStorage(e.RENDERBUFFER,Ne,W.width,W.height);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,Z||null)}else if(W.depthBuffer&&W.stencilBuffer){let Ne=Le(W);De&&Se(W)===!1?e.renderbufferStorageMultisample(e.RENDERBUFFER,Ne,e.DEPTH24_STENCIL8,W.width,W.height):Se(W)?p.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,Ne,e.DEPTH24_STENCIL8,W.width,W.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,W.width,W.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,Z||null)}else{let Ne=[W.texture];for(let me=0;me<Ne.length;me++){let ve=Ne[me],Pe=a.convert(ve.format,ve.colorSpace),He=a.convert(ve.type),ot=M(ve.internalFormat,Pe,He,ve.colorSpace),Ge=Le(W);De&&Se(W)===!1?e.renderbufferStorageMultisample(e.RENDERBUFFER,Ge,ot,W.width,W.height):Se(W)?p.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,Ge,ot,W.width,W.height):e.renderbufferStorage(e.RENDERBUFFER,ot,W.width,W.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function X(Z,W){if(i.bindFramebuffer(e.FRAMEBUFFER,Z),!(W.depthTexture&&W.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!o.get(W.depthTexture).__webglTexture||W.depthTexture.image.width!==W.width||W.depthTexture.image.height!==W.height)&&(W.depthTexture.image.width=W.width,W.depthTexture.image.height=W.height,W.depthTexture.needsUpdate=!0),w(W.depthTexture,0);let De=o.get(W.depthTexture).__webglTexture;Ut(De,"webglDepthTexture");let Ne=Le(W);if(W.depthTexture.format===Ch)Se(W)?p.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,De,0,Ne):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,De,0);else if(W.depthTexture.format===tm)Se(W)?p.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,De,0,Ne):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,De,0);else throw new Error("Unknown depthTexture format")}function ae(Z){let W=o.get(Z),De=EF(W);Z.depthTexture&&!W.__autoAllocateDepthBuffer?X(De,Z):(i.bindFramebuffer(e.FRAMEBUFFER,De),W.__webglDepthbuffer=e.createRenderbuffer()||void 0,ne(W.__webglDepthbuffer,Z,!1)),i.bindFramebuffer(e.FRAMEBUFFER,null)}function J(Z,W,De){let Ne=o.get(Z),me=EF(Ne);W!==void 0&&le(me,Z,Z.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),De!==void 0&&ae(Z)}function ge(Z){let W=Z.texture,De=o.get(Z),Ne=o.get(W);if(Z.addEventListener("dispose",P),Ne.__webglTexture===void 0&&(Ne.__webglTexture=e.createTexture()||void 0),Ne.__version=W.version,s.memory.textures++,W.mipmaps&&W.mipmaps.length>0){let ve=[];De.__webglFramebuffer=ve;for(let Pe=0;Pe<W.mipmaps.length;Pe++){let He=e.createFramebuffer();Ut(He,"framebuffer",e),ve[Pe]=He}}else{let ve=e.createFramebuffer();De.__webglFramebuffer=ve||void 0}if(Z.samples>0&&Se(Z)===!1){let ve=[W],Pe=e.createFramebuffer();Ut(Pe,"framebuffer",e),De.__webglMultisampledFramebuffer=Pe,De.__webglColorRenderbuffer=[],i.bindFramebuffer(e.FRAMEBUFFER,De.__webglMultisampledFramebuffer);for(let He=0;He<ve.length;He++){let ot=ve[He],Ge=e.createRenderbuffer();Ut(Ge,"renderbuffer",e),De.__webglColorRenderbuffer[He]=Ge,e.bindRenderbuffer(e.RENDERBUFFER,De.__webglColorRenderbuffer[He]);let Et=a.convert(ot.format,ot.colorSpace),Oe=a.convert(ot.type),Tr=M(ot.internalFormat,Et,Oe,ot.colorSpace,!1),Q=Le(Z);e.renderbufferStorageMultisample(e.RENDERBUFFER,Q,Tr,Z.width,Z.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+He,e.RENDERBUFFER,De.__webglColorRenderbuffer[He])}if(e.bindRenderbuffer(e.RENDERBUFFER,null),Z.depthBuffer){let He=e.createRenderbuffer();Ut(He,"renderbuffer",e),De.__webglDepthRenderbuffer=He,ne(De.__webglDepthRenderbuffer,Z,!0)}i.bindFramebuffer(e.FRAMEBUFFER,null)}let me=e.TEXTURE_2D;if(i.bindTexture(me,Ne.__webglTexture),F(me,W),W.mipmaps&&W.mipmaps.length>0){let ve=Mde(De);for(let Pe=0;Pe<W.mipmaps.length;Pe++)le(ve[Pe],Z,W,e.COLOR_ATTACHMENT0,me,Pe)}else le(De.__webglFramebuffer,Z,W,e.COLOR_ATTACHMENT0,me,0);S(W)&&v(me),i.unbindTexture(),Z.depthBuffer&&ae(Z)}function be(Z){let W=[Z.texture];for(let De=0,Ne=W.length;De<Ne;De++){let me=W[De];if(S(me)){let ve=e.TEXTURE_2D,Pe=o.get(me).__webglTexture;i.bindTexture(ve,Pe),v(ve),i.unbindTexture()}}}function Ee(Z){if(Z.samples>0&&Se(Z)===!1){let W=[Z.texture],De=Z.width,Ne=Z.height,me=e.COLOR_BUFFER_BIT,ve=[],Pe=Z.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,He=o.get(Z);Ut(He.__webglMultisampledFramebuffer,"__webglMultisampledFramebuffer"),i.bindFramebuffer(e.READ_FRAMEBUFFER,He.__webglMultisampledFramebuffer),i.bindFramebuffer(e.DRAW_FRAMEBUFFER,EF(He));for(let ot=0;ot<W.length;ot++){ve.push(e.COLOR_ATTACHMENT0+ot),Z.depthBuffer&&ve.push(Pe);let Ge=He.__ignoreDepthValues!==void 0?He.__ignoreDepthValues:!1;Ge===!1&&(Z.depthBuffer&&(me|=e.DEPTH_BUFFER_BIT),Z.stencilBuffer&&(me|=e.STENCIL_BUFFER_BIT)),Ge===!0&&(e.invalidateFramebuffer(e.READ_FRAMEBUFFER,[Pe]),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[Pe])),e.blitFramebuffer(0,0,De,Ne,0,0,De,Ne,me,e.NEAREST),g&&e.invalidateFramebuffer(e.READ_FRAMEBUFFER,ve)}i.bindFramebuffer(e.READ_FRAMEBUFFER,null),i.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(e.DRAW_FRAMEBUFFER,He.__webglMultisampledFramebuffer)}}function Le(Z){return Math.min(d,Z.samples)}function Se(Z){let W=o.get(Z);return Z.samples>0&&t.has("WEBGL_multisampled_render_to_texture")===!0&&W.__useRenderToTexture!==!1}function et(Z,W){let De=Z.colorSpace,Ne=Z.format,me=Z.type;return Z.format===cM||De!==Zl&&De!==iw&&(De===ko?(Ne!==lu||me!==Ha)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",De)),W}this.allocateTextureUnit=O,this.resetTextureUnits=H,this.setTexture2D=w,this.rebindTextures=J,this.setupRenderTarget=ge,this.updateRenderTargetMipmap=be,this.updateMultisampleRenderTarget=Ee,this.useMultisampledRTT=Se}};function EF(r){let e=r.__webglFramebuffer;if(!e||Array.isArray(e))throw new Error("THREE.WebGLTextures: expected non-array framebuffer");return e}function Mde(r){let e=r.__webglFramebuffer;if(!e||!Array.isArray(e))throw new Error("THREE.WebGLTextures: expected array framebuffer");return e}var WM=class{constructor(e,t){function i(o,n=iw){let a;if(o===Ha)return e.UNSIGNED_BYTE;if(o===Z1)return e.UNSIGNED_SHORT_4_4_4_4;if(o===eM)return e.UNSIGNED_SHORT_5_5_5_1;if(o===g$)return e.BYTE;if(o===m$)return e.SHORT;if(o===tw)return e.UNSIGNED_SHORT;if(o===Q1)return e.INT;if(o===Zd)return e.UNSIGNED_INT;if(o===rd)return e.FLOAT;if(o===rw)return e.HALF_FLOAT;if(o===f$)return e.ALPHA;if(o===lu)return e.RGBA;if(o===b$)return e.LUMINANCE;if(o===y$)return e.LUMINANCE_ALPHA;if(o===Ch)return e.DEPTH_COMPONENT;if(o===tm)return e.DEPTH_STENCIL;if(o===cM)return a=t.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(o===x$)return e.RED;if(o===tM)return e.RED_INTEGER;if(o===w$)return e.RG;if(o===rM)return e.RG_INTEGER;if(o===iM)return e.RGBA_INTEGER;if(o===oM||o===nM||o===aM||o===sM)if(n===ko)if(a=t.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(o===oM)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(o===nM)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(o===aM)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(o===sM)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=t.get("WEBGL_compressed_texture_s3tc"),a!==null){if(o===oM)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(o===nM)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(o===aM)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(o===sM)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(o===_R||o===OR||o===RR||o===FR)if(a=t.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(o===_R)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(o===OR)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(o===RR)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(o===FR)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(o===v$)return a=t.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(o===NR||o===BR)if(a=t.get("WEBGL_compressed_texture_etc"),a!==null){if(o===NR)return n===ko?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(o===BR)return n===ko?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(o===UR||o===zR||o===KR||o===qR||o===HR||o===WR||o===$R||o===jR||o===YR||o===XR||o===JR||o===QR||o===ZR||o===eF)if(a=t.get("WEBGL_compressed_texture_astc"),a!==null){if(o===UR)return n===ko?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(o===zR)return n===ko?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(o===KR)return n===ko?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(o===qR)return n===ko?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(o===HR)return n===ko?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(o===WR)return n===ko?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(o===$R)return n===ko?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(o===jR)return n===ko?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(o===YR)return n===ko?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(o===XR)return n===ko?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(o===JR)return n===ko?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(o===QR)return n===ko?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(o===ZR)return n===ko?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(o===eF)return n===ko?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(o===tF)if(a=t.get("EXT_texture_compression_bptc"),a!==null){if(o===tF)return n===ko?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(o===rF||o===iF||o===oF||o===nF)if(a=t.get("EXT_texture_compression_rgtc"),a!==null){if(o===rF)return a.COMPRESSED_RED_RGTC1_EXT;if(o===iF)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(o===oF)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(o===nF)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return o===su?e.UNSIGNED_INT_24_8:e[o]!==void 0?e[o]:null}this.convert=i}};var $M=class{constructor(e,t,i){let o={},n={},a=[],s=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);function l(C,S){let v=S.program;Ut(v,"webglProgram"),i.uniformBlockBinding(C,v)}function c(C,S){let v=o[C.id];v===void 0&&(f(C),v=d(C),o[C.id]=v,C.addEventListener("dispose",x));let M=S.program;Ut(M,"webglProgram"),i.updateUBOMapping(C,M);let A=t.render.frame;n[C.id]!==A&&(g(C),n[C.id]=A)}function d(C){let S=p();C.__bindingPointIndex=S;let v=e.createBuffer(),M=C.__size,A=C.usage;return e.bindBuffer(e.UNIFORM_BUFFER,v),e.bufferData(e.UNIFORM_BUFFER,M,A),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,S,v),v}function p(){for(let C=0;C<s;C++)if(a.indexOf(C)===-1)return a.push(C),C;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function g(C){let S=o[C.id],v=C.uniforms,M=C.__cache;if(S===void 0)throw new Error("THREE.WebGLUniformsGroups: buffer is undefined");e.bindBuffer(e.UNIFORM_BUFFER,S);for(let A=0,I=v.length;A<I;A++){let P=v[A];if(h(P,A,M)===!0){let _=P.__offset,U=Array.isArray(P.value)?P.value:[P.value],Y=0;for(let R=0;R<U.length;R++){let H=U[R],O=y(H);typeof H=="number"?(P.__data[0]=H,e.bufferSubData(e.UNIFORM_BUFFER,_+Y,P.__data)):H instanceof Go?(P.__data[0]=H.elements[0],P.__data[1]=H.elements[1],P.__data[2]=H.elements[2],P.__data[3]=H.elements[0],P.__data[4]=H.elements[3],P.__data[5]=H.elements[4],P.__data[6]=H.elements[5],P.__data[7]=H.elements[0],P.__data[8]=H.elements[6],P.__data[9]=H.elements[7],P.__data[10]=H.elements[8],P.__data[11]=H.elements[0]):(H.toArray(P.__data,Y),Y+=O.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,_,P.__data)}}e.bindBuffer(e.UNIFORM_BUFFER,null)}function h(C,S,v){let M=C.value;if(v[S]===void 0){if(typeof M=="number")v[S]=M;else{let A=Array.isArray(M)?M:[M],I=[];for(let P=0;P<A.length;P++){let _=A[P];I.push(typeof _=="number"?_:_.clone())}v[S]=I}return!0}else if(typeof M=="number"){if(v[S]!==M)return v[S]=M,!0}else{let A=v[S],I=Array.isArray(A)?A:[A],P=Array.isArray(M)?M:[M];for(let _=0;_<I.length;_++){let U=I[_];if(U.equals(P[_])===!1)return U.copy(P[_]),!0}}return!1}function f(C){let S=C.uniforms,v=0,M=16,A=0;for(let I=0,P=S.length;I<P;I++){let _=S[I],U={boundary:0,storage:0},Y=Array.isArray(_.value)?_.value:[_.value];for(let R=0,H=Y.length;R<H;R++){let O=Y[R],q=y(O);U.boundary+=q.boundary,U.storage+=q.storage}if(_.__data=new Float32Array(U.storage/Float32Array.BYTES_PER_ELEMENT),_.__offset=v,I>0){A=v%M;let R=M-A;A!==0&&R-U.boundary<0&&(v+=M-A,_.__offset=v)}v+=U.storage}A=v%M,A>0&&(v+=M-A),C.__size=v,C.__cache={}}function y(C){let S={boundary:0,storage:0};return typeof C=="number"?(S.boundary=4,S.storage=4):C instanceof Ht?(S.boundary=8,S.storage=8):C instanceof Ae||C instanceof er?(S.boundary=16,S.storage=12):C instanceof Ga?(S.boundary=16,S.storage=16):C instanceof Go?(S.boundary=48,S.storage=48):C instanceof rr?(S.boundary=64,S.storage=64):C instanceof rc?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",C),S}function x(C){let S=C.target;S.removeEventListener("dispose",x);let v=a.indexOf(S.__bindingPointIndex);a.splice(v,1);let M=o[S.id];M!==void 0&&e.deleteBuffer(M),delete o[S.id],delete n[S.id]}function E(){for(let C in o){let S=o[C];S!==void 0&&e.deleteBuffer(S)}a=[],o={},n={}}this.bind=l,this.update=c,this.dispose=E}};var Th=class extends Rn{constructor(){super();this.isScene=!0;this.isScene=!0,this.type="Scene",this.background=null,this.overrideMaterial=null}};function fj(r){return r instanceof Ga}function bj(r){return r.isLight}function Ide(r){return r.isScene}function jM(r){return r.isMesh}function SF(r){return r.isLine}function Ade(r){return r.isLineSegments}function Vde(){let r=mM("canvas");return r.style.display="block",r}var bw=class{constructor(e={}){let{canvas:t=Vde(),context:i=null,depth:o=!0,stencil:n=!0,alpha:a=!1,antialias:s=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:d="default",failIfMajorPerformanceCaveat:p=!1}=e;this.isWebGLRenderer=!0;let g;i!==null?g=i.getContextAttributes().alpha:g=a;let h=new Uint32Array(4),f=new Int32Array(4),y=null,x=null,E=[],C=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.outputColorSpace=ko;let S=this,v=!1,M=0,A=0,I=null,P=-1,_=null,U=new Ga,Y=new Ga,R=null,H=t.width,O=t.height,q=1,w=null,T=null,B=new Ga(0,0,H,O),de=new Ga(0,0,H,O),F=!1,j=new vM,pe=new rr,le=new Ae,ne=new Th;function X(){return I===null?q:1}let ae={alpha:!0,depth:o,stencil:n,antialias:s,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:d,failIfMajorPerformanceCaveat:p};"setAttribute"in t&&t.setAttribute("data-engine",`three.js r${H9}`),t.addEventListener("webglcontextlost",Q,!1),t.addEventListener("webglcontextrestored",ke,!1),t.addEventListener("webglcontextcreationerror",Ue,!1);let J=(()=>{let he=i||t.getContext("webgl2",ae);if(he===null)throw new Error("THREE.WebGLRenderer: Error creating WebGL context with your selected attributes.");return he})(),ge,be,Ee,Le,Se,et,Z,W,De,Ne,me,ve,Pe,He,ot,Ge,Et,Oe;function Tr(){Ut(J,"gl context"),ge=new MM(J),be=new TM(J,ge,e),ge.init(),Ge=new WM(J,ge),Ee=new qM(J),Le=new VM(J),Se=new FM,et=new HM(J,ge,Ee,Se,be,Ge,Le),Z=new EM(J),Et=new kM(J,Z),W=new IM(J,Z,Le,Et),De=new LM(J,W,Z,Le),Ne=new RM(S,be,Et),me=new BM,ve=new KM,Pe=new DM(S,Ee,De,g,l),Oe=new $M(J,Le,Ee),He=new GM(J,Le),ot=new AM(J,Le),Le.programs=Ne.programs,S.capabilities=be,S.extensions=ge,S.properties=Se,S.renderLists=me,S.state=Ee,S.info=Le}Tr(),this.getContext=function(){return J},this.getContextAttributes=function(){return J.getContextAttributes()},this.forceContextLoss=function(){let he=ge.get("WEBGL_lose_context");he&&he.loseContext()},this.forceContextRestore=function(){let he=ge.get("WEBGL_lose_context");he&&he.restoreContext()},this.getPixelRatio=function(){return q},this.setPixelRatio=function(he){he!==void 0&&(q=he,this.setSize(H,O,!1))},this.getSize=function(he){return he.set(H,O)},this.setSize=function(he,Qe,We=!0){H=he,O=Qe,t.width=Math.floor(he*q),t.height=Math.floor(Qe*q),We===!0&&(t.style.width=he+"px",t.style.height=Qe+"px"),this.setViewport(0,0,he,Qe)},this.getDrawingBufferSize=function(he){return he.set(H*q,O*q).floor()},this.setDrawingBufferSize=function(he,Qe,We){H=he,O=Qe,q=We,t.width=Math.floor(he*We),t.height=Math.floor(Qe*We),this.setViewport(0,0,he,Qe)},this.getCurrentViewport=function(he){return he.copy(U)},this.getViewport=function(he){return he.copy(B)},this.setViewport=function(he,Qe,We,nt){fj(he)?B.set(he.x,he.y,he.z,he.w):B.set(he,Qe,We,nt),Ee.viewport(U.copy(B).multiplyScalar(q).floor())},this.getScissor=function(he){return he.copy(de)},this.setScissor=function(he,Qe,We,nt){fj(he)?de.set(he.x,he.y,he.z,he.w):de.set(he,Qe,We,nt),Ee.scissor(Y.copy(de).multiplyScalar(q).floor())},this.getScissorTest=function(){return F},this.setScissorTest=function(he){Ee.setScissorTest(F=he)},this.setOpaqueSort=function(he){w=he},this.setTransparentSort=function(he){T=he},this.getClearColor=function(he){return he.copy(Pe.getClearColor())},this.setClearColor=function(...he){Pe.setClearColor.apply(Pe,he)},this.getClearAlpha=function(){return Pe.getClearAlpha()},this.setClearAlpha=function(...he){Pe.setClearAlpha.apply(Pe,he)},this.clear=function(he=!0,Qe=!0,We=!0){let nt=0;if(he){let St=!1;if(I!==null){let vt=I.texture.format;St=vt===iM||vt===rM||vt===tM}if(St){Ut(I,"render target");let vt=I.texture.type,Lt=vt===Ha||vt===Zd||vt===tw||vt===su||vt===Z1||vt===eM,Rt=Pe.getClearColor(),or=Pe.getClearAlpha(),zt=Rt.r,Sr=Rt.g,Dr=Rt.b;Lt?(h[0]=zt,h[1]=Sr,h[2]=Dr,h[3]=or,J.clearBufferuiv(J.COLOR,0,h)):(f[0]=zt,f[1]=Sr,f[2]=Dr,f[3]=or,J.clearBufferiv(J.COLOR,0,f))}else nt|=J.COLOR_BUFFER_BIT}Qe&&(nt|=J.DEPTH_BUFFER_BIT),We&&(nt|=J.STENCIL_BUFFER_BIT),J.clear(nt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Q,!1),t.removeEventListener("webglcontextrestored",ke,!1),t.removeEventListener("webglcontextcreationerror",Ue,!1),me.dispose(),ve.dispose(),Se.dispose(),De.dispose(),Et.dispose(),Oe.dispose(),Ne.dispose()};function Q(he){he.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),v=!0}function ke(){console.log("THREE.WebGLRenderer: Context Restored."),v=!1;let he=Le.autoReset;Tr(),Le.autoReset=he}function Ue(he){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",he.statusMessage)}function xe(he){let Qe=he.target;Qe.removeEventListener("dispose",xe),ct(Qe)}function ct(he){it(he),Se.remove(he)}function it(he){let Qe=Se.get(he).programs;Qe!==void 0&&(Qe.forEach(function(We){Ne.releaseProgram(We)}),Ne.releaseShaderCache(he))}this.renderBufferDirect=function(he,Qe,We,nt,St,vt){Qe===null&&(Qe=ne);let Lt=!!jM(St)&&St.matrixWorld.determinant()<0,Rt=Uo(he,Qe,nt,St);Ee.setMaterial(nt,Lt);let or=We.index,zt=1;if(nt.wireframe===!0){if(or=W.getWireframeAttribute(We),or===void 0)return;zt=2}let Sr=We.attributes.position,Dr=0,ki=1/0*zt;vt!==null&&(Dr=Math.max(Dr,vt.start*zt),ki=Math.min(ki,(vt.start+vt.count)*zt)),or!==null?(Dr=Math.max(Dr,0),ki=Math.min(ki,or.count)):Sr!=null&&(Dr=Math.max(Dr,0),ki=Math.min(ki,Sr.count));let Hn=ki-Dr;if(Hn<0||Hn===1/0)return;Ut(Rt,"program"),Et.setup(St,nt,Rt,We,or);let Mn,qi=He;if(or!==null&&(Mn=Z.get(or),qi=ot,Ut(Mn,"attribute"),ot.setIndex(Mn)),jM(St)?nt.wireframe===!0?(Ee.setLineWidth(X()),qi.setMode(J.LINES)):qi.setMode(J.TRIANGLES):SF(St)&&(Ee.setLineWidth(X()),Ade(St)?qi.setMode(J.LINES):qi.setMode(J.LINE_STRIP)),St instanceof Nn)qi.renderInstances(Dr,Hn,St.count);else if(We instanceof gw){let io=We._maxInstanceCount!==void 0?We._maxInstanceCount:1/0,pn=Math.min(We.instanceCount,io);qi.renderInstances(Dr,Hn,pn)}else qi.render(Dr,Hn)},this.compile=function(he,Qe){function We(nt,St,vt){nt.transparent===!0&&nt.side===Ls&&nt.forceSinglePass===!1?(nt.side=Yf,nt.needsUpdate=!0,Br(nt,St,vt),nt.side=RE,nt.needsUpdate=!0,Br(nt,St,vt),nt.side=Ls):Br(nt,St,vt)}x=ve.get(he),x.init(),C.push(x),he.traverseVisible(function(nt){Ut(x,"render state"),bj(nt)&&nt.layers.test(Qe.layers)&&x.pushLight(nt)}),x.setupLights(),he.traverse(function(nt){let St=nt.material;if(St){if(!jM(nt)&&!SF(nt))throw new Error(`THREE.WebGLRenderer: Object of type ${nt.type} has material but no geometry.`);if(Array.isArray(St))for(let vt=0;vt<St.length;vt++){let Lt=St[vt];We(Lt,he,nt)}else We(St,he,nt)}}),C.pop(),x=null},this.render=function(he,Qe){if(Qe!==void 0&&Qe.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}v!==!0&&(he.matrixWorldAutoUpdate===!0&&he.updateMatrixWorld(),Qe.parent===null&&Qe.matrixWorldAutoUpdate===!0&&Qe.updateMatrixWorld(),x=ve.get(he,C.length),x.init(),C.push(x),pe.multiplyMatrices(Qe.projectionMatrix,Qe.matrixWorldInverse),j.setFromProjectionMatrix(pe),y=me.get(he,E.length),y.init(),E.push(y),li(he,Qe,0,S.sortObjects),y.finish(),S.sortObjects===!0&&y.sort(w,T),this.info.render.frame++,this.info.autoReset===!0&&this.info.reset(),Pe.render(y,he),x.setupLights(),Mt(y,he,Qe),I!==null&&(et.updateMultisampleRenderTarget(I),et.updateRenderTargetMipmap(I)),Et.resetDefaultState(),P=-1,_=null,C.pop(),C.length>0?x=C[C.length-1]:x=null,E.pop(),E.length>0?y=E[E.length-1]:y=null)};function li(he,Qe,We,nt){if(he.visible===!1)return;if(he.layers.test(Qe.layers)){if(Ut(x,"render state"),he.isGroup)We=he.renderOrder;else if(bj(he))x.pushLight(he);else if((jM(he)||SF(he))&&(Ut(y,"render list"),!he.frustumCulled||j.intersectsObject(he))){let Lt=De.update(he),Rt=he.material;if(Ut(Rt,"material"),nt&&(Lt.boundingSphere===null&&Lt.computeBoundingSphere(),le.copy(Lt.boundingSphere.center),le.applyMatrix4(he.matrixWorld).applyMatrix4(pe)),Array.isArray(Rt)){let or=Lt.groups;for(let zt=0,Sr=or.length;zt<Sr;zt++){let Dr=or[zt],ki=Dr.materialIndex&&Rt[Dr.materialIndex];ki&&ki.visible&&y.push(he,Lt,ki,We,le.z,Dr)}}else Rt.visible&&y.push(he,Lt,Rt,We,le.z,null)}}let vt=he.children;for(let Lt=0,Rt=vt.length;Lt<Rt;Lt++)li(vt[Lt],Qe,We,nt)}function Mt(he,Qe,We,nt){let St=he.opaque,vt=he.transparent;Ut(x,"render state"),x.setupLightsView(We),nt&&Ee.viewport(U.copy(nt)),St.length>0&&Bo(St,Qe,We),vt.length>0&&Bo(vt,Qe,We),Ee.buffers.depth.setTest(!0),Ee.buffers.depth.setMask(!0),Ee.buffers.color.setMask(!0),Ee.setPolygonOffset(!1)}function Bo(he,Qe,We){let nt=Ide(Qe)?Qe.overrideMaterial:null;for(let St=0,vt=he.length;St<vt;St++){let Lt=he[St],Rt=Lt.object,or=Lt.geometry,zt=nt===null?Lt.material:nt,Sr=Lt.group;Rt.layers.test(We.layers)&&Di(Rt,Qe,We,or,zt,Sr)}}function Di(he,Qe,We,nt,St,vt){he.modelViewMatrix.multiplyMatrices(We.matrixWorldInverse,he.matrixWorld),he.normalMatrix.getNormalMatrix(he.modelViewMatrix),St.transparent===!0&&St.side===Ls&&St.forceSinglePass===!1?(St.side=Yf,St.needsUpdate=!0,S.renderBufferDirect(We,Qe,nt,St,he,vt),St.side=RE,St.needsUpdate=!0,S.renderBufferDirect(We,Qe,nt,St,he,vt),St.side=Ls):S.renderBufferDirect(We,Qe,nt,St,he,vt)}function Br(he,Qe,We){Qe.isScene!==!0&&(Qe=ne);let nt=Se.get(he);Ut(x,"render state");let St=x.state.lights,vt=St.state.version,Lt=Ne.getParameters(he,St.state,Qe,We),Rt=Ne.getProgramCacheKey(Lt),or=nt.programs;or===void 0&&(he.addEventListener("dispose",xe),or=new Map,nt.programs=or);let zt=or.get(Rt);if(zt!==void 0){if(nt.currentProgram===zt&&nt.lightsStateVersion===vt)return ni(he,Lt),zt}else Lt.uniforms=Ne.getUniforms(he),zt=Ne.acquireProgram(Lt,Rt),or.set(Rt,zt),nt.uniforms=Lt.uniforms;let Sr=nt.uniforms;Ut(Sr,"uniforms"),ni(he,Lt),nt.needsLights=Xt(he),nt.lightsStateVersion=vt,nt.needsLights&&(Sr.ambientLightColor.value=St.state.ambient,Sr.directionalLights.value=St.state.directional);let Dr=zt.getUniforms(),ki=hm.seqWithValue(Dr.seq,Sr);return nt.currentProgram=zt,nt.uniformsList=ki,zt}function ni(he,Qe){let We=Se.get(he);We.outputColorSpace=Qe.outputColorSpace,We.instancing=Qe.instancing,We.instancingColor=Qe.instancingColor,We.instancingPickingColor=Qe.instancingPickingColor}function Uo(he,Qe,We,nt){Qe.isScene!==!0&&(Qe=ne),et.resetTextureUnits();let St=I===null?S.outputColorSpace:Zl,vt=Se.get(We);Ut(x,"render state");let Lt=x.state.lights,Rt=!1;We.version===vt.__version?(vt.needsLights&&vt.lightsStateVersion!==Lt.state.version||vt.outputColorSpace!==St||nt instanceof Nn!=!!vt.instancing)&&(Rt=!0):(Rt=!0,vt.__version=We.version);let or=vt.currentProgram;Rt===!0&&(or=Br(We,Qe,nt));let zt=!1,Sr=!1,Dr=!1;Ut(or,"program");let ki=or.getUniforms(),Hn=vt.uniforms;if(Ee.useProgram(or.program)&&(zt=!0,Sr=!0,Dr=!0),We.id!==P&&(P=We.id,Sr=!0),zt||_!==he){ki.setValue(J,"projectionMatrix",he.projectionMatrix,et),_!==he&&(_=he,Sr=!0,Dr=!0);let qi=ki.map.cameraPosition;qi!==void 0&&qi.setValue(J,le.setFromMatrixPosition(he.matrixWorld),et),ki.setValue(J,"isOrthographic",he instanceof Sh,et),ki.setValue(J,"viewMatrix",he.matrixWorldInverse,et)}Sr&&(vt.needsLights&&(Ut(Hn,"m_uniforms"),al(Hn,Dr)),We.uniformsNeedUpdate=!1,Ut(vt.uniformsList,"uniformsList"),Ut(Hn,"m_uniforms"),hm.upload(J,vt.uniformsList,Hn,et)),We.uniformsNeedUpdate===!0&&(Ut(vt.uniformsList,"uniformsList"),Ut(Hn,"m_uniforms"),hm.upload(J,vt.uniformsList,Hn,et),We.uniformsNeedUpdate=!1),ki.setValue(J,"dcgModelMatrix",nt.dcgModelMatrix,et),ki.setValue(J,"modelViewMatrix",nt.modelViewMatrix,et),ki.setValue(J,"pickingColor",nt.pickingColor||[0,0,0,0],et),ki.setValue(J,"normalMatrix",nt.normalMatrix,et);let Mn=We.uniformsGroups;for(let qi=0,io=Mn.length;qi<io;qi++){let pn=Mn[qi];Oe.update(pn,or),Oe.bind(pn,or)}return or}function al(he,Qe){he.ambientLightColor.needsUpdate=Qe,he.directionalLights.needsUpdate=Qe}function Xt(he){return he.lights===!0}this.getActiveCubeFace=function(){return M},this.getActiveMipmapLevel=function(){return A},this.getRenderTarget=function(){return I},this.setRenderTarget=function(he,Qe=0,We=0){I=he,M=Qe,A=We;let nt=!0,St=null;if(he){let Lt=Se.get(he);Lt.__useDefaultFramebuffer!==void 0?(Ee.bindFramebuffer(J.FRAMEBUFFER,null),nt=!1):Lt.__webglFramebuffer===void 0?et.setupRenderTarget(he):Lt.__hasExternalTextures&&he.depthTexture&&et.rebindTextures(he,Se.get(he.texture).__webglTexture,Se.get(he.depthTexture).__webglTexture);let Rt=Se.get(he).__webglFramebuffer;he.samples>0&&et.useMultisampledRTT(he)===!1?St=Se.get(he).__webglMultisampledFramebuffer:Array.isArray(Rt)?St=Rt[We]:St=Rt,U.copy(he.viewport),Y.copy(he.scissor),R=he.scissorTest}else U.copy(B).multiplyScalar(q).floor(),Y.copy(de).multiplyScalar(q).floor(),R=F;Ee.bindFramebuffer(J.FRAMEBUFFER,St)&&be.drawBuffers&&nt&&Ee.drawBuffers(he,St),Ee.viewport(U),Ee.scissor(Y),Ee.setScissorTest(R),P=-1},this.readRenderTargetPixels=function(he,Qe,We,nt,St,vt,Lt){if(!(he&&he.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Rt=Se.get(he).__webglFramebuffer;if(Rt){Ee.bindFramebuffer(J.FRAMEBUFFER,Rt);try{let or=he.texture,zt=or.format,Sr=or.type;if(zt!==lu&&Ge.convert(zt)!==J.getParameter(J.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let Dr=Sr===rw&&(ge.has("EXT_color_buffer_half_float")||ge.has("EXT_color_buffer_float"));if(Sr!==Ha&&Ge.convert(Sr)!==J.getParameter(J.IMPLEMENTATION_COLOR_READ_TYPE)&&Sr!==rd&&!Dr){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Qe>=0&&Qe<=he.width-nt&&We>=0&&We<=he.height-St&&J.readPixels(Qe,We,nt,St,Ge.convert(zt),Ge.convert(Sr),vt)}finally{let or=I!==null?Se.get(I).__webglFramebuffer:null;Ee.bindFramebuffer(J.FRAMEBUFFER,or||null)}}},this.copyFramebufferToTexture=function(he,Qe,We=0){let nt=Math.pow(2,-We),St=Math.floor(Qe.image.width*nt),vt=Math.floor(Qe.image.height*nt);et.setTexture2D(Qe,0),J.copyTexSubImage2D(J.TEXTURE_2D,We,0,0,he.x,he.y,St,vt),Ee.unbindTexture()},this.copyTextureToTexture=function(he,Qe,We,nt=0){let St=Ge.convert(We.format),vt=Ge.convert(We.type);et.setTexture2D(We,0),J.pixelStorei(J.UNPACK_FLIP_Y_WEBGL,We.flipY),J.pixelStorei(J.UNPACK_PREMULTIPLY_ALPHA_WEBGL,We.premultiplyAlpha),J.pixelStorei(J.UNPACK_ALIGNMENT,We.unpackAlignment),J.texSubImage2D(J.TEXTURE_2D,nt,he.x,he.y,St,vt,Qe.image),nt===0&&We.generateMipmaps&&J.generateMipmap(J.TEXTURE_2D),Ee.unbindTexture()},this.initTexture=function(he){et.setTexture2D(he,0),Ee.unbindTexture()},this.resetState=function(){M=0,A=0,I=null,Ee.reset(),Et.reset()}}get coordinateSystem(){return id}};var DF={common:{diffuse:{value:new er(16777215)},opacity:{value:1},map:{value:null},alphaTest:{value:0}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}}}};var YM=class extends rc{constructor(t,i,o,n,a,s,l,c,d){super(t,i,o,n,a,s,l,c,d);this.isCanvasTexture=!0;this.needsUpdate=!0}};var YE=class{constructor(e){this.data=e}generateShapes(e,t=100){let i=[],o=Lde(e,t,this.data);for(let n=0,a=o.length;n<a;n++)i.push(...o[n].toShapes());return i}};function Lde(r,e,t){let i=Array.from(r),o=e/t.resolution,n=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*o,a=[],s=0,l=0;for(let c=0;c<i.length;c++){let d=i[c];if(d===`
`)s=0,l-=n;else{let p=Pde(d,o,s,l,t);s+=p.offsetX,a.push(p.path)}}return a}function Pde(r,e,t,i,o){let n=o.glyphs[r]||o.glyphs["?"];if(!n)throw new Error('THREE.Font: character "'+r+'" does not exists in font family '+o.familyName+".");let a=new yM,s,l,c,d,p,g;if(n.o){let h=n._cachedOutline||(n._cachedOutline=n.o.split(" "));for(let f=0,y=h.length;f<y;){let x=h[f++];switch(x){case"m":s=h[f++]*e+t,l=h[f++]*e+i,a.moveTo(s,l);break;case"l":s=h[f++]*e+t,l=h[f++]*e+i,a.lineTo(s,l);break;case"q":c=h[f++]*e+t,d=h[f++]*e+i,p=h[f++]*e+t,g=h[f++]*e+i,a.quadraticCurveTo(p,g,c,d);break;default:if(x)throw new Error("unrecognized action: "+x)}}}return{offsetX:n.ha*e,path:a}}var XE=class extends wM{constructor(e,t){let o=t.font.generateShapes(e,t.size),n={...t,depth:t.height!==void 0?t.height:50};n.bevelThickness===void 0&&(n.bevelThickness=10),n.bevelSize===void 0&&(n.bevelSize=8),n.bevelEnabled===void 0&&(n.bevelEnabled=!1),super(o,n)}};var yj=`// License: MIT License (c) 2014 Mikola Lysenko
// https://github.com/mikolalysenko/glsl-read-float/blob/master/index.glsl

#define FLOAT_MAX  1.70141184e38
#define FLOAT_MIN  1.17549435e-38

lowp vec4 encode_float(highp float v) {
  highp float av = abs(v);

  //Handle special cases
  if(av < FLOAT_MIN) {
    return vec4(0.0, 0.0, 0.0, 0.0);
  } else if(v > FLOAT_MAX) {
    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;
  } else if(v < -FLOAT_MAX) {
    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;
  }

  highp vec4 c = vec4(0,0,0,0);

  //Compute exponent and mantissa
  highp float e = floor(log2(av));
  highp float m = av * pow(2.0, -e) - 1.0;

  //Unpack mantissa
  c[1] = floor(128.0 * m);
  m -= c[1] / 128.0;
  c[2] = floor(32768.0 * m);
  m -= c[2] / 32768.0;
  c[3] = floor(8388608.0 * m);

  //Unpack exponent
  highp float ebias = e + 127.0;
  c[0] = floor(ebias / 2.0);
  ebias -= c[0] * 2.0;
  c[1] += floor(ebias) * 128.0;

  //Unpack sign bit
  c[0] += 128.0 * step(0.0, -v);

  //Scale back to range
  return c / 255.0;
}
`;var yw=`
uniform int uDepthPeel; // 1 or 0
uniform vec2 uScreenSize;
uniform sampler2D uPrevDepthTexture;
uniform int uDepthPeelLayer;
uniform float uDepthOffset;
`,xw=`
  if(uDepthPeel != 0 && uDepthPeelLayer != 0){
      vec2 screenPos = gl_FragCoord.xy * uScreenSize;
      vec4 texel = texture2D(uPrevDepthTexture,screenPos);
      float prevDepth = texel.x;
      if(prevDepth + uDepthOffset - gl_FragCoord.z >= 0. ){
        discard;
      }
  }
`;var El={Default:0,PickingObjectId:1,PickingX:2,PickingY:3,PickingZ:4,Depth:5};function XM(){return{zMinForAnimation:{value:-1/0},zMaxForAnimation:{value:1/0},uvMin:{value:new Ht},uvWidth:{value:new Ht},clip_x:{value:!0},clip_y:{value:!0},clip_z:{value:!0},NaN:{value:NaN},Infinity:{value:1/0}}}var kF=`
#ifdef DCG_SUPPORTS_PICKING
  uniform vec4 pickingColor;
  ${yj}
#endif
`,JM=`#ifdef DCG_SUPPORTS_PICKING
if (dcgRenderMode == ${El.PickingObjectId}) {
  #if defined(USE_INSTANCING_PICKINGCOLOR) || defined(USE_VERTEX_PICKING_COLOR)
  gl_FragColor = vPickingColor;
  #else
  gl_FragColor = pickingColor;
  #endif
  return;
} else if (dcgRenderMode == ${El.PickingX}) {
  gl_FragColor = encode_float(vPosition.x);
  return;
} else if (dcgRenderMode == ${El.PickingY}) {
  gl_FragColor = encode_float(vPosition.y);
  return;
} else if (dcgRenderMode == ${El.PickingZ}) {
  gl_FragColor = encode_float(vPosition.z);
  return;
}
#endif
`,Ode=`  varying vec3 vPosition;
  uniform bool clip_x;
  uniform bool clip_y;
  uniform bool clip_z;
  uniform float xMin;
  uniform float xMax;
  uniform float yMin;
  uniform float yMax;
  uniform float zMin;
  uniform float zMax;
  uniform float zMinForAnimation;
  uniform float zMaxForAnimation;
  uniform vec2 uvMin;
  uniform vec2 uvWidth;
  uniform int dcgRenderMode;

  ${kF}
`,Rde=`  if (clip_x && (vPosition.x < xMin || vPosition.x > xMax)) {discard;}
  if (clip_y && (vPosition.y < yMin || vPosition.y > yMax)) {discard;}
  if (clip_z && (vPosition.z < zMin || vPosition.z > zMax)) {discard;}
  if ((vPosition.z < zMinForAnimation) || (vPosition.z > zMaxForAnimation)) {discard;}
`,gm=`  gl_FragColor = LinearTosRGB( gl_FragColor );
`;function QM({variant:r,uvArgs:e,extraMeshArgs:t,restrictionShader:i}){let o;r.type==="colorFunc"?o=`      vec3 color = getColor();
      if (isnan(color.x) || isnan(color.y) || isnan(color.z)) {discard;}
      vec4 diffuseColor = vec4(color.x, color.y, color.z, opacity );`:o="vec4 diffuseColor = vec4( diffuse, opacity );";let n=r.type==="colorFunc"?__dcg_shared_module_exports__['qc']`vec3 getColor() {
            ${xj(e,r.colorShader.source)}
            ${wj(t,r.colorShader.source)}
            ${r.colorShader.source}
            }\n`:"",a=[i].concat(r.type==="colorFunc"?[r.colorShader]:[]),s=__dcg_shared_module_exports__['rc'](...a.map(M=>M==null?void 0:M.shaderFunctions))+`
`+n+Fde(i,xj(e,i==null?void 0:i.source),t),l=Nde(i)+xw+o,c=/\bvUV\b/.test(s)||/\bvUV\b/.test(l),d=[void 0,"float","vec2","vec3"][t.length],p=d&&(/\bvExtras\b/.test(s)||/\bvExtras\b/.test(l)),g=__dcg_shared_module_exports__['sc'](i==null?void 0:i.shaderUniforms),h=g.uniforms,f=g.declarations,y=`    ${__dcg_shared_module_exports__['pc']}
    ${f}
    ${c?`varying vec2 vUV;
`:""}
    ${p?`varying ${d} vExtras;
`:""}
    ${yw}
    ${s}
`,x=(c?`varying vec2 vUV;
`:"")+(p?`attribute ${d} extras;
`:"")+(p?`varying ${d} vExtras;
`:"")+`varying vec3 vPosition;
uniform mat4 dcgModelMatrix;
`,E=`    ${p?"  vExtras = extras; ":""}
    ${c?"  vUV = uv; ":""}
    #ifdef USE_INSTANCING
      vPosition = (instanceMatrix * vec4( position, 1.0 )).xyz;
    #else
      vPosition = (dcgModelMatrix * vec4( position, 1.0 )).xyz;
    #endif
  `,C=r.type==="colorFunc"?"color::"+r.colorCacheKey+"::"+e.join(","):r.type,S=i?"::"+i.source:"",v=C+S;return{fragmentDeclarations:Ode+y,fragmentColorChunk:Rde+l,vertexDeclarations:x,vertexPositionChunk:E,cacheKey:v,glslUniforms:h}}function xj(r,e){let t=c=>c==="x"||c==="y"||c==="z",i=r[0],o=r[1],n=new RegExp(`\\b${i}\\b`),a=new RegExp(`\\b${o}\\b`),s=i!==void 0&&!t(i)&&e&&n.test(e),l=o!==void 0&&!t(o)&&e&&a.test(e);return(s?[`float ${i} = vUV.x;`]:[]).concat(l?[`float ${o} = vUV.y;`]:[]).join(`
`)}function wj(r,e){let t=i=>new RegExp(`\\b${i}\\b`).test(e);return["float x = vPosition.x;","float y = vPosition.y;","float z = vPosition.z;"].concat(r.length===1?t(r[0])?`float ${r[0]} = vExtras;`:"":r.map((i,o)=>t(i)?`float ${i} = vExtras.${"xyz"[o]};`:"")).join(`
`)}function Fde(r,e,t){return r?__dcg_shared_module_exports__['qc']`bool restriction() {
      ${e}
      ${wj(t,r.source)}
      ${r.source}
      }\n`:""}function Nde(r){return r?"if (!restriction()) {discard;}":""}var JE=class extends ic{constructor(e,t){let i=new YM(e.canvas);super({name:"DomainPlaneNumbersMaterial",side:Ls,transparent:e.transparent,vertexShader:`
        varying vec2 vUv;

        void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
      `,fragmentShader:`

        uniform sampler2D map;
        uniform float opacity;
        varying vec2 vUv;
        uniform int dcgRenderMode;

        ${yw}

        uniform float alphaTest;

        void main() {
          ${xw}

          vec4 sampleColor = texture2D( map, vUv );

          // When we're only showing numbers, we clear the canvas with a low alpha and discard it here.
          if ( sampleColor.a < alphaTest ) {
            discard;
          }

          #ifdef OPAQUE
          if (uDepthPeel == 0) {
            sampleColor.a = 1.0;
          }
          #endif

          gl_FragColor = sampleColor;

          ${gm}
        }
      `,uniforms:{map:{value:i},alphaTest:{value:.1},...t}}),this.canvas=e.canvas,this.texture=i}dispose(){super.dispose(),this.texture.dispose()}};var QE=class extends ic{constructor(e,t){super({name:"DomainPlaneMaterial",side:Ls,transparent:e.transparent,vertexShader:`
        varying vec3 vPosition;
        void main() {
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
          vPosition = position;
        }
      `,fragmentShader:`

        uniform vec3 diffuse;
        uniform float opacity;
        varying vec3 vPosition;
        uniform int dcgRenderMode;

        ${yw}
        ${kF}

        void main() {
          ${xw}
          ${JM}

          gl_FragColor = vec4(diffuse, opacity);

          ${gm}
        }
      `,defines:{DCG_SUPPORTS_PICKING:!0},uniforms:{opacity:{value:e.opacity},diffuse:{value:e.color},...t}})}};var vj=pr("disableLighting");function Cj(r){let{cacheKey:e,vertexPositionChunk:t,vertexDeclarations:i,fragmentColorChunk:o,fragmentDeclarations:n,glslUniforms:a}=QM(r),s=`
varying vec3 vViewPosition;
varying vec3 vNormal;

${Ta.common}
${Ta.common_pars_vertex}

${i}

void main() {

	${Ta.common_vertex}

	vViewPosition = - mvPosition.xyz;
	vec3 transformedNormal = vec3( normal );

	#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	#else
	mat3 m = mat3( dcgModelMatrix );
	#endif
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;

	transformedNormal = normalMatrix * transformedNormal;

	#ifdef FLIP_SIDED
		transformedNormal = - transformedNormal;
	#endif
	vNormal = normalize( transformedNormal );

  ${t}
}
`,l=`
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
varying vec3 vNormal;

#ifdef IOR
	uniform float ior;
#endif

varying vec3 vViewPosition;

${Ta.common}
${Ta.common_pars_fragment}
${Ta.lights_pars_fragment}

${n}

void main() {

  ${o}

	#if defined( USE_COLOR  ) || defined( USE_INSTANCING_COLOR  )
		diffuseColor.rgb = vColor;
	#endif

	${vj?"vec4 dcgRawColor = diffuseColor;":""}

	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	${Ta.common_fragment_begin}
	float roughnessFactor = roughness;
	float metalnessFactor = metalness;
	float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif

	// non perturbed normal for clearcoat among others
	vec3 geometryNormal = normal;

	// accumulation
	${Ta.lights_fragment}

	// modulation

	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;

	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;

	${JM}

	${Ta.common_fragment_end}

	${vj?"gl_FragColor.rgb = dcgRawColor.rgb;":""}

	${gm}

	if (uDepthPeel == 1) {
		// When depth peeling, we render with transparent: false, which causes <opaque_fragment> to set gl_FragColor.a = 1.
		// We need to set it back to the correct value so that it can be respsected in compositing.
		gl_FragColor.a = opacity;
	}
}
`;return{vertex:s,fragment:l,cacheKey:e,glslUniforms:a}}var Bde={...dm(DF.common),...dm(DF.lights),roughness:{value:.4},metalness:{value:0},emissive:{value:new er(0)}},mm=class extends ic{constructor(t){let{vertex:i,fragment:o,cacheKey:n,glslUniforms:a}=Cj(t),s=typeof t.color=="string"&&__dcg_shared_module_exports__['wd'](t.color)?"#808080":t.color,l={...dm(Bde),...XM(),...t.graphUniforms,...t.globalUniforms,opacity:{value:t.opacity},diffuse:{value:new er(s)},map:{value:t.map},...a};super({name:"GraphSurfaceMaterial",wireframe:t.wireframe,vertexShader:i,fragmentShader:o,opacity:t.opacity,side:Ls,lights:!0,uniforms:l});this.defines={DCG_SUPPORTS_PICKING:!1};this.vertexColors=t.vertexColors,this.useVertexPickingColors=t.useVertexPickingColors,this.map=t.map,this.defines.DCG_SUPPORTS_PICKING=!0,this.cacheKey=n}setEmissiveIntensity(t){let i=new er(16777215);i.multiplyScalar(t),this.uniforms.emissive.value.copy(i)}customProgramCacheKey(){return this.cacheKey}};function Ej(r){let{cacheKey:e,vertexPositionChunk:t,vertexDeclarations:i,fragmentColorChunk:o,fragmentDeclarations:n,glslUniforms:a}=QM(r),s=`
  ${Ta.common}
  ${Ta.common_pars_vertex}

  ${i}

void main() {
  ${Ta.common_vertex}

  ${t}
}
`,l=`
uniform vec3 diffuse;
uniform float opacity;
varying vec3 vNormal;

${Ta.common}
${Ta.common_pars_fragment}

${n}

void main() {

  ${o}

  ${Ta.common_fragment_begin}
  float specularStrength = 1.0;

	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );

	// accumulation (baked indirect lighting only)
	reflectedLight.indirectDiffuse += vec3( 1.0 );

	// modulation

	reflectedLight.indirectDiffuse *= diffuseColor.rgb;

	vec3 outgoingLight = reflectedLight.indirectDiffuse;

  ${Ta.common_fragment_end}

	${gm}
}
`;return{vertex:s,fragment:l,cacheKey:e,glslUniforms:a}}var fm=class extends ic{constructor(e){let{vertex:t,fragment:i,cacheKey:o,glslUniforms:n}=Ej({extraMeshArgs:[],restrictionShader:void 0,uvArgs:[],variant:{type:"zClip"}}),a=typeof e.color=="string"&&__dcg_shared_module_exports__['wd'](e.color)?"#808080":e.color,s={...XM(),...e.graphUniforms,...e.globalUniforms,roughness:{value:.4},metalness:{value:0},opacity:{value:e.opacity},diffuse:{value:new er(a)},...n};super({name:"LineMaterial",vertexShader:t,fragmentShader:i,opacity:e.opacity,side:Ls,uniforms:s}),this.cacheKey=o}setColor(e){this.uniforms.diffuse.value.copy(e)}setOpacity(e){this.opacity=this.uniforms.opacity.value=e}customProgramCacheKey(){return this.cacheKey}};var eI=class{constructor(){this.materialCache={};this.globalUniforms={dcgRenderMode:El.Default,xMin:0,xMax:0,yMin:0,yMax:0,zMin:0,zMax:0,uDepthPeel:0,uDepthPeelLayer:0,uPrevDepthTexture:null,uScreenSize:new Ht(1,1),uDepthOffset:1e-6}}setGlobalUniform(e,t){this.globalUniforms[e]=t}disposeAllMaterials(){this.disposeMaterialsNotInScene(new Th)}disposeMaterialsNotInScene(e){var i;let t={};e.traverse(o=>{if("material"in o){let n=o.material,a;Array.isArray(o.material)?a=n:a=[n],a.forEach(s=>{Sj(s)&&(t[s.dcgMaterialCacheKey]=!0)})}});for(let o in this.materialCache)if(!t[o]){let n=this.materialCache[o];n.dispose(),(i=n.map)==null||i.dispose(),delete this.materialCache[o]}}getOrMakeMaterial(e){var t=zde(e.spec),i=this.materialCache[t];if(i)switch(e.type){case"surface-graph":ZM(i.uniforms,e.uniforms);break;case"curve-graph":ZM(i.uniforms,e.uniforms);break;case"domain-plane":break;default:throw new Error(`Unexpected type ${e.type}`)}else{switch(e.type){case"surface-graph":i=this._buildSurfaceMaterial(e.spec,e.uniforms);break;case"curve-graph":i=this._buildCurveMaterial(e.spec,e.uniforms);break;case"domain-plane":i=this.buildDomainPlaneMaterial(e.spec);break;default:throw new Error(`Unexpected type ${e.type}`)}this.materialCache[t]=i,i.dcgMaterialCacheKey=t}return i}setDomain(e){let{xmin:t,xmax:i,ymin:o,ymax:n,zmin:a,zmax:s}=e,l=1e-5,c=(i-t)*l,d=(n-o)*l,p=(s-a)*l;this.globalUniforms.xMin=t-c,this.globalUniforms.xMax=i+c,this.globalUniforms.yMin=o-d,this.globalUniforms.yMax=n+d,this.globalUniforms.zMin=a-p,this.globalUniforms.zMax=s+p}setZBoundsUniform(e,t){if(!Sj(e))throw new Error("Cannot update zBoundsForAnimation on a material that is not managed by MaterialManager");e instanceof QE||e instanceof JE||Dj(e.uniforms,t)}_buildSurfaceMaterial(e,t){var d,p;let i=e.color,o=(d=e.uvArgs)!=null?d:[],n=(p=e.extraMeshArgs)!=null?p:[],a=e.restrictionShader,s=i.startsWith("wireframe:");s&&(i=i.slice(10));let l=this.getVariant(i,e.colorShader),c=new mm({color:__dcg_shared_module_exports__['wd'](i)?"#808080":i,wireframe:s,opacity:e.opacity,extraMeshArgs:n,map:void 0,variant:l,vertexColors:e.vertexColors||!1,useVertexPickingColors:e.useVertexPickingColors||!1,restrictionShader:a,uvArgs:o,globalUniforms:this.getGlobalUniforms()});return ZM(c.uniforms,t),c}_buildCurveMaterial(e,t){let i=new fm({color:e.color,opacity:1,globalUniforms:this.getGlobalUniforms()});return ZM(i.uniforms,t),i}buildDomainPlaneMaterial(e){let t;return e.type==="domain-plane-numbers-material"?t=new JE(e,this.getGlobalUniforms()):t=new QE(e,this.getGlobalUniforms()),this.setupGlobalUniforms(t.uniforms),t}getVariant(e,t){return e.startsWith("shader:")?!t||!t.source?{type:"zClip"}:{type:"colorFunc",colorShader:t,colorCacheKey:JSON.stringify(t)}:{type:"zClip"}}getGlobalUniforms(){let e={};return this.setupGlobalUniforms(e),e}setupGlobalUniforms(e){let t=this;for(let i in this.globalUniforms){let o=i;e[o]={get value(){return t.globalUniforms[o]}}}}};function ZM(r,e){let{clip:t,uvRange:i,zBoundsForAnimation:o}=e;Ude(r,i),Dj(r,o),r.clip_x={value:t.x},r.clip_y={value:t.y},r.clip_z={value:t.z},r.NaN={value:NaN},r.Infinity={value:1/0}}function Ude(r,e){r.uvMin={value:new Ht(e[0].min,e[1].min)},r.uvWidth={value:new Ht(e[0].max-e[0].min,e[1].max-e[1].min)}}function Dj(r,e){r.zMinForAnimation={value:e.zMinForAnimation},r.zMaxForAnimation={value:e.zMaxForAnimation}}function zde(r){return r.type==="domain-plane-numbers-material"?(r.canvas.hasAttribute("dcg-material-manager-id")||r.canvas.setAttribute("dcg-material-manager-id",Math.random()+""),JSON.stringify({...r,canvas:r.canvas.getAttribute("dcg-material-manager-id")})):JSON.stringify(r)}function Sj(r){return"dcgMaterialCacheKey"in r}var kj=`{
  "glyphs": {
    "x": {
      "x_min": 0,
      "x_max": 675,
      "ha": 764,
      "o": "m 675 0 l 525 0 l 331 286 l 144 0 l 0 0 l 256 379 l 12 738 l 157 737 l 336 473 l 516 738 l 661 738 l 412 380 l 675 0 "
    },
    "y": {
      "x_min": 0,
      "x_max": 684.78125,
      "ha": 771,
      "o": "m 684 738 l 388 -83 q 311 -216 356 -167 q 173 -279 252 -279 q 97 -266 133 -279 l 97 -149 q 132 -155 109 -151 q 168 -160 155 -160 q 240 -114 213 -160 q 274 -26 248 -98 l 0 738 l 137 737 l 341 139 l 548 737 l 684 738 "
    },
    "z": {
      "x_min": -0.015625,
      "x_max": 613.890625,
      "ha": 697,
      "o": "m 613 0 l 0 0 l 0 100 l 433 630 l 20 630 l 20 738 l 594 738 l 593 636 l 163 110 l 613 110 l 613 0 "
    }
  },
  "cssFontWeight": "normal",
  "ascender": 1189,
  "underlinePosition": -100,
  "cssFontStyle": "normal",
  "boundingBox": { "yMin": -334, "xMin": -111, "yMax": 1189, "xMax": 1672 },
  "resolution": 1000,
  "original_font_information": {
    "postscript_name": "Helvetiker-Regular",
    "version_string": "Version 1.00 2004 initial release",
    "vendor_url": "http://www.magenta.gr/",
    "full_font_name": "Helvetiker",
    "font_family_name": "Helvetiker",
    "copyright": "Copyright (c) \u039Cagenta ltd, 2004",
    "description": "",
    "trademark": "",
    "designer": "",
    "designer_url": "",
    "unique_font_identifier": "\u039Cagenta ltd:Helvetiker:22-10-104",
    "license_url": "http://www.ellak.gr/fonts/MgOpen/license.html",
    "license_description": "Copyright (c) 2004 by MAGENTA Ltd. All Rights Reserved.\\r\\n\\r\\nPermission is hereby granted, free of charge, to any person obtaining a copy of the fonts accompanying this license (\\"Fonts\\") and associated documentation files (the \\"Font Software\\"), to reproduce and distribute the Font Software, including without limitation the rights to use, copy, merge, publish, distribute, and/or sell copies of the Font Software, and to permit persons to whom the Font Software is furnished to do so, subject to the following conditions: \\r\\n\\r\\nThe above copyright and this permission notice shall be included in all copies of one or more of the Font Software typefaces.\\r\\n\\r\\nThe Font Software may be modified, altered, or added to, and in particular the designs of glyphs or characters in the Fonts may be modified and additional glyphs or characters may be added to the Fonts, only if the fonts are renamed to names not containing the word \\"MgOpen\\", or if the modifications are accepted for inclusion in the Font Software itself by the each appointed Administrator.\\r\\n\\r\\nThis License becomes null and void to the extent applicable to Fonts or Font Software that has been modified and is distributed under the \\"MgOpen\\" name.\\r\\n\\r\\nThe Font Software may be sold as part of a larger software package but no copy of one or more of the Font Software typefaces may be sold by itself. \\r\\n\\r\\nTHE FONT SOFTWARE IS PROVIDED \\"AS IS\\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL MAGENTA OR PERSONS OR BODIES IN CHARGE OF ADMINISTRATION AND MAINTENANCE OF THE FONT SOFTWARE BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM OTHER DEALINGS IN THE FONT SOFTWARE.",
    "manufacturer_name": "\u039Cagenta ltd",
    "font_sub_family_name": "Regular"
  },
  "descender": -334,
  "familyName": "Helvetiker",
  "lineHeight": 1522,
  "underlineThickness": 50
}
`;var{abs:ib,min:Gj,max:Ij}=Math,Aj=11184810,qde=3355443,GF="#444444",TF="#bbbbbb",Hde=1e-4;function Vj(r){let e=new er(Aj),t=new er(qde);return{axisMaterial:Tj(e,r),tickMaterial:Tj(t,r)}}function IF(r,e,t){return new rI(new Qf(new Ae(r.xmin,r.ymin,r.zmin),new Ae(r.xmax,r.ymax,r.zmax)),new er(e),t)}function Lj(r,e){let t=r.box;t.min.x=e.xmin,t.max.x=e.xmax,t.min.y=e.ymin,t.max.y=e.ymax,t.min.z=e.zmin,t.max.z=e.zmax,r.updateMatrixWorld()}function AF(r){r.dispose()}var Wde=new YE(JSON.parse(kj));function Tj(r,e){let t=new mm({color:r,extraMeshArgs:[],map:void 0,opacity:1,restrictionShader:void 0,uvArgs:[],variant:{type:"zClip"},wireframe:!1,vertexColors:!1,useVertexPickingColors:!1,globalUniforms:e,graphUniforms:{clip_x:{value:!1},clip_y:{value:!1},clip_z:{value:!1}}});return t.customProgramCacheKey=()=>"axis-material",t}function Pj(r,e){let{xmin:t,xmax:i,ymin:o,ymax:n,zmin:a,zmax:s}=r,l=Gj(e.width,e.height),c=.05*(l>360?1:l>120?360/l:4-l/120),d=4,p=d*c/.08,g=__dcg_shared_module_exports__['Cb'](0,t,i),h=__dcg_shared_module_exports__['Cb'](0,o,n),f=__dcg_shared_module_exports__['Cb'](0,a,s),y=i-t,x=n-o,E=s-a,C=4*((g-t)/y-.5),S=4*((h-o)/x-.5),v=4*((f-a)/E-.5),M=s<=0?-4:Gj(4*s/E,4);return{textSize:c,scale:d,delta:p,zLen:M,x:C,y:S,z:v}}var _j=.02,pu=7*_j;function Oj(r,e,t,{axisMaterial:i}){let{xmin:o,xmax:n,ymin:a,ymax:s,zmin:l,zmax:c}=r,d=n-o,p=s-a,g=c-l,h=(n+o)/2,f=(s+a)/2,y=(c+l)/2,x=new Rn,E=Math.PI,C=_j,{textSize:S,scale:v,delta:M,zLen:A,x:I,y:P,z:_}=Pj(r,e);function U(O){return new Fn(new du(.8*C,.8*C,O,10),i)}function Y(){return new Fn(new xM(2*C,pu,16),i)}function R(O,q,w,T=1){return O.position.set(w[0],w[1],w[2]),O.setRotationFromEuler(ob(q[0],q[1],q[2])),O.scale.set(T,T,T),O.name="axes",x.add(O),O}function H(O,q,w=1){let T=Jde(O,i);T.translateX(-q[0]*M),T.translateY(-q[1]*M),T.scale.set(w,w,w),T.name="axes";let B=zj(T);B.name=O,x.add(B)}return R(U(4-6*C),[0,0,E/2],[-pu/2,P,_]),R(U(4-6*C),[0,0,0],[I,-pu/2,_]),R(U(4-6*C),[-E/2,0,0],[I,P,-pu/2]),R(Y(),[0,0,-E/2],[2-pu/2,P,_]),R(Y(),[0,0,0],[I,2-pu/2,_]),R(Y(),[E/2,0,0],[I,P,_+Ij(A,0)-pu/2]),t&&(H("x",[.027,.03],S*v),H("y",[.025,.02],S*v),H("z",[.025,.03],S*v)),x.scale.set(d/4,p/4,g/4),x.position.set(h,f,y),x}function VF(r){for(let e of r.getObjectsByProperty("name","axes"))e.geometry.dispose()}function Rj(r){r.axisMaterial.dispose(),r.tickMaterial.dispose()}function Fj({axes:r,plane:e,gridMaterials:t,domain:i,screen:o,controls:n,invertedColors:a,isDepthPeelingActive:s}){let l=n.worldRotation3D,{xmax:c,ymax:d,zmax:p}=i,{scale:g,delta:h,zLen:f,x:y,y:x,z:E}=Pj(i,o);if(r===void 0)return;let C=Math.PI,S=r.getObjectByName("x"),v=r.getObjectByName("y"),M=r.getObjectByName("z"),A=new Ae(1,0,0).applyMatrix3(l),I=new Ae(0,1,0).applyMatrix3(l),P=new Ae(0,0,1).applyMatrix3(l);function _(Le,Se,et){Le==null||Le.setRotationFromEuler(ob(Se[0],Se[1],Se[2])),Le==null||Le.position.set(et[0],et[1],et[2])}function U(Le){return Math.acos(__dcg_shared_module_exports__['Cb'](Le,-1,1))}let Y=c<=0?-1:1,R=d<=0?-1:1,H=p<=0?-1:1,O=[Y*(.5*g+.05*h),x,E],q=[y,R*(.5*g+.05*h),E],w=[y,x,H*(E+Ij(f,0)+.04*h)],T=n.speed3D===0||n.grapher3d.isDragging,B=ib(n.axis3D[0])>.99,de=ib(n.axis3D[1])>.99,F=ib(n.axis3D[2])>.99,j=T||B,pe=T||de,le=T||F,{isXYsnapped:ne,isZsnapped:X}=n,ae=ib(A.y)>.99&&ne&&j,J=ib(I.y)>.99&&ne&&pe;if(ib(P.z)<.001&&X&&le)_(S,[C,0,C],O),_(v,[C,C,C],q),_(M,[C/2,0,0],w);else{let Le=P.z<0?1:-1,Se=I.y<0?1:-1,et=-Le*(C/2),W=(I.x*A.y<0?1:-1)*U(I.z),De=-Le*U(-Se*A.z),Ne=ae?W:C/2,me=J?De:et,ve=(I.y<0?-1:1)*U(A.y)+C,Pe=Se*C/2;_(S,[Ne,0,0],O),_(v,[me,0,Pe],q),_(M,[et,0,ve],w);let He=e==null?void 0:e.getObjectByName("z plane");He==null||He.setRotationFromEuler(ob(C/2,0,ve))}let Ee=new Ae(0,0,1).applyMatrix3(n.worldRotation3D).x;e==null||e.updateZOffsets(Ee<0),e!=null&&e.xyPlane&&(e.xyPlane.material.uniforms.diffuse.value=new er(a?0:16777215)),Xde({grid:e==null?void 0:e.grid,invertedColors:a,obliqueness:Ee,gridMaterials:t,isDepthPeelingActive:s})}var tI=class extends hw{constructor(e,t,i,o,n,a){super();let{showNumbers3D:s,showPlane3D:l}=i.settings,{xmin:c,xmax:d,ymin:p,ymax:g,zmin:h,zmax:f}=e,[y,x,E]=[d-c,g-p,f-h],C=__dcg_shared_module_exports__['Cb'](0,h,f);this.basePosition=new Ae((d+c)/2,(g+p)/2,C),this.zOffset=Hde*(f-h);let S=new $E(y,x);if(this.xyNumbersPlane=new Fn(S,t.xyNumbersMaterial),this.xyNumbersPlane.name="xy numbers plane",this.xyPlane=new Fn(S,t.xyPlaneMaterial),this.xyPlane.name="xy plane",l){this.add(this.xyPlane);let v=new rI(new Qf(new Ae(c,p,C),new Ae(d,g,C)),new er(Aj),a);v.name="xy border",this.add(v),this.grid=new MF(i,e,o),this.grid.name="grid",this.add(this.grid)}if(s){this.add(this.xyNumbersPlane),this.add(Yde(i,e,n));let v=new $E(4,4),M=new Fn(v,t.zMaterial),A=zj(M),[I,P]=[__dcg_shared_module_exports__['Cb'](0,c,d),__dcg_shared_module_exports__['Cb'](0,p,g)];M.setRotationFromEuler(ob(Math.PI/2,0,0)),M.name="z plane",A.scale.set(y/4,x/4,E/4),A.position.set(I,P,(f+h)/2),$de(t.zCanvas,i,e),t.zMaterial.uniforms.map.value.needsUpdate=!0,this.add(A)}}updateZOffsets(e){var a,s,l;let{x:t,y:i,z:o}=this.basePosition,n=e?this.zOffset:-this.zOffset;this.xyPlane&&((a=this.xyPlane)==null||a.position.set(t,i,o-n),this.xyPlane.renderOrder=0),this.grid&&((s=this.grid)==null||s.updateZOffset(n),this.grid.renderOrder=1),this.xyNumbersPlane&&((l=this.xyNumbersPlane)==null||l.position.set(t,i,o+2*n),this.xyNumbersPlane.renderOrder=2)}};function $de(r,e,t){var i=r.getContext("2d");if(i===null)return;let o=Nj(e,t),n=e.settings.labelSize,{xmin:a,xmax:s,zmin:l,zmax:c}=t,d=[];for(let S of o){let v=__dcg_shared_module_exports__['zb'].value(S,c-l);d.push(new Hs(v,n))}i.save(),i.scale(window.devicePixelRatio,window.devicePixelRatio),i.clearRect(0,0,e.screen.width,e.screen.height),i.fillStyle=`rgba(${e.settings.config.invertedColors?"0,0,0":"255,255,255"},0.001961)`,i.fillRect(0,0,e.screen.width,e.screen.height),i.lineWidth=1.5,i.miterLimit=2,i.strokeStyle=e.settings.getBackgroundColor({invertWhite:!0});let p=5,g=e.settings.getTextColor({invertBlack:!0}),h=e.screen.width,f=e.screen.height,y={left:3,top:3,right:h-3,bottom:f-3},x=new di(a,s,l,c,l,c),E=new wl(e.screen,x,e.settings),C=r.width/window.devicePixelRatio/2;for(let S of d){let v={x:C-p-S.getRect().right,y:E.mapy(S.getValue())},M=S.clampBoundsWithinRect(v,y);i.fillStyle=g,S.drawCenteredAt(i,M,"")}i.restore()}var MF=class extends hw{constructor(e,t,i){super();let{xmin:o,xmax:n,ymin:a,ymax:s,zmin:l,zmax:c}=t,d=Qc(e),{xMinor:p,xMajor:g,yMinor:h,yMajor:f}=Qde(t,d),y=n-o,x=s-a,E=__dcg_shared_module_exports__['Cb'](0,l,c);this.basePosition=new Ae(o,a,E);let C=[];for(let P of p)C.push(P-o,0,0,P-o,x,0);for(let P of h)C.push(0,P-a,0,y,P-a,0);let S=new Wa;S.setAttribute("position",new ao(C,3));let v=new um(S,i.minor);v.name="minor";let M=[];for(let P of g)M.push(P-o,0,0,P-o,x,0);for(let P of f)M.push(0,P-a,0,y,P-a,0);let A=new Wa;A.setAttribute("position",new ao(M,3));let I=new um(A,i.major);I.name="major",this.add(v),this.add(I)}updateZOffset(e){this.position.set(this.basePosition.x,this.basePosition.y,this.basePosition.z+e)}};function Nj(r,e){let{zmin:t,zmax:i}=e,o={...r.viewport,ymin:t,ymax:i},n={...r,viewport:o},{majorStepY:a}=Qc(n),s=Vs(t,i,a);return i>0&&(s=s.filter(l=>l!=0)),s}function jde(r,e){let{zmin:t,zmax:i}=e;return Nj(r,e).filter(n=>n<=i-pu/4*(i-t))}function Yde(r,e,{tickMaterial:t}){let{xmin:i,xmax:o,ymin:n,ymax:a,zmin:s,zmax:l}=e,c=__dcg_shared_module_exports__['Cb'](0,i,o),d=__dcg_shared_module_exports__['Cb'](0,n,a),p=__dcg_shared_module_exports__['Cb'](0,s,l),g=Math.PI,h=.004,f=h*(o-i),y=h*(a-n),x=h*(l-s),E=new hw,C=.4;for(let A of jde(r,e)){let I=new du;var S=new Fn(I,t);S.position.set(c,d,A),S.scale.set(f,C*x,y),S.setRotationFromEuler(ob(g/2,0,0)),S.name="ticks",E.add(S)}let{majorStepX:v,majorStepY:M}=Qc(r);for(let A of Vs(i,o,v)){if(A>o-pu/4*(o-i))continue;let I=new du;var S=new Fn(I,t);S.position.set(A,d,p),S.scale.set(y,C*f,x),S.setRotationFromEuler(ob(0,0,g/2)),S.name="ticks",E.add(S)}for(let A of Vs(n,a,M)){if(A>a-pu/4*(a-n))continue;let I=new du;var S=new Fn(I,t);S.position.set(c,A,p),S.scale.set(x,C*y,f),S.setRotationFromEuler(ob(0,g/2,0)),S.name="ticks",E.add(S)}return E}function Bj(r){let e={clip_x:{value:!1},clip_y:{value:!1},clip_z:{value:!1}};return{minor:new fm({color:new er(TF),opacity:1,globalUniforms:r,graphUniforms:e}),major:new fm({color:new er(GF),opacity:1,globalUniforms:r,graphUniforms:e})}}function Xde({obliqueness:r,gridMaterials:e,grid:t,invertedColors:i,isDepthPeelingActive:o}){let n=r<0,a=.5;if(r<a){let c=ib(r)/a;e.minor.transparent=!o,e.major.transparent=!o,e.minor.setOpacity(c),e.major.setOpacity(c),t&&(t.renderOrder=n?-1:1)}else e.minor.transparent=!1,e.major.transparent=!1,e.minor.setOpacity(1),e.major.setOpacity(1);let s=i?__dcg_shared_module_exports__['R'](GF):GF,l=i?__dcg_shared_module_exports__['R'](TF):TF;e.major.setColor(new er(s)),e.minor.setColor(new er(l))}function Uj(r){var i,o,n,a,s,l;let e=c=>r.getObjectByName(c);(i=e("xy numbers plane"))==null||i.geometry.dispose(),(o=e("xy plane"))==null||o.geometry.dispose(),(n=e("z plane"))==null||n.geometry.dispose(),(a=e("xy border"))==null||a.dispose(),(s=e("major"))==null||s.geometry.dispose(),(l=e("minor"))==null||l.geometry.dispose();let t=r.getObjectsByProperty("name","ticks");for(let c of t)c.geometry.dispose()}function LF(r){r.uniforms.map.value.dispose(),r.dispose()}function zj(r){let e=new Rn;return e.add(r),e}function Jde(r,e){let t=new XE(r,{font:Wde,size:1,height:.02,curveSegments:12,bevelEnabled:!0,bevelThickness:.04,bevelSize:.04,bevelOffset:0,bevelSegments:5});var i=new Fn(t,e);return i}var ob=(r,e,t)=>new tc(r,e,t,"ZYX");function Qde(r,e){let{xmin:t,xmax:i,ymin:o,ymax:n}=r,{majorStepX:a,majorStepY:s,minorStepX:l,minorStepY:c}=e,d=Mj({min:t,max:i,majorStep:a,minorStep:l}),p=Mj({min:o,max:n,majorStep:s,minorStep:c});return{xMinor:d.minor,xMajor:d.major,yMinor:p.minor,yMajor:p.major}}function Mj({min:r,max:e,majorStep:t,minorStep:i}){let o=Vs(r,e,t),n=Vs(r,e,i);if(o.length>0&&n.length>0){let a=Math.round(t/i),s=Math.round((o[0]-n[0])/i);n=n.filter((l,c)=>c%a!==s)}return{minor:n,major:o}}var rI=class extends um{constructor(t,i,o){let n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),a=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new Wa;s.setIndex(new Ps(n,1)),s.setAttribute("position",new ao(a,3));super(s,new fm({color:i,opacity:1,graphUniforms:{clip_x:{value:!1},clip_y:{value:!1},clip_z:{value:!1}},globalUniforms:o}));this.type="Box3Helper";this.box=t,this.geometry.computeBoundingSphere()}updateMatrixWorld(t){let i=this.box;i.isEmpty()||(i.getCenter(this.position),i.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(t))}dispose(){this.geometry.dispose(),this.material.dispose()}};var PF=[];function Kj(r){return PF[r]===void 0&&(PF[r]=Zde(r)),PF[r]}function Zde(r){let e=Math.SQRT1_2,t=[0,0,1,0,0,-1,-e,-e,0,e,-e,0,e,e,0,-e,e,0],i=[0,3,4,0,4,5,0,5,2,0,2,3,1,4,3,1,5,4,1,2,5,1,3,2];function o(n){let a=t.length/3;for(let s=0;s<a;s++)if(n.x===t[3*s+0]&&n.y===t[3*s+1]&&n.z===t[3*s+2])return s;return t.push(n.x,n.y,n.z),a}for(let n=0;n<r;n++){let a=i.length/3;for(let s=0;s<a;s++){let l=i[3*s+0],c=i[3*s+1],d=i[3*s+2],p=new __dcg_shared_module_exports__['Qc'](t[3*l+0],t[3*l+1],t[3*l+2]),g=new __dcg_shared_module_exports__['Qc'](t[3*c+0],t[3*c+1],t[3*c+2]),h=new __dcg_shared_module_exports__['Qc'](t[3*d+0],t[3*d+1],t[3*d+2]),f=new __dcg_shared_module_exports__['Qc']().addVectors(p,g).multiply(.5).normalize(),y=new __dcg_shared_module_exports__['Qc']().addVectors(g,h).multiply(.5).normalize(),x=new __dcg_shared_module_exports__['Qc']().addVectors(h,p).multiply(.5).normalize(),E=o(f),C=o(y),S=o(x);i.push(l,E,S,E,c,C,C,d,S),i[3*s+0]=E,i[3*s+1]=C,i[3*s+2]=S}}return{vertices:new Float32Array(t),indices:new Uint16Array(i)}}function qj(r,e,t){let i=__dcg_shared_module_exports__['Cb'](Math.floor(8+30*e),8,20);for(let A=0;A<r.length/3;A++)if(C(A)&&C(A+1)){r=r.slice(3*A);break}if(!(C(0)&&C(1)))return[[],[],[]];let n=r.length/3-1,a=new Ae,s=new Ae,l=(t.xmax-t.xmin)/2,c=(t.ymax-t.ymin)/2,d=(t.zmax-t.zmin)/2,p=[],g=[],h=[],f=M();for(let A=0;A<=n;A++)y(A);return x(),[p,g,h];function y(A){s.x=r[3*A+0],s.y=r[3*A+1],s.z=r[3*A+2];let I=f.normals[A],P=f.binormals[A];if(v(A))for(let _=0;_<=i;_++){let U=_/i*Math.PI*2,Y=Math.sin(U),R=-Math.cos(U);a.x=l*e*(R*I.x+Y*P.x),a.y=c*e*(R*I.y+Y*P.y),a.z=d*e*(R*I.z+Y*P.z),p.push(s.x+a.x,s.y+a.y,s.z+a.z),a.normalize(),g.push(a.x,a.y,a.z)}else for(let _=0;_<=i;_++)p.push(0,0,0),g.push(0,0,0)}function x(){for(let A=1;A<=n;A++)if(v(A-1)&&v(A))for(let I=1;I<=i;I++){let P=(i+1)*(A-1)+(I-1),_=(i+1)*A+(I-1),U=(i+1)*A+I,Y=(i+1)*(A-1)+I;h.push(P,_,Y,_,U,Y)}}function E(A){return new Ae(r[3*A+0],r[3*A+1],r[3*A+2])}function C(A){return isFinite(Math.fround(r[3*A+0]))&&isFinite(Math.fround(r[3*A+1]))&&isFinite(Math.fround(r[3*A+2]))}function S(A){return isFinite(A.x)&&isFinite(A.y)&&isFinite(A.z)}function v(A){return C(A)&&S(f.normals[A])&&S(f.binormals[A])}function M(){let A=new Ae,I=[],P=[],_=[],U=new Ae,Y=new rr;for(let R=0;R<=n;R++){let[H,O]=R<n?[R+1,R]:[R,R-1],q=E(H).sub(E(O)).normalize();S(q)?I[R]=q:R>0&&(I[R]=I[R-1])}for(let R=0;R<=n;R++)if(R===0||!C(R-1)){P[R]=new Ae,_[R]=new Ae;let H=Number.MAX_VALUE,O=Math.abs(I[R].x),q=Math.abs(I[R].y),w=Math.abs(I[R].z);O<=H&&(H=O,A.set(1,0,0)),q<=H&&(H=q,A.set(0,1,0)),w<=H&&A.set(0,0,1),U.crossVectors(I[R],A).normalize(),P[R].crossVectors(I[R],U),_[R].crossVectors(I[R],P[R])}else{if(P[R]=P[R-1].clone(),_[R]=_[R-1].clone(),U.crossVectors(I[R-1],I[R]),U.length()>Number.EPSILON){U.normalize();let O=Math.acos(__dcg_shared_module_exports__['Cb'](I[R-1].dot(I[R]),-1,1));P[R].applyMatrix4(Y.makeRotationAxis(U,O))}let H=R>0&&I[R-1].dot(I[R])>-.999999*I[R-1].length()*I[R].length()?I[R].clone().add(I[R-1]).normalize():I[R];_[R].crossVectors(H,P[R]).normalize()}return{normals:P,binormals:_}}}var{abs:_F,floor:epe,sin:Hj,cos:Wj}=Math;function $j(r,e,t,i){if(!O(r)||!O(e)||!isFinite(t)||r.equals(e)||t===0)return[[],[],[]];let o=e.clone().sub(r).normalize(),n=o.clone().negate(),a=new Ae,s=new Ae,l=new Ae,c=Number.MAX_VALUE,d=_F(o.x),p=_F(o.y),g=_F(o.z);d<=c&&(c=d,a.set(1,0,0)),p<=c&&(c=p,a.set(0,1,0)),g<=c&&a.set(0,0,1),l.crossVectors(o,a).normalize(),a.crossVectors(o,l),s.crossVectors(o,a);let h=new Ae,f=(i.xmax-i.xmin)/2,y=(i.ymax-i.ymin)/2,x=(i.zmax-i.zmin)/2,E=[],C=[],S=[],v=e.clone().sub(r),A=new Ae(v.x/f,v.y/y,v.z/x).length();t>A/6&&(t=A/6);let I=6*t,P=1-Math.min(1,I/A),_=r.clone().add(v.clone().multiplyScalar(P)),U=__dcg_shared_module_exports__['Cb'](epe(8+80*t),8,30);R(r,t),R(_,t),H();let Y=E.length/3;E.push(r.x,r.y,r.z),C.push(n.x,n.y,n.z),R(r,t,n);for(let q=1;q<=U;q++)S.push(Y,Y+q,Y+q+1);Y=E.length/3,E.push(_.x,_.y,_.z),C.push(n.x,n.y,n.z),R(_,2*t,n);for(let q=1;q<=U;q++)S.push(Y,Y+q,Y+q+1);Y=E.length/3;for(let q=0;q<=U;q++){let w=q/U*Math.PI*2,T=Hj(w),B=-Wj(w);h.x=f*2*t*(B*a.x+T*s.x),h.y=y*2*t*(B*a.y+T*s.y),h.z=x*2*t*(B*a.z+T*s.z),E.push(_.x+h.x,_.y+h.y,_.z+h.z),E.push(e.x,e.y,e.z);let de=1/3,F=new Ae(B*a.x+T*s.x+de*o.x,B*a.y+T*s.y+de*o.y,B*a.z+T*s.z+de*o.z).normalize();C.push(F.x,F.y,F.z,F.x,F.y,F.z)}for(let q=0;q<U;q++)S.push(Y+2*q,Y+2*q+1,Y+2*q+2);return[E,C,S];function R(q,w,T){for(let B=0;B<=U;B++){let de=B/U*Math.PI*2,F=Hj(de),j=-Wj(de);h.x=f*w*(j*a.x+F*s.x),h.y=y*w*(j*a.y+F*s.y),h.z=x*w*(j*a.z+F*s.z),E.push(q.x+h.x,q.y+h.y,q.z+h.z),h.normalize(),T===void 0?C.push(h.x,h.y,h.z):C.push(T.x,T.y,T.z)}}function H(){for(let q=1;q<=U;q++){let w=q-1,T=U+q,B=U+q+1,de=q;S.push(w,T,de,T,B,de)}}function O(q){return isFinite(q.x)&&isFinite(q.y)&&isFinite(q.z)}}var iI=class{constructor(){}setSize(e,t){}dispose(){}},tpe=new Sh(-1,1,1,-1,0,1),ww=class{constructor(e){let t=new Wa;t.setAttribute("position",new ao([-1,3,0,-1,-1,0,3,-1,0],3)),t.setAttribute("uv",new ao([0,2,0,0,2,0],2)),this._mesh=new Fn(t,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,tpe)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}};var Mh=class extends iI{constructor(t,i={},o="tDiffuse"){super();this.inputTextureName=o;this.uniforms=dm(t.uniforms),this.defines=t.defines?{...t.defines}:{},this.material=new ic({...i,name:t.name!==void 0?t.name:"unspecified",defines:this.defines,uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.fsTriangle=new ww(this.material)}render(t,i,o){this.renderFromTexture(t,i,o.texture)}renderFromTexture(t,i,o){this.uniforms[this.inputTextureName]&&(this.uniforms[this.inputTextureName].value=o),this.fsTriangle.material=this.material,t.setRenderTarget(i),this.fsTriangle.render(t)}dispose(){this.material.dispose(),this.fsTriangle.dispose()}};var jj={name:"FillShader",defines:{},uniforms:{color:{value:new er(16777215)},opacity:{value:1}},vertexShader:`
		void main() {
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
		}`,fragmentShader:`
		uniform vec3 color;
		uniform float opacity;
		void main() {
			gl_FragColor = vec4( color, opacity );
		}`};function oI(r,e,t=0,i=0,o=e.width,n=e.height,a=new Uint8ClampedArray(4*o*n)){return r.readRenderTargetPixels(e,t,i,o,n,a),a}function eS(r,e,t,i){let o=4*(i*e+t);return[r[o],r[o+1],r[o+2],r[o+3]]}var ZE=new Uint8Array(4),rpe=new Float32Array(ZE.buffer);function nI([r,e,t,i]){return ZE[0]=i,ZE[1]=t,ZE[2]=e,ZE[3]=r,rpe[0]}function ipe(r){let e=r.getContext();if(!(e instanceof WebGL2RenderingContext))throw new Error("WebGL2 is required for waitForFullFlush");return e}async function Yj(r){let e=ipe(r),t=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);if(!t)throw new Error("Failed to create sync object");e.flush();let i=await ope(e,t,0,0);return e.deleteSync(t),i}function ope(r,e,t,i){let o=performance.now();return new Promise((n,a)=>{function s(){let l=r.clientWaitSync(e,t,0);if(l===r.WAIT_FAILED){a();return}if(l===r.TIMEOUT_EXPIRED){o=performance.now(),setTimeout(s,i);return}n([o,performance.now()])}s()})}var OF;function Xj(){if(OF)return OF;let r=new Mh(jj),e=1,t=1,i=1,o=0,n=r.material;n.uniforms.color.value=new er().setRGB(e,t,i),n.uniforms.opacity.value=o,n.blending=$1,n.blendEquation=ou,n.blendSrc=Y1,n.blendDst=j1;let a=new bw,s=a.getContext(),l=[rd,rw,Ha],c=[s.FLOAT,s.HALF_FLOAT,s.UNSIGNED_BYTE],d=[new Float32Array(4),new Uint16Array(4),new Uint8Array(4)],p=[1,15360,255],g=[];for(let h=0;h<l.length;h++){let f=new oc(1,1,{minFilter:nu,magFilter:nu,type:l[h],format:lu,stencilBuffer:!1,depthBuffer:!0});r.render(a,f,new oc),s.readPixels(0,0,1,1,s.RGBA,c[h],d[h]);let y=[...d[h]];y[0]/=p[h],y[1]/=p[h],y[2]/=p[h],y[3]/=p[h];let x=(C,S,v=.01)=>C<S+v&&C>S-v,E=s.checkFramebufferStatus(s.FRAMEBUFFER)===s.FRAMEBUFFER_COMPLETE;E=E&&x(y[0],e),E=E&&x(y[1],t),E=E&&x(y[2],i),E=E&&x(y[3],o),E=E||h===l.length-1,f.dispose(),E&&g.push(l[h])}return r.dispose&&r.dispose(),OF=g,g}var RF;function npe(){if(!RF){let r=document.createElement("div");r.className="dcg-3d-debug-root",document.body.appendChild(r),RF=r}return RF}var aI=class{constructor({filter:e}){this.canvases={};e?(this.enabled=!0,this.filter=new RegExp(e)):this.enabled=!1}get(e){if(!(!this.enabled||!this.filter.test(e)))return this.canvases[e]||(this.canvases[e]=new FF(e)),this.canvases[e]}},FF=class{constructor(e){this.label=e;this.container=document.createElement("div"),this.container.className="dcg-3d-debug-container",this.container.setAttribute("dcg-label",e),this.canvas=document.createElement("canvas"),this.container.appendChild(this.canvas),npe().appendChild(this.container)}renderRawData(e,t,i,o){var a;let n=new ImageData(e,t,i);this.canvas.width=t,this.canvas.height=i,this.container.style.width=t*o+"px",this.container.style.height=i*o+"px",(a=this.canvas.getContext("2d"))==null||a.putImageData(n,0,0)}renderFromTarget(e,t,i){this.renderRawData(oI(e,t),t.width,t.height,i)}};var sI={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},defines:{SRGB_COLOR_SPACE:!0},vertexShader:`
		varying vec2 vUv;

		void main() {
			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
		}`,fragmentShader:`
		uniform float opacity;
		uniform sampler2D tDiffuse;
		varying vec2 vUv;

		void main() {
			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;
      #ifdef SRGB_COLOR_SPACE
      gl_FragColor = LinearTosRGB( gl_FragColor );
      #endif
		}`};as();var Jj={name:"CopyShader",uniforms:{t0:{value:null},t1:{value:null},t2:{value:null},t3:{value:null}},defines:{},vertexShader:`
		varying vec2 vUv;
		void main() {
			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
		}`,fragmentShader:`
		uniform sampler2D t0;
		uniform sampler2D t1;
		uniform sampler2D t2;
		uniform sampler2D t3;

		uniform float opacity;
		uniform sampler2D tDiffuse;
		varying vec2 vUv;

		void main() {
      int index = int(vUv.x * 4.0);
      float x = vUv.x * 4.0 - float(index);
      vec2 uv = vec2(x, vUv.y);
      if (index == 0) {
        gl_FragColor = texture2D( t0, uv );
      } else if (index == 1) {
        gl_FragColor = texture2D( t1, uv );
      } else if (index == 2) {
        gl_FragColor = texture2D( t2, uv );
      } else if (index == 3) {
        gl_FragColor = texture2D( t3, uv );
      }
		}`};var NF=new URLSearchParams(window.location.search),ape=NF.has("peel-float-texture"),Qj=NF.has("peel-upsample")?parseFloat(NF.get("peel-upsample")):void 0,lI={BackgroundColor:0,Texture:1},cI=class{constructor(e,t,i,o,n){this.renderer=e;this.materialManager=t;this.scene=i;this.camera=o;this.debug=n;this.triangles=0;this.pixelRatio=e.getPixelRatio();let a=e.getSize(new Ht).multiplyScalar(this.pixelRatio);this.size=a,this.init()}init(){this.samples=1,Qj?this.samples=Qj:this.pixelRatio<1.5?this.samples=3:this.pixelRatio<2.5?this.samples=2:this.samples=1;let e=ape?Xj()[0]:Ha,t=()=>new oc(this.size.x,this.size.y,{minFilter:au,magFilter:au,type:e,colorSpace:Zl});this.peelSampleTargets=[],this.peelResultTarget=t(),this.compositingTargets=[t(),t()];let i=2*this.samples;for(let o=0;o<i;o++){let n=t();n.depthTexture=new fw(this.size.x,this.size.y),this.peelSampleTargets.push(n)}this.additiveCopyPass=new Mh(sI,{depthTest:!1,depthWrite:!1,transparent:!0,premultipliedAlpha:!0,blending:FE}),this.additiveCopyPass.defines.SRGB_COLOR_SPACE=!1,this.compositeMaterial=new ic({name:"DepthPeelLayerCompositeShader",uniforms:{uTextureA:{value:null},uTextureB:{value:null},uBackgroundColor:{value:this.scene.background},uCompositeType:{value:lI.Texture}},vertexShader:`
        varying vec2 vUv;
        void main(){
          vUv = uv;
          gl_Position = vec4(position.xy,0.,1.);
        }
      `,fragmentShader:`
        varying vec2 vUv;
        uniform sampler2D uTextureA;
        uniform sampler2D uTextureB;
        uniform vec3 uBackgroundColor;
        uniform int uCompositeType;
        void main() {
          vec4 src = texture2D(uTextureA,vUv);
          vec4 dst = uCompositeType == ${lI.Texture} ? texture2D(uTextureB,vUv) : vec4(uBackgroundColor, 1.0);

          float oneMinusSrcAlpha = 1.-src.a;
          float composedAlpha = src.a + oneMinusSrcAlpha * dst.a;
          gl_FragColor.a = composedAlpha;
          gl_FragColor.rgb = (src.a * src.rgb + oneMinusSrcAlpha * dst.a * dst.rgb) / composedAlpha;
        }
      `,transparent:!1,depthTest:!1,depthWrite:!1}),this.fsTriangle=new ww(this.compositeMaterial),this.materialManager.setGlobalUniform("uScreenSize",new Ht(1/this.size.x,1/this.size.y))}dispose(){this.peelSampleTargets.forEach(e=>e.dispose()),this.compositingTargets.forEach(e=>e.dispose()),this.peelResultTarget.dispose(),this.compositeMaterial.dispose(),this.fsTriangle.dispose(),this.additiveCopyPass.dispose()}render(e){var h;let t=this.renderer,i=t.getPixelRatio(),o=t.getSize(new Ht).multiplyScalar(i);(i!==this.pixelRatio||this.size.x!==o.x||this.size.y!==o.y)&&(this.size.copy(o),this.dispose(),this.init());let n=t.getClearColor(new er),a=t.autoClear;t.autoClear=!0,t.setClearColor(new er(0),1),t.clear(),this.materialManager.setGlobalUniform("uDepthPeel",1),this.materialManager.setGlobalUniform("uDepthPeelLayer",0),this.materialManager.setGlobalUniform("uPrevDepthTexture",null);let s;this.materialManager.setGlobalUniform("dcgRenderMode",El.Default);let l=this.peelSampleTargets.slice(0,this.samples),c=this.peelSampleTargets.slice(this.samples,2*this.samples),d=this.compositingTargets[0],p=this.compositingTargets[1],g=this.getJitterOffsets();this.peel(g,l,void 0,0,d),s=d;for(let f=0;f<e;f++){let y=f+1;this.peel(g,c,l,y,this.peelResultTarget),t.setRenderTarget(p),this.composite(d,this.peelResultTarget),(h=this.debug.get(`peel-c${y}`))==null||h.renderFromTarget(this.renderer,p,1/10),s=p,[c,l]=[l,c],[p,d]=[d,p]}t.setRenderTarget(null),this.composite(s,this.scene.background),t.setClearColor(n),t.autoClear=a,this.materialManager.setGlobalUniform("uPrevDepthTexture",null),this.materialManager.setGlobalUniform("uDepthPeel",0)}peel(e,t,i,o,n){var a,s;for(let l=0;l<t.length;l++){let c=t[l];i&&this.materialManager.setGlobalUniform("uPrevDepthTexture",i[l].depthTexture),this.camera.setViewOffset(this.size.x,this.size.y,e[l][0]*.0625,e[l][1]*.0625,this.size.x,this.size.y),this.materialManager.setGlobalUniform("uDepthPeelLayer",o),this.materialManager.setGlobalUniform("dcgRenderMode",El.Default),this.renderer.setClearColor(new er(0),0),this.renderer.setRenderTarget(c),this.renderer.clear(!0,!0),this.renderer.render(this.scene,this.camera),this.triangles=this.renderer.info.render.triangles,(a=this.debug.get(`peel-p${o}-s${l}`))==null||a.renderFromTarget(this.renderer,c,1/10),this.renderer.setRenderTarget(n),this.renderer.autoClear=!1,this.additiveCopyPass.uniforms.opacity.value=spe(t.length,l),l===0&&(this.renderer.setClearColor(new er(0),0),this.renderer.clear()),this.additiveCopyPass.render(this.renderer,n,c),(s=this.debug.get(`peel-p${o}-s${l}-combined`))==null||s.renderFromTarget(this.renderer,n,1/10)}this.renderer.autoClear=!0,this.camera.clearViewOffset()}composite(e,t){this.compositeMaterial.uniforms.uTextureA.value=e.texture,t instanceof er?(this.compositeMaterial.uniforms.uBackgroundColor.value=t,this.compositeMaterial.uniforms.uCompositeType.value=lI.BackgroundColor):(this.compositeMaterial.uniforms.uTextureB.value=t.texture,this.compositeMaterial.uniforms.uCompositeType.value=lI.Texture),this.fsTriangle.render(this.renderer)}getJitterOffsets(){if(!Zj[this.samples])throw new Error(`Unsupported sample count: ${this.samples}`);return Zj[this.samples]}};function spe(r,e){let t=1/r,i=1/32,o=-.5+(e+.5)/r;return t+i*o}var Zj={1:[[0,0]],2:[[4,4],[-4,-4]],3:[[3.323,3.323],[-4.54,1.216],[1.216,-4.54]],4:[[-2,-6],[6,-2],[-6,2],[2,6]]};as();var eY=new Set;eY.add("(0,0,0,0)");var dI=class{constructor(){this.pickingColorToData=new Map;this.idToPickingColor=new Map;this.testingLastHashCollisionCount=0}setPickingColorForMesh(e){let{mesh:t,branchId:i}=e;if(t instanceof Nn)for(let o=0;o<t.count;o++){let n=i+":"+o,a=this._getOrCreatePickingColor({mesh:t,index:o,isPoint:e.isPoint,blocksPicking:e.blocksPicking,forceOpaque:!1,pickingId:n});t.setPickingColorAt(o,a)}else if(e.pickingColorVertexCounts){let o=[],{pickingColorVertexCounts:n}=e;for(let a=0;a<n.length;a++){let s=i.split(":")[0]+":"+a,l=this._getOrCreatePickingColor({mesh:t,index:a,isPoint:e.isPoint,blocksPicking:e.blocksPicking,forceOpaque:!1,pickingId:s});o.push(l)}t.setPickingColorArray({colors:o,repeatColorCounts:n})}else{let o=i;t.pickingColor=this._getOrCreatePickingColor({mesh:t,index:0,isPoint:e.isPoint,blocksPicking:e.blocksPicking,forceOpaque:e.forceOpaque,pickingId:o})}}_getOrCreatePickingColor(e){let t=e.pickingId,i=this.idToPickingColor.get(t);if(i){let l=i.key;return this.pickingColorToData.set(l,e),i.color}let o=dpe(e.pickingId),n,a,s=0;for(;;){let l=o+s**2,c=l>>24&255,d=l>>16&255,p=l>>8&255,g=e.forceOpaque?255:l&255;if(n=`(${c},${d},${p},${g})`,a=[c/255,d/255,p/255,g/255],!eY.has(n)&&!this.pickingColorToData.has(n))break;if(s++,s>100){Ii(new Error(`PickingColorManager.getOrCreatePickingColor: too many collisions for id ${t}`)),n="(0,0,0,0)",a=[0,0,0,0];break}}return this.testingLastHashCollisionCount=s,this.pickingColorToData.set(n,e),this.idToPickingColor.set(t,{key:n,color:a}),a}getDataForPickingColor(e){let t=`(${e.join(",")})`;return this.pickingColorToData.get(t)}disposeColorsNotInScene(e){let t=new Set;e.traverse(i=>{if(i instanceof Nn){let o=[0,0,0,0];for(let n=0;n<i.count;n++)i.getPickingColorAt(n,o),t.add(BF(o))}else if(i.pickingColorArray){let o=i.pickingColorArray.colors;if(o)for(let n of o)t.add(BF(n))}else{let o=i.pickingColor;o&&t.add(BF(o))}});for(let i of this.pickingColorToData.keys())if(!t.has(i)){let o=this.pickingColorToData.get(i);this.idToPickingColor.delete(o.pickingId),this.pickingColorToData.delete(i)}}};function BF(r){return"("+Math.round(r[0]*255)+","+Math.round(r[1]*255)+","+Math.round(r[2]*255)+","+Math.round(r[3]*255)+")"}var lpe=2166136261,cpe=16777619;function dpe(r){let e=lpe;for(let t=0;t<r.length;t++)e^=r.charCodeAt(t),e*=cpe;return e>>>0}var{abs:tY,PI:rY}=Math;function aY(r,e,t,i){let o=iY(r,t,i),n=iY(e,t,i);return lY(o,n)}function iY(r,e,t){let i={x:(r.x-e.x)/t,y:-(r.y-e.y)/t},o=i.x*i.x+i.y*i.y,n=Math.sqrt(o);return o<1?new Ae(i.x,-i.y,Math.sqrt(1-o)):new Ae(i.x/n,-i.y/n,0)}function sY(r,e,t){let i=oY(r,t),o=oY(e,t);return lY(i,o)}function oY(r,e){let t={x:r.x-e.x,y:r.y-e.y},i=Math.hypot(t.x,t.y);return i===0?new Ae(1,0,0):new Ae(t.x/i,t.y/i,0)}function ppe(r){let e=r.elements,t=new Ae(e[3],e[4],e[5]).normalize(),i=new Ae(e[6],e[7],e[8]),o=new Ae().crossVectors(t,i).normalize();i.crossVectors(o,t).normalize();let n=new Go;return n.set(o.x,t.x,i.x,o.y,t.y,i.y,o.z,t.z,i.z),n}function vw(r,e){let t=r.clone().transpose(),i=new Go().multiplyMatrices(t,e),o=new Go().multiplyMatrices(i,r);return ppe(o)}function lY(r,e){let t=e.clone();t.cross(r);let i=t.length(),o=e.dot(r),n=1-o;i>0&&(t.x=t.x/i,t.y=t.y/i,t.z=t.z/i);let a=new Go;return a.set(n*t.z*t.z+o,n*t.z*t.x-i*t.y,n*t.y*t.z+i*t.x,n*t.z*t.x+i*t.y,n*t.x*t.x+o,n*t.y*t.x-i*t.z,n*t.y*t.z-i*t.x,n*t.y*t.x+i*t.z,n*t.y*t.y+o),a}var{sin:tS,cos:pI}=Math;function uu(){let r=Cw(-(11*Math.PI)/16);return nb(Math.PI/8).multiply(r)}function uI(){let r=Cw(-Math.PI/2);return nb(Math.PI/2).multiply(r)}function Cw(r){let e=new Go;return e.set(pI(r),-tS(r),0,tS(r),pI(r),0,0,0,1),e}function nb(r){let e=new Go;return e.set(pI(r),0,-tS(r),0,1,0,tS(r),0,pI(r)),e}function UF(r){let e=r.elements,t=e[0]+e[4]+e[8];if(t<3){let i=Math.acos(.5*(t-1)),o=2*tS(i),n=(e[5]-e[7])/o,a=(e[6]-e[2])/o,s=(e[1]-e[3])/o;return{axis:new Ae(n,a,s),angle:i}}return{axis:new Ae(0,0,-1),angle:0}}function cY(r,e){let t=__dcg_shared_module_exports__['Rc'](r,e),i=new Go;return i.elements=t,i}function nY(r,e){return e*Math.floor(r/e+.5)}function hI(r){let e=Sp?.06:.03,t=new rr().setFromMatrix3(r),{y:i,z:o}=new tc(0,0,0,"YXZ").setFromRotationMatrix(t),n=nY(i,rY/2),a=nY(o,rY/2),s=tY(i-n)<e,l=tY(o-a)<e,c;if(s||l){let d=s?n:i,p=l?a:o,g=new tc(0,d,p,"YXZ"),h=new rr().makeRotationFromEuler(g);c=new Go().setFromMatrix4(h)}else c=r;return{matrix:c,isXYsnapped:l,isZsnapped:s}}var upe=new URLSearchParams(window.location.search),dY=(r,e)=>{let t=upe.get(r);return t===null?e:Number(t)},pY=dY("scrollZoomRecenterAggressiveness",.2),hpe=dY("buttonZoomRecenterAggressiveness",.1),mI=class{constructor(e,t){this.viewport=e;this.grapher3d=t;this.s=uc(()=>this.grapher3d.settings.config.language)}isDefaultViewportRestored(){return this.grapher3d.isDefaultDomain()}getCurrentDomain(){var e,t;return{xmin:this.viewport.xmin,xmax:this.viewport.xmax,ymin:this.viewport.ymin,ymax:this.viewport.ymax,zmin:(e=this.viewport.zmin)!=null?e:__dcg_shared_module_exports__['kc'].zmin,zmax:(t=this.viewport.zmax)!=null?t:__dcg_shared_module_exports__['kc'].zmax}}animateToDomain(e){let t=this.getCurrentDomain(),i=this.grapher3d.transition;i.isZooming||(i.isZooming=!0,i.startTime=window.performance.now(),i.duration=150,i.zoom0=t,i.zoom1=e,this.grapher3d.startZoom())}setDefaultViewport(){this.animateToDomain(new __dcg_shared_module_exports__['$c']),Te(this.s("graphing-calculator-narration-viewport-default"))}setViewport(e){var n,a;if(!e.isValid({xAxisScale:"linear",yAxisScale:"linear"})||!e.isZValid())return;let i=e.toObject();e=di.fromObject(fpe({...i,zmin:(n=i.zmin)!=null?n:__dcg_shared_module_exports__['kc'].zmin,zmax:(a=i.zmax)!=null?a:__dcg_shared_module_exports__['kc'].zmax})),this.grapher3d.controller.getGrapher2d().viewportController.setViewport(e),this.viewport=e,this.grapher3d.controller.requestRedrawGraph()}getViewport(){return this.viewport}setScreen(){}zoom(e){let t=this.getCurrentDomain(),i=this.grapher3d.transition;switch(e){case"in":{if(i.isZooming)return;i.isZooming=!0,i.startTime=window.performance.now(),i.duration=150,i.zoom0=t,i.zoom1=rS(t,1/2),this.grapher3d.startZoom(),Te(this.s("graphing-calculator-narration-viewport-zoom-in"))}break;case"out":{if(i.isZooming)return;i.isZooming=!0,i.startTime=window.performance.now(),i.duration=150,i.zoom0=t,i.zoom1=KF(t,2,hpe),this.grapher3d.startZoom(),Te(this.s("graphing-calculator-narration-viewport-zoom-out"))}break;case"square":this.grapher3d.settings.setProperty("squareAxes",!0),this.animateToDomain(gpe(this.getCurrentDomain())),Te(this.s("graphing-calculator-narration-viewport-zoom-square"));break;case"default":this.setDefaultViewport();break;case"default3dOrientation":this.animateToOrientation(uu()),Te(this.s("graphing-calculator-narration-viewport-zoom-3d-default"));break;case"xy3dOrientation":this.animateToOrientation(uI()),Te(this.s("graphing-calculator-narration-viewport-zoom-3d-xy"));break;case"recenter":this.animateToDomain(mpe(this.getCurrentDomain())),Te(this.s("graphing-calculator-narration-viewport-zoom-recenter"));break;default:}}animateToOrientation(e){this.grapher3d.settings.setProperty("speed3D",0),this.grapher3d.settings.setProperty("worldRotation3D",[...e.elements]),this.grapher3d.controls.animateToOrientation(e)}zoomSquareImmediately(){}remove(){}beginPanning(){}zoomCustom(e){}getProjection(){return this.grapher3d.getProjection()}};function rS(r,e,t){let{xwidth:i,ywidth:o,zwidth:n}=bpe(r);return uY(r,{xwidth:i*e,ywidth:o*e,zwidth:n*e},t)}function KF(r,e,t,i=new Ae(0,0,0)){let o=new Ae((r.xmax+r.xmin)/2,(r.ymax+r.ymin)/2,(r.zmax+r.zmin)/2),n=new Ae(i.x<o.x?r.xmax:r.xmin,i.y<o.y?r.ymax:r.ymin,i.z<o.z?r.zmax:r.zmin),a=0;for(let d of["x","y","z"])Math.abs(n[d]-i[d])>Math.abs(a)&&o[d]!==i[d]&&(a=(n[d]-i[d])/(o[d]-i[d]));let s=o.clone().sub(i).multiplyScalar(a).add(i);s.lerp(o,1-t);for(let d of["x","y","z"]){let p=r[`${d}min`],g=r[`${d}max`];p===0||g===0?s[d]=0:p===-g&&(s[d]=o[d])}let l=rS(r,e,s),c=new Ae((l.xmax+l.xmin)/2,(l.ymax+l.ymin)/2,(l.zmax+l.zmin)/2);return c.x<i.x!=o.x<i.x&&(l.xmax=.5*(l.xmax-l.xmin),l.xmin=-l.xmax),c.y<i.y!=o.y<i.y&&(l.ymax=.5*(l.ymax-l.ymin),l.ymin=-l.ymax),c.z<i.z!=o.z<i.z&&(l.zmax=.5*(l.zmax-l.zmin),l.zmin=-l.zmax),l}function gpe(r){let e=r.xmax-r.xmin;return uY(r,{xwidth:e,ywidth:e,zwidth:e})}function uY(r,{xwidth:e,ywidth:t,zwidth:i},o){let n=new __dcg_shared_module_exports__['$c'];return[n.xmin,n.xmax]=zF(r.xmin,r.xmax,e,o==null?void 0:o.x),[n.ymin,n.ymax]=zF(r.ymin,r.ymax,t,o==null?void 0:o.y),[n.zmin,n.zmax]=zF(r.zmin,r.zmax,i,o==null?void 0:o.z),n}function mpe(r){let e=new __dcg_shared_module_exports__['$c'];return e.xmax=.5*(r.xmax-r.xmin),e.xmin=-e.xmax,e.ymax=.5*(r.ymax-r.ymin),e.ymin=-e.ymax,e.zmax=.5*(r.zmax-r.zmin),e.zmin=-e.zmax,e}function fpe(r){let e=new __dcg_shared_module_exports__['$c'];return[e.xmin,e.xmax]=gI(r.xmin,r.xmax),[e.ymin,e.ymax]=gI(r.ymin,r.ymax),[e.zmin,e.zmax]=gI(r.zmin,r.zmax),e}var ep=134e3,hY=134e-6;function gY(r,e,t,i){return t=__dcg_shared_module_exports__['Cb'](t,hY,ep),i=i!=null?i:r===0||e===0?0:(r+e)/2,r=i+(r-i)/(e-r)*t,e=r+t,[r,e]}function zF(r,e,t,i){return[r,e]=gY(r,e,t,i),gI(r,e)}function gI(r,e){r<-ep/2&&(e<-ep/4&&(e+=-ep/2-r,e=Math.min(ep/2,e)),r=-ep/2),e>ep/2&&(r>ep/4&&(r+=ep/2-e,r=Math.max(-ep/2,r)),e=ep/2);let t=hY*Math.max(1,Math.abs(r),Math.abs(e));return e-r<t?gY(r,e,t):[r,e]}function bpe(r){let{xmin:e,xmax:t,ymin:i,ymax:o,zmin:n,zmax:a}=r;return{xwidth:t-e,ywidth:o-i,zwidth:a-n}}qt();var{abs:tp,min:yY,acos:mY,hypot:xY,PI:rp}=Math,ype=1e3,Ih={NONE:-1,ROTATE:0},xpe={type:"start"},wpe={type:"end"},fY=50,vpe=5*Math.PI/180,fI=class extends ec{constructor(t,i,o){super();this.worldRotation3D=uu();this.unsnappedRotation=new Go;this.axis3D=[0,0,1];this.speed3D=0;this.touches=[];this.spinningWorld=t,this.copyWorldRotationToWorld(),this.domElement=o!==void 0?o:document,this.grapher3d=i,this.state=Ih.NONE,this.lastMovedTime=0,this.lastRotateTime=0,this.lastWheelEventTime=0,this.keyStillDown=!1,this.lastAngle=0,this.useVirtualSphere=!1,this.startedOutsideVirtualSphere=!1,this.isXYsnapped=!1,this.isZsnapped=!1,this.dimensions=()=>{let a=this.domElement===document?this.domElement.body:this.domElement,s=a.clientWidth,l=a.clientHeight,c=new Ht(s/2,l/2),d=Math.min(s,l)/2;return{center:c,radius:d,height:l,width:s}},this.onContextMenu=a=>{this.grapher3d.controller.dispatch({type:"blur-focus-location",location:this.grapher3d.controller.getFocusLocation()})},this.onTapStart=a=>{var C,S;let s=a,l=Object.keys(this.touches).length;this.touches=qF(s.touches);let c=Object.keys(this.touches).length,d=i.webglLayer.getPressedAction()!==void 0;if(l<2&&c===2&&!d){this.startPinchZoom();return}if(c>1)return;let{top:p,left:g}=go(this.grapher3d.elt),h=this.touches[0].pageX-g,f=this.touches[0].pageY-p;if(this.isPinchZooming()||(C=this.grapher3d)!=null&&C.transition.isOrienting)return;this.grapher3d.controller.dispatch({type:"set-none-selected"}),i.webglLayer.setMouse({x:h,y:f}),i.webglLayer.pickAtMouseAndReadResults();let y=(S=i.webglLayer.getPickResult())==null?void 0:S.id;if(y){let v=i.controller.getItemModel(y);if(v&&v.type==="expression"&&cs(v))return}this.state=Ih.ROTATE,this.speed3D=0,this.invert=void 0;let{center:x,radius:E}=this.dimensions();this.startedOutsideVirtualSphere=xY(h-x.x,f-x.y)>=E,this.unsnappedRotation.copy(this.worldRotation3D),this.useVirtualSphere=s.shiftKey&&!!pr("beta3d")||!this.isHorizonLevel(),this.state!==Ih.NONE&&(this.grapher3d.isDragging=!0,ie(document).on("dcg-tapmove",this.onTapMove),ie(document).on("dcg-tapend",this.onTapUp),ie(document).on("dcg-tapcancel",this.onTapUp),this.dispatchEvent(xpe))},this.onTapMove=a=>{var E;let s=a,l=s.changedTouches[0].identifier,c=s.changedTouches[0],d=this.touches.find(C=>C.identifier===l)||c;this.touches=qF(s.touches);let{top:p,left:g}=go(this.grapher3d.elt),h=new Ht(d.pageX-g,d.pageY-p),f=new Ht(c.pageX-g,c.pageY-p);if(this.isPinchZooming()){this.updatePinchZoom();return}if((E=this.grapher3d)!=null&&E.transition.isOrienting||this.state!=Ih.ROTATE)return;let y=f.x-h.x,x=f.y-h.y;if(y!==0||x!==0){let C,{center:S,radius:v,height:M,width:A}=this.dimensions();if(this.useVirtualSphere)C=this.startedOutsideVirtualSphere?sY(f,h,S):aY(f,h,S,v),C=vw(this.worldRotation3D,C),this.setWorldRotation(this.worldRotation3D.multiply(C));else{if(this.invert===void 0){this.invert=f.y>S.y?1:-1;let de=new Ae(0,0,1).applyMatrix3(this.worldRotation3D);de.x>.7&&(this.invert*=-1),tp(de.x)<.7&&(this.invert=de.z<-.7?-1:1)}let R=y/A*rp*this.invert,H=x/M*rp,O=Cw(R),q=nb(H);q=vw(this.unsnappedRotation,q),tp(x)>2*tp(y)?this.unsnappedRotation.multiply(q):tp(y)>2*tp(x)?this.unsnappedRotation.multiply(O):this.unsnappedRotation.multiply(q).multiply(O);let{matrix:w,isXYsnapped:T,isZsnapped:B}=hI(this.unsnappedRotation);this.setWorldRotation(w),this.isXYsnapped=T,this.isZsnapped=B,q=nb(H),q=vw(this.worldRotation3D,q),C=tp(x)>tp(y)?q:O}let{axis:I,angle:P}=UF(C),_=s.timeStamp,U=(_-this.lastMovedTime)*.001;this.axis3D=[I.x,I.y,I.z],this.useVirtualSphere&&this.snapSpinAxisIfClose();let Y=240*(rp/180);this.speed3D=__dcg_shared_module_exports__['Cb'](P/U,-Y,Y),this.lastAngle=0,this.lastMovedTime=_,tp(this.speed3D)<vpe&&(this.speed3D=0)}else this.lastMovedTime+fY<s.timeStamp&&(this.speed3D=0)},this.onTapUp=a=>{var d;let s=a,l=Object.keys(this.touches).length;this.touches=qF(s.touches);let c=Object.keys(this.touches).length;l===2&&c<2&&this.isPinchZooming()&&this.stopPinchZoom(),!((d=this.grapher3d)!=null&&d.transition.isOrienting)&&(c>0||(this.lastMovedTime+fY<s.timeStamp&&!this.isPinchZooming()&&(this.speed3D=0),this.grapher3d.isDragging=!1,ie(document).off("dcg-tapmove",this.onTapMove),ie(document).off("dcg-tapend",this.onTapUp),ie(document).off("dcg-tapcancel",this.onTapUp),this.dispatchEvent(wpe),this.grapher3d.debounceUserRequestedRotationChange(),this.state=Ih.NONE,this.grapher3d.controller.dispatch({type:"render"})))},this.onMouseWheel=a=>{var v,M;let s=a;if(this.state!==Ih.NONE||this.isLocked()||s.deltaY===0)return;s.preventDefault(),this.lastWheelEventTime===0&&this.grapher3d.startZoom(),this.lastWheelEventTime=window.performance.now();let l=this.grapher3d.webglLayer.domain(),c=this.grapher3d.webglLayer.getMouse(),d=Date.now(),p=this.speed3D!==0,g=s.deltaY<0?"in":"out",h=this.currentZoomAction&&d-this.currentZoomAction.lastChangeTime>ype;if(!this.currentZoomAction||this.currentZoomAction.input.type!=="pointer"||this.currentZoomAction.input.x!==(c==null?void 0:c.x)||this.currentZoomAction.input.y!==(c==null?void 0:c.y)||this.currentZoomAction.isSpinning!==p||g==="in"&&this.currentZoomAction.initialDirection==="out"||h){let A=g==="in"?(v=this.grapher3d.webglLayer.getZoomScrollWheelPickResult())==null?void 0:v.point:void 0;this.currentZoomAction={lastChangeTime:d,start:l,input:{type:"pointer",...c},isSpinning:p,center:A==null?void 0:A.clone(),initialDirection:g}}else this.currentZoomAction&&(this.currentZoomAction.lastChangeTime=d);let f=(M=this.currentZoomAction)==null?void 0:M.center,y=this.currentZoomAction.start.xmax-this.currentZoomAction.start.xmin,x=l.xmax-l.xmin;if(this.currentZoomAction.initialDirection==="in"&&g==="out"&&x>=y){let A=this.currentZoomAction.start;delete this.currentZoomAction,l=A,f=void 0}if(!f){let A=l.xmin<=0&&l.xmax>=0,I=l.ymin<=0&&l.ymax>=0,P=l.zmin<=0&&l.zmax>=0;A&&I&&P&&(f=new Ae(0,0,0))}let E=1.05,C;g==="out"&&(!f||f.lengthSq()===0)?C=KF(l,E,pY):C=rS(l,s.deltaY<0?1/E:E,f);let S=new di(C.xmin,C.xmax,C.ymin,C.ymax,C.zmin,C.zmax);this.updateViewport(S),this.copyWorldRotationToWorld(),this.grapher3d.webglLayer.updateAxes(),this.grapher3d.controller.dispatch({type:"render"})};let n={passive:!1};this.onTouchStart=a=>{a.preventDefault()},this.domElement.addEventListener("touchstart",this.onTouchStart,n),ie(this.domElement).on("dcg-tapstart",this.onTapStart),ie(this.domElement).on("contextmenu",this.onContextMenu),this.domElement.addEventListener("wheel",this.onMouseWheel)}keyUp(){this.keyStillDown=!1,this.speed3D&&Te(this.grapher3d.controller.s("graphing-calculator-narration-3d-rotation-speed",{speed:Math.ceil(this.speed3D*180/rp)}))}applyTiltFromKeyboard(t,i){var d;if(this.isPinchZooming()||(d=this.grapher3d)!=null&&d.transition.isOrienting)return;this.grapher3d.controller.dispatch({type:"set-none-selected"});let o={Up:this.grapher3d.controller.s("graphing-calculator-narration-3d-rotate-up"),Down:this.grapher3d.controller.s("graphing-calculator-narration-3d-rotate-down"),Left:this.grapher3d.controller.s("graphing-calculator-narration-3d-rotate-left"),Right:this.grapher3d.controller.s("graphing-calculator-narration-3d-rotate-right")},n=p=>{let g=nb(p);g=vw(this.unsnappedRotation,g),this.unsnappedRotation.multiply(g)},a=p=>{this.unsnappedRotation.multiply(Cw(p))},s=p=>{let g=nb(p);return vw(this.worldRotation3D,g)},l=p=>Cw(p);if(t===this.lastKeyboardDirection&&this.keyStillDown)if(this.speed3D===0){let p,g=2*rp/180;switch(t){case"Up":p=s(-g);break;case"Down":p=s(+g);break;case"Left":p=l(-g);break;case"Right":p=l(+g);break}let{axis:h,angle:f}=UF(p);this.axis3D=[h.x,h.y,h.z],this.speed3D=f}else{let p=240*(rp/180);this.speed3D=__dcg_shared_module_exports__['Cb'](this.speed3D*1.1,-p,p)}else if(this.speed3D)this.lastKeyboardDirection=void 0,this.keyStillDown=!0,this.speed3D=0,Te(this.grapher3d.controller.s("graphing-calculator-narration-3d-rotation-stopped"));else{this.lastKeyboardDirection=t,this.keyStillDown=!0,Te(o[t]);let p=rp/180;switch(t){case"Up":n(-p);break;case"Down":n(+p);break;case"Left":a(-p);break;case"Right":a(+p);break}let{matrix:g,isXYsnapped:h,isZsnapped:f}=hI(this.unsnappedRotation);this.setWorldRotation(g),this.isXYsnapped=h,this.isZsnapped=f,this.lastAngle=0}}isPinchZooming(){var t;return((t=this.currentZoomAction)==null?void 0:t.input.type)==="pinch"}startPinchZoom(){if(this.isLocked()||this.isPinchZooming())return;let t=__dcg_shared_module_exports__['Z'](this.touches);this.grapher3d.controller.dispatch({type:"set-none-selected"}),this.grapher3d.startZoom(),this.currentZoomAction={lastChangeTime:Date.now(),start:this.grapher3d.webglLayer.domain(),center:void 0,input:{type:"pinch",pinchZoomStartPositions:t},isSpinning:this.speed3D!==0,initialDirection:void 0}}stopPinchZoom(){this.isPinchZooming()&&(this.currentZoomAction=void 0,this.grapher3d.endZoom(),this.grapher3d.controller.dispatch({type:"render"}))}updatePinchZoom(){var s;if(((s=this.currentZoomAction)==null?void 0:s.input.type)!=="pinch")return;let t=bY(this.currentZoomAction.input.pinchZoomStartPositions),o=bY(this.touches)/t;if(!isFinite(o))return;let n=rS(this.currentZoomAction.start,1/o),a=new di(n.xmin,n.xmax,n.ymin,n.ymax,n.zmin,n.zmax);this.updateViewport(a),this.copyWorldRotationToWorld()}snapSpinAxisIfClose(){if(!this.grapher3d.settings.showAxis3D)return;let[t,i,o]=this.axis3D,n=.97;t>n&&(this.axis3D=[1,0,0]),i>n&&(this.axis3D=[0,1,0]),o>n&&(this.axis3D=[0,0,1]),t<-n&&(this.axis3D=[-1,0,0]),i<-n&&(this.axis3D=[0,-1,0]),o<-n&&(this.axis3D=[0,0,-1])}copyWorldRotationToWorld(){this.spinningWorld.setRotationFromMatrix(new rr().setFromMatrix3(this.worldRotation3D))}update(){return!0}dispose(){ie(this.domElement).off("dcg-tapstart",this.onTapStart),ie(document).off("dcg-tapmove",this.onTapMove),ie(document).off("dcg-tapend",this.onTapUp),ie(document).off("dcg-tapcancel",this.onTapUp),this.domElement.removeEventListener("wheel",this.onMouseWheel),this.domElement.removeEventListener("touchstart",this.onTouchStart)}setWorldRotation(t){this.worldRotation3D=t,this.copyWorldRotationToWorld();let{isXYsnapped:i,isZsnapped:o}=hI(t);this.isXYsnapped=i,this.isZsnapped=o}isHorizonLevel(){let t=new Ae(0,0,1).applyMatrix3(this.worldRotation3D);return tp(t.y)<1e-4}compareWorldRotationTo(t){let i=new rr().setFromMatrix3(this.worldRotation3D),o=new rr().setFromMatrix3(t),n=new tc(0,0,0,"YXZ").setFromRotationMatrix(i),a=new tc().setFromRotationMatrix(o),s=new od().setFromEuler(n).normalize(),l=new od().setFromEuler(a).normalize(),c=yY(tp(s.dot(l)),1);return 2*mY(c)*(180/rp)}isDefaultOrientation(){let t=this.compareWorldRotationTo(uu());return this.speed3D===0&&t<1}isXYPlaneOrientation(){let t=this.compareWorldRotationTo(uI());return this.speed3D===0&&t<.001}animateToOrientation(t){let i=this.grapher3d;this.speed3D=0;let o=i.transition,n=new rr().setFromMatrix3(this.worldRotation3D),a=new rr().setFromMatrix3(t),s=new tc().setFromRotationMatrix(a),l=new tc(0,0,0,"YXZ").setFromRotationMatrix(n);o.q0.setFromEuler(l),o.q1.setFromEuler(s);let c=o.q0.clone().normalize(),d=o.q1.clone().normalize(),p=2*mY(tp(c.dot(d)))*(180/rp);o.isOrienting=!0,o.startTime=window.performance.now(),o.duration=150*__dcg_shared_module_exports__['Cb'](p/30,1,3)}updateViewport(t){let i=this.grapher3d,o=i.controller.getGrapher2d();i.viewportController.setViewport(t),i.debounceUserRequestedViewportChange(),o.viewportController.setViewport(t),o.redrawAllLayersSynchronously(),i.webglLayer.updatePlaneMap(),i.webglLayer.updateDomainObjects()}isLocked(){return this.grapher3d.controller.getGraphSettings().userLockedViewport}},bI=class{constructor(){this.isZooming=!1;this.zoom0=new __dcg_shared_module_exports__['$c'];this.zoom1=new __dcg_shared_module_exports__['$c'];this.isOrienting=!1;this.q0=new od;this.q1=new od;this.objectIdExtendingTo3D=void 0;this.startTime=0;this.duration=0}};function wY(r){let e=r.grapher3d,t=e.transition;if(e.settings.threeDMode){if(r.lastWheelEventTime!=0&&(window.performance.now()-r.lastWheelEventTime)*.001>.1&&(r.lastWheelEventTime=0,e.endZoom()),t.isZooming){let{zoom0:i,zoom1:o}=t,n=window.performance.now(),a=yY(1,(n-t.startTime)/t.duration),s=new di(a*o.xmin+(1-a)*i.xmin,a*o.xmax+(1-a)*i.xmax,a*o.ymin+(1-a)*i.ymin,a*o.ymax+(1-a)*i.ymax,a*o.zmin+(1-a)*i.zmin,a*o.zmax+(1-a)*i.zmax);a>=1&&(e.endZoom(),t.isZooming=!1),r.updateViewport(s)}if(t.isOrienting){let o=(window.performance.now()-t.startTime)/t.duration;if(o>=1){let n=new rr().makeRotationFromQuaternion(t.q1);r.setWorldRotation(new Go().setFromMatrix4(n)),t.isOrienting=!1,e.controller.dispatch({type:"render"})}else{let n=t.q0.clone().slerp(t.q1,o),a=new rr().makeRotationFromQuaternion(n);r.setWorldRotation(new Go().setFromMatrix4(a)),r.unsnappedRotation.copy(r.worldRotation3D)}}if(t.objectIdExtendingTo3D&&t.startTime>0){let i=r.grapher3d.webglLayer,o=t.objectIdExtendingTo3D,n=i.domain(),{zmin:a,zmax:s}=n,c=(window.performance.now()-t.startTime)/t.duration;c>=1?(i.setZboundsOnSurfaces(o,-1/0,1/0),t.objectIdExtendingTo3D=void 0):i.setZboundsOnSurfaces(o,c*a,c*s),e.controller.requestRedrawGraph()}if(r.speed3D===0)r.lastRotateTime=window.performance.now();else{let i=window.performance.now(),o=(i-r.lastRotateTime)*.001,n=r.lastRotateTime!=0&&o<2?o*r.speed3D:0;if(n>20*rp/180&&(n=20*rp/180),r.state===Ih.NONE){let a=r.axis3D,s=new Ae(a[0],a[1],a[2]),l=cY(s,n);r.setWorldRotation(r.worldRotation3D.multiply(l)),r.unsnappedRotation.copy(r.worldRotation3D)}r.lastRotateTime=i,r.lastAngle=n}}}function bY(r){return r.length!==2?NaN:xY(r[0].pageX-r[1].pageX,r[0].pageY-r[1].pageY)}function qF(r){return __dcg_shared_module_exports__['Z'](r)}function vY(r,e=.01*(r.xmax-r.xmin)){return e*=2,Math.abs(r.xmin+r.xmax)<=e&&Math.abs(r.ymin+r.ymax)<=e&&Math.abs(r.zmin+r.zmax)<=e}var{abs:WF,min:SY,max:yI,sqrt:Ape,tan:$F,atan:DY,PI:Vpe}=Math,YF=new URLSearchParams(window.location.search),kY=YF.has("peel-layers")?parseInt(YF.get("peel-layers")):void 0,XF=YF.get("debug3dRender"),_Y=XF&&XF.includes("pick"),CI=50,GY=6.75,sd=_Y?5:1,iS=_Y?5:1,oS=class{constructor(e,t){this.pickingColorManager=new dI;this.perspective=1;this.debugOnlyMeasureGPUTiming=!1;this.lastRenderInfo={triangles:0,bufferUploads:0,bufferUploadItems:0,startTimeCPU:0,durationCPU:0};this.mainCopyOutputPass=new Mh(sI);this.concatPass=new Mh(Jj);this.debug=new aI({filter:XF});this.pickingPassCacheKey="";this.pickResult={pickingReadCacheKey:""};this.worldViewCacheKeyInfo={math:[new Ae(0,0,0),new Ae(1,0,0),new Ae(0,1,0),new Ae(0,0,1)],clip:[new Ae(0,0,0),new Ae(1,0,0),new Ae(0,1,0),new Ae(0,0,1)]};this.domainObjectUpdates=0;this.surfaces={},this.renderedTabTargets={},this.renderedTabTargetOrder=[],this.isTrackingPressedAction=!1,this.scene=new Th,this.spinningWorld=new Rn,this.world=new Rn,this.spinningWorld.add(this.world),this.scene.add(this.spinningWorld),this.controller=t,this.materialManager=new eI,this.cameraDistance=CI,this.camera=new am,this.axesMaterials=Vj(this.materialManager.getGlobalUniforms()),this.setBackgroundColor(t.getGraphSettings().backgroundColor3d),this.canvas=e,this.renderer=Lpe(this.canvas),this.mainRenderTarget=new oc(this.canvas.width,this.canvas.height,{colorSpace:Zl,samples:4}),this.mainCopyOutputPass.defines.SRGB_COLOR_SPACE=!1;let i=new uw(4210752,Math.PI);this.scene.add(i);let o=2.8,n=new cm(16777215,o);n.position.set(-1,1,1),this.scene.add(n);let a=new cm(16777215,o);a.position.set(-1,-1,0),this.scene.add(a),this.gridMaterials=Bj(this.materialManager.getGlobalUniforms()),this.updateDomainObjects(),this.initPickingTargets(),this.initDepthPeel()}getNumberOfSurfaces(){return Object.keys(this.surfaces).length}showPlane(e){this.domainPlane!==void 0&&(e?this.world.add(this.domainPlane):this.world.remove(this.domainPlane))}showBox(e){e?this.world.add(this.domainBox):this.world.remove(this.domainBox);for(var t in this.surfaces)this.deleteSurface(t)}showAxes(e){e?this.world.add(this.domainAxes):this.world.remove(this.domainAxes)}updateCamera(){let e=this.canvas.width/this.canvas.height,t=this.controller.getPerspectiveDistortion();if(t===0&&!(this.camera instanceof Sh)?this.depthPeel.camera=this.camera=new Sh:t!==0&&!(this.camera instanceof am)&&(this.depthPeel.camera=this.camera=new am),this.camera instanceof am){let i=Vpe/360,o=GY/SY(e,1);this.cameraDistance=CI/t,this.camera.position.set(-this.cameraDistance,0,0),this.camera.fov=DY(t*$F(i*o))/i}else this.cameraDistance=50,this.camera.position.set(-this.cameraDistance,0,0),e>1?(this.camera.left=-2.95*e,this.camera.right=2.95*e,this.camera.bottom=-2.95,this.camera.top=2.95):(this.camera.left=-2.95,this.camera.right=2.95,this.camera.bottom=-2.95/e,this.camera.top=2.95/e);this.camera.up.set(0,0,1),this.camera.lookAt(new Ae(0,0,0)),this.camera.updateProjectionMatrix(),this.perspective=t}initDepthPeel(){this.depthPeel=new cI(this.renderer,this.materialManager,this.scene,this.camera,this.debug)}initPickingTargets(){let e=sd,t=iS;this.pickingTargets={id:new oc(e,t,{type:Ha}),x:new oc(e,t,{type:Ha}),y:new oc(e,t,{type:Ha}),z:new oc(e,t,{type:Ha}),combined:new oc(e*4,t,{type:Ha})}}debugOnlyTrackBufferUploads(){let e=this;Ps.prototype.onUploadCallback=function(){e.lastRenderInfo.bufferUploads++,e.lastRenderInfo.bufferUploadItems+=this.array.length}}debugGetPrograms(){return this.renderer.info.programs||[]}getClipAxes(e){return this.controller.getGraphSettings().showBox3D?{x:!0,y:!0,z:!0}:e!=null?e:{x:!1,y:!1,z:!1}}setBackgroundColor(e){this.backgroundColor=new er(e),this.updateBackgroundColor()}updateBackgroundColor(){if(this.controller.invertSwatches()){let{r:e,g:t,b:i}=this.backgroundColor;this.scene.background=new er,this.scene.background.setRGB(1-e,1-t,1-i)}else this.scene.background=this.backgroundColor}domain(){var t,i;let e=this.controller.getGrapher3d();if(e){let o=e.viewportController.getViewport(),n=o.xmin,a=o.xmax,s=o.ymin,l=o.ymax,c=(t=o.zmin)!=null?t:-2,d=(i=o.zmax)!=null?i:2;return{xmin:n,xmax:a,ymin:s,ymax:l,zmin:c,zmax:d}}else return new __dcg_shared_module_exports__['$c']}updateAxes(){this.domainAxes!==void 0&&(this.world.remove(this.domainAxes),VF(this.domainAxes)),this.domainAxes=Oj(this.domain(),this.controller.get2dProjection().screen,this.controller.getGraphSettings().showAxisLabels3D,this.axesMaterials),this.controller.getGraphSettings().showAxis3D&&this.world.add(this.domainAxes)}updateBox(){let e=this.domain();this.domainBox?(this.updateDomainBoxColor(),Lj(this.domainBox,e)):this.domainBox=IF(e,this.getDomainBoxColor(),this.materialManager.getGlobalUniforms());let t=this.controller.getGraphSettings().showBox3D,i=this.domainBox.parent===this.world;t!==i&&(t?this.world.add(this.domainBox):this.world.remove(this.domainBox))}getDomainBoxColor(){var t;return this.controller.isGraphPaperFocused()&&!((t=this.controller.getGrapher3d())!=null&&t.isDragging)&&this.controller.getGrapher2d().poiController.keyboardAttentionManager.getKeyboardAttention()===void 0?this.controller.getInvertedColors()?16777215:0:11184810}updateDomainBoxColor(){let{showBox3D:e}=this.controller.getGraphSettings();if(!e||!this.domainBox)return;let t=this.getDomainBoxColor();t!==this.domainBoxColor&&(this.domainBoxColor=t,this.world.remove(this.domainBox),AF(this.domainBox),this.domainBox=IF(this.domain(),t,this.materialManager.getGlobalUniforms()),this.world.add(this.domainBox))}updatePlaneMap(){this.disposePlaneTextureIfResized(),this.domainPlaneMaterials!==void 0&&(this.domainPlaneMaterials.xyNumbersMaterial.uniforms.map.value.needsUpdate=!0,this.domainPlaneMaterials.zMaterial.uniforms.map.value.needsUpdate=!0)}disposePlaneTextureIfResized(){let e=this.controller.getGrapher2d().getCanvasNode();this.domainPlaneMaterials&&(e.width!==this.domainPlaneMaterials.width||e.height!==this.domainPlaneMaterials.height)&&(LF(this.domainPlaneMaterials.xyNumbersMaterial),LF(this.domainPlaneMaterials.zMaterial),this.domainPlaneMaterials=void 0)}disposePlane(){this.domainPlane!==void 0&&(this.world.remove(this.domainPlane),Uj(this.domainPlane),this.domainPlane=void 0)}updatePlane(){this.disposePlaneTextureIfResized(),this.disposePlane(),this.domainPlaneMaterials=this.constructDomainMaterials(),this.domainPlaneMaterials&&(this.domainPlane=new tI(this.domain(),this.domainPlaneMaterials,this.controller.getGrapher2d().getProjection(),this.gridMaterials,this.axesMaterials,this.materialManager.getGlobalUniforms()),this.domainPlane.xyPlane&&this.pickingColorManager.setPickingColorForMesh({mesh:this.domainPlane.xyPlane,isPoint:!1,blocksPicking:!0,forceOpaque:!0,branchId:"**dcg_domain_plane_picking_id**"}),(this.controller.showPlane3D()||this.controller.showNumbers3D())&&this.world.add(this.domainPlane))}constructDomainMaterials(){var p,g,h,f,y;let{showNumbers3D:e,showPlane3D:t}=this.controller.getGraphSettings(),i=this.computeDepthPeelLayers()>0;if(this.domainPlaneMaterials!==void 0&&this.domainPlaneMaterials.showPlane3D===t&&this.domainPlaneMaterials.showNumbers3D===e&&this.domainPlaneMaterials.depthPeelingActive===i)return this.domainPlaneMaterials;(g=(p=this.domainPlaneMaterials)==null?void 0:p.xyNumbersMaterial)==null||g.dispose(),(h=this.domainPlaneMaterials)==null||h.xyPlaneMaterial.dispose(),(y=(f=this.domainPlaneMaterials)==null?void 0:f.zMaterial)==null||y.dispose();let o=this.controller.getGrapher2d().getCanvasNode();if(o.width===0||o.height===0)return;let n=this.materialManager.getOrMakeMaterial({type:"domain-plane",spec:{type:"domain-plane-numbers-material",canvas:o,showNumbers:e,transparent:t&&!i}}),a=document.createElement("canvas");a.width=o.width,a.height=o.height;let s=this.materialManager.getOrMakeMaterial({type:"domain-plane",spec:{type:"domain-plane-numbers-material",canvas:a,showNumbers:e,transparent:!1}}),l=this.controller.getGraphSettings().plane3dOpacity,c=Number(l);(l===""||isNaN(c))&&(c=.5),c=__dcg_shared_module_exports__['Cb'](c,.001961,1);let d=this.materialManager.getOrMakeMaterial({type:"domain-plane",spec:{type:"domain-plane-material",opacity:c,transparent:!i,color:new er(16777215)}});return{zCanvas:a,zMaterial:s,xyNumbersMaterial:n,xyPlaneMaterial:d,width:o.width,height:o.height,showNumbers3D:e,showPlane3D:t,depthPeelingActive:i}}computeDepthPeelLayers(){if(kY!==void 0)return kY;for(let e in this.surfaces)if(this.surfaces[e].isTransparent)return this.controller.showPlane3D()?3:2;return 0}updateDomainObjects(){this.domainObjectUpdates++,this.updateAxes(),this.updateBox(),this.updatePlane();let e=this.domain(),{xmin:t,xmax:i,ymin:o,ymax:n,zmin:a,zmax:s}=e;this.spinningWorld.scale.set(4/(i-t),4/(n-o),4/(s-a)),this.world.position.set(-(i+t)/2,-(n+o)/2,-(s+a)/2),this.materialManager.setDomain(e),this.updateDomainObjectsFromCamera()}getZBoundsForAnimationForNewSurface(e){var s;let t=(s=this.controller.getGrapher3d())==null?void 0:s.transition,i=t==null?void 0:t.objectIdExtendingTo3D,{zmin:o,zmax:n}=this.domain(),a=window.performance.now();if(i&&e.startsWith(i+":")){t.startTime<0&&(t.startTime=a);let l=(a-t.startTime)/t.duration;return l>=1?Ah:{zMinForAnimation:l*o,zMaxForAnimation:l*n}}return Ah}setZboundsOnSurfaces(e,t,i){for(let o in this.surfaces)if(o.startsWith(e+":")){let a=this.surfaces[o].mesh.material;this.materialManager.setZBoundsUniform(a,{zMinForAnimation:t,zMaxForAnimation:i})}}deleteSurface(e){let t=this.surfaces[e];if(!t)return;this.world.remove(t.mesh);let i=t.mesh.geometry;Ppe(i)||i.dispose(),delete this.surfaces[e]}getColorShader(e){if(e.startsWith("shader:"))return this.controller.getShader(e.slice(7))}renderPoint3D(e,t,i){let{position:o,radius:n,guid:a}=e;if(n<=0||!isFinite(n))return;let s=this.domain(),{xmin:l,xmax:c,ymin:d,ymax:p,zmin:g,zmax:h}=s,f=this.makeCacheKey(a,s);this.surfaces[t]&&(this.surfaces[t].cacheKey!==f||this.surfaces[t].materialColor!=i)&&this.deleteSurface(t);let[y,x,E]=o,C=n*(c-l)/4,S=n*(p-d)/4,v=n*(h-g)/4;if(!this.surfaces[t]){let M=this.materialManager.getOrMakeMaterial({type:"surface-graph",spec:{type:"surface-material",objectId:t,color:i,opacity:1,colorShader:this.getColorShader(i)},uniforms:{domain:s,clip:this.getClipAxes(),zBoundsForAnimation:Ah,uvRange:[new __dcg_shared_module_exports__['Sc'](0,1),new __dcg_shared_module_exports__['Sc'](0,1)]}}),A=xI(n),I=new Fn(A,M);I.dcgModelMatrix=new rr().makeTranslation(y,x,E).multiply(new rr().makeScale(C,S,v)),this.surfaces[t]={mesh:I,cacheKey:f,isNotInSketchOrder:!1,materialColor:i,isTransparent:!1,isPoint:!0},this.world.add(I)}this.surfaces[t].isNotInSketchOrder=!1}makeCacheKey(e,t){return e+":"+JSON.stringify(t)}renderPointList3D(e,t){let i=this.domain(),{xmin:o,xmax:n,ymin:a,ymax:s,zmin:l,zmax:c}=i,{pressedId:d}=this.pressedActionData(),p=this.highlightedIndex(e),g=t.map(y=>y.color+"_"+y.guid).join(":")+`:${p}:${e===d}`,h=this.makeCacheKey(g,i);if(this.surfaces[e]&&this.surfaces[e].cacheKey!==h&&this.deleteSurface(e),!this.surfaces[e]){let y="",x=this.materialManager.getOrMakeMaterial({type:"surface-graph",spec:{type:"surface-material",objectId:e,color:y,opacity:1,colorShader:this.getColorShader(y)},uniforms:{domain:i,clip:this.getClipAxes(),zBoundsForAnimation:Ah,uvRange:[new __dcg_shared_module_exports__['Sc'](0,1),new __dcg_shared_module_exports__['Sc'](0,1)]}}),E=t[0];if(E.graphMode!==114)return;let C=xI(E.radius),S=new Nn(C,x,t.length);for(var f=0;f<t.length;f++){let v=t[f];if(v.graphMode!==114)return;let[M,A,I]=v.position,P=v.radius,_=this.needsHighlighting(e,f)?sb(v.color,this.highlightAmount(e,f)):v.color,U=P*(n-o)/4,Y=P*(s-a)/4,R=P*(c-l)/4;if(P<=0||!isFinite(P)||xI(P)!==C)return;let O=new rr().makeTranslation(M,A,I).multiply(new rr().makeScale(U,Y,R));S.setMatrixAt(f,O),S.setColorAt(f,new er(_))}this.surfaces[e]={mesh:S,cacheKey:h,isNotInSketchOrder:!1,materialColor:y,isTransparent:!1,isPoint:!0},this.world.add(S)}return this.surfaces[e].isNotInSketchOrder=!1,this.surfaces[e]}renderSphere3D(e,t,i){var U,Y;let{position:o,radius:n,fillOpacity:a,restrictionShader:s,guid:l}=e,c=((U=this.getColorShader(i))==null?void 0:U.source)||"";this.surfaces[t]&&(this.surfaces[t].cacheKey!==l||this.surfaces[t].materialColor!=i||c!=((Y=this.surfaces[t].shader)!=null?Y:""))&&this.deleteSurface(t);let[d,p,g]=o,[h,f,y]=[WF(n[0]),WF(n[1]),WF(n[2])],{xmin:x,xmax:E,ymin:C,ymax:S,zmin:v,zmax:M}=this.domain(),[A,I,P]=[E-x,S-C,M-v],_=2*yI(h/A,f/I,y/P);if(!this.surfaces[t]){let R=this.materialManager.getOrMakeMaterial({type:"surface-graph",spec:{type:"surface-material",objectId:t,color:i,opacity:a,colorShader:this.getColorShader(i),restrictionShader:s},uniforms:{domain:this.domain(),clip:this.getClipAxes(),zBoundsForAnimation:Ah,uvRange:[new __dcg_shared_module_exports__['Sc'](0,1),new __dcg_shared_module_exports__['Sc'](0,1)]}}),H=xI(_),O=new Fn(H,R);O.dcgModelMatrix=new rr().makeTranslation(d,p,g).multiply(new rr().makeScale(h,f,y)),this.surfaces[t]={mesh:O,cacheKey:l,isNotInSketchOrder:!1,materialColor:i,isTransparent:a!==1,shader:c},this.world.add(O)}this.surfaces[t].isNotInSketchOrder=!1}renderCurve3D(e,t,i){var g,h;let{points:o,thickness:n,guid:a}=e,s=jF(e.graphMode);if(n<0||!isFinite(n))return;let l=this.domain(),c=a+":"+JSON.stringify(n)+":"+JSON.stringify(l),d=this.surfaces[t],p=((g=this.getColorShader(i))==null?void 0:g.source)||"";if(d&&(d.cacheKey!==c||d.materialColor!=i||p!=((h=d.shader)!=null?h:""))&&this.deleteSurface(t),!(o===void 0||o.length===0)){if(!this.surfaces[t])if(n!=0){let f=this.materialManager.getOrMakeMaterial({type:"surface-graph",spec:{type:"surface-material",objectId:t,color:i,opacity:1,colorShader:this.getColorShader(i)},uniforms:{domain:l,clip:this.getClipAxes(s),zBoundsForAnimation:Ah,uvRange:[new __dcg_shared_module_exports__['Sc'](0,1),new __dcg_shared_module_exports__['Sc'](0,1)]}}),y=.01*n,[x,E,C]=qj(o,y,l),S=wI(new Float32Array(x),new Float32Array(E),new Uint32Array(C)),v=new Fn(S,f);this.surfaces[t]={mesh:v,cacheKey:c,isNotInSketchOrder:!1,isTransparent:!1,materialColor:i},this.world.add(v)}else{let f=[],y=o.length/3;for(let S=0;S<y-1;S++){let v=o.slice(3*S,3*S+6);v.every(M=>!isNaN(M))&&f.push(v[0],v[1],v[2],v[3],v[4],v[5])}let x=this.materialManager.getOrMakeMaterial({type:"curve-graph",spec:{type:"curve-material",objectId:t,color:i},uniforms:{domain:l,clip:this.getClipAxes(),zBoundsForAnimation:Ah,uvRange:[new __dcg_shared_module_exports__['Sc'](0,1),new __dcg_shared_module_exports__['Sc'](0,1)]}}),E=new Wa;E.setAttribute("position",new ao(f,3));let C=new um(E,x);this.surfaces[t]={mesh:C,cacheKey:c,isNotInSketchOrder:!1,materialColor:i,isTransparent:!1,shader:p},this.world.add(C)}this.surfaces[t].isNotInSketchOrder=!1}}renderVector3D(e,t,i,o){var A,I;let n=this.isClickable(t),a=t===this.pressedActionData().pressedId,s=this.highlightedIndex(t),l=t+`:${i}`,{points:c,thickness:d,guid:p}=e,g=jF(e.graphMode),h=this.domain(),f=JSON.stringify(h),y=`${p}:${f}:${d}:${s}:${a}`,x=this.surfaces[l],E=((A=this.getColorShader(o))==null?void 0:A.source)||"";if(x&&(x.cacheKey!==y||x.materialColor!=o||E!=((I=x.shader)!=null?I:""))&&this.deleteSurface(l),c===void 0||c.length<6||c.length%6!=0)return;this.needsHighlighting(t,i)&&c.length===6&&(o=sb(o,this.highlightAmount(t,i)));let C=s!==void 0&&c.length>6,S=sb(o,this.highlightAmount(t,s)),v=__dcg_shared_module_exports__['V'](o),M=__dcg_shared_module_exports__['V'](S);if(!this.surfaces[l]){let P=c.length>6&&n,_=this.materialManager.getOrMakeMaterial({type:"surface-graph",spec:{type:"surface-material",objectId:l,color:o,opacity:1,colorShader:this.getColorShader(o),vertexColors:C,useVertexPickingColors:P},uniforms:{domain:h,clip:this.getClipAxes(g),zBoundsForAnimation:Ah,uvRange:[new __dcg_shared_module_exports__['Sc'](0,1),new __dcg_shared_module_exports__['Sc'](0,1)]}}),U=P?[]:void 0,Y=.01*d,R=[],H=[],O=[],q=[];for(let B=0;B<c.length;B+=6){let de=new Ae(c[B],c[B+1],c[B+2]),F=new Ae(c[B+3],c[B+4],c[B+5]),[j,pe,le]=$j(de,F,Y,h),ne=R.length/3;if(R.push(...j),H.push(...pe),O.push(...le.map(X=>X+ne)),U==null||U.push(j.length/3),C){let X=B/6===s?M:v;for(let ae=0;ae<j.length/3;ae++)q.push(X[0],X[1],X[2])}}let w=wI(new Float32Array(R),new Float32Array(H),new Uint32Array(O));C&&w.setAttribute("color",new Ps(new Float32Array(q),3));let T=new Fn(w,_);this.surfaces[l]={mesh:T,cacheKey:y,isNotInSketchOrder:!1,isTransparent:!1,materialColor:o,pickingColorVertexCounts:U},this.world.add(T)}this.surfaces[l].isNotInSketchOrder=!1}renderTriangle3D(e,t,i,o){let n=this.isClickable(t),a=t+`:${i}`,s=t===this.pressedActionData().pressedId,l=this.highlightedIndex(t),c=`:${l}:${s}`,d=e.meshData.faces.length/3,{meshData:p}=e,g=sb(o,this.highlightAmount(t,l)),h=__dcg_shared_module_exports__['V'](o),f=__dcg_shared_module_exports__['V'](g),y=[],x=d>1&&n;if(this.needsHighlighting(t,i)&&d===1&&(o=sb(o,this.highlightAmount(t,i))),l!==void 0&&d>1)if(p.colors&&l!=null){let S=p.colors,v=new Float32Array(S),M=9*l,A=255*__dcg_shared_module_exports__['U'](S[M]),I=255*__dcg_shared_module_exports__['U'](S[M+1]),P=255*__dcg_shared_module_exports__['U'](S[M+2]),_=__dcg_shared_module_exports__['Q'](A,I,P),U=sb(_,this.highlightAmount(t,i)),Y=__dcg_shared_module_exports__['V'](U);v.set([...Y,...Y,...Y],M),e={...e,meshData:{...e.meshData,colors:v}}}else{for(let v=0;v<p.faces.length;v+=3){let M=v/3===l?f:h;y.push(M[0],M[1],M[2],M[0],M[1],M[2],M[0],M[1],M[2])}let S=new Float32Array(y);e={...e,meshData:{...e.meshData,colors:S}}}let C=this.renderSurface(e,a,o,x,c);if(x){let S=[];for(let v=0;v<d;v++)S.push(3);C.pickingColorVertexCounts=S}}renderSurface(e,t,i,o=!1,n=""){var x,E,C;this.controller.getGraphSettings().config.wireframe&&(i="wireframe:"+i);let{meshData:a,fillOpacity:s}=e,{uvArgs:l,restrictionShader:c}=e,d=(x=e.extraMeshArgs)!=null?x:[],p=e.uvRange||[new __dcg_shared_module_exports__['Sc'](0,1),new __dcg_shared_module_exports__['Sc'](0,1)],g=jF(e.graphMode),h=((E=this.getColorShader(i))==null?void 0:E.source)||"",f=this.domain(),y=a.guid+n;if(this.surfaces[t]&&(this.surfaces[t].cacheKey!==y||this.surfaces[t].materialColor!=i||h!=((C=this.surfaces[t].shader)!=null?C:"")||a.isDomainCube&&!_pe(f,this.surfaces[t].domain))&&this.deleteSurface(t),!this.surfaces[t]){let S=this.materialManager.getOrMakeMaterial({type:"surface-graph",spec:{type:"surface-material",objectId:t,color:i,opacity:s,colorShader:this.getColorShader(i),vertexColors:!!a.colors,useVertexPickingColors:o,restrictionShader:c,uvArgs:l,extraMeshArgs:d},uniforms:{domain:f,clip:this.getClipAxes(g),uvRange:p,zBoundsForAnimation:a.isDomainCube?Ah:this.getZBoundsForAnimationForNewSurface(t)}});if(a.isDomainCube){let A=f,P=this.controller.getGrapher3d().transition;if(P.objectIdExtendingTo3D&&P.startTime>0){let _=P.objectIdExtendingTo3D;if(_&&t.startsWith(_+":")){let U=this.domain(),{zmin:Y,zmax:R}=U,O=(window.performance.now()-P.startTime)/P.duration;O<1&&(A.zmin=O*Y,A.zmax=O*R)}}a.positions=__dcg_shared_module_exports__['vd'](A).positions}let v=wI(a.positions,a.normals,a.faces);v.setAttribute("uv",new ao(a.uvs,2)),d.length>0&&v.setAttribute("extras",new ao(a.extraAttrs,d.length)),a.colors&&v.setAttribute("color",new Ps(a.colors,3));let M=new Fn(v,S);this.surfaces[t]={mesh:M,cacheKey:y,isNotInSketchOrder:!1,materialColor:i,shader:h,isTransparent:s!==1,domain:f},this.world.add(M)}return this.surfaces[t].isNotInSketchOrder=!1,this.surfaces[t]}projectMathCoordinates(e,t=new Ae){return t.copy(e).applyMatrix4(this.world.matrixWorld).project(this.camera)}finalizeSurface(e){let{branchId:t,surface:i,renderOrder:o,isSurfaceSelected:n}=e;this.pickingColorManager.setPickingColorForMesh({branchId:t,mesh:i.mesh,isPoint:!!i.isPoint,blocksPicking:!1,forceOpaque:!1,pickingColorVertexCounts:i.pickingColorVertexCounts});let a=i==null?void 0:i.mesh.material;i&&a instanceof mm&&(i.mesh.renderOrder=o,a.setEmissiveIntensity(n?.015:0))}needsHighlighting(e,t){if(!this.isClickable(e))return!1;let{keyboardFocusId:i,keyboardFocusIndex:o}=this.getKeyboardFocus(),{pressedId:n,pressedIndex:a}=this.pressedActionData(),s=this.getZoomScrollWheelPickResult(),l=s==null?void 0:s.id,c=s==null?void 0:s.index;return e===l&&t===c||e===i&&t===o||e===n&&t===a}highlightedIndex(e){if(!this.isClickable(e))return;let{keyboardFocusId:t,keyboardFocusIndex:i}=this.getKeyboardFocus(),{pressedId:o,pressedIndex:n}=this.pressedActionData(),a=this.getZoomScrollWheelPickResult(),s=a==null?void 0:a.id,l=a==null?void 0:a.index;if(e===s)return l;if(e===t)return i;if(e===o)return n}highlightAmount(e,t){let{pressedId:i,pressedIndex:o}=this.pressedActionData();return e===i&&t===o?.16:.24}redraw(e,t){var U;let i=this.controller.getGrapher3d();if(i===void 0)return;this.renderedTabTargets={},this.renderedTabTargetOrder=[];let o=this.canvas,n=performance.now(),a=this.lastRenderInfo={bufferUploadItems:0,bufferUploads:0,triangles:0,startTimeCPU:n,durationCPU:0},s=this.renderer;s.setRenderTarget(this.mainRenderTarget),this.updateBackgroundColor(),this.updateDomainObjectsFromCamera(),this.updateCamera();let l=window.devicePixelRatio||1;l!==s.getPixelRatio()&&(s.setPixelRatio(l),i.controls.updateViewport(i.viewportController.getViewport())),this.camera.setViewOffset(o.width/l,o.height/l,0,0,o.width/l,o.height/l),s.setSize(o.width/l,o.height/l);for(let Y in this.surfaces)this.surfaces[Y].isNotInSketchOrder=!0;let c=this.getZoomScrollWheelPickResult();this.isClickable(c==null?void 0:c.id)?i.setLayerClass("clickableObjects","dcg-mouse-over-clickable-object"):i.setLayerClass("clickableObjects",void 0);let d=0;for(let Y of t){let R=e[Y];if(!R||!R.branches)continue;let H=this.controller.isItemSelected(Y),O=this.controller.getItemModel(Y),q=this.isClickable(Y);if((O==null?void 0:O.type)==="expression"&&(uf(O)||qy(O))){let w=this.renderPointList3D(Y,R.branches);if(w){if(d+=1,this.finalizeSurface({branchId:Y,surface:w,renderOrder:d,isSurfaceSelected:H}),q)for(let T=0;T<R.branches.length;T++)this.addTabTarget(O,T);continue}}for(let w in R.branches){d+=1;let T=R.branches[w],B=Y+":"+w,de=T.color,F=parseInt(w);this.needsHighlighting(Y,F)&&(de=sb(de,this.highlightAmount(Y,F))),T.graphMode===130||T.graphMode===103||T.graphMode===104||T.graphMode===105||T.graphMode===106||T.graphMode===107||T.graphMode===108||T.graphMode===109||T.graphMode===110||T.graphMode===111||T.graphMode===112||T.graphMode===113||T.graphMode===210?this.renderSurface(T,B,de):T.graphMode===100||T.graphMode===101||T.graphMode===102||T.graphMode===119||T.graphMode===128?this.renderCurve3D(T,B,de):T.graphMode===114?this.renderPoint3D(T,B,de):T.graphMode===118?this.renderSphere3D(T,B,de):T.graphMode===117?this.renderTriangle3D(T,Y,F,T.color):T.graphMode===129&&this.renderVector3D(T,Y,F,T.color);let j=this.surfaces[B];if(j&&(this.finalizeSurface({branchId:B,surface:j,renderOrder:d,isSurfaceSelected:H}),q))if(T.graphMode===117){let pe=T.meshData.faces.length/3;for(let le=0;le<pe;le++)this.addTabTarget(O,le)}else if(T.graphMode===129&&F===0){let pe=T.points.length/6;for(let le=0;le<pe;le++)this.addTabTarget(O,le)}else this.addTabTarget(O,F)}}let p=2.0001*Ape(3),{xmin:g,xmax:h,ymin:f,ymax:y,zmin:x,zmax:E}=this.domain(),C=new Ae((h+g)/2,(y+f)/2,(E+x)/2),S=4/yI(h-g,y-f,E-x);for(let Y in this.surfaces)if(this.surfaces[Y].isNotInSketchOrder)this.deleteSurface(Y);else if(!this.controller.getGraphSettings().showBox3D){let R=this.surfaces[Y].mesh.geometry;R.boundingSphere===null&&R.computeBoundingSphere();let H=R.boundingSphere;if(H===null)continue;let q=(new Ae().subVectors(C,H.center).length()+H.radius)*S;p=yI(p,q)}let v=this.computeDepthPeelLayers();v>0!==((U=this.domainPlaneMaterials)==null?void 0:U.depthPeelingActive)&&this.updateDomainObjects();let A=this.controller.getPerspectiveDistortion(),I=1e3/(0<A&&A<1?A:1),P=yI(.001,this.cameraDistance-p),_=SY(I,this.cameraDistance+p);this.camera.near=P,this.camera.far=_,this.camera.updateProjectionMatrix(),this.materialManager.setGlobalUniform("dcgRenderMode",El.Default),this.mainRenderTarget.setSize(o.width,o.height),this.renderer.setRenderTarget(this.mainRenderTarget),v>0?(this.depthPeel.render(v),a.triangles=this.depthPeel.triangles):(s.render(this.scene,this.camera),a.triangles=this.renderer.info.render.triangles),v==0&&this.mainCopyOutputPass.render(s,null,this.mainRenderTarget),this.debugOnlyMeasureGPUTiming&&Yj(this.renderer).then(Y=>{a.endTimeGPU=Y}),a.durationCPU=performance.now()-n,this.materialManager.disposeMaterialsNotInScene(this.scene),this.pickingColorManager.disposeColorsNotInScene(this.scene),this.onRenderSpy&&this.onRenderSpy()}updateDomainObjectsFromCamera(){let e=this.controller.getGrapher3d();e&&Fj({axes:this.domainAxes,plane:this.domainPlane,gridMaterials:this.gridMaterials,domain:this.domain(),screen:this.controller.get2dProjection().screen,controls:e.controls,invertedColors:this.controller.getInvertedColors(),isDepthPeelingActive:this.computeDepthPeelLayers()>0})}pickAtMouseAndReadResults(){this.pickingPass(),this.readPickingOutputFromGPU()}getAllSurfaceGeoemtriesCacheKey(){let e="";for(let t in this.surfaces){let i=this.surfaces[t];e+=i.cacheKey}return e+="|domainUpdates:"+this.domainObjectUpdates,e}getPickingCacheKey(){var e,t;return`world:${this.getWorldViewCacheKey()}:mouse:${(e=this.mouse)==null?void 0:e.x},${(t=this.mouse)==null?void 0:t.y}:surfaces:${this.getAllSurfaceGeoemtriesCacheKey()}`}pickingPass(){if(this.controller.getGrapher3d()===void 0)return;let t=this.mouse;if(!t)return;let i=this.pickingPassCacheKey,o=this.getPickingCacheKey();if(i===o)return;this.pickingPassCacheKey=o;let n=this.scene.background,a=this.renderer.getClearColor(new er),s=new Map;this.world.children.forEach(h=>{var f;if(s.set(h,h.visible),h instanceof Fn){let y=h.material;h.visible=!!((f=y.defines)!=null&&f.DCG_SUPPORTS_PICKING)}else h.visible=!1}),this.domainPlane&&s.get(this.domainPlane)&&(this.domainPlane.visible=!0,this.domainPlane.children.forEach(h=>{s.set(h,h.visible),h.visible=h.name==="xy plane"}));let l=window.devicePixelRatio,c=Math.floor(sd/2),d=Math.floor(iS/2),[p,g]=[Math.floor(t.x*l)-c,Math.floor(t.y*l)-d];this.camera.setViewOffset(this.renderer.domElement.width,this.renderer.domElement.height,p,g,sd,iS),this.renderer.setClearColor(new er(0),0),this.scene.background=null,this.materialManager.setGlobalUniform("dcgRenderMode",El.PickingObjectId),this.renderer.setRenderTarget(this.pickingTargets.id),this.renderer.clearColor(),this.renderer.render(this.scene,this.camera),this.materialManager.setGlobalUniform("dcgRenderMode",El.PickingX),this.renderer.setRenderTarget(this.pickingTargets.x),this.renderer.clearColor(),this.renderer.render(this.scene,this.camera),this.materialManager.setGlobalUniform("dcgRenderMode",El.PickingY),this.renderer.setRenderTarget(this.pickingTargets.y),this.renderer.clearColor(),this.renderer.render(this.scene,this.camera),this.materialManager.setGlobalUniform("dcgRenderMode",El.PickingZ),this.renderer.setRenderTarget(this.pickingTargets.z),this.renderer.clearColor(),this.renderer.render(this.scene,this.camera),this.concatPass.uniforms.t0={value:this.pickingTargets.id.texture},this.concatPass.uniforms.t1={value:this.pickingTargets.x.texture},this.concatPass.uniforms.t2={value:this.pickingTargets.y.texture},this.concatPass.uniforms.t3={value:this.pickingTargets.z.texture},this.camera.clearViewOffset(),this.renderer.setClearColor(a),this.scene.background=n,s.forEach((h,f)=>{f.visible=h}),this.concatPass.render(this.renderer,this.pickingTargets.combined,this.pickingTargets.combined)}readPickingOutputFromGPU(){var C,S,v;let e=this.getPickingCacheKey();if(this.pickResult.pickingReadCacheKey===e)return;let t=Math.floor(sd/2),i=Math.floor(iS/2),o=oI(this.renderer,this.pickingTargets.combined,0,0,sd*4,iS),n=eS(o,sd*4,t,i),a=eS(o,sd*4,sd+t,i),s=eS(o,sd*4,2*sd+t,i),l=eS(o,sd*4,3*sd+t,i),c=nI(a),d=nI(s),p=nI(l);if((C=this.debug.get("pick-combined"))==null||C.renderFromTarget(this.renderer,this.pickingTargets.combined,10),n.every(M=>M===0)){this.pickResult={pickingReadCacheKey:e};return}let g=this.pickingColorManager.getDataForPickingColor(n);if(!g){Ii(`Failed to find id for picking color ${n}`),this.pickResult={pickingReadCacheKey:e};return}if(g.blocksPicking){this.pickResult={pickingReadCacheKey:e};return}let h=(v=(S=this.pickResult.result)==null?void 0:S.point)!=null?v:new Ae;if(h.set(c,d,p),g.isPoint){let M=g.mesh,A;M instanceof Nn?(A=new rr,M.getMatrixAt(g.index,A)):A=g.mesh.dcgModelMatrix,h=new Ae(0,0,0).applyMatrix4(A)}let f=g.pickingId.split(":"),y=f.length,x=f[0],E=y>1?parseInt(f[y-1]):-1;this.pickResult={pickingReadCacheKey:e,result:{point:h,id:x,index:E}}}isClickable(e){if(e===void 0)return!1;let t=this.controller.getItemModel(e);return!!Ly(t)}getPickResult(){return this.pickResult.result}getKeyboardFocus(){let e=this.controller.getGrapher2d().poiController.keyboardAttentionManager.getKeyboardAttention(),t=e==null?void 0:e.calcId,i=e==null?void 0:e.listIndex;return{keyboardFocusId:t,keyboardFocusIndex:i}}pressedActionData(){var i,o;let e=(i=this.pressedAction)==null?void 0:i.id,t=(o=this.pressedAction)==null?void 0:o.index;return{pressedId:e,pressedIndex:t}}getZoomScrollWheelPickResult(){if(this.controller.getGrapher3d().controls.speed3D===0)return this.getPickResult()}getMouse(){return this.mouse}setMouse(e){this.mouse=e}getWorldViewCacheKey(){let{math:e,clip:t}=this.worldViewCacheKeyInfo,i="";for(let o=0;o<e.length;o++)this.projectMathCoordinates(e[o],t[o]),i+=`:${t[o].x},${t[o].y}`;return i}baseplaneMultiplier(){let e=GY*(Math.PI/360),t=this.camera instanceof am?DY(this.perspective*$F(e)):e;return 2/($F(t)*-this.camera.position.x)}mathCoordinatesToBufferCoordinates(e){let t=new Ae(e.x,e.y,e.z).applyMatrix4(this.world.matrixWorld).project(this.camera),i=this.canvas,o=i.width/2,n=i.height/2,a=Math.round(t.x*o+o),s=Math.round(t.y*n+n);return{x:a,y:s}}mathCoordinatesToScreenCoordinates(e,t){let i=new Ae(e.x,e.y,e.z).applyMatrix4(this.world.matrixWorld).project(this.camera),o=this.canvas,n=window.devicePixelRatio,a=o.width/n/2,s=o.height/n/2,l=i.x*a+a,c=-i.y*s+s;return(!t||!t.skipRounding)&&(l=Math.round(l),c=Math.round(c)),{x:l,y:c}}_testingGetMeshById(e){let t=this.surfaces[e];return t?t.mesh:void 0}remove(){this.materialManager.disposeAllMaterials(),this.pickingColorManager.disposeColorsNotInScene(new Th),this.domainBox&&AF(this.domainBox),this.domainAxes&&(VF(this.domainAxes),Rj(this.axesMaterials)),this.renderer.dispose(),this.renderer.forceContextLoss()}addTabTarget(e,t){let i=W2(e.id,t);this.renderedTabTargetOrder.indexOf(i)!==-1||this.renderedTabTargets[i]!==void 0||(this.renderedTabTargetOrder.push(i),this.renderedTabTargets[i]={type:e.type,id:e.id,listIndex:t,description:this.getComputedDescription(e,t)})}getOrderedTabTargets(){return this.renderedTabTargetOrder.map(e=>{let t=this.renderedTabTargets[e];return{calcId:t.id,listIndex:t.listIndex,polygonEdge:void 0,description:t.description}})}setPressedAction(e){this.pressedAction=e,e!==void 0&&(this.isTrackingPressedAction=!0);let t=this.controller.getGrapher3d();t&&(t.controls.state=Ih.NONE,t.redrawAllLayers())}getPressedAction(){return this.pressedAction}getComputedDescription(e,t){let i=e.formula&&e.formula.computed_description&&e.formula.computed_description[t];return i&&i!==""?la(i):this.getDescription(e)}getDescription(e){switch(e.formula.expression_type){case"SURFACE":case"SURFACE_AMBIGUOUS":case"SURFACE_CONSTANT_AMBIGUOUS":case"SURFACE_r_\u03B8z":case"SURFACE_r_\u03B8z_AMBIGUOUS":case"SURFACE_z_r\u03B8":case"SURFACE_r_\u03B8\u03C6":case"SURFACE_xyz_uv":case"IMPLICIT_SURFACE":case"IMPLICIT_SURFACE_AMBIGUOUS":return this.controller.raw("surface");case"CURVE3D_xyz_t":case"SLICE":case"SLICE_r\u03B8z_at_z":case"SLICE_zr\u03B8_at_r":case"SLICE_zr\u03B8_at_\u03B8":case"SLICE_zr\u03B8_at_xyz":case"SLICE_r\u03B8\u03C6_at_\u03B8":case"SLICE_r\u03B8\u03C6_at_\u03C6":case"SLICE_r\u03B8\u03C6_at_xyz":case"SLICE_xyz_uv":return this.controller.raw("curve");case"SEGMENT3D":return this.controller.raw("segment");case"VECTOR3D":return this.controller.raw("vector");case"SPHERE3D":return this.controller.raw("sphere");case"POINT3D":case"POINT3D_LIST":return this.controller.raw("point");case"TRIANGLE3D":return this.controller.raw("triangle")}return this.controller.raw("3d object")}};function Lpe(r){let e=new bw({antialias:!0,alpha:!0,preserveDrawingBuffer:!0,canvas:r});return e.setPixelRatio(window.devicePixelRatio||1),e}function jF(r){switch(r){case 106:return{x:!0,y:!0,z:!1};case 107:return{x:!1,y:!0,z:!0};case 108:return{x:!0,y:!1,z:!0};case 110:return{x:!1,y:!1,z:!0};case 112:case 113:case 210:case 128:return{x:!0,y:!0,z:!0};default:return{x:!1,y:!1,z:!1}}}var Ah={zMinForAnimation:-1/0,zMaxForAnimation:1/0};function wI(r,e,t){let i=new Wa;return i.setIndex(r.length<65536?new im(t,1):new om(t,1)),i.setAttribute("position",new ao(r,3)),i.setAttribute("normal",new ao(e,3)),i}var vI=[];function xI(r){let e=r<.02?1:r<.05?2:r<.2?3:r<.8?4:5;if(vI[e]===void 0){let t=Kj(e);vI[e]=wI(t.vertices,t.vertices,t.indices)}return vI[e]}function Ppe(r){return vI.includes(r)}function _pe(r,e){return e!==void 0&&r.xmin===e.xmin&&r.xmax===e.xmax&&r.ymin===e.ymin&&r.ymax===e.ymax&&r.zmin===e.zmin&&r.zmax===e.zmax}function sb(r,e){return __dcg_shared_module_exports__['wd'](r)?r:__dcg_shared_module_exports__['P'](r,e)}var ip=__dcg_shared_module_exports__['e'](te());var hu=class extends ip.Class{template(){return ip.createElement($e,{tooltip:()=>this.props.controller().s("shared-calculator-label-toast-learn-more")},ip.createElement("a",{"aria-label":()=>this.props.controller().s("shared-calculator-label-toast-learn-more"),class:ip.const("dcg-learn-more-link"),href:this.props.href,target:ip.const("_blank")},ip.createElement("i",{class:ip.const("dcg-icon-question-sign"),"aria-hidden":ip.const("true")})))}};var{If:Ope}=Xo.Components,JF=0,nS=CI/8,EI=class extends Xo.Class{init(){this.controller=this.props.controller()}template(){return Xo.createElement("div",{class:Xo.const("dcg-options-menu-section")},Xo.createElement("div",{class:Xo.const("dcg-options-menu-section-title dcg-local-display-preferences-title")},()=>this.controller.s("graphing-calculator-label-display-properties"),Xo.createElement(hu,{href:this.const("https://help.desmos.com/hc/en-us/articles/20301369699981-3D-Graph-Settings#h_01HCFSXHM8S59ETFXB55Y8CZQ5\u2019"),controller:this.props.controller})),Xo.createElement(xt,{onChange:this.bindFn(this.toggleInvertedColors),checked:()=>this.controller.getInvertedColors(),manageFocus:this.const(ft({controller:this.controller,location:{type:"settings",location:"reverse-contrast"}}))},()=>this.controller.s("graphing-calculator-label-settings-reverse-contrast")),Xo.createElement(Ope,{predicate:()=>!!pr("beta3d")},()=>Xo.createElement(xt,{onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showBox3D:!this.controller.getGraphSettings().showBox3D})},checked:()=>!!this.controller.getGraphSettings().showBox3D},()=>this.controller.raw("Clip to box"))),Xo.createElement(xt,{class:()=>"dcg-translucent-surfaces-checkbox",onChange:this.bindFn(this.toggleTranslucentSurfaces),checked:()=>this.controller.getTranslucentSurfaces(),ariaLabel:()=>this.controller.s("graphing-calculator-label-settings-translucent-surfaces"),manageFocus:this.const(ft({controller:this.controller,location:{type:"settings",location:"translucent-surfaces"}}))},()=>this.controller.s("graphing-calculator-label-settings-translucent-surfaces")),Xo.createElement("div",{class:Xo.const("dcg-perspective-slider")},Xo.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-settings-3d-perspective-min"),sticky:this.const(!0),gravity:this.const("s")},Xo.createElement("i",{class:Xo.const("dcg-icon-3d-cube"),"aria-hidden":Xo.const("true")})),Xo.createElement(jf,{min:()=>JF-1,max:()=>nS-1,step:()=>{},value:()=>this.getPerspectiveValue(),ariaLabel:()=>this.controller.s("graphing-calculator-label-settings-3d-perspective-distortion-ratio"),ariaPercent:this.const(!0),onDragUpdate:this.bindFn(this.onDragUpdate),onKeyboardUpdate:this.bindFn(this.onKeyboardUpdate)}),Xo.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-settings-3d-perspective-max"),sticky:this.const(!0),gravity:this.const("s")},Xo.createElement("i",{class:Xo.const("dcg-icon-3d-perspective"),"aria-hidden":Xo.const("true")}))))}toggleTranslucentSurfaces(){this.controller.dispatch({type:"set-translucent-surfaces",value:!this.controller.getTranslucentSurfaces()})}toggleInvertedColors(){this.controller.dispatch({type:"set-inverted-colors",value:!this.controller.getInvertedColors()})}getPerspectiveValue(){return this.controller.getPerspectiveDistortion()-1}onKeyboardUpdate(e){let i=this.getPerspectiveValue();switch(e){case"up":i+=.1;break;case"down":i-=.1;break;case"bigup":i+=.3;break;case"bigdown":i-=.3;break;case"min":i=JF-1;break;case"max":i=nS-1;break}i=__dcg_shared_module_exports__['Cb'](i+1,JF,nS),this.controller.dispatch({type:"set-perspective-distortion",value:i})}onDragUpdate(e){this.controller.dispatch({type:"set-perspective-distortion",value:e+1})}};function NY(r){switch(r){case"parallel":case"perpendicular":case"compass":return!0}return!1}function OY(r){var e;switch(r.type){case"tick":return!1;case"tick-ticker":return!1;case"on-evaluator-changes":return!!((e=r.eventUpdates)!=null&&e.userAction);default:return!0}}var cb=class{constructor(e){this.__nextItemId=0;this.__pendingImageUploads={};this.__lastSelectedIdsForPropagation={};this.nextSubscription=0;this.subscriptions={};this._queuedCallbacks=[];this._hasUnsavedChanges=!1;this.shouldScrollSelectedItemIntoViewAfterDispatch=!1;this.lastParsableObjects={};this.isExpressionSearchStrValidForReplace=!1;this.isExpressionReplaceStrValidForReplace=!1;this.expressionSearchCount=0;this.expressionSearchOpen=!1;this.geoUIActive=!1;this.showConstructionsOpen=!1;this.activeTool="selection";this.geometryGettingStartedMessageState="pick-a-tool";this.activeTokens={selected:void 0,hovered:void 0};this.apiMethodCallStackInfo={apiMethodCallDepth:0,withHistoryReplacementDepth:0};this.canShowKeyboardShortcuts=!1;this.toastData={};this.s=uc(()=>this.graphSettings.config.language);this.raw=(e,t)=>Kl(e,t);this.hasTranslation=e=>{let t=this.graphSettings.config.language;return ZP(e,t)};this.unpack=e=>{let t=this.graphSettings.config.language;return Mp(e,t)};this.dispatch=e=>{if(e.type==="blur-focus-location"&&this.dispatcher.isDispatching()){this.runAfterDispatch(()=>{this.dispatch(e)});return}if(e.type==="set-focus-location"&&this.dispatcher.isDispatching()){this.runAfterDispatch(()=>{this.dispatch(e)});return}if(e.type==="tick"&&this.dispatcher.isDispatching()){this.runAfterDispatch(()=>{this.dispatch(e)});return}e.type==="tick"||nf("dispatch::"+this.bugsnagContext,{type:e.type}),this.dispatcher.isDispatching()&&nf("dispatch-in-dispatch::"+this.bugsnagContext,{type:e.type}),this.dispatcher.dispatch(e),this.onEventsEmitted&&this.onEventsEmitted(this.enqueuedEvents);let t;for(;t=this._queuedCallbacks.shift();)t()};this._requiresTickNextFrame=!1;this.cachedGeoTokenDepths={};this.cachedGeoTokenInfo={};this.toolPreviewJSONState={};this.updateViews=()=>{for(var e in this.subscriptions)this.subscriptions[e]()};this.bugsnagContext="";this.inPrintMode=!1;this.lastInfiniteScrollFirstDOM=void 0;this.lastInfiniteScrollLastDOM=void 0;this.hasDispatchSinceLastInfiniteScrollUpdate=!1;this.stateStack=new vh;this.isCurrentlyDoingSetState=!1;this.isCurrentlyDoingRestoreState=!1;this.getQuestIsActive=()=>!1;this.showQuestModal=()=>{};this.showContestDropdown=()=>{};this.logEvent=e=>{};var t,i;this.graphSettings=e,(i=(t=this.graphSettings).setController)==null||i.call(t,this),this.listModel=GK(this),this.layoutModel=vR(this.graphSettings.config),this.layoutMeasurements={width:0,height:0},this.settingsViewModel=CR(),this.geometryToolbarModel=SK(),this.imageRetryState={lastAttemptTime:0,attempts:0},this.makeGeoAPI(),this.setupDispatcher(),this.toneAllowed()&&(this.toneController=new nC(this)),this.graphSettings.config.observe("tone",()=>this._updateToneAvailability()),this.graphSettings.config.observe("audio",()=>this._updateToneAvailability())}hasUnsavedChanges(){return this._hasUnsavedChanges}getExpressionSearchOpen(){return this.expressionSearchOpen}getShowConstructionsOpen(){return this.showConstructionsOpen}getNoticeId(){if(!(this.isNarrow()&&(this.noticeId==="3d-art-contest"||this.noticeId==="art-contest")))return this.noticeId}getGeoToolbarSuppressedByAuthor(){return this.geometryToolbarModel.toolbar==="none"&&!this.shouldShowAuthorFeatures()}shouldShowGeoToolbar(){return this.isGeoUIActive()&&!this.getGeoToolbarSuppressedByAuthor()}isGeoUIActive(){return this.geoUIActive}isGeoToolActive(){return this.activeTool!=="selection"&&this.activeTool!=="box-selection"}getActiveTool(){return this.activeTool}canExpandListForItem(e){let t=this.getItemModel(e);return t?!this.isGeometry()||this.activeTool!=="selection"&&this.activeTool!=="box-selection"||this.isClickableId(e)||"label"in t&&t.label!=="":!1}getGeoModel(){return this.geoModel}getGeoToolbarGroupKeys(){return kG(this.geometryToolbarModel,this.shouldShowAuthorFeatures()).groups}getGeoToolbarItemsForGroup(e){let{items:t}=kG(this.geometryToolbarModel,this.shouldShowAuthorFeatures());return t[e]}getAllVisibleGeoToolbarItems(){let e=this.getGeoToolbarGroupKeys(),t=[];for(let i of e){let o=this.getGeoToolbarItemsForGroup(i);o&&t.push(o)}return t}getTickerOpen(){return this.areActionsEnabled()?this.listModel.ticker.open:!1}getTickerVisible(){return this.getTickerOpen()&&!this.getTicker().filteredBySearch}getTickerPlaying(){return this.areActionsEnabled()?this.listModel.ticker.playing:!1}hasVisibleToast(){return!__dcg_shared_module_exports__['F'](this.toastData)}hasVisibleAndUndoableToast(){return typeof this.toastData.undoCallback=="function"}toastUndo(){typeof this.toastData.undoCallback=="function"&&(this.toastData.undoCallback(),this.dispatch({type:"toast/close"}))}runAfterDispatch(e){this.dispatcher.isDispatching()?this._queuedCallbacks.push(e):e()}enqueueEvent(e,t){var n;let i=this.apiMethodCallStackInfo.apiMethodCallDepth>0,o=t&&!i&&OY(t)||!!((n=this.enqueuedEvents[e])!=null&&n.isUserInitiated)||e==="userMovedPoint";this.enqueuedEvents[e]={isUserInitiated:o}}pushWithHistoryReplacement(){this.apiMethodCallStackInfo.withHistoryReplacementDepth++}popWithHistoryReplacement(){if(this.apiMethodCallStackInfo.withHistoryReplacementDepth--,this.apiMethodCallStackInfo.withHistoryReplacementDepth<0)throw new Error("Programming Error: withHistoryReplacementDepth < 0")}pushAPIMethodCall(){this.apiMethodCallStackInfo.apiMethodCallDepth++}popAPIMethodCall(){this.apiMethodCallStackInfo.apiMethodCallDepth--}getGrapherDimensions(){let e=this.getGrapher();if(!e)return{width:0,height:0};let{width:t,height:i}=e.getProjection().screen;return{width:t,height:i}}setRandomSeed(e){this.graphSettings.setProperty("randomSeed",e)}getRandomSeed(){return this.graphSettings.randomSeed}shouldDispatchTickNextFrame(){return!!this._requiresTickNextFrame}markTickRequiredNextFrame(){this._requiresTickNextFrame=!0}handleTick(e){this.areActionsEnabled()&&lK(this.listModel.ticker,{currentFrameTime:e,previousFrameTime:this.lastFrameTime})?this.dispatch({type:"tick-ticker",time:e}):this.shouldDispatchTickNextFrame()&&this.dispatch({type:"tick",time:e}),this.getGeoModel().isFading()&&this.requestRedrawGraph(),this.lastFrameTime=e}setupDispatcher(){this.dispatcher=new iu,this.dispatcher.register(e=>{var l;let t=this.getFirstSelectedItem(),i=this.getFocusLocation();this.shouldScrollSelectedItemIntoViewAfterDispatch=!1;let o;this.enqueuedEvents={change:void 0,graphReset:void 0,clearUnsavedChanges:void 0,openDrawer:void 0,showHotkeysModal:void 0,userMovedPoint:void 0,userClickedObject:void 0,userEditedLabel:void 0},e.type==="tick"&&(this._requiresTickNextFrame=!1),this.isCurrentlyDoingSetState=!1,this.isCurrentlyDoingRestoreState=!1,this.handleDispatchedAction(e),this.constrainMultiSelect(),this.updateTheComputedWorld();var n=this.getImageToRetry();(this.getPlayingSliders().length>0||this.isDragDropActive()||n)&&this.markTickRequiredNextFrame(),n&&this.retryLoadingFailedImage(n),this.updateGeometryGettingStartedMessageState(),e.type!=="undo"&&e.type!=="redo"&&!this.isDragDropActive()&&this.commitUndoRedoSynchronously(e),this.requestParseForAllItems(),this.isCurrentlyDoingSetState=!1,this.isCurrentlyDoingRestoreState=!1,this.enqueuedEvents.change&&((l=this.getGrapher2d())==null||l.markLabelsDirty()),this.enqueuedEvents.clearUnsavedChanges?this._hasUnsavedChanges=!1:this.enqueuedEvents.change&&(this._hasUnsavedChanges=!0);let a=this.getFirstSelectedItem();a?(!t||t.guid!==a.guid)&&(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0):this.shouldScrollSelectedItemIntoViewAfterDispatch=!1;let s=this.getFocusLocation();s&&!__dcg_shared_module_exports__['E'](s,i)&&this.getFocusedItem()==a&&(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0),i&&t&&t.type==="table"&&i.type==="table"&&(!s||s.type!=="table"||i.id!==s.id)&&t.isExpanded&&(ux(t,!1),s||(o=t)),s&&a&&a.type==="table"&&fq(a),(e.type==="adjust-slider-by-dragging-thumb"||e.type==="adjust-slider-by-keyboard")&&(o=this.getItemModel(e.id)),this.updateRenderShellsBeforePaint(),this.updateViews(),o?this.scrollItemIntoView(o):this.shouldScrollSelectedItemIntoViewAfterDispatch&&this.scrollSelectedItemIntoView(),this.updateDragDrop(),this.updateRenderShellsAfterDispatch()})}updateGeometryGettingStartedMessageState(){if(!this.isGeometry())return;let e=this.geometryGettingStartedMessageState,t=this.getActiveTool(),i=t==="selection"||t==="box-selection"||t==="expression-edit";if(e==="hidden")return;if(this.isGraphSettingsOpen()||this.getGraphSettings().showGrid||this.getGraphSettings().showYAxis){this.geometryGettingStartedMessageState="hidden";return}let o=this.getItemModelByIndex(1);if(this.getItemCount()>2||!o||o.type!=="expression"||o.latex!==""||this.geoModel.getNonObjectsState().ui.currentTool.inputIndex>0){this.geometryGettingStartedMessageState="hidden";return}i||(this.geometryGettingStartedMessageState="construct")}getGeometryGettingStartedMessageState(){return this.geometryGettingStartedMessageState}handleDispatchedAction(e){var d,p,g,h,f,y,x,E,C,S,v,M,A,I,P,_;switch(e.type){case"render":break;case"undo":this.isGeoToolActive()&&this.cancelGeoToolplay(),this.undo();break;case"redo":this.isGeoToolActive()&&this.cancelGeoToolplay(),this.redo();break;case"clear-undoredo-history":this.clearUndoRedoHistory();break;case"on-special-key-pressed":e.key==="Enter"?bR(this):e.key==="Up"?hR(this):e.key==="Down"?gR(this):e.key==="Backspace"?mR(this):e.key==="Delete"&&fR(this);break;case"select-previous-expression":VG(this.listModel);break;case"select-next-expression":LG(this.listModel);break;case"toggle-label-for-all-selected-points":this.toggleLabelForAllSelectedObjects();break;case"update-all-selected-items":{let w=e.update;if(e.update.prop==="folderId"){let T;if(e.update.createFolder){T=this.generateId();let X=this.createItemModel({type:"folder",id:T,title:e.update.value}),ae=this.getItemCount()-1,J=ex(this.listModel,ae);J&&J.type==="expression"&&J.latex===""?this._toplevelReplaceItemAt(this.getItemCount()-1,X,!1):Bd(this.listModel,X)}else T=e.update.value;let B=this.getItemModel(T);if(!B||B.type!=="folder")return;let de={},F={};this.getAllSelectedItems().forEach(X=>{var ae;if(!(X.type==="folder"||X.folderId===T)&&!this.isItemReadonly(X.id)&&(de[X.id]=X,X.type==="expression")){let J=(ae=X.formula.geometry)==null?void 0:ae.call;if(J&&J.symbol==="apply"){let ge=J.parents[0]&&J.parents[0][0];ge&&(F[ge]=!0)}}});for(let X in F){let ae=xf(this.listModel,X);ae.length===1&&ae[0].folderId!==T&&(de[ae[0].id]=ae[0])}let j={},pe=[];for(let X in de){let ae=de[X];pe.push(ae)}pe.forEach(X=>{if(X.type==="expression"){let ae=M_(X);ae&&(j[X.id]=ae)}}),pe.sort((X,ae)=>X.index-ae.index);let le=this.findLastSubscriptForLetters();pe.forEach(X=>{if(X.type==="expression"){var ae=j[X.id];if(ae){let J=this.getAutonameLatexForExpression(X,le);Tg(this.listModel,ae,J)}}}),pe.forEach(X=>{sx(this.listModel,X.id)});let ne=B.index+this.getNumberOfItemsInFolder(T)+1;pe.forEach(X=>{fc(this.listModel,X,ne),ne+=1}),pe.forEach(X=>{Ba(X,T)})}else if(w.prop==="visible")this.getAllSelectedItems().forEach(T=>{this.isItemReadonly(T.id)||(this._setItemHidden(T.id,!w.value),w.value===!1&&T.type==="expression"&&cf(T,!1))});else if(e.update.prop==="color"){let T=e.update.value;this.getAllSelectedItems().forEach(B=>{B.type==="expression"&&zk(B,T)})}else if(e.update.prop==="colorLatex"){let T=e.update.value;this.getAllSelectedItems().forEach(B=>{B.type==="expression"&&fC(B,T)})}else if(e.update.prop==="showLabel"){let T=e.update.value;this.getAllSelectedItems().forEach(B=>{B.type==="expression"&&cf(B,T)})}else if(e.update.prop==="label"){let T=e.update.value;this.getAllSelectedItems().forEach(B=>{B.type==="expression"&&sh(B,T)})}else if(e.update.prop==="dragMode"){let T=e.update.value;this.getAllSelectedItems().forEach(B=>{B.type==="expression"&&df(B,T)})}else if(e.update.prop==="lineWidth"){let T=e.update.value;this.getAllSelectedItems().forEach(B=>{B.type==="expression"&&Fy(B,T)})}else if(e.update.prop==="lineOpacity"){let T=e.update.value;this.getAllSelectedItems().forEach(B=>{B.type==="expression"&&Ry(B,T)})}else if(e.update.prop==="lineStyle"){let T=e.update.value;this.getAllSelectedItems().forEach(B=>{B.type==="expression"&&qk(B,T)})}else if(e.update.prop==="strictIntersection"){let T=e.update.value;this.getAllSelectedItems().forEach(B=>{B.type==="expression"&&Y4(B,T)})}else if(e.update.prop==="disableGraphInteractions"){let T=e.update.value;this.getAllSelectedItems().forEach(B=>{B.type==="expression"?Y_(B,T):B.type==="image"&&rO(B,T)})}}break;case"delete-all-selected-items":{let{deletedItems:w,readonlyItemsNotDeleted:T}=this.removeListOfItems(Object.keys(this.getSelectedExpressionIds()));this.garbageCollectGeo(w,{}),this.ensureAtLeastOneVisibleItem(),w.length>0&&Kt(this.s("graphing-calculator-narration-items-deleted",{count:new on(w.length)})),T>0&&Kt(this.s("graphing-calculator-narration-locked-items-not-deleted",{count:new on(T)})),Te();break}case"upward-delete-selected-expression":yR(this,{moveSelection:!1});break;case"downward-delete-selected-expression":xR(this,{moveSelection:!1});break;case"table-show-more-rows":{let w=this.getItemModel(e.id);if(!w||w.type!=="table")return;let T=Cf(w);if(!T)return;vi(this.listModel,w),ux(w,!0),Vi(this,{type:"table",id:w.id,location:{row:T.min,column:0}})}break;case"navigate-table-by-key":C9(this,e.id,e.key);break;case"delete-item-and-animate-out":this._deleteItemAndAnimateOut(e.id,e.setFocusAfterDelete);break;case"finish-deleting-item-after-animation":this._finishDeletingItemAfterAnimation(e.id,e.setFocusAfterDelete);break;case"expression-zoom-fit":this._expressionZoomFit(e.id,e.focusAfterTap);break;case"set-expression-properties-from-api":this._setExpressionPropertiesFromAPI(e.id,e.properties);break;case"add-item-to-end-from-api":this._addItemToEndFromAPI(this.createItemModel(e.state));break;case"duplicate-expression":{let w=this.getItemModel(e.id);if(!w||w.type==="folder")return;this.copyExpressionToIndex(w,w.index+1)}break;case"duplicate-folder":{let{id:w}=e,T=this.getItemModel(w);if(!T||T.type!=="folder")return;let B=this.createItemModel({...sG(T,{stripDefaults:!1}),id:this.generateId()}),de=this.getNumberOfItemsInFolder(w),F=de+1;this._toplevelInsertItemAt(T.index+F,B,!1,void 0);let j=T.index+1,pe=j+de;for(let le=j;le<=pe;le++){let ne=ex(this.listModel,le);if(!ne||ne.type==="folder")return;this.copyExpressionToIndex(ne,le+F,B.id)}}break;case"insert-item-at-index":{let w=this.createItemModel(e.state);this._toplevelInsertItemAt(e.index,w,e.focus,e.folderId)}break;case"new-expression-at-end":{this.setGeoTool("selection");let w=this.createItemModel({type:"expression",id:this.generateId(),color:this.getNextColor()});this.setEditListMode(!1),Bd(this.listModel,w),Xn(this,w.id)}break;case"new-expression":{let w=this.createItemModel({type:"expression",id:this.generateId(),color:this.getNextColor()});this.setEditListMode(!1),this._toplevelNewItemAtSelection(w,{shouldFocus:!0}),this._closeAddExpression()}break;case"new-text":{let w=this.createItemModel({id:this.generateId(),type:"text"});this._toplevelNewItemAtSelection(w,{shouldFocus:!0}),this._closeAddExpression()}break;case"new-folder":{let w=this.createItemModel({type:"folder",id:this.generateId()});this._toplevelNewItemAtSelection(w,{shouldFocus:!0}),this._closeAddExpression()}break;case"new-images":this._uploadImagesAndWaitForThemToLoad({files:e.files}),this._closeAddExpression();break;case"change-image":this._uploadImagesAndWaitForThemToLoad({files:e.files,id:e.id});break;case"new-table":{let w=this._createTableItem();this._toplevelNewItemAtSelection(w,{shouldFocus:!0}),this._closeAddExpression()}break;case"paste-table":this._pasteTable(e.data);break;case"insert-several-expressions":this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,this._insertSeveralExpressions(e.expressions);break;case"append-number-list":this._appendNumberList(e.latex);break;case"remove-item-by-id":sx(this.listModel,e.id);break;case"replace-item-at-index":{let w=this.createItemModel(e.state);this._toplevelReplaceItemAt(e.index,w,e.focus)}break;case"create-sliders-for-item":this.createSlidersForItem(e.id,e.variables);break;case"create-sliders-for-ticker":this.createSlidersForTicker(e.variables);break;case"convert-image-to-draggable":this.convertImageToDraggable(e.id);break;case"start-dragdrop":{let w=this.getItemModel(e.dragTarget.calcId);if(!w)return;let T={x:0,y:0},B=this.getItemRootNodeById(w.id);if(B){let j=B.getBoundingClientRect();T.y=e.grabPt.y-j.top,T.x=e.grabPt.x-j.left}this.isItemSelected(w.id)?vi(this.listModel,w):vi(this.listModel,void 0);let de=!1,F=1;w.type==="folder"&&(F+=this.getNumberOfItemsInFolder(w.id),w.collapsed||(de=!0,Hy(w,!0))),GC(this.listModel,{firstItemId:w.id,numberOfItems:F,expandFolder:de,grabOffset:T,mousePt:e.mousePt,dragTarget:e.dragTarget,renderType:e.dragTarget.type,itemTop:0,itemLeft:0}),this.dragdrop_expressions.startDragging(e.mousePt)}break;case"update-dragdrop":{let w=this.listModel.dragState;if(!w)return;GC(this.listModel,{...w,mousePt:e.mousePt})}break;case"stop-dragdrop":{let w=this.listModel.dragState;if(!w)return;let T=this.getItemModel(w.firstItemId);if(!T)return;T.type==="folder"&&w.expandFolder&&Hy(T,!1),GC(this.listModel,void 0),this.ensureAtLeastOneVisibleItem()}break;case"set-selected-id":{let w=this.getItemModel(e.id);vi(this.listModel,w)}break;case"set-all-selected-ids":gO(this.listModel,e.ids);break;case"toggle-selected-with-multi-select":hO(this.listModel,e.id);break;case"set-selected-index":{let w=this.getItemModelByIndex(e.index);vi(this.listModel,w)}break;case"set-none-selected":vi(this.listModel,void 0);break;case"set-focus-location":{let w=e.location?e.location.type:"";if(w==="expression"&&this.setGeoTool("selection"),w==="table"&&(this.layoutModel={...this.layoutModel,inEditListMode:!1}),w==="graph-paper"){this.setGraphPaperFocus({isFocused:!0});break}Vi(this,e.location)}break;case"focus-first-expression":{this.focusFirstExpression();break}case"move-focus-to-item":Xn(this,e.id,e.where);break;case"blur-focus-location":this.isFocusLocationFocused(e.location)&&Vi(this,void 0),((d=e.location)==null?void 0:d.type)==="graph-paper"&&this.setGraphPaperFocus({isFocused:!1});break;case"set-folder-collapsed":{let w=this.getItemModel(e.id);if(!w||w.type!=="folder")return;Hy(w,e.isCollapsed)}break;case"set-all-folders-collapsed":oq(this.listModel,e.isCollapsed);break;case"set-item-secret":{let w=this.getItemModel(e.id);if(!w)return;fO(w,e.isSecret)}break;case"set-item-readonly":{let{id:w,readonly:T}=e,B=this.getItemModel(w);if(!B)return;if($G(B,T),B.type==="folder")for(let de of VK(this.listModel,w))$G(de,T)}break;case"set-item-disable-graph-interactions":{let{id:w,disableGraphInteractions:T}=e,B=this.getItemModel(w);if(!B)return;switch(B.type){case"expression":Y_(B,T);break;case"image":rO(B,T);break}break}case"set-tablecolumn-disable-graph-interactions":{let{tableId:w,columnId:T,disableGraphInteractions:B}=e,de=this.getItemModel(w);if(!de||de.type!=="table")return;let F=jn(de,T);if(!F)return;Uq(F,B);break}case"set-tablecolumn-color":{let w=this.getItemModel(e.tableId);if(!w||w.type!=="table")return;_q(w,e.columnId,e.color)}break;case"set-tablecolumn-colorlatex":{let w=this.getItemModel(e.tableId);if(!w||w.type!=="table")return;NG(w,e.columnId,e.colorLatex)}break;case"dismiss-notice":this.noticeId=void 0,e.focusFirstExpression&&this.focusFirstExpression();break;case"set-show-cdf":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;u8(w,e.showCDF)}break;case"set-cdf-min":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;tG(w,e.latex)}break;case"set-cdf-max":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;rG(w,e.latex)}break;case"toggle-item-hidden":this._toggleItemHidden(e.id);break;case"toggle-tablecolumn-hidden":this._toggleTableColumnHidden(e.tableId,e.columnId);break;case"toggle-item-settings-menu":this.isItemSettingsMenuOpen(e.menu.guid)?this.closeItemSettingsMenu():(this.listModel.openItemMenu=e.menu,e.menu.focusFirstOption&&(e.menu.type==="geo-tool-dropdown"?Vi(this,{type:"geo-basic-tool-menu-item",tool:e.menu.tools[0]}):e.menu.type==="multi-select-more"||e.menu.type==="multi-select-transformations"?Vi(this,{type:"generic-menu",where:"start"}):Vi(this,{type:"expression-menu",id:e.menu.model.id,location:"start"})));break;case"close-item-settings-menu":this.closeItemSettingsMenu();break;case"toggle-fraction-evaluation":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;let T=wg(w);z4(w,!T)}break;case"set-item-label":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;sh(w,e.label),this.enqueueEvent("userEditedLabel",e)}break;case"set-item-showlabel":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;cf(w,e.showLabel),!e.showLabel&&!Cg(w)&&(yC(w,!1),Wk(w,"NONE"))}break;case"set-item-color":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;zk(w,e.color)}break;case"set-item-description":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression"&&w.type!=="image")return;w.type==="expression"?K4(w,e.description):w.type==="image"&&U8(w,e.description)}break;case"set-item-fill":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;L_(w,e.fill),this._setItemHidden(w.id,By(w))}break;case"set-image-opacity":{let w=this.getItemModel(e.id);if(!w||w.type!=="image")return;q8(w,e.opacity),this._setItemHidden(w.id,!1)}break;case"set-image-in-foreground":{let w=this.getItemModel(e.id);if(!w||w.type!=="image")return;Z_(w,e.foreground)}break;case"image-upload-error":this.__pendingImageUploads[e.token]&&(delete this.__pendingImageUploads[e.token],this._showToast({message:this.s("graphing-calculator-text-toast-image-upload-failed")}));break;case"image-upload-success":{if(this.__pendingImageUploads[e.token])if(delete this.__pendingImageUploads[e.token],e.id){let w=this.getItemModel(e.id);w&&w.type==="image"&&H8(w,e.url)}else{let w=this.createItemModel({type:"image",id:this.generateId(),width:e.width,height:e.height,image_url:e.url,name:e.name});this._toplevelNewItemAtSelection(w,{shouldFocus:!1})}this.isUploadingImages()||(this.toastData={})}break;case"image-load-success":{let w=this.getItemModel(e.id);if(!w||w.type!=="image")return;bG(w,"loaded"),this.imageRetryState={lastAttemptTime:0,attempts:0}}break;case"image-load-error":{let w=this.getItemModel(e.id);if(!w||w.type!=="image")return;bG(w,"failed")}break;case"image-retry-loading":{let w=this.getItemModel(e.id);if(!w||w.type!=="image")return;tO(w)}break;case"set-item-dragmode":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;df(w,e.dragMode)}break;case"set-tablecolumn-dragmode":{let w=this.getItemModel(e.tableId);if(!w||w.type!=="table")return;Pq(w,e.columnId,e.dragMode),e.dragMode!=="NONE"&&this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-points":{let w=this.getItemModel(e.tableId);if(!w||w.type!=="table")return;wO(w,e.columnId,e.bool),this._setTableColumnHidden(e.tableId,e.columnId,ZG(w,e.columnId))}break;case"set-tablecolumn-lines":{let w=this.getItemModel(e.tableId);if(!w||w.type!=="table")return;Aq(w,e.columnId,e.bool),this._setTableColumnHidden(e.tableId,e.columnId,ZG(w,e.columnId))}break;case"set-tablecolumn-linestyle":{let w=this.getItemModel(e.tableId);if(!w||w.type!=="table")return;Vq(w,e.columnId,e.lineStyle),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-linewidth":{let w=this.getItemModel(e.tableId);if(!w||w.type!=="table")return;_G(w,e.columnId,e.lineWidth),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-lineopacity":{let w=this.getItemModel(e.tableId);if(!w||w.type!=="table")return;OG(w,e.columnId,e.lineOpacity),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-pointsize":{let w=this.getItemModel(e.tableId);if(!w||w.type!=="table")return;RG(w,e.columnId,e.pointSize),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-pointopacity":{let w=this.getItemModel(e.tableId);if(!w||w.type!=="table")return;FG(w,e.columnId,e.pointOpacity),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-pointstyle":{let w=this.getItemModel(e.tableId);if(!w||w.type!=="table")return;Iq(w,e.columnId,e.pointStyle),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-item-points":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;P_(w,e.points),this._setItemHidden(e.id,By(w)),!e.points&&w.dragMode!=="NONE"&&df(w,"NONE")}break;case"set-item-pointstyle":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;__(w,e.pointStyle),this._setItemHidden(e.id,!1)}break;case"set-item-lines":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;O_(w,e.lines),this._setItemHidden(e.id,By(w))}break;case"set-item-extend-to-3D":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;H4(w,e.extendTo3D),this._setItemHidden(e.id,!1);let T=(p=this.grapher3d)==null?void 0:p.transition;T&&e.extendTo3D&&(T.objectIdExtendingTo3D&&((g=this.grapher3d)==null||g.webglLayer.setZboundsOnSurfaces(T.objectIdExtendingTo3D,-1/0,1/0)),T.objectIdExtendingTo3D=w.id,T.startTime=-1,T.duration=150)}break;case"set-item-linestyle":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;qk(w,e.lineStyle),this._setItemHidden(e.id,!1)}break;case"set-item-arrow-mode":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;W4(w,e.value),this._setItemHidden(e.id,!1);break}case"set-item-label-dropdown-open":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;q4(w,e.open)}break;case"set-item-fillopacity":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;hC(w,e.fillOpacity),this._setItemHidden(e.id,!1)}break;case"set-item-lineopacity":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;Ry(w,e.lineOpacity),this._setItemHidden(e.id,!1)}break;case"set-item-pointopacity":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;gC(w,e.pointOpacity),w.showLabel||this._setItemHidden(e.id,!1)}break;case"set-item-pointsize":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;mC(w,e.pointSize),this._setItemHidden(e.id,!1)}break;case"set-item-linewidth":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;Fy(w,e.lineWidth),this._setItemHidden(e.id,!1)}break;case"set-item-resolution":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;Kk(w,e.resolution),this._setItemHidden(e.id,!1)}break;case"set-item-colorlatex":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;fC(w,e.colorLatex)}break;case"set-item-labelSize":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;bC(w,e.labelSize)}break;case"set-item-labelangle":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;Hk(w,e.labelAngle)}break;case"set-item-label-orientation":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;R_(w,e.labelOrientation)}break;case"set-suppress-text-outline":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;$4(w,e.suppressTextOutline)}break;case"set-item-interactive-label":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;yC(w,e.interactiveLabel),e.interactiveLabel&&Wk(w,"NONE")}break;case"set-item-editable-label-mode":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;w.editableLabelMode!=="NONE"&&e.editableLabelMode!=="NONE"&&w.editableLabelMode!==e.editableLabelMode&&sh(w,""),Wk(w,e.editableLabelMode),e.editableLabelMode!=="NONE"&&yC(w,!1)}break;case"plot-residuals":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;var t=w.formula.regression;if(!t)return;var i=t.residualSuggestionId;if(!i)return;var o=this.getItemModel(i);if(!o)return;QG(o,{latex:__dcg_shared_module_exports__['ub'](t.residualVariable),columnIndex:o.columnModels.length-1})}break;case"toggle-logmode":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;var n=w.isLogModeRegression;V_(w,!n)}break;case"set-item-latex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;let T=e.latex,B=w.latex;if(this.garbageCollectGeo([],{[w.id]:{prevLatex:B,nextLatex:T}}),(T==='"'||T==="note")&&this.areNotesEnabled()){let de=this.createItemModel({id:this.generateId(),type:"text"});this._toplevelReplaceItemAt(w.index,de,!0)}else if(T==="")w8(w);else if(T==="ticker"&&this.canAddTicker())this.listModel.ticker.open=!0,this.focusLocation={type:"ticker",location:"handler"},this._removeExpressionSynchronously(w);else if(T==="folder"&&this.areFoldersEnabled()){let de=this.createItemModel({id:this.generateId(),type:"folder"});bl(w)?(this._toplevelNewItemAtSelection(de,{shouldFocus:!0}),gl(w,"")):this._toplevelReplaceItemAt(w.index,de,!0)}else if(T==="table"){let de=this._createTableItem();this._toplevelReplaceItemAt(w.index,de,!0)}else!this.isGeometry()&&(T==="betchacant"||T==="pride"||T==="teapot"&&this.is3dProduct())?this.runAfterDispatch(()=>{this.triggerEasterEgg&&this.triggerEasterEgg(T)}):gl(w,T)}break;case"set-visualization-prop":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;G4(w,e.prop,e.value)}break;case"set-clickableinfo-prop":{let w=this.getItemModel(e.id);if(!w)return;w.type==="expression"?T4(w,e.prop,e.value):w.type==="image"&&yG(w,e.prop,e.value)}break;case"set-clickableinfo-rule-latex":{let w=this.getItemModel(e.id);if(!w)return;w.type==="expression"?Pk(w,e.latex):w.type==="image"&&Q8(w,e.latex)}break;case"set-folder-title":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.id);if(!w||w.type!=="folder")return;S8(w,e.title)}break;case"set-image-mq-attribute":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.id);if(!w||w.type!=="image")return;jl(w,e.attribute,e.latex)}break;case"set-image-name":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.id);if(!w||w.type!=="image")return;z8(w,e.name)}break;case"set-image-draggable":{let w=this.getItemModel(e.id);if(!w||w.type!=="image")return;let T=Wy(w);if(!T)return;Q_(w,e.draggable),e.draggable&&(mo(T)==="NONE"||T.dragMode==="AUTO")&&df(T,"XY")}break;case"set-graph-settings":{for(let w in e)w!=="type"&&(w==="xAxisScale"?this.switchAxisScale("xAxisScale",e.xAxisScale):w==="yAxisScale"?this.switchAxisScale("yAxisScale",e.yAxisScale):this.graphSettings.setProperty(w,e[w]));this.grapher3d&&this.isThreeDMode()&&(this.grapher2d.redrawAllLayersSynchronously(),"backgroundColor3d"in e&&this.grapher3d.webglLayer.setBackgroundColor(e.backgroundColor3d),this.apply3dProps(e))}break;case"set-polar-mode":if(this.graphSettings.setProperty("polarMode",e.polarMode),e.polarMode){let w=this.graphSettings.xAxisScale==="logarithmic"||this.graphSettings.yAxisScale==="logarithmic",T=this.getGrapher2d();w&&T&&(this.graphSettings.setProperty("xAxisScale","linear"),this.graphSettings.setProperty("yAxisScale","linear"),T.viewportController.setViewport(T.getDefaultViewport()),T.getProjection().updateScalePairs())}break;case"set-domain-minlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;ml(w,e.latex,e.variable)}break;case"set-domain-maxlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;fl(w,e.latex,e.variable)}break;case"set-note-text":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.id);if(!w||w.type!=="text")return;I8(w,e.text)}break;case"set-edit-list-mode":{let w=nx(this.listModel);if(this.setEditListMode(e.isEditListMode),e.focusExpressionList){if(w===void 0&&(w=this.getItemModelByIndex(0)),!w)return;Xn(this,w.id,w.type==="table"&&e.isEditListMode?"container":"start")}else vi(this.listModel,void 0),Vi(this,void 0)}break;case"set-ghost-mode":this.getGraphSettings().config.setProperty("ghostMode",e.value);break;case"set-projector-mode":this.getGraphSettings().config.setProperty("projectorMode",e.value),this.isThreeDMode()&&this.grapher2d.redrawAllLayersSynchronously();break;case"set-inverted-colors":this.getGraphSettings().config.setProperty("invertedColors",e.value);break;case"set-tablecell-latex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.tableId);if(!w||w.type!=="table")return;ch(w,e.cell,e.latex)}break;case"set-state":this.externalSetState(e.state,e.opts);break;case"set-blank":this.externalSetState(this.getBlankState({degreeMode:e.degreeMode}),e.opts);break;case"clear-unsaved-changes":this.enqueueEvent("clearUnsavedChanges",e);break;case"reset-graph":{let w=this.getState();this.externalSetState(this.graphSettings.defaultState,{allowUndo:!0}),this.graphSettings.config.expressions?this.focusFirstExpression():this.setGraphPaperFocus({isFocused:!0}),this._showToast({message:this.s("graphing-calculator-text-toast-graph-reset"),undoCallback:()=>this.dispatch({type:"set-state",state:w,opts:{allowUndo:!0}})}),this.enqueueEvent("graphReset",e)}break;case"clear-graph":{if(this.triggerClearGraph){this.runAfterDispatch(()=>this.triggerClearGraph());return}let w=this.getState();this.externalSetState(this.getBlankState(),{allowUndo:!0});let T=this.getItemModelByIndex(0);T&&Xn(this,T.id,"end"),this._showToast({message:this.s("graphing-calculator-text-toast-graph-cleared"),undoCallback:()=>this.dispatch({type:"set-state",state:w,opts:{allowUndo:!0}})}),this.enqueueEvent("graphReset",e)}break;case"on-evaluator-changes":{if(this.onEvaluatorChangesSpy&&this.onEvaluatorChangesSpy(e.changes,e.timingData,e.graphData,e.eventUpdates),tq(this.listModel,e.changes),(h=this.toneController)==null||h.recomputeAudio(),!e.graphData)break;for(let w in e.graphData.addedGraphs){let T=e.graphData.addedGraphs[w];if(__dcg_shared_module_exports__['gc'](T)){let B=T.filter(F=>!__dcg_shared_module_exports__['Gc'](F.graphMode)),de=T.filter(F=>__dcg_shared_module_exports__['Gc'](F.graphMode));(f=this.grapher2d)==null||f.updateSketch(w,B),(y=this.grapher3d)==null||y.updateSketch(w,de),eq(this.listModel,w,T)}}for(let w in e.graphData.removedGraphs)(x=this.grapher2d)==null||x.removeGraphSketch(w),(E=this.grapher3d)==null||E.removeGraphSketch(w);if(this.isThreeDMode())(C=this.grapher2d)==null||C.redrawAllLayersSynchronously();else{for(let w in e.graphData.intersections){let T=e.graphData.intersections[w];__dcg_shared_module_exports__['gc'](T)&&((S=this.grapher2d)==null||S.updateIntersections(w,T))}(v=this.get2dPOIController())==null||v.handleTraceUpdate(),(M=this.getAudioGraph())==null||M.handleEvaluatorChange(e.graphData)}if(e.eventUpdates){let w=!1;for(let T in e.eventUpdates.updates)if(this.doesIdentifierBlockActionUpdate(T)){w=!0;break}if(!w){for(let T in e.eventUpdates.updates)this.updateLatexForIdentifier(T,e.eventUpdates.updates[T]);e.eventUpdates.objectClicked&&this.enqueueEvent("userClickedObject",e),this.onActionUpdatesAppliedSpy&&this.onActionUpdatesAppliedSpy(e.eventUpdates)}}}break;case"add-helper-expression":KK(this.listModel,e.state);break;case"tick":this._tickSliders(e.time);break;case"tick-ticker":this.tickTicker(e.time);break;case"adjust-slider-by-keyboard":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;w4(w,e.adjustment)}break;case"adjust-slider-by-dragging-thumb":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;v4(w,e.target)}break;case"set-slider-minlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;Py(w,e.latex)}break;case"set-slider-maxlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;_y(w,e.latex)}break;case"set-slider-steplatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;uC(w,e.latex)}break;case"set-slider-dragging":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;pC(w,e.dragging)}break;case"play-slider-from-min":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;let T=hc(w);if(isNaN(T))return;let B=yg(w.latex,T);$l(w,!1),gl(w,B),$l(w,!0)}break;case"set-slider-isplaying":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;$l(w,e.isPlaying)}break;case"set-slider-loopmode":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;B4(w,e.loopMode)}break;case"set-slider-animationperiod":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;U4(w,e.animationPeriod)}break;case"show-expressions-list":this._showExpressions(e.focusHideIcon);break;case"hide-expressions-list":this._hideExpressions(e.focusShowIcon);break;case"open-drawer":this.enqueueEvent("openDrawer",e);break;case"re-randomize":this.setRandomSeed(Xp());break;case"resize-exp-list":this._setExpListWidth(e.expListWidth);break;case"toast/show":this._showToast(e.toast);break;case"toast/close":this.closeToast();break;case"toast/undo":let U=this.toastData.undoCallback;U&&this.runAfterDispatch(U),this.toastData={};break;case"toast/learn-more":let Y=this.toastData.learnMoreCallback;Y&&this.runAfterDispatch(Y),this.toastData={};break;case"start-moving-points":r9(this,this.listModel,e.points);break;case"stop-moving-points":o9(this,e.points);break;case"on-move-points":i9(this,e.points,e.previousScreenPts,e.screenPts,e.projection,e.transform,e.keyboardDirection)&&this.enqueueEvent("userMovedPoint",e);break;case"commit-user-requested-viewport":this._commitUserRequestedViewport(e.viewport);break;case"commit-user-requested-rotation":this.graphSettings.setProperty("worldRotation3D",e.worldRotation3D),this.graphSettings.setProperty("axis3D",e.axis3D),this.graphSettings.setProperty("speed3D",e.speed3D);break;case"toggle-lock-viewport":this.graphSettings.setProperty("userLockedViewport",!this.graphSettings.userLockedViewport);break;case"set-axis-limit-latex":this._setAxisLimitLatex(e.limit,e.latex),e.updateYZAlso&&(this._setAxisLimitLatex(e.limit==="xmin"?"ymin":"ymax",e.latex),this._setAxisLimitLatex(e.limit==="xmin"?"zmin":"zmax",e.latex)),this.lastDirectlyEditedViewport=(A=this.getGrapher())==null?void 0:A.getCurrentViewport();break;case"toggle-graph-settings":this.layoutModel={...this.layoutModel,graphSettingsOpen:!this.layoutModel.graphSettingsOpen},vi(this.listModel,void 0),e.focusOnOpen&&(this.layoutModel.graphSettingsOpen?this.is3dProduct()?Vi(this,{type:"settings",location:"reverse-contrast"}):this.getGraphSettings().config.projectorMode?Vi(this,{type:"settings",location:"large-size"}):Vi(this,{type:"settings",location:"default-size"}):Vi(this,{type:"settings",location:"icon"}));break;case"close-graph-settings":this.layoutModel={...this.layoutModel,graphSettingsOpen:!1},e.focusIconAfterClose&&Vi(this,{type:"settings",location:"icon"});break;case"toggle-add-expression":this.layoutModel={...this.layoutModel,addExpressionOpen:!this.layoutModel.addExpressionOpen},e.focusOnOpen&&this.layoutModel.addExpressionOpen&&Vi(this,{type:"add-expression-btn"});break;case"close-add-expression":this._closeAddExpression(),e.focusIconAfterClose&&Vi(this,{type:"add-item-btn"});break;case"ui/container-resized":this.layoutMeasurements={width:e.size.width,height:e.size.height},this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;break;case"enter-printmode":this.inPrintMode=!0;break;case"exit-printmode":this.inPrintMode=!1;break;case"expression-size-exceeded":this._showToast({message:this.s("graphing-calculator-text-toast-expression-size-limit")});break;case"keypad/set-layout":this.layoutModel={...this.layoutModel,keypadLayout:e.layout,keypadFunctionsOpen:!1};break;case"keypad/set-minimized":this.layoutModel={...this.layoutModel,keypadMinimized:e.minimized,keypadLayout:"mainNumbers"},this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,this.needsFakeKeypad()||x9(this),Te(e.minimized?this.s("graphing-calculator-narration-keypad-hidden"):this.s("graphing-calculator-narration-keypad-visible"));break;case"keypad/type-text":this.layoutModel={...this.layoutModel,keypadFunctionsOpen:!1},this.runAfterDispatch(()=>{let w=Ze.getFocusedMathquill();w&&Ze.canAcceptText(w,this.getCapExpressionSize(),e.text)&&(w.typedText(e.text),Ze.simulateUserChangedLatex(w))});break;case"keypad/press-key":this.layoutModel={...this.layoutModel,keypadFunctionsOpen:!1},this.runAfterDispatch(()=>{let w=Ze.getFocusedMathquill();w&&Ze.simulateKeypress(w,e.key)});break;case"keypad/audio-trace":this.handleAudioTraceCommand(e.command);break;case"set-audio-trace-speed":this.setAudioTraceSpeed(e.speed);break;case"keypad/custom-command":this.layoutModel={...this.layoutModel,keypadFunctionsOpen:!1},this.runAfterDispatch(()=>{let w=Ze.getFocusedMathquill();w&&(Xx(w,e.command,{capExpressionSize:this.getCapExpressionSize()}),Ze.simulateUserChangedLatex(w))});break;case"keypad/shift":this.layoutModel={...this.layoutModel,keypadLayout:E9(this.getKeypadLayout()),keypadFunctionsOpen:!1};break;case"keypad/123":this.layoutModel={...this.layoutModel,keypadLayout:"mainNumbers",keypadFunctionsOpen:!1};break;case"keypad/abc":this.isQwertyKeyboardEnabled()?this.layoutModel={...this.layoutModel,keypadLayout:"letters",keypadFunctionsOpen:!1}:this.layoutModel={...this.layoutModel,keypadLayout:"noQwertyLetters",keypadFunctionsOpen:!1};break;case"keypad/audio":this.layoutModel={...this.layoutModel,keypadMinimized:!1,keypadLayout:"audio",keypadFunctionsOpen:!1};break;case"keypad/functions":this.layoutModel={...this.layoutModel,keypadFunctionsOpen:!this.isKeypadFunctionsPopoverOpen()};break;case"grapher/drag-start":break;case"grapher/drag-move":break;case"grapher/drag-end":break;case"open-on-web":this._openOnWeb();break;case"file-is-dragged-over":this.listModel.openItemMenu=void 0,this.layoutModel={...this.layoutModel,isFileDraggedOver:!0};break;case"file-is-not-dragged-over":this.layoutModel={...this.layoutModel,isFileDraggedOver:!1};break;case"zoom":(I=this.getGrapher())==null||I.viewportController.zoom(e.direction);break;case"set-hovered-image":{let w=this.getItemModel(e.id);if(!w||w.type!=="image")return;yG(w,"hoveredImage",e.url)}break;case"set-depressed-image":{let w=this.getItemModel(e.id);if(!w||w.type!=="image")return;yG(w,"depressedImage",e.url)}break;case"clickable-item-clicked":this.handleClickableItemClicked(e.id,e.listIndex);break;case"action-single-step":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression"||!w.formula.action_value)return;this.evaluator.addActionStepEvent(w.id)}break;case"update-expression-search-str":this.updateExpressionSearchStr(e.str);break;case"update-expression-replace-str":this.updateExpressionReplaceStr(e.str);break;case"rename-identifier-global":this.suggestedIdentifierRename=void 0,Tg(this.listModel,e.search,e.replace);break;case"rename-identifier-in-item":this.suggestedIdentifierRename=void 0;let R=this.getItemModel(e.id);R&&R.type==="folder"?Tg(this.listModel,e.search,e.replace,{limitToFolder:e.id}):Tg(this.listModel,e.search,e.replace,{limitToItem:e.id});break;case"update-ticker-handlerlatex":this.updateTickerHandlerLatex(e.latex);break;case"update-ticker-minsteplatex":this.updateTickerMinStepLatex(e.latex);break;case"set-braille-mode":this.setBrailleMode(e.mode);break;case"set-six-key-input":this.setSixKeyInput(e.useSixKeyInput);break;case"set-show-constructions-open":if(this.showConstructionsOpen=e.open,e.setFocus)if(!e.open)Vi(this,{type:"geo-show-constructions-icon"});else for(let w in this.cachedGeoTokenInfo){let{calcId:T}=this.cachedGeoTokenInfo[w];if(this.getItemModel(T)){Vi(this,{type:"geo-token",identifier:w});break}}break;case"select-geo-tool":this.listModel.openItemMenu=void 0,this.setGeoTool(e.tool),__dcg_shared_module_exports__['oc'](e.tool)||e.tool==="selection"||vi(this.listModel,void 0),e.focusGraphPaper&&this.setGraphPaperFocus({isFocused:!0}),this.closeToast();break;case"cancel-geo-toolplay":this.cancelGeoToolplay();break;case"commit-geo-objects":{let w=[],T=[];var a=this.findLastSubscriptForLetters(),s={};let B=pe=>{let le=s[pe];if(le)return le.assignmentLatex;let ne=this.getItemModel(pe);if(!ne||ne.type!=="expression")return pe;var X=this._autoNameExpression(ne,a);return le=s[pe]={model:ne,assignmentLatex:X},le.assignmentLatex},de=[];for(let pe in e.committed){var l=e.committed[pe];__dcg_shared_module_exports__['oc'](l.type)&&de.push(pe);var c=u2(l,!0,B);c&&(c.sliderInfo?T.push({latex:c.latex,color:c.color,sliderInfo:c.sliderInfo}):w.push({...c,tokenId:pe}))}let F=this.listModel.__toolPreviewIdToModel;if(w.length){let pe=this.getGeometryFolder(),le=pe?pe.index+this.getNumberOfItemsInFolder(pe.id)+1:0;w.forEach(ne=>{var ae;let X;for(let J in F){let ge=F[J];if(((ae=mn(ge))==null?void 0:ae.latex)===ne.tokenId){X=ge;break}}X?(X.latex=ne.latex,X.color=ne.color,X.showLabel=!!ne.showLabel,X.showAngleLabel=ne.showAngleLabel!==!1,pe&&(X.folderId=pe.id)):X=this.createItemModel({id:this.generateId(),type:"expression",showLabel:ne.showLabel,showAngleLabel:ne.showAngleLabel,latex:ne.latex,folderId:pe&&pe.id,color:ne.color}),pe?(fc(this.listModel,X,le),le+=1):Bd(this.listModel,X),this.getGeoModel().recordCommittedOutput(X.id)})}T.forEach(pe=>{let le;for(let ne in F){let X=F[ne];if(X.latex===pe.latex){le=X;break}}le?(le.latex=pe.latex,le.color=pe.color,Py(le,pe.sliderInfo.min),_y(le,pe.sliderInfo.max)):le=this.createItemModel({id:this.generateId(),type:"expression",latex:pe.latex,color:pe.color,slider:{hardMin:!0,hardMax:!0,min:pe.sliderInfo.min,max:pe.sliderInfo.max}}),fc(this.listModel,le,0),this.getGeoModel().recordCommittedOutput(le.id)}),de.length===1&&this.transformAllSelectedItemsByAssignmentLatex(de[0]),this.geoModel.isCurrentToolSingleUse()&&this.setGeoTool("selection");let j=e.toolIdToLatex[1];if(this.geoModel.getToolMode()==="expression-edit"&&j){let pe=p2(j,B);this.writeIdentifierIntoCurrentMathquill(pe)}this.isGeometry()&&this.getGeoModel().updateFadeAnimations()}break;case"rename-identifier":{let w=e.from,T=e.to,B=__dcg_shared_module_exports__['wb'](w),de=this.getGeometryFolder();de&&this.getItemsByIdentifier(B).forEach(F=>{e.geoFolder&&F.folderId!==de.id?(Ba(F,de.id),Mg(this.listModel,F.index,de.index+1,1)):!e.geoFolder&&F.folderId===de.id&&(Mg(this.listModel,F.index,de.index+this.getNumberOfItemsInFolder(de.id),1),Ba(F,""))}),Tg(this.listModel,w,T)}break;case"set-active-token":this.activeTokens[e.style]=e.identifier;break;case"unset-active-token":this.activeTokens[e.style]===e.identifier&&(this.activeTokens[e.style]=void 0);break;case"select-expression-that-defines-token":{let w=this.getExpressionIdForIdentifier(e.identifier);if(!w||(this.setGeoTool("selection"),this.isItemNotSelectableBecauseItsSecret(w)))return;e.multiSelectMode||e.toggle?hO(this.listModel,w):this.tryInsertTokenIntoMathquill(w,void 0)||vi(this.listModel,this.getItemModel(w))}break;case"close-expression-search":this.closeExpressionsSearch();break;case"open-expression-search":this.expressionSearchOpen=!0,this.focusLocation={type:"search-expressions"};let H=e.latex;e.rename&&!ul(H)&&(H="");let O=e.rename?H?`\\operatorname{rename}\\ ${H}\\to`:"\\operatorname{rename}\\ ":H;this.updateExpressionSearchStr(O);break;case"open-ticker":this.listModel.ticker.open=!0,this.focusLocation={type:"ticker",location:"handler"},this._closeAddExpression();break;case"close-ticker":this.listModel.ticker.open=!1,this.listModel.ticker.playing=!1,this.listModel.ticker.minStepLatex="",this.listModel.ticker.handlerLatex="";break;case"toggle-ticker":this.listModel.ticker.playing=!this.listModel.ticker.playing,this.listModel.ticker.lastTickTime=void 0,this.pauseAllSliders();break;case"set-tool-preview-state":this.setToolPreviewState(e.state);break;case"apply-transformation-to-selected":this.transformAllSelectedItemsByAssignmentLatex(e.assignmentLatex),this.closeItemSettingsMenu();break;case"set-geometry-toolbar":{DK(this.geometryToolbarModel,e.toolbar);break}case"set-geometry-custom-toolbar-setting":{DG(this.geometryToolbarModel,e.tool,e.value);break}case"set-author-mode":{this.setAuthorMode(e.enabled);break}case"set-translucent-surfaces":{this.getGraphSettings().config.setProperty("translucentSurfaces",e.value);break}case"set-perspective-distortion":{this.getGraphSettings().config.setProperty("perspectiveDistortion",e.value),(P=this.grapher3d)==null||P.redrawAllLayers();break}case"mute-global":case"unmute-global":{e.type==="unmute-global"&&this.runAfterDispatch(()=>{var w;(w=this.getAudioGraph())==null||w.exitAudioTrace()}),(_=this.toneController)==null||_.handleAction(e);break}default:return e}}switchAxisScale(e,t){var o;if(!t||t===this.graphSettings[e])return;this.graphSettings.setProperty("polarMode",!1);let i;this.getAllItemModels().forEach(n=>{if(this.isExpressionZoomFit(n)){if(!this.getBoundingBoxesForZoomFit(n))return;i=n.id}}),this.graphSettings.setProperty(e,t),(o=this.getGrapher2d())==null||o.getProjection().updateScalePairs(),!(i&&this._expressionZoomFit(i,!1,!0))&&this.enforceAxisLimitsForScale(e)}enforceAxisLimitsForScale(e){let t=this.getGrapher2d();if(!t)return;let i=t.getDefaultViewport();if(!i)return;e==="xAxisScale"?(this._setAxisLimitLatex("xmin",__dcg_shared_module_exports__['tb'](i.xmin)),this._setAxisLimitLatex("xmax",__dcg_shared_module_exports__['tb'](i.xmax))):(this._setAxisLimitLatex("ymin",__dcg_shared_module_exports__['tb'](i.ymin)),this._setAxisLimitLatex("ymax",__dcg_shared_module_exports__['tb'](i.ymax))),this.graphSettings.xAxisScale===this.graphSettings.yAxisScale&&(this.graphSettings.setProperty("lastChangedAxis",e==="xAxisScale"?"y":"x"),t.viewportController.zoomSquareImmediately(),this.markSquareAxesAfterUserEditedViewport());let o=t.viewportController.getViewport(),n=t.getProjection(),{xmin:a,xmax:s,ymin:l,ymax:c}=o,d=this.getGraphSettings().config.logScales;if(e==="xAxisScale"&&d){let p=n.mapx(a),g=n.mapx(s),h=Yi(n.reverse_mapx(p-.25),n.reverse_mapx(p+.25)),f=Yi(n.reverse_mapx(g-.25),n.reverse_mapx(g+.25));this._setAxisLimitLatex("xmin",__dcg_shared_module_exports__['tb'](h)),this._setAxisLimitLatex("xmax",__dcg_shared_module_exports__['tb'](f))}if(e==="yAxisScale"&&d){let p=n.mapy(l),g=n.mapy(c),h=Yi(n.reverse_mapy(p-.25),n.reverse_mapy(p+.25)),f=Yi(n.reverse_mapy(g-.25),n.reverse_mapy(g+.25));this._setAxisLimitLatex("ymin",__dcg_shared_module_exports__['tb'](h)),this._setAxisLimitLatex("ymax",__dcg_shared_module_exports__['tb'](f))}this.lastDirectlyEditedViewport=t.getCurrentViewport()}updateGraphSettingsViewportLimitsLatex(e){this._setAxisLimitLatex("xmin",e.xmin+""),this._setAxisLimitLatex("xmax",e.xmax+""),this._setAxisLimitLatex("ymin",e.ymin+""),this._setAxisLimitLatex("ymax",e.ymax+""),this._setAxisLimitLatex("zmin",e.zmin+""),this._setAxisLimitLatex("zmax",e.zmax+"")}transformAllSelectedItemsByAssignmentLatex(e){var g,h;let t=AG(this.listModel),i=this.findLastTokenNumber()+1,o=this.findLastSubscriptForLetters(),n=this.getGeometryFolder(),a=n?n.index+this.getNumberOfItemsInFolder(n.id)+1:0,s={};for(let f of t){if(f.type!=="expression")continue;var l=f.formula.geometry;if(!l)continue;var c=(g=f.formula.typed_constant_value)==null?void 0:g.valueType;if(!c||__dcg_shared_module_exports__['ib'](c,__dcg_shared_module_exports__['Ta']))continue;var d=(h=mn(f))==null?void 0:h.latex;d||(d=this._autoNameExpression(f,o));let y=`\\token{${i}}`;i+=1;let x=`${y}=${e}\\left(${d}\\right)`,E=this.createItemModel({id:this.generateId(),type:"expression",showLabel:f.showLabel&&!f.label,showAngleLabel:f.showAngleLabel&&!f.label,latex:x,folderId:n&&n.id,color:f.color});s[E.id]=!0,n?(fc(this.listModel,E,a),a+=1):Bd(this.listModel,E)}let p=Object.keys(s);if(p.length&&gO(this.listModel,s),p.length===1){let f=p[0];this.runAfterDispatch(()=>{this.getItemModel(f)&&this.get2dPOIController().keyboardAttentionManager.updateKeyboardAttention({calcId:f,listIndex:void 0,polygonEdge:void 0},{describe:!1})})}}convertToTokenAssignment(e,t=""){var n;let i=(n=mn(e))==null?void 0:n.latex,o=t?oC(t)||"":"\\token{"+(this.findLastTokenNumber()+1)+"}";i?Tg(this.listModel,i,o):gl(e,o+"="+e.latex)}convertToNamedAssignment(e,t=""){let i=M_(e);if(!i)return;let o=t?oC(t):this.getAutonameLatexForExpression(e);o?Tg(this.listModel,i,o):gl(e,t)}getAutonameLatexForExpression(e,t){if(t||(t=this.findLastSubscriptForLetters()),I_(e)==="point"&&e.label&&ul(e.label)&&this.countGlobalIdentifierOccurences(e.label)===0)return e.label;var i=_4(e),o=(t[i]||0)+1;return t[i]=o,i+"_{"+o+"}"}_autoNameExpression(e,t){let i=this.getAutonameLatexForExpression(e,t);return gl(e,i+"="+e.latex),i}isGeoToolVisible(e,{ignoreAuthorMode:t}={ignoreAuthorMode:!1}){return!t&&this.shouldShowAuthorFeatures()?!0:ff(this.geometryToolbarModel,e)}isGeoToolEnabled(e,{ignoreAuthorMode:t}={ignoreAuthorMode:!1}){return!t&&this.shouldShowAuthorFeatures()?!0:Xy(this.geometryToolbarModel,e)}isSomeTransformToolVisible(){return Px.some(e=>this.isGeoToolVisible(e))}setGeoTool(e){if(!this.geoUIActive||this.activeTool===e||!this.isGeoToolEnabled(e))return;kK(this.geometryToolbarModel,e,this.shouldShowAuthorFeatures()),this.activeTool=e,this.getGeoModel().setToolMode(e),this.cancelGeoToolplay()}cancelGeoToolplay(){var t;let e=this.getGeoModel();e.cancelToolplay(),e.deselectAllObjects(),this.setToolPreviewState({}),(t=this.get2dPOIController())==null||t.cancelGeoToolplay()}setToolPreviewState(e){var i;this.toolPreviewJSONState=e;var t=this.listModel.__toolPreviewIdToModel;this.listModel.__toolPreviewIdToModel={};for(let o in e){let n=e[o],a=u2(n,!1);if(!a)continue;let s;for(let l in t){let c=t[n.type==="expression-edit-preview-latex"?Zy:l];if(((i=mn(c))==null?void 0:i.latex)===o){s=c;break}}s?(s.latex=a.latex,s.color=a.color,s.showAngleLabel=!!a.showAngleLabel,s.hidden=n.hidden):s=Bk({id:n.type==="expression-edit-preview-latex"?Zy:this.generateId(),type:"expression",color:a.color,latex:a.latex,showAngleLabel:!!a.showAngleLabel,hidden:n.hidden},this),this.listModel.__toolPreviewIdToModel[s.id]=s}}isGeoItem(e){let t=this.getItemModel(e);return t&&t.type==="expression"&&t.formula&&t.formula.geometry&&!t.formula.error}getSelectedGeoExpression(){var e=this.getSelectedItem();if(e&&this.isGeoItem(e.id)&&e.type==="expression")return e}getGeometryFolder(){let e=this.getItemModel(__dcg_shared_module_exports__['jd']);return e&&e.type==="folder"?e:void 0}isItemInGeoFolder(e){var t=this.getItemModel(e);return!t||t.type==="folder"?!1:t.folderId===__dcg_shared_module_exports__['jd']}isGeoFolder(e){return e.id===__dcg_shared_module_exports__['jd']}isItemNotSelectableBecauseItsSecret(e){return!(this.shouldShowAuthorFeatures()||this.isItemInGeoFolder(e)||!this.isItemSecret(e))}pauseAllSliders(){this.getPlayingSliders().forEach(e=>{$l(e,!1)})}countGlobalIdentifierOccurences(e){return dO(this.listModel,e)}handleClickableItemClicked(e,t){let i=this.getItemModel(e);lx(i)&&this.evaluator.addClickEvent(i.id,t)}canAddTicker(){return!this.getTickerOpen()}countIdentifierAssignments(e){return xf(this.listModel,e).length}countIdentifierAssignmentsInsideFolder(e,t){return xf(this.listModel,e).filter(i=>i.folderId===t).length}doesIdentifierBlockActionUpdate(e){var t=this.getFocusLocation(),i=xf(this.listModel,e);for(let o of i)if((t==null?void 0:t.type)==="expression"&&t.id===o.id||F4(o))return!0;return!1}getItemsByIdentifier(e){return xf(this.listModel,e)}isAtLeastOnePointSelected(){let e=this.getAllSelectedItems();for(var t=0;t<e.length;t++){let i=e[t];if(i.type==="expression"&&Op(i))return!0}return!1}toggleLabelForAllSelectedObjects(){let e=[],t=[];this.getAllSelectedItems().forEach(o=>{o.type==="expression"&&Op(o)&&(o.showLabel?t.push(o):e.push(o))});let i=/^([A-Z])([0-9]*)$/;if(e.length){let o=0;this.getAllItemModels().forEach(n=>{if(n.type!=="expression"||!n.showLabel||!n.label)return;let a=n.label.match(i);if(!a)return;let s=a[1].charCodeAt(0)-65;a[2]&&(s+=parseInt(a[2])*26),s>=o&&(o=s+1)}),e.forEach(n=>{if(!n.label){let a=o;o++;let s=String.fromCharCode(a%26+65),l=Math.floor(a/26),c=l>0?l+"":"";sh(n,s+c)}cf(n,!0)})}else t.length&&t.forEach(o=>{i.test(o.label)&&sh(o,""),cf(o,!1)})}updateLatexForIdentifier(e,t){var i=xf(this.listModel,e);if(i.length===1){var o=i[0];o.slider.isPlaying?($l(o,!1),gl(o,t),$l(o,!0)):gl(o,t)}}updateExpressionSearchStr(e){this.rawExpressionSearchStr=e;let t="\\operatorname{rename}";if(e.indexOf(t)===0){let o=e.slice(t.length).replace(/\\ /g,"").split(/\\to(?![a-zA-Z])/);o.length===2?(this.expressionSearchStr=o[0],this.isExpressionSearchStrValidForReplace=ul(this.expressionSearchStr),this.updateExpressionReplaceStr(o[1])):(this.expressionSearchStr=o[0],this.isExpressionSearchStrValidForReplace=!1,this.updateExpressionReplaceStr(""));let n=RK(this.listModel,this.getExpressionSearchStr());this.expressionSearchCount=this.expressionSearchOpen?n:0}else this.expressionSearchStr=e.length>1&&"rename".indexOf(e)===0?"":e,this.isExpressionSearchStrValidForReplace=!1,this.updateExpressionReplaceStr(""),this.filterItemsBySearch()}closeExpressionsSearch(){var i;if(this.expressionSearchOpen=!1,this.updateExpressionSearchStr(""),((i=this.getFocusLocation())==null?void 0:i.type)==="ticker")return;let e=this.getFirstSelectedItem(),t=this.getItemModelByIndex(0);!e&&t&&Xn(this,t.id,"end"),e&&this.getSelectedItem()&&!this.getFocusedItem()&&Xn(this,e.id,"end"),(e||t)&&(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0)}filterItemsBySearch(){if(!this.getExpressionReplaceStr()){let e=FK(this.listModel,this.getExpressionSearchStr());this.expressionSearchCount=this.expressionSearchOpen?e:0}}updateExpressionReplaceStr(e){this.expressionReplaceStr=e,this.isExpressionReplaceStrValidForReplace=ul(e)}getIsExpressionSearchStrValidForReplace(){return this.isExpressionSearchStrValidForReplace}getIsExpressionReplaceStrValidForReplace(){return this.isExpressionReplaceStrValidForReplace}isSearchReplaceValid(){return this.getIsExpressionSearchStrValidForReplace()&&this.getIsExpressionReplaceStrValidForReplace()}shouldShowReplaceIcon(){return this.isSearchReplaceValid()}updateTickerHandlerLatex(e){this.listModel.ticker.handlerLatex=e}updateTickerMinStepLatex(e){this.listModel.ticker.minStepLatex=e}getRawExpressionSearchStr(){return this.rawExpressionSearchStr||""}getExpressionSearchStr(){return this.expressionSearchStr||""}getExpressionReplaceStr(){return this.expressionReplaceStr||""}getExpressionSearchCount(){return this.expressionSearchCount||0}getTicker(){return this.listModel.ticker}getTickerHandlerLatex(){return this.listModel.ticker.handlerLatex||""}getTickerMinStepLatex(){return this.listModel.ticker.minStepLatex||""}getTickerAvgDelta(){return this.listModel.ticker.avgDelta}getBrailleMode(){return this.graphSettings.config.brailleMode}setBrailleMode(e){this.graphSettings.config.setProperty("brailleMode",e)}getSixKeyInput(){return this.graphSettings.config.sixKeyInput}setSixKeyInput(e){this.graphSettings.config.setProperty("sixKeyInput",e)}getBrailleControls(){return this.graphSettings.config.brailleControls}setBrailleControls(e){this.graphSettings.config.setProperty("brailleControls",e)}getAudio(){return this.graphSettings.config.audio}setAudio(e){this.graphSettings.config.setProperty("audio",e)}setEditListMode(e){this.layoutModel={...this.layoutModel,inEditListMode:e}}generateTableXSubscript(){return MG(this.listModel)}findLastTokenNumber(){return NK(this.listModel)}findLastSubscriptForLetters(){return BK(this.listModel)}_createTableItem(){let e=this.generateTableXSubscript(),t=xO(e,[[],[]],this);return this.createItemModel(t)}_populateSettingsViewLimitLatex(){let e=this.getGrapher();if(!e)return;let t=e.getCurrentViewport();this.isGraphSettingsOpen()&&__dcg_shared_module_exports__['E'](t,this.lastDirectlyEditedViewport)||(this.settingsViewModel={...this.settingsViewModel,limitLatex:T9(t,{steps:this.getAxisStepSettings(),scales:this.getAxisScaleSettings()})})}getAxisStepSettings(){return{xAxisStep:this.graphSettings.xAxisStep,yAxisStep:this.graphSettings.yAxisStep}}getAxisScaleSettings(){return{xAxisScale:this.graphSettings.xAxisScale,yAxisScale:this.graphSettings.yAxisScale}}getDefaultAxisScaleSettings(){var t,i;let{defaultState:e}=this.graphSettings;return{xAxisScale:((t=e==null?void 0:e.graph)==null?void 0:t.xAxisScale)||"linear",yAxisScale:((i=e==null?void 0:e.graph)==null?void 0:i.yAxisScale)||"linear"}}getSettingsViewModel(){return this.settingsViewModel}getListModel(){return this.listModel}getGeometryToolbarModel(){return this.geometryToolbarModel}hasBackgroundColor(){return this.getBackgroundColor()!=="#ffffff"}getBackgroundColor(){return this.getGraphSettings().getBackgroundColor()}getTextColor(){return this.getGraphSettings().getTextColor()}getPillboxBackgroundColor(){return __dcg_shared_module_exports__['P'](this.getBackgroundColor(),-.07)}subscribeToChanges(e){let t=this.nextSubscription;return this.nextSubscription+=1,this.subscriptions[t]=e,()=>{delete this.subscriptions[t]}}updateTheComputedWorld(){var d,p,g,h,f,y,x;wf(this.listModel);let t=this.getSelectedItem()&&this.activeTool==="expression-edit"&&this.listModel.__toolPreviewIdToModel[Zy]&&((d=this.getGrapher())!=null&&d.graphSketches[Zy])?"preview":"actual";UK(this.listModel,t),(p=this.grapher2d)==null||p.setSketchOrder(this.listModel.drawOrder),(g=this.grapher3d)==null||g.setSketchOrder(this.listModel.drawOrder);let i={},o=E=>{var S;let C=(S=mn(E))==null?void 0:S.identifier;C&&(C[0]==="$"||E.formula.geometry)&&C&&(i[C]?i[C].multiple=!0:i[C]={model:E,multiple:!1})};for(let E of this.getAllToolPreviewItems())A_(E),o(E);for(let E of this.getAllItemModels())switch(E.type){case"expression":A_(E),o(E);break;case"image":W8(E);break;case"table":Eq(E);break;case"folder":C8(E);break;case"text":V8(E);break;default:return E}this.geoUIActive=this.isGeometry()&&!this.getGraphSettings().config.hideGeoUI,this.cachedGeoTokenInfo={};for(let E in i){let{multiple:C,model:S}=i[E];if(S&&!this.isItemInGeoFolder(S.id)&&(S.readonly||Yl(S)))continue;let v="blue",M="unknown",A="unknown",I=!1,P=!1,_=!1,U=ls(S);!C&&S?(v=Ud(S),I=P4(S),A=R4(S),M=I_(S),S.error&&(P=!0,v="#")):(M="error",P=!0),M&&S?this.isItemSelected(S.id)&&(_=!0):P=!0;let Y=(S==null?void 0:S.label)||"";this.cachedGeoTokenInfo[E]={groupType:M,iconType:A,isList:I,hasError:P,color:v,isSelected:_,isHidden:U,label:Y,calcId:S&&S.id||""}}this.cachedGeoTokenDepths={};let{createdDepth:n,firstReferencedDepth:a}=this.geoModel.getComputedBoard().getDepthValues();for(let E in this.cachedGeoTokenInfo){let{calcId:C}=this.cachedGeoTokenInfo[E],S=this.getItemModel(C);if(!S)continue;let v=E;if(!(E in n)&&S.type==="expression"&&(C===this.getDraggedItemId()||S===this.getFocusedItem())){let U=S.formula.assignment;U&&U in n&&(v=U)}let M=n[v]||0,A=a[v];A=isFinite(A)?A:0;let I=Math.max(M,A-1)+"",P=this.cachedGeoTokenDepths[I];P||(P=[],this.cachedGeoTokenDepths[I]=P);let _=this.cachedGeoTokenInfo[E];P.push({color:_.color,groupType:_.groupType,identifier:E,calcId:C})}sK(this.listModel.ticker);let s=this.getFocusLocation();if(s&&s.type==="expression"&&s.isFakeGraphFocus&&(this.getValidCursorContext()||Vi(this,{...s,isFakeGraphFocus:void 0})),this.isCurrentFocusLocationValid()||Vi(this,void 0),this.listModel.openItemMenu){let E=this.getOpenMenuIcon();document.body&&E&&document.body.contains(E)||(this.listModel.openItemMenu=void 0)}let l=this.getSelectedItem();l&&!this.getItemModel(l.id)&&vi(this.listModel,void 0),this._populateSettingsViewLimitLatex(),this.propagateSelection(),this.propagateActiveTokens(),this.isKeypadOpen()||(this.layoutModel={...this.layoutModel,keypadFunctionsOpen:!1}),this.updateSuggestedIdentifierRenameInfo(),this.isGeometry()&&l&&l.type==="expression"?this.getValidCursorContext()?(this.setGeoTool("expression-edit"),this.geoModel.updateFadeAnimations()):this.geoModel.getToolMode()==="expression-edit"&&this.setGeoTool("selection"):this.geoModel.getToolMode()==="expression-edit"&&this.setGeoTool("selection");let c=this.getValidCursorContext();this.isGeometry()&&this.getGeoModel().getToolMode()==="expression-edit"&&!__dcg_shared_module_exports__['E'](c,this.lastCursorContext)&&this.runAfterDispatch(()=>{var E;(E=this.get2dPOIController())==null||E.replayGeoTapMove()}),this.lastCursorContext=c,(f=(h=this.grapher2d)==null?void 0:h.poiController)!=null&&f.keyboardAttentionManager.getKeyboardAttention()&&!this.isGraphPaperFocused()&&((x=(y=this.grapher2d)==null?void 0:y.poiController)==null||x.keyboardAttentionManager.setKeyboardAttention(void 0)),this.isGeometry()&&(wK(this.geometryToolbarModel),this.isGeoToolEnabled(this.getActiveTool())||this.setGeoTool("selection")),this.runAfterDispatch(()=>{var E,C;this.isThreeDMode()||((E=this.grapher2d)==null||E.audioGraph.checkIfSelectedItemChanged(l?l.id:void 0),this.focusLocation&&this.focusLocation.type!=="graph-paper"&&((C=this.grapher2d)==null||C.audioGraph.exitAudioTrace()))})}getOpenMenuIconSelector(){let e=this.getOpenItemMenu();return e?`[dcg-open-menu-guid="${e.guid}"]`:void 0}getOpenMenuIcon(){let e=this.getOpenMenuIconSelector();return e?this.findEl(e):void 0}propagateSelection(){let e=this.getGrapher();e?this.__lastSelectedIdsForPropagation=Kq(this,e,this.__lastSelectedIdsForPropagation):this.__lastSelectedIdsForPropagation={}}propagateActiveTokens(){var e,t;this.isThreeDMode()||((e=this.grapher2d)==null||e.setActiveToken(this.getExpressionIdForIdentifier(this.activeTokens.selected),"selected"),(t=this.grapher2d)==null||t.setActiveToken(this.getExpressionIdForIdentifier(this.activeTokens.hovered),"hovered"))}getHoveredOrFocusedTokenIdentifier(){if(this.activeTokens.hovered)return this.activeTokens.hovered;let e=this.getFocusLocation();if(e&&e.type==="geo-token")return e.identifier}doesLatexContainToken(e){return O4(e)}getToolPreviewJSONState(){return this.toolPreviewJSONState}removeListOfItems(e){let t={},i=[],o=new Set;return e.forEach(n=>{if(this.isItemReadonly(n))o.add(n);else{let a=sx(this.listModel,n);for(let s of a)t[s.id]||(t[s.id]=!0,i.push(s))}}),{deletedItems:i,readonlyItemsNotDeleted:o.size}}garbageCollectGeo(e,t){if(!this.isGeometry())return;let i=F9(this,e,t);i.length&&this.removeListOfItems(i)}ensureAtLeastOneVisibleItem(){if(WK(this.listModel)){let e=this.createItemModel({type:"expression",id:this.generateId(),color:this.getNextColor()});Bd(this.listModel,e)}}getExpressionIdForIdentifier(e){if(e){var t=this.getItemsByIdentifier(e);if(t.length===1)return t[0].id}}getValidCursorContext(){var o;let e=this.getSelectedItem();if(!e||e.type!=="expression")return;let t=e.formula.cursor_context,i=(o=Ze.getFocusedMathquill())==null?void 0:o.selection();if((t==null?void 0:t.type)==="expression-arguments"){let{argIndex:n,positionWithinArg:a}=t;if(!(n===t.argCount-1&&a==="end"||t.positionWithinArg==="start-to-end"&&(i==null?void 0:i.startIndex)!==void 0&&(i==null?void 0:i.startIndex)===(i==null?void 0:i.endIndex)))return}if((e==null?void 0:e.type)==="expression"&&e.latex===(t==null?void 0:t.selection.input)&&(i==null?void 0:i.startIndex)===(t==null?void 0:t.selection.start)&&(i==null?void 0:i.endIndex)===(t==null?void 0:t.selection.end)&&(i==null?void 0:i.latex)===(t==null?void 0:t.selection.input))return t}tryInsertTokenIntoMathquill(e,t){if(!this.isGeometry()||!e)return!1;var i=this.getItemModel(e);if(!i||i.type!=="expression")return!1;let o=i.formula.typed_constant_value;t===0&&(!o||!__dcg_shared_module_exports__['db'](o.valueType))&&(t=void 0);var n,a,s=sa(i);if(s?a=__dcg_shared_module_exports__['ub'](s):i.formula.geometry&&(a=this.getAutonameLatexForExpression(i),n=a),!a)return!1;t!==void 0&&(a+="\\left["+(t+1)+"\\right]");var l=this.getFocusLocation();if(!l||!this.seemsLikeInsertingTokenWillImproveThings(o==null?void 0:o.valueType))return!1;var c=l.type==="expression";return c?(n&&(mo(i)==="NONE"&&i.dragMode==="AUTO"&&df(i,"NONE"),gl(i,n+"="+i.latex)),this.writeIdentifierIntoCurrentMathquill(a),!0):!1}seemsLikeInsertingTokenWillImproveThings(e){let t=this.getValidCursorContext();if(t){if(!e)return!1;let i=__dcg_shared_module_exports__['db'](e)?__dcg_shared_module_exports__['eb'](e):e;return(t.type==="expression-arguments"?t.allowedTypesForInsertedArg:t.allowedTypes).some(n=>__dcg_shared_module_exports__['gb'](i,n))}return!1}writeIdentifierIntoCurrentMathquill(e){this.runAfterDispatch(()=>{let t=this.getValidCursorContext(),i=Ze.getFocusedMathquill();if(!i)return;let o="",n="";(t==null?void 0:t.type)==="expression-arguments"&&((t==null?void 0:t.positionWithinArg)==="end"?o=",":(t==null?void 0:t.positionWithinArg)==="start"&&(n=","));let a=`${o}${e}${n}`,s=!1;if((t==null?void 0:t.type)==="expression-arguments"&&t.polygonVertices){let{argIndex:l,polygonVertices:c,positionWithinArg:d}=t;(e===c.firstLatex||e===c.lastLatex)&&(d==="end"||d==="start-to-end")&&l===t.argCount-1&&(a="",s=!0)}else(t==null?void 0:t.type)==="expression-arguments"&&(s=t.isLastValidArg);Ze.canAcceptText(i,this.getCapExpressionSize(),a)&&(i.write(a),Ze.simulateUserChangedLatex(i),s&&i.keystroke("Right"))})}getSelectedExpressionIds(){return jK(this.listModel)}getPropagatedSelectedIds(){return this.__lastSelectedIdsForPropagation}areParsableObjectsEqual(e,t){return e===t?!0:__dcg_shared_module_exports__['E']({...e,regressionParameters:void 0},{...t,regressionParameters:void 0})}requestParseForAllItems(){var o,n,a;(this.isCurrentlyDoingSetState||this.isCurrentlyDoingRestoreState)&&(this.lastParsableObjects={},this.evaluator.clearStatementsAndStartCompleteState(),this.isCurrentlyDoingRestoreState&&this.evaluator.markUndoRedoState());var e={},t=this.lastParsableObjects;for(let s of this.getAllItemModels())switch(s.type){case"expression":case"image":case"table":e[s.guid]=s.cachedParsableState;break;case"folder":case"text":break;default:return s}for(let s of _K(this.listModel))e[s.guid]=s.cachedParsableState;for(let s of ix(this.listModel)){let l=this.getSelectedItem(),c=this.activeTool==="polygon";if(this.activeTool==="expression-edit"&&(l==null?void 0:l.type)==="expression"&&((n=(o=l.formula.geometry)==null?void 0:o.call)==null?void 0:n.symbol)==="polygon"&&((a=l.formula.cursor_context)==null?void 0:a.type)==="expression-arguments"){let{positionWithinArg:d,argIndex:p}=l.formula.cursor_context;c=(d==="end"||d==="start-to-end")&&p===l.formula.geometry.call.parents.length-1}e[s.guid]={...s.cachedParsableState,shouldOmitLastPolygonSegment:c}}let i=this.getFocusedItem();if((i==null?void 0:i.type)==="expression"){let s=Ze.getFocusedMathquill(),l=s==null?void 0:s.selection();(l==null?void 0:l.latex)===i.latex&&(e[i.guid]={...i.cachedParsableState,latexSelection:{start:l.startIndex,end:l.endIndex}})}if(this.is3dProduct()&&this.getTranslucentSurfaces())for(let s in e){let l=e[s];l.type==="statement"&&(e[s]={...l,fillOpacity:q9})}this.listModel.ticker.cachedParsableState&&(e[this.listModel.ticker.guid]=this.listModel.ticker.cachedParsableState);for(let s of vK(this.geometryToolbarModel))e[s.id]=s;for(let s in t){let l=t[s],c=e[s];if(l.type==="image"&&(!c||c.type!==l.type||c.guid!==l.guid)&&this.grapher2d&&this.grapher2d.removeGraphImage(l.id),!c&&(this.evaluator.removeStatement(l.id),l.type==="table"))for(let d of l.columns)this.evaluator.removeStatement(d.id)}for(let s in e){let l=e[s],c=t[s];if(l.type==="image"&&(!c||l.type!==c.type||l.guid!==c.guid)&&this.grapher2d){let d=this.getItemModel(l.id);d&&d.type==="image"&&this.grapher2d.addGraphImage(d)}this.areParsableObjectsEqual(l,c)||(this.grapher2d&&l.type==="statement"&&l.latex===""&&this.grapher2d.removeGraphSketch(l.id),this.evaluator.addStatement(l))}this.lastParsableObjects=e}getViewState(){let e=this.getGrapher();if(e){let t=e.getProjection();return{viewport:t.viewport.toObject(),screen:t.screen,xAxisScale:t.settings.xAxisScale,yAxisScale:t.settings.yAxisScale,degreeMode:t.settings.degreeMode}}else return}getTokenRenderInfoByIdentifier(e){let t=this.cachedGeoTokenInfo[e];return t||(t={iconType:"unknown",isList:!1,hasError:!0,isSelected:!1,groupType:"unknown",color:"",isHidden:!1,label:"",calcId:""}),t}setEvaluator(e){this.evaluator=e}getEvaluator(){return this.evaluator}setGrapher2d(e){this.grapher2d=e}setGrapher3d(e){this.grapher3d=e,this.grapher2d.poiController.add3DTouchEventHandlers(e)}getGrapher(){return this.isThreeDMode()?this.grapher3d:this.grapher2d}getGrapher2d(){return this.grapher2d}getGrapher3d(){return this.grapher3d}get2dPOIController(){var e;return(e=this.grapher2d)==null?void 0:e.poiController}isDefaultViewportRestored(){var e;return!!((e=this.getGrapher())!=null&&e.viewportController.isDefaultViewportRestored())}requestRedrawGraph(){var e,t;(e=this.grapher2d)==null||e.redrawAllLayers(),this.isThreeDMode()&&((t=this.grapher3d)==null||t.redrawAllLayers())}get2dProjection(){var e;return(e=this.grapher2d)==null?void 0:e.getProjection()}get2dSketchOrder(){var e;return(e=this.grapher2d)==null?void 0:e.getSketchOrder()}getBoundingBoxesForZoomFit(e){if(!(!this.grapher2d&&!this.grapher3d)&&this.isZoomFitEnabled()&&!(e.type!=="expression"&&e.type!=="table")&&!(e.type==="expression"&&(e.error||!e.shouldGraph||!e.formula.is_graphable)))return e.boundingBoxes}isExpressionZoomFit(e){if(this.isThreeDMode())return!1;let t=this.getBoundingBoxesForZoomFit(e),i=this.get2dProjection();return!i||!t?!1:!wR(t,i)&&!!LE(t,i)}viewportIsLocked(){return this.getLockViewportConfigSetting()||this.getLockViewportUserSetting()}showExpressionZoomFitButton(e){if(this.viewportIsLocked()||this.isGeometry()||this.is3dProduct())return!1;let t=this.getBoundingBoxesForZoomFit(e),i=this.get2dProjection();return!!(i&&t&&wR(t,i))}setBugsnagContext(e){this.bugsnagContext=e}getItemRootNodeById(e){let t=this.getItemModel(e);if(t&&t.dcgView)return t.dcgView.findRootNode()}getItemNodeById(e){return this.getItemRootNodeById(e)}generateId(){var e=this.__nextItemId;return this.__nextItemId+=1,e+""}getNextColor(){return MK(this.listModel)}getNextDisplayIndex(){return this.listModel.nextDisplayIndex}_clearPendingImageUploads(){this.__pendingImageUploads={}}isUploadingImages(){return Object.keys(this.__pendingImageUploads).length>0}getExpressionAnalysis(){return this.listModel.expressionAnalysis}createItemModel(e){return Qy(this.listModel,e)}getItemModel(e,t){return zp(this.listModel,e,t)}getHiddenGeoItemCount(){return HK(this.listModel)}getColorById(e){let t=this.getItemModel(e);return!t||t.type!=="expression"?"":v_(t)}getAllColorAssignments(){let e=[];for(let t of this.getAllItemModels()){if(t.type!=="expression")continue;let i=sa(t);if(!i)continue;let o=this.getEvaluationValueForItem(t.id);(typeof o=="string"||Array.isArray(o)&&typeof o[0]=="string")&&e.push({id:t.id,assignmentLatex:__dcg_shared_module_exports__['ub'](i)})}return e}getAllColorFunctionAssignments(){let e=[];if(!this.isBeta3DMode())return e;for(let t of this.getAllItemModels()){if(t.type!=="expression")continue;let i=sa(t),o=G_(t);!i||!o||e.push({id:"shader",assignmentLatex:"shader:"+__dcg_shared_module_exports__['ub'](i)})}return e}getShader(e){for(let t of this.getAllItemModels()){if(t.type!=="expression")continue;let i=sa(t);if(i&&__dcg_shared_module_exports__['ub'](i)===e){let o=G_(t);if(o)return o}}return{source:"",shaderFunctions:{},shaderUniforms:[]}}getItemModelByIndex(e){return ex(this.listModel,e)}getItemCount(){return kC(this.listModel)}getItemEditableLabelMode(e){let t=this.getItemModel(e);if(!(!t||t.type!=="expression"))return j4(t)}isItemSecret(e){let t=this.getItemModel(e);return t?DC(t):!1}isItemMarkedReadonly(e){let t=this.getItemModel(e);return t?!this.isListEnabled()&&!this.isItemInGeoFolder(e)?!0:LK(t):!1}isItemReadonly(e){return this.isItemMarkedReadonly(e)&&!this.shouldShowAuthorFeatures()}isItemSelected(e){let t=this.getItemModel(e);return!!t&&Na(t)}hasAnyItemsSelected(){return this.getAllSelectedItems().length>0}hasMultipleItemsSelected(){return this.getAllSelectedItems().length>1}isItemSelectable(e){let t=this.getItemModel(e);return t?rx(t):!1}anyItemDependsOnRandomSeed(){return rq(this.listModel)}areActionsEnabled(){return this.graphSettings.config.actions==="auto"?iq(this.listModel):!!this.graphSettings.config.actions}getAllItemModels(){return cO(this.listModel)}getAllToolPreviewItems(){return ix(this.listModel)}isToolPreviewItem(e){return zK(this.listModel,e)}getAllModelsWithSliders(){return $K(this.listModel)}getGraphSettings(){return this.graphSettings}getAudioGraph(){var e;if(!this.isThreeDMode())return(e=this.grapher2d)==null?void 0:e.audioGraph}inAudioTraceMode(){let e=this.getAudioGraph();return!!(e&&e.audioTraceActive)}canAudioTrace(){let e=this.getAudioGraph();return e?e.canAudioTraceCurrentExp():!1}isAudioTracing(){let e=this.getAudioGraph();return e?e.isAudioTracing():!1}expressionsAreFullWidth(){return this.isNarrow()||this.graphSettings.config.graphpaper===!1}getExpListWidthString(){return this.expressionsAreFullWidth()?"100%":this.rootElt?this._getExpListWidth()+"px":"0"}getExpListWidth(){return this.rootElt?this._getExpListWidth():0}findFirstVisibleItem(){let e=A9(this,this._previousFirstVisibleId);if(this._previousFirstVisibleId=e,e)return this.getItemModel(e)}findLastVisibleItem(){let e=V9(this,this._previousLastVisibleId);if(this._previousLastVisibleId=e,e)return this.getItemModel(e)}updateRenderShellsAfterDispatch(){if(!this.rootElt||!this.isListVisible())return;let e=this.findFirstVisibleItem(),t=this.findLastVisibleItem();var i=e&&this.getItemRootNodeById(e.id),o=t&&this.getItemRootNodeById(t.id);if(i===this.lastInfiniteScrollFirstDOM&&o===this.lastInfiniteScrollLastDOM&&!this.hasDispatchSinceLastInfiniteScrollUpdate)return;this.lastInfiniteScrollFirstDOM=i,this.lastInfiniteScrollLastDOM=o,this.hasDispatchSinceLastInfiniteScrollUpdate=!1;let n=!1,a=e?e.index:1/0,s=t?t.index:1/0,l=this.listModel.dragState&&this.listModel.dragState.firstItemId,c,d=this.getOpenItemMenu();d&&d.type!=="multi-select-more"&&d.type!=="multi-select-transformations"&&d.type!=="geo-tool-dropdown"&&(c=d.model.id);for(let g of this.getAllItemModels()){var p=(g.index<a||g.index>s||g.isHiddenFromUI)&&!(g.type==="expression"&&g.sliderDragging);if(l==g.id&&(p=!1),c===g.id&&(p=!1),g.renderShell!==p&&(g.renderShell=p,n=!0,p)){let h=this.getItemRootNodeById(g.id);if(h){let f=h.getBoundingClientRect().height;f>0&&(g.cachedRenderHeight=f)}}}n&&this.markTickRequiredNextFrame()}updateRenderShellsBeforePaint(){if(this.hasDispatchSinceLastInfiniteScrollUpdate=!0,this.inPrintMode){for(let t of this.getAllItemModels())t.renderShell=!1;return}for(let t of this.getAllItemModels())t.isHiddenFromUI&&(t.renderShell=!0),t.type==="expression"&&t.sliderDragging&&(t.renderShell=!1);let e=this.getSelectedItem();e&&!this.isGeoItem(e.id)&&(e.renderShell=!1)}updateDragDrop(){let e=this.listModel.dragState;if(!e)return;let t=this.getItemModel(e.firstItemId);if(!t)return;let i=this.dragdrop_expressions.applyDrag();i&&(GC(this.listModel,i.dragState),Ba(t,i.folderId),t.index!==i.newIndex&&Mg(this.listModel,t.index,i.newIndex,e.numberOfItems))}_tickSliders(e){this.getPlayingSliders().forEach(function(t){C4(t,e)})}tickTicker(e){let t=this.listModel.ticker.lastTickTime===void 0;this.evaluator.addClockTickEvent(this.listModel.ticker.id,t),cK(this.listModel.ticker,e)}stopAllSliders(){for(let e of this.getAllItemModels())e.type==="expression"&&e.slider.isPlaying&&$l(e,!1)}getPlayingSliders(){var e=this.getAllItemModels(),t=[];for(let i of e)i.type==="expression"&&i.sliderExists&&i.slider.isPlaying&&t.push(i);return t}areAnyImagesLoading(){return TK(this.listModel)}_commitUserRequestedViewport(e){var t;(t=this.getGrapher())==null||t.setUserRequestedViewport(e)}_setAxisLimitLatex(e,t){this.settingsViewModel={...this.settingsViewModel,limitLatex:{...this.settingsViewModel.limitLatex,[e]:t}};let o=t===""&&(e==="xstep"||e==="ystep")?0:Bi(t,this.graphSettings.degreeMode),n=this.getGrapher();switch(e){case"xstep":{if(!yy(o))return;this.graphSettings.setProperty("xAxisStep",o)}break;case"ystep":{if(!yy(o))return;this.graphSettings.setProperty("yAxisStep",o)}break;case"xmin":case"xmax":case"ymin":case"ymax":case"zmin":case"zmax":{if(!n)return;let a=n.viewportController.getViewport(),s="xmin";e==="xmin"&&(s="xmax"),e==="ymax"&&(s="ymin"),e==="ymin"&&(s="ymax"),e==="zmax"&&(s="zmin"),e==="zmin"&&(s="zmax");let l=Bi(this.settingsViewModel.limitLatex[s]||"",this.graphSettings.degreeMode),c=di.fromObject({...a.toObject(),[e]:o,[s]:l});if(!c.isValid(this.getAxisScaleSettings()))return;n.viewportController.setViewport(c);let p;switch(e){case"xmin":case"xmax":p="x";break;case"ymin":case"ymax":p="y";break;case"zmin":case"zmax":p="z";break;default:let g=e;throw new Error(`Invalid limit: ${g}`)}this.graphSettings.setProperty("lastChangedAxis",p),this.markSquareAxesAfterUserEditedViewport()}break}if(n){let a=n.viewportController.getViewport().toObject();this._commitUserRequestedViewport(a)}}unmarkLastChangedAxis(){this.graphSettings.setProperty("lastChangedAxis",void 0)}markSquareAxesAfterUserEditedViewport(){let e=this.getGrapher();if(!e)return;let t=e.viewportController.getViewport(),i=this.isThreeDMode()?t.isSquare3D():t.isSquare(e.getProjection().screen,this.getAxisScaleSettings());this.graphSettings.setProperty("squareAxes",i)}getLockViewportConfigSetting(){return this.graphSettings.config.lockViewport}getLockViewportUserSetting(){return this.graphSettings.userLockedViewport}canUserAddExpressions(){return!!this.graphSettings.config.expressions}areNotesEnabled(){return!!this.graphSettings.config.notes}areSlidersEnabled(){return!!this.graphSettings.config.sliders}areLinksEnabled(){return!!this.graphSettings.config.links}areImagesEnabled(){let e=window.FileReader,t=ll&&Xu&&Xu[0]===8&&Xu[1]===0&&Xu[2]===0;return!!(this.graphSettings.config.images&&e&&!t&&!this.is3dProduct())}areFoldersEnabled(){return!!this.graphSettings.config.folders}isDecimalToFractionEnabled(){return!!this.graphSettings.config.decimalToFraction}isTraceEnabled(){return!!this.graphSettings.config.trace}areFunctionsRestricted(){return!!this.graphSettings.config.restrictedFunctions}areGeometryFunctionsForceEnabled(){return!!this.graphSettings.config.forceEnableGeometryFunctions}isQwertyKeyboardEnabled(){return!!this.graphSettings.config.qwertyKeyboard}isZoomFitEnabled(){return!!this.graphSettings.config.zoomFit}canEditOnWeb(){return!!this.graphSettings.config.editOnWeb}hasTransparentBackground(){return!!this.graphSettings.config.transparentBackground}shouldAudioTraceReverseExpressions(){return!!this.graphSettings.config.audioTraceReverseExpressions}hasDefaultState(){return!!this.graphSettings.defaultState}getDefaultViewport(){var t;var e=this.graphSettings.defaultState;return e&&e.graph?e.graph.viewport:(t=this.getGrapher())==null?void 0:t.getDefaultViewport()}getColors(){return this.isThreeDMode()?__dcg_shared_module_exports__['X']:this.graphSettings.config.colors}getImageOpacities(){return["0.2","0.4","0.6","0.8","1"]}getUIDragModes(){return["X","Y","XY"]}getNumberOfItemsInFolder(e){return IK(this.listModel,e)}getEnabledDragModesForItem(e){let t=this.getItemModel(e);if(!t||t.type!=="expression")return[];let i=t.formula,o=[];if(!i.move_strategy)return o;let n=i.move_strategy[0].type!=="none",a=i.move_strategy[1].type!=="none",s=n&&a;return n&&o.push("X"),a&&o.push("Y"),s&&o.push("XY"),o}shouldShowEvaluationForItem(e){let t=this.getItemModel(e);return!t||t.type!=="expression"?!1:w_(t)}getEvaluationValueForItem(e){let t=this.getItemModel(e);return t?t.type!=="expression"?NaN:v_(t):NaN}canDisplayEvaluationForItemAsFraction(e){if(!this.isDecimalToFractionEnabled())return!1;let t=this.getItemModel(e);if(!t||t.type!=="expression"||xg(t))return!1;let i=this.getEvaluationValueForItem(e);return typeof i!="number"?!1:__dcg_shared_module_exports__['qb'](i)}shouldEvaluationForItemDisplayAsFraction(e){if(!this.isDecimalToFractionEnabled())return!1;let t=this.getItemModel(e);return!t||t.type!=="expression"?!1:wg(t)}getEvaluationLabelOptionsForItem(e){return{...y4,displayAsFraction:this.shouldEvaluationForItemDisplayAsFraction(e)}}isInEditListMode(){return this.layoutModel.inEditListMode}authorFeaturesAvailable(){return!!this.graphSettings.config.authorFeatures}shouldShowAuthorFeatures(){return this.authorFeaturesAvailable()&&!!this.graphSettings.config.authorMode}shouldIgnoreGraphInteractions(e){return this.shouldShowAuthorFeatures()?!1:Yl(e)}toolWillBeHiddenOrDisabled(e){return this.shouldShowAuthorFeatures()&&(!this.isGeoToolVisible(e,{ignoreAuthorMode:!0})||!this.isGeoToolEnabled(e,{ignoreAuthorMode:!0}))}setAuthorMode(e){this.graphSettings.config.setProperty("authorMode",e)}getInvertedColors(){return!!this.graphSettings.config.invertedColors}invertSwatches(){return this.isThreeDMode()&&this.getInvertedColors()}canUseAdvancedStyling(){return this.graphSettings.config.advancedStyling}isDegreeMode(){return this.graphSettings.degreeMode}isThreeDMode(){return this.graphSettings.threeDMode}showPlane3D(){let{threeDMode:e,showAxis3D:t,showPlane3D:i}=this.graphSettings;return e&&t&&i}showNumbers3D(){let{threeDMode:e,showAxis3D:t,showNumbers3D:i}=this.graphSettings;return e&&t&&i}getTranslucentSurfaces(){return!!this.graphSettings.config.translucentSurfaces}getPerspectiveDistortion(){let e=this.graphSettings.config.perspectiveDistortion;return isNaN(e)?1:e<1e-4?0:__dcg_shared_module_exports__['Cb'](e,0,nS)}isBeta3DMode(){return this.isThreeDMode()&&pr("beta3d")}areLogModeRegressionsForced(){return this.graphSettings.config.forceLogModeRegressions}setAllRegressionsToLogMode(){for(let e of this.getAllItemModels())e.type==="expression"&&e.formula&&e.formula.is_regression&&V_(e,!0)}isGraphSettingsOpen(){return this.layoutModel.graphSettingsOpen}isAddExpressionOpen(){return this.layoutModel.addExpressionOpen}shouldRenderList(){if(this.layoutModel.expressionsVisible)return!0;var e=this.layoutModel.expressionsHiddenTime;return e===void 0?!1:Date.now()-e<=500}isListVisible(){return this.layoutModel.expressionsVisible}isGrapherEnabled(){return this.graphSettings.config.graphpaper!==!1}isListEnabled(){return this.graphSettings.config.expressions!==!1}areDistributionsEnabled(){return this.graphSettings.config.distributions===!0}isExpressionListFocused(){let e=this.getFocusLocation();if(!e)return!1;switch(e.type){case"settings":case"generic-menu":case"expression-menu":case"editable-label":case"geo-token":case"multi-select-more-icon":case"multi-select-transformations-icon":case"geo-header-back-link":case"multi-select-delete-icon":case"multi-select-show-hide-icon":case"new-transformation-number":case"label-points-icon":case"geo-show-constructions-icon":case"geo-basic-tool":case"geo-basic-tool-menu-item":case"regression-output":case"graph-paper":case"zoom-in-btn":case"zoom-restore-btn":case"quest":case"global-mute-button":return!1;case"distribution-param":case"cdf-limit":case"slider-limit":case"domain-limit":case"expression":case"visualization-prop":case"search-expressions":case"replace-expressions":case"ticker":case"table":case"image":case"readonly-expression":case"braille-output":case"table-container":case"text":case"folder":case"add-item-btn":case"add-expression-btn":case"add-note-btn":case"add-table-btn":case"add-folder-btn":case"add-ticker-btn":case"add-image-btn":case"change-image-btn":case"edit-list-toggle":case"expression-icon":case"image-icon":case"slider-icon":case"slider-animation-properties-icon":case"slider-thumb":case"table-icon":case"action-icon":case"hide-expression-list-btn":case"show-expression-list-btn":case"top-level-icon":return!0;default:return e}}needsFakeKeypad(){if(this.inAudioTraceMode()&&this.isKeypadEnabled())return!0;let e=this.getFocusLocation();if(!e||this.getBrailleMode()!=="none"&&vl())return!1;switch(e.type){case"settings":return G9(e.location);case"new-transformation-number":case"distribution-param":case"cdf-limit":case"slider-limit":case"domain-limit":case"expression":case"visualization-prop":case"search-expressions":case"replace-expressions":case"ticker":return!0;case"expression-menu":return e.location==="opacity"||e.location==="linewidth"||e.location==="lineopacity"||e.location==="pointopacity"||e.location==="pointsize"||e.location==="labelsize"||e.location==="labelangle"||e.location==="updaterule";case"table":{if(this.isInEditListMode())return!1;let o=e.location;if(o.row===0)return!0;var t=this.getItemModel(e.id);if(!t||t.type!=="table")return!1;let n=t.columnModels[o.column];return n?!n.disabled:!1}case"image":return e.location!=="name";case"readonly-expression":case"braille-output":case"regression-output":case"graph-paper":case"table-container":case"text":case"folder":case"add-item-btn":case"add-expression-btn":case"add-note-btn":case"add-table-btn":case"add-folder-btn":case"add-ticker-btn":case"add-image-btn":case"change-image-btn":case"edit-list-toggle":case"hide-expression-list-btn":case"show-expression-list-btn":case"geo-token":case"multi-select-more-icon":case"multi-select-transformations-icon":case"geo-header-back-link":case"multi-select-delete-icon":case"multi-select-show-hide-icon":case"label-points-icon":case"geo-show-constructions-icon":case"geo-basic-tool":case"geo-basic-tool-menu-item":case"generic-menu":case"zoom-in-btn":case"zoom-restore-btn":case"quest":case"global-mute-button":return!1;case"expression-icon":case"image-icon":case"slider-icon":case"action-icon":case"slider-animation-properties-icon":case"slider-thumb":case"table-icon":case"top-level-icon":return!1;case"editable-label":return this.getItemEditableLabelMode(e.id)==="MATH";default:return e}}isIdentifierRenameValid(e){return ul(e)?!OK(this.listModel,e):!1}getBrandingMode(){return this.getEditLink()?"static-edit-link":this.getGraphSettings().config.editOnWeb?"edit-link":"powered-by"}getEditLink(){return window.iframeEmbedBrandingLink}_expressionZoomFit(e,t,i=!1){let o=this.getItemModel(e);if(this.isThreeDMode()||!this.grapher2d||!this.isZoomFitEnabled()||!o||o.type!=="expression"&&o.type!=="table"||!o.boundingBoxes||!o.boundingBoxes.length)return!1;var n=this.grapher2d.viewportController;if(!("zoomCustom"in n))return!1;let a=LE(o.boundingBoxes,n.getProjection());return a?(i?n.setViewport(di.fromObject(a)):n.zoomCustom(a),t&&Vi(this,{type:"zoom-restore-btn"}),!0):!1}_deleteItemAndAnimateOut(e,t){let o=this.getItemNodeById(e);o&&(aa(o,{transition:.2+"s",opacity:"0",transform:"scale(.1, .1)"}),setTimeout(()=>{this.dispatch({type:"finish-deleting-item-after-animation",id:e,setFocusAfterDelete:t})},1e3*.2))}_finishDeletingItemAfterAnimation(e,t){let i=this.getItemModel(e);if(!i)return;let o=this.getItemNodeById(e),n=o&&document.activeElement&&o.contains(document.activeElement),a=bf(this.listModel,i.index);if(this._removeExpressionSynchronously(i),!(!t||!n)){if(!a){let s=tx(this.listModel);s&&(a=s)}a&&Xn(this,a.id,"end")}}_removeExpressionSynchronously(e){let t=ax(this.listModel,e.index);this.garbageCollectGeo(t,{}),this.ensureAtLeastOneVisibleItem()}setRootElt(e){this.rootElt=e,this.dragdrop_expressions=new OE(this)}getRootElt(){return this.rootElt}_hideExpressions(e){this.graphSettings.config.expressions&&(vi(this.listModel,void 0),this.layoutModel={...this.layoutModel,expressionsVisible:!1,expressionsHiddenTime:Date.now()},e?Vi(this,{type:"show-expression-list-btn"}):pi())}_showExpressions(e){this.graphSettings.config.expressions&&(this.layoutModel={...this.layoutModel,expressionsVisible:!0},e?Vi(this,{type:"hide-expression-list-btn"}):pi())}_showToast(e){this.toastData=e,clearTimeout(this._hideToastTimeout);let t=typeof e.hideAfter=="number"?e.hideAfter:6e3;t>0&&(this._hideToastTimeout=setTimeout(()=>{this.dispatch({type:"toast/close",onHide:this.toastData.onHide})},t))}_setExpressionPropertiesFromAPI(e,t){let i=this.getItemModel(e);if(i)if(i.type==="table"&&t.columns){t=__dcg_shared_module_exports__['Z'](t);let a=Mq(i,t);var o=Qy(this.listModel,a);this._toplevelReplaceItemAt(i.index,o,!1)}else{let a=this.getItemModel(e);if(!a)return;for(var n in t)if(t.hasOwnProperty(n))switch(n){case"slider":{if(a.type!=="expression")continue;let s=t[n];s.hasOwnProperty("min")&&Py(a,s.min),s.hasOwnProperty("max")&&_y(a,s.max),s.hasOwnProperty("step")&&uC(a,s.step),s.hasOwnProperty("isPlaying")&&$l(a,s.isPlaying)}break;case"polarDomain":{if(a.type!=="expression")continue;ml(a,__dcg_shared_module_exports__['Nc'](t.polarDomain.min),"theta"),fl(a,__dcg_shared_module_exports__['Nc'](t.polarDomain.max),"theta")}break;case"parametricDomain":{if(a.type!=="expression")continue;ml(a,__dcg_shared_module_exports__['Nc'](t.parametricDomain.min),"t"),fl(a,__dcg_shared_module_exports__['Nc'](t.parametricDomain.max),"t")}break;case"parametricDomain3Du":{if(a.type!=="expression")continue;ml(a,__dcg_shared_module_exports__['Nc'](t.parametricDomain3Du.min),"u"),fl(a,__dcg_shared_module_exports__['Nc'](t.parametricDomain3Du.max),"u")}break;case"parametricDomain3Dv":{if(a.type!=="expression")continue;ml(a,__dcg_shared_module_exports__['Nc'](t.parametricDomain3Dv.min),"v"),fl(a,__dcg_shared_module_exports__['Nc'](t.parametricDomain3Dv.max),"v")}break;case"parametricDomain3Dr":{if(a.type!=="expression")continue;ml(a,__dcg_shared_module_exports__['Nc'](t.parametricDomain3Dr.min),"r"),fl(a,__dcg_shared_module_exports__['Nc'](t.parametricDomain3Dr.max),"r")}break;case"parametricDomain3Dphi":{if(a.type!=="expression")continue;ml(a,__dcg_shared_module_exports__['Nc'](t.parametricDomain3Dphi.min),"phi"),fl(a,__dcg_shared_module_exports__['Nc'](t.parametricDomain3Dphi.max),"phi")}break;case"hidden":this._setItemHidden(e,t.hidden);break;case"secret":fO(a,t.secret);break;case"readonly":$G(a,t.readonly);break;case"color":{if(a.type!=="expression")continue;zk(a,t.color)}break;case"dragMode":{if(a.type!=="expression")continue;df(a,t.dragMode)}break;case"label":{if(a.type!=="expression")continue;sh(a,t.label)}break;case"showLabel":{if(a.type!=="expression")continue;cf(a,t.showLabel)}break;case"labelSize":{if(a.type!=="expression")continue;bC(a,t.labelSize)}break;case"labelOrientation":{if(a.type!=="expression")continue;R_(a,t.labelOrientation)}break;case"latex":if(a.type!=="expression")continue;gl(a,t.latex);break;case"points":if(a.type!=="expression")continue;P_(a,!!t.points);break;case"lines":if(a.type!=="expression")continue;O_(a,!!t.lines);break;case"pointStyle":if(a.type!=="expression")continue;__(a,t.pointStyle);break;case"pointSize":case"movablePointSize":if(a.type!=="expression")continue;mC(a,t.pointSize);break;case"pointOpacity":if(a.type!=="expression")continue;gC(a,t.pointOpacity);break;case"lineStyle":if(a.type!=="expression")continue;qk(a,t.lineStyle);break;case"lineWidth":if(a.type!=="expression")continue;Fy(a,t.lineWidth);break;case"lineOpacity":if(a.type!=="expression")continue;Ry(a,t.lineOpacity);break;case"fill":if(a.type!=="expression")continue;L_(a,t.fill);break;case"fillOpacity":if(a.type!=="expression")continue;hC(a,t.fillOpacity);break;case"id":case"type":case"domain":break;default:throw new Error("trying to call setProperty for: "+n)}}}_isParentFolderHidden(e){let t=this.getItemModel(e);if(!t)return!1;let i=bl(t);return i?i.hidden:!1}_toggleItemHidden(e){var t;if(this._isParentFolderHidden(e))this._setItemHidden(e,!1);else{let i=this.getItemModel(e);if(!i)return;switch(i.type){case"expression":this._setItemHidden(e,!ls(i));break;case"image":case"folder":this._setItemHidden(e,!i.hidden);break;case"table":case"text":break;default:return i}Wl(i)&&(ls(i)||this.logEvent({category:"tone",action:ls(i)?"mute-local":"unmute-local"}),(t=this.toneController)==null||t.recomputeAudio())}}_toggleTableColumnHidden(e,t){if(this._isParentFolderHidden(e))this._setTableColumnHidden(e,t,!1);else{let i=this.getItemModel(e);if(!i||i.type!=="table")return;let o=jn(i,t);if(!o)return;this._setTableColumnHidden(e,t,!o.hidden)}}_setTableColumnHidden(e,t,i){let o=this.getItemModel(e);if(!o||o.type!=="table")return;let n=ZG(o,t);!i&&this._isParentFolderHidden(e)&&this._setItemHidden(o.folderId,!1),Oq(o,t,i),!i&&n&&wO(o,t,!0)}_setItemHidden(e,t){let i=this.getItemModel(e);if(i)switch(!t&&i.type!=="folder"&&this._isParentFolderHidden(i.id)&&this._setItemHidden(i.folderId,!1),i.type){case"expression":J4(i,t);break;case"folder":D8(i,t);break;case"image":N8(i,t);break;case"table":case"text":break;default:return i}}_addItemToEndFromAPI(e){let t=TG(this.listModel);!e.secret&&t&&t.type==="expression"&&t.latex===""&&ax(this.listModel,t.index),Bd(this.listModel,e)}copyExpressionToIndex(e,t,i){let o={stripDefaults:!1},n;switch(e.type){case"expression":n=Nk(e,o);break;case"table":n=cx(e,o),n.columns&&n.columns.forEach(s=>{s.id=this.generateId()});break;case"image":n=fG(e,o);break;case"text":n=lG(e,o);break;default:return}let a=this.createItemModel({...n,id:this.generateId()});this._toplevelInsertItemAt(t,a,!1,i||e.folderId)}_toplevelInsertItemAt(e,t,i,o){let n=t;fc(this.listModel,n,e),o&&Ba(n,o),i&&Xn(this,n.id)}_toplevelNewItemAtSelection(e,t){this.setGeoTool("selection");let i=this.getSelectedItem();if(i){let s=i.type==="expression"&&!i.latex;if(s&&!i.folderId&&(e.type!=="expression"||e.latex))return this._toplevelReplaceItemAt(i.index,e,t.shouldFocus);if(s&&i.folderId&&e.type!=="expression"&&e.type!=="folder")return this._toplevelReplaceItemAt(i.index,e,t.shouldFocus);if(i.type!=="folder"&&!i.folderId)return this._toplevelInsertItemAt(i.index+1,e,t.shouldFocus,void 0);if(i.type!=="folder"&&i.folderId&&e.type!=="folder")return this._toplevelInsertItemAt(i.index+1,e,t.shouldFocus,i.folderId);if(i.type==="folder"&&!i.collapsed&&e.type!=="folder")return this._toplevelInsertItemAt(i.index+1,e,t.shouldFocus,i.id)}let o=this.getFirstFullyVisibleItem();for(o&&o.type==="folder"&&(o=this.getItemModelByIndex(o.index+1));o&&o.type!=="folder"&&o.folderId;)o=this.getItemModelByIndex(o.index+1);let n=o?o.index:this.getItemCount();return this._toplevelInsertItemAt(n,e,t.shouldFocus,void 0)}getFirstFullyVisibleItem(){let e=ER(this);if(e)return zp(this.listModel,e)}findEl(e){if(this.rootElt)return this.rootElt.querySelector(e)||void 0}getExppanelElt(){return PE(this)}scrollItemIntoView(e){if(!this.rootElt||!this.isListVisible())return;let t=this.getItemNodeById(e.id),i=PE(this);if(!(!t||!i)){if(e.type==="table"){let o=t.querySelector(".dcg-row .dcg-selected");if(o){yc(o,i,60);return}}yc(t,i,90)}}scrollSelectedItemIntoView(){let e=this.getFirstSelectedItem();if(e){if(e&&e.type!=="folder"&&e.folderId){let t=this.getItemModel(e.folderId);t&&t.type==="folder"&&t.collapsedChildIsSelected&&(e=t)}this.scrollItemIntoView(e)}}_pasteTable(e){let t=this.getGrapher();if(!t)return;let i=MG(this.listModel),o=xO(i,e,this),n=this.createItemModel(o);this._toplevelNewItemAtSelection(n,{shouldFocus:!0}),this._closeAddExpression();let a=t.getProjection(),s=a.viewport,l=__dcg_shared_module_exports__['h'](e[0],function(p){return parseFloat(p)}),c=__dcg_shared_module_exports__['h'](e[1],function(p){return parseFloat(p)});if(this.is3dProduct())return;let d={xmin:__dcg_shared_module_exports__['o'](l),xmax:__dcg_shared_module_exports__['n'](l),ymin:__dcg_shared_module_exports__['o'](c),ymax:__dcg_shared_module_exports__['n'](c),type:"table"};if(isFinite(d.xmin)&&isFinite(d.xmax)&&isFinite(d.ymin)&&isFinite(d.ymax)&&(d.xmax>s.xmax||d.xmin<s.xmin||d.ymax>s.ymax||d.ymin<s.ymin)){let p=LE([d],a);if(p&&!this.viewportIsLocked()){let g=new di(p.xmin,p.xmax,p.ymin,p.ymax);t.viewportController.setViewport(g),this._showToast({message:this.s("graphing-calculator-text-toast-zoom-to-fit"),undoCallback:()=>{this.dispatch({type:"undo"})}}),this.markSquareAxesAfterUserEditedViewport()}}}_insertSeveralExpressions(e){for(var t=0;t<e.length;t++){let i;i=this.createItemModel(e[t]),this._toplevelNewItemAtSelection(i,{shouldFocus:!0})}}_appendNumberList(e){let t=this.getSelectedItem();if(t&&t.type==="expression"){let i=t.latex,o=this.createItemModel({type:"expression",id:this.generateId(),latex:i+e});return this._toplevelReplaceItemAt(t.index,o,!0)}}_openOnWeb(){this.runAfterDispatch(()=>{let e=this.getGrapher();if(!e)return;let t=JSON.stringify(this.getState()),i=e.screenshot({width:100,height:100}),a=(this.getGraphSettings().config.crossOriginSaveTest?"/":"https://www.desmos.com/")+"api/v1/calculator/cross_origin_save",s=document.createElement("div");FY.mountToNode(H1,s,{stateData:()=>t,thumbData:()=>i,saveURL:()=>a}),this.rootElt.append(s);let l=s.querySelector("form[name=open_graph_on_web]");ie(l).trigger("submit"),s.remove()})}notifyBugsnagAboutMissingSelectedItem(e,t){let i=nx(this.listModel);var o="";try{i?o=JSON.stringify(i.cachedUndoRedoFullState,null,2):o="undefined"}catch(s){o="[[could not stringify]]"}var n="";try{if(!i)n="undefined";else{let s={id:i.id,index:i.index,displayIndex:i.index,secretIndex:i.secretIndex,guid:i.guid,renderShell:i.renderShell,isHiddenFromUI:i.isHiddenFromUI,hasDCGView:!!i.dcgView,cachedRenderHeight:i.cachedRenderHeight};n=JSON.stringify(s,null,2)}}catch(s){n="[[could not stringify]]"}var a="";try{a=JSON.stringify(uO(this.listModel),null,2)}catch(s){a="[[could not stringify]]"}Ii("ReplaceItemAtError: no item at index",{metaData:{index:e,shouldFocus:t,selectedModelJSON:n,selectedItemJSON:o,listStateJSON:a}})}_toplevelReplaceItemAt(e,t,i){let o=t,n=this.getItemModelByIndex(e);n||this.notifyBugsnagAboutMissingSelectedItem(e,i);let a=n.type!=="folder"&&n.folderId;ax(this.listModel,e),fc(this.listModel,o,e),a&&Ba(o,a),i&&Xn(this,o.id)}convertImageToDraggable(e){let t=this.getItemModel(e);if(!t||t.type!=="image")return;let i=t.folderId,o=t.index+1,n=t.center,a=MG(this.listModel),s=__dcg_shared_module_exports__['ub']("C_"+a),l=this.createItemModel({id:this.generateId(),type:"expression",latex:s+"="+n,dragMode:"XY",hidden:!0});fc(this.listModel,l,o),i&&Ba(l,i),jl(t,"center",s),Q_(t,!0),Z_(t,!0)}createSlidersForItem(e,t){let i=this.getItemModel(e);if(!i)return;let o=i.type!=="folder"&&i.folderId;return this.createSliders({model:i,folderId:o,index:i.index+1},t)}createSlidersForTicker(e){return this.createSliders({model:this.listModel.ticker,folderId:!1,index:0,doNotChangeFocus:!0},e)}createSliders({model:e,folderId:t,index:i,doNotChangeFocus:o},n){var a=[];e.type==="ticker"?vG(e,(g,h)=>{a.push({latex:g,location:h})}):Jy(e,(g,h)=>{a.push({latex:g,location:h.location})});var s=y9(a,n,{degreeMode:this.graphSettings.degreeMode});let l=e.formula?e.formula.action_value:void 0;for(var c=n.map(g=>{var h=s[g],f="1";h&&h.value!==void 0&&(f=h.value);var y;g===""?y="":l&&l.hasOwnProperty(g)?y=l[g]:y=__dcg_shared_module_exports__['ub'](g)+"="+f;var x={type:"expression",id:this.generateId(),latex:y,color:this.getNextColor(),hidden:!!y};return h&&(h.min!==void 0&&(x.slider||(x.slider={}),x.slider.hardMin=!0,x.slider.min=h.min),h.max!==void 0&&(x.slider||(x.slider={}),x.slider.hardMax=!0,x.slider.max=h.max),h.step!==void 0&&(x.slider||(x.slider={}),x.slider.step=h.step)),x}),d=c.length-1;d>=0;d--){let g=this.createItemModel(c[d]);fc(this.listModel,g,i),t&&Ba(g,t)}if(o)return;let p=c[c.length-1];p.latex===""?Xn(this,p.id):Vi(this,void 0)}_uploadImagesAndWaitForThemToLoad(e){let{files:t,id:i}=e;if(!t||t.length===0){this._showToast({message:this.s("graphing-calculator-text-toast-no-file-selected")});return}if(i&&t.length>1){this._showToast({message:this.s("graphing-calculator-text-toast-choose-one-file")});return}let o=J8({controller:this,files:t,id:i}),n=o.errors[0];n&&this._showToast({message:n});for(let a of o.tokens)this.__pendingImageUploads[a]=!0;this.isUploadingImages()&&this._showToast({message:this.s("graphing-calculator-text-toast-uploading-images"),onHide:()=>{this._clearPendingImageUploads()}})}getImageToRetry(){let e;for(let t of this.getAllItemModels())t.type==="image"&&t.loadStatus==="failed"&&(!e||e.failures>t.failures)&&(e=t);return e}retryLoadingFailedImage(e){let t=Date.now(),i=t-this.imageRetryState.lastAttemptTime,o=1e3*Math.pow(2,this.imageRetryState.attempts);this.imageRetryState.attempts>0&&i<o||(tO(e),this.imageRetryState={lastAttemptTime:t,attempts:this.imageRetryState.attempts+1})}getSelectedItem(){return nx(this.listModel)}getFirstSelectedItem(){let e=this.getAllSelectedItems(),t=e[0];if(t){for(let i=1;i<e.length;i++){let o=e[i];o.index<t.index&&(t=o)}return t}}getAllSelectedItems(){return AG(this.listModel)}getOpenItemMenu(){return this.listModel.openItemMenu}isItemSettingsMenuOpen(e){var t=this.listModel.openItemMenu;return t?t.guid===e:!1}closeItemSettingsMenu(){let e=this.getOpenItemMenu();e!==void 0&&(e.focusFirstOption&&(e.previousFocusLocation!==void 0?Vi(this,e.previousFocusLocation):this.focusOpenMenuIcon()),this.listModel.openItemMenu=void 0)}focusOpenMenuIcon(){let e=this.getOpenItemMenu();e&&(e.type==="slider"?this.dispatch({type:"set-focus-location",location:{type:"slider-animation-properties-icon",id:e.model.id}}):e.type==="image"?this.dispatch({type:"set-focus-location",location:{type:"image-icon",id:e.model.id}}):e.type==="table-column"?this.dispatch({type:"set-focus-location",location:{type:"table-icon",id:e.model.table.id,columnId:e.model.id}}):e.type==="geo-tool-dropdown"?this.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:e.tools[0]}}):e.type==="multi-select-more"?this.dispatch({type:"set-focus-location",location:{type:"multi-select-more-icon"}}):e.type==="multi-select-transformations"?this.dispatch({type:"set-focus-location",location:{type:"multi-select-transformations-icon"}}):this.dispatch({type:"set-focus-location",location:{type:"expression-icon",id:e.model.id}}))}getFocusedItem(){return w9(this)}getFocusLocation(){return this.focusLocation}isFocusLocationFocused(e){let t=this.focusLocation,i=e;return!t||!i?!1:__dcg_shared_module_exports__['E'](t,i)}isCurrentFocusLocationValid(){var o;let e=this.focusLocation;if(!e)return!0;if(e.type==="settings")return e.location==="icon"||this.isGraphSettingsOpen();if(e.type==="add-item-btn"||e.type==="edit-list-toggle"||e.type==="hide-expression-list-btn"||e.type==="show-expression-list-btn")return this.isListEnabled();if(e.type==="add-expression-btn"||e.type==="add-table-btn")return this.layoutModel.addExpressionOpen;if(e.type==="add-note-btn")return this.layoutModel.addExpressionOpen&&this.areNotesEnabled();if(e.type==="add-folder-btn")return this.layoutModel.addExpressionOpen&&this.areFoldersEnabled();if(e.type==="add-ticker-btn")return this.layoutModel.addExpressionOpen&&this.areActionsEnabled();if(e.type==="add-image-btn")return this.layoutModel.addExpressionOpen&&this.areImagesEnabled();if(e.type==="zoom-in-btn"||e.type==="zoom-restore-btn")return!0;if(e.type==="search-expressions"||e.type==="replace-expressions")return this.expressionSearchOpen;if(e.type==="ticker")return this.listModel.ticker.open;if(e.type==="generic-menu")return!!this.getOpenItemMenu();if(e.type==="graph-paper"){let n=this.getGrapher();return!!(n&&n.getIsVisible()&&n.settings.config.graphpaper)}if(e.type==="geo-show-constructions-icon"||e.type==="geo-token"||e.type==="multi-select-more-icon"||e.type==="multi-select-transformations-icon"||e.type==="label-points-icon")return this.isGeoUIActive();if(e.type==="new-transformation-number"){let n=this.getGeoModel(),a=n.getCurrentTool(),s=n.getNonObjectsState().ui.currentTool.inputIndex,l=a.getSpec&&a.getSpec();return!!l&&!!l.inputs[s]&&!!l.inputs[s].numberInputInfo}if(e.type==="geo-header-back-link"||e.type==="multi-select-delete-icon"||e.type==="multi-select-show-hide-icon")return this.isGeoUIActive()&&this.hasAnyItemsSelected();if(e.type==="geo-basic-tool")return this.isGeoUIActive()&&e.tool!=="expression-edit";if(e.type==="regression-output")return!!this.getItemModel(e.id)&&e.parameter!=="";if(e.type==="quest")return this.getQuestIsActive();let t=this.getOpenItemMenu();if(e.type==="geo-basic-tool-menu-item")return this.isGeoUIActive()&&e.tool!==""&&t!==void 0&&t.type==="geo-tool-dropdown";if(e.type==="global-mute-button")return!!((o=this.toneController)!=null&&o.someExpressionsShouldPlayTones());let i;if(t&&t.type==="table-column"?i=t.model.table:i=this.getItemModel(e.id),!i)return!1;if(e.type==="change-image-btn")return this.listModel&&i.type==="image"&&this.areImagesEnabled();if(e.type==="expression-menu"){if(e.location==="start"||e.location==="end"||e.location==="updaterule"||e.location==="anywhere"||i.type==="table")return!0;if(i.type!=="expression")return!1;let{points:n,lines:a,fill:s}=i;_p(i)&&(s=!0);let l=__dcg_shared_module_exports__['Ic'](i.formula.expression_type,{points:n,lines:a,fill:s},c=>{Ii("getReconciledExpressionProps [Chrome Switch Bug]",{metaData:{method:"isCurrentFocusLocationValid",type:c}})});return!(!l.fill&&!l.points&&!l.lines&&!i.showLabel)}if(!this.isItemSelected(e.id)&&e.type!=="editable-label")return!1;switch(e.type){case"domain-limit":return!(i.type!=="expression"||!$k(i)&&!jk(i));case"expression-icon":case"top-level-icon":return!0;case"image-icon":return i.type==="image"&&i.loadStatus!=="loading"&&i.loadStatus!=="failed"&&!i.error;case"action-icon":return!(i.type!=="expression"||!Uy(i));case"slider-icon":case"slider-animation-properties-icon":case"slider-thumb":case"slider-limit":return!(i.type!=="expression"||!e8(i));case"table-icon":return i.type==="table"&&this.getGraphSettings().config.graphpaper;case"visualization-prop":return!(i.type!=="expression"||!Zk(i));case"distribution-param":if(i.type!=="expression")return!1;let n=gc(i);return n?e.location in n.values:!1;case"cdf-limit":return i.type!=="expression"?!1:Rp(i);case"image":return i.type==="image";case"folder":return i.type==="folder";case"text":return i.type==="text";case"expression":return!(i.type!=="expression"||this.isInEditListMode()||e.isFakeGraphFocus&&!this.getValidCursorContext());case"readonly-expression":return this.isItemReadonly(i.id)||i.type==="expression"&&this.isInEditListMode();case"braille-output":return i.type==="expression"&&this.getBrailleMode()!=="none";case"table":return i.type!=="table"?!1:Nq(i,e.location);case"table-container":return i.type==="table"&&this.isInEditListMode();case"editable-label":return i.type!=="expression"?!1:Ny(i);default:return e}}shouldAllowMovingPointsWithKeyboard(){let e=this.getActiveTool();return e==="selection"||e==="box-selection"}isDragDropActive(){return!!this.listModel.dragState}isItemBeingDragged(e){let t=this.listModel.dragState;return!(!t||t.firstItemId!==e)}shouldRenderDraggedItemAsToken(){let e=this.listModel.dragState;return e?e.renderType==="token":!1}canDraggedItemBeMovedIntoTokenPane(){var n,a,s,l,c;let e=this.getDraggedItemId();if(!e)return!1;let t=this.getItemModel(e);if(!t||t.type!=="expression"||this.isItemMarkedReadonly(t.id))return!1;let i=(n=t.formula.geometry)==null?void 0:n.valueType;if(i===void 0)return!1;let o=(s=(a=t.formula.geometry)==null?void 0:a.call)==null?void 0:s.parents;if(o){let d=(c=(l=t.formula.geometry)==null?void 0:l.call)==null?void 0:c.symbol;for(let p=0;p<o.length;p++){let g=o[p];if(!(d==="rotate"&&p===1||d==="dilate"&&p===1)){if(d==="glider"&&p===1){let h=T_(t),f=h&&h[1];return f&&f.type==="Decimal"}if(d==="translate"&&p===1){let h=T_(t),f=h&&h[0],y=h&&h[1];if(f&&__dcg_shared_module_exports__['xc'](f)&&(y==null?void 0:y.type)==="Dot"&&y.args[1].type==="Cmd"&&y.args[1].val==="start"&&__dcg_shared_module_exports__['xc'](y.args[0])&&__dcg_shared_module_exports__['nb'](f.span)===__dcg_shared_module_exports__['nb'](y.args[0].span))return!0}if(!g)return!1}}return!(__dcg_shared_module_exports__['ib'](i,__dcg_shared_module_exports__['Ta'])&&!__dcg_shared_module_exports__['oc'](d))}if(__dcg_shared_module_exports__['ib'](i,__dcg_shared_module_exports__['va'])){let d=t.latex.slice(t.latex.indexOf("=")+1);if(/^ *(\\left)*\([0-9. ,-]+(\\right)*\) *$/.test(d))return!0}return!1}getDraggedItemId(){let e=this.listModel.dragState;return e&&e.firstItemId}getDraggedIdentifier(){var i;let e=this.getRawDragState();if(!e)return;let t=this.getItemModel(e.dragTarget.calcId);if(!(!t||t.type!=="expression"))return(i=mn(t))==null?void 0:i.identifier}getRawDragState(){return this.listModel.dragState}initStateStack(){this.stateStack=new vh,this.stateStack.addState({diffState:this.getUndoRedoDiffState(),fullState:this.getUndoRedoFullState()})}getUndoRedoDiffState(){var e;return{randomSeed:this.getRandomSeed(),layoutModel:this.layoutModel,settingsViewModel:this.settingsViewModel,graph:(e=this.getGrapher())==null?void 0:e.getUndoRedoDiffState(),expressions:YK(this.listModel),geometryToolbar:nO(this.geometryToolbarModel),wasCompleteSetState:this.isCurrentlyDoingSetState}}getUndoRedoFullState(){var e;return{randomSeed:this.getRandomSeed(),layoutModel:this.layoutModel,settingsViewModel:this.settingsViewModel,graph:(e=this.getGrapher())==null?void 0:e.getUndoRedoFullState(),expressions:uO(this.listModel),geometryToolbar:nO(this.geometryToolbarModel),wasCompleteSetState:this.isCurrentlyDoingSetState}}getState(e){var n,a;let t={stripDefaults:!0};e&&e.hasOwnProperty("stripDefaults")&&(t.stripDefaults=!!e.stripDefaults);let i=(a=(n=this.getGrapher())==null?void 0:n.getState(t))!=null?a:{...this.getBlankState().graph,degreeMode:this.graphSettings.degreeMode};var o={version:ed,randomSeed:this.getRandomSeed(),graph:i,expressions:XK(this.listModel,t)};if(this.isGeometry()){let s=xK(this.geometryToolbarModel,t);s&&(o.geometryToolbar=s)}return e&&e.avoidBackMigration?__dcg_shared_module_exports__['Z'](o):_6(__dcg_shared_module_exports__['Z'](o))}getProduct(){return this.graphSettings.config.product}isGeometry(){return this.getProduct()==="geometry-calculator"}is3dProduct(){return this.getProduct()==="graphing-3d"}isMultiSelectEnabled(){return this.isGeometry()}canLoadPastedLink(e){return this.graphSettings.config.pasteGraphLink?this.isGeometry()?q1(e)||GR(e)||MR(e):this.is3dProduct()?TR(e):q1(e):!1}getBlankState(e){if(this.isGeometry())return Vx;if(this.is3dProduct())return N9;let t;return(e==null?void 0:e.degreeMode)!==void 0?t=e.degreeMode:t=this.graphSettings.config.clearIntoDegreeMode,t?{...Ug,graph:{...Ug.graph,degreeMode:!0}}:Ug}externalSetState(e,t){this._clearPendingImageUploads(),this.rootElt&&document.activeElement&&this.rootElt.contains(document.activeElement)&&ie(document.activeElement).trigger("blur"),t||(t={}),e||(e=this.getBlankState()),typeof e=="string"&&(e=JSON.parse(e));let i=Wd(e),o=this.graphSettings.config.product,n;if(!i.graph||i.graph.product===void 0?n="graphing":n=i.graph.product,n!==o)throw new Error(`Data Error: state appears to have been saved in the '${n}' product and cannot be opened in the '${o}' product.`);o==="geometry-calculator"&&(this.showConstructionsOpen=!1),ay&&o==="graphing-3d"&&i.graph.speed3D&&delete i.graph.speed3D;let a=this.layoutModel;this.setState(i,t),qK(this.listModel),IG(this.listModel),this.layoutModel={...vR(this.graphSettings.config),keypadMinimized:a.keypadMinimized,keypadLayout:a.keypadLayout,keypadFunctionsOpen:a.keypadFunctionsOpen,expressionsVisible:!!this.graphSettings.config.expressions&&(this.isListVisible()||!!t.forceExpressionsOpen)},this.settingsViewModel=CR(),Vi(this,void 0),t.forceUnsavedChanges?this.enqueueEvent("change"):this.enqueueEvent("clearUnsavedChanges")}setState(e,t){if(this.isCurrentlyDoingSetState=!0,this.suggestedIdentifierRename=void 0,"graph"in e&&e.graph!==void 0){if("threeDMode"in e.graph&&e.graph.threeDMode&&this.grapher3d){if("showBox3D"in e.graph&&this.grapher3d.webglLayer.showBox(e.graph.showBox3D),"showAxis3D"in e.graph&&this.grapher3d.webglLayer.showAxes(!!e.graph.showAxis3D),"showAxisLabels3D"in e.graph&&this.grapher3d.webglLayer.updateAxes(),"showPlane3D"in e.graph||"showAxis3D"in e.graph){let n=("showPlane3D"in e.graph?!!e.graph.showPlane3D:this.graphSettings.showPlane3D)&&("showAxis3D"in e.graph?!!e.graph.showAxis3D:this.graphSettings.showAxis3D);this.grapher3d.webglLayer.showPlane(n)}let o=this.grapher3d.baseplaneWidth();this.grapher2d.setCanvasSizeFor3D(o,o),this.grapher3d.webglLayer.setBackgroundColor(e.graph.backgroundColor3d)}let i=this.getGrapher();i?i.setGrapherState(e.graph):Kf.copyGraphProperties(e.graph,this.graphSettings),"threeDMode"in e.graph&&e.graph.threeDMode&&this.grapher3d&&this.grapher3d.controls.copyWorldRotationToWorld()}if("expressions"in e){vi(this.listModel,void 0);let i=JK(e.expressions);i>=this.__nextItemId&&(this.__nextItemId=i+1),QK(this.listModel,e.expressions,t||{})}if(e.layoutModel&&(this.layoutModel=e.layoutModel),e.settingsViewModel&&(this.settingsViewModel=e.settingsViewModel),(!t||!t.allowUndo)&&this.clearUndoRedoHistory(),this.setRandomSeed(e.randomSeed||Xp()),"geometryToolbar"in e){let i=e.geometryToolbar;this.geometryToolbarModel=SG(i)}}updateToState(e){if(this.isCurrentlyDoingRestoreState=!0,this.suggestedIdentifierRename=void 0,"graph"in e&&(e.graph.threeDMode?this.grapher3d&&this.grapher3d.setGrapherState(e.graph):this.grapher2d&&this.grapher2d.setGrapherState(e.graph,{doNotClear:!0})),"expressions"in e&&ZK(this.listModel,e.expressions),e.layoutModel&&(this.layoutModel=e.layoutModel),e.settingsViewModel&&(this.settingsViewModel=e.settingsViewModel),"geometryToolbar"in e){let t=e.geometryToolbar;this.geometryToolbarModel=SG(t)}}commitUndoRedoSynchronously(e){let t=this.stateStack.getState(),i=t&&t.diffState,o=this.getUndoRedoDiffState();if(Rpe(i,o))return;let n=this.apiMethodCallStackInfo.withHistoryReplacementDepth>0,a={diffState:o,fullState:this.getUndoRedoFullState()};!n&&OY(e)?(this.stateStack.addState(a),this.enqueueEvent("change",e)):this.stateStack.replaceInteriorState(a)}undo(){if(!this.canUndo())return;this.closeToast(),this.stateStack.undo();let e=this.stateStack.getState().fullState;e.wasCompleteSetState?this.setState(e,{allowUndo:!0}):this.updateToState(e),this.enqueueEvent("change",{type:"undo"})}redo(){if(!this.canRedo())return;this.stateStack.redo();let e=this.stateStack.getState().fullState;e.wasCompleteSetState?this.setState(e,{allowUndo:!0}):this.updateToState(e),this.enqueueEvent("change",{type:"undo"})}clearUndoRedoHistory(){this.stateStack.clear()}canUndo(){return this.stateStack.canUndo()}canRedo(){return this.stateStack.canRedo()}closeToast(){let e=this.toastData.onHide;e&&this.runAfterDispatch(e),this.toastData={}}_closeAddExpression(){this.layoutModel={...this.layoutModel,addExpressionOpen:!1}}doesDOMHaveSize(){return this.layoutMeasurements.width>0&&this.layoutMeasurements.height>0}_getExpListWidth(){var e;if(this.userSpecifiedExpListWidth!==void 0){let o=this.isGeometry()?320:200,n=this.isGeometry()?320:280;e=Math.max(n,Math.min(this.layoutMeasurements.width-o,this.userSpecifiedExpListWidth))}else{if(e=this.layoutMeasurements.width,!e)return 356;var t=.2*e+160;e=Math.min(500,Math.max(280,t))}var i=this.layoutMeasurements.width-this.getGrapherHeight();return Math.abs(i-e)<=10?i:e}_setExpListWidth(e){this.userSpecifiedExpListWidth!==e&&(this.userSpecifiedExpListWidth=e)}getKeypadHeight(){return this.computeMajorLayout().keypad.height}isKeypadEnabled(){return!!this.graphSettings.config.keypad}isKeypadOpen(){if(!this.isKeypadEnabled())return!1;let e=this.layoutModel.keypadMinimized&&!this.isNarrow();return this.needsFakeKeypad()&&!e}isHideKeypadButtonVisible(){return this.getBrailleMode()==="none"&&this.isKeypadOpen()&&(!this.isNarrow()||this.inAudioTraceMode())}isKeypadFunctionsPopoverOpen(){return!!this.layoutModel.keypadFunctionsOpen}getKeypadLayout(){let e=this.layoutModel.keypadLayout;return this.isThreeDMode()?S9(e):e}isLetterKeypadOpen(){let e=this.getKeypadLayout();return this.isKeypadOpen()&&(e==="letters"||e==="noQwertyLetters"||e==="capitalLetters"||e==="noQwertyCapitalLetters")}isFileDraggedOver(){return this.layoutModel.isFileDraggedOver}getGeoToolbarHeight(){return this.shouldShowGeoToolbar()?48:0}isNarrowGeometryHeader(){return this.computeMajorLayout().grapher.width<450}shouldShowMultiSelectHeader(){return this.getSelectedGeoExpression()||this.hasMultipleItemsSelected()}getGrapherHeight(){return this.layoutMeasurements.height-this.getGeoToolbarHeight()}computeMajorLayout(){var e=this.layoutMeasurements.width,t=this.layoutMeasurements.height,i=this.isNarrow(),o=this.isListVisible(),n=this.isKeypadOpen(),a=!this.isGrapherEnabled(),s=!this.isListEnabled(),l=!!this.getGraphSettings().config.projectorMode,c={left:0,top:0,width:0,height:0},d={left:0,top:0,width:0,height:0,paddingTop:0},p={left:0,top:t,width:e,height:l?i?185:193:169};s?(d.width=e,d.height=t):a?(c.width=e,c.height=t):o?i?(c.width=e,c.height=Math.round(.58*t),c.top=t-c.height,d.width=e,d.height=t-c.height):(c.width=this.getExpListWidth(),c.height=t,d.left=c.width,d.width=e-d.left,d.height=t):o||(i?(c.width=e,c.height=Math.round(.58*t),c.top=t,d.width=e,d.height=t):(c.width=this.getExpListWidth(),c.height=t,c.left=-c.width,d.width=e,d.height=t)),n&&(p.top-=p.height,s||(c.height-=p.height));let g=this.getGeoToolbarHeight();return g&&(d.top+=g,d.height-=g),{list:c,grapher:d,keypad:p}}isNarrow(){return this.isGeometry()?this.layoutMeasurements.width<600:this.layoutMeasurements.width<450}getLayoutMeasurements(){return this.layoutMeasurements}getCapExpressionSize(){return!!this.getGraphSettings().config.capExpressionSize}handleAudioTraceCommand(e){let t=this.getAudioGraph();if(t===void 0)return;let i=t.agNavigator;switch(e){case"on":this.runAfterDispatch(()=>{t.enterAudioTrace({fromKeypad:!0})});break;case"off":this.runAfterDispatch(()=>{t.exitAudioTrace()});break;case"hear-graph":t.hearGraph();break;case"stop-graph":t.stopGraph();break;case"volume-down":t.adjustVolume("down");break;case"volume-up":t.adjustVolume("up");break;case"speed-down":t.speedDown();break;case"speed-up":t.speedUp();break;case"previous-point":this.runAfterDispatch(()=>{t.reportAndMoveToPrevPoint()});break;case"next-point":this.runAfterDispatch(()=>{t.reportAndMoveToNextPoint()});break;case"previous-poi":this.runAfterDispatch(()=>{t.reportAndMoveToPrevPOI()});break;case"next-poi":this.runAfterDispatch(()=>{t.reportAndMoveToNextPOI()});break;case"previous-curve":this.runAfterDispatch(()=>{i.prevCurve()});break;case"next-curve":this.runAfterDispatch(()=>{i.nextCurve()});break;case"describe-point":t.describePoint();break;case"describe-curve":t.describeCurve();break;case"describe-axes":t.describeAxes();break;case"keyboard-shortcuts":this.enqueueEvent("showHotkeysModal",{type:"keypad/audio-trace",command:e});break;default:return e}}setAudioTraceSpeed(e){let t=this.getAudioGraph();t&&t.adjustPlaybackSpeed(e)}setGraphPaperFocus(e){var t;Vi(this,e.isFocused?{type:"graph-paper"}:void 0),(t=this.get2dPOIController())==null||t.keyboardAttentionManager.setKeyboardAttention(void 0),this.requestRedrawGraph(),e.isFocused&&this.isGeoToolActive()&&this.runAfterDispatch(()=>{var i;(i=this.get2dPOIController())==null||i.keyboardAttentionManager.handleGrapherGainedFocus()})}isGraphPaperFocused(){let e=this.getFocusLocation();return e?!!(e.type==="graph-paper"||e.type==="expression"&&e.isFakeGraphFocus):!1}isVirtualMouseAllowed(){return!(!this.isGeometry()||!this.isGraphPaperFocused()||!this.geoModel.getCurrentTool().canNextInputBePoint())}isClickableId(e){return lx(this.getItemModel(e))}setCanShowKeyboardShortcuts(e){this.canShowKeyboardShortcuts=e}getCanShowKeyboardShortcuts(){return this.canShowKeyboardShortcuts}apply3dProps(e){if(!this.isThreeDMode()||!this.grapher3d)return;let t=this.grapher3d.webglLayer;for(let i in e)switch(i){case"showPlane3D":t.showPlane(this.showPlane3D());break;case"showBox3D":t.showBox(!!e[i]);break;case"showAxis3D":t.showAxes(!!e[i]),t.showPlane(this.showPlane3D());break;case"showAxisLabels3D":t.updateAxes();break;default:break}}getGeometryTokenCount(){if(!this.cachedGeoTokenDepths)return 0;let e=0;return __dcg_shared_module_exports__['h'](__dcg_shared_module_exports__['C'](this.cachedGeoTokenDepths),t=>e+=t?t.length:0),e}getAllGeometryConstructionIds(){return AK(this.listModel,__dcg_shared_module_exports__['jd'])}makeGeoAPI(){this.geoModel=new AE(this)}getGeoTokenInfoFromIdentifier(e){if(e)return this.cachedGeoTokenInfo[e]}getGhostMode(){return this.getGraphSettings().config.getProperty("ghostMode")}getshowKeyboardShortcutsInTooltips(){return!!this.getGraphSettings().config.showKeyboardShortcutsInTooltips}isDispatching(){return this.dispatcher.isDispatching()}getSuggestedIdentifierRenameInfo(e){if(this.suggestedIdentifierRename&&this.suggestedIdentifierRename.id===e)return this.suggestedIdentifierRename}updateSuggestedIdentifierRenameInfo(){if(!this.shouldShowAuthorFeatures())return;let e=this.getSelectedItem();if(!e||e.type!=="expression"){this.suggestedIdentifierRename=void 0;return}this.suggestedIdentifierRename&&this.suggestedIdentifierRename.id!==e.id&&(this.suggestedIdentifierRename=void 0),this.suggestedIdentifierRename&&this.countGlobalIdentifierOccurences(this.suggestedIdentifierRename.from)===0&&(this.suggestedIdentifierRename=void 0);var t=e.formula.assignment||e.formula.function_definition||"",i=t?__dcg_shared_module_exports__['ub'](t):"";if(!this.suggestedIdentifierRename){i&&(this.suggestedIdentifierRename={id:e.id,from:i,to:i,countOfChanges:0,folderId:void 0});return}if(i===this.suggestedIdentifierRename.to)return;if(this.suggestedIdentifierRename.to=i,this.suggestedIdentifierRename.from===this.suggestedIdentifierRename.to||!this.suggestedIdentifierRename.from||!this.suggestedIdentifierRename.to){this.suggestedIdentifierRename.countOfChanges=0;return}if(this.countIdentifierAssignments(t)>1){this.suggestedIdentifierRename.countOfChanges=0;return}let o=__dcg_shared_module_exports__['wb'](this.suggestedIdentifierRename.from);if(this.suggestedIdentifierRename.folderId=void 0,this.countIdentifierAssignments(o)>0){let a;if(e.folderId&&(a=this.countIdentifierAssignmentsInsideFolder(o,e.folderId))===0)this.suggestedIdentifierRename.folderId=e.folderId,this.suggestedIdentifierRename.countOfChanges=a;else{this.suggestedIdentifierRename.countOfChanges=0;return}}let n=dO(this.listModel,this.suggestedIdentifierRename.from,this.suggestedIdentifierRename.folderId);this.suggestedIdentifierRename.countOfChanges=n}getMathquillConfig(e){let t=e.additionalOperators||[];return this.toneAllowed()&&t.push("tone"),{autoOperatorNames:Wp({additionalOperators:t,includeGeometryFunctions:this.isGeometry(),include3DFunctions:this.is3dProduct()}),infixOperatorNames:wx(),autoCommands:Hp({additionalCommands:this.isGeometry()?[]:["int"],disallowAns:this.isGeometry()})}}constrainMultiSelect(){if(this.isMultiSelectEnabled())return;let e=AG(this.listModel);e.length>1&&vi(this.listModel,e[0])}focusFirstExpression(){if(!this.getGraphSettings().config.expressions)return;let e=tx(this.listModel);e&&Xn(this,e.id,"end")}_updateToneAvailability(){let e=this.toneAllowed();e&&!this.toneController?this.toneController=new nC(this):!e&&this.toneController&&(this.toneController=void 0)}toneItemsExist(){return this.toneEnabled()?this.getAllItemModels().some(e=>Wl(e)):!1}toneAllowed(){return!!(this.graphSettings.config.audio&&this.graphSettings.config.tone)}toneEnabled(){return!!this.toneController}setNotice(e){this.noticeId=e}};function RY(r){return r&&{...r,wasCompleteSetState:void 0,layoutModel:void 0,settingsViewModel:void 0}}function Rpe(r,e){return __dcg_shared_module_exports__['E'](RY(r),RY(e))}var $w=__dcg_shared_module_exports__['e'](te());qt();var aS=class{constructor(e){this.previousPaneFocusLocations={main:void 0,quest:void 0};this.controller=e}markKeyDownAsHandled(e){e.stopPropagation(),e.preventDefault()}handleKeydown(e){var i,o,n,a,s;let t=ji(e);if(tf(e))this.markKeyDownAsHandled(e),this.controller.hasVisibleAndUndoableToast()?this.controller.toastUndo():this.controller.dispatch({type:"undo"});else if(rf(e))this.markKeyDownAsHandled(e),this.controller.dispatch({type:"redo"});else if(e.altKey&&!e.ctrlKey&&!e.metaKey&&e.shiftKey&&t==="Z"){let l=this.controller.getSelectedItem();l&&l.id&&(this.markKeyDownAsHandled(e),this.controller.dispatch({type:"expression-zoom-fit",id:l.id,focusAfterTap:!1}))}else if(e.altKey!==Ti&&e.metaKey===Ti&&!e.ctrlKey&&e.shiftKey&&t==="A"&&this.controller.isDecimalToFractionEnabled()){let l=this.controller.getSelectedItem();l&&l.type==="expression"&&(this.markKeyDownAsHandled(e),this.controller.dispatch({type:"toggle-fraction-evaluation",id:l.id}),this.controller.runAfterDispatch(()=>{wg(l)?Te(this.controller.s("shared-calculator-narration-show-as-fraction")):Te(this.controller.s("shared-calculator-narration-show-as-decimal"))}))}else if(!e.altKey&&e.ctrlKey!==Ti&&e.metaKey===Ti&&t==="F"){if(this.controller.isExpressionListFocused()){let l=Ze.getFocusedMathquill(),c="";try{c=l.__controller.cursor.selection.join("latex")||""}catch(d){}this.controller.dispatch({type:"open-expression-search",rename:!!e.shiftKey,latex:c}),this.markKeyDownAsHandled(e)}}else if((e.altKey||e.metaKey)&&!e.ctrlKey&&!e.shiftKey&&t===void 0){if(Be(e)===un){let l=this.controller.getSelectedItem();l&&l.type==="folder"&&(this.markKeyDownAsHandled(e),this.controller.dispatch({type:"set-folder-collapsed",id:l.id,isCollapsed:!0}),Te(this.controller.s("graphing-calculator-narration-folder-collapsed")))}else if(Be(e)===hn){let l=this.controller.getSelectedItem();l&&l.type==="folder"&&(this.markKeyDownAsHandled(e),this.controller.dispatch({type:"set-folder-collapsed",id:l.id,isCollapsed:!1}),Te(this.controller.s("graphing-calculator-narration-folder-expanded")))}}else if(e.shiftKey&&(e.altKey||e.metaKey)&&!e.ctrlKey){if(Be(e)===un)this.markKeyDownAsHandled(e),this.controller.dispatch({type:"set-all-folders-collapsed",isCollapsed:!0}),Te(this.controller.s("graphing-calculator-narration-all-folders-collapsed"));else if(Be(e)===hn)this.markKeyDownAsHandled(e),this.controller.dispatch({type:"set-all-folders-collapsed",isCollapsed:!1}),Te(this.controller.s("graphing-calculator-narration-all-folders-expanded"));else if(t==="H"){let l=this.controller.getSelectedItem();l&&"hidden"in l&&(this.markKeyDownAsHandled(e),this.controller.dispatch({type:"toggle-item-hidden",id:l.id}),this.controller.runAfterDispatch(()=>{l.hidden?Te(this.controller.s("graphing-calculator-narration-item-hidden")):Te(this.controller.s("graphing-calculator-narration-item-visible"))}))}else if(t==="O"){if(!this.controller.authorFeaturesAvailable())return;this.controller.dispatch({type:"set-author-mode",enabled:!this.controller.shouldShowAuthorFeatures()}),Te(this.controller.shouldShowAuthorFeatures()?this.controller.s("shared-calculator-narration-author-mode-on"):this.controller.s("shared-calculator-narration-author-mode-off")),this.markKeyDownAsHandled(e)}else if(t==="E"){if(!this.controller.isListEnabled())return;this.controller.isListVisible()?(this.controller.dispatch({type:"hide-expressions-list",focusShowIcon:!1}),Te(this.controller.s("graphing-calculator-narration-hide-expression-list"))):(this.controller.dispatch({type:"show-expressions-list",focusHideIcon:!1}),this.focusExpressionList()),this.markKeyDownAsHandled(e)}}else if(e.ctrlKey&&(e.altKey||e.metaKey)&&!e.shiftKey){if(t==="E"){if(!this.controller.isListEnabled())return;this.markKeyDownAsHandled(e),this.focusExpressionList()}else if(t==="X"){if(!this.controller.isListEnabled())return;this.markKeyDownAsHandled(e),this.controller.canUserAddExpressions()?(Te(this.controller.s("graphing-calculator-narration-add-expression")),this.controller.dispatch({type:"new-expression"})):Te(this.controller.s("graphing-calculator-narration-unable-to-add-expression"))}else if(t==="O"){if(!this.controller.isListEnabled())return;this.markKeyDownAsHandled(e),this.controller.canUserAddExpressions()&&this.controller.areNotesEnabled()?(Te(this.controller.s("graphing-calculator-narration-add-note")),this.controller.dispatch({type:"new-text"})):Te(this.controller.s("graphing-calculator-narration-unable-to-add-note"))}else if(t==="F"&&this.controller.canUserAddExpressions()&&this.controller.areFoldersEnabled())this.markKeyDownAsHandled(e),Te(this.controller.s("graphing-calculator-narration-add-folder")),this.controller.dispatch({type:"new-folder"});else if(t==="I"&&this.controller.canUserAddExpressions()&&this.controller.areImagesEnabled())this.markKeyDownAsHandled(e),this.controller.dispatch({type:"toggle-add-expression",focusOnOpen:!1}),this.controller.runAfterDispatch(()=>{let l=this.controller.findEl(".dcg-add-expression-container input[type=file]");l&&(ie(l).trigger("click"),Te(this.controller.s("graphing-calculator-narration-add-image")))});else if(t==="T")this.markKeyDownAsHandled(e),this.controller.canUserAddExpressions()?(Te(this.controller.s("graphing-calculator-narration-add-table")),this.controller.dispatch({type:"new-table"})):Te(this.controller.s("graphing-calculator-narration-unable-to-add-table"));else if(t==="M"&&this.controller.isGeoUIActive())if(this.markKeyDownAsHandled(e),this.controller.getGeoToolbarGroupKeys().length>0){let l=this.controller.getActiveTool();this.controller.shouldShowMultiSelectHeader()?this.controller.dispatch({type:"set-focus-location",location:{type:"geo-header-back-link"}}):(l==="expression-edit"&&(l="selection"),this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:l}}))}else Te(this.controller.s("graphing-calculator-narration-no-geometry-tools-available"));else if(t==="C"&&this.controller.isGeoUIActive())this.markKeyDownAsHandled(e),this.controller.getGeometryTokenCount()>0?this.controller.dispatch({type:"set-show-constructions-open",open:!0,setFocus:!0}):Te(this.controller.raw("Object navigator has no items."));else if(t==="G")this.markKeyDownAsHandled(e),this.controller.dispatch({type:"toggle-graph-settings",focusOnOpen:!0});else if(t==="P"){if(this.markKeyDownAsHandled(e),this.controller.isGeometry()){let l=this.controller.getFocusLocation(),c=this.controller.getValidCursorContext();if(l&&l.type==="expression"&&c&&c.type!=="empty"){this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:l.id,isFakeGraphFocus:!0}}),(o=(i=this.controller.getGrapher2d())==null?void 0:i.poiController)==null||o.keyboardAttentionManager.handleGrapherGainedFocus();return}}this.controller.dispatch({type:"set-focus-location",location:{type:"graph-paper"}})}else if(t==="Z"){let l=this.controller.getSelectedItem();l&&l.id&&this.controller.dispatch({type:"expression-zoom-fit",id:l.id,focusAfterTap:!1})}else if(t==="D"&&this.controller.canUserAddExpressions()){this.markKeyDownAsHandled(e);let l=!this.controller.isInEditListMode();this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:l,focusExpressionList:!0})}}else if(FP(e)&&this.controller.getQuestIsActive()){((n=this.controller.focusLocation)==null?void 0:n.type)==="quest"?(this.previousPaneFocusLocations.quest=this.controller.focusLocation,this.previousPaneFocusLocations.main?this.controller.dispatch({type:"set-focus-location",location:this.previousPaneFocusLocations.main}):this.focusExpressionList()):(this.previousPaneFocusLocations.main=this.controller.focusLocation,this.controller.dispatch({type:"set-focus-location",location:(a=this.previousPaneFocusLocations.quest)!=null?a:{type:"quest",location:"quest-pane"}})),this.markKeyDownAsHandled(e);return}else if(!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey){if(Be(e)===Nc)(!document.activeElement||!ug(document.activeElement))&&e.preventDefault();else if(Be(e)===rn&&!this.controller.getOpenItemMenu()&&!this.controller.isGraphSettingsOpen()){if(this.controller.isGeoUIActive()){let l=!1,c=this.controller.getGeoModel();if(this.controller.hasAnyItemsSelected()&&(this.controller.dispatch({type:"set-none-selected"}),l=!0),c.isToolplayActive()&&(this.controller.dispatch({type:"cancel-geo-toolplay"}),Te(this.controller.s("graphing-calculator-narration-geometry-tool-cancelled")),l=!0),this.controller.isGraphPaperFocused()&&(this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:this.controller.getActiveTool()}}),l=!0),this.controller.getActiveTool()!=="selection"&&!l){this.controller.dispatch({type:"select-geo-tool",tool:"selection"});let d=this.controller.getFocusLocation();d&&d.type==="geo-basic-tool"&&this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:this.controller.getActiveTool()}}),l=!0}if(l){this.markKeyDownAsHandled(e);return}}this.controller.isInEditListMode()&&!this.controller.findEl(".dcg-options-menu")&&(this.markKeyDownAsHandled(e),this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:!1,focusExpressionList:!0}))}}else if(!e.metaKey&&!e.shiftKey&&e.ctrlKey===Ti&&e.altKey===!Ti){if(t==="N"){if(!this.controller.getBrailleControls())return;this.markKeyDownAsHandled(e),this.controller.dispatch({type:"set-braille-mode",mode:"nemeth"}),Te(this.controller.s("shared-calculator-narration-hotkey-braille-mode-nemeth"))}else if(t==="U"){if(!this.controller.getBrailleControls())return;this.markKeyDownAsHandled(e),this.controller.dispatch({type:"set-braille-mode",mode:"ueb"}),Te(this.controller.s("shared-calculator-narration-hotkey-braille-mode-ueb"))}else if(t==="Q"||t==="X"){if(!this.controller.getBrailleControls())return;this.markKeyDownAsHandled(e),this.controller.dispatch({type:"set-braille-mode",mode:"none"}),Te(this.controller.s("shared-calculator-narration-hotkey-braille-mode-off"))}else if(t==="6"){if(!this.controller.getBrailleControls())return;this.markKeyDownAsHandled(e);let l=!this.controller.getSixKeyInput();this.controller.dispatch({type:"set-six-key-input",useSixKeyInput:l}),Te(l?this.controller.s("shared-calculator-narration-six-key-mode-on"):this.controller.s("shared-calculator-narration-six-key-mode-off"))}else if(t==="D")this.markKeyDownAsHandled(e),this.controller.dispatch({type:"set-graph-settings",degreeMode:!this.controller.getGraphSettings().degreeMode}),Te(this.controller.getGraphSettings().degreeMode?this.controller.s("graphing-calculator-button-settings-degrees"):this.controller.s("graphing-calculator-button-settings-radians"));else if(t==="K"){if(!this.controller.isKeypadEnabled()||this.controller.inAudioTraceMode())return;this.markKeyDownAsHandled(e),this.controller.dispatch({type:"keypad/set-minimized",minimized:this.controller.isHideKeypadButtonVisible()})}else t==="M"&&((s=this.controller.toneController)==null||s.handleMuteKeyShortcut(),this.markKeyDownAsHandled(e));if(t==="+"||t==="="){this.zoom("in"),this.markKeyDownAsHandled(e);return}else if(t==="-"){this.zoom("out"),this.markKeyDownAsHandled(e);return}else if(t==="0"&&!e.shiftKey){this.setDefaultViewport(),this.markKeyDownAsHandled(e);return}}}focusExpressionList(){let e=this.controller.getSelectedItem();e?this.controller.dispatch({type:"move-focus-to-item",id:e.id}):this.controller.dispatch({type:"focus-first-expression"})}zoom(e){var t;(t=this.controller.getGrapher())==null||t.viewportController.zoom(e)}setDefaultViewport(){var e;(e=this.controller.getGrapher())==null||e.viewportController.setDefaultViewport()}};qt();var Fpe=function(){{var r=0,e=1,t=2,i=!1,o=function(){n(document),i=!0},n=function(a){i||ie(a).bind("touchstart",function(s){var l=ie(s.target),c=r,d=null;if(!l[0].closest("[disablescroll]"))for(;c===r&&l.length&&l[0].tagName!==void 0;){var p=getComputedStyle(l[0]).overflow,g=getComputedStyle(l[0]).overflowY;if(p!=="hidden"&&p!=="visible"&&g!=="hidden"&&g!=="hidden"){var h=l.scrollTop();h!==0&&(c=t),l.scrollTop(h+1),l.scrollTop()!==h&&(c=e|c,l.scrollTop(h))}l=ie(l[0].parentElement)}if(c!==r){d=[];for(var f=s.originalEvent.touches,y=0;y<f.length;y++){var x={};for(var E in f[y])f[y].hasOwnProperty(E)&&(x[E]=f[y][E]);d.push(x)}}ie(document).on("touchmove.scrollfix",function(C){if(d){var S=d[0],v=C.originalEvent.touches[0],M=v.screenY-S.screenY;(M>0&&!(c&t)||M<0&&!(c&e))&&(c=r),M&&(d=null)}c===r&&C.preventDefault()}),ie(document).on("touchend.scrollfix",function(){ie(document).off(".scrollfix")})})};return{limitScrollOnElement:n,limitScrollOnDocument:o}}}();var{limitScrollOnElement:SI,limitScrollOnDocument:BY}=Fpe;var ur=__dcg_shared_module_exports__['e'](te());qt();var wt=__dcg_shared_module_exports__['e'](te());qt();var UY=__dcg_shared_module_exports__['e'](te());function Npe(r){let e=r.target;return e.classList.contains("dcg-exp-action-button")||e.classList.contains("dcg-icon-duplicate")||e.classList.contains("dcg-icon-remove")||e.classList.contains("dcg-icon-lock")||e.classList.contains("dcg-icon-pencil")}var Sl=class extends UY.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,this._isFirstRender=!0,this._isDragCopy=this.props.isDragCopy()}onItemViewMounted(){this._isDragCopy||(this.model.dcgView=this),this._isFirstRender=!1}onItemViewUnmounted(){this._isDragCopy||(this.model.dcgView=void 0)}isFirstRender(){return this._isFirstRender}onMouseSelect(e){if(this.controller.isInEditListMode()&&!Npe(e)){this.exitEditListMode();return}this.controller.isItemReadonly(this.id)||e.type==="dcg-tap"&&e.device==="mouse"||e.type==="dcg-tapstart"&&e.device==="touch"||e.wasHandled()||(e.handle(),this.controller.dispatch({type:"set-selected-id",id:this.id}))}onDragPending(e){this.controller.isItemReadonly(this.model.id)||this.props.onDragPending(e)}exitEditListMode(){this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:!1,focusExpressionList:!0})}};var ca=__dcg_shared_module_exports__['e'](te());var Vh=__dcg_shared_module_exports__['e'](te());var $a=class extends Vh.Class{template(){return Vh.createElement($e,{tooltip:this.props.error,sticky:this.const(!0),gravity:this.props.gravity},Vh.createElement("div",{class:()=>({"dcg-tooltipped-error":!0,"dcg-white":this.props.isWhite&&this.props.isWhite(),"dcg-small":this.props.size&&this.props.size()==="small"})},Vh.createElement("i",{class:Vh.const("dcg-icon-error"),"aria-hidden":Vh.const("true")})))}};var ja=__dcg_shared_module_exports__['e'](te());var _s=__dcg_shared_module_exports__['e'](te());var{If:DI}=_s.Components,yn=class extends _s.Class{template(){return _s.createElement("span",{class:()=>({"dcg-do-not-blur":!0,"dcg-forced-color-none":!0,"dcg-circular-icon":!0,"dcg-thick-outline":this.isThickOutline(),"dcg-white-icon":!!this.props.whiteIcon&&this.props.whiteIcon(),"dcg-hidden":this.isHidden(),"dcg-semi-transparent":this.props.semiTransparent&&this.props.semiTransparent(),"dcg-colored-icon":this.isColoredIcon(),"dcg-has-background-image":this.hasBackgroundImage(),[this.iconModifier()]:this.iconModifier().length>0}),style:this.bindFn(this.getIconStyle)},_s.createElement(DI,{predicate:this.bindFn(this.hasBackgroundImage)},()=>_s.createElement("span",{class:_s.const("dcg-background-image"),style:()=>({"background-image":this.props.backgroundImage&&this.props.backgroundImage(),opacity:this.props.backgroundOpacity&&this.props.backgroundOpacity()})})),_s.createElement(DI,{predicate:()=>!!this.backgroundIcon()},()=>_s.createElement("i",{class:()=>({[this.backgroundIcon()]:!0,"dcg-layered-icon":!0}),style:()=>({opacity:this.backgroundOpacity()})})),_s.createElement(DI,{predicate:()=>!!this.primaryIcon()},()=>_s.createElement("i",{class:()=>({[this.primaryIcon()]:!0,"dcg-layered-icon":!0}),style:()=>({color:this.props.foregroundColor&&this.props.foregroundColor()})})),_s.createElement(DI,{predicate:()=>this.props.iconType()==="loading"},()=>_s.createElement("span",{class:_s.const("dcg-spinner")})))}isColoredIcon(){return!this.isThickOutline()&&!this.isHidden()&&!this.hasBackgroundImage()&&this.props.iconType()!=="loading"}iconModifier(){if(!this.props.iconModifier)return"";switch(this.props.iconModifier()){case"medium":return"dcg-modifier-size-medium";case"large":return"dcg-modifier-size-large";case"small":return"dcg-modifier-size-small";case"rotated":return"dcg-modifier-rotated";case"none":return""}}getIconStyle(){let e=!this.isHidden()&&this.props.backgroundColor?dx(this.props.backgroundColor()):void 0;return e?{background:e}:{}}isHidden(){return this.props.iconType()==="hidden"}isThickOutline(){let e=this.props.iconType();return e==="folder"||e==="pause"||e==="play"||e==="fraction"||e==="action"||e==="metronome"||e==="sound"}hasBackgroundImage(){return!!this.props.backgroundImage&&!this.isHidden()&&!!this.props.backgroundImage()}primaryIcon(){let e=this.props.iconType();switch(e){case"sound":return"dcg-icon-sound-wave";case"folder":return"dcg-icon-folder";case"pause":return"dcg-icon-pause";case"play":return"dcg-icon-play";case"polygon-dashed":case"polygon-dashed-filled":return"dcg-icon-polygon-dashed";case"polygon-dotted":case"polygon-dotted-filled":return"dcg-icon-polygon-dotted";case"polygon-default":case"polygon-default-filled":return"dcg-icon-polygon-solid";case"graph-dashed":case"parametric-dashed-filled":return"dcg-icon-parametric-dashed";case"graph-dotted":case"parametric-dotted-filled":return"dcg-icon-parametric-dotted";case"graph-default":case"parametric-default-filled":return"dcg-icon-parametric-solid";case"movable-vertical":return"dcg-icon-move-vertical";case"movable-both":return"dcg-icon-move";case"movable-horizontal":return"dcg-icon-move-horizontal";case"point-open":return"dcg-icon-open";case"point-cross":return"dcg-icon-cross";case"point-default":return"dcg-icon-point";case"table-points":case"table-points-and-lines":return"dcg-icon-points";case"table-lines":return"dcg-icon-lines-solid";case"shaded-inequality":case"inequality":return"dcg-icon-shaded-inequality-dash";case"check":return"dcg-icon-check";case"none":case"background":case"hidden":case"polygon-none-filled":case"parametric-none-filled":case"loading":return"";case"fraction":return"dcg-icon-fraction";case"boxplot":return"dcg-icon-boxplot";case"dotplot-cross":return"dcg-icon-dotplot-cross";case"dotplot-default":return"dcg-icon-dotplot-default";case"dotplot-open":return"dcg-icon-dotplot-open";case"histogram":return"dcg-icon-histogram";case"unfilled-distribution":case"filled-distribution":return"dcg-icon-distribution";case"action":return"dcg-icon-chevron-right";case"metronome":return"dcg-icon-metronome-2";case"arrow-right":return"dcg-icon-arrow-right";default:return e}}backgroundOpacity(){let e=this.backgroundIcon();return e==="dcg-icon-polygon-filled"||e==="dcg-icon-parametric-filled"||e==="dcg-icon-shaded-inequality-shade2"||e==="dcg-icon-distribution-fill"||e==="dcg-icon-histogram-fill"?.5:1}backgroundIcon(){let e=this.props.iconType();return e==="filled-distribution"?"dcg-icon-distribution-fill":e==="histogram"?"dcg-icon-histogram-fill":e==="polygon-dashed-filled"||e==="polygon-dotted-filled"||e==="polygon-default-filled"||e==="polygon-none-filled"?"dcg-icon-polygon-filled":e==="parametric-dashed-filled"||e==="parametric-dotted-filled"||e==="parametric-default-filled"||e==="parametric-none-filled"?"dcg-icon-parametric-filled":e==="table-points-and-lines"?"dcg-icon-lines-solid":e==="shaded-inequality"?"dcg-icon-shaded-inequality-shade2":e==="action"?"dcg-icon-minus":""}};var kI=class extends ja.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return ja.createElement("div",{class:ja.const("dcg-play-pause-icon-view")},ja.createElement($e,{gravity:this.const("s"),tooltip:()=>this.controller.s("graphing-calculator-label-slider-disabled-while-ticker-playing"),disabled:()=>!this.controller.getTickerPlaying(),sticky:this.const(!0)},ja.createElement("div",{class:()=>({"dcg-circular-icon-container":!0,"dcg-disabled":this.controller.getTickerPlaying()}),"aria-label":this.bindFn(this.getAriaLabel),role:ja.const("button"),tabindex:ja.const("0"),onTap:e=>{e.wasHandled("dragdrop")||this.toggleSliderIsPlaying()},"dcg-open-menu-guid":()=>this.model.guid,manageFocus:this.const(ft({controller:this.controller,location:{type:"slider-icon",id:this.model.id}}))},ja.createElement(yn,{iconType:()=>this.getIconType(),whiteIcon:()=>!this.controller.isInEditListMode()&&this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)}))),ja.createElement("div",{class:ja.const("dcg-slider-menu-container")},ja.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-animation-properties-tooltip"),gravity:this.const("e")},ja.createElement("div",{class:()=>({"dcg-slider-menu-opener":!0,"dcg-menu-open":this.myOptionsOpen()}),tabindex:ja.const(0),"dcg-open-menu-guid":()=>this.getMenuGUID(),role:ja.const("button"),"aria-label":()=>this.myOptionsOpen()?this.controller.s("graphing-calculator-narration-hide-animation-properties"):this.controller.s("graphing-calculator-narration-show-animation-properties"),onTap:e=>{e.wasHandled("dragdrop")||e.wasLongheld()||this.toggleOptions(e)},manageFocus:this.const(ft({controller:this.controller,location:{type:"slider-animation-properties-icon",id:this.model.id}}))},ja.createElement("i",{class:this.bindFn(this.getIcon),"aria-hidden":ja.const("true")})))))}getIcon(){return __dcg_shared_module_exports__['ac'](this.model.slider.loopMode)}getIconType(){return!this.model.slider.isPlaying||D_(this.model)?"play":"pause"}getMenuGUID(){return"slider-"+this.model.guid}myOptionsOpen(){return this.controller.isItemSettingsMenuOpen(this.getMenuGUID())}toggleOptions(e){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"slider",model:this.model,guid:this.getMenuGUID(),focusFirstOption:e.device==="keyboard"}})}getAriaLabel(){if(!this.model.sliderExists)return"";var e=sa(this.model);return e?this.model.slider.isPlaying?this.controller.s("graphing-calculator-narration-pause-variable-animation",{variable:e}):this.controller.s("graphing-calculator-narration-play-variable-animation",{variable:e}):""}toggleSliderIsPlaying(){if(this.model.sliderExists){var e="",t=sa(this.model);D_(this.model)?(typeof t=="string"&&(e=this.controller.s("graphing-calculator-narration-slider-variable-restarted",{variable:t})),this.controller.dispatch({type:"play-slider-from-min",id:this.model.id})):this.model.slider.isPlaying?(typeof t=="string"&&(e=this.controller.s("graphing-calculator-narration-slider-variable-paused",{variable:t})),this.controller.dispatch({type:"set-slider-isplaying",id:this.model.id,isPlaying:!1})):(typeof t=="string"&&(e=this.controller.s("graphing-calculator-narration-slider-variable-playing",{variable:t})),this.controller.dispatch({type:"set-slider-isplaying",id:this.model.id,isPlaying:!0})),e!==""&&Te(e)}}};var gu=__dcg_shared_module_exports__['e'](te());var GI=class extends gu.Class{constructor(){super(...arguments),this.isAnimating=!1}init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return gu.createElement("div",{class:()=>({"dcg-action-icon-view":!0,"dcg-action-icon-view-animating":this.isAnimating})},gu.createElement("div",{class:gu.const("dcg-circular-icon-container"),"aria-label":()=>this.controller.s("graphing-calculator-narration-run-action-icon"),role:gu.const("button"),tabindex:gu.const("0"),onTap:e=>{e.wasHandled("dragdrop")||this.runActionOnce()},manageFocus:this.const(ft({controller:this.props.controller(),location:{type:"action-icon",id:this.model.id}}))},gu.createElement(yn,{iconType:this.const("action"),whiteIcon:()=>!this.controller.isInEditListMode()&&this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)})))}runActionOnce(){this.isAnimating=!0,this.controller.dispatch({type:"action-single-step",id:this.model.id}),setTimeout(this.bindIfMounted(()=>{this.isAnimating=!1,this.update()}),150)}};var sS=__dcg_shared_module_exports__['e'](te());var TI=class extends sS.Class{init(){this.model=this.props.model(),this.controller=this.props.controller()}toggleMuted(){this.controller.dispatch({type:"toggle-item-hidden",id:this.model.id})}showAsTurnedOff(){return sC(this.model)}template(){return sS.createElement("button",{class:()=>{var e;return{"dcg-unstyled-button":!0,"dcg-circular-icon-container":!0,"dcg-show-globally-muted":((e=this.controller.toneController)==null?void 0:e.isGlobalMuted())&&!this.showAsTurnedOff()}},onTap:e=>{e.wasHandled("dragdrop")||this.toggleMuted()},"aria-label":this.props.ariaLabel},sS.createElement(yn,{iconType:()=>this.showAsTurnedOff()?"hidden":"sound",whiteIcon:()=>!this.controller.isInEditListMode()&&this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)}))}};as();var{SwitchUnion:Bpe,If:Upe}=ca.Components,zpe="#6A93D2",zY="#000",KY="#fff",lS=class extends ca.Class{init(){this.model=this.props.model(),this.controller=this.props.controller()}template(){return ca.createElement("div",{class:ca.const("dcg-expression-icon-container")},Bpe(this.bindFn(this.getIconMode),{error:()=>ca.createElement($a,{error:this.bindFn(this.getErrorMsg),isWhite:this.bindFn(this.isSelected),gravity:this.const("s")}),none:()=>ca.createElement("span",null),slider:()=>ca.createElement(kI,{controller:this.props.controller,model:this.props.model}),action:()=>ca.createElement(GI,{controller:this.props.controller,model:this.props.model}),icon:()=>ca.createElement("div",{class:ca.const("dcg-circular-icon-container"),role:ca.const("button"),tabindex:ca.const("0"),"dcg-open-menu-guid":()=>this.getMenuGUID(),"aria-label":this.bindFn(this.getIconAriaLabel),onTap:e=>{if(!e.wasHandled("dragdrop")&&!e.wasLongheld()){if(this.myOptionsOpen())return this.toggleOptions(e);if((this.controller.isInEditListMode()||e.shiftKey)&&!this.isFraction())return this.toggleOptions(e);if(this.isFraction())return this.onToggleFractionDisplay();this.toggleGraphShown()}},onLongHold:e=>{e.handle("dcg-longhold"),e.handle("dcg-tap"),!this.isFraction()&&this.toggleOptions(e)},manageFocus:this.const(ft({controller:this.controller,location:{type:"expression-icon",id:this.model.id}}))},ca.createElement(yn,{iconType:this.bindFn(this.getIconType),backgroundColor:this.bindFn(this.getBackgroundColor),whiteIcon:this.bindFn(this.isSelected),foregroundColor:this.bindFn(this.getForegroundColor),iconModifier:this.bindFn(this.getIconModifier),backgroundImage:this.bindFn(this.backgroundImage),backgroundOpacity:this.const(1)}),ca.createElement(Upe,{predicate:()=>this.model.disableGraphInteractions},()=>ca.createElement("i",{class:ca.const("dcg-graph-interaction-disabled dcg-icon-lock")}))),tone:()=>ca.createElement(TI,{controller:this.props.controller,model:this.props.model,ariaLabel:this.bindFn(this.getIconAriaLabel)})}))}backgroundImage(){let e=this.getBackgroundColor();return e.type==="image"?`url("${e.value}")`:""}getErrorMsg(){return this.colorError()?this.controller.s("shared-calculator-error-color-not-assigned"):this.controller.unpack(this.model.error)}getMenuGUID(){return this.model.guid}myOptionsOpen(){return this.controller.isItemSettingsMenuOpen(this.getMenuGUID())}toggleOptions(e){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"expression",model:this.model,guid:this.getMenuGUID(),focusFirstOption:e.device==="keyboard"}})}isSelected(){return this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)}isFraction(){return this.controller.canDisplayEvaluationForItemAsFraction(this.model.id)}getIconMode(){return this.hasError()?"error":this.controller.getGraphSettings().config.graphpaper?xg(this.model)?"icon":this.hasSlider()?"slider":this.isFraction()?"icon":this.isNonemptyAction()?"action":this.isToneExpression()&&this.controller.toneEnabled()?"tone":"none":"none"}isToneExpression(){return Wl(this.model)}toggleGraphShown(){this.controller.dispatch({type:"toggle-item-hidden",id:this.model.id})}colorError(){return!!this.model.formula.rgb_value&&!this.model.formula.assignment}hasError(){return this.colorError()?!0:!!this.model.error&&!Hl(this.model)&&this.controller.getBrailleMode()==="none"}hasSlider(){return!!this.model.sliderExists}isNonemptyAction(){return Uy(this.model)}getDisplayProps(){let{points:e,lines:t,fill:i}=this.model;return __dcg_shared_module_exports__['Ic'](this.model.formula.expression_type,{points:e,lines:t,fill:i},o=>{Ii("getReconciledExpressionProps [Chrome Switch Bug]",{metaData:{method:"getDisplayProps",type:o}})})}getBackgroundColor(){if(!this.isFraction())return MC(this.model);let e=this.isSelected();return this.controller.shouldEvaluationForItemDisplayAsFraction(this.model.id)?{type:"single-color",value:e?KY:zY}:{type:"single-color",value:""}}getForegroundColor(){if(!this.isFraction())return"";let e=this.isSelected(),t=this.controller.shouldEvaluationForItemDisplayAsFraction(this.model.id);return e!==t?KY:e?zpe:zY}onToggleFractionDisplay(){this.controller.dispatch({type:"toggle-fraction-evaluation",id:this.model.id})}getIconModifier(){return Eg(this.model)&&ah(this.model,"alignedAxis")==="y"?"rotated":"none"}getIconType(){if(this.isFraction())return"fraction";if(!this.model.shouldGraph)return"hidden";if(this.controller.isInEditListMode())return"none";let e=this.model.pointStyle,t=this.model.lineStyle,i=this.getDisplayProps(),o=this.model.formula;if(Eg(this.model))return"boxplot";if(lh(this.model)){if(this.model.pointStyle==="POINT")return"dotplot-default";if(this.model.pointStyle==="CROSS")return"dotplot-cross";if(this.model.pointStyle==="OPEN")return"dotplot-open"}if(hf(this.model))return"histogram";if(Sg(this.model))return Rp(this.model)?"filled-distribution":"unfilled-distribution";if(mo(this.model)==="X")return"movable-horizontal";if(mo(this.model)==="Y")return"movable-vertical";if(mo(this.model)==="XY")return"movable-both";if(zs(this.model))return e==="OPEN"?"point-open":e==="CROSS"?"point-cross":"point-default";if(Yk(this.model))return"point-default";if(uf(this.model)||qy(this.model))return i.lines&&i.points?"table-points-and-lines":i.lines?"table-lines":"table-points";if(Xk(this.model))return"polygon-default-filled";let n=this.getDisplayProps().fill;if(vg(this.model))return n?i.lines?t==="DASHED"?"polygon-dashed-filled":t==="DOTTED"?"polygon-dotted-filled":"polygon-default-filled":"polygon-none-filled":i.lines?t==="DASHED"?"polygon-dashed":t==="DOTTED"?"polygon-dotted":"polygon-default":"none";if(pf(this.model))return n?i.lines?t==="DASHED"?"parametric-dashed-filled":t==="DOTTED"?"parametric-dotted-filled":"parametric-default-filled":"parametric-none-filled":i.lines?t==="DASHED"?"graph-dashed":t==="DOTTED"?"graph-dotted":"graph-default":"none";var a=o.operator,s=__dcg_shared_module_exports__['ec'][a].direction!==0,l=__dcg_shared_module_exports__['ec'][a].inclusive===!1;return o.is_shade_between||!l&&s?"shaded-inequality":l&&!s?"inequality":l&&s?"shaded-inequality":t==="DASHED"?"graph-dashed":t==="DOTTED"?"graph-dotted":"graph-default"}getIconAriaLabel(){return this.isFraction()?wg(this.model)?this.controller.s("shared-calculator-narration-display-as-decimal"):this.controller.s("shared-calculator-narration-display-as-fraction"):this.myOptionsOpen()?Ui(this.model,"hide-options"):this.controller.isInEditListMode()?Ui(this.model,"show-options"):Wl(this.model)?this.model.hidden?Ui(this.model,"unmute"):Ui(this.model,"mute"):this.model.hidden?Ui(this.model,"show"):Ui(this.model,"hide")}};var bo=__dcg_shared_module_exports__['e'](te());var{If:Kpe,SwitchUnion:qpe}=bo.Components;function Hpe(r,e){return __dcg_shared_module_exports__['rb'](r,e)}var db=class extends bo.Class{init(){this.controller=this.props.controller()}template(){return bo.createElement("div",{class:bo.const("dcg-evaluation-container")},bo.createElement("div",{didMount:e=>this.containerNode=e,class:()=>({"dcg-evaluation":!0,"dcg-do-blur":!0,"dcg-hidden":this.props.controller().isInEditListMode()}),handleEvent:bo.const("true"),tabindex:()=>this.props.focusable()&&this.controller.getBrailleMode()==="none"?"0":"-1",onFocus:()=>{this.controller.getBrailleMode()==="none"&&this.evaluationNode&&this.onSelectEvaluation()},onBlur:()=>{this.controller.getBrailleMode()==="none"&&this.evaluationNode&&this.onUnselectEvaluation()},onTap:()=>{var e;return(e=this.containerNode)==null?void 0:e.focus()}},bo.createElement(_o,{latex:this.bindFn(this.getBrailleEvaluation),ariaLabel:this.const(""),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="braille-output"?!1:e.id===this.props.id()},onBrailleInput:()=>{},isStatic:this.const(!0),onBrailleFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"braille-output",id:this.props.id()}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"braille-output",id:this.props.id()}})},...Bn(this.controller)},bo.createElement("div",{class:bo.const("dcg-evaluation-label-container")},bo.createElement(Kpe,{predicate:()=>!!this.props.dependent()},()=>bo.createElement(lt,{latex:()=>__dcg_shared_module_exports__['ub'](this.props.dependent()),config:this.const({})})),bo.createElement("span",{class:bo.const("dcg-equals")},bo.createElement(lt,{latex:this.const("="),config:this.const({})}))),bo.createElement("span",{class:()=>({"dcg-text-selectable":this.getEvaluationType()!=="rgbcolor","dcg-evaluation-html":!0,"dcg-color-evaluation":this.getEvaluationType()==="rgbcolor"}),didMount:this.bindFn(this.didMountEvaluation)},qpe(()=>this.getEvaluationType(),{list:()=>bo.createElement("span",{class:bo.const("dcg-evaluation-list")},()=>this.controller.s("graphing-calculator-label-evaluation-list",{count:this.props.val().length})),fraction:()=>bo.createElement(lt,{latex:()=>__dcg_shared_module_exports__['tb'](this.props.val(),this.getLabelOptions()),config:this.const({})}),undefined:()=>bo.createElement("span",null,bo.const("undefined")),scientific:()=>bo.createElement(lt,{latex:()=>`${this.getNumberLabel().mantissa}\\times10^{${this.getNumberLabel().exponent}}`,config:this.const({})}),decimal:()=>bo.createElement(lt,{latex:()=>this.getNumberLabel().value,config:this.const({})}),rgbcolor:()=>bo.createElement(If,{color:()=>this.getColorValue(),isEvaluation:this.const(!0),invertSwatches:()=>this.controller.invertSwatches()})})))),bo.createElement("div",{class:bo.const("dcg-clear")}))}getColorValue(){let e=this.props.id(),t=this.controller.getColorById(e);return Array.isArray(t)?{type:"color-array",value:t}:{type:"single-color",value:t}}getNumberLabel(){return Hpe(this.props.val(),this.getLabelOptions())}getEvaluationType(){let e=this.props.val();return typeof e=="string"?"rgbcolor":Array.isArray(e)?typeof e[0]=="string"?"rgbcolor":"list":this.getNumberLabel().type}getLabelOptions(){return this.props.controller().getEvaluationLabelOptionsForItem(this.props.id())}didMountEvaluation(e){this.evaluationNode=e}onSelectEvaluation(){let e=document.createRange();e.selectNodeContents(this.evaluationNode);let t=window.getSelection();t&&(t.removeAllRanges(),t=window.getSelection(),t&&t.addRange(e))}onUnselectEvaluation(){let e=window.getSelection();e&&e.removeAllRanges()}getBrailleEvaluation(){let e="";this.props.dependent()&&(e=__dcg_shared_module_exports__['ub'](this.props.dependent())),e+="=";let t=this.getEvaluationType();switch(t){case"list":e+=this.controller.s("graphing-calculator-label-evaluation-list",{count:this.props.val().length});break;case"fraction":e+=__dcg_shared_module_exports__['tb'](this.props.val(),this.getLabelOptions());break;case"undefined":e="undefined";break;case"scientific":e+=`${this.getNumberLabel().mantissa}\\times10^{${this.getNumberLabel().exponent}}`;break;case"decimal":e+=this.getNumberLabel().value;break;case"rgbcolor":e+=this.props.val();break;default:return t}return e}};var Ma=__dcg_shared_module_exports__['e'](te());var{Switch:Wpe}=Ma.Components,cS=class extends Ma.Class{template(){return this.controller=this.props.controller(),Ma.createElement("div",{class:Ma.const("dcg-expression-warning")},Ma.createElement("i",{class:Ma.const("dcg-icon-error"),"aria-hidden":Ma.const("true")}),Ma.createElement(Wpe,{key:this.props.type},e=>{switch(e){case"unresolved":return Ma.createElement("span",null,()=>this.controller.s("graphing-calculator-error-equation-contains-unresolved-details"),Ma.createElement("a",{href:Ma.const("https://help.desmos.com/hc/en-us/articles/202529079-Unresolved-Detail-In-Plotted-Functions"),target:Ma.const("_blank")},()=>this.controller.s("graphing-calculator-link-learn-more")),Ma.const(")"));case"tone-out-of-range":return Ma.createElement("span",null,Ma.const(" "),()=>this.controller.s("graphing-calculator-error-tone-frequency-out-of-range",{min:Ty,max:My}));case"recursive-depth-plotting-error":return Ma.createElement("span",null,()=>this.controller.raw("Reached maximum recursion depth while plotting this expression."))}}))}};var Ya=__dcg_shared_module_exports__['e'](te());var nc=__dcg_shared_module_exports__['e'](te());var{SwitchUnion:$pe}=nc.Components,_r=class extends nc.Class{init(){this.controller=this.props.controller()}template(){return nc.createElement("div",{class:this.bindFn(this.getContainerClass)},$pe(()=>String(this.props.readonly()),{true:()=>nc.createElement(_o,{latex:this.bindFn(this.getStaticLatex),operatorNames:()=>this.getMQConfig().autoOperatorNames,brailleShouldFocus:this.props.isFocused,isStatic:this.const(!0),onBrailleFocusedChanged:this.props.handleFocusChanged,ariaLabel:this.bindFn(this.getBrailleLabel),dataLabelAttributeValue:this.props.dataLabelAttributeValue,...Bn(this.props.controller())},nc.createElement(lt,{latex:this.bindFn(this.getStaticLatex),config:this.bindFn(this.getMQConfig),getAriaLabel:this.props.ariaLabel},nc.createElement("span",{class:nc.const("dcg-math-field"),"data-dcg-label":()=>this.props.dataLabelAttributeValue?this.props.dataLabelAttributeValue():void 0,manageFocus:this.const({shouldBeFocused:()=>this.props.isFocused(),onFocusedChanged:(e,t)=>this.props.handleFocusChanged(e,t)}),tabindex:nc.const("0")}))),false:()=>nc.createElement(_o,{latex:this.props.latex,operatorNames:()=>this.getMQConfig().autoOperatorNames||"",brailleShouldFocus:this.props.isFocused,selectOnFocus:this.const(!0),onBrailleInput:this.props.handleLatexChanged,onBrailleFocusedChanged:this.props.handleFocusChanged,onBrailleKeydown:this.bindFn(this.onBrailleKeydown),hasError:this.props.hasError,placeholder:this.props.placeholder,ariaLabel:this.bindFn(this.getBrailleLabel),dataLabelAttributeValue:this.props.dataLabelAttributeValue,...Bn(this.props.controller())},nc.createElement(Ze,{latex:this.props.latex,getAriaPostLabel:()=>{var t,i;let e=((i=(t=this.props).ariaPostLabel)==null?void 0:i.call(t))||"";return this.props.hasError()&&e===""&&(e=this.controller.s("shared-calculator-narration-math-input-error-message")),e},isFocused:this.props.isFocused,placeholder:this.props.placeholder,capExpressionSize:()=>this.controller.getCapExpressionSize(),selectOnFocus:this.const(!0),config:this.bindFn(this.getMQConfig),getAriaLabel:this.props.ariaLabel,hasError:this.props.hasError,dataLabelAttributeValue:this.props.dataLabelAttributeValue,onUserPressedKey:this.props.handlePressedKey,onUserChangedLatex:this.props.handleLatexChanged,onSelectionChanged:this.props.handleSelectionChanged,onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:this.props.handleFocusChanged,needsSystemKeypad:()=>!this.controller.isKeypadEnabled()}))}))}getStaticLatex(){return this.props.latex()?this.props.latex():this.props.placeholder?this.props.placeholder():""}getContainerClass(){let e=this.props.containerClass?this.props.containerClass():{};return e["dcg-inline-math-input-view"]=!0,this.props.fullWidth&&this.props.fullWidth()&&(e["dcg-full-width-inline-math-input"]=!0),this.props.fontSize&&this.props.fontSize()==="large"&&(e["dcg-large-font-inline-math-input"]=!0),this.props.noBorder&&this.props.noBorder()&&(e["dcg-no-border-inline-math-input"]=!0),e}onBrailleKeydown(e){if(!this.props.handlePressedKey)return;let t=Be(e);t&&this.props.handlePressedKey(t,e)}getMQConfig(){return this.controller.getMathquillConfig({})}getBrailleLabel(){return this.props.brailleLabel?this.props.brailleLabel():this.props.ariaLabel()}};var{If:jpe}=Ya.Components,pb=class extends Ya.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return Ya.createElement("div",{class:Ya.const("dcg-domain dcg-do-blur"),handleEvent:Ya.const("true")},Ya.createElement("div",{class:Ya.const("dcg-display-domain dcg-do-blur"),handleEvent:Ya.const("true")},Ya.createElement(_r,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.getMinLatex(),isFocused:()=>this.getFocusedInput()==="min"+this.getDomainVariableString(),placeholder:()=>__dcg_shared_module_exports__['ob'](I4(this.model,this.getDomainVariable())).latex,ariaLabel:()=>this.controller.s("graphing-calculator-narration-domain3d-minimum",{term:this.getDomainVariableString()}),brailleLabel:()=>this.controller.raw("dmin"),handleFocusChanged:e=>this.handleFocusedChanged("min"+this.getDomainVariableString(),e),hasError:()=>!V4(this.model,this.getDomainVariable()),controller:this.props.controller,handlePressedKey:(e,t)=>this.handlePressedKey("min"+this.getDomainVariableString(),e,t),handleLatexChanged:e=>this.dispatchMinLatexIfChanged(e),dataLabelAttributeValue:this.const("domain-min")}),Ya.createElement("span",{class:Ya.const("dcg-interval-interior")},Ya.createElement(lt,{latex:()=>this.getDomainVariableDisplayLatex(),config:this.const({})})),Ya.createElement(_r,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.getMaxLatex(),isFocused:()=>this.getFocusedInput()==="max"+this.getDomainVariableString(),placeholder:()=>__dcg_shared_module_exports__['ob'](A4(this.model,this.getDomainVariable())).latex,ariaLabel:()=>this.controller.s("graphing-calculator-narration-domain3d-maximum",{term:this.getDomainVariableString()}),brailleLabel:()=>this.controller.raw("dmax"),handleFocusChanged:e=>this.handleFocusedChanged("max"+this.getDomainVariableString(),e),hasError:()=>!L4(this.model,this.getDomainVariable()),controller:this.props.controller,handlePressedKey:(e,t)=>this.handlePressedKey("max"+this.getDomainVariableString(),e,t),handleLatexChanged:e=>this.dispatchMaxLatexIfChanged(e),dataLabelAttributeValue:this.const("domain-max")}),Ya.createElement(jpe,{predicate:()=>this.getDomainVariableString()==="\\phi"},()=>Ya.createElement(hu,{href:this.const("https://help.desmos.com/hc/en-us/articles/15824510769805"),controller:this.props.controller}))))}handlePressedKey(e,t,i){if(!this.controller.isInEditListMode()){if(t==="Esc"){this.controller.dispatch({type:"set-focus-location",location:void 0});return}if(t==="Enter")return this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"})}let o=Ze.getFocusedMathquill(),n=vl();if(t==="Left"||t==="Right"||t==="Down"||t==="Up"){var a;o?a=Ze.applyArrowKeyAndReturnIfWasAtBounds(o,t,i):n&&(n.selectionStart===0&&t==="Left"||n.selectionStart===n.value.length&&t==="Right"||t==="Up"||t==="Down")?a=!0:a=!1,a&&(i&&i.preventDefault(),t==="Left"?e==="max"+this.getDomainVariableString()&&this.controller.dispatch({type:"set-focus-location",location:{type:"domain-limit",id:this.model.id,location:"min"+this.getDomainVariableString()}}):t==="Right"?e==="min"+this.getDomainVariableString()&&this.controller.dispatch({type:"set-focus-location",location:{type:"domain-limit",id:this.model.id,location:"max"+this.getDomainVariableString()}}):t==="Down"?this.controller.dispatch({type:"on-special-key-pressed",key:"Down"}):t==="Up"&&this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.model.id}}));return}o&&(o.keystroke(t,i),e==="min"+this.getDomainVariableString()?this.dispatchMinLatexIfChanged(o.latex()):e==="max"+this.getDomainVariableString()&&this.dispatchMaxLatexIfChanged(o.latex()))}getDomainVariable(){var i,o;let e=this.props.domainIndex(),t=(o=(i=this.model.formula.domains)==null?void 0:i[e])==null?void 0:o.variable;if(!t)throw new Error("Programming Error: could not find domain variable in index "+e);return t}handleFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"domain-limit",id:this.id,location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"domain-limit",id:this.id,location:e}})}dispatchMinLatexIfChanged(e){this.getMinLatex()!==e&&this.controller.dispatch({type:"set-domain-minlatex",variable:this.getDomainVariable(),id:this.id,latex:e})}dispatchMaxLatexIfChanged(e){this.getMaxLatex()!==e&&this.controller.dispatch({type:"set-domain-maxlatex",variable:this.getDomainVariable(),id:this.id,latex:e})}getFocusedInput(){let e=this.controller.getFocusLocation();if(!(!e||e.type!=="domain-limit"||e.id!==this.id))return e.location}getMinLatex(){return Q4(this.model,this.getDomainVariable())}getMaxLatex(){return Z4(this.model,this.getDomainVariable())}getDomainVariableString(){let e=this.getDomainVariable();return e==="theta"?e="\\theta":e==="phi"&&(e="\\phi"),e}getDomainVariableDisplayLatex(){return"\\le "+this.getDomainVariableString()+" \\le"}};var _e=__dcg_shared_module_exports__['e'](te());var{If:ld,For:Ype,IfElse:Xpe}=_e.Components,dS=class extends _e.Class{template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,_e.createElement(ld,{predicate:this.bindFn(this.hasRegression)},()=>_e.createElement("div",{class:_e.const("dcg-regression-container")},_e.createElement("div",{class:_e.const("dcg-handle-event"),handleEvent:_e.const("true")},_e.createElement(ld,{predicate:this.bindFn(this.getShouldSuggestLogMode)},()=>_e.createElement("div",{class:_e.const("dcg-log-mode-toggle")},Xpe(()=>this.areLogModeRegressionsForced(),{true:()=>_e.createElement("div",{class:_e.const("dcg-action-log-mode-toggle dcg-no-hover-styling")},()=>this.controller.s("graphing-calculator-button-regression-log-mode")),false:()=>_e.createElement("div",null,_e.createElement(xt,{class:this.const("dcg-action-log-mode-toggle dcg-log-mode-checkbox"),onChange:this.bindFn(this.onTapLogMode),checked:()=>this.getIsLogModeRegression()},()=>this.controller.s("graphing-calculator-button-regression-log-mode")),_e.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-regression-log-mode-help-tooltip"),gravity:this.const("e")},_e.createElement("a",{"aria-label":()=>this.controller.s("graphing-calculator-label-regression-log-mode-help-tooltip"),class:_e.const("dcg-log-mode-toggle-help"),target:_e.const("_blank"),href:_e.const("https://help.desmos.com/hc/en-us/articles/204349605")},_e.createElement("i",{class:_e.const("dcg-icon-question-sign"),"aria-hidden":_e.const("true")}))))}))),_e.createElement("div",{class:_e.const("dcg-statistics"),role:_e.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-heading-regression-statistics")},_e.createElement("div",{class:_e.const("dcg-expression-footer-title")},()=>this.controller.s("graphing-calculator-heading-regression-statistics"),_e.createElement(ld,{predicate:()=>this.getRegression().statistics.hasOwnProperty("RMSE")},()=>_e.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-regression-what-is-rmse-tooltip"),gravity:this.const("s")},_e.createElement("a",{class:_e.const("dcg-expression-footer-title-help"),target:_e.const("_blank"),href:_e.const("https://help.desmos.com/hc/en-us/articles/202529129-What-is-RMSE-"),"aria-label":()=>this.controller.s("graphing-calculator-label-regression-what-is-rmse-tooltip")},_e.createElement("i",{class:_e.const("dcg-icon-question-sign"),"aria-hidden":_e.const("true")})))),_e.createElement(ld,{predicate:()=>this.getRegression().statistics.Rsquared<0},()=>_e.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-regression-why-is-negative-tooltip"),gravity:this.const("s")},_e.createElement("a",{"aria-label":()=>this.controller.s("graphing-calculator-label-regression-why-is-negative-tooltip"),class:_e.const("dcg-expression-footer-title-help"),target:_e.const("_blank"),href:_e.const("https://help.desmos.com/hc/en-us/articles/202529139-Why-am-I-seeing-a-negative-R-2-value-")},_e.createElement("i",{class:_e.const("dcg-icon-question-sign"),"aria-hidden":_e.const("true")}))))),_e.createElement("div",{class:_e.const("dcg-statistics-values")},_e.createElement(ld,{predicate:()=>this.getRegression().statistics.hasOwnProperty("Rsquared")},()=>_e.createElement("div",null,_e.createElement(_o,{latex:()=>"R^2="+Gc(this.getRegression(),"Rsquared"),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="regression-output"?!1:e.id===this.id&&e.parameter==="Rsquared"},onBrailleFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"regression-output",id:this.id,parameter:"Rsquared"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"regression-output",id:this.id,parameter:"Rsquared"}})},ariaLabel:this.const(""),isStatic:this.const(!0),...Bn(this.controller)},_e.createElement(lt,{latex:()=>"R^2="+Gc(this.getRegression(),"Rsquared"),config:this.const({})},_e.createElement("span",{tabindex:_e.const("0"),manageFocus:this.const(ft({predicate:()=>this.controller.getBrailleMode()==="none",controller:this.controller,location:{type:"regression-output",id:this.id,parameter:"Rsquared"}}))}))))),_e.createElement(ld,{predicate:()=>this.getRegression().statistics.hasOwnProperty("rsquared")},()=>_e.createElement("div",null,_e.createElement(_o,{latex:()=>"r^2="+Gc(this.getRegression(),"rsquared"),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="regression-output"?!1:e.id===this.id&&e.parameter==="rsquared"},onBrailleFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"regression-output",id:this.id,parameter:"rsquared"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"regression-output",id:this.id,parameter:"rsquared"}})},ariaLabel:this.const(""),isStatic:this.const(!0),...Bn(this.controller)},_e.createElement(lt,{latex:()=>"r^2="+Gc(this.getRegression(),"rsquared"),config:this.const({})},_e.createElement("span",{tabindex:_e.const("0"),manageFocus:this.const(ft({predicate:()=>this.controller.getBrailleMode()==="none",controller:this.controller,location:{type:"regression-output",id:this.id,parameter:"rsquared"}}))}))))),_e.createElement(ld,{predicate:()=>this.getRegression().statistics.hasOwnProperty("r")},()=>_e.createElement("div",null,_e.createElement(_o,{latex:()=>"r="+Gc(this.getRegression(),"r"),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="regression-output"?!1:e.id===this.id&&e.parameter==="r"},onBrailleFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"regression-output",id:this.id,parameter:"r"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"regression-output",id:this.id,parameter:"r"}})},ariaLabel:this.const(""),isStatic:this.const(!0),...Bn(this.controller)},_e.createElement(lt,{latex:()=>"r="+Gc(this.getRegression(),"r"),config:this.const({})},_e.createElement("span",{class:_e.const("dcg-r-value"),tabindex:_e.const("0"),manageFocus:this.const(ft({predicate:()=>this.controller.getBrailleMode()==="none",controller:this.controller,location:{type:"regression-output",id:this.id,parameter:"r"}}))}))))),_e.createElement(ld,{predicate:()=>this.getRegression().statistics.hasOwnProperty("RMSE")},()=>_e.createElement("div",null,_e.createElement(_o,{latex:()=>"\\operatorname{RMSE}="+Gc(this.getRegression(),"RMSE"),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="regression-output"?!1:e.id===this.id&&e.parameter==="RMSE"},onBrailleFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"regression-output",id:this.id,parameter:"RMSE"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"regression-output",id:this.id,parameter:"RMSE"}})},ariaLabel:this.const(""),isStatic:this.const(!0),...Bn(this.controller)},_e.createElement(lt,{latex:()=>"\\operatorname{RMSE}="+Gc(this.getRegression(),"RMSE"),config:this.const({})},_e.createElement("span",{tabindex:_e.const("0"),manageFocus:this.const(ft({predicate:()=>this.controller.getBrailleMode()==="none",controller:this.controller,location:{type:"regression-output",id:this.id,parameter:"RMSE"}}))}))))))),_e.createElement("div",{role:_e.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-heading-regression-residuals"),class:_e.const("dcg-residuals")},_e.createElement("div",{class:_e.const("dcg-expression-footer-title")},()=>this.controller.s("graphing-calculator-heading-regression-residuals")),_e.createElement(_o,{latex:this.bindFn(this.getResidualVariable),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="regression-output"?!1:e.id===this.id&&e.parameter===this.getResidualVariable()},onBrailleFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"regression-output",id:this.id,parameter:this.getResidualVariable()}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"regression-output",id:this.id,parameter:this.getResidualVariable()}})},ariaLabel:this.const(""),isStatic:this.const(!0),...Bn(this.controller)},_e.createElement(lt,{latex:this.bindFn(this.getResidualVariable),config:this.const({})},_e.createElement("span",{class:_e.const("dcg-residuals-variable"),tabindex:_e.const("0"),manageFocus:this.const(ft({predicate:()=>this.controller.getBrailleMode()==="none",controller:this.controller,location:{type:"regression-output",id:this.id,parameter:this.getResidualVariable()}}))}))),_e.createElement(ld,{predicate:this.bindFn(this.getResidualSuggestionVisible)},()=>_e.createElement("div",{class:_e.const("dcg-residual-suggestion dcg-action-plot-residual dcg-btn dcg-btn-light-gray"),role:_e.const("button"),onTap:this.bindFn(this.onTapResidualsSuggestion)},()=>this.controller.s("graphing-calculator-button-regression-plot-residuals")))),_e.createElement(ld,{predicate:()=>Object.keys(this.getRegression().parameters).length>0},()=>_e.createElement("div",{class:_e.const("dcg-parameters-container")},_e.createElement("div",{class:_e.const("dcg-expression-footer-title")},()=>this.controller.s("graphing-calculator-heading-regression-parameters"),_e.createElement(ld,{predicate:()=>this.isNonLinearRegression()},()=>_e.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-regression-parameters-not-exact"),gravity:this.const("s")},_e.createElement("a",{class:_e.const("dcg-expression-footer-title-help"),target:_e.const("_blank"),href:_e.const("https://help.desmos.com/hc/en-us/articles/360042428612"),"aria-label":()=>this.controller.s("graphing-calculator-label-regression-parameters-not-exact")},_e.createElement("i",{class:_e.const("dcg-icon-question-sign"),"aria-hidden":_e.const("true")}))))),_e.createElement(Ype,{each:()=>Object.keys(this.getRegression().parameters)},_e.createElement("div",{role:_e.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-heading-regression-parameters"),class:_e.const("dcg-parameters")},e=>_e.createElement(_o,{latex:()=>e+"="+MI(this.getRegression(),e),brailleShouldFocus:()=>{let t=this.controller.getFocusLocation();return!t||t.type!=="regression-output"?!1:t.id===this.id&&t.parameter===e},onBrailleFocusedChanged:t=>{t?this.controller.dispatch({type:"set-focus-location",location:{type:"regression-output",id:this.id,parameter:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"regression-output",id:this.id,parameter:e}})},ariaLabel:this.const(""),isStatic:this.const(!0),...Bn(this.controller)},_e.createElement(lt,{latex:()=>e+"="+MI(this.getRegression(),e),config:this.const({})},_e.createElement("span",{class:_e.const("dcg-parameter"),tabindex:_e.const("0"),manageFocus:this.const(ft({controller:this.controller,location:{type:"regression-output",id:this.id,parameter:e}}))}))))))),_e.createElement("div",{class:_e.const("dcg-clear")}),_e.createElement(ld,{predicate:()=>this.hasParameterWarning()},()=>_e.createElement("div",{class:_e.const("dcg-parameter-warning")},_e.createElement("i",{class:_e.const("dcg-icon-error"),"aria-hidden":_e.const("true")}),_e.const("\xA0"),()=>this.controller.s("graphing-calculator-text-regression-potentially-inaccurate-parameters"),_e.const("\xA0"),_e.createElement("a",{href:_e.const("https://help.desmos.com/hc/en-us/articles/360042942771"),target:_e.const("_blank")},()=>this.controller.s("graphing-calculator-link-learn-more")))))))}onTapResidualsSuggestion(){this.controller.dispatch({type:"plot-residuals",id:this.id})}onTapLogMode(){this.controller.dispatch({type:"toggle-logmode",id:this.id})}getRegression(){return this.model.formula.regression}hasRegression(){return!!this.model.formula.regression}isNonLinearRegression(){return!this.getRegression().isLinear}getResidualVariable(){return this.getRegression().residualVariable||""}getResidualSuggestionVisible(){return this.getRegression().residualSuggestionId!==void 0}areLogModeRegressionsForced(){return this.controller.areLogModeRegressionsForced()}getShouldSuggestLogMode(){return!!this.getRegression().shouldSuggestLogMode}hasParameterWarning(){return!!this.getRegression().parameterWarning}getIsLogModeRegression(){return!!this.model.isLogModeRegression}};function MI(r,e){return __dcg_shared_module_exports__['tb'](r.parameters[e],{digits:6,smallCutoff:1e-6,bigCutoff:1e9})}function Gc(r,e){return __dcg_shared_module_exports__['tb'](r.statistics[e],{zeroCutoff:1e-15,digits:4,smallCutoff:1e-6,bigCutoff:1e9})}var Jo=__dcg_shared_module_exports__['e'](te());var xn=__dcg_shared_module_exports__['e'](te());var{If:Jpe}=xn.Components,pS=class extends xn.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return xn.createElement("div",{class:xn.const("dcg-slider_menu dcg-do-blur"),handleEvent:xn.const("true"),didMount:e=>this.node=e},xn.createElement("div",{class:xn.const("dcg-editable-mathquill-container")},xn.createElement(Jpe,{predicate:()=>!this.shouldOnlyShowStep()},()=>xn.createElement("span",null,xn.createElement(_r,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.model.slider.hardMin?this.model.slider.min:"",isFocused:()=>this.getFocusedInput()==="min",ariaLabel:()=>this.controller.s("graphing-calculator-narration-slider-minimum"),brailleLabel:()=>this.controller.raw("sldrmin"),handleFocusChanged:(e,t)=>this.handleFocusedChanged("min",e,t),hasError:()=>!_k(this.model),controller:this.props.controller,handlePressedKey:(e,t)=>this.handlePressedKey("min",e,t),handleLatexChanged:e=>this.handleLatexChanged("min",e),dataLabelAttributeValue:this.const("slidermin")}),xn.createElement("span",{class:xn.const("dcg-interval-interior")},xn.createElement(lt,{latex:this.bindFn(this.getDependentLatex),config:this.const({})},xn.createElement("span",null))),xn.createElement(_r,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.model.slider.hardMax?this.model.slider.max:"",isFocused:()=>this.getFocusedInput()==="max",ariaLabel:()=>this.controller.s("graphing-calculator-narration-slider-maximum"),brailleLabel:()=>this.controller.raw("sldrmax"),handleFocusChanged:(e,t)=>this.handleFocusedChanged("max",e,t),hasError:()=>!Ok(this.model),controller:this.props.controller,handlePressedKey:(e,t)=>this.handlePressedKey("max",e,t),handleLatexChanged:e=>this.handleLatexChanged("max",e),dataLabelAttributeValue:this.const("slidermax")}))),xn.createElement("span",{class:()=>({"dcg-slider-step-container":!this.shouldOnlyShowStep()})},xn.createElement("span",{class:xn.const("dcg-slider-step-label"),"aria-hidden":xn.const("true")},()=>this.controller.s("graphing-calculator-label-slider-step")),xn.createElement(_r,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.model.slider.step,isFocused:()=>this.getFocusedInput()==="step",ariaLabel:()=>this.controller.s("graphing-calculator-narration-slider-step"),brailleLabel:()=>this.controller.raw("sldrstep"),handleFocusChanged:(e,t)=>this.handleFocusedChanged("step",e,t),hasError:()=>!Rk(this.model),controller:this.props.controller,handlePressedKey:(e,t)=>this.handlePressedKey("step",e,t),handleLatexChanged:e=>this.handleLatexChanged("step",e),dataLabelAttributeValue:this.const("sliderstep")}))))}handlePressedKey(e,t,i){if(!this.controller.isInEditListMode()&&!this.shouldOnlyShowStep()&&(t==="Esc"||t==="Enter")){this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.id}});return}let o=Ze.getFocusedMathquill(),n=vl();if(t==="Left"||t==="Right"||t==="Down"||t==="Up"){var a;o?a=Ze.applyArrowKeyAndReturnIfWasAtBounds(o,t,i):n&&(n.selectionStart===0&&t==="Left"||n.selectionStart===n.value.length&&t==="Right"||t==="Up"||t==="Down")?a=!0:a=!1,a&&(i&&i.preventDefault(),t==="Left"&&!this.shouldOnlyShowStep()?e==="max"?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:"min"}}):e==="step"&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:"max"}}):t==="Right"&&!this.shouldOnlyShowStep()?e==="min"?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:"max"}}):e==="max"&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:"step"}}):t==="Down"?this.controller.dispatch({type:"on-special-key-pressed",key:"Down"}):t==="Up"&&this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}}));return}o&&(o.keystroke(t,i),this.handleLatexChanged(e,o.latex()))}shouldOnlyShowStep(){return this.model.slider.loopMode==="PLAY_INDEFINITELY"}handleLatexChanged(e,t){e==="min"?this.dispatchMinLatexIfChanged(t):e==="max"?this.dispatchMaxLatexIfChanged(t):e==="step"&&this.dispatchStepLatexIfChanged(t)}handleFocusedChanged(e,t,i){t&&this.getFocusedInput()!==e?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:e}}):this.getFocusedInput()===e&&this.controller.getBrailleMode()==="none"&&(!i.relatedTarget||!this.node.contains(i.relatedTarget))&&this.controller.dispatch({type:"blur-focus-location",location:{type:"slider-limit",id:this.id,location:e}})}dispatchMinLatexIfChanged(e){this.model.slider.min!==e&&this.controller.dispatch({type:"set-slider-minlatex",id:this.id,latex:e})}dispatchMaxLatexIfChanged(e){this.model.slider.max!==e&&this.controller.dispatch({type:"set-slider-maxlatex",id:this.id,latex:e})}dispatchStepLatexIfChanged(e){this.model.slider.step!==e&&this.controller.dispatch({type:"set-slider-steplatex",id:this.id,latex:e})}getDependentLatex(){var e=sa(this.model)||"";return" \\le "+__dcg_shared_module_exports__['ub'](e)+" \\le "}getFocusedInput(){let e=this.controller.getFocusLocation();if(!(!e||e.type!=="slider-limit"||e.id!==this.id))return e.location}};var{If:qY}=Jo.Components,uS=class extends Jo.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return Jo.createElement("span",{class:Jo.const("dcg-slider-container"),tapboundary:Jo.const("true"),onKeydown:e=>{if(Be(e)==="Tab"&&!e.altKey&&!e.metaKey&&!e.ctrlKey)if(e.shiftKey)if(this.isSliderMinFocused()&&this.controller.isInEditListMode()){if(e.target){let t=e.target.closest(".dcg-expressionitem");if(t){let i=Array.from(t.querySelectorAll('[tabindex="0"]')).filter(Zu)[0];i==null||i.focus()}}e.preventDefault(),e.stopPropagation()}else this.isSliderThumbFocused()&&(this.controller.isItemReadonly(this.model.id)||(this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:"step"}}),e.preventDefault(),e.stopPropagation()));else!e.shiftKey&&this.isSliderStepFocused()&&(this.controller.isInEditListMode()?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-icon",id:this.id}}):this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.id}}),e.preventDefault(),e.stopPropagation())}},Jo.createElement(qY,{predicate:this.bindFn(this.shouldShowSlider)},()=>Jo.createElement("div",{class:Jo.const("dcg-do-blur dcg-slider"),handleEvent:Jo.const("true")},Jo.createElement("div",{class:Jo.const("dcg-minLabel dcg-template-minlabelhtml"),role:Jo.const("button"),tabindex:Jo.const("0"),"aria-label":this.bindFn(this.getMinAriaLabel),onTap:()=>this.onEditLimit("min")},Jo.createElement(lt,{latex:()=>Lk(this.model),config:this.const({})})),Jo.createElement(jf,{min:()=>hc(this.model),max:()=>Rd(this.model),step:()=>Jc(this.model),value:()=>hl(this.model),ariaLabel:()=>this.controller.getBrailleMode()==="none"?'"'+sa(this.model)+'"':""+sa(this.model),onGrab:this.bindFn(this.onGrab),onDrop:this.bindFn(this.onDrop),onDragUpdate:this.bindFn(this.onDragUpdate),onKeyboardUpdate:this.bindFn(this.onKeyboardUpdate),onUpPress:()=>this.controller.dispatch({type:"on-special-key-pressed",key:"Up"}),onDownPress:()=>this.controller.dispatch({type:"on-special-key-pressed",key:"Down"}),onEnterPress:()=>this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"}),isFocused:this.bindFn(this.isSliderThumbFocused),onFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.id}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"slider-thumb",id:this.id}})}}),Jo.createElement("div",{class:Jo.const("dcg-maxLabel dcg-template-maxlabelhtml"),onTap:()=>this.onEditLimit("max"),role:Jo.const("button"),tabindex:Jo.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-narration-slider-maximum")+" "+la(Lk(this.model))},Jo.createElement(lt,{latex:()=>S4(this.model),config:this.const({})})))),Jo.createElement(qY,{predicate:this.bindFn(this.shouldShowLimitInputs)},()=>Jo.createElement(pS,{model:this.props.model,controller:this.props.controller})))}getMinAriaLabel(){return this.controller.isItemReadonly(this.model.id)?this.controller.s("graphing-calculator-narration-slider-minimum")+" "+la(Lk(this.model)):this.controller.s("graphing-calculator-narration-edit-slider-variable-limits",{variable:this.controller.getBrailleMode()==="none"?'"'+sa(this.model)+'"':""+sa(this.model)})}onGrab(){this.dispatchIsDraggingIfChanged(!0)}onDrop(){this.controller.dispatch({type:"set-none-selected"}),this.dispatchIsPlayingIfChanged(!1),this.dispatchIsDraggingIfChanged(!1)}onKeyboardUpdate(e){this.controller.dispatch({type:"adjust-slider-by-keyboard",id:this.id,adjustment:e})}onDragUpdate(e){this.controller.dispatch({type:"adjust-slider-by-dragging-thumb",id:this.model.id,target:e})}onEditLimit(e){this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:e}})}dispatchIsPlayingIfChanged(e){this.model.slider.isPlaying!==e&&this.controller.dispatch({type:"set-slider-isplaying",id:this.id,isPlaying:e})}dispatchIsDraggingIfChanged(e){this.model.sliderDragging!==e&&this.controller.dispatch({type:"set-slider-dragging",id:this.id,dragging:e})}shouldShowLimitInputs(){if(this.controller.isInEditListMode())return!0;if(this.controller.isItemReadonly(this.model.id))return!1;if(!_k(this.model)||!Ok(this.model)||!Rk(this.model)||this.model.slider.loopMode==="PLAY_INDEFINITELY")return!0;let e=this.controller.getFocusLocation();return!!(e&&(e.type==="slider-limit"||e.type==="expression"||e.type==="top-level-icon"||e.type==="readonly-expression")&&e.id===this.id)}shouldShowSlider(){return!this.shouldShowLimitInputs()}isSliderThumbFocused(){let e=this.controller.getFocusLocation();return!!(e&&e.type==="slider-thumb"&&e.id===this.id)}isSliderMinFocused(){let e=this.controller.getFocusLocation();return!!(e&&e.type==="slider-limit"&&e.id===this.id&&e.location==="min")}isSliderStepFocused(){let e=this.controller.getFocusLocation();return!!(e&&e.type==="slider-limit"&&e.id===this.id&&e.location==="step")}};qt();var Oo=__dcg_shared_module_exports__['e'](te());var{For:Qpe,If:Zpe}=Oo.Components,op=class extends Oo.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return Oo.createElement("div",{class:Oo.const("dcg-create-sliders dcg-action-createslider"),handleEvent:Oo.const("true"),onTap:this.bindFn(this.onCreateSlider)},Oo.createElement("span",{class:Oo.const("dcg-msg")},()=>this.controller.s("graphing-calculator-label-add-slider")),Oo.createElement("span",{class:Oo.const("btns")},Oo.createElement(Qpe,{each:()=>this.getMissingVariables().slice(0,4)},Oo.createElement("span",null,e=>Oo.createElement("div",{class:Oo.const("dcg-slider-btn-container"),var_name:this.const(e)},Oo.createElement("div",{role:Oo.const("button"),tabindex:Oo.const("0"),class:()=>({"dcg-btn-slider":!0,"dcg-btn-blue":this.getMissingVariables().length===1,"dcg-btn-light-gray":this.getMissingVariables().length!==1}),didMount:t=>{t.innerHTML=__dcg_shared_module_exports__['vb'](e)}})))),Oo.createElement(Zpe,{predicate:()=>this.getMissingVariables().length>1},()=>Oo.createElement("div",{class:Oo.const("dcg-slider-btn-container dcg-all")},Oo.createElement("div",{role:Oo.const("button"),tabindex:Oo.const("0"),class:Oo.const("dcg-btn-slider dcg-btn-blue")},()=>this.controller.s("graphing-calculator-button-slider-add-all-variables"))))))}onCreateSlider(e){if(this.controller.dispatch({type:"set-none-selected"}),!e.target)return;var t=e.target.closest(".dcg-slider-btn-container");if(!t)return;let i=t.classList.contains("dcg-all"),o=i?this.getMissingVariables():[t.getAttribute("var_name")];if(this.model.type==="ticker"?this.controller.dispatch({type:"create-sliders-for-ticker",variables:this.getMissingVariables()}):this.controller.dispatch({type:"create-sliders-for-item",id:this.model.id,variables:o}),e.device==="keyboard"){let n=this.model.id,a=this.props.controller().getItemNodeById(n);if(!a)return;i?this.controller.dispatch({type:"move-focus-to-item",id:n}):ie(a.querySelector(".dcg-btn-blue")).trigger("focus")}}getMissingVariables(){return this.model.type==="ticker"?SC(this.model):TC(this.model)}didMount(){this.promptAlertTimeout&&clearTimeout(this.promptAlertTimeout),this.promptAlertTimeout=setTimeout(this.bindIfMounted(()=>{for(var e=[],t=this.getMissingVariables(),i=0;i<t.length;i++)e.push('"'+t[i]+'"');Te(this.controller.s("graphing-calculator-narration-add-slider-prompt",{vars:e.join(",")})),this.promptAlertTimeout=0}),2e3)}didUnmount(){this.promptAlertTimeout&&clearTimeout(this.promptAlertTimeout)}};var Zs=__dcg_shared_module_exports__['e'](te());var hS=class extends Zs.Class{template(){return Zs.createElement("div",{class:Zs.const("dcg-prompt-rename"),handleEvent:Zs.const("true")},()=>Pn("graphing-calculator-label-rename"),Zs.createElement("span",{class:Zs.const("dcg-btn-light-gray"),onTap:this.props.handleRename,tabindex:Zs.const(0),role:Zs.const("button")},Zs.createElement(lt,{latex:()=>this.props.from()+" \\to "+this.props.to(),config:this.const({})},Zs.createElement("span",{style:Zs.const("pointer-events:none")}))),Zs.createElement("span",{class:Zs.const("dcg-reference-count")},()=>Pn(this.props.inFolder()?"graphing-calculator-label-reference-count-in-folder":"graphing-calculator-label-reference-count",{count:new on(this.props.count())})))}};var Tc=__dcg_shared_module_exports__['e'](te());var Un=__dcg_shared_module_exports__['e'](te());var{If:HY}=Un.Components,gS=class extends Un.Class{constructor(){super(...arguments),this.focusedValues={}}template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,Un.createElement("div",{class:Un.const("dcg-cdf-footer-container dcg-do-blur"),tapboundary:Un.const("true"),handleEvent:Un.const("true")},Un.createElement(xt,{checked:()=>Rp(this.model),disabled:()=>q_(this.model)||this.controller.isItemReadonly(this.model.id),onChange:e=>{this.controller.dispatch({type:"set-show-cdf",id:this.model.id,showCDF:e})}},()=>this.controller.s("graphing-calculator-button-find-cdf")),Un.createElement(HY,{predicate:()=>Rp(this.model)},()=>Un.createElement("div",null,Un.createElement("span",{class:Un.const("dcg-cdf-limit-name")},()=>this.controller.s("graphing-calculator-label-cdf-minimum")),Un.createElement(_r,{handleFocusChanged:e=>this.handleFocusedChanged("min",e),latex:()=>wC(this.model),hasError:()=>!CC(this.model),isFocused:()=>this.isInputFocused("min"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-cdf-minimum"),placeholder:()=>d8(this.model),handlePressedKey:(e,t)=>this.handlePressedKey(e,t,"min"),controller:this.props.controller,handleLatexChanged:this.bindFn(this.updateCDFMin),readonly:()=>this.controller.isItemReadonly(this.model.id)}),Un.createElement("span",{class:Un.const("dcg-cdf-limit-name")},()=>this.controller.s("graphing-calculator-label-cdf-maximum")),Un.createElement(_r,{handleFocusChanged:e=>this.handleFocusedChanged("max",e),latex:()=>vC(this.model),hasError:()=>!EC(this.model),isFocused:()=>this.isInputFocused("max"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-cdf-maximum"),placeholder:()=>p8(this.model),handlePressedKey:(e,t)=>this.handlePressedKey(e,t,"max"),controller:this.props.controller,handleLatexChanged:this.bindFn(this.updateCDFMax),readonly:()=>this.controller.isItemReadonly(this.model.id)}),Un.createElement(HY,{predicate:this.bindFn(this.showEvaluation)},()=>Un.createElement("div",{class:Un.const("dcg-cdf-evaluation-container")},Un.createElement(db,{val:()=>nG(this.model),controller:this.props.controller,dependent:this.const(""),id:()=>this.model.id,focusable:this.const(!0)}))))))}handlePressedKey(e,t,i){if(e==="Esc"){this.controller.dispatch({type:"set-focus-location",location:void 0});return}if(e==="Enter")return this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"});var o=Ze.getFocusedMathquill();o&&(o.keystroke(e,t),i==="min"&&wC(this.model)!==o.latex()&&this.updateCDFMin(o.latex()),i==="max"&&vC(this.model)!==o.latex()&&this.updateCDFMax(o.latex()))}updateCDFMax(e){this.controller.dispatch({type:"set-cdf-max",id:this.model.id,latex:e})}updateCDFMin(e){this.controller.dispatch({type:"set-cdf-min",id:this.model.id,latex:e})}showEvaluation(){return!(!EC(this.model)||!CC(this.model))}isInputFocused(e){let t=this.controller.getFocusLocation();return!t||t.type!=="cdf-limit"||t.id!==this.id?!1:t.location===e}handleFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"cdf-limit",id:this.id,location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"cdf-limit",id:this.id,location:e}})}};var Xa=__dcg_shared_module_exports__['e'](te());var{If:eue,For:WY,SwitchUnion:tue}=Xa.Components,Sw=class extends Xa.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return tue(this.bindFn(this.getSuggestionType),{list:()=>Xa.createElement(WY,{each:this.bindFn(this.getListOfParameters)},Xa.createElement("div",{class:()=>({"dcg-parameter-suggestion-container":!0,"dcg-parameter-suggestion-braille":this.controller.getBrailleMode()!=="none"})},e=>Xa.createElement("span",{class:Xa.const("dcg-parameter-name")},()=>this.getParamName(e)))),listWithDefault:()=>Xa.createElement(WY,{each:this.bindFn(this.getListOfParameters)},Xa.createElement("div",{class:()=>({"dcg-parameter-suggestion-container":!0,"dcg-parameter-suggestion-braille":this.controller.getBrailleMode()!=="none"}),onTap:this.bindFn(this.fillInDefaults)},e=>Xa.createElement("span",{class:Xa.const("dcg-parameter-name")},()=>this.getParamName(e),Xa.createElement(eue,{predicate:()=>this.shouldShowDefaultValue(e)},()=>Xa.createElement("span",{class:Xa.const("dcg-default-marker")},Xa.const("= "),()=>this.getDefaultValue(e)))))),individual:()=>Xa.createElement("div",{class:()=>({"dcg-parameter-suggestion-container":!0,"dcg-parameter-suggestion-braille":this.controller.getBrailleMode()!=="none"})},this.bindFn(this.getMissingRequiredParamText)),none:()=>{}})}getExtractedAndDefaultArgString(e){let{params:t,values:i,defaults:o}=e;return t.map((a,s)=>{let l=i[a],c=o[s];return l||c||""}).join(",")}fillInDefaults(){let e=gc(this.model);if(!e)return;let{symbol:t,span:i}=e,{input:o,start:n,end:a}=i,s=this.getExtractedAndDefaultArgString(e),l=`\\operatorname{${t}}\\left(${s}\\right)`,c=`${o.slice(0,n)}${l}${o.slice(a)}`;this.controller.dispatch({type:"set-item-latex",id:this.id,latex:c}),this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}}),this.controller.dispatch({type:"keypad/press-key",key:"Left"})}isMissingDefault(){if(!xC(this.model))return!1;let e=gc(this.model);if(!e)return!1;for(var t=0;t<e.params.length;t++)if(this.shouldShowDefaultValue(e.params[t]))return!0;return!1}getSuggestionType(){return this.getListOfParameters().length>1?this.isMissingDefault()?"listWithDefault":"list":this.missingRequiredParam()?"individual":"none"}missingRequiredParam(){let e=gc(this.model);if(e&&e.params.length===1){var t=e.params[0];if(!this.getDefaultValue(t)&&!this.getParameterExtractedValue(t))return t}}getMissingRequiredParamText(){var e=this.missingRequiredParam();return e?this.controller.s("graphing-calculator-text-enter-pareneter",{param:this.getParamName(e)}):""}getDefaultValue(e){let t=gc(this.model);if(!t||!t.params)return"";for(let i=0;i<t.params.length;i++)if(t.params[i]===e)return t.defaults[i]||"";return""}getParameterExtractedValue(e){let t=gc(this.model);return t&&t.values[e]||""}shouldShowDefaultValue(e){return!this.getParameterExtractedValue(e)&&!!this.getDefaultValue(e)}getListOfParameters(){let e=gc(this.model);return e?e.params:[]}getParamName(e){switch(e){case"mean":return this.controller.s("graphing-calculator-text-parameter-name-mean");case"stdev":return this.controller.s("graphing-calculator-text-parameter-name-stddev");case"dof":return this.controller.s("graphing-calculator-text-parameter-name-dof");case"probsuccess":return this.controller.s("graphing-calculator-text-parameter-name-probsuccess");case"trials":return this.controller.s("graphing-calculator-text-parameter-name-trials");case"data":return this.controller.s("graphing-calculator-text-parameter-name-data");case"binwidth":return this.controller.s("graphing-calculator-text-parameter-name-binwidth");case"min":return this.controller.s("graphing-calculator-text-parameter-name-min");case"max":return this.controller.s("graphing-calculator-text-parameter-name-max");case"height":return this.controller.s("graphing-calculator-text-parameter-name-height");case"offset":return this.controller.s("graphing-calculator-text-parameter-name-offset");default:return e}}};var{If:rue}=Tc.Components,mS=class extends Tc.Class{template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,Tc.createElement("div",{class:Tc.const("dcg-distribution-parameters-container dcg-do-blur"),tapboundary:Tc.const("true"),handleEvent:Tc.const("true")},Tc.createElement(Sw,{model:this.props.model,controller:this.props.controller}),Tc.createElement(rue,{predicate:()=>K_(this.model)},()=>Tc.createElement(gS,{model:this.props.model,controller:this.props.controller})))}};var mr=__dcg_shared_module_exports__['e'](te());var{SwitchUnion:iue,If:$Y}=mr.Components,Dw=class extends mr.Class{template(){return mr.createElement("div",{class:mr.const("dcg-toggle-container")},mr.createElement("div",{class:mr.const("dcg-expression-footer-title")},this.props.title,mr.createElement($Y,{predicate:()=>!!this.props.helpLink},()=>mr.createElement("a",{"aria-label":()=>this.props.controller().s("account-shell-link-help"),class:mr.const("dcg-expression-footer-title-help"),target:mr.const("_blank"),href:this.props.helpLink},mr.createElement("i",{class:mr.const("dcg-icon-question-sign"),"aria-hidden":mr.const("true")})))),mr.createElement(Xi,{staticConfig:this.bindFn(this.getSegmentedControlOptions),ariaGroupLabel:this.props.title,disabled:this.bindFn(this.isReadonly),theme:this.const("mini"),minButtonWidth:this.const(65)}))}isReadonly(){return this.props.controller().isItemReadonly(this.props.model().id)}getSegmentedControlOptions(){return this.props.options().map(e=>({key:e.name,label:()=>e.displayName,selected:()=>this.isSelected(e.name),onSelect:()=>{this.props.controller().dispatch({type:"set-visualization-prop",id:this.props.model().id,prop:this.props.vizProp(),value:e.name})}}))}isSelected(e){return ah(this.props.model(),this.props.vizProp())===e}},fS=class extends mr.Class{template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,mr.createElement("div",{class:mr.const("dcg-visualization-parameters-container dcg-do-blur"),tapboundary:mr.const("true"),handleEvent:mr.const("true")},mr.createElement(Sw,{...this.props}),mr.createElement("div",{class:mr.const("dcg-smaller-font")},iue(()=>this.getVisualizationType(),{boxplot:()=>mr.createElement("div",null,mr.createElement("div",{class:mr.const("dcg-expression-footer-title")},()=>this.controller.s("graphing-calculator-heading-visual-parameters-display-properties")),this.makeMQInput({prop:"axisOffset",siblingProps:["breadth"],default:"1",name:()=>this.controller.s("graphing-calculator-narration-visual-parameters-offset")}),this.makeMQInput({prop:"breadth",siblingProps:["axisOffset"],default:"1",name:()=>ah(this.model,"alignedAxis")==="y"?this.controller.s("graphing-calculator-narration-visual-parameters-width"):this.controller.s("graphing-calculator-narration-visual-parameters-height")}),mr.createElement(xt,{checked:()=>!!ah(this.model,"showBoxplotOutliers"),disabled:()=>this.controller.isItemReadonly(this.model.id),onChange:this.bindFn(this.onToggleOutliers)},mr.createElement("span",{class:mr.const("dcg-parameter-name")},()=>this.controller.s("graphing-calculator-button-visual-parameters-exclude-outliers")))),dotplot:()=>mr.createElement($Y,{predicate:()=>M4(this.model)},()=>mr.createElement("div",{class:mr.const("dcg-toggles-container")},mr.createElement(Dw,{...this.props,vizProp:()=>"dotplotXMode",options:()=>[{name:"exact",displayName:this.controller.s("graphing-calculator-button-visual-parameters-exact")},{name:"bin",displayName:this.controller.s("graphing-calculator-button-visual-parameters-binned")}],title:()=>this.controller.s("graphing-calculator-heading-visual-parameters-x-values")}),mr.createElement(Dw,{...this.props,vizProp:()=>"binAlignment",options:()=>[{name:"center",displayName:this.controller.s("graphing-calculator-button-visual-parameters-center")},{name:"left",displayName:this.controller.s("graphing-calculator-button-visual-parameters-left")}],title:()=>this.controller.s("graphing-calculator-heading-visual-parameters-bin-alignment")}))),histogram:()=>mr.createElement("div",{class:mr.const("dcg-toggles-container")},mr.createElement(Dw,{...this.props,vizProp:()=>"histogramMode",options:()=>[{name:"",displayName:this.controller.s("graphing-calculator-button-visual-parameters-count")},{name:"relative",displayName:this.controller.s("graphing-calculator-button-visual-parameters-relative")},{name:"density",displayName:this.controller.s("graphing-calculator-button-visual-parameters-density")}],title:()=>this.controller.s("graphing-calculator-heading-visual-parameters-bar-heights"),helpLink:this.const("https://help.desmos.com/hc/en-us/articles/360022405991")}),mr.createElement(Dw,{...this.props,vizProp:()=>"binAlignment",options:()=>[{name:"center",displayName:this.controller.s("graphing-calculator-button-visual-parameters-center")},{name:"left",displayName:this.controller.s("graphing-calculator-button-visual-parameters-left")}],title:()=>this.controller.s("graphing-calculator-heading-visual-parameters-bin-alignment")})),none:()=>mr.createElement("span",null)})))}makeMQInput(e){return mr.createElement("span",null,mr.createElement("span",{class:mr.const("dcg-parameter-name")},e.name,mr.const(":")),mr.createElement(_r,{latex:()=>this.getPropLatex(e),ariaLabel:e.name,placeholder:()=>e.default,isFocused:()=>this.isInputFocused(e.prop),hasError:()=>!k4(this.model,e.prop),handleFocusChanged:t=>this.handleFocusedChanged(e.prop,t),handlePressedKey:(t,i)=>this.handlePressedKey(t,i,e.prop),handleLatexChanged:t=>this.handleLatexChanged(e.prop,t),readonly:()=>this.controller.isItemReadonly(this.model.id),controller:this.props.controller}))}handlePressedKey(e,t,i){if(e==="Esc"){this.controller.dispatch({type:"set-focus-location",location:void 0});return}if(e==="Enter")return this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"});var o=Ze.getFocusedMathquill();o&&(o.keystroke(e,t),this.handleLatexChanged(i,o.latex()))}isInputFocused(e){let t=this.controller.getFocusLocation();return!t||t.type!=="visualization-prop"||t.id!==this.id?!1:t.location===e}handleFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"visualization-prop",id:this.id,location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"visualization-prop",id:this.id,location:e}})}getPropLatex({prop:e}){let t=ah(this.model,e);return typeof t=="string"?t:""}handleLatexChanged(e,t){ah(this.model,e)!==t&&this.controller.dispatch({type:"set-visualization-prop",id:this.id,prop:e,value:t})}onToggleOutliers(){var e=ah(this.model,"showBoxplotOutliers");this.controller.dispatch({type:"set-visualization-prop",id:this.id,prop:"showBoxplotOutliers",value:!e})}getVisualizationType(){return xC(this.model)?Eg(this.model)?"boxplot":lh(this.model)?"dotplot":hf(this.model)?"histogram":"none":"none"}};var fr=__dcg_shared_module_exports__['e'](te());var bS=class extends fr.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return fr.createElement("div",{class:fr.const("dcg-ttest-footer-container dcg-do-blur"),handleEvent:fr.const("true")},fr.createElement("table",null,fr.createElement("tr",null,fr.createElement("td",null,fr.createElement("div",{class:fr.const("dcg-value"),role:fr.const("textbox"),"aria-readonly":fr.const("true"),tabindex:fr.const("0"),"aria-label":()=>"Less than: "+this.getLessThan()},fr.createElement("span",{class:fr.const("dcg-operator")},fr.createElement(lt,{config:this.const({}),latex:this.const("<")})),fr.createElement("span",{class:fr.const("dcg-evaluation")},fr.createElement(lt,{config:this.const({}),latex:()=>this.getLessThan()}))))),fr.createElement("tr",null,fr.createElement("td",null,fr.createElement("div",{class:fr.const("dcg-value"),role:fr.const("textbox"),"aria-readonly":fr.const("true"),tabindex:fr.const("0"),"aria-label":()=>"Greater than: "+this.getGreaterThan()},fr.createElement("span",{class:fr.const("dcg-operator")},fr.createElement(lt,{config:this.const({}),latex:this.const(">")})),fr.createElement("span",{class:fr.const("dcg-evaluation")},fr.createElement(lt,{config:this.const({}),latex:()=>this.getGreaterThan()}))))),fr.createElement("tr",null,fr.createElement("td",null,fr.createElement("div",{class:fr.const("dcg-value"),role:fr.const("textbox"),"aria-readonly":fr.const("true"),tabindex:fr.const("0"),"aria-label":()=>"Not equal: "+this.getNotEqual()},fr.createElement("span",{class:fr.const("dcg-operator")},fr.createElement(lt,{config:this.const({}),latex:this.const("\u2260")})),fr.createElement("span",{class:fr.const("dcg-evaluation")},fr.createElement(lt,{config:this.const({}),latex:()=>this.getNotEqual()})))))))}getLessThan(){var e=Iy(this.model);return e?__dcg_shared_module_exports__['Pc'](e.lessThan,5):""}getGreaterThan(){var e=Iy(this.model);return e?__dcg_shared_module_exports__['Pc'](e.greaterThan,5):""}getNotEqual(){var e=Iy(this.model);return e?__dcg_shared_module_exports__['Pc'](e.notEqual,5):""}};var Dt=__dcg_shared_module_exports__['e'](te());var yS=class extends Dt.Class{template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,Dt.createElement("div",{class:Dt.const("dcg-stats-footer-container dcg-do-blur"),handleEvent:Dt.const("true")},Dt.createElement("table",null,Dt.createElement("tr",null,Dt.createElement("td",null,Dt.createElement("div",{class:Dt.const("dcg-value"),role:Dt.const("textbox"),"aria-readonly":Dt.const("true"),tabindex:Dt.const("0"),"aria-label":()=>"Min: "+this.getMin()},Dt.createElement("span",{class:Dt.const("dcg-row-header")},Dt.const("Min")),Dt.createElement("span",{class:Dt.const("dcg-evaluation")},Dt.createElement(lt,{config:this.const({}),latex:this.bindFn(this.getMin)}))))),Dt.createElement("tr",null,Dt.createElement("td",null,Dt.createElement("div",{class:Dt.const("dcg-value"),role:Dt.const("textbox"),"aria-readonly":Dt.const("true"),tabindex:Dt.const("0"),"aria-label":()=>"Q1: "+this.getQ1()},Dt.createElement("span",{class:Dt.const("dcg-row-header")},Dt.const("Q1")),Dt.createElement("span",{class:Dt.const("dcg-evaluation")},Dt.createElement(lt,{config:this.const({}),latex:this.bindFn(this.getQ1)}))))),Dt.createElement("tr",null,Dt.createElement("td",null,Dt.createElement("div",{class:Dt.const("dcg-value"),role:Dt.const("textbox"),"aria-readonly":Dt.const("true"),tabindex:Dt.const("0"),"aria-label":()=>"Median: "+this.getMedian()},Dt.createElement("span",{class:Dt.const("dcg-row-header")},Dt.const("Median")),Dt.createElement("span",{class:Dt.const("dcg-evaluation")},Dt.createElement(lt,{config:this.const({}),latex:this.bindFn(this.getMedian)}))))),Dt.createElement("tr",null,Dt.createElement("td",null,Dt.createElement("div",{class:Dt.const("dcg-value"),role:Dt.const("textbox"),"aria-readonly":Dt.const("true"),tabindex:Dt.const("0"),"aria-label":()=>"Q3: "+this.getQ3()},Dt.createElement("span",{class:Dt.const("dcg-row-header")},Dt.const("Q3")),Dt.createElement("span",{class:Dt.const("dcg-evaluation")},Dt.createElement(lt,{config:this.const({}),latex:this.bindFn(this.getQ3)}))))),Dt.createElement("tr",null,Dt.createElement("td",null,Dt.createElement("div",{class:Dt.const("dcg-value"),role:Dt.const("textbox"),"aria-readonly":Dt.const("true"),tabindex:Dt.const("0"),"aria-label":()=>"Max: "+this.getMax()},Dt.createElement("span",{class:Dt.const("dcg-row-header")},Dt.const("Max")),Dt.createElement("span",{class:Dt.const("dcg-evaluation")},Dt.createElement(lt,{config:this.const({}),latex:this.bindFn(this.getMax)})))))))}getMin(){let e=Ay(this.model);return e?__dcg_shared_module_exports__['Oc'](e.min):""}getQ1(){let e=Ay(this.model);return e?__dcg_shared_module_exports__['Oc'](e.q1):""}getMedian(){let e=Ay(this.model);return e?__dcg_shared_module_exports__['Oc'](e.median):""}getQ3(){let e=Ay(this.model);return e?__dcg_shared_module_exports__['Oc'](e.q3):""}getMax(){let e=Ay(this.model);return e?__dcg_shared_module_exports__['Oc'](e.max):""}};var wn=__dcg_shared_module_exports__['e'](te());var{If:oue}=wn.Components,ub=class extends wn.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return wn.createElement("div",{class:wn.const("dcg-action-info"),handleEvent:wn.const("true")},wn.createElement("span",{class:wn.const("dcg-action-label")},wn.const("Run ")),wn.createElement(lt,{latex:()=>this.model.clickableInfo.latex,config:this.bindFn(this.getMQConfig)}),wn.createElement("span",{class:wn.const("dcg-action-label")},wn.const(" on click")),wn.createElement(oue,{predicate:()=>!this.controller.isItemReadonly(this.model.id)},()=>wn.createElement("span",{class:wn.const("dcg-click-edit"),role:wn.const("button"),tabindex:wn.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-action"),onTap:this.bindFn(this.editAction)},wn.createElement("i",{class:wn.const("dcg-icon-pencil"),"aria-hidden":wn.const("true")}))))}editAction(){this.model.type==="expression"?this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"expression",model:this.model,guid:this.getMenuGUID(),focusFirstOption:!1}}):this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"image",model:this.model,guid:this.getMenuGUID(),focusFirstOption:!1}}),this.controller.dispatch({type:"set-focus-location",location:{type:"expression-menu",id:this.model.id,location:"updaterule"}})}getMenuGUID(){return this.model.guid}getMQConfig(){return{autoOperatorNames:Wp({additionalOperators:["index"]}),autoCommands:Hp()}}};var ar=__dcg_shared_module_exports__['e'](te());var{If:II}=ar.Components,cd=class extends ar.Class{init(){this.controller=this.props.controller()}template(){return ar.createElement(II,{predicate:this.bindFn(this.shouldShowOptions)},()=>ar.createElement("span",{class:()=>({"dcg-expression-edit-actions":!0,"dcg-limited-height":this.limitedHeight()}),style:()=>({background:this.controller.getBackgroundColor()}),didMount:()=>{this.controller.isInEditListMode()&&Te(this.controller.s("graphing-calculator-narration-edit-list-mode-on"))},didUnmount:()=>{this.controller.isInEditListMode()||Te(this.controller.s("graphing-calculator-narration-edit-list-mode-off"))}},ar.createElement(II,{predicate:()=>!this.controller.hasBackgroundColor()},()=>ar.createElement("span",{class:ar.const("dcg-graphic"),handleEvent:ar.const("true ")})),ar.createElement(II,{predicate:this.bindFn(this.canConvertToTable)},()=>ar.createElement($e,{tooltip:this.bindFn(this.getConvertTooltip),gravity:this.const("s")},ar.createElement("span",{class:ar.const("dcg-action-createtable dcg-exp-action-button"),handleEvent:ar.const("true"),role:ar.const("button"),tabindex:ar.const("0"),"aria-label":()=>Ui(this.model(),"create_table"),onTap:this.bindFn(this.onCreateTable)},ar.createElement("i",{class:ar.const("dcg-icon-table"),"aria-hidden":ar.const("true")})))),ar.createElement(II,{predicate:()=>this.controller.shouldShowAuthorFeatures()},()=>ar.createElement($e,{tooltip:this.bindFn(this.getReadonlyToggleLabel),gravity:this.const("s")},ar.createElement("span",{class:()=>({"dcg-action-lock":!0,"dcg-exp-action-button":!0,"dcg-selected":this.isReadonly()}),handleEvent:ar.const("true"),role:ar.const("button"),tabindex:ar.const("0"),"aria-label":this.bindFn(this.getReadonlyToggleLabel),onTap:this.bindFn(this.onToggleReadonly)},ar.createElement("i",{class:ar.const("dcg-icon-lock"),"aria-hidden":ar.const("true")})))),ar.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-duplicate-expression-tooltip"),gravity:this.const("s")},ar.createElement("span",{class:ar.const("dcg-duplicate-btn dcg-exp-action-button"),handleEvent:ar.const("true"),role:ar.const("button"),tabindex:ar.const("0"),"aria-label":()=>Ui(this.model(),"duplicate"),onTap:this.bindFn(this.onDuplicateWithoutFocus)},ar.createElement("i",{class:ar.const("dcg-icon-duplicate"),"aria-hidden":ar.const("true")}))),ar.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-expression-delete-tooltip"),gravity:this.const("s")},ar.createElement("span",{class:ar.const("dcg-delete-btn dcg-exp-action-button"),handleEvent:ar.const("true"),role:ar.const("button"),tabindex:ar.const("0"),"aria-label":()=>Ui(this.model(),"delete"),onTap:this.bindFn(this.onDelete)},ar.createElement("i",{class:ar.const("dcg-icon-remove"),"aria-hidden":ar.const("true")})))))}shouldShowOptions(){return this.controller.isInEditListMode()&&(this.controller.shouldShowAuthorFeatures()||!this.controller.isItemReadonly(this.props.id()))}model(){return this.controller.getItemModel(this.props.id())}getConvertTooltip(){return this.shouldInsertOnCreateTable()?this.controller.s("graphing-calculator-label-convert-to-table-tooltip"):this.controller.s("graphing-calculator-label-create-table")}canConvertToTable(){let e=this.model();return!!(e&&e.type==="expression"&&e.formula.is_tableable)}limitedHeight(){let e=this.model();return e&&(e.type==="image"||this.isSlider())}isSlider(){let e=this.model();return e&&e.type==="expression"&&e.sliderExists}generateSubscriptedTableColumns(e,t,i){var o={independent:t,dependent:i};if(t==="x")return o;var n=__dcg_shared_module_exports__['Ec'](t);if(n.type!=="Identifier")return o;var a=__dcg_shared_module_exports__['Ec'](i);if(a.type!=="FunctionCall"||a.args.length!==1)return o;var s=a.args[0];if(s.type!=="Identifier"||s._symbol!==t)return o;let l=a.getInputString(),c=s.getInputSpan(),d=l.substr(0,c.start),p=l.substr(c.end);return o.independent="x_{"+e+"}",o.dependent=d+o.independent+p,o}shouldInsertOnCreateTable(){let e=this.model();return!!e&&e.type==="expression"&&Op(e)}onCreateTable(){let e=this.model();if(!(!e||e.type!=="expression")){var t=e.formula;if(t.is_tableable&&t.table_info){var i=t.table_info,o=e.index,n=i.independent_variable,a=i.dependent_column;if(i.by_reference){let y=this.generateSubscriptedTableColumns(this.controller.generateTableXSubscript(),n,a);n=y.independent,a=y.dependent}var s,l=[],c=[];if(i.values)for(s=0;s<i.values.length;s++){var d=i.values[s][0];l.push(isNaN(d)?"":__dcg_shared_module_exports__['Nc'](d));var p=i.values[s][1];c.push(isNaN(p)?"":__dcg_shared_module_exports__['Nc'](p))}else for(s=-2;s<=2;s++)l.push(s+""),c.push("");var g={id:this.controller.generateId(),type:"table",readonly:!i.by_reference&&e.readonly,columns:[{id:this.controller.generateId(),latex:n,color:this.controller.getNextColor(),hidden:!1,values:l,points:!0,lines:!1,dragMode:"NONE",pointStyle:"POINT",lineStyle:"SOLID",colorLatex:"",lineOpacity:"",lineWidth:"",pointOpacity:"",pointSize:"",disableGraphInteractions:!1},{id:this.controller.generateId(),latex:a,color:Ud(e),hidden:!1,values:c,points:!0,lines:this.shouldInsertOnCreateTable()&&!!e.lines,dragMode:"NONE",pointStyle:"POINT",lineStyle:"SOLID",colorLatex:"",lineOpacity:"",lineWidth:"",pointOpacity:"",pointSize:"",disableGraphInteractions:!1}]},h=this.controller;this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:!1,focusExpressionList:!1}),this.shouldInsertOnCreateTable()?this.controller.dispatch({type:"replace-item-at-index",index:o,state:g,focus:!0}):this.controller.dispatch({type:"insert-item-at-index",index:o+1,state:g,folderId:e.folderId,focus:!0});var f=function(){h.dispatch({type:"undo"}),h.dispatch({type:"set-edit-list-mode",isEditListMode:!0,focusExpressionList:!1})};this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-table-created"),undoCallback:f}})}}}onDelete(e){this.controller.dispatch({type:"delete-item-and-animate-out",id:this.props.id(),setFocusAfterDelete:e.device==="keyboard"})}onDuplicateWithoutFocus(){let e=this.model();e&&(e.type==="folder"?this.controller.dispatch({type:"duplicate-folder",id:this.props.id()}):this.controller.dispatch({type:"duplicate-expression",id:this.props.id()}))}isReadonly(){return this.controller.isItemMarkedReadonly(this.props.id())}onToggleReadonly(){let e=this.model();e&&this.controller.dispatch({type:"set-item-readonly",id:this.props.id(),readonly:!e.readonly})}getReadonlyIcon(){return this.isReadonly()?"dcg-icon-lock":"dcg-icon-pencil"}getReadonlyToggleLabel(){return this.isReadonly()?this.controller.s("graphing-calculator-label-unlock-expression-tooltip"):this.controller.s("graphing-calculator-label-lock-expression-tooltip")}};var Dl=__dcg_shared_module_exports__['e'](te());var{If:nue}=Dl.Components,kw=class extends Dl.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return Dl.createElement(nue,{predicate:()=>this.controller.showExpressionZoomFitButton(this.model)},()=>Dl.createElement("div",{class:Dl.const("dcg-suggested-zoom-view dcg-do-blur"),handleEvent:Dl.const(!0)},Dl.createElement($e,{tooltip:this.bindFn(this.getZoomText),gravity:()=>"e"},Dl.createElement("i",{onTap:this.bindFn(this.onZoom),role:Dl.const("button"),tabindex:Dl.const("0"),"aria-label":this.bindFn(this.getZoomText),class:Dl.const("dcg-icon-zoom-fit")}))))}getZoomText(){return this.controller.s("graphing-calculator-text-zoom-fit")}onZoom(e){this.controller.dispatch({type:"expression-zoom-fit",id:this.model.id,focusAfterTap:e.device==="keyboard"})}};var Pt=__dcg_shared_module_exports__['e'](te());var da=__dcg_shared_module_exports__['e'](te());var{If:aue}=da.Components,{Switch:sue}=da.Components,dd=class extends da.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}iconType(){return this.controller.shouldShowReplaceIcon()?"rename":this.controller.isItemMarkedReadonly(this.model.id)?"lock":"delete"}getAriaLabel(){switch(this.iconType()){case"none":case"lock":return;case"rename":return Ui(this.model,"rename");case"delete":return Ui(this.model,"delete")}}onIconTap(){this.iconType()==="delete"?this.controller.dispatch({type:"delete-item-and-animate-out",id:this.model.id,setFocusAfterDelete:!this.controller.isInEditListMode()}):this.iconType()==="rename"&&this.controller.dispatch({type:"rename-identifier-in-item",search:this.controller.getExpressionSearchStr(),replace:this.controller.getExpressionReplaceStr(),id:this.model.id})}isIconTappable(){let e=this.iconType();return e!=="none"&&e!=="lock"}template(){return da.createElement(aue,{predicate:()=>!this.controller.isInEditListMode()},()=>da.createElement("div",{class:()=>({"dcg-top-level-icon":!0,"dcg-tappable":this.isIconTappable()}),tabIndex:()=>this.isIconTappable()?0:-1,"aria-label":this.bindFn(this.getAriaLabel),handleEvent:this.bindFn(this.isIconTappable),onTap:this.bindFn(this.onIconTap),role:da.const("button"),manageFocus:this.const({shouldBeFocused:()=>Tf({controller:this.controller,location:{type:"top-level-icon",id:this.model.id}}),onFocusedChanged:(e,t)=>{var i;e?this.controller.dispatch({type:"set-focus-location",location:{type:"top-level-icon",id:this.model.id}}):t.relatedTarget&&!((i=t.relatedTarget)!=null&&i.closest("[data-dcg-label]"))&&this.controller.dispatch({type:"blur-focus-location",location:{type:"top-level-icon",id:this.model.id}})}})},da.createElement(sue,{key:()=>this.iconType()},e=>{switch(e){case"delete":return da.createElement("i",{class:da.const("dcg-icon-remove dcg-top-level-delete"),"aria-hidden":da.const("true")});case"lock":return da.createElement("i",{class:da.const("dcg-icon-lock dcg-lock-indicator"),"aria-hidden":da.const("true")});case"rename":return da.createElement("i",{class:da.const("dcg-icon-replace"),"aria-hidden":da.const("true")});case"none":return da.createElement("span",null)}})))}};var{If:mu,SwitchUnion:lue}=Pt.Components,hb=class extends Sl{didMount(){this.onItemViewMounted(),this.lastBrailleMode=this.controller.getBrailleMode()}didMountRootNode(e){this.rootNode=e}willUnmount(){this.onItemViewUnmounted()}template(){return Pt.createElement("div",{class:()=>({"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-mathitem":!0,"dcg-inFolder":!!this.model.folderId,"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-selected":this.controller.isItemSelected(this.id)&&!this.controller.isInEditListMode(),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id),"dcg-hasSlider":this.hasSlider(),"dcg-hasEvaluation":this.controller.shouldShowEvaluationForItem(this.id),"dcg-hasRegression":this.hasRegression(),"dcg-hasDomain":this.hasDomain()||this.hasDomain3d()}),"expr-id":()=>this.model.id,didMount:this.bindFn(this.didMountRootNode)},Pt.createElement("div",{class:Pt.const("dcg-fade-container"),onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect)},Pt.createElement("div",{class:Pt.const("dcg-main")},Pt.createElement(mu,{predicate:()=>!this.controller.isInEditListMode()&&!this.isReadonly()},()=>Pt.createElement(_o,{latex:()=>dC(this.model),operatorNames:()=>this.getMQConfig().autoOperatorNames,ariaLabel:()=>this.getAriaLabel("braille"),brailleShouldFocus:()=>this.isFocused(),onBrailleInput:e=>this.handleLatexChanged(e),onBrailleFocusedChanged:(e,t)=>this.handleMQFocusedChanged(e,t),onBrailleKeydown:this.bindFn(this.handleBraillePressedKey),...Bn(this.controller)},Pt.createElement(Ze,{latex:()=>dC(this.model),getAriaLabel:()=>this.getAriaLabel("speech"),getAriaPostLabel:this.bindFn(this.getFormulaAria),isFocused:()=>this.isFocused(),noFadeout:()=>this.controller.isItemMarkedReadonly(this.model.id),tokenController:this.props.controller,capExpressionSize:()=>this.controller.getCapExpressionSize(),config:this.bindFn(this.getMQConfig),hasError:this.const(!1),onUserPressedKey:(e,t)=>this.handlePressedKey(e,t),onUserChangedLatex:e=>this.handleLatexChanged(e),onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:(e,t)=>this.handleMQFocusedChanged(e,t),onSelectionChanged:()=>{this.controller.runAfterDispatch(()=>{this.controller.dispatch({type:"render"})})},needsSystemKeypad:()=>!this.controller.isKeypadEnabled()}))),Pt.createElement(mu,{predicate:()=>this.controller.isInEditListMode()||this.isReadonly()},()=>Pt.createElement("div",{class:Pt.const("dcg-edit-list-mathquill"),tabindex:()=>this.controller.getBrailleMode()==="none"?"0":"-1",onTap:()=>this.controller.isInEditListMode()?this.exitEditListMode():{},onKeydown:this.bindFn(this.handleReadonlyPressedKey),manageFocus:this.const({shouldBeFocused:()=>this.controller.getBrailleMode()!=="none"?!1:Tf({controller:this.controller,location:{type:"readonly-expression",id:this.model.id}}),onFocusedChanged:(e,t)=>{this.controller.getBrailleMode()==="none"&&(e?this.controller.dispatch({type:"set-focus-location",location:{type:"readonly-expression",id:this.model.id}}):this.doesNodeBelongToSliderLimit(t.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"readonly-expression",id:this.model.id}}))}})},Pt.createElement(_o,{latex:()=>dC(this.model),operatorNames:()=>this.getMQConfig().autoOperatorNames,ariaLabel:()=>this.getAriaLabel("braille"),isStatic:this.const(!0),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="readonly-expression"?!1:e.id===this.id},onBrailleFocusedChanged:(e,t)=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"readonly-expression",id:this.model.id}}):this.doesNodeBelongToSliderLimit(t.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"readonly-expression",id:this.model.id}})},...Bn(this.controller)},Pt.createElement(lt,{latex:()=>dC(this.model),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabel("speech"),tokenController:this.props.controller}))))),Pt.createElement(dd,{controller:this.props.controller,model:this.props.model}),Pt.createElement(mu,{predicate:this.bindFn(this.shouldShowFooter)},()=>Pt.createElement("div",{class:this.getFooterClass()},lue(()=>this.getFooterType(),{none:()=>{},regression:()=>Pt.createElement(dS,{model:this.props.model,controller:this.props.controller}),label:()=>Pt.createElement(Af,{model:this.props.model,controller:this.props.controller}),slider:()=>Pt.createElement(uS,{model:this.props.model,controller:this.props.controller}),domain:()=>Pt.createElement(pb,{model:this.props.model,controller:this.props.controller,domainIndex:()=>0}),domain3d:()=>Pt.createElement("div",null,Pt.createElement(mu,{predicate:()=>!t8(this.model)},()=>Pt.createElement(pb,{model:this.props.model,controller:this.props.controller,domainIndex:()=>0})),Pt.createElement(mu,{predicate:()=>!r8(this.model)},()=>Pt.createElement(pb,{model:this.props.model,controller:this.props.controller,domainIndex:()=>1}))),evaluation:()=>Pt.createElement(db,{id:()=>this.props.model().id,dependent:()=>sa(this.model)||"",val:()=>this.controller.getEvaluationValueForItem(this.id),controller:this.props.controller,focusable:this.const(!0)}),distribution:()=>Pt.createElement(mS,{model:this.props.model,controller:this.props.controller}),visualization:()=>Pt.createElement(fS,{model:this.props.model,controller:this.props.controller}),ttest:()=>Pt.createElement(bS,{model:this.props.model,controller:this.props.controller}),stats:()=>Pt.createElement(yS,{model:this.props.model,controller:this.props.controller}),warning:()=>Pt.createElement(cS,{controller:this.props.controller,type:this.bindFn(this.getFooterWarningType)})}),Pt.createElement(mu,{predicate:this.bindFn(this.shouldShowBrailleError)},()=>Pt.createElement("div",{tabindex:Pt.const(0),class:Pt.const("dcg-expression-braille-error"),role:Pt.const("button"),"aria-roledescription":Pt.const("error"),"aria-label":()=>this.controller.unpack(this.model.error)},Pt.createElement("i",{class:Pt.const("dcg-icon-error"),"aria-hidden":Pt.const("true")}),()=>this.controller.unpack(this.model.error))),Pt.createElement(mu,{predicate:this.bindFn(this.shouldShowSliderPrompt)},()=>Pt.createElement(op,{model:this.props.model,controller:this.props.controller})),Pt.createElement(mu,{predicate:this.bindFn(this.shouldShowRenamePrompt)},()=>Pt.createElement(hS,{from:this.bindFn(this.getRenameIdentifierFrom),to:this.bindFn(this.getRenameIdentifierTo),count:this.bindFn(this.getRenameCountOfChanges),inFolder:()=>this.getRenameIdentifierFolderId()!==void 0,handleRename:this.bindFn(this.handleRename)})))),Pt.createElement(mu,{predicate:this.bindFn(this.shouldShowActionInfo)},()=>Pt.createElement("div",{class:this.getFooterClass()},Pt.createElement(ub,{model:this.props.model,controller:this.props.controller}))),Pt.createElement(mu,{predicate:this.bindFn(this.shouldShowExtendTo3D)},()=>Pt.createElement("div",{class:this.getFooterClass("dcg-extend-to-3d"),handleEvent:Pt.const("true")},Pt.createElement(xt,{onChange:e=>{this.controller.dispatch({type:"set-item-extend-to-3D",id:this.model.id,extendTo3D:e})},checked:()=>this.model.extendTo3D,class:this.const("dcg-expression-footer-checkbox")},()=>this.controller.s("graphing-calculator-label-extend-to-3d"))))),Pt.createElement("span",{class:Pt.const("dcg-tab dcg-action-drag dcg-action-icon-touch"),handleevent:Pt.const("true"),tapboundary:Pt.const("true"),disablescroll:Pt.const("true"),onTapStart:this.bindFn(this.onDragPending)},Pt.createElement("span",{class:Pt.const("dcg-num")},()=>this.model.displayIndex),Pt.createElement("div",{class:Pt.const("dcg-tab-interior dcg-action-icon-mouse")},Pt.createElement(lS,{model:this.props.model,controller:this.props.controller})),Pt.createElement(kw,{model:this.props.model,controller:this.props.controller})),Pt.createElement(cd,{controller:this.props.controller,id:()=>this.model.id}))}shouldShowExtendTo3D(){return this.controller.isThreeDMode()?Jk(this.model):!1}getRenameIdentifierFrom(){let e=this.controller.getSuggestedIdentifierRenameInfo(this.id);return e&&e.from||""}getRenameIdentifierTo(){let e=this.controller.getSuggestedIdentifierRenameInfo(this.id);return e&&e.to||""}getRenameCountOfChanges(){let e=this.controller.getSuggestedIdentifierRenameInfo(this.id);return e&&e.countOfChanges||0}getRenameIdentifierFolderId(){let e=this.controller.getSuggestedIdentifierRenameInfo(this.id);return e==null?void 0:e.folderId}handleRename(){let e={search:this.getRenameIdentifierFrom(),replace:this.getRenameIdentifierTo()},t=this.getRenameIdentifierFolderId();t===void 0?this.controller.dispatch({type:"rename-identifier-global",...e}):this.controller.dispatch({type:"rename-identifier-in-item",id:t,...e})}didUpdate(){this.lastBrailleMode=this.controller.getBrailleMode()}shouldShowFooter(){return this.shouldShowBrailleError()||this.shouldShowSliderPrompt()||this.shouldShowRenamePrompt()?!0:this.getFooterType()!=="none"}getFooterType(){return this.hasRegression()?"regression":this.shouldShowLabelView()?"label":this.hasSlider()?"slider":this.hasDomain()?"domain":this.hasDomain3d()?"domain3d":this.isTTest()?"ttest":this.isStats()?"stats":this.controller.shouldShowEvaluationForItem(this.id)?"evaluation":this.model.unresolved?"warning":this.isToplevelDistribution()?"distribution":this.isVisualization()?"visualization":S_(this.model)||this.model.recursiveDepthPlottingError?"warning":"none"}getFooterWarningType(){if(this.model.unresolved)return"unresolved";if(S_(this.model))return"tone-out-of-range";if(this.model.recursiveDepthPlottingError)return"recursive-depth-plotting-error"}getFooterClass(e){return this.const({"dcg-expression-bottom":!0,"dcg-indent-in-folder":!0,"dcg-fadein-bottom":!this.isFirstRender(),[e||""]:!!e})}onCreateSliders(e){this.controller.dispatch({type:"create-sliders-for-item",id:this.id,variables:e})}shouldShowLabelView(){return pr("labels")&&s8(this.model)&&!this.controller.isThreeDMode()}shouldShowSliderPrompt(){return this.controller.areSlidersEnabled()?Vk(this.model).length>0:!1}shouldShowRenamePrompt(){return this.getRenameCountOfChanges()>0}shouldShowActionInfo(){return!!(this.controller.areActionsEnabled()&&this.model.clickableInfo&&this.model.clickableInfo.enabled&&this.model.clickableInfo.latex)}shouldShowBrailleError(){return this.controller.getBrailleMode()!=="none"&&this.hasError()}hasRegression(){return!!(this.model.formula&&this.model.formula.is_regression)}hasDomain(){return $k(this.model)}hasDomain3d(){return jk(this.model)}isToplevelDistribution(){return Sg(this.model)}isVisualization(){return Zk(this.model)}isTTest(){return eG(this.model)}isStats(){return l8(this.model)}hasSlider(){return!!this.model.sliderExists}getLabelOptions(){return this.controller.getEvaluationLabelOptionsForItem(this.model.id)}getAriaLabel(e){if(this.shouldShowLabelView()){var t;this.model.label&&this.model.label!==""?t=this.model.label:e==="speech"?t=this.controller.s("graphing-calculator-narration-expression-label"):t=this.controller.raw("lbl");var i;return Fd(this.model)?i=t:e==="speech"?i=this.controller.s("graphing-calculator-narration-expression-hidden-label",{label:t}):i=this.controller.raw("h __label__",{label:t}),i}return e==="speech"?this.controller.s("shared-calculator-narration-expression-index",{index:this.model.displayIndex}):this.controller.raw("eq__index__",{index:this.model.displayIndex})}getFormulaAria(){let e=this.model.formula,t="";if(!e||Hl(this.model))return t;if(this.controller.shouldShowEvaluationForItem(this.id)){t="equals ";let i=e.zero_values&&e.zero_values.length?e.zero_values[0].val:e.constant_value;Array.isArray(i)?t+=i.length+" element list.":i!==void 0&&(t+=Ua(__dcg_shared_module_exports__['tb'](+i,this.getLabelOptions())))}else e.error&&!this.shouldShowSliderPrompt()?t=this.controller.unpack(e.error):Sg(this.model)?t=this.controller.s("graphing-calculator-narration-expression-evaluation-is-distribution"):this.isTTest()&&(t=this.controller.s("graphing-calculator-narration-expression-evaluation-is-t-test"));if(this.model.shouldGraph&&(e.is_graphable||e.is_regression)){e.is_graphable&&e.is_regression?t+=" "+this.controller.s("graphing-calculator-narration-expression-evaluation-has-graph-and-regression"):e.is_regression?t+=" "+this.controller.s("graphing-calculator-narration-expression-evaluation-has-regression"):t+=" "+this.controller.s("graphing-calculator-narration-expression-evaluation-has-graph");let i=this.controller.getAudioGraph();i&&i.agNavigator.canTrace(this.model)&&(Ti?t+=" "+this.controller.s("graphing-calculator-narration-expression-audio-trace-mac"):t+=" "+this.controller.s("graphing-calculator-narration-expression-audio-trace-windows"))}return this.controller.toneEnabled()&&Wl(this.model)&&(this.model.hidden?t+=" "+this.controller.s("graphing-calculator-narration-expression-tone-muted"):t+=" "+this.controller.s("graphing-calculator-narration-expression-tone-unmuted")),t}handleBraillePressedKey(e){let t=Be(e);if(t){if(t==="Esc")pi(),this.hasSlider()&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.model.id}});else if(t==="Up"||t==="Down"||t==="Enter")this.controller.dispatch({type:"on-special-key-pressed",key:t});else if(t==="Del"||t==="Backspace"){let i=vl();Hl(this.model)&&Zx(i)&&(this.controller.dispatch({type:"on-special-key-pressed",key:t==="Del"?"Delete":t}),e.preventDefault(),e.stopPropagation())}}}handleReadonlyPressedKey(e){if(this.controller.isInEditListMode())return;let t=Be(e);!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&(t==="Esc"?(e.preventDefault(),e.stopPropagation(),pi(),this.hasSlider()&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.model.id}})):(t==="Up"||t==="Down"||t==="Enter")&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"on-special-key-pressed",key:t})))}handlePressedKey(e,t){var n;var i=Ze.getFocusedMathquill();if(i){if(t&&this.controller.isGraphPaperFocused()){let a=(n=this.controller.getGrapher2d())==null?void 0:n.poiController;if(!a)return;let s=a.keyboardAttentionManager;if(e==="Tab"||e==="Shift-Tab"){t.stopPropagation(),t.preventDefault(),s.focusNextObjFromKeyboard({direction:t.shiftKey?"prev":"next"});return}else if(e==="Left"||e==="Right"||e==="Up"||e==="Down"||e==="Shift-Left"||e==="Shift-Right"||e==="Shift-Up"||e==="Shift-Down"){t.stopPropagation(),t.preventDefault(),t&&a.moveGeoPointFromKeyboard(t);return}else if(e==="Enter"){t.stopPropagation(),t.preventDefault();let l=s.getKeyboardAttention();a.tapGeoPointFromKeyboard(t),this.controller.getEvaluator().notifyWhenSynced(()=>{let c=this.controller.getValidCursorContext(),d=this.model.formula.cursor_context;if(c&&c===d){let p=this.controller.getFocusLocation();if(p&&p.type==="expression"&&p.id===this.model.id&&!p.isFakeGraphFocus&&this.controller.dispatch({type:"set-focus-location",location:{...p,isFakeGraphFocus:!0}}),l){let g=s.findTabbableObjectsForCurrentTool(l);g.currentIsTabbable&&s.updateKeyboardAttention(g.targets[g.currentTabIndex],{describe:!1})}}});return}else if(e==="Esc"){t.stopPropagation(),t.preventDefault(),this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.model.id}});return}}if(e==="Esc"){pi(),this.hasSlider()&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.model.id}});return}else if(e==="Up"||e==="Down"){var o=Ze.applyArrowKeyAndReturnIfWasAtBounds(i,e,t);return o?this.controller.dispatch({type:"on-special-key-pressed",key:e}):void 0}else if(e==="Delete"||e==="Backspace"){if(Hl(this.model))return this.controller.dispatch({type:"on-special-key-pressed",key:e})}else if(e==="Enter")return t&&(t.preventDefault(),t.stopPropagation()),this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"});i.keystroke(e,t),this.handleLatexChanged(i.latex())}}handleLatexChanged(e){e!==this.model.latex&&this.controller.dispatch({type:"set-item-latex",id:this.id,latex:e})}doesNodeBelongToSliderLimit(e){return!e||!this.rootNode.contains(e)?!1:!!e.closest("[data-dcg-label]")}handleMQFocusedChanged(e,t){e?this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}}):!this.doesNodeBelongToSliderLimit(t.relatedTarget)&&this.lastBrailleMode===this.controller.getBrailleMode()&&this.controller.dispatch({type:"blur-focus-location",location:{type:"expression",id:this.id}})}onMouseSelect(e){this.isReadonly()||e.device!=="keyboard"&&(e.type==="dcg-tap"&&e.device==="mouse"||e.type==="dcg-tapstart"&&e.device==="touch"||e.wasHandled()||(e.handle(),this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}})))}isReadonly(){return this.controller.isItemReadonly(this.id)}isFocused(){let e=this.controller.getFocusLocation();return!e||e.type!=="expression"?!1:e.id===this.id}isSliderThumbFocused(){let e=this.controller.getFocusLocation();return!e||e.type!=="slider-thumb"?!1:e.id===this.id}hasError(){return!!this.model.error&&!Hl(this.model)}getMQConfig(){return this.controller.getMathquillConfig({})}};function Bn(r){return{sixKeyInput:()=>r.getSixKeyInput(),mode:()=>r.getBrailleMode(),capExpressionSize:()=>r.getCapExpressionSize()?{exceedsLimit:e=>e.length>Dx,onExpressionSizeExceeded:()=>r.dispatch({type:"expression-size-exceeded"})}:void 0}}var np=__dcg_shared_module_exports__['e'](te());qt();var{Textarea:cue}=np.Components,Lh=class extends np.Class{template(){return np.createElement("div",{class:np.const("dcg-smart-textarea-container")},np.createElement("div",{class:np.const("dcg-displayTextarea dcg-fixed-width-element"),didMount:this.bindFn(this.didMountDisplay)}),np.createElement(cue,{class:()=>({"dcg-do-blur":!0,"dcg-fixed-width-element":!0,"dcg-smart-textarea":!0,"dcg-empty":!this.props.text()}),"aria-label":()=>{var e,t;return(t=(e=this.props).ariaLabel)==null?void 0:t.call(e)},placeholder:this.bindFn(this.getPlaceholder),readonly:()=>this.props.readonly()?!0:void 0,value:this.props.text,onInput:this.props.onInput,didMount:this.bindFn(this.didMountTextarea),onKeydown:this.bindFn(this.onKeydownEvent)}))}getDisplayTextHTML(){let e=this.props.text()||"",t=(n,a)=>e.slice(n,a).replace(/</g,"&lt;").replace(/>/g,"&gt;"),i=0,o="";if(this.props.showLinks()){let n=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,a=null;for(;(a=n.exec(e))!==null;){let[s]=a;o+=t(i,a.index),o+=`<a rel='nofollow ugc' href='${s}' target ='_blank'>${s}</a>`,i=n.lastIndex}}return o+=t(i),o}willUnmount(){this.textareaNode=void 0}didMountDisplay(e){this.displayNode=e,ie(e).on("touchend",function(t){t.preventDefault()}),ie(e).on("dcg-tap dcg-tapstart",function(t){t.target.closest("a")&&t.handle()}),this.renderDisplayText()}didMountTextarea(e){this.textareaNode=e,ie(e).on("dcg-tapstart",t=>{t.handle()}),ie(e).on("focusin focusout",()=>this.onFocusEvent()),this.updateFocused()}didUpdate(){this.updateFocused(),this.renderDisplayText()}onFocusEvent(){if(this.textareaNode){var e=document.activeElement===this.textareaNode;this.shouldBeFocused()!==e&&this.props.onFocusChange(e)}}renderDisplayText(){if(!this.displayNode)return;let e=this.getDisplayTextHTML();this.lastDisplayTextHTML!==e&&(this.lastDisplayTextHTML=e,this.displayNode.innerHTML=e)}isFocused(){return document.activeElement===this.textareaNode}shouldBeFocused(){return this.props.shouldFocus()}updateFocused(){if(!this.textareaNode)return;let e=this.isFocused(),t=this.shouldBeFocused();if(e!==t)if(!t)this.textareaNode.blur();else{if(ll&&Qu)return;this.textareaNode.focus(),this.textareaNode.selectionStart=this.textareaNode.selectionEnd=this.textareaNode.value.length}}onKeydownEvent(e){var t=this.textareaNode;if(!t)return;var i=Be(e);let o=this.props.readonly(),n=this.props.readonlyAction&&this.props.readonlyAction();if(o&&n!==void 0&&n.predicate()){!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&(i===dl||i===lg)&&(e.preventDefault(),n.action());return}i===dl&&!e.metaKey?(e.preventDefault(),this.props.onSpecialKey("Enter")):i===rn?pi():i===un?(o||t.selectionStart===0&&t.selectionEnd===0)&&!(e.altKey||e.metaKey)&&(e.preventDefault(),this.props.onSpecialKey("Up")):i===hn?(o||t.selectionStart===t.value.length&&t.selectionEnd===t.value.length)&&!(e.altKey||e.metaKey)&&(e.preventDefault(),this.props.onSpecialKey("Down")):i===Nc&&!(o&&n!==void 0&&n.predicate())?t.value.length===0&&(e.preventDefault(),this.props.onSpecialKey("Backspace")):i===cy&&!(o&&n!==void 0&&n.predicate())&&t.value.length===0&&(e.preventDefault(),this.props.onSpecialKey("Delete")),this.props.onKeydown&&this.props.onKeydown(e)}getPlaceholder(){var e,t;if(!this.props.text())return(t=(e=this.props).placeholder)==null?void 0:t.call(e)}};var Jn=__dcg_shared_module_exports__['e'](te());var xS=class extends Sl{didMount(){this.onItemViewMounted()}willUnmount(){this.onItemViewUnmounted()}template(){return Jn.createElement("div",{class:()=>({"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-expressiontext":!0,"dcg-inFolder":!!this.model.folderId,"dcg-selected":!!this.controller.isItemSelected(this.id),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id)}),"expr-id":()=>this.model.id,onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect)},Jn.createElement("div",{class:Jn.const("dcg-fade-container")},Jn.createElement("div",{class:Jn.const("dcg-main")},Jn.createElement(Lh,{shouldFocus:this.bindFn(this.isFocused),text:()=>this.model.text,showLinks:()=>this.controller.areLinksEnabled(),onInput:this.bindFn(this.onInput),onFocusChange:this.bindFn(this.onFocusChange),onSpecialKey:this.bindFn(this.onSpecialKey),readonly:()=>this.controller.isInEditListMode()||this.controller.isItemReadonly(this.id),readonlyAction:this.const({predicate:()=>this.controller.isInEditListMode(),action:()=>this.exitEditListMode()}),ariaLabel:()=>Ui(this.model,"edit_title"),placeholder:()=>this.controller.s("graphing-calculator-text-note-placeholder")})),Jn.createElement(dd,{controller:this.props.controller,model:this.props.model})),Jn.createElement("span",{class:Jn.const("dcg-tab dcg-action-drag"),handleevent:Jn.const("true"),tapboundary:Jn.const("true"),disablescroll:Jn.const("true"),onTapStart:this.bindFn(this.onDragPending)},Jn.createElement("span",{class:Jn.const("dcg-num")},()=>this.model.displayIndex),Jn.createElement("div",{class:Jn.const("dcg-tab-interior")}),Jn.createElement("i",{class:Jn.const("dcg-icon-text"),"aria-hidden":Jn.const("true")})),Jn.createElement(cd,{controller:this.props.controller,id:()=>this.model.id}))}onInput(e){this.controller.dispatch({type:"set-note-text",id:this.id,text:e})}onFocusChange(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"text",id:this.id}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"text",id:this.id}})}onSpecialKey(e){return this.controller.dispatch({type:"on-special-key-pressed",key:e})}isFocused(){let e=this.controller.getFocusLocation();return!(!e||e.type!=="text"||e.id!==this.id)}};var ir=__dcg_shared_module_exports__['e'](te());qt();var Li=__dcg_shared_module_exports__['e'](te());var Ja=__dcg_shared_module_exports__['e'](te());var{SwitchUnion:due,If:pue}=Ja.Components,wS=class extends Ja.Class{init(){this.model=this.props.model(),this.controller=this.props.controller()}template(){return Ja.createElement("div",{class:Ja.const("dcg-table-icon-container")},due(this.bindFn(this.typeOfIcon),{error:()=>Ja.createElement($a,{error:()=>this.controller.unpack(this.model.error),gravity:this.const("s")}),none:()=>Ja.createElement("span",null),icon:()=>Ja.createElement("div",{class:Ja.const("dcg-circular-icon-container"),role:Ja.const("button"),tabindex:Ja.const("0"),"aria-label":this.bindFn(this.getIconAriaLabel),handleevent:Ja.const("true"),"dcg-open-menu-guid":()=>this.getMenuGUID(),onTap:e=>{if(!e.wasHandled("dragdrop")&&!e.wasLongheld()){if(this.myOptionsOpen())return this.toggleOptions();if(this.controller.isInEditListMode()||e.shiftKey)return this.toggleOptions();this.toggleGraphShown()}},onLongHold:e=>{e.handle("dcg-longhold"),e.handle("dcg-tap"),this.toggleOptions()},manageFocus:this.const(ft({controller:this.controller,location:{type:"table-icon",id:this.model.table.id,columnId:this.model.id}}))},Ja.createElement(yn,{iconType:this.bindFn(this.getIcon),backgroundColor:this.bindFn(this.getModelColor)}),Ja.createElement(pue,{predicate:()=>this.model.disableGraphInteractions},()=>Ja.createElement("i",{class:Ja.const("dcg-graph-interaction-disabled dcg-icon-lock")})))}))}getModelColor(){return MC(this.model)}getMenuGUID(){return this.model.guid}myOptionsOpen(){return this.controller.isItemSettingsMenuOpen(this.getMenuGUID())}toggleOptions(){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"table-column",model:this.model,guid:this.getMenuGUID(),focusFirstOption:!1}})}toggleGraphShown(){this.controller.dispatch({type:"toggle-tablecolumn-hidden",tableId:this.model.table.id,columnId:this.model.id})}hasError(){return!!this.model.error}getIcon(){return this.model.shouldGraph?this.controller.isInEditListMode()?"none":this.model.points&&this.model.lines?"table-points-and-lines":this.model.points&&!this.model.lines?"table-points":!this.model.points&&this.model.lines?"table-lines":"none":"hidden"}typeOfIcon(){return this.model.latex===""||!this.controller.getGraphSettings().config.graphpaper?"none":this.model.error?"error":this.model.index===0?"none":"icon"}getIconAriaLabel(){return this.myOptionsOpen()?this.controller.s("graphing-calculator-narration-hide-options"):this.controller.isInEditListMode()?this.controller.s("graphing-calculator-narration-show-options"):this.model.shouldGraph?this.controller.s("graphing-calculator-narration-hide-table-column"):this.controller.s("graphing-calculator-narration-show-table-column")}};var{If:vS}=Li.Components,CS=class extends Li.Class{init(){this.model=this.props.model(),this.controller=this.props.controller(),this.table=this.model.table}isRightSide(){return this.lookupCellPosition().column>=this.table.columnModels.length-1}template(){return Li.createElement("div",{class:()=>({"dcg-cell":!0,"dcg-table-header":!0,"dcg-do-not-blur":!0,"dcg-left":this.model.index===0,"dcg-right":this.isRightSide(),"dcg-selected":this.shouldFocus()&&!this.table.readonly,"dcg-error":!!this.model.error,"dcg-leave-space-for-icon":this.leaveSpaceForIcon(),"dcg-leave-space-for-drag-icon":this.hasDragIcon()}),index:()=>this.model.index,onTapStart:this.bindFn(this.focusThisCell)},Li.createElement("div",{class:Li.const("dcg-inner-border")}),Li.createElement(vS,{predicate:()=>!this.isRightSide()&&(!this.controller.is3dProduct()||!!this.model.error)},()=>Li.createElement(wS,{model:this.props.model,controller:this.props.controller})),Li.createElement("div",{role:Li.const("columnheader")},Li.createElement(vS,{predicate:()=>!this.controller.isInEditListMode()&&!this.controller.isItemReadonly(this.table.id)},()=>Li.createElement(_o,{latex:()=>this.model.latex||"",operatorNames:()=>this.getMQConfig().autoOperatorNames,brailleShouldFocus:this.bindFn(this.shouldFocus),ariaLabel:()=>this.getAriaLabel("braille"),onBrailleInput:e=>this.handleLatexChanged(e),onBrailleFocusedChanged:this.bindFn(this.handleMQFocusedChanged),selectOnFocus:this.const(!0),onBrailleKeydown:this.bindFn(this.handleKeydownOnBrailleInput),...Bn(this.props.controller())},Li.createElement(Ze,{latex:()=>this.model.latex||"",isFocused:this.bindFn(this.shouldFocus),capExpressionSize:()=>this.controller.getCapExpressionSize(),noFadeout:this.const(!0),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabel("speech"),getAriaPostLabel:this.bindFn(this.getAriaPostLabel),hasError:this.const(!1),onUserPressedKey:(e,t)=>this.handlePressedKey(e,t),onUserChangedLatex:e=>this.handleLatexChanged(e),onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:this.bindFn(this.handleMQFocusedChanged),selectOnFocus:this.const(!0),needsSystemKeypad:()=>!this.controller.isKeypadEnabled()}))),Li.createElement(vS,{predicate:()=>this.controller.isInEditListMode()||this.controller.isItemReadonly(this.table.id)},()=>Li.createElement(_o,{latex:()=>this.model.latex||"",operatorNames:()=>this.getMQConfig().autoOperatorNames,ariaLabel:()=>this.getAriaLabel("braille"),onBrailleInput:e=>this.handleLatexChanged(e),tabindex:this.const(-1),isStatic:this.const(!0),brailleShouldFocus:this.bindFn(this.shouldFocusReadonlyCell),onBrailleFocusedChanged:this.bindFn(this.handleMQFocusedChanged),...Bn(this.props.controller())},Li.createElement(lt,{latex:()=>this.model.latex||"",config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabel("speech")},Li.createElement("span",{class:Li.const("dcg-math-field dcg-cell-math-content"),role:Li.const("textbox"),"aria-readonly":Li.const("true"),tabindex:()=>this.controller.isInEditListMode()?-1:0,onKeyDown:this.bindFn(this.handleKeydownOnReadonlyCell),manageFocus:this.const({shouldBeFocused:this.bindFn(this.shouldFocusReadonlyCell),onFocusedChanged:this.bindFn(this.handleFocusedChanged)})})))),Li.createElement(vS,{predicate:this.bindFn(this.hasDragIcon)},()=>Li.createElement("span",{class:Li.const("dcg-drag-icon"),"dcg-drag-mode":()=>this.model.dragMode,style:()=>({color:this.model.color})},Li.createElement("i",{class:()=>({"dcg-icon-move":this.model.dragMode==="XY","dcg-icon-move-horizontal":this.model.dragMode==="X","dcg-icon-move-vertical":this.model.dragMode==="Y"}),"aria-hidden":Li.const("true")})))),Li.createElement("div",{class:Li.const("dcg-empty-line")}),Li.createElement(vS,{predicate:()=>this.isRightSide()},()=>Li.createElement("span",{class:Li.const("dcg-fade-right")})))}hasDragIcon(){return this.model.dragMode!=="NONE"&&!this.model.error}leaveSpaceForIcon(){if(this.model.error||this.controller.is3dProduct())return!1;let{column:e}=this.lookupCellPosition(),t=hx(this.table);return e>0&&e<t-1}focusThisCell(e){e.wasHandled()||(e.handle(),!this.controller.isItemReadonly(this.table.id)&&(this.shouldFocus()||this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}})))}handleFocusedChanged(e,t){e?this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}}):this.isNodeWithinTableCell(t.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}})}lookupCellPosition(){return{row:0,column:this.model.index}}getAriaLabel(e){var t=this.lookupCellPosition();return e==="speech"?this.controller.s("graphing-calculator-narration-table-column-header",{column:t.column+1}):this.controller.raw("h__column__",{column:t.column+1})}getAriaPostLabel(){let e="",t=this.model;return t.shouldGraph&&(t.points||t.lines)&&!Bq(t)&&(e=this.controller.s("graphing-calculator-narration-expression-evaluation-has-graph"),Ti?e+=" "+this.controller.s("graphing-calculator-narration-expression-audio-trace-mac"):e+=" "+this.controller.s("graphing-calculator-narration-expression-audio-trace-windows")),e}handlePressedKey(e,t){var i=Ze.getFocusedMathquill();i&&(Ze.handleKeystrokeAndDecideIfSpecialEvent(i,e,t)?this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:e}):this.handleLatexChanged(i.latex()))}handleKeydownOnBrailleInput(e){let t=Be(e);if(!t)return;let i=t==="Enter"||t==="Up"||t==="Down",o=vl(),n=o&&t==="Left"&&o.selectionStart===0||t==="Right"&&o.selectionStart===o.value.length,a=this.model.latex.length===0&&Zx(o);(i||n||(t==="Del"||t==="Backspace")&&a)&&(this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:t==="Del"?"Delete":t}),e.preventDefault())}handleKeydownOnReadonlyCell(e){let t=Be(e);t!=="Tab"&&(e.preventDefault(),t==="Esc"&&pi(),t&&this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:t}))}handleLatexChanged(e){var t=this.model.latex;t!==e&&this.controller.dispatch({type:"set-tablecell-latex",tableId:this.table.id,cell:this.lookupCellPosition(),latex:e})}shouldFocus(){return!this.controller.isInEditListMode()&&__dcg_shared_module_exports__['E'](this.lookupCellPosition(),ds(this.table))}shouldFocusReadonlyCell(){return __dcg_shared_module_exports__['E'](this.lookupCellPosition(),ds(this.table))}isNodeWithinTableCell(e){if(!e||!e.closest(".dcg-cell"))return!1;var t=this.controller.getItemRootNodeById(this.table.id);return t?ie.contains(t,e):!1}handleMQFocusedChanged(e,t){e?this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}}):this.isNodeWithinTableCell(t.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}})}getMQConfig(){return this.controller.getMathquillConfig({})}};var Ro=__dcg_shared_module_exports__['e'](te());qt();var{If:ZF}=Ro.Components,ES=class extends Ro.Class{init(){this.column=this.props.column(),this.controller=this.props.controller(),this.table=this.column.table}template(){return Ro.createElement("div",{class:()=>({"dcg-cell":!0,"dcg-do-not-blur":!0,"dcg-empty":this.isEmpty(),"dcg-non-editable":!!this.column.disabled,"dcg-error":!!this.hasError(),"dcg-selected":this.shouldFocus()&&!this.controller.isItemReadonly(this.table.id)}),onTapStart:this.bindFn(this.focusThisCell)},Ro.createElement("div",{class:Ro.const("dcg-inner-border")}),Ro.createElement("div",{role:Ro.const("gridcell")},Ro.createElement(ZF,{predicate:this.bindFn(this.hasError)},()=>Ro.createElement("span",{class:Ro.const("dcg-table-icon-error-container")},Ro.createElement($a,{error:this.bindFn(this.getErrorMessage),gravity:this.const("s"),size:this.const("small")}))),Ro.createElement(ZF,{predicate:()=>!this.isColumnEditable()},()=>Ro.createElement(_o,{latex:()=>this.getValue(),operatorNames:()=>this.getMQConfig().autoOperatorNames,brailleShouldFocus:this.bindFn(this.shouldFocusReadonlyCell),ariaLabel:()=>this.getAriaLabel("braille"),tabindex:()=>this.controller.isInEditListMode()?-1:0,isStatic:this.const(!0),onBrailleFocusedChanged:this.bindFn(this.handleFocusedChanged),onBrailleKeydown:e=>(this.handleKeydownOnReadonlyCell(e),!0),...Bn(this.props.controller())},Ro.createElement(lt,{getAriaLabel:()=>this.getAriaLabel("speech"),latex:()=>this.getValue(),config:this.bindFn(this.getMQConfig)},Ro.createElement("span",{class:Ro.const("dcg-math-field dcg-cell-math-content dcg-mathquill-input-span"),role:Ro.const("textbox"),"aria-roledescription":()=>this.column.disabled?this.controller.s("graphing-calculator-narration-computed-cell-role-description"):void 0,"aria-readonly":Ro.const("true"),tabindex:()=>!this.controller.isInEditListMode()&&(!this.isEmpty()||!this.column.disabled)?0:-1,onKeyDown:this.bindFn(this.handleKeydownOnReadonlyCell),manageFocus:this.const({shouldBeFocused:this.bindFn(this.shouldFocusReadonlyCell),onFocusedChanged:this.bindFn(this.handleFocusedChanged)})})))),Ro.createElement(ZF,{predicate:this.bindFn(this.isColumnEditable)},()=>Ro.createElement(_o,{latex:()=>this.getValue(),operatorNames:()=>this.getMQConfig().autoOperatorNames,brailleShouldFocus:this.bindFn(this.shouldFocusEditableCell),ariaLabel:()=>this.getAriaLabel("braille"),onBrailleInput:e=>this.handleLatexChanged(e),onBrailleFocusedChanged:this.bindFn(this.handleFocusedChanged),onBrailleKeydown:this.bindFn(this.handleKeydownOnBrailleInput),selectOnFocus:this.const(!0),...Bn(this.props.controller())},Ro.createElement(Ze,{latex:()=>this.getValue(),isFocused:this.bindFn(this.shouldFocusEditableCell),capExpressionSize:()=>this.controller.getCapExpressionSize(),noFadeout:this.const(!0),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabel("speech"),getAriaPostLabel:this.bindFn(this.getErrorMessage),hasError:this.const(!1),onUserPressedKey:(e,t)=>this.handlePressedKey(e,t),onUserChangedLatex:e=>this.handleLatexChanged(e),onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:this.bindFn(this.handleFocusedChanged),selectOnFocus:this.const(!0),needsSystemKeypad:()=>!this.controller.isKeypadEnabled()})))),Ro.createElement("div",{class:Ro.const("dcg-empty-line")}))}focusThisCell(e){e.wasHandled()||this.controller.isItemReadonly(this.table.id)||(e.handle(),!this.shouldFocus()&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}}))}handlePressedKey(e,t){var i=Ze.getFocusedMathquill();if(i){let o=Ze.handleKeystrokeAndDecideIfSpecialEvent(i,e,t);e===rn&&pi(),o?this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:e}):this.handleLatexChanged(i.latex())}}handleKeydownOnBrailleInput(e){let t=Be(e);if(!t)return;t===rn&&pi();let i=t==="Enter"||t==="Up"||t==="Down",o=vl(),n=o&&t==="Left"&&o.selectionStart===0||t==="Right"&&o.selectionStart===o.value.length;(i||n||(t==="Del"||t==="Backspace")&&this.getValue().length===0)&&(this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:t==="Del"?"Delete":t}),e.preventDefault())}handleKeydownOnReadonlyCell(e){let t=Be(e);t!=="Tab"&&(e.preventDefault(),t==="Esc"&&pi(),t&&this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:t}))}handleLatexChanged(e){var t=this.getValue();t!==e&&this.controller.dispatch({type:"set-tablecell-latex",tableId:this.table.id,cell:this.lookupCellPosition(),latex:e})}shouldFocus(){return __dcg_shared_module_exports__['E'](this.lookupCellPosition(),ds(this.table))}shouldFocusReadonlyCell(){return!this.controller.isInEditListMode()&&(this.controller.isItemReadonly(this.table.id)||!!this.column.disabled)&&this.shouldFocus()}shouldFocusEditableCell(){return!this.column.disabled&&this.shouldFocus()}isNodeWithinTableCell(e){if(!e||!e.closest(".dcg-cell"))return!1;var t=this.controller.getItemRootNodeById(this.table.id);return t?ie.contains(t,e):!1}handleFocusedChanged(e,t){e?this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}}):this.isNodeWithinTableCell(t.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}})}lookupCellPosition(){return{row:this.props.rowIdx(),column:this.column.index}}getPackedError(){return this.column.packedErrors[this.props.rowIdx()-1]}hasError(){return!!this.getPackedError()}getErrorMessage(){let e=this.getPackedError();return e?this.controller.unpack(e):""}getValue(){let e=this.props.rowIdx()-1,t=this.column.index;return AC(this.table,e,t)}isEmpty(){let e=vl();return this.getValue()===""&&Zx(e)}getAriaLabel(e){var t=this.lookupCellPosition(),i=t.row,o=t.column+1;return e==="speech"?this.controller.s("graphing-calculator-narration-table-row-column",{row:i.toString(),column:o.toString()}):this.controller.raw("r__row__c__column__",{row:i.toString(),column:o.toString()})}isColumnEditable(){return!this.column.disabled&&!this.controller.isItemReadonly(this.table.id)&&!this.controller.isInEditListMode()}getMQConfig(){return this.controller.getMathquillConfig({})}};qt();var{For:e3}=ir.Components,SS=class extends Sl{didMount(){this.onItemViewMounted()}willUnmount(){this.onItemViewUnmounted()}template(){return ir.createElement("div",{class:()=>({"dcg-expressionitem":!0,"dcg-expressiontable":!0,"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-inFolder":!!this.model.folderId,"dcg-selected":!!this.controller.isItemSelected(this.id),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id),"dcg-faded-h":this.shouldFadeLastColumn(),"dcg-faded-v":this.shouldFadeLastRow()}),"expr-id":()=>this.model.id,didMount:this.bindFn(this.didMountContainer),onKeydown:this.bindFn(this.onKeydown)},ir.createElement("div",{class:ir.const("dcg-fade-container dcg-disable-horizontal-scroll-to-cursor")},ir.createElement("div",{class:ir.const("dcg-main")},ir.createElement("div",{class:ir.const("dcg-table-container"),tabindex:()=>this.controller.isInEditListMode()?0:-1,"aria-label":()=>this.controller.getBrailleMode()==="none"?this.controller.s("graphing-calculator-narration-expression-index-table",{index:this.model.displayIndex}):this.controller.s("graphing-calculator-narration-expression-index-table",{index:this.model.displayIndex}),didMount:this.bindFn(this.didMountContainer),manageFocus:this.const({shouldBeFocused:this.shouldBeFocused.bind(this),onFocusedChanged:this.onFocusedChanged.bind(this)})},ir.createElement("div",{class:ir.const("dcg-table-sliding-container"),style:()=>({transform:`translateX(${this.computeScrolledX()}px)`})},ir.createElement(e3,{each:()=>this.getVisibleRows(),key:e=>this.getRowGUID(e)},ir.createElement("div",{role:ir.const("grid"),class:ir.const("dcg-tabledata")},e=>e.type==="show-more"?ir.createElement("tr",{role:ir.const("row"),class:ir.const("dcg-show-more-row")},ir.createElement("td",{colspan:this.bindFn(this.getColSpan)},this.bindFn(this.missingRowMessage),ir.createElement("div",{tabindex:ir.const(0),role:ir.const("button"),class:ir.const("dcg-show-more"),onTap:()=>this.controller.dispatch({type:"table-show-more-rows",id:this.id})},()=>this.controller.s("graphing-calculator-button-show-all-table-rows")))):e.type==="spacer-row"?ir.createElement("tr",{role:ir.const("row"),class:ir.const("dcg-blank-row")},ir.createElement("td",{colspan:this.bindFn(this.getColSpan),style:()=>({height:(e.endIdx-e.startIdx+1)*this.getRowHeight()+"px"})})):e.type==="header"?ir.createElement(e3,{each:()=>this.model.columnModels,key:t=>t.guid},ir.createElement("tr",{role:ir.const("row"),"aria-rowindex":ir.const(0),class:()=>({"dcg-row":e,"dcg-braille-row":this.controller.getBrailleMode()!=="none"})},t=>ir.createElement(CS,{controller:this.props.controller,model:this.const(t)}))):ir.createElement(e3,{each:()=>this.model.columnModels,key:t=>t.guid},ir.createElement("tr",{role:ir.const("row"),"aria-rowindex":()=>e.index,class:()=>({"dcg-row":e,"dcg-braille-row":this.controller.getBrailleMode()!=="none"})},t=>ir.createElement(ES,{controller:this.props.controller,column:this.const(t),rowIdx:()=>e.index})))))))),ir.createElement(dd,{controller:this.props.controller,model:this.props.model})),ir.createElement("span",{class:ir.const("dcg-tab dcg-action-drag"),handleevent:ir.const("true"),tapboundary:ir.const("true"),disablescroll:ir.const("true"),onTapStart:this.bindFn(this.onDragPending)},ir.createElement("span",{class:ir.const("dcg-num")},()=>this.model.displayIndex),ir.createElement("div",{class:ir.const("dcg-tab-interior")}),ir.createElement(kw,{model:this.props.model,controller:this.props.controller})),ir.createElement(cd,{controller:this.props.controller,id:()=>this.model.id}))}getRowGUID(e){switch(e.type){case"header":return"header";case"show-more":return"show-more";case"spacer-row":return`spacer-${e.startIdx}-${e.endIdx}`;case"standard-row":return`row-${e.index}`}}getColSpan(){return this.model.columnModels.length-1}getRowHeight(){return this.controller.getGraphSettings().config.projectorMode?38:33}getVisibleRows(){var h,f,y;let e=[{type:"header"}],t=bc(this.model)+1;if(t<=25){for(let x=1;x<t;x++)e.push({type:"standard-row",index:x});return e}let i=Cf(this.model);if(i!==void 0){for(let x=1;x<i.min;x++)e.push({type:"standard-row",index:x});e.push({type:"show-more"});for(let x=i.max;x<t;x++)e.push({type:"standard-row",index:x});return e}let o=_E(this.controller),n=o?o.height:0,a=ie(this.node).offset(),s=(a?a.top:0)-(o?o.top:0),l=(y=(f=(h=this.node)==null?void 0:h.querySelector(".dcg-row"))==null?void 0:f.getBoundingClientRect().height)!=null?y:0,c=this.getRowHeight();if(n/c>t){for(let x=1;x<t;x++)e.push({type:"standard-row",index:x});return e}let d=(-s-l)/c,p=(n-s)/c;for(var g=1;g<t;g++){let x=ds(this.model);if(g===t-2||x&&x.row===g)e.push({type:"standard-row",index:g});else if(g>p||g<d){let E=e[e.length-1];E&&E.type==="spacer-row"?E.endIdx=g:e.push({type:"spacer-row",startIdx:g,endIdx:g})}else e.push({type:"standard-row",index:g})}return e}missingRowMessage(){let e=Cf(this.model);return e===void 0?"":this.controller.s("graphing-calculator-text-table-more-rows",{rowCount:e.max-e.min})}didMountContainer(e){this.node=e,ie(e).on("scroll",()=>e.scrollLeft=0)}getSelectedCell(){return ds(this.model)}computeScrolledX(){if(!this.getSelectedCell()||!this.node)return 0;let e=this.node.children[0],t=this.node.querySelector(".dcg-selected");if(e===null||t===null)return 0;let i=this.node.getBoundingClientRect(),o=t.getBoundingClientRect(),n=o.left-e.getBoundingClientRect().left,a=i.width-n-o.width-80,s=Math.min(0,i.width-e.scrollWidth-30);return a=Math.max(a,s),Math.min(0,a)}shouldFadeLastRow(){return zq(this.model)&&!this.isBottomFocused()}shouldFadeLastColumn(){return!this.isRightFocused()}isBottomFocused(){let e=this.getSelectedCell();return!!e&&e.row===bc(this.model)}isRightFocused(){let e=this.getSelectedCell();return!!e&&e.column===this.model.columnModels.length-1}isReadonly(){return this.controller.isItemReadonly(this.id)}isFocused(){return!!this.getSelectedCell()}onKeydown(e){this.controller.isInEditListMode()||e.ctrlKey&&!e.shiftKey&&!e.altKey&&!e.metaKey&&(Be(e)==="Up"?(e.preventDefault(),e.stopPropagation(),this.moveToFirstCellInColumn()):Be(e)==="Down"?(e.preventDefault(),e.stopPropagation(),this.moveToLastCellInColumn()):Be(e)==="Left"?(e.preventDefault(),e.stopPropagation(),this.moveToFirstCellInRow()):Be(e)==="Right"?(e.preventDefault(),e.stopPropagation(),this.moveToLastCellInRow()):ji(e)==="H"&&(e.preventDefault(),e.stopPropagation(),this.speakColumnHeader()))}moveToFirstCellInColumn(){let e=this.getSelectedCell();e&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.id,location:{row:0,column:e.column}}})}moveToLastCellInColumn(){let e=this.getSelectedCell();e&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.id,location:{row:bc(this.model),column:e.column}}})}moveToFirstCellInRow(){let e=this.getSelectedCell();e&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.id,location:{row:e.row,column:0}}})}moveToLastCellInRow(){let e=this.getSelectedCell();e&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.id,location:{row:e.row,column:bc(this.model)-1}}})}speakColumnHeader(){let e=this.controller.s("graphing-calculator-narration-table-no-column-header"),t=this.getSelectedCell();if(t){let i=this.model.columnModels[t.column].latex;i&&(e=Zc.StaticMath(document.createElement("span")).latex(i).mathspeak())}Te(e)}focusHelperOptions(){return{controller:this.controller,location:{type:"table-container",id:this.model.id}}}shouldBeFocused(){return Tf(this.focusHelperOptions())}onFocusedChanged(e){if(this.controller.isInEditListMode())return OO(this.focusHelperOptions(),e)}};var bi=__dcg_shared_module_exports__['e'](te());var DS=class extends Sl{didMount(){this.onItemViewMounted()}willUnmount(){this.onItemViewUnmounted()}template(){return bi.createElement("div",{class:()=>({"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-expressionfolder":!0,"dcg-inFolder":!1,"dcg-selected":this.renderAsSelected(),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id),"dcg-collapsed":!!this.model.collapsed,"dcg-hidden":!!this.model.hidden,"dcg-has-items":this.controller.getNumberOfItemsInFolder(this.id)>0,"dcg-secretFolder":this.model.secret&&!this.controller.shouldShowAuthorFeatures()}),"expr-id":()=>this.model.id,onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect)},bi.createElement("div",{class:bi.const("dcg-fade-container")},bi.createElement("div",{class:bi.const("dcg-main")},bi.createElement("div",{role:bi.const("button"),tabindex:bi.const("0"),"aria-pressed":()=>this.model.collapsed,"aria-label":()=>this.model.collapsed?Ui(this.model,"expand"):Ui(this.model,"collapse"),class:bi.const("dcg-caret-container dcg-action-toggle-folder-collapsed dcg-do-not-blur"),handleEvent:bi.const("true"),onTap:this.bindFn(this.toggleCollapsed)},bi.createElement("i",{class:bi.const("dcg-icon-caret-down"),"aria-hidden":bi.const("true")})),bi.createElement(Lh,{shouldFocus:this.bindFn(this.isFocused),text:()=>this.model.title,showLinks:()=>this.controller.areLinksEnabled(),onInput:this.bindFn(this.onInput),onFocusChange:this.bindFn(this.onFocusChange),onSpecialKey:this.bindFn(this.onSpecialKey),ariaLabel:this.bindFn(this.getAriaLabel),readonly:()=>this.controller.isInEditListMode()||this.controller.isItemReadonly(this.id),readonlyAction:this.const({predicate:()=>this.controller.isInEditListMode(),action:()=>this.exitEditListMode()}),placeholder:()=>this.controller.s("graphing-calculator-text-folder-placeholder")}),bi.createElement(xt,{checked:()=>this.model.secret,class:this.const("dcg-action-toggle-secret-folder dcg-do-not-blur"),style:()=>({display:this.controller.shouldShowAuthorFeatures()?void 0:"none"}),onChange:this.bindFn(this.toggleSecret)},bi.createElement("span",{class:bi.const("dcg-checkbox-label")},()=>this.controller.s("graphing-calculator-button-hide-folder-from-students-2")))),bi.createElement(dd,{controller:this.props.controller,model:this.props.model})),bi.createElement("span",{class:bi.const("dcg-tab dcg-action-drag"),handleevent:bi.const("true"),tapboundary:bi.const("true"),disablescroll:bi.const("true"),onTapStart:this.bindFn(this.onDragPending)},bi.createElement("span",{class:bi.const("dcg-num")},()=>this.model.displayIndex),bi.createElement("div",{class:bi.const("dcg-tab-interior")},bi.createElement("span",{role:bi.const("button"),tabindex:bi.const("0"),"aria-pressed":()=>!!this.model.hidden,"aria-label":()=>this.model.hidden?Ui(this.model,"show"):Ui(this.model,"hide"),class:bi.const("dcg-circular-icon-container dcg-expression-icon-container"),onTap:this.bindFn(this.toggleHidden)},bi.createElement(yn,{iconType:()=>this.model.hidden?"hidden":"folder",whiteIcon:()=>this.renderAsSelected()||this.controller.isItemBeingDragged(this.model.id)})))),bi.createElement(cd,{controller:this.props.controller,id:()=>this.model.id}))}renderAsSelected(){return this.controller.isItemSelected(this.model.id)||this.model.collapsedChildIsSelected}toggleHidden(){this.controller.dispatch({type:"toggle-item-hidden",id:this.id})}toggleSecret(){this.controller.dispatch({type:"set-item-secret",id:this.id,isSecret:!this.model.secret})}toggleCollapsed(){this.controller.dispatch({type:"set-folder-collapsed",id:this.id,isCollapsed:!this.model.collapsed})}onInput(e){this.controller.dispatch({type:"set-folder-title",id:this.id,title:e})}onFocusChange(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"folder",id:this.id}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"folder",id:this.id}})}onSpecialKey(e){return this.controller.dispatch({type:"on-special-key-pressed",key:e})}isFocused(){let e=this.controller.getFocusLocation();return!(!e||e.type!=="folder"||e.id!==this.id)}getAriaLabel(){let e="",t="";switch((this.model.hidden?1:0)+(this.model.collapsed?16:0)+(this.model.secret?256:0)+(this.model.readonly?4096:0)){case 0:t=this.controller.s("graphing-calculator-narration-description-folder");break;case 1:t=this.controller.s("graphing-calculator-narration-description-hidden-folder");break;case 16:t=this.controller.s("graphing-calculator-narration-description-collapsed-folder");break;case 256:t=this.controller.s("graphing-calculator-narration-description-secret-folder");break;case 4096:t=this.controller.s("graphing-calculator-narration-description-readonly-folder");break;case 17:t=this.controller.s("graphing-calculator-narration-description-hidden-collapsed-folder");break;case 257:t=this.controller.s("graphing-calculator-narration-description-hidden-secret-folder");break;case 4097:t=this.controller.s("graphing-calculator-narration-description-hidden-readonly-folder");break;case 272:t=this.controller.s("graphing-calculator-narration-description-collapsed-secret-folder");break;case 4352:t=this.controller.s("graphing-calculator-narration-description-secret-readonly-folder");break;case 4112:t=this.controller.s("graphing-calculator-narration-description-collapsed-readonly-folder");break;case 273:t=this.controller.s("graphing-calculator-narration-description-hidden-collapsed-secret-folder");break;case 4113:t=this.controller.s("graphing-calculator-narration-description-hidden-collapsed-readonly-folder");break;case 4353:t=this.controller.s("graphing-calculator-narration-description-hidden-secret-readonly-folder");break;case 4368:t=this.controller.s("graphing-calculator-narration-description-collapsed-secret-readonly-folder");break;case 4369:t=this.controller.s("graphing-calculator-narration-description-hidden-collapsed-secret-readonly-folder");break}let c=this.controller.getNumberOfItemsInFolder(this.id);return c>0?e=this.controller.s("graphing-calculator-narration-folder-has-items",{folder:t,count:c}):e=t,e}};var ut=__dcg_shared_module_exports__['e'](te());function AI(r){let e=document.createElement("a");return e.href=r,e.href}var Qa=__dcg_shared_module_exports__['e'](te());var{SwitchUnion:uue,If:hue}=Qa.Components,gb=class extends Qa.Class{init(){this.model=this.props.model(),this.controller=this.props.controller()}template(){return Qa.createElement("div",{class:Qa.const("dcg-expression-icon-container dcg-image-icon-container")},uue(this.bindFn(this.typeOfIcon),{error:()=>Qa.createElement($a,{error:()=>this.controller.unpack(this.model.error),isWhite:this.bindFn(this.isSelected),gravity:this.const("s")}),failed:()=>Qa.createElement("span",null),loading:()=>Qa.createElement(yn,{iconType:this.const("loading")}),hidden:()=>this.buildIconView(),image:()=>this.buildIconView()}))}buildIconView(){return Qa.createElement("div",{class:Qa.const("dcg-circular-icon-container"),role:Qa.const("button"),tabindex:Qa.const("0"),"dcg-open-menu-guid":()=>this.getMenuGUID(),"aria-label":this.bindFn(this.getIconAriaLabel),onTap:e=>{if(!e.wasHandled("dragdrop")&&!e.wasLongheld()){if(this.myOptionsOpen())return this.toggleOptions(e);if(this.controller.isInEditListMode()||e.shiftKey)return this.toggleOptions(e);this.toggleImageShown()}},onLongHold:e=>{e.handle("dcg-longhold"),e.handle("dcg-tap"),this.toggleOptions(e)},manageFocus:this.const(ft({controller:this.controller,location:{type:"image-icon",id:this.model.id}}))},Qa.createElement(yn,{iconType:()=>this.typeOfIcon()==="hidden"?"hidden":"background",backgroundImage:this.bindFn(this.getBackgroundImage),backgroundOpacity:this.const(1),whiteIcon:this.bindFn(this.isSelected)}),Qa.createElement(hue,{predicate:()=>this.model.disableGraphInteractions},()=>Qa.createElement("i",{class:Qa.const("dcg-graph-interaction-disabled dcg-icon-lock")})))}isSelected(){return this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)}typeOfIcon(){return this.model.loadStatus==="loading"?"loading":this.model.loadStatus==="failed"?"failed":this.hasError()?"error":this.model.shouldGraph?"image":"hidden"}getMenuGUID(){return this.model.guid}myOptionsOpen(){return this.controller.isItemSettingsMenuOpen(this.getMenuGUID())}toggleOptions(e){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"image",model:this.model,guid:this.getMenuGUID(),focusFirstOption:e.device==="keyboard"}})}hasError(){return!!this.model.error&&this.controller.getBrailleMode()==="none"}getBackgroundImage(){return this.model.image_url===this.lastURL?this.lastEncodedURL:(this.lastURL=this.model.image_url,this.lastEncodedURL='url("'+AI(this.model.image_url)+'")',this.lastEncodedURL)}toggleImageShown(){this.controller.dispatch({type:"toggle-item-hidden",id:this.model.id}),this.controller.dispatch({type:"set-focus-location",location:{type:"image-icon",id:this.model.id}})}getIconAriaLabel(){return this.myOptionsOpen()?Ui(this.model,"hide-options"):this.controller.isInEditListMode()?Ui(this.model,"show-options"):this.model.hidden?Ui(this.model,"show"):Ui(this.model,"hide")}};var pd=__dcg_shared_module_exports__['e'](te());qt();var Ph=class extends pd.Class{init(){this.controller=this.props.controller()}template(){return pd.createElement("div",{class:pd.const("dcg-do-not-blur"),onTap:this.bindFn(this.newImage),handleEvent:pd.const("true"),role:pd.const("button"),tabindex:()=>this.props.readonly()?-1:0,"aria-label":this.props.ariaLabel,"aria-disabled":()=>this.props.readonly(),manageFocus:this.const(this.props.location?ft({controller:this.controller,location:this.props.location()}):void 0)},this.children,pd.createElement("input",{type:pd.const("file"),accept:pd.const("image/*"),style:pd.const("display: none"),didMount:this.bindFn(this.didMountFileInput)}))}didMountFileInput(e){this.fileInputNode=e,ie(e).on("change",()=>{this.props.onFileChange(e.files),e.value=""})}newImage(){this.props.readonly()||this.fileInputNode.click()}};var{If:kS,SwitchUnion:gue}=ut.Components,mb=class extends ut.Class{init(){this.model=this.props.model(),this.controller=this.props.controller()}template(){return ut.createElement(_r,{containerClass:()=>({"dcg-image-input-mathquill":!0,"dcg-suffix-degree":this.props.name()==="angle"&&this.props.controller().getGraphSettings().degreeMode,"dcg-suffix-radian":this.props.name()==="angle"&&!this.props.controller().getGraphSettings().degreeMode}),fontSize:this.const("large"),fullWidth:this.const(!0),readonly:this.props.readonly,latex:()=>this.model[this.props.name()],isFocused:()=>this.props.focusedInput()===this.props.name(),ariaLabel:()=>this.controller.raw(this.props.name()),handleFocusChanged:this.bindFn(this.handleMQFocusedChanged),hasError:()=>j8(this.model,this.props.name()),controller:this.props.controller,handlePressedKey:this.bindFn(this.handlePressedKey),handleLatexChanged:this.bindFn(this.handleLatexChanged),noBorder:()=>!this.props.focusedInput()})}getInputs(){return["center","width","angle","height","opacity"]}handlePressedKey(e,t){let i=this.props.name();var o=Ze.getFocusedMathquill();let n=this.getInputs(),a=n.indexOf(i);if(!this.controller.isInEditListMode()){if(e==="Enter")return this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"});if(e==="Esc"){pi();return}}let s=-1;e==="Up"&&(s=a===1?4:a-2),e==="Down"&&(s=a===4?1:a+2),e==="Left"&&(s=a-1),e==="Right"&&(s=a+1);let l=e;if(s>=0&&s<n.length){let c=!1;if(o)c=Ze.applyArrowKeyAndReturnIfWasAtBounds(o,l,t);else if(e==="Up"||e==="Down")c=!0;else{let d=vl();c=d&&(e==="Left"&&d.selectionStart===0||e==="Right"&&d.selectionStart===d.value.length)}c&&(this.focusInput(n[s]),t&&t.preventDefault());return}o&&(o.keystroke(e,t),this.handleLatexChanged(o.latex()))}focusInput(e){this.controller.dispatch({type:"set-focus-location",location:{type:"image",id:this.model.id,location:e}})}handleLatexChanged(e){let t=this.props.name();this.model.draggingOnGraphpaper||B8(this.model,t)!==e&&this.controller.dispatch({type:"set-image-mq-attribute",id:this.model.id,attribute:t,latex:e})}handleMQFocusedChanged(e){let t=this.props.name();e?this.props.focusedInput()!==t&&this.controller.dispatch({type:"set-focus-location",location:{type:"image",id:this.model.id,location:t}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"image",id:this.model.id,location:t}})}},GS=class extends Sl{didMount(){this.onItemViewMounted()}willUnmount(){this.onItemViewUnmounted()}template(){return ut.createElement("div",{class:()=>({"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-readonly":this.controller.isItemMarkedReadonly(this.id),"dcg-expressionimage":!0,"dcg-inFolder":!!this.model.folderId,"dcg-selected":this.controller.isItemSelected(this.id),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id),"dcg-input-focused":this.getFocusedInput()&&this.getFocusedInput()!=="name"}),"expr-id":()=>this.model.id,onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect)},ut.createElement("div",{class:ut.const("dcg-fade-container")},ut.createElement("div",{class:ut.const("dcg-main")},gue(()=>this.model.loadStatus,{failed:()=>ut.createElement("div",null,ut.createElement("div",{class:ut.const("dcg-image-failed")},()=>this.controller.s("graphing-calculator-error-failed-to-load-image")),ut.createElement("div",{role:ut.const("button"),tabindex:ut.const(0),class:ut.const("dcg-retry-loading-image"),onTap:this.bindFn(this.onRetryLoad)},()=>this.controller.s("graphing-calculator-button-load-image-retry"))),loading:()=>ut.createElement("div",null,ut.createElement("div",{class:ut.const("dcg-image-loading")},()=>this.controller.s("graphing-calculator-text-loading-image")),ut.createElement("div",{role:ut.const("button"),tabindex:ut.const(0),class:ut.const("dcg-retry-loading-image"),onTap:this.bindFn(this.onRetryLoad)},()=>this.controller.s("graphing-calculator-button-load-image-retry"))),loaded:()=>ut.createElement("div",{class:ut.const("dcg-image-loaded")},ut.createElement("div",{class:ut.const("dcg-image-title-row")},ut.createElement(Lh,{shouldFocus:()=>this.getFocusedInput()==="name",text:()=>this.model.name,ariaLabel:()=>Ui(this.model,"edit_title"),placeholder:()=>this.controller.s("graphing-calculator-text-image-placeholder"),showLinks:()=>this.controller.areLinksEnabled(),onInput:this.bindFn(this.onNameInput),onFocusChange:this.bindFn(this.onNameFocusChange),onSpecialKey:this.bindFn(this.onNameSpecialKey),readonly:()=>this.controller.isInEditListMode()||this.isReadonly()}),ut.createElement(kS,{predicate:()=>this.controller.areImagesEnabled()},()=>ut.createElement(Ph,{controller:()=>this.controller,ariaLabel:()=>this.controller.s("graphing-calculator-button-change-image"),onFileChange:e=>this.insertFiles(e),location:this.const({type:"change-image-btn",id:this.id}),readonly:this.bindFn(this.isReadonly)},ut.createElement(kS,{predicate:()=>!this.isReadonly()},()=>ut.createElement("div",{class:ut.const("dcg-action-changeimage")},()=>this.controller.s("graphing-calculator-button-change-image")))))),ut.createElement("div",{class:()=>({"dcg-do-blur":!0,"dcg-image-input-grid":!0}),handleEvent:ut.const("true")},ut.createElement("div",{class:ut.const("dcg-image-input-name")},()=>this.controller.s("graphing-calculator-label-image-center")),ut.createElement(mb,{name:this.const("center"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)}),ut.createElement("div",{class:ut.const("dcg-image-input-name")},()=>this.controller.s("graphing-calculator-label-image-width")),ut.createElement(mb,{name:this.const("width"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)}),ut.createElement("div",{class:ut.const("dcg-image-input-name")},()=>this.controller.s("graphing-calculator-label-image-angle")),ut.createElement(mb,{name:this.const("angle"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)}),ut.createElement("div",{class:ut.const("dcg-image-input-name")},()=>this.controller.s("graphing-calculator-label-image-height")),ut.createElement(mb,{name:this.const("height"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)}),ut.createElement("div",{class:ut.const("dcg-image-input-name")},()=>this.controller.s("graphing-calculator-label-image-opacity")),ut.createElement(mb,{name:this.const("opacity"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)})))})),ut.createElement("span",{class:ut.const("dcg-fadeout")}),ut.createElement(dd,{controller:this.props.controller,model:this.props.model}),ut.createElement(kS,{predicate:this.bindFn(this.shouldShowBrailleError)},()=>ut.createElement("div",{class:this.getFooterClass()},ut.createElement("div",{tabindex:ut.const(0),class:ut.const("dcg-expression-braille-error"),"aria-roledescription":ut.const("error"),"aria-label":()=>this.controller.unpack(this.model.error)},ut.createElement("i",{class:ut.const("dcg-icon-error"),"aria-hidden":ut.const("true")}),()=>this.controller.unpack(this.model.error)))),ut.createElement(kS,{predicate:()=>mG(this.model).length>0&&this.controller.areSlidersEnabled()},()=>ut.createElement("div",{class:this.getFooterClass()},ut.createElement(op,{model:this.props.model,controller:this.props.controller}))),ut.createElement(kS,{predicate:this.bindFn(this.shouldShowActionInfo)},()=>ut.createElement("div",{class:this.getFooterClass()},ut.createElement(ub,{model:this.props.model,controller:this.props.controller})))),ut.createElement("span",{class:ut.const("dcg-tab dcg-action-drag dcg-action-icon-touch"),handleevent:ut.const("true"),tapboundary:ut.const("true"),disablescroll:ut.const("true"),onTapStart:this.bindFn(this.onDragPending)},ut.createElement("span",{class:ut.const("dcg-num")},()=>this.model.displayIndex),ut.createElement("div",{class:ut.const("dcg-tab-interior dcg-action-icon-mouse")},ut.createElement(gb,{model:this.props.model,controller:this.props.controller}))),ut.createElement(cd,{controller:this.props.controller,id:()=>this.model.id}))}isReadonly(){return this.controller.isItemReadonly(this.id)}shouldShowActionInfo(){return!!(this.model.clickableInfo&&this.model.clickableInfo.enabled&&this.model.clickableInfo.latex)}getFooterClass(){return this.isFirstRender()?this.const("dcg-expression-bottom dcg-indent-in-folder"):this.const("dcg-expression-bottom dcg-fadein-bottom dcg-indent-in-folder")}onNameInput(e){this.controller.dispatch({type:"set-image-name",id:this.id,name:e})}onNameFocusChange(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"image",id:this.id,location:"name"}}):this.getFocusedInput()==="name"&&this.controller.dispatch({type:"blur-focus-location",location:{type:"image",id:this.id,location:"name"}})}onNameSpecialKey(e){return this.controller.dispatch({type:"on-special-key-pressed",key:e})}getFocusedInput(){let e=this.controller.getFocusLocation();if(e&&e.type==="image"&&e.id===this.model.id)return e.location}onRetryLoad(){this.controller.dispatch({type:"image-retry-loading",id:this.id})}shouldShowBrailleError(){return this.controller.getBrailleMode()!=="none"&&!!this.model.error}insertFiles(e){this.controller.dispatch({type:"change-image",files:e,id:this.id})}onMouseSelect(e){e.type==="dcg-tap"&&e.device==="mouse"||e.type==="dcg-tapstart"&&e.device==="touch"||e.wasHandled()||(e.handle(),this.controller.dispatch({type:"set-selected-id",id:this.id}))}};var TS=__dcg_shared_module_exports__['e'](te());var MS=class extends Sl{didMount(){this.onItemViewMounted()}willUnmount(){this.onItemViewUnmounted()}template(){let e="";return this.model.cachedRenderHeight&&(e="height:"+this.model.cachedRenderHeight+"px"),TS.createElement("div",{class:TS.const("dcg-do-not-blur dcg-expressionitem dcg-shell"),"expr-id":this.const(this.model.id),onTap:this.bindFn(this.onMouseSelect),style:TS.const(e)})}};var Gw=__dcg_shared_module_exports__['e'](te()),IS=class extends Gw.Class{init(){this.controller=this.props.controller()}template(){return Gw.createElement("div",{class:Gw.const("dcg-drag-container"),style:()=>({top:this.getTopPx(),left:this.getLeftPx()})},this.children)}getTopPx(){let e=this.controller.getRawDragState();if(e)return e.itemTop+"px"}getLeftPx(){let e=this.controller.getRawDragState();if(e)return e.itemLeft+"px"}};var fu={delimiter:"",header:!1,dynamicTyping:!1,preview:0,step:void 0,encoding:"",comments:!1,complete:void 0,error:void 0,download:!1,chunk:void 0,keepEmptyRows:!1},Za={};Za.parse=mue;Za.RECORD_SEP="";Za.UNIT_SEP="";Za.BYTE_ORDER_MARK="\uFEFF";Za.BAD_DELIMITERS=["\r",`
`,'"',Za.BYTE_ORDER_MARK];Za.LocalChunkSize=1024*1024*10;Za.RemoteChunkSize=1024*1024*5;Za.DefaultDelimiter=",";Za.Parser=VI;Za.ParserHandle=jY;function mue(r,e){var t=fue(e),i=new jY(t),o=i.parse(r);return o}function jY(r){var e=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,t=this,i,o,n=!1,a,s=[],l={data:[],errors:[],meta:{}};r=t3(r),this.parse=function(x){if(a=!1,!r.delimiter){var E=h(x);E.successful?r.delimiter=E.bestDelimiter:(a=!0,r.delimiter=Za.DefaultDelimiter),l.meta.delimiter=r.delimiter}if(Tw(r.step)){var C=r.step;r.step=function(S){l=S,d()?c():C(c(),t)}}return r.preview&&r.header&&r.preview++,i=x,o=new VI(r),l=o.parse(i),c(),Tw(r.complete)&&!n&&r.complete(l),n?{meta:{paused:!0}}:l},this.pause=function(){n=!0,o.abort(),i=i.substr(o.getCharIndex())},this.resume=function(){n=!1,o=new VI(r),o.parse(i),Tw(r.complete)&&!n&&r.complete(l)},this.abort=function(){o.abort(),Tw(r.complete)&&r.complete(l),i=""};function c(){return l&&a&&(y("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+Za.DefaultDelimiter+"'"),a=!1),d()&&p(),g()}function d(){return r.header&&s.length==0}function p(){if(l){for(var x=0;d()&&x<l.data.length;x++)for(var E=0;E<l.data[x].length;E++)s.push(l.data[x][E]);l.data.splice(0,1)}}function g(){if(!l||!r.header&&!r.dynamicTyping)return l;for(var x=0;x<l.data.length;x++){for(var E={},C=0;C<l.data[x].length;C++){if(r.dynamicTyping){var S=l.data[x][C];S=="true"?l.data[x][C]=!0:S=="false"?l.data[x][C]=!1:l.data[x][C]=f(S)}r.header&&(C>=s.length?(E.__parsed_extra||(E.__parsed_extra=[]),E.__parsed_extra.push(l.data[x][C])):E[s[C]]=l.data[x][C])}r.header&&(l.data[x]=E,C>s.length?y("FieldMismatch","TooManyFields","Too many fields: expected "+s.length+" fields but parsed "+C,x):C<s.length&&y("FieldMismatch","TooFewFields","Too few fields: expected "+s.length+" fields but parsed "+C,x))}return r.header&&l.meta&&(l.meta.fields=s),l}function h(x){for(var E=[",","	","|",";",Za.RECORD_SEP,Za.UNIT_SEP],C,S,v,M=0;M<E.length;M++){var A=E[M],I=0,P=0;v=void 0;for(var _=new VI({delimiter:A,preview:10}).parse(x),U=0;U<_.data.length;U++){var Y=_.data[U].length;if(P+=Y,typeof v=="undefined"){v=Y;continue}else Y>1&&(I+=Math.abs(Y-v),v=Y)}P/=_.data.length,(typeof S=="undefined"||I<S)&&P>1.99&&(S=I,C=A)}return r.delimiter=C,{successful:!!C,bestDelimiter:C}}function f(x){var E=e.test(x);return E?parseFloat(x):x}function y(x,E,C,S){l.errors.push({type:x,code:E,message:C,row:S})}}function VI(r){var e=/^\s*$/,t,i,o,n,a,s,l,c,d,p,g,h,f,y,x,E=!1;r=r||{},i=r.delimiter,o=r.comments,n=r.step,s=r.preview,(typeof i!="string"||i.length!=1||Za.BAD_DELIMITERS.indexOf(i)>-1)&&(i=","),o===!0?o="#":(typeof o!="string"||o.length!=1||Za.BAD_DELIMITERS.indexOf(o)>-1||o==i)&&(o=!1),this.parse=function(ne){if(typeof ne!="string")throw"Input must be a string";return j(ne),C()},this.abort=function(){E=!0},this.getCharIndex=function(){return c};function C(){for(;c<t.length&&!(E||s>0&&x>=s);)l=='"'?M():d?A():I(),S();return v()}function S(){c++,l=t[c]}function v(){if(E&&F("Abort","ParseAbort","Parsing was aborted by the user's step function"),d&&F("Quotes","MissingQuotes","Unescaped or mismatched quotes"),H(),!Tw(n))return le()}function M(){B()&&!T()?d=!d:(U(),d&&T()?c++:F("Quotes","UnexpectedQuotes","Unexpected quotes"))}function A(){(q(c)||w(c))&&p++,U()}function I(){l==i?Y():q(c)?(R(),S()):w(c)?R():P()?_():U()}function P(){if(!o)return!1;var ne=c==0||w(c-1)||q(c-2);return ne&&t[c]===o}function _(){for(;!q(c)&&!w(c)&&c<t.length;)S()}function U(){g[f][y]+=l}function Y(){g[f].push(""),y=g[f].length-1}function R(){H(),p++,x++,g.push([]),f=g.length-1,Y()}function H(){O(),Tw(n)&&(g[f]&&n(le()),pe())}function O(){g[f].length==1&&e.test(g[f][0])&&(r.keepEmptyRows?g[f].splice(0,1):g.splice(f,1),f=g.length-1)}function q(ne){return ne<t.length-1&&(t[ne]=="\r"&&t[ne+1]==`
`||t[ne]==`
`&&t[ne+1]=="\r")}function w(ne){return t[ne]=="\r"||t[ne]==`
`}function T(){return!B()&&c<t.length-1&&t[c+1]=='"'}function B(){return!d&&de(c-1)||de(c+1)}function de(ne){typeof ne!="number"&&(ne=c);var X=t[ne];return ne<=-1||ne>=t.length||X==i||X=="\r"||X==`
`}function F(ne,X,ae){h.push({type:ne,code:X,message:ae,line:p,row:f,index:c})}function j(ne){t=ne,d=!1,c=0,x=0,p=1,pe(),g=[[""]],l=t[c]}function pe(){g=[],h=[],f=0,y=0}function le(){return{data:g,errors:h,meta:{lines:p,delimiter:i,aborted:E,truncated:s>0&&c<t.length}}}}function fue(r){typeof r!="object"&&(r={});var e=t3(r);return(typeof e.delimiter!="string"||e.delimiter.length!=1||Za.BAD_DELIMITERS.indexOf(e.delimiter)>-1)&&(e.delimiter=fu.delimiter),typeof e.header!="boolean"&&(e.header=fu.header),typeof e.dynamicTyping!="boolean"&&(e.dynamicTyping=fu.dynamicTyping),typeof e.preview!="number"&&(e.preview=fu.preview),typeof e.step!="function"&&(e.step=fu.step),typeof e.complete!="function"&&(e.complete=fu.complete),typeof e.error!="function"&&(e.error=fu.error),typeof e.encoding!="string"&&(e.encoding=fu.encoding),typeof e.download!="boolean"&&(e.download=fu.download),typeof e.keepEmptyRows!="boolean"&&(e.keepEmptyRows=fu.keepEmptyRows),e}function t3(r){if(typeof r!="object")return r;var e=r instanceof Array?[]:{};for(var t in r)e[t]=t3(r[t]);return e}function Tw(r){return typeof r=="function"}var{parse:YY}=Za;as();function r3(r){var e;if(typeof r=="number")e=r+"";else if(typeof r=="string")e=r;else return!1;return e.trim().match(/^-?[0-9]*\.?[0-9]*$/)}function XY(r){let e=r.split(/\r?\n/),t=[],i=!1;if(!(e.length<2)){for(let o=0;o<e.length;o++){let n=e[o];if(!n.trim())continue;o>0&&!r3(n.replace(/,(\d{3})/g,"$1"))&&(i=!0);let a={content:n};t.push(a)}if(!i){let o=__dcg_shared_module_exports__['m'](t,"content").map(n=>n.replace(/,(\d{3})/g,"$1"));return r3(o[0])||(o=o.slice(1)),[{content:"\\left["+o.join(",")+"\\right]",numberList:!0}]}return t}}function JY(r){if(/^\s*$/.test(r))return;let e=YY(r,{preview:1e4}),t=e.data,i=[];if(e.errors.length&&!e.data.length){Ii("PapaParse.parse returned errors.",{metaData:{input:r,output:e.errors}});return}if(!(!e.data.length||e.data.length<2)){var o=t[0].length;for(let n=0;n<o;n++)i.push([]);for(let n=0;n<e.data.length;n++)if(!(n===0&&isNaN(parseFloat(t[n][0])))){if(t[n].length<2)return;if(!(!t[n][0]&&!t[n][1]))for(let a=0;a<o;a++){let s=(t[n][a]||"").replace(/,(\d{3})/g,"$1");if(s&&isNaN(parseFloat(s)))return;i[a].push(s)}}if(!(i[0].length<2))return i}}var el=__dcg_shared_module_exports__['e'](te()),AS=class extends el.Class{template(){return this.controller=this.props.controller(),el.createElement("div",{class:el.const("dcg-expressionitem dcg-new-expression dcg-opened")},el.createElement("div",{class:el.const("dcg-new-math-div dcg-do-not-blur dcg-action-newmath"),onTap:this.bindFn(this.newMath)},el.createElement("div",{class:el.const("dcg-new-expression-fade")})),el.createElement("span",{class:el.const("dcg-tab")},el.createElement("span",{class:el.const("dcg-num dcg-variable-index")},this.bindFn(this.getIndex)),el.createElement("div",{class:el.const("dcg-tab-interior")})))}getIndex(){return this.controller.getNextDisplayIndex()}newMath(){this.controller.dispatch({type:"new-expression-at-end"})}};var Tt=__dcg_shared_module_exports__['e'](te());qt();var{If:VS}=Tt.Components,LS=class extends Tt.Class{init(){this.controller=this.props.controller()}template(){return Tt.createElement("div",{class:Tt.const("dcg-add-expression-container")},Tt.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-add-item-tooltip"),gravity:this.const("s")},Tt.createElement("button",{class:()=>({"dcg-unstyled-button":!0,"dcg-icon-btn":!0,"dcg-add-expression-btn":!0,"dcg-action-add-expression":!0,"dcg-do-blur":!0,"dcg-active":this.controller.isAddExpressionOpen()}),handleEvent:Tt.const("true"),"aria-haspopup":Tt.const("true"),"aria-expanded":()=>this.controller.isAddExpressionOpen(),"aria-label":()=>this.controller.s("graphing-calculator-label-add-item-tooltip"),didMount:e=>{this.toggleButtonNode=e},onTap:this.bindFn(this.toggleAddExpression),manageFocus:this.const(ft({controller:this.controller,location:{type:"add-item-btn"}}))},Tt.createElement("i",{class:Tt.const("dcg-icon-plus"),"aria-hidden":Tt.const("true")}))),Tt.createElement(VS,{predicate:()=>this.controller.isAddExpressionOpen()},()=>Tt.createElement("div",{class:()=>({"dcg-add-expression-dropdown":!0,"dcg-popover":!0,"dcg-bottom":!this.controller.isNarrow(),"dcg-right":this.controller.isNarrow()}),role:Tt.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-item-menu"),didMount:this.bindFn(this.didMountPopover),didUnmount:this.bindFn(this.didUnmountPopover)},Tt.createElement("div",{class:Tt.const("dcg-popover-interior")},Tt.createElement("div",{class:Tt.const("dcg-new-item dcg-do-not-blur dcg-action-newexpression"),role:Tt.const("button"),tabindex:Tt.const(0),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-expression"),onTap:this.bindFn(this.newExpression),handleEvent:Tt.const("true"),manageFocus:this.const(ft({controller:this.controller,location:{type:"add-expression-btn"}}))},Tt.createElement("i",{class:Tt.const("dcg-icon-new-expression dcg-expression-icon"),"aria-hidden":Tt.const("true")}),()=>this.controller.s("graphing-calculator-label-expression-lowercase")),Tt.createElement(VS,{predicate:()=>this.controller.areNotesEnabled()},()=>Tt.createElement("div",{class:Tt.const("dcg-new-item dcg-do-not-blur dcg-action-newtext"),role:Tt.const("button"),tabindex:Tt.const(0),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-note"),onTap:this.bindFn(this.newText),handleEvent:Tt.const("true"),manageFocus:this.const(ft({controller:this.controller,location:{type:"add-note-btn"}}))},Tt.createElement("i",{class:Tt.const("dcg-icon-new-text dcg-expression-icon"),"aria-hidden":Tt.const("true")}),()=>this.controller.s("graphing-calculator-label-note-lowercase"))),Tt.createElement("div",{class:Tt.const("dcg-new-item dcg-do-not-blur dcg-action-newtable"),role:Tt.const("button"),tabindex:Tt.const(0),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-table"),onTap:this.bindFn(this.newTable),handleEvent:Tt.const("true"),manageFocus:this.const(ft({controller:this.controller,location:{type:"add-table-btn"}}))},Tt.createElement("i",{class:Tt.const("dcg-icon-new-table dcg-expression-icon"),"aria-hidden":Tt.const("true")}),()=>this.controller.s("graphing-calculator-label-table-lowercase")),Tt.createElement(VS,{predicate:()=>this.controller.areFoldersEnabled()},()=>Tt.createElement("div",{class:Tt.const("dcg-new-item dcg-do-not-blur dcg-action-newfolder"),role:Tt.const("button"),tabindex:Tt.const(0),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-folder"),onTap:this.bindFn(this.newFolder),handleEvent:Tt.const("true"),manageFocus:this.const(ft({controller:this.controller,location:{type:"add-folder-btn"}}))},Tt.createElement("i",{class:Tt.const("dcg-icon-new-folder dcg-expression-icon"),"aria-hidden":Tt.const("true")}),()=>this.controller.s("graphing-calculator-label-folder-lowercase"))),Tt.createElement(VS,{predicate:()=>this.controller.areImagesEnabled()},()=>Tt.createElement(Ph,{controller:()=>this.controller,ariaLabel:()=>this.controller.s("graphing-calculator-narration-add-image"),onFileChange:e=>this.insertFiles(e),location:this.const({type:"add-image-btn"}),readonly:this.const(!1)},Tt.createElement("div",{class:Tt.const("dcg-new-item dcg-action-newimage")},Tt.createElement("i",{class:Tt.const("dcg-icon-new-image dcg-expression-icon"),"aria-hidden":Tt.const("true")}),()=>this.controller.s("graphing-calculator-label-image-lowercase")))),Tt.createElement(VS,{predicate:this.bindFn(this.showAddTicker)},()=>Tt.createElement("div",{class:Tt.const("dcg-new-item dcg-do-not-blur dcg-action-ticker"),role:Tt.const("button"),tabindex:Tt.const(0),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-ticker"),onTap:this.bindFn(this.addTicker),handleEvent:Tt.const("true"),manageFocus:this.const(ft({controller:this.controller,location:{type:"add-ticker-btn"}}))},Tt.createElement("i",{class:Tt.const("dcg-icon-metronome dcg-expression-icon"),"aria-hidden":Tt.const("true")}),()=>this.controller.s("graphing-calculator-label-ticker-lowercase")))),Tt.createElement("span",{class:Tt.const("dcg-arrow")}))))}showAddTicker(){return this.controller.areActionsEnabled()&&!this.controller.getTickerOpen()}didMountPopover(e){this.popoverNode=e,ie(document).on("dcg-tapstart.add-expression-view wheel.add-expression-view",t=>{this.eventShouldClosePopover(t)&&this.controller.dispatch({type:"close-add-expression",focusIconAfterClose:t.device==="keyboard"})}),ie(document).on("keydown.add-expression-view",t=>{if(Be(t)==="Esc"&&this.controller.dispatch({type:"close-add-expression",focusIconAfterClose:!0}),Be(t)==="Tab"&&!t.altKey&&!t.metaKey&&!t.ctrlKey){let i=this.controller.getFocusLocation();if(!i)return;let o;this.showAddTicker()?o={type:"add-ticker-btn"}:this.controller.areImagesEnabled()?o={type:"add-image-btn"}:this.controller.areFoldersEnabled()?o={type:"add-folder-btn"}:o={type:"add-table-btn"},!t.shiftKey&&i.type===o.type?(this.controller.dispatch({type:"set-focus-location",location:{type:"add-item-btn"}}),t.preventDefault(),t.stopPropagation()):t.shiftKey&&i.type==="add-item-btn"&&(this.controller.dispatch({type:"set-focus-location",location:o}),t.preventDefault(),t.stopPropagation())}}),ll&&Qu&&ie(e).on("dcg-tapstart",t=>t.preventDefault()),ie(e.querySelector(".dcg-new-item")).on("touchstart",t=>t.preventDefault())}didUnmountPopover(){ie(document).off(".add-expression-view")}toggleAddExpression(e){this.controller.dispatch({type:"toggle-add-expression",focusOnOpen:e.device==="keyboard"})}newExpression(){this.controller.dispatch({type:"new-expression"})}newText(){this.controller.dispatch({type:"new-text"})}newFolder(){this.controller.dispatch({type:"new-folder"})}addTicker(){this.controller.dispatch({type:"open-ticker"})}newTable(){this.controller.dispatch({type:"new-table"})}insertFiles(e){this.controller.dispatch({type:"new-images",files:e})}eventShouldClosePopover(e){let t=!!this.popoverNode.contains(e.target),i=!!this.toggleButtonNode.contains(e.target);return!(t||i)}};var $t=__dcg_shared_module_exports__['e'](te());var bu=__dcg_shared_module_exports__['e'](te());var LI=class extends bu.Class{init(){this.controller=this.props.controller()}template(){return bu.createElement("button",{class:()=>({"dcg-unstyled-button":!0,"dcg-constructions-count-link":!0,"dcg-icon-btn":!0,"dcg-active":this.controller.getShowConstructionsOpen(),"dcg-do-not-blur":!0}),handleEvent:bu.const("true"),"aria-expanded":()=>this.controller.getShowConstructionsOpen(),manageFocus:this.const(ft({controller:this.controller,location:{type:"geo-show-constructions-icon"}})),onTap:this.bindFn(this.showAllConstructions)},bu.createElement("i",{class:bu.const("dcg-icon-geometry"),"aria-label":()=>this.controller.s("graphing-calculator-narration-geometry-construction-icon-label")}),bu.createElement("span",{class:bu.const("dcg-construction-count")},()=>this.controller.getGeometryTokenCount()))}showAllConstructions(){this.controller.dispatch({type:"set-show-constructions-open",open:!this.controller.getShowConstructionsOpen(),setFocus:!1})}};var kl=__dcg_shared_module_exports__['e'](te());var Mw=class extends kl.Class{init(){this.controller=this.props.controller()}template(){return kl.createElement("div",{class:()=>({"dcg-btn-flat-gray":this.props.isPillbox(),"dcg-btn-flat-gray-group":this.props.isPillbox(),"dcg-group-horizontal":this.props.isPillbox()}),style:()=>({background:this.props.isPillbox()?this.controller.getPillboxBackgroundColor():void 0})},kl.createElement($e,{tooltip:()=>this.controller.getshowKeyboardShortcutsInTooltips()?this.controller.s("graphing-calculator-label-undo-with-shortcut-tooltip"):this.controller.s("graphing-calculator-label-undo-tooltip"),gravity:this.const("s"),disabled:()=>!this.controller.canUndo(),displayBlock:this.props.isPillbox},kl.createElement("button",{class:()=>({"dcg-unstyled-button":!0,"dcg-action-undo":!0,"dcg-icon-btn":!0,"dcg-pillbox-btn-interior":this.props.isPillbox(),"dcg-disabled":!this.controller.canUndo()}),tabindex:()=>this.controller.canUndo()?0:-1,"aria-label":()=>this.controller.s("graphing-calculator-narration-undo"),onTap:()=>this.controller.dispatch({type:"undo"}),"aria-disabled":()=>!this.controller.canUndo()},kl.createElement("i",{class:kl.const("dcg-icon-undo"),"aria-hidden":kl.const("true")}))),kl.createElement($e,{tooltip:()=>this.controller.getshowKeyboardShortcutsInTooltips()?this.controller.s("graphing-calculator-label-redo-with-shortcut-tooltip"):this.controller.s("graphing-calculator-label-redo-tooltip"),gravity:this.const("s"),disabled:()=>!this.controller.canRedo(),displayBlock:this.props.isPillbox},kl.createElement("button",{class:()=>({"dcg-unstyled-button":!0,"dcg-action-redo":!0,"dcg-icon-btn":!0,"dcg-pillbox-btn-interior":this.props.isPillbox(),"dcg-disabled":!this.controller.canRedo()}),tabindex:()=>this.controller.canRedo()?0:-1,"aria-label":()=>this.controller.s("graphing-calculator-narration-redo"),onTap:()=>this.controller.dispatch({type:"redo"}),"aria-disabled":()=>!this.controller.canRedo()},kl.createElement("i",{class:kl.const("dcg-icon-redo"),"aria-hidden":kl.const("true")}))))}};var yu=__dcg_shared_module_exports__['e'](te());qt();var PI=class extends yu.Class{init(){this.controller=this.props.controller()}toggleMuted(){var e;(e=this.controller.toneController)!=null&&e.isGlobalMuted()?this.controller.dispatch({type:"unmute-global"}):this.controller.dispatch({type:"mute-global"})}getMutedState(){return!this.controller.toneController||this.controller.toneController.isGlobalMuted()?"muted":"playing"}getAriaLabel(){switch(this.getMutedState()){case"playing":return this.controller.s("graphing-calculator-narration-mute-all");case"muted":return this.controller.s("graphing-calculator-narration-unmute-all")}}template(){return yu.createElement($e,{gravity:this.const("s"),tooltip:this.bindFn(this.getAriaLabel)},yu.createElement("button",{class:()=>{var e;return{"dcg-global-mute-button":!0,"dcg-unstyled-button":!0,"dcg-icon-btn":!0,"dcg-is-muted":this.getMutedState()==="muted","dcg-has-never-interacted":!((e=this.controller.toneController)!=null&&e.getHasEverInteractedWithMute())}},didMount:e=>ie(e).on("tipsyshow",()=>{var t;(t=this.controller.toneController)==null||t.registerMuteInteraction(),this.update()}),onTap:()=>this.toggleMuted(),manageFocus:this.const(ft({controller:this.controller,location:{type:"global-mute-button"}})),"aria-label":this.bindFn(this.getAriaLabel)},yu.createElement("span",{class:yu.const("dcg-first-time-animation")}),yu.createElement("i",{class:yu.const("dcg-icon-volume")})))}};var{If:xu}=$t.Components,PS=class extends $t.Class{init(){this.controller=this.props.controller()}template(){return $t.createElement("div",{class:()=>({"dcg-expression-top-bar":!0,"dcg-expressions-scrolled":this.showShadow()}),role:$t.const("toolbar"),"aria-label":()=>this.controller.s("graphing-calculator-narration-expression-bar"),didMount:e=>{this.node=e},onTapStart:this.bindFn(this.clearSelectionOnMobile),style:()=>({background:this.controller.hasBackgroundColor()?this.controller.getPillboxBackgroundColor():void 0})},$t.createElement(xu,{predicate:this.bindFn(this.showHamburger)},()=>$t.createElement("button",{class:$t.const("dcg-unstyled-button dcg-action-opendrawer dcg-tooltip dcg-icon-btn dcg-in-api-action-opendrawer"),handleEvent:$t.const("true"),tooltip:()=>this.controller.getshowKeyboardShortcutsInTooltips()?this.controller.s("graphing-calculator-label-open-graph-with-shortcut-tooltip"):this.controller.s("graphing-calculator-label-open-graph-tooltip"),"aria-label":()=>this.controller.s("graphing-calculator-narration-open-graph"),onTap:()=>this.controller.dispatch({type:"open-drawer"})},$t.createElement("i",{class:$t.const("dcg-icon-hamburger"),"aria-hidden":$t.const("true")}))),$t.createElement(xu,{predicate:()=>!this.controller.isInEditListMode()},()=>$t.createElement(LS,{controller:()=>this.props.controller()})),$t.createElement(xu,{predicate:()=>this.controller.isGeoUIActive()&&!this.controller.isInEditListMode()},()=>$t.createElement(LI,{controller:this.props.controller})),$t.createElement(xu,{predicate:this.bindFn(this.showMuteButton)},()=>$t.createElement(PI,{controller:this.props.controller})),$t.createElement(xu,{predicate:this.bindFn(this.showRerandomize)},()=>$t.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-randomize-tooltip"),gravity:this.const("s")},$t.createElement("button",{class:$t.const("dcg-unstyled-button dcg-icon-btn"),handleEvent:$t.const("true"),"aria-label":()=>this.controller.s("graphing-calculator-label-randomize-tooltip"),onTap:()=>this.controller.dispatch({type:"re-randomize"})},$t.createElement("i",{class:$t.const("dcg-icon-randomize"),"aria-hidden":$t.const("true")})))),$t.createElement(xu,{predicate:()=>this.controller.isInEditListMode()&&!this.controller.hasDefaultState()},()=>$t.createElement("button",{class:$t.const("dcg-unstyled-button dcg-btn-red dcg-action-clearall"),onTap:()=>this.controller.dispatch({type:"clear-graph"})},()=>this.controller.s("graphing-calculator-button-clear-graph"))),$t.createElement(xu,{predicate:()=>this.controller.isInEditListMode()&&this.controller.hasDefaultState()},()=>$t.createElement("button",{class:$t.const("dcg-unstyled-button dcg-btn-red dcg-action-reset"),onTap:()=>this.controller.dispatch({type:"reset-graph"})},()=>this.controller.s("graphing-calculator-button-reset-graph"))),$t.createElement("div",{class:$t.const("dcg-center-buttons")},$t.createElement(Mw,{...this.props,isPillbox:this.const(!1)})),$t.createElement(xu,{predicate:()=>!this.controller.isInEditListMode()},()=>$t.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-edit-list-tooltip"),gravity:this.const("s")},$t.createElement("button",{class:$t.const("dcg-unstyled-button dcg-icon-btn dcg-action-toggle-edit"),handleEvent:$t.const("true"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-expression-list"),onTap:this.bindFn(this.toggleEditListMode),manageFocus:this.const(ft({controller:this.controller,location:{type:"edit-list-toggle"}}))},$t.createElement("i",{class:$t.const("dcg-icon-settings"),"aria-hidden":$t.const("true")})))),$t.createElement(xu,{predicate:()=>this.controller.isInEditListMode()},()=>$t.createElement("button",{class:$t.const("dcg-unstyled-button dcg-btn-primary dcg-action-toggle-edit dcg-do-not-blur"),handleEvent:$t.const("true"),onTap:this.bindFn(this.toggleEditListMode),manageFocus:this.const(ft({controller:this.controller,location:{type:"edit-list-toggle"}}))},()=>this.controller.s("graphing-calculator-button-done"))),$t.createElement(xu,{predicate:()=>!this.controller.isInEditListMode()&&this.controller.getGraphSettings().config.graphpaper},()=>$t.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-hide-expression-list-tooltip"),gravity:this.const("s")},$t.const(" "),$t.createElement("button",{class:()=>({"dcg-unstyled-button":!0,"dcg-resize-list-btn":!0,"dcg-action-hideexpressions":!0,"dcg-icon-btn":!0,"dcg-rotated":this.controller.isNarrow()}),"aria-label":()=>this.controller.s("graphing-calculator-label-hide-expression-list-tooltip"),onTap:e=>{this.controller.dispatch({type:"hide-expressions-list",focusShowIcon:e.device==="keyboard"})},manageFocus:this.const(ft({controller:this.controller,location:{type:"hide-expression-list-btn"}}))},$t.createElement("i",{class:$t.const("dcg-icon-hide"),"aria-hidden":$t.const("true")})))))}showShadow(){return this.controller.getTickerOpen()||this.controller.getExpressionSearchOpen()?!1:this.props.expsScrolled()}showRerandomize(){return this.controller.isInEditListMode()?!1:this.controller.anyItemDependsOnRandomSeed()}showHamburger(){return!this.controller.getGraphSettings().config.showHamburger||this.controller.isInEditListMode()?!1:!this.controller.isNarrow()}clearSelectionOnMobile(e){e.wasHandled()||this.controller.dispatch({type:"set-none-selected"})}toggleEditListMode(e){this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:!this.controller.isInEditListMode(),focusExpressionList:!1}),e.device==="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"edit-list-toggle"}})}showMuteButton(){return this.controller.isInEditListMode()?!1:this.controller.toneItemsExist()}};function QY(r){let e=__dcg_shared_module_exports__['Z'](Wd(r));return e.graph.product="geometry-calculator",e}async function _I(r,e,t){let i=!1;r.dispatch({type:"toast/show",toast:{message:r.s("graphing-calculator-text-toast-importing-graph"),hideAfter:0,toastStyle:"cover",onHide:()=>{i=!0}}});let o=()=>{i||r.dispatch({type:"toast/show",toast:{message:r.s("graphing-calculator-text-toast-error-importing-graph"),toastStyle:"error",hideAfter:12e3}})},n=()=>{r.dispatch({type:"toast/show",toast:{message:r.s("graphing-calculator-text-toast-error-no-folders"),toastStyle:"error",hideAfter:12e3}})},a=(l,c)=>{r.dispatch({type:"set-state",state:l}),r.dispatch({type:"toast/show",toast:{message:r.s("graphing-calculator-text-toast-imported-graph"),undoCallback:()=>{r.dispatch({type:"set-state",state:c})}}})},s=(l,c,d)=>{if(i)return;let p=r.getSelectedItem();if(!p)return;let g=p.type==="folder",h=p.type!=="folder"&&!!p.folderId,f=g||h,y={},x=r.getState(),E=x.expressions.list;if(E.length===1&&!g&&!r.isGeometry()){a(l,x);return}if(r.isGeometry()&&d!=="graphing"){a(l,x);return}let C=l.expressions.list;d==="graphing"&&Array.isArray(C)&&(C=C.filter(I=>I.id!==__dcg_shared_module_exports__['jd']));for(let I=0;I<C.length;I++){let P=r.generateId(),_=C[I];if(_.type==="folder")if(f){n();return}else{y[_.id]=P,_.id=P;continue}_.folderId?_.folderId=y[_.folderId]:g?_.folderId=p.id:h&&(_.folderId=p.folderId),_.id=P}let S=__dcg_shared_module_exports__['Z'](x),v=0;for(;v<E.length;){if(E[v].id===p.id){g&&(E[v].title=c);break}v+=1}let M=g?v+1:v,A=g?0:1;E.splice(M,A,...C),a(x,S)};try{let l=await fetch(`${e}?${new URLSearchParams(Ip)}`,{headers:{Accept:"application/json"}});if(!l.ok)throw void 0;let c=await l.json(),d=c.state,p=B9(e);r.isGeometry()&&(p==="geometry"?d=fh(d):p==="graphing"&&(d=QY(d))),d=Wd(d),t(d,(g,h)=>{g||!h||!p?o():s(h,c.title||"",p)})}catch(l){o()}}function ZY(r){if(window.clipboardData&&window.clipboardData.getData)return window.clipboardData.getData("Text");if(r&&r.clipboardData&&r.clipboardData.getData)return r.clipboardData.getData("text/plain")}var _h=__dcg_shared_module_exports__['e'](te());qt();var{If:yue}=_h.Components,OI=class extends _h.Class{init(){this.guid=__dcg_shared_module_exports__['K']("dcg-exp-list-resize")}template(){return _h.createElement(yue,{predicate:this.bindFn(this.isVisible)},()=>_h.createElement("div",{class:_h.const("dcg-exp-list-resizer"),onTapStart:this.bindFn(this.onTapStart)}))}isVisible(){return this.props.controller().expressionsAreFullWidth()?!1:this.props.controller().isListVisible()}onTapStart(e){this.initialWidth=this.props.controller().getExpListWidth(),this.initialLeft=e.changedTouches[0].clientX,ie(document).on(`dcg-tapmove.${this.guid}`,t=>{if(this.initialLeft===void 0||this.initialWidth===void 0)return;let i=t.changedTouches[0].clientX-this.initialLeft+this.initialWidth;this.props.controller().dispatch({type:"resize-exp-list",expListWidth:i})}),ie(document).on(`dcg-tapend.${this.guid}`,this.bindFn(this.onTapEnd)),ie(document).on(`dcg-tapcancel.${this.guid}`,this.bindFn(this.onTapEnd))}onTapEnd(){ie(document).off(`.${this.guid}`),this.initialLeft=void 0,this.initialWidth=void 0}};var kr=__dcg_shared_module_exports__['e'](te());var{If:_S}=kr.Components,RI=class extends kr.Class{constructor(){super(...arguments),this.justGlobalReplaced=!1}init(){this.controller=this.props.controller()}template(){return kr.createElement("div",{class:()=>({"dcg-expression-search-bar":!0,"dcg-expressions-scrolled":this.props.expsScrolled()&&!this.controller.getTickerOpen()}),role:kr.const("search")},kr.createElement("div",{class:kr.const("dcg-search-row")},kr.createElement("div",{class:kr.const("dcg-search-mathquill-container")},kr.createElement(Ze,{hasError:this.const(!1),getAriaLabel:()=>this.controller.s("graphing-calculator-label-search-expressions"),getAriaPostLabel:()=>this.controller.getExpressionSearchStr().length===0?this.controller.raw(""):this.shouldShowReplaceError()?this.controller.s("graphing-calculator-error-expression-replacement"):this.shouldShowSearchError()?this.controller.s("graphing-calculator-error-expression-search"):this.controller.s("shared-calculator-text-search-results",{count:new on(this.controller.getExpressionSearchCount())}),capExpressionSize:this.const(!1),onUserChangedLatex:this.bindFn(this.onSearchChange),latex:()=>this.controller.getRawExpressionSearchStr(),isFocused:this.bindFn(this.isSearchFocused),config:this.bindFn(this.getMQConfig),onFocusedChanged:this.bindFn(this.onSearchFocusChanged),noFadeout:this.const(!0),onUserPressedKey:(e,t)=>{if(e==="Esc")t&&t.preventDefault(),this.closeSearch();else if(e==="Enter")t&&t.preventDefault(),this.onEnter();else if(e==="Down"){let o=Ze.getFocusedMathquill();return!o||!Ze.applyArrowKeyAndReturnIfWasAtBounds(o,e,t)?void 0:this.controller.dispatch({type:"on-special-key-pressed",key:e})}else{var i=Ze.getFocusedMathquill();if(!i)return;i.keystroke(e,t),this.controller.getRawExpressionSearchStr()!==i.latex()&&(this.justGlobalReplaced=!1,this.onSearchChange(i.latex()))}}}),kr.createElement("i",{class:kr.const("dcg-icon-search"),"aria-hidden":kr.const("true")}),kr.createElement(_S,{predicate:()=>this.controller.getRawExpressionSearchStr().length===0},()=>kr.createElement("span",{class:kr.const("dcg-search-placeholder")},()=>this.controller.s("graphing-calculator-label-search-expressions"))),kr.createElement(_S,{predicate:()=>this.shouldShowSearchError()},()=>kr.createElement("span",{class:kr.const("dcg-search-replace-icon-container")},kr.createElement($a,{error:()=>this.controller.s("graphing-calculator-error-expression-search"),gravity:this.const("s"),size:this.const("small")}))),kr.createElement(_S,{predicate:()=>this.controller.isSearchReplaceValid()&&!this.justGlobalReplaced},()=>kr.createElement("span",{class:kr.const("dcg-search-replace-icon-container")},kr.createElement("i",{class:kr.const("dcg-icon-replace"),role:kr.const("button"),tabindex:kr.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-button-replace"),onTap:this.bindFn(this.onGlobalReplace)}))),kr.createElement(_S,{predicate:()=>this.justGlobalReplaced},()=>kr.createElement("span",{class:kr.const("dcg-search-replace-icon-container")},kr.createElement("i",{class:kr.const("dcg-icon-check"),"aria-hidden":kr.const("true")}))),kr.createElement(_S,{predicate:()=>this.shouldShowReplaceError()},()=>kr.createElement("span",{class:kr.const("dcg-search-replace-icon-container")},kr.createElement($a,{error:()=>this.controller.s("graphing-calculator-error-expression-replacement"),gravity:this.const("s"),size:this.const("small")})))),kr.createElement("i",{onTap:()=>this.closeSearch(),tabindex:kr.const("0"),"aria-label":()=>this.controller.s("account-shell-button-cancel"),role:kr.const("button"),class:kr.const("dcg-icon-remove dcg-do-not-blur")})))}onGlobalReplace(){this.justGlobalReplaced=!0,setTimeout(this.bindIfMounted(()=>{this.justGlobalReplaced=!1,this.update()}),1500),this.controller.dispatch({type:"rename-identifier-global",search:this.controller.getExpressionSearchStr(),replace:this.controller.getExpressionReplaceStr()})}onEnter(){this.controller.isSearchReplaceValid()?this.onGlobalReplace():this.controller.dispatch({type:"update-expression-search-str",str:this.controller.getRawExpressionSearchStr()})}shouldShowSearchError(){return!this.controller.getIsExpressionSearchStrValidForReplace()&&this.controller.getExpressionReplaceStr().length>0}shouldShowReplaceError(){return!this.shouldShowSearchError()&&!this.controller.getIsExpressionReplaceStrValidForReplace()&&this.controller.getExpressionReplaceStr().length>0}closeSearch(){this.controller.dispatch({type:"close-expression-search"})}onSearchChange(e){this.controller.dispatch({type:"update-expression-search-str",str:e})}onSearchFocusChanged(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"search-expressions"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"search-expressions"}})}isSearchFocused(){let e=this.controller.getFocusLocation();return!!e&&e.type==="search-expressions"}onReplaceChange(e){this.controller.dispatch({type:"update-expression-replace-str",str:e})}onReplaceFocusChanged(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"replace-expressions"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"replace-expressions"}})}isReplaceFocused(){let e=this.controller.getFocusLocation();return!!e&&e.type==="replace-expressions"}getMQConfig(){return this.controller.getMathquillConfig({additionalOperators:["label","rename","image"]})}};var Cr=__dcg_shared_module_exports__['e'](te());var{If:eX,IfDefined:xue}=Cr.Components,FI=class extends Cr.Class{init(){this.controller=this.props.controller()}template(){return Cr.createElement("div",{class:()=>({"dcg-ticker":!0,"dcg-expressions-scrolled":this.props.expsScrolled()})},Cr.createElement("div",{class:Cr.const("dcg-ticker-settings-container")},Cr.createElement("div",{class:Cr.const("dcg-ticker-settings-internal")},Cr.createElement("div",{class:Cr.const("dcg-editable-mathquill-container dcg-action-definition")},Cr.createElement("span",{class:Cr.const("dcg-ticker-label")},()=>this.controller.raw("Run")),Cr.createElement(Ze,{hasError:()=>!!this.getHandlerErrorString(),getAriaPostLabel:()=>{let e=this.getHandlerErrorString();return e?this.controller.unpack(e):""},capExpressionSize:this.const(!1),onUserChangedLatex:e=>this.dispatchHandlerLatexIfChanged(e),latex:()=>this.getHandlerLatex(),getAriaLabel:()=>this.controller.s("graphing-calculator-narration-tick-action"),isFocused:()=>this.getFocusedInput()==="handler",config:()=>this.getMQConfig(),onFocusedChanged:e=>this.handleFocusedChanged("handler",e),selectOnFocus:this.const(!0),noFadeout:this.const(!0),onUserPressedKey:(e,t)=>{this.handlePressedKey("handler",e,t)}}),xue(()=>this.getHandlerErrorString(),e=>Cr.createElement("span",{class:Cr.const("dcg-clickable-info-error-container")},Cr.createElement($a,{error:()=>this.controller.unpack(e()),gravity:this.const("s"),size:this.const("small")})))),Cr.createElement("div",{class:Cr.const("dcg-editable-mathquill-container dcg-action-frequency")},Cr.createElement("span",{class:Cr.const("dcg-ticker-label")},()=>this.controller.raw("every")),Cr.createElement(Ze,{hasError:()=>!!this.getMinStepErrorString(),getAriaPostLabel:()=>{let e=this.getMinStepErrorString();return e?this.controller.unpack(e):""},capExpressionSize:this.const(!1),onUserChangedLatex:e=>this.dispatchMinStepLatexIfChanged(e),latex:()=>this.getMinStepLatex(),getAriaLabel:()=>this.controller.s("graphing-calculator-label-ticker-min-step"),isFocused:()=>this.getFocusedInput()==="minstep",config:this.bindFn(this.getMQConfig),onFocusedChanged:e=>this.handleFocusedChanged("minstep",e),selectOnFocus:this.const(!0),placeholder:this.const("0"),noFadeout:this.const(!0),onUserPressedKey:(e,t)=>{this.handlePressedKey("minstep",e,t)}}),()=>this.controller.raw("ms"),Cr.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-ticker-help-tooltip"),gravity:this.const("s")},Cr.createElement("a",{"aria-label":()=>this.controller.s("graphing-calculator-label-ticker-help-tooltip"),class:Cr.const("dcg-ticker-toggle-help"),target:Cr.const("_blank"),href:Cr.const("https://help.desmos.com/hc/en-us/articles/4407725009165#h_01FB2RZQRYM62C3EB94H2TRRAX")},Cr.createElement("i",{class:Cr.const("dcg-icon-question-sign"),"aria-hidden":Cr.const("true")})))),Cr.createElement(eX,{predicate:this.bindFn(this.shouldShowSliderPrompt)},()=>Cr.createElement(op,{model:()=>this.props.controller().getTicker(),controller:this.props.controller}))),Cr.createElement("div",{class:()=>({"dcg-circular-icon-container":!0,"dcg-disabled":this.iconDisabled()}),"aria-label":this.bindFn(this.getIconAriaLabel),role:Cr.const("button"),tabindex:()=>this.iconDisabled()?-1:0,"aria-disabled":this.bindFn(this.iconDisabled),"aria-pressed":()=>this.controller.getTickerPlaying()&&!this.iconDisabled(),onTap:this.bindFn(this.toggleTicker),onTapStart:()=>{pi()}},Cr.createElement(yn,{iconType:this.const("metronome")}),Cr.createElement("div",{class:()=>({"dcg-metronome-bar":!0,"dcg-metronome-playing":this.controller.getTickerPlaying()&&!this.iconDisabled()})}),Cr.createElement(eX,{predicate:()=>!this.iconDisabled()},()=>Cr.createElement("div",{class:Cr.const("dcg-mini-play-pause")},Cr.createElement(yn,{iconType:this.bindFn(this.getPlayIcon)}))))),Cr.createElement("i",{onTap:this.bindFn(this.closeTicker),tabindex:()=>this.controller.isInEditListMode()?0:-1,"aria-label":()=>this.controller.s("graphing-calculator-label-ticker-close"),role:Cr.const("link"),class:Cr.const("dcg-icon-remove dcg-do-not-blur")}))}iconDisabled(){return!!(this.getMinStepErrorString()||this.getHandlerErrorString()||!this.isHandlerMaybeValid())}isHandlerMaybeValid(){var t;return((t=this.controller.getTicker().formula)==null?void 0:t.handler.status)==="maybe-valid"}closeTicker(){this.controller.dispatch({type:"close-ticker"})}toggleTicker(){this.iconDisabled()||this.controller.dispatch({type:"toggle-ticker"})}getPlayIcon(){return this.controller.getTickerPlaying()?"pause":"play"}getIconAriaLabel(){return this.controller.getTickerPlaying()?this.controller.s("graphing-calculator-label-ticker-pause"):this.controller.s("graphing-calculator-label-ticker-play")}getFocusedInput(){let e=this.controller.getFocusLocation();if(!(!e||e.type!=="ticker"))return e.location}handlePressedKey(e,t,i){let o=Ze.getFocusedMathquill();if(o){if(t==="Enter"&&this.shouldShowSliderPrompt()&&this.controller.dispatch({type:"create-sliders-for-ticker",variables:SC(this.props.controller().getTicker())}),t==="Esc"&&this.controller.getExpressionSearchOpen()&&this.controller.dispatch({type:"close-expression-search"}),t==="Right"&&e==="handler"||t==="Left"&&e==="minstep"||t==="Down"||t==="Up"){var n=Ze.applyArrowKeyAndReturnIfWasAtBounds(o,t,i);if(!n)return;if(t==="Down"||t==="Up")return this.controller.dispatch({type:"on-special-key-pressed",key:t});if(t==="Right"){this.handleFocusedChanged("minstep",!0);return}else if(t==="Left"){this.handleFocusedChanged("handler",!0);return}}o.keystroke(t,i),e==="handler"?this.dispatchHandlerLatexIfChanged(o.latex()):e==="minstep"&&this.dispatchMinStepLatexIfChanged(o.latex())}}handleFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"ticker",location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"ticker",location:e}})}dispatchHandlerLatexIfChanged(e){this.getHandlerLatex()!==e&&this.controller.dispatch({type:"update-ticker-handlerlatex",latex:e})}dispatchMinStepLatexIfChanged(e){this.getMinStepLatex()!==e&&this.controller.dispatch({type:"update-ticker-minsteplatex",latex:e})}getHandlerLatex(){return this.controller.getTickerHandlerLatex()}getMinStepLatex(){return this.controller.getTickerMinStepLatex()}getMQConfig(){return this.controller.getMathquillConfig({additionalOperators:["dt"]})}getHandlerErrorString(){return this.getHandlerLatex()?dK(this.controller.getTicker()):void 0}getMinStepErrorString(){return pK(this.controller.getTicker())}shouldShowSliderPrompt(){return this.controller.areSlidersEnabled()?SC(this.controller.getTicker()).length>0:!1}};var Ia=__dcg_shared_module_exports__['e'](te());var{For:tX,If:wue}=Ia.Components,NI=class extends Ia.Class{init(){this.controller=this.props.controller(),this.currentlyInspectedDepth=1/0,this.cachedTokenDepths={depths:{},isInvalid:!1},this.updateCachedTokenDepthInfo()}willUpdate(){this.updateCachedTokenDepthInfo()}updateCachedTokenDepthInfo(){let e="",t=!1,i=this.controller.getFocusLocation();if(i&&i.type==="expression"){let n=this.controller.getFocusedItem();(n==null?void 0:n.type)==="expression"&&(e=n.id,t=!!n.error&&n.latex!==""||!!n.formula.variables.length)}if(this.cachedTokenDepths.focusedExpressionBeforeError==e&&t){this.cachedTokenDepths.isInvalid=!0;return}this.cachedTokenDepths={depths:this.controller.cachedGeoTokenDepths,isInvalid:!1,focusedExpressionBeforeError:t?void 0:e}}template(){return Ia.createElement("div",{class:()=>({"dcg-geo-show-constructions-pane":!0,"dcg-transient-error":this.cachedTokenDepths.isInvalid,"dcg-cant-drag-item":!!this.controller.getDraggedItemId()&&!this.controller.canDraggedItemBeMovedIntoTokenPane()}),"aria-label":()=>this.controller.s("graphing-calculator-narration-geometry-token-navigator-label"),role:Ia.const("region"),didUnmount:()=>this.lastFocusedIdentifier=void 0,onKeydown:this.bindFn(this.handleKeydown)},Ia.createElement(wue,{predicate:()=>this.controller.getGeometryTokenCount()===0},()=>Ia.createElement("div",{class:Ia.const("dcg-empty-constructions")},()=>this.controller.s("graphing-calculator-text-geometry-no-constructed-objects"))),Ia.createElement(tX,{each:this.bindFn(this.getObjectDepths)},Ia.createElement("div",{class:Ia.const("dcg-displayed-sections-container")},e=>Ia.createElement("div",{class:()=>({"dcg-displayed-section-level":!0,"dcg-selected-level":parseInt(e)===this.getCurrentlyInspectedDepth(),"dcg-below-the-line":parseInt(e)>this.getCurrentlyInspectedDepth()})},Ia.createElement(tX,{each:()=>this.getTokensForDepth(e),key:(t,i)=>i},Ia.createElement("span",{role:Ia.const("listbox"),"aria-label":()=>this.controller.s("graphing-calculator-narration-geometry-token-navigator-depth",{depth:e})},(t,i)=>Ia.createElement("span",{class:()=>({"dcg-token-being-dragged-container":this.isTokenBeingDragged(e,i)}),onTapStart:o=>{let n=this.getCalcIdForDepth(e,i),a=this.controller.getItemModel(n);!a||a.type!=="expression"||this.controller.isItemInGeoFolder(a.id)&&this.props.onDragPending(o,{type:"token",calcId:n,originalIndex:a.index})}},Ia.createElement($p,{showParentChildrenHover:this.const(!0),controller:this.props.controller,identifier:()=>this.getIdentifierForDepth(e,i),insideMQ:this.const(!1),insideGroup:this.const(!0),focusLocation:()=>({type:"geo-token",identifier:this.getIdentifierForDepth(e,i)}),putInTabOrder:()=>{if(this.lastFocusedIdentifier===void 0){let o=this.getObjectDepths();this.lastFocusedIdentifier=this.getIdentifierForDepth(o[0],0)}return this.lastFocusedIdentifier===this.getIdentifierForDepth(e,i)}}))))))))}isTokenBeingDragged(e,t){let i=this.controller.getDraggedItemId();if(!i)return!1;if(this.controller.isItemInGeoFolder(i))return i==this.getCalcIdForDepth(e,t)}getCurrentlyInspectedDepth(){return Math.min(this.currentlyInspectedDepth,this.getObjectDepths().length-1)}getIdentifierForDepth(e,t){var i=this.getTokensForDepth(e)[t];return i?i.identifier:""}getCalcIdForDepth(e,t){var i=this.getTokensForDepth(e)[t];return i?i.calcId:""}getTokensForDepth(e){let{depths:t}=this.cachedTokenDepths;var i=t[e];return i||[]}getObjectDepths(){let e=Object.keys(this.cachedTokenDepths.depths);return e.sort((t,i)=>{let o=parseInt(t),n=parseInt(i);return isFinite(o)?isFinite(n)?o-n:1:-1}),e}selectItemIfNecessary(){if(this.controller.hasAnyItemsSelected())return;let e=this.controller.getFocusLocation();if((e==null?void 0:e.type)!=="geo-token")return;let{calcId:t}=this.controller.cachedGeoTokenInfo[e.identifier];!t||!this.controller.getItemModel(t)||this.controller.dispatch({type:"set-selected-id",id:t})}handleKeydown(e){let t=this.controller.getFocusLocation(),i=Be(e),o=ji(e);if(e.ctrlKey&&e.shiftKey&&!e.altKey&&!e.metaKey&&o==="O"){e.preventDefault(),e.stopPropagation(),this.selectItemIfNecessary(),this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"multi-select-more",guid:Lf(),focusFirstOption:!0,previousFocusLocation:t}});return}if(e.altKey&&!e.ctrlKey&&!e.metaKey&&e.shiftKey&&o==="T"){if(e.preventDefault(),e.stopPropagation(),(t==null?void 0:t.type)!=="geo-token")return;let{calcId:g}=this.controller.cachedGeoTokenInfo[t.identifier];if(!g)return;let h=this.controller.getItemModel(g);if(!Xc(h))return;this.controller.convertToNamedAssignment(h),Ba(h,""),this.controller.dispatch({type:"set-none-selected"}),this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:h.id}});return}if(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return;if(i==="Esc"){e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-show-constructions-open",open:!1,setFocus:!0});return}if(i!=="Up"&&i!=="Down"&&i!=="Left"&&i!=="Right")return;e.preventDefault(),e.stopPropagation();let n=this.getObjectDepths();if(n.length===0)return;let a="";if(t&&t.type==="geo-token")a=t.identifier;else{let g=this.getTokensForDepth(n[0])[0];if(!g)return;a=g.identifier}if(a==="")return;let s,l=-1,c=[];for(s=0;s<n.length;s++){let g=n[s];if(c=this.getTokensForDepth(g),!!c&&(l=__dcg_shared_module_exports__['w'](c,{identifier:a}),l!==-1))break}if(s===-1||l===-1)return;i==="Up"?s=Math.max(s-1,0):i==="Down"?s=Math.min(s+1,n.length-1):i==="Left"?l=Math.max(l-1,0):i==="Right"&&(l=Math.min(l+1,c.length-1));let d=this.getTokensForDepth(n[s]);if(!d)return;l=Math.min(l,d.length-1);let p=d[l].identifier;this.controller.dispatch({type:"set-focus-location",location:{type:"geo-token",identifier:p}}),this.lastFocusedIdentifier=p}};var Cn=__dcg_shared_module_exports__['e'](te());var rX=__dcg_shared_module_exports__['e'](te());var vn=class extends rX.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}getFocusedInput(){let e=this.controller.getFocusLocation(),t=this.model.type==="table-column"?this.model.table.id:this.id;if(!(!e||e.type!=="expression-menu"||e.id!==t))return e.location}handleFocusedChanged(e,t){let i=this.model.type==="table-column"?this.model.table.id:this.id;e?this.controller.dispatch({type:"set-focus-location",location:{type:"expression-menu",id:i,location:t}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"expression-menu",id:i,location:t}})}onColorSelected(e){this.model.type!=="image"&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-color",id:this.id,color:e}):this.controller.dispatch({type:"set-tablecolumn-color",color:e,tableId:this.model.table.id,columnId:this.id}))}onCustomColorSelected(e){this.model.type!=="image"&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-colorlatex",id:this.id,colorLatex:e}):this.controller.dispatch({type:"set-tablecolumn-colorlatex",tableId:this.model.table.id,columnId:this.model.id,colorLatex:e}))}getModelColor(){return this.model.type==="image"?"":Ud(this.model)}};var ui=__dcg_shared_module_exports__['e'](te());var Oh=__dcg_shared_module_exports__['e'](te()),yo=class extends Oh.Class{template(){return Oh.createElement("div",{class:()=>({"dcg-toggle-view":!0,"dcg-toggled":this.props.toggled()}),"aria-label":()=>this.props.ariaLabel(),role:Oh.const("checkbox"),tabindex:Oh.const("0"),"aria-checked":()=>this.props.toggled(),toggled:()=>this.props.toggled(),onTap:this.bindFn(this.props.onChange)},Oh.createElement("div",{class:Oh.const("dcg-toggle-switch")}))}};var{If:i3}=ui.Components,Iw=class extends vn{template(){return ui.createElement("div",{class:ui.const("dcg-options-menu-section")},ui.createElement("div",{class:ui.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-lines"),ui.createElement(yo,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-lines-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleLinesVisible)})),ui.createElement(i3,{predicate:()=>this.props.isOpen()},()=>ui.createElement("div",{class:ui.const("dcg-options-menu-content")},ui.createElement("div",{class:ui.const("dcg-options-flex-container")},ui.createElement("div",{class:ui.const("dcg-options-left-side")},ui.createElement("div",{class:ui.const("dcg-iconed-mathquill-row dcg-line-opacity-row")},ui.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-opacity-tooltip"),sticky:this.const(!0),gravity:this.const("s")},ui.createElement("i",{class:ui.const("dcg-icon-opacity"),"aria-hidden":ui.const("true")})),ui.createElement(_r,{latex:()=>this.model.lineOpacity,placeholder:this.bindFn(this.getLineOpacity),isFocused:()=>this.getFocusedInput()==="lineopacity",ariaPostLabel:()=>this.isLineOpacityValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-line-opacity"),hasError:()=>!this.isLineOpacityValid(),handleLatexChanged:this.bindFn(this.dispatchLineOpacityLatexIfChanged),dataLabelAttributeValue:this.const("line-opacity"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"lineopacity")})),ui.createElement("div",{class:ui.const("dcg-iconed-mathquill-row dcg-line-thickness-row")},ui.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-line-thickness-tooltip"),sticky:this.const(!0),gravity:this.const("s")},ui.createElement("i",{class:ui.const("dcg-icon-line-thickness"),"aria-hidden":ui.const("true")})),ui.createElement(_r,{latex:()=>this.model.lineWidth,placeholder:this.bindFn(this.getLineWidth),isFocused:()=>this.getFocusedInput()==="linewidth",ariaPostLabel:()=>this.isLineWidthValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-label-line-thickness-tooltip"),hasError:()=>!this.isLineWidthValid(),handleLatexChanged:this.bindFn(this.dispatchLineWidthLatexIfChanged),dataLabelAttributeValue:this.const("line-width"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"linewidth")}))),ui.createElement("div",{class:ui.const("dcg-options-right-side")},ui.createElement(i3,{predicate:this.bindFn(this.shouldShowLineStyles)},()=>ui.createElement(Xi,{staticConfig:this.bindFn(this.getPointStyleOptions),ariaGroupLabel:()=>this.controller.s("graphing-calculator-heading-style"),theme:this.const("mini")})))),ui.createElement(i3,{predicate:this.props.isFirstOpenSection},()=>ui.createElement(Da,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected)})))))}getLineWidth(){return this.isGeometryPolygon()?""+1.5:""+2.5}getLineOpacity(){return""+1}isGeometryPolygon(){return this.controller.isGeometry()&&this.model.type==="expression"&&vg(this.model)}getPointStyleOptions(){return["SOLID","DASHED","DOTTED"].map(t=>({key:t,icon:()=>this.getStyleIcon(t),ariaLabel:()=>this.getStyleAria(t),selected:()=>this.model.lineStyle===t,class:()=>"dcg-line-segmented-option",onSelect:()=>{this.onLineStyleSelected(t)}}))}getStyleIcon(e){switch(e){case"SOLID":return"dcg-icon-line-solid";case"DASHED":return"dcg-icon-line-dashed";case"DOTTED":return"dcg-icon-line-dotted"}}getStyleAria(e){let t=this.controller.s;switch(e){case"SOLID":return t("graphing-calculator-narration-line-style-solid");case"DASHED":return t("graphing-calculator-narration-line-style-dashed");case"DOTTED":return t("graphing-calculator-narration-line-style-dotted")}}isLineOpacityValid(){return this.model.type==="expression"?h8(this.model):this.model.type==="table-column"?xq(this.model):!1}isLineWidthValid(){return this.model.type==="expression"?oG(this.model):this.model.type==="table-column"?wq(this.model):!1}dispatchLineOpacityLatexIfChanged(e){this.model.lineOpacity!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-lineopacity",id:this.id,lineOpacity:e}):this.controller.dispatch({type:"set-tablecolumn-lineopacity",tableId:this.model.table.id,columnId:this.model.id,lineOpacity:e}))}shouldShowLineStyles(){return!(this.model.type==="expression"&&_p(this.model))}onLineStyleSelected(e){this.model.lineStyle!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-linestyle",id:this.id,lineStyle:e}):this.controller.dispatch({type:"set-tablecolumn-linestyle",tableId:this.model.table.id,columnId:this.model.id,lineStyle:e}))}dispatchLineWidthLatexIfChanged(e){this.model.lineWidth!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-linewidth",id:this.id,lineWidth:e}):this.controller.dispatch({type:"set-tablecolumn-linewidth",tableId:this.model.table.id,columnId:this.model.id,lineWidth:e}))}toggleLinesVisible(){this.model.type==="expression"?this.controller.dispatch({type:"set-item-lines",id:this.id,lines:!this.props.isOpen()}):this.controller.dispatch({type:"set-tablecolumn-lines",tableId:this.model.table.id,columnId:this.model.id,bool:!this.props.isOpen()})}};var OS=__dcg_shared_module_exports__['e'](te());var BI=class extends vn{template(){return OS.createElement("div",{class:OS.const("dcg-options-menu-section")},OS.createElement(Da,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected),customColorVisibility:()=>this.model.type==="expression"&&zy(this.model)?"hidden":"visible"}))}};var Qn=__dcg_shared_module_exports__['e'](te());var{If:o3}=Qn.Components,UI=class extends vn{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return Qn.createElement("div",{class:Qn.const("dcg-options-menu-section")},Qn.createElement("div",{class:Qn.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-fill"),Qn.createElement(o3,{predicate:()=>!this.isInequality()},()=>Qn.createElement(yo,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-fill-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleFillVisible)}))),Qn.createElement(o3,{predicate:this.props.isOpen},()=>Qn.createElement("div",{class:Qn.const("dcg-options-menu-content")},Qn.createElement("div",{class:Qn.const("dcg-iconed-mathquill-row dcg-fill-opacity-row")},Qn.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-opacity-tooltip"),sticky:this.const(!0),gravity:this.const("s")},Qn.createElement("i",{class:Qn.const("dcg-icon-opacity"),"aria-hidden":Qn.const("true")})),Qn.createElement(_r,{latex:()=>this.model.fillOpacity,placeholder:this.bindFn(this.getFillOpacity),isFocused:()=>this.getFocusedInput()==="opacity",ariaPostLabel:()=>H_(this.model)?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-fill-opacity"),hasError:()=>!H_(this.model),handleLatexChanged:this.bindFn(this.dispatchOpacityLatexIfChanged),dataLabelAttributeValue:this.const("fill-opacity"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"opacity")})),Qn.createElement(o3,{predicate:this.props.isFirstOpenSection},()=>Qn.createElement(Da,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected)})))))}getFillOpacity(){return""+.4}isInequality(){return _p(this.model)}toggleFillVisible(){this.controller.dispatch({type:"set-item-fill",id:this.id,fill:!this.props.isOpen()})}dispatchOpacityLatexIfChanged(e){this.model.fillOpacity!==e&&this.controller.dispatch({type:"set-item-fillopacity",id:this.id,fillOpacity:e})}};var hi=__dcg_shared_module_exports__['e'](te());var br=__dcg_shared_module_exports__['e'](te());var{If:iX,Switch:oX}=br.Components,zI=class extends br.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return br.createElement("div",{class:br.const("dcg-clickable-image-info-view"),role:br.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-clickable-image-options")},br.createElement("div",{class:br.const("dcg-clickable-image-state-container")},br.createElement($e,{tooltip:()=>this.tooltip("hovered"),gravity:this.const("s")},br.createElement(Ph,{controller:()=>this.controller,ariaLabel:()=>this.tooltip("hovered"),onFileChange:e=>this.updateImage("hovered",e),readonly:()=>this.controller.isItemReadonly(this.id)},br.createElement(oX,{key:this.bindFn(this.hoveredStatus)},()=>br.createElement("div",{class:br.const("dcg-clickable-image-state"),style:()=>this.getStyleForState("hovered")})))),br.createElement(iX,{predicate:()=>!!this.model.clickableInfo.hoveredImage},()=>br.createElement("div",{class:br.const("dcg-clickable-image-state-close"),onTap:()=>this.removeImageState("hovered"),ariaLabel:()=>this.controller.s("graphing-calculator-label-remove-hovered-image"),role:br.const("button"),tabIndex:br.const(0)},br.createElement("i",{class:br.const("dcg-icon-remove"),"aria-hidden":br.const("true")}))),br.createElement("div",{role:br.const("heading"),"aria-level":br.const("2"),class:br.const("dcg-clickable-image-label")},()=>this.controller.s("graphing-calculator-label-hovered"))),br.createElement("div",{class:br.const("dcg-clickable-image-state-container")},br.createElement($e,{tooltip:()=>this.tooltip("depressed"),gravity:this.const("s")},br.createElement(Ph,{controller:()=>this.controller,ariaLabel:()=>this.tooltip("depressed"),onFileChange:e=>this.updateImage("depressed",e),readonly:()=>this.controller.isItemReadonly(this.id)},br.createElement(oX,{key:this.bindFn(this.depressedStatus)},()=>br.createElement("div",{class:br.const("dcg-clickable-image-state"),style:()=>this.getStyleForState("depressed")})))),br.createElement(iX,{predicate:()=>!!this.model.clickableInfo.depressedImage},()=>br.createElement("div",{class:br.const("dcg-clickable-image-state-close"),onTap:()=>this.removeImageState("depressed"),ariaLabel:()=>this.controller.s("graphing-calculator-label-remove-depressed-image"),role:br.const("button"),tabIndex:br.const(0)},br.createElement("i",{class:br.const("dcg-icon-remove"),"aria-hidden":br.const("true")}))),br.createElement("div",{role:br.const("heading"),"aria-level":br.const("2"),class:br.const("dcg-clickable-image-label")},()=>this.controller.s("graphing-calculator-label-depressed"))))}hoveredStatus(){return this.hoveredUploading?"loading":"background"}depressedStatus(){return this.depressedUploading?"loading":"background"}tooltip(e){return(e==="hovered"?this.model.clickableInfo.hoveredImage:this.model.clickableInfo.depressedImage)?e==="depressed"?this.controller.s("graphing-calculator-label-change-depressed-image-tooltip"):this.controller.s("graphing-calculator-label-change-hovered-image-tooltip"):e==="depressed"?this.controller.s("graphing-calculator-label-add-depressed-image-tooltip"):this.controller.s("graphing-calculator-label-add-hovered-image-tooltip")}getImageURLForState(e){let t;if(e==="hovered"){if(this.hoveredStatus()!=="background")return"";t="hoveredImage"}else{if(this.depressedStatus()!=="background")return"";t="depressedImage"}let i=this.model.clickableInfo[t];return i?`url(${i})`:`url(${this.model.image_url})`}getStyleForState(e){let t={"background-image":this.getImageURLForState(e),opacity:1};return e==="hovered"&&!this.model.clickableInfo.hoveredImage&&(t.opacity=.5),t}removeImageState(e){e==="hovered"?this.controller.dispatch({type:"set-hovered-image",id:this.model.id,url:""}):this.controller.dispatch({type:"set-depressed-image",id:this.model.id,url:""})}updateImage(e,t){if(!t||!t[0])return;let i=t[0];e==="hovered"&&(this.hoveredUploading=!0),e==="depressed"&&(this.depressedUploading=!0),this.controller.getGraphSettings().config.imageUploadCallback(i,(o,n)=>{e==="hovered"&&(this.hoveredUploading=!1),e==="depressed"&&(this.depressedUploading=!1),!o&&n&&(e==="hovered"?this.controller.dispatch({type:"set-hovered-image",id:this.model.id,url:n}):this.controller.dispatch({type:"set-depressed-image",id:this.model.id,url:n}))})}};var ud=__dcg_shared_module_exports__['e'](te()),KI=__dcg_shared_module_exports__['e'](mX());var a3=/\{\$([a-zA-Z0-9\-]+([a-zA-Z0-9\-]+_)*[a-zA-Z0-9\-]+)\}/;function fX(r,e){let t=0,i=0,o={},n={},a=s(r);if(!/^<0>/.test(a)||!/<\/0>$/.test(a))throw new Error("Expected template string to start and end with <0> and </0>, but found "+JSON.stringify(a));return a.slice(3,-4).trim();function s(c){if(e.isConst(c))return Mue(e.getConstValue(c));if(e.isNamedBinding(c)){let d=l(o,e.getBindingName(c)),p=`{$${d}}`;if(!a3.test(p))throw new Error(`Invalid <Localize> variable: ${p}.`);return e.addBinding&&e.addBinding(d,c),o[d]=!0,p}else if(c!==r&&e.isView(c)){let d=l(n,e.getViewName(c));if(!/[a-zA-Z0-9\-_]/.test(d))throw new Error(`Invalid <Localize> subview identifier: ${d}.`);return e.addView&&e.addView(d,c),n[d]=!0,`<${d}/>`}else if(e.isBinding(c)){let d=l(o,`v${t++}`),p=`{$${d}}`;return e.addBinding&&e.addBinding(d,c),o[d]=!0,p}else{let d=`${i++}`;e.addElement&&e.addElement(d,c);let p=[];return e.forEachChild(c,g=>{p.push(s(g))}),n[d]=!0,p.length>0?`<${d}>${p.join("")}</${d}>`:`<${d}/>`}}function l(c,d){let p=0,g=d;for(;c[g];)g=`${d}-${++p}`;return g}}var Tue=!0;function Mue(r){return Tue?r:r.replace(/\{|\}/g,e=>`{"${e}"}`).replace(/(^|[\s\n]+)(\[|\]|\.)/g,(e,t,i)=>`${t}{"${i}"}`)}function Iue(r){return r.__DCGViewLocalizeBindingName}function Aue(r){return typeof r=="function"&&r.__DCGViewLocalizeViewName}var yi=class extends ud.Class{init(){this.viewMap={},this.elementMap={},this.bindingMap={},this.i18n=this.props.i18n(),this.templateString=this.serializeToTemplateString(ud.createElement("div",null,this.children))}template(){return ud.createElement(ud.Components.If,{predicate:()=>this.shouldShow()},()=>ud.createElement(ud.Components.Switch,{key:()=>s3(this.translatedString())},e=>this.renderDeserializedTemplateNode(this.parseAndValidate(e))))}shouldShow(){let e=this.props.options&&this.props.options();return e&&e.hideUntranslatedView&&this.i18n.hasTranslation?this.i18n.hasTranslation(this.props.key()):!0}translatedString(){let e={};for(let t in this.bindingMap)e[t]=Kl(`{$${t}}`);return this.i18n.s(this.props.key(),e)}static variable(e,t){let i=()=>t();return i.__DCGViewLocalizeBindingName=e,i}static subview(e,t){let i=()=>t();return i.__DCGViewLocalizeViewName=e,i}parseAndValidate(e){let t=(0,KI.parse)(e),i={},o={};n(t);for(let a in this.elementMap)if(!o[a])return(0,KI.parse)(s3(this.templateString));for(let a in this.bindingMap)if(!i[a])return(0,KI.parse)(s3(this.templateString));return t;function n(a){if(Array.isArray(a)){for(let s of a)n(s);return}a.name==="token"?i[a.attrs.id]=!0:a.type!=="text"&&(o[a.name]=!0,n(a.children))}}renderDeserializedTemplateNode(e){if(Array.isArray(e))return e.map(t=>this.renderDeserializedTemplateNode(t));if(e.type==="text")return ud.const(e.content||"");if(e.name==="token"){let t=this.bindingMap[e.attrs.id];return t||(()=>"")}else if(this.elementMap[e.name]){let t=this.elementMap[e.name],i=e.children.map(o=>this.renderDeserializedTemplateNode(o));return yX(t.type,t.attrs,i)}else return this.viewMap[e.name]?this.viewMap[e.name]():yX("span",{},[])}serializeToTemplateString(e){return fX(e,{isView:Aue,isConst:bX,isBinding:t=>typeof t=="function",isNamedBinding:Iue,getConstValue:t=>t(),getBindingName:t=>t.__DCGViewLocalizeBindingName,getViewName:t=>t.__DCGViewLocalizeViewName,addBinding:(t,i)=>{this.bindingMap[t]=i},addElement:(t,i)=>{this.elementMap[t]={type:i.tagName,attrs:i.attrs}},addView:(t,i)=>{if(this.viewMap[t])throw new Error(`Unexpected duplicate view ${t}.`);this.viewMap[t]=i},forEachChild:(t,i)=>{for(let o of t.children){if(!bX(o)&&typeof o!="function"&&o._isDCGView)throw new Error("Bare DCGViews are not allowed inside <Localize>. Use Localize.subview().");i(o)}}})}};function bX(r){return typeof r=="function"&&r.isDCGViewConst}function yX(r,e,t){return ud.createElement(r,e,t)}function s3(r){return`<0>${r}</0>`.replace(new RegExp(a3.source,"g"),(t,i)=>`<token id="${i}"/>`)}var{If:qI,IfDefined:Vue,Textarea:Lue}=hi.Components,Aw=class extends vn{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return hi.createElement("div",{class:hi.const("dcg-options-menu-section dcg-clickable-section")},hi.createElement("div",{class:hi.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-clickable"),hi.createElement(yo,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-make-clickable"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleClickable)})),hi.createElement(qI,{predicate:this.props.isOpen},()=>hi.createElement("div",{class:hi.const("dcg-options-menu-content")},hi.createElement("div",{class:hi.const("dcg-clickable-menu-row")},hi.createElement("span",{class:hi.const("dcg-input-label")},()=>this.controller.s("graphing-calculator-label-update-on-click")),hi.createElement(Ze,{latex:()=>this.model.clickableInfo.latex,placeholder:this.const(""),isFocused:()=>this.getFocusedInput()==="updaterule",capExpressionSize:()=>!!this.controller.getGraphSettings().config.capExpressionSize,selectOnFocus:this.const(!0),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.controller.s("graphing-calculator-narration-click-action"),getAriaPostLabel:this.const(""),hasError:()=>this.hasError(),onUserChangedLatex:e=>this.dispatchUpdateRuleLatexIfChanged(e),onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:e=>this.handleFocusedChanged(e,"updaterule"),dataLabelAttributeValue:this.const("click-handler"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled()}),Vue(()=>this.packedError(),e=>hi.createElement("span",{class:hi.const("dcg-clickable-info-error-container")},hi.createElement($a,{error:()=>this.controller.unpack(e()),gravity:this.const("s"),size:this.const("small")})))),hi.createElement(qI,{predicate:this.bindFn(this.isList)},()=>hi.createElement("div",{class:hi.const("dcg-clickable-list-index-notice")},hi.createElement(yi,{i18n:this.const(this.controller),key:this.const("graphing-calculator-label-list-index")},hi.const("Use"),hi.const(" "),hi.createElement("span",{class:()=>({"dcg-index-variable-marker":!0,"dcg-btn":!0,"dcg-btn-light-gray":!0,"dcg-mathquill-has-focus":this.getFocusedInput()==="updaterule","dcg-do-not-blur":!0}),onTap:this.bindFn(this.insertIndex)},hi.const("index")),hi.const(" "),hi.const("to reference the clicked index in the list.")))),hi.createElement(qI,{predicate:()=>this.model.type!=="image"},()=>hi.createElement(Lue,{placeholder:()=>this.controller.s("graphing-calculator-text-add-screen-reader-label-placeholder"),value:()=>this.model.description,onInput:e=>this.controller.dispatch({type:"set-item-description",id:this.model.id,description:e})})),hi.createElement(qI,{predicate:()=>this.model.type==="image"},()=>hi.createElement("div",{class:hi.const("dcg-clickable-menu-row")},hi.createElement(zI,{controller:()=>this.controller,model:()=>this.model}))))))}insertIndex(){this.controller.dispatch({type:"keypad/type-text",text:"index"})}isList(){return this.model.formula?!!this.model.formula.is_concrete_list:!1}hasError(){return this.packedError()!==void 0}packedError(){if(this.model.formula.click_handler&&this.model.formula.click_handler.status==="error")return this.model.formula.click_handler.error}toggleClickable(){this.controller.dispatch({type:"set-clickableinfo-prop",id:this.model.id,prop:"enabled",value:!this.model.clickableInfo.enabled}),this.model.clickableInfo.enabled&&this.handleFocusedChanged(!0,"updaterule")}dispatchUpdateRuleLatexIfChanged(e){this.model.clickableInfo.latex!==e&&this.controller.dispatch({type:"set-clickableinfo-rule-latex",id:this.id,latex:e})}getMQConfig(){return this.controller.getMathquillConfig({additionalOperators:["index"]})}};var Qi=__dcg_shared_module_exports__['e'](te());var Rh=__dcg_shared_module_exports__['e'](te());var Vw=class extends vn{template(){return Rh.createElement("div",{class:Rh.const("dcg-iconed-mathquill-row dcg-point-opacity-row")},Rh.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-opacity-tooltip"),sticky:this.const(!0),gravity:this.const("s")},Rh.createElement("i",{class:Rh.const("dcg-icon-opacity"),"aria-hidden":Rh.const("true")})),Rh.createElement(_r,{latex:()=>this.model.pointOpacity,placeholder:this.bindFn(this.getPointOpacityPlaceholder),isFocused:()=>this.getFocusedInput()==="pointopacity",ariaPostLabel:()=>this.isPointOpacityValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-line-opacity"),hasError:()=>!this.isPointOpacityValid(),handleLatexChanged:this.bindFn(this.dispatchPointOpacityLatexIfChanged),dataLabelAttributeValue:this.const("point-opacity"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"pointopacity")}))}isPointOpacityValid(){return this.model.type==="expression"?g8(this.model):this.model.type==="table-column"?Cq(this.model):!1}dispatchPointOpacityLatexIfChanged(e){this.model.pointOpacity!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-pointopacity",id:this.id,pointOpacity:e}):this.controller.dispatch({type:"set-tablecolumn-pointopacity",columnId:this.model.id,tableId:this.model.table.id,pointOpacity:e}))}getPointOpacityPlaceholder(){return`${1}`}};var{If:HI}=Qi.Components,Lw=class extends vn{template(){return Qi.createElement("div",{class:Qi.const("dcg-options-menu-section")},Qi.createElement("div",{class:Qi.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-points"),Qi.createElement(yo,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-points-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.togglePointsVisible)})),Qi.createElement(HI,{predicate:this.props.isOpen},()=>Qi.createElement("div",{class:Qi.const("dcg-options-menu-content")},Qi.createElement("div",{class:Qi.const("dcg-options-flex-container")},Qi.createElement("div",{class:Qi.const("dcg-options-left-side")},Qi.createElement(Vw,{...this.props}),Qi.createElement(HI,{predicate:()=>this.model.type==="expression"||!this.isDraggable()},()=>Qi.createElement("div",{class:Qi.const("dcg-iconed-mathquill-row dcg-point-size-row")},Qi.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-point-size-tooltip"),gravity:this.const("s"),sticky:this.const(!0)},Qi.createElement("i",{class:Qi.const("dcg-icon-line-thickness"),"aria-hidden":Qi.const("true")})),Qi.createElement(_r,{latex:this.bindFn(this.getPointSize),placeholder:this.bindFn(this.getDefaultPointSize),isFocused:()=>this.getFocusedInput()==="pointsize",ariaPostLabel:()=>this.isPointSizeValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-point-size"),hasError:()=>!this.isPointSizeValid(),handleLatexChanged:e=>this.dispatchPointSizeLatexIfChanged(e),dataLabelAttributeValue:this.const("point-size"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"pointsize")})))),Qi.createElement("div",{class:Qi.const("dcg-options-right-side")},Qi.createElement(HI,{predicate:()=>!this.isDraggable()},()=>Qi.createElement(Xi,{staticConfig:this.bindFn(this.getPointStyleOptions),ariaGroupLabel:()=>this.controller.s("graphing-calculator-heading-style"),theme:this.const("mini")})))),Qi.createElement(HI,{predicate:this.props.isFirstOpenSection},()=>Qi.createElement(Da,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected)})))))}getPointSize(){return this.isDraggable()&&this.model.type==="expression"?this.model.movablePointSize:this.model.pointSize}getPointStyleOptions(){return["POINT","OPEN","CROSS"].map(t=>({key:t,icon:()=>this.getStyleIcon(t),ariaLabel:()=>this.getStyleAria(t),selected:()=>this.model.pointStyle===t,class:()=>"dcg-point-segmented-option",onSelect:()=>{this.onPointStyleSelected(t)}}))}getStyleIcon(e){switch(e){case"POINT":return"dcg-icon-point";case"OPEN":return"dcg-icon-open";case"CROSS":return"dcg-icon-cross"}}getStyleAria(e){let t=this.controller.s;switch(e){case"POINT":return t("graphing-calculator-narration-point-style-point");case"OPEN":return t("graphing-calculator-narration-point-style-open");case"CROSS":return t("graphing-calculator-narration-point-style-cross")}}isPointSizeValid(){return this.model.type==="expression"?this.isDraggable()?m8(this.model):iG(this.model):this.model.type==="table-column"?vq(this.model):!1}onPointStyleSelected(e){this.model.pointStyle!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-pointstyle",id:this.id,pointStyle:e}):this.controller.dispatch({type:"set-tablecolumn-pointstyle",columnId:this.model.id,tableId:this.model.table.id,pointStyle:e}))}dispatchPointSizeLatexIfChanged(e){this.getPointSize()!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-pointsize",id:this.id,pointSize:e}):this.controller.dispatch({type:"set-tablecolumn-pointsize",columnId:this.model.id,tableId:this.model.table.id,pointSize:e}))}isDraggable(){return this.getDragMode()!=="NONE"}togglePointsVisible(){this.model.type==="expression"&&zs(this.model)?this.controller.dispatch({type:"toggle-item-hidden",id:this.model.id}):this.model.type==="expression"?this.controller.dispatch({type:"set-item-points",id:this.id,points:!this.props.isOpen()}):this.controller.dispatch({type:"set-tablecolumn-points",columnId:this.model.id,tableId:this.model.table.id,bool:!this.props.isOpen()})}getDragMode(){return this.model.type==="expression"?mo(this.model)||this.model.dragMode:this.model.dragMode}getDefaultPointSize(){return this.model.type==="expression"&&lh(this.model)?`${14}`:`${8}`}};var wr=__dcg_shared_module_exports__['e'](te());var ms=__dcg_shared_module_exports__['e'](te());var{For:_ue}=ms.Components,Oue=[{orientation:"default",cssClass:"dcg-label-orientation-center",description:"graphing-calculator-text-label-orientation-default"},{orientation:"above",cssClass:"dcg-label-orientation-above",description:"graphing-calculator-text-label-orientation-above"},{orientation:"above_right",cssClass:"dcg-label-orientation-above-right",description:"graphing-calculator-text-label-orientation-above-right"},{orientation:"right",cssClass:"dcg-label-orientation-right",description:"graphing-calculator-text-label-orientation-right"},{orientation:"below_right",cssClass:"dcg-label-orientation-below-right",description:"graphing-calculator-text-label-orientation-below-right"},{orientation:"below",cssClass:"dcg-label-orientation-below",description:"graphing-calculator-text-label-orientation-below"},{orientation:"below_left",cssClass:"dcg-label-orientation-below-left",description:"graphing-calculator-text-label-orientation-below-left"},{orientation:"left",cssClass:"dcg-label-orientation-left",description:"graphing-calculator-text-label-orientation-left"},{orientation:"above_left",cssClass:"dcg-label-orientation-above-left",description:"graphing-calculator-text-label-orientation-above-left"}],WI=class extends ms.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return ms.createElement("div",{class:ms.const("dcg-label-orientation-view"),style:()=>`transform: rotate(${this.getCSSRotationValue()});`},ms.createElement("span",{class:ms.const("dcg-vertical-orientation-indicator")}),ms.createElement(_ue,{each:()=>Oue,key:e=>e.orientation},ms.createElement("div",{class:ms.const("dcg-label-orientations"),role:ms.const("radiogroup"),"aria-label":()=>this.controller.s("graphing-calculator-heading-label-orientation")},e=>ms.createElement("div",{class:()=>({[e.cssClass]:!0,"dcg-orientation-option":!0,"dcg-selected":this.isSelected(e.orientation),"dcg-orientation-disabled":this.isDisabled(e.orientation)}),role:ms.const("radio"),tabindex:ms.const("0"),"aria-label":()=>this.controller.s(e.description),"aria-checked":()=>this.getOrientation()===e.orientation,onTap:()=>this.onTapOrientation(e.orientation)},ms.createElement("i",{class:()=>({"dcg-icon-chevron-left":e.orientation!=="default"})})))))}isDisabled(e){return e!=="default"?!1:this.isPointVisible()?!0:this.model.labelOrientation==="default"}isSelected(e){return e==="default"&&e===this.model.labelOrientation?!this.isPointVisible():e===this.model.labelOrientation}isPointVisible(){return this.model.hidden?!1:zs(this.model)?!this.model.hidden:this.model.points}getCSSRotationValue(){let e=x8(this.model);return`${Array.isArray(e)?0:e}rad`}getOrientation(){return this.props.model().labelOrientation}onTapOrientation(e){e===this.getOrientation()&&(e="default"),this.controller.dispatch({type:"set-item-label-orientation",id:this.id,labelOrientation:e})}};var{If:Pw}=wr.Components,$I=class extends vn{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return wr.createElement("div",{class:wr.const("dcg-options-menu-section")},wr.createElement("div",{class:wr.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-label"),wr.createElement(yo,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-label-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleLabelVisible)})),wr.createElement(Pw,{predicate:this.props.isOpen},()=>wr.createElement("div",{class:wr.const("dcg-options-menu-content")},wr.createElement("div",{class:wr.const("dcg-options-flex-container")},wr.createElement("div",{class:wr.const("dcg-options-left-side")},wr.createElement(Pw,{predicate:this.props.isFirstOpenSection},()=>wr.createElement(Vw,{...this.props})),wr.createElement("div",{class:wr.const("dcg-iconed-mathquill-row dcg-label-size-row")},wr.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-label-size-tooltip"),sticky:this.const(!0),gravity:this.const("s")},wr.createElement("span",{class:wr.const("dcg-font-size")},wr.const("A"))),wr.createElement(_r,{latex:()=>this.model.labelSize,placeholder:()=>"1",isFocused:()=>this.getFocusedInput()==="labelsize",ariaPostLabel:()=>W_(this.model)?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-label-size"),hasError:()=>!W_(this.model),handleLatexChanged:this.bindFn(this.dispatchLabelSizeIfChanged),dataLabelAttributeValue:this.const("label-size"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"labelsize")})),wr.createElement("div",{class:()=>({"dcg-iconed-mathquill-row":!0,"dcg-label-angle-row":!0,"dcg-suffix-degree":this.props.controller().getGraphSettings().degreeMode,"dcg-suffix-radian":!this.props.controller().getGraphSettings().degreeMode})},wr.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-angle-tooltip"),sticky:this.const(!0)},wr.createElement("i",{class:wr.const("dcg-icon-angle"),"aria-hidden":wr.const("true")})),wr.createElement(_r,{latex:()=>this.model.labelAngle,placeholder:()=>"0",isFocused:()=>this.getFocusedInput()==="labelangle",ariaPostLabel:()=>$_(this.model)?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-label-angle"),hasError:()=>!$_(this.model),handleLatexChanged:this.bindFn(this.dispatchLabelAngleIfChanged),dataLabelAttributeValue:this.const("label-angle"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"labelangle")}))),wr.createElement("div",{class:wr.const("dcg-options-right-side")},wr.createElement(WI,{controller:()=>this.controller,model:()=>this.model}))),wr.createElement(Pw,{predicate:this.props.isFirstOpenSection},()=>wr.createElement(Da,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected)})),wr.createElement(Pw,{predicate:()=>this.controller.canUseAdvancedStyling()},()=>wr.createElement("div",{class:wr.const("dcg-label-advanced")},wr.createElement(xt,{checked:this.bindFn(this.getWhiteTextOutline),onChange:this.bindFn(this.setWhiteTextOutline),disabled:()=>this.getEditable()},()=>this.controller.s("graphing-calculator-button-label-text-outline")),wr.createElement("div",{role:wr.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-heading-advanced")},wr.createElement(Pw,{predicate:()=>this.shouldShowHoverLabelCheckbox()},()=>wr.createElement(xt,{checked:this.bindFn(this.getInteractiveLabel),onChange:this.bindFn(this.setInteractiveLabel)},()=>this.controller.s("graphing-calculator-button-label-show-on-hover"))),wr.createElement(Pw,{predicate:this.bindFn(this.shouldShowEditableLabelToggle)},()=>wr.createElement(xt,{checked:this.bindFn(this.getEditable),onChange:this.bindFn(this.setEditable)},()=>this.controller.s("graphing-calculator-button-label-editable")))))))))}getWhiteTextOutline(){return this.getEditable()?!1:!this.model.suppressTextOutline}setWhiteTextOutline(e){this.controller.dispatch({type:"set-suppress-text-outline",id:this.id,suppressTextOutline:!e})}setInteractiveLabel(e){this.controller.dispatch({type:"set-item-interactive-label",id:this.id,interactiveLabel:e})}getInteractiveLabel(){return!!this.model.interactiveLabel}setEditable(e){if(e){let t=__dcg_shared_module_exports__['Ed'](this.model.label)==="latex"?"MATH":"TEXT";this.controller.dispatch({type:"set-item-editable-label-mode",id:this.id,editableLabelMode:t})}else this.controller.dispatch({type:"set-item-editable-label-mode",id:this.id,editableLabelMode:"NONE"})}getEditable(){return this.model.editableLabelMode!=="NONE"}shouldShowEditableLabelToggle(){return zs(this.model)}shouldShowHoverLabelCheckbox(){return mo(this.model)==="NONE"}dispatchLabelAngleIfChanged(e){this.model.labelAngle!==e&&this.controller.dispatch({type:"set-item-labelangle",id:this.id,labelAngle:e})}dispatchLabelSizeIfChanged(e){this.model.labelSize!==e&&this.controller.dispatch({type:"set-item-labelSize",id:this.id,labelSize:e})}toggleLabelVisible(){this.controller.dispatch({type:"set-item-showlabel",id:this.id,showLabel:!this.props.isOpen()})}};var es=__dcg_shared_module_exports__['e'](te());var{If:Rue,For:Fue}=es.Components,_w=class extends vn{template(){return es.createElement("div",{class:es.const("dcg-options-menu-section")},es.createElement("div",{class:es.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-drag"),es.createElement(yo,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-menu-drag-enabled"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleDragEnabled)})),es.createElement(Rue,{predicate:this.props.isOpen},()=>es.createElement("div",{class:es.const("dcg-options-menu-content")},es.createElement(Fue,{each:()=>["X","Y","XY"]},es.createElement("div",{class:es.const("dcg-style-icons"),role:es.const("radiogroup")},e=>es.createElement("div",{class:()=>({"dcg-style-icon-container":!0,"dcg-disabled":this.isDisabled(e)}),onTap:()=>this.onDragModeSelected(e),role:es.const("radio"),tabindex:()=>this.isDisabled(e)?-1:0,"aria-label":()=>e==="X"?this.controller.s("graphing-calculator-narration-drag-mode-x"):e==="Y"?this.controller.s("graphing-calculator-narration-drag-mode-y"):e==="XY"?this.controller.s("graphing-calculator-narration-drag-mode-xy"):this.controller.raw(""),"aria-checked":()=>this.getDragMode()===e},es.createElement(yn,{backgroundColor:()=>({type:"single-color",value:"#000"}),semiTransparent:()=>this.getDragMode()!==e,iconType:()=>e==="X"?"movable-horizontal":e==="Y"?"movable-vertical":"movable-both"})))))))}isDisabled(e){let t=this.controller.getEnabledDragModesForItem(this.id);return!__dcg_shared_module_exports__['l'](t,e)}onDragModeSelected(e){if(this.model.type==="expression"){if(this.isDisabled(e))return;this.controller.dispatch({type:"set-item-dragmode",id:this.id,dragMode:e})}else{let t=this.model.id,i=this.model.table.id;this.controller.dispatch({type:"set-tablecolumn-dragmode",tableId:i,columnId:t,dragMode:e})}}getDragMode(){return this.model.type==="expression"?mo(this.model)||this.model.dragMode:this.model.dragMode}toggleDragEnabled(){let e=this.getDragMode()!=="NONE"?"NONE":"XY";this.model.type==="expression"?this.controller.dispatch({type:"set-item-dragmode",id:this.id,dragMode:e}):this.onDragModeSelected(e)}};var Aa=__dcg_shared_module_exports__['e'](te());var{If:Bue}=Aa.Components,jI=class extends vn{template(){return Aa.createElement("div",{class:Aa.const("dcg-options-menu-section")},Aa.createElement("div",{class:Aa.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-points"),Aa.createElement(yo,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-points-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.togglePointsVisible)})),Aa.createElement(Bue,{predicate:()=>this.props.isOpen()},()=>Aa.createElement("div",{class:Aa.const("dcg-options-menu-content")},Aa.createElement("div",{class:Aa.const("dcg-iconed-mathquill-row dcg-line-thickness-row-3d")},Aa.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-point-size-3d-tooltip"),gravity:this.const("s"),sticky:this.const(!0)},Aa.createElement("i",{class:Aa.const("dcg-icon-line-thickness"),"aria-hidden":Aa.const("true")})),Aa.createElement(_r,{latex:()=>this.model.pointSize,placeholder:this.bindFn(this.getDefaultPointSize),isFocused:()=>this.getFocusedInput()==="pointsize",ariaPostLabel:()=>this.isPointSizeValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-point-size"),hasError:()=>!this.isPointSizeValid(),handleLatexChanged:e=>this.dispatchPointSizeLatexIfChanged(e),dataLabelAttributeValue:this.const("point-size"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"pointsize")})),Aa.createElement(Da,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected),hideColorFunctions:()=>!0}))))}togglePointsVisible(){this.controller.dispatch({type:"set-item-points",id:this.id,points:!this.props.isOpen()})}isPointSizeValid(){return this.model.type==="expression"?iG(this.model):!1}dispatchPointSizeLatexIfChanged(e){this.model.pointSize!==e&&this.model.type==="expression"&&this.controller.dispatch({type:"set-item-pointsize",id:this.id,pointSize:e})}getDefaultPointSize(){return`${3}`}};var pa=__dcg_shared_module_exports__['e'](te());var{If:xX}=pa.Components,YI=class extends vn{template(){return pa.createElement("div",{class:pa.const("dcg-options-menu-section")},pa.createElement("div",{class:pa.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-lines"),pa.createElement(yo,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-lines-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleLinesVisible)})),pa.createElement(xX,{predicate:()=>this.props.isOpen()},()=>pa.createElement("div",{class:pa.const("dcg-options-menu-content")},pa.createElement("div",{class:pa.const("dcg-iconed-mathquill-row dcg-line-thickness-row-3d")},pa.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-line-thickness-3d-tooltip"),sticky:this.const(!0),gravity:this.const("s")},pa.createElement("i",{class:pa.const("dcg-icon-line-thickness"),"aria-hidden":pa.const("true")})),pa.createElement(_r,{latex:()=>this.model.lineWidth,placeholder:()=>`${1}`,isFocused:()=>this.getFocusedInput()==="linewidth",ariaPostLabel:()=>this.isLineWidthValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-label-line-thickness-3d-tooltip"),hasError:()=>!this.isLineWidthValid(),handleLatexChanged:this.bindFn(this.dispatchLineWidthLatexIfChanged),dataLabelAttributeValue:this.const("line-width"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"linewidth")})),pa.createElement(xX,{predicate:this.props.isFirstOpenSection},()=>pa.createElement(Da,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected)})))))}toggleLinesVisible(){this.controller.dispatch({type:"set-item-lines",id:this.id,lines:!this.props.isOpen()})}isLineWidthValid(){return this.model.type==="expression"?oG(this.model):!1}dispatchLineWidthLatexIfChanged(e){this.model.lineWidth!==e&&this.model.type==="expression"&&this.controller.dispatch({type:"set-item-linewidth",id:this.id,lineWidth:e})}};var ua=__dcg_shared_module_exports__['e'](te());var{If:l3}=ua.Components,XI=class extends vn{template(){return ua.createElement("div",{class:ua.const("dcg-options-menu-section")},ua.createElement("div",{class:ua.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-surfaces"),ua.createElement(yo,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-surfaces-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleSurfacesVisible)})),ua.createElement(l3,{predicate:()=>this.props.isOpen()},()=>ua.createElement("div",{style:ua.const("font-size:85%; margin-top:8px")},ua.createElement(l3,{predicate:()=>this.usesResolution()&&!!pr("beta3d")},()=>ua.createElement("div",null,ua.const("Resolution:"),ua.createElement(_r,{latex:()=>this.model.resolution,placeholder:()=>this.getDefaultResolution(),isFocused:()=>this.getFocusedInput()==="resolution",ariaPostLabel:()=>this.isResolutionValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-label-resolution-tooltip"),hasError:()=>!this.isResolutionValid(),handleLatexChanged:this.bindFn(this.dispatchResolutionLatexIfChanged),dataLabelAttributeValue:this.const("resolution"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"resolution")}))),ua.createElement(l3,{predicate:this.props.isFirstOpenSection},()=>ua.createElement("div",{class:ua.const("dcg-options-menu-content"),style:ua.const("margin-top:8px")},ua.createElement(Da,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected)}))))))}toggleSurfacesVisible(){this.controller.dispatch({type:"set-item-lines",id:this.id,lines:!this.props.isOpen()})}usesResolution(){return!Xk(this.model)&&!i8(this.model)}dispatchResolutionLatexIfChanged(e){this.model.resolution!==e&&this.model.type==="expression"&&this.controller.dispatch({type:"set-item-resolution",id:this.id,resolution:e})}isResolutionValid(){return this.model.type==="expression"?f8(this.model):!1}getDefaultResolution(){return this.model.type==="expression"&&o8(this.model)?`${__dcg_shared_module_exports__['Tc']}`:`${__dcg_shared_module_exports__['Uc']}`}};qt();var hd=__dcg_shared_module_exports__['e'](te());var{If:zue}=hd.Components,ym=class extends hd.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return hd.createElement(zue,{predicate:()=>this.isVisible()},()=>hd.createElement("div",{class:hd.const("dcg-options-menu-section dcg-interactivity-section dcg-section-without-title")},hd.createElement("div",{class:hd.const("dcg-options-menu-content")},hd.createElement(xt,{checked:()=>Yl(this.model),onChange:()=>this.toggleGraphInteractionsDisabled(),ariaLabel:()=>this.controller.s("graphing-calculator-label-disable-graph-interactions")},()=>this.controller.s("graphing-calculator-label-disable-graph-interactions")))))}isVisible(){return this.controller.shouldShowAuthorFeatures()}toggleGraphInteractionsDisabled(){this.model.type==="table-column"?this.controller.dispatch({type:"set-tablecolumn-disable-graph-interactions",tableId:this.model.table.id,columnId:this.model.id,disableGraphInteractions:!Yl(this.model)}):this.controller.dispatch({type:"set-item-disable-graph-interactions",id:this.model.id,disableGraphInteractions:!Yl(this.model)})}};as();var{For:Kue,If:que}=Cn.Components;function ap(r,e){if(!r)return;let t=r.closest(".dcg-options-menu-container"),i=e.findEl(".dcg-container"),o=e.getOpenMenuIcon(),n=!!r.closest(".dcg-table-column-menu");if(!t||!i||!o)return;let a=e.computeMajorLayout(),s=a.list.top+a.list.height,l=a.keypad.top,c=Math.min(s,l),d=i.getBoundingClientRect(),p=o.getBoundingClientRect(),g=c+d.top-p.top,h=t.offsetHeight,f=0;h>g&&(f=+g-h);let y=n?!f:-f<h-38;t.style.marginTop=`${n&&f<0?f-34:f}px`,r.style.marginTop=`${-f}px`,r.style.display=y?"":"none"}function fb(r,e){requestAnimationFrame(()=>{let t=e.getExppanelElt(),i=e.getOpenMenuIcon();r&&t&&i&&t.contains(i)&&ie(t).on(`scroll.${r}`,()=>{ie(t).off(`scroll.${r}`);let o=e.getFocusLocation(),n=e.getOpenItemMenu();o&&n&&o.type==="expression-menu"&&"model"in n&&o.id===n.model.id&&e.dispatch({type:"blur-focus-location",location:o}),e.dispatch({type:"close-item-settings-menu"})})})}function bb(r,e){let t=e.getExppanelElt();t&&r&&ie(t).off(`scroll.${r}`)}var Ow=class extends Cn.Class{init(){var e;this.controller=this.props.controller(),this.guid=(e=this.controller.getOpenItemMenu())==null?void 0:e.guid}didMount(){fb(this.guid,this.controller)}willUnmount(){bb(this.guid,this.controller)}didUpdate(){ap(this.arrowElt,this.controller)}template(){let e=this.props.model();return Cn.createElement("div",{class:()=>({"dcg-expressions-options-menu":!0,"dcg-options-menu":!0}),role:Cn.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-options-menu")},Cn.createElement(Kue,{each:this.bindFn(this.getSections)},Cn.createElement("div",null,t=>{switch(t){case"points":return Cn.createElement(Lw,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("points"),isFirstOpenSection:()=>this.isFirstOpenSection("points")});case"label":return Cn.createElement($I,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("label"),isFirstOpenSection:()=>this.isFirstOpenSection("label")});case"drag":return Cn.createElement(_w,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("drag"),isFirstOpenSection:()=>this.isFirstOpenSection("drag")});case"lines":return Cn.createElement(Iw,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("lines"),isFirstOpenSection:()=>this.isFirstOpenSection("lines")});case"fill":return Cn.createElement(UI,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("fill"),isFirstOpenSection:()=>this.isFirstOpenSection("fill")});case"colors-only":return Cn.createElement(BI,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:this.const(!0),isFirstOpenSection:this.const(!0)});case"points3d":return Cn.createElement(jI,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("points3d"),isFirstOpenSection:()=>this.isFirstOpenSection("points3d")});case"lines3d":return Cn.createElement(YI,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("lines3d"),isFirstOpenSection:()=>this.isFirstOpenSection("lines3d")});case"surfaces":return Cn.createElement(XI,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("surfaces"),isFirstOpenSection:()=>this.isFirstOpenSection("surfaces")})}})),Cn.createElement(que,{predicate:this.bindFn(this.shouldShowClickableSection)},()=>Cn.createElement(Aw,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>!!e.clickableInfo.enabled,isFirstOpenSection:this.const(!1)})),Cn.createElement(ym,{model:()=>e,controller:()=>this.props.controller()}),Cn.createElement("div",{class:Cn.const("dcg-triangle"),didMount:this.bindFn(this.didMountArrow),didUnmount:()=>this.arrowElt=void 0}))}didMountArrow(e){this.arrowElt=e,ap(this.arrowElt,this.controller)}shouldShowClickableSection(){let e=this.props.model();return this.controller.areActionsEnabled()&&j_(e)&&!this.controller.isItemReadonly(e.id)&&(this.controller.shouldShowAuthorFeatures()||!Yl(e))}shouldShowDragSection(){let e=this.props.model();return this.controller.shouldShowAuthorFeatures()||!Yl(e)}getSections(){let e=this.props.model();if(this.controller.isThreeDMode()){if(Jk(e))return e.extendTo3D?["surfaces"]:["lines3d"];if(N_(e))return["surfaces"];if(pf(e)||F_(e)||U_(e)||z_(e))return["lines3d"];if(zs(e)||Yk(e))return["points3d"];if(uf(e)||qy(e))return["points3d","lines3d"]}return hf(e)||Eg(e)||zy(e)||c8(e)||Cg(e)?["colors-only"]:Sg(e)?["lines"]:lh(e)?["points"]:uf(e)?["points","label","lines"]:zs(e)?e.formula.move_strategy&&this.shouldShowDragSection()?["points","label","drag"]:["points","label"]:pf(e)||vg(e)?["lines","fill"]:_p(e)?Ky(e)||Qk(e)||B_(e)?["lines"]:["lines","fill"]:["lines"]}isFirstOpenSection(e){return this.getSections().find(t=>this.isSectionOpen(t))===e}isSectionOpen(e){let t=this.props.model(),{points:i,lines:o,fill:n}=t,a=__dcg_shared_module_exports__['Ic'](t.formula.expression_type,{points:i,lines:o,fill:n},s=>{Ii("getReconciledExpressionProps [Chrome Switch Bug]",{metaData:{method:"isSectionOpen",type:s}})});switch(e){case"lines":return t.hidden?!1:a.lines;case"label":return Fd(t);case"fill":return t.hidden?!1:_p(t)?!0:a.fill;case"points":return t.hidden?!1:zs(t)?!t.hidden:a.points;case"drag":return mo(t)!=="NONE";case"colors-only":return!0;case"points3d":return t.hidden?!1:a.points;case"lines3d":case"surfaces":return t.hidden?!1:a.lines}}};var yr=__dcg_shared_module_exports__['e'](te());var{For:Hue,If:JI,Textarea:Wue}=yr.Components,QI=class extends yr.Class{template(){return yr.createElement("div",{class:yr.const("dcg-image-aria-container")},yr.createElement(Wue,{placeholder:()=>this.props.controller().s("graphing-calculator-text-add-screen-reader-label-placeholder"),value:()=>this.props.model().description,onInput:e=>this.props.controller().dispatch({type:"set-item-description",id:this.props.model().id,description:e})}))}},ZI=class extends yr.Class{init(){var e;this.controller=this.props.controller(),this.model=this.props.model(),this.guid=(e=this.controller.getOpenItemMenu())==null?void 0:e.guid}didMountArrow(e){this.arrowElt=e,ap(this.arrowElt,this.controller)}didMount(){fb(this.guid,this.controller)}willUnmount(){bb(this.guid,this.controller)}didUpdate(){ap(this.arrowElt,this.controller)}template(){let e=this.model;return yr.createElement("div",{class:yr.const("dcg-image-options-menu dcg-options-menu")},yr.createElement("div",{class:yr.const("dcg-opacities-menu dcg-options-menu-section")},yr.createElement("div",{role:yr.const("heading"),"aria-level":yr.const("2"),class:yr.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-image-opacity")),yr.createElement(Hue,{each:()=>this.controller.getImageOpacities()},yr.createElement("div",{class:yr.const("dcg-opacities-menu-flex"),role:yr.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-heading-image-opacity")},t=>yr.createElement("span",{class:yr.const("dcg-opacity-option"),role:yr.const("button"),tabindex:yr.const(0),"aria-label":()=>`opacity: ${t}`,"aria-pressed":()=>this.isOpacitySelected(t),handleevent:yr.const("true"),onTap:()=>this.onSelectOpacity(t)},yr.createElement(yn,{backgroundImage:this.bindFn(this.getBackgroundImage),iconType:()=>this.isOpacitySelected(t)?"check":"none",backgroundOpacity:()=>parseFloat(t)}))))),yr.createElement("div",{class:yr.const("dcg-styles-div dcg-options-menu-section dcg-section-without-title")},yr.createElement("div",{class:yr.const("dcg-styles-menu"),role:yr.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-narration-image-styles")},yr.createElement(xt,{checked:()=>!e.foreground,onChange:this.bindFn(this.onToggleForeground)},()=>this.controller.s("graphing-calculator-button-place-image-behind-graphs"))),yr.createElement(JI,{predicate:()=>this.shouldShowDraggableCheckbox()},()=>yr.createElement("div",{class:yr.const("dcg-draggable-checkbox-container")},yr.createElement(xt,{checked:()=>Nd(e),onChange:this.bindFn(this.onToggleDraggable)},()=>this.controller.s("graphing-calculator-button-draggable"))))),yr.createElement(JI,{predicate:()=>Nd(e)},()=>yr.createElement(QI,{...this.props})),yr.createElement(JI,{predicate:this.bindFn(this.shouldShowClickable)},()=>yr.createElement(Aw,{controller:this.props.controller,model:()=>e,isOpen:()=>!!e.clickableInfo.enabled,isFirstOpenSection:this.const(!1)})),yr.createElement(JI,{predicate:()=>!!e.clickableInfo.enabled&&!Nd(e)},()=>yr.createElement(QI,{...this.props})),yr.createElement(ym,{model:()=>e,controller:()=>this.props.controller()}),yr.createElement("div",{class:yr.const("dcg-triangle"),didMount:this.bindFn(this.didMountArrow),didUnmount:()=>this.arrowElt=void 0}))}onToggleDraggable(){Wy(this.model)?this.controller.dispatch({type:"set-image-draggable",id:this.model.id,draggable:!this.model.draggable}):this.makeDraggable()}onToggleForeground(e){this.controller.dispatch({type:"set-image-in-foreground",id:this.model.id,foreground:!e})}onSelectOpacity(e){this.controller.dispatch({type:"set-image-opacity",id:this.model.id,opacity:e})}isOpacitySelected(e){return this.model.opacity===e}getBackgroundImage(){return this.model.image_url===this.lastURL?this.lastEncodedURL:(this.lastURL=this.model.image_url,this.lastEncodedURL='url("'+AI(this.model.image_url)+'")',this.lastEncodedURL)}shouldShowClickable(){return this.controller.shouldIgnoreGraphInteractions(this.model)?!1:this.controller.areActionsEnabled()}makeDraggable(){this.controller.dispatch({type:"convert-image-to-draggable",id:this.model.id})}shouldShowDraggableCheckbox(){if(this.controller.isThreeDMode()||this.controller.shouldIgnoreGraphInteractions(this.model))return!1;let e=Wy(this.model);return e?aG(e):K8(this.model)}};var Fo=__dcg_shared_module_exports__['e'](te());var Va=__dcg_shared_module_exports__['e'](te());var eA=[.05,.1,.15,.2,.35,.5,.75,1,1.5,2,3.5,5,7.5,10,15,20],$ue=__dcg_shared_module_exports__['o'](eA),jue=__dcg_shared_module_exports__['n'](eA),RS=class extends Va.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return Va.createElement("div",{class:Va.const("dcg-slider-speed-container dcg-do-not-blur"),handleEvent:Va.const("true")},Va.createElement("span",{class:()=>({"dcg-action-slower":!0,"dcg-disabled":this.isSlowerDisabled()}),onTap:()=>this.animateSlower(),role:Va.const("button"),"aria-label":()=>this.getSlowerAriaLabel(),tabindex:()=>this.isSlowerDisabled()?-1:0,"aria-disabled":()=>this.isSlowerDisabled()},Va.createElement("i",{class:Va.const("dcg-icon-show"),"aria-hidden":Va.const("true")})),Va.createElement("span",{class:Va.const("dcg-variable-speed")},this.bindFn(this.computeSpeed),Va.const("x")),Va.createElement("span",{class:()=>({"dcg-action-faster":!0,"dcg-disabled":this.isFasterDisabled()}),onTap:()=>this.animateFaster(),role:Va.const("button"),"aria-label":()=>this.getFasterAriaLabel(),tabindex:()=>this.isFasterDisabled()?-1:0,"aria-disabled":()=>this.isFasterDisabled()},Va.createElement("i",{class:Va.const("dcg-icon-show"),"aria-hidden":Va.const("true")})))}computeSpeed(){var e=__dcg_shared_module_exports__['kd']/this.model.slider.animationPeriod;return e=Number(e.toFixed(3)),e}isSlowerDisabled(){return $ue>=this.computeSpeed()}isFasterDisabled(){return jue<=this.computeSpeed()}animateSlower(){var e=this.computeSpeed(),t=__dcg_shared_module_exports__['i'](eA,function(i){return i<e});t.length!==0&&this.setPeriodFromSpeed(__dcg_shared_module_exports__['n'](t))}animateFaster(){var e=this.computeSpeed(),t=__dcg_shared_module_exports__['i'](eA,function(i){return i>e});t.length!==0&&this.setPeriodFromSpeed(__dcg_shared_module_exports__['o'](t))}setPeriodFromSpeed(e){var t=__dcg_shared_module_exports__['kd']/e;this.controller.dispatch({type:"set-slider-animationperiod",id:this.model.id,animationPeriod:t}),Te(this.controller.s("graphing-calculator-narration-slider-animating-at-speed",{speed:e+""}))}getSlowerAriaLabel(){return this.controller.s("graphing-calculator-narration-slider-animate-slower")}getFasterAriaLabel(){return this.controller.s("graphing-calculator-narration-slider-animate-faster")}};var tA=class extends Fo.Class{init(){var e;this.controller=this.props.controller(),this.model=this.props.model(),this.guid=(e=this.controller.getOpenItemMenu())==null?void 0:e.guid}didMount(){fb(this.guid,this.controller)}willUnmount(){bb(this.guid,this.controller)}didMountArrow(e){this.arrowElt=e,ap(this.arrowElt,this.controller)}didUpdate(){ap(this.arrowElt,this.controller)}template(){let e=this.model;return Fo.createElement("div",{class:Fo.const("dcg-slider-options-view dcg-options-menu")},Fo.createElement("div",{class:Fo.const("dcg-triangle"),didMount:this.bindFn(this.didMountArrow),didUnmount:()=>this.arrowElt=void 0}),Fo.createElement("div",{class:Fo.const("dcg-slider-menu")},Fo.createElement("div",{role:Fo.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-heading-slider-animation-mode")},Fo.createElement("div",{role:Fo.const("heading"),"aria-level":Fo.const("2"),class:Fo.const("dcg-title")},()=>this.controller.s("graphing-calculator-heading-slider-animation-mode")),Fo.createElement(Xi,{ariaGroupLabel:()=>this.controller.s("graphing-calculator-heading-slider-animation-mode"),staticConfig:this.bindFn(this.getAnimationOptions),theme:this.const("mini")}))),Fo.createElement("div",{class:Fo.const("dcg-slider-menu dcg-slider-speed-menu"),role:Fo.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-heading-slider-speed")},Fo.createElement("div",{role:Fo.const("heading"),"aria-level":Fo.const("2"),class:Fo.const("dcg-title")},()=>this.controller.s("graphing-calculator-heading-slider-speed")),Fo.createElement("div",{class:Fo.const("dcg-slider-speed-container")},Fo.createElement(RS,{model:()=>e,controller:this.props.controller}))))}getAnimationOptions(){let e=this.model;return["LOOP_FORWARD_REVERSE","LOOP_FORWARD","PLAY_ONCE","PLAY_INDEFINITELY"].map(i=>({key:i,icon:()=>__dcg_shared_module_exports__['ac'](i),tooltip:()=>this.getTooltip(i),tooltipGravity:this.const("s"),selected:()=>this.isSelected(i),onSelect:()=>{this.controller.dispatch({type:"set-slider-loopmode",id:e.id,loopMode:i})}}))}getTooltip(e){let t=this.controller.s;switch(e){case"LOOP_FORWARD_REVERSE":return t("graphing-calculator-narration-slider-loop-forwards-and-backwards");case"LOOP_FORWARD":return t("graphing-calculator-narration-slider-repeat-one-direction");case"PLAY_ONCE":return t("graphing-calculator-narration-slider-play-once");case"PLAY_INDEFINITELY":return t("graphing-calculator-narration-slider-play-indefinitely")}}isSelected(e){return this.model.slider.loopMode===e}};var tl=__dcg_shared_module_exports__['e'](te());var{For:Yue}=tl.Components,rA=class extends tl.Class{init(){var e;this.controller=this.props.controller(),this.model=this.props.model(),this.guid=(e=this.controller.getOpenItemMenu())==null?void 0:e.guid}didMount(){fb(this.guid,this.controller)}willUnmount(){bb(this.guid,this.controller)}didMountArrow(e){this.arrowElt=e,ap(this.arrowElt,this.controller)}didUpdate(){ap(this.arrowElt,this.controller)}template(){let e=this.model;return tl.createElement("div",{class:()=>({"dcg-table-column-menu":!0,"dcg-options-menu":!0}),role:tl.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-options-menu")},tl.createElement(Yue,{each:this.bindFn(this.getSections)},tl.createElement("div",null,t=>{switch(t){case"points":return tl.createElement(Lw,{model:()=>e,controller:this.props.controller,isOpen:()=>this.isSectionOpen("points"),isFirstOpenSection:()=>this.isFirstOpenSection("points")});case"drag":return tl.createElement(_w,{model:()=>e,controller:this.props.controller,isOpen:()=>this.isSectionOpen("drag"),isFirstOpenSection:()=>this.isFirstOpenSection("drag")});case"lines":return tl.createElement(Iw,{model:()=>e,controller:this.props.controller,isOpen:()=>this.isSectionOpen("lines"),isFirstOpenSection:()=>this.isFirstOpenSection("lines")})}})),tl.createElement(ym,{model:()=>e,controller:()=>this.props.controller()}),tl.createElement("div",{class:tl.const("dcg-triangle"),didMount:this.bindFn(this.didMountArrow),didUnmount:()=>this.arrowElt=void 0}))}getSections(){return this.model.draggable&&!this.controller.isThreeDMode()&&!this.controller.shouldIgnoreGraphInteractions(this.model)?["points","lines","drag"]:["points","lines"]}isFirstOpenSection(e){let t=this.getSections();for(let i of t){if(i===e)return this.isSectionOpen(e);if(this.isSectionOpen(i))return!1}return!1}isSectionOpen(e){switch(e){case"drag":return this.model.dragMode!=="NONE";case"lines":return!!this.model.lines;case"points":return!!this.model.points}}};var gd=__dcg_shared_module_exports__['e'](te());var To=__dcg_shared_module_exports__['e'](te());var yb=__dcg_shared_module_exports__['e'](te());var xm=class extends yb.Class{hide({device:e}){this.props.controller().dispatch({type:"dismiss-notice",focusFirstExpression:e==="keyboard"})}template(){return yb.createElement("i",{class:()=>({"dcg-icon-remove":!0,"dcg-close-notice-icon":!0,"dcg-theme-dark":this.props.theme()==="dark","dcg-theme-light":this.props.theme()==="light"}),role:yb.const("button"),tabindex:yb.const("0"),"aria-label":()=>Pn("shared-button-close-message"),onTap:this.bindFn(this.hide)})}};var iA=class extends To.Class{init(){this.controller=this.props.controller(),this.s=this.controller.s}template(){return To.createElement("aside",{class:To.const("dcg-notice dcg-notice--3d")},To.createElement(xm,{controller:this.props.controller,theme:this.const("dark")}),To.createElement("h2",{class:To.const("dcg-notice__title")},()=>this.s("account-shell-text-welcome-to-3d")),To.createElement("div",{class:To.const("dcg-notice__message")},To.createElement(yi,{i18n:this.props.controller,key:this.const("account-shell-text-3d-expression-list-notice")},To.const("Please share any bugs, questions, or suggestions at:"),To.const(" "),To.createElement("a",{class:To.const(""),href:To.const("mailto:feedback@desmos.com")},To.const("feedback@desmos.com")))),To.createElement("div",{class:To.const("dcg-notice__actions")},To.createElement("a",{class:To.const("dcg-btn-white-outline dcg-unstyled-button dcg-flexed-notice-btn"),href:To.const("//blog.desmos.com/articles/beta-3d-release/"),target:To.const("_blank")},()=>this.s("account-shell-link-read-blog"),To.createElement("span",{class:To.const("dcg-sr-only")},()=>this.s("account-shell-link-read-blog"))),To.createElement("button",{class:To.const("dcg-unstyled-button dcg-notice__action--primary dcg-flexed-notice-btn"),onTap:()=>{var e,t;return(t=(e=this.controller).showQuestModal)==null?void 0:t.call(e)}},()=>this.s("account-shell-link-try-a-quest"))))}};var Gl=__dcg_shared_module_exports__['e'](te());var oA=class extends Gl.Class{init(){this.controller=this.props.controller()}template(){return Gl.createElement("aside",{class:Gl.const("dcg-notice dcg-notice--terms")},Gl.createElement(xm,{controller:this.props.controller,theme:this.const("light")}),Gl.createElement("div",{class:Gl.const("dcg-notice__message")},()=>this.controller.s("frontpage-text-header-terms-update")),Gl.createElement("div",{class:Gl.const("dcg-notice__actions")},Gl.createElement("a",{href:Gl.const("//blog.desmos.com/articles/desmos-studio-terms-update//"),target:Gl.const("_blank"),class:Gl.const("dcg-notice__action dcg-btn-gray-outline")},()=>this.controller.s("account-shell-link-read-blog"))))}};var Mc=__dcg_shared_module_exports__['e'](te());var nA=class extends Mc.Class{init(){this.controller=this.props.controller()}template(){return Mc.createElement("aside",{class:Mc.const("dcg-notice dcg-notice--art-contest")},Mc.createElement(xm,{controller:this.props.controller,theme:this.const("light")}),Mc.createElement("h2",{class:Mc.const("dcg-notice__title")},()=>this.controller.s("account-shell-label-math-art-contest")),Mc.createElement("div",{class:Mc.const("dcg-notice__message")},()=>this.controller.isGeometry()?this.controller.s("account-shell-label-art-contest-nudge-construction"):this.controller.s("account-shell-label-art-contest-nudge-graph")),Mc.createElement("button",{onTap:()=>{this.controller.showContestDropdown(),this.controller.dispatch({type:"dismiss-notice"})},class:Mc.const("dcg-btn-gray-outline")},()=>this.controller.s("account-shell-label-join-contest")))}};var{Switch:Xue}=gd.Components,aA=class extends gd.Class{template(){return gd.createElement("div",{class:gd.const("dcg-notice-wrapper")},gd.createElement(Xue,{key:this.props.id},e=>{switch(e){case"3d-art-contest":return gd.createElement(iA,{controller:this.props.controller});case"art-contest":return gd.createElement(nA,{controller:this.props.controller});case"terms":return gd.createElement(oA,{controller:this.props.controller})}}))}};var{If:md,IfDefined:sA,For:Jue,Switch:wX,SwitchUnion:Que,IfElse:Zue}=wt.Components,FS=class extends wt.Class{constructor(){super(...arguments),this.guid=__dcg_shared_module_exports__['K']("listView")}init(){this.controller=this.props.controller()}template(){return wt.createElement("div",{didMount:this.bindFn(this.didMountContainer)},wt.createElement("div",{class:wt.const("dcg-exppanel-outer"),onDrop:this.bindFn(this.onDrop),style:()=>this.computeExppanelOuterStyle()},wt.createElement(md,{predicate:()=>this.controller.isFileDraggedOver()},()=>wt.createElement("div",{class:wt.const("dcg-drop-image")},wt.createElement("span",null,()=>this.controller.s("graphing-calculator-label-drop-image-here")))),wt.createElement("div",{class:()=>{var e;return{"dcg-exppanel-container":!0,"dcg-add-shadow":this.controller.shouldRenderList(),"dcg-global-mute-on":!!((e=this.controller.toneController)!=null&&e.isGlobalMuted())}},style:()=>({transform:this.controller.isListVisible()?void 0:this.controller.isNarrow()?"translate(0, 100%)":"translate(-100%, 0)"})},wt.createElement(md,{predicate:()=>this.controller.shouldRenderList()},()=>wt.createElement(PS,{controller:this.props.controller,expsScrolled:()=>!!this.exppanel&&this.exppanel.scrollTop>0})),wt.createElement(md,{predicate:()=>this.controller.getExpressionSearchOpen()},()=>wt.createElement(RI,{controller:this.props.controller,expsScrolled:()=>!!this.exppanel&&this.exppanel.scrollTop>0})),wt.createElement(md,{predicate:()=>this.controller.getTickerVisible()},()=>wt.createElement(FI,{controller:this.props.controller,expsScrolled:()=>!!this.exppanel&&this.exppanel.scrollTop>0})),wt.createElement(md,{predicate:()=>this.controller.shouldRenderList()},()=>wt.createElement("div",{class:()=>({"dcg-exppanel":!0,"dcg-disable-horizontal-scroll-to-cursor":!0,"dcg-isDragging":this.controller.isDragDropActive(),"dcg-has-background-color":this.controller.hasBackgroundColor(),"dcg-edit-list-mode":this.controller.isInEditListMode()}),style:()=>({background:this.controller.getBackgroundColor()}),onPaste:this.bindFn(this.onPaste),onTapStart:this.bindFn(this.onExppanelTapstart),didMount:this.bindFn(this.didMountExppanel)},wt.createElement("div",{class:wt.const("dcg-expressionlist"),role:wt.const("region"),"aria-label":()=>this.controller.s("shared-calculator-narration-expression-list")},wt.createElement(md,{predicate:()=>this.controller.getShowConstructionsOpen()},()=>wt.createElement(NI,{controller:this.props.controller,onDragPending:(e,t)=>this.onDragPending(e,t)})),wt.createElement(Jue,{each:()=>this.controller.getAllItemModels(),key:e=>e.guid},wt.createElement("span",{class:wt.const("dcg-template-expressioneach")},e=>Que(()=>jG(e),{shell:()=>this.makeShellViewForModel(e),render:()=>this.makeViewForModel(e),none:()=>{}}))),wt.createElement(AS,{controller:()=>this.props.controller()}),wt.createElement(wX,{key:()=>this.controller.getDraggedItemId()},e=>{if(e){let t=this.controller.getItemModel(e);return wt.createElement(IS,{controller:this.props.controller},this.makeDragCopyViewForModel(t))}else return}),wt.createElement("span",{style:wt.const("flex:1")}),wt.createElement(md,{predicate:()=>!!this.controller.getNoticeId()&&!this.controller.isKeypadOpen()},()=>wt.createElement(aA,{controller:this.const(this.controller),id:()=>this.controller.getNoticeId()})),wt.createElement(md,{predicate:()=>!this.controller.isKeypadOpen()},()=>wt.createElement("div",{class:wt.const("dcg-expressions-branding")},Zue(()=>this.controller.canEditOnWeb(),{true:()=>wt.createElement("span",{role:wt.const("link"),tabindex:wt.const(0),class:wt.const("dcg-edit-branding"),onTap:()=>this.controller.dispatch({type:"open-on-web"})},wt.createElement("div",{class:wt.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-graph-on-desmos")},()=>this.controller.s("graphing-calculator-button-edit-graph-on-desmos-logo")),wt.createElement("i",{class:wt.const("dcg-icon-desmos"),"aria-hidden":wt.const("true")})),false:()=>wt.createElement("div",null,wt.createElement("div",{class:wt.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-powered-by-desmos")},()=>this.controller.s("graphing-calculator-label-powered-by")),wt.createElement("i",{class:wt.const("dcg-icon-desmos"),"aria-hidden":wt.const("true")}))}))))))),wt.createElement(OI,{controller:this.props.controller})),wt.createElement(md,{predicate:()=>this.isOptionsViewOpen("expression")},()=>wt.createElement(td,{menuType:this.const("expression"),menuButtonFocusLocation:()=>{let e=this.getActiveExpressionModelForOptionsView();return e?{type:"expression-icon",id:e.id}:void 0},...this.getSharedDropdownWrapperProps()},sA(this.bindFn(this.getActiveExpressionModelForOptionsView),e=>wt.createElement(Ow,{controller:this.props.controller,model:e})))),wt.createElement(md,{predicate:()=>this.isOptionsViewOpen("image")},()=>wt.createElement(td,{menuType:this.const("image"),menuButtonFocusLocation:()=>{let e=this.getActiveImageModelForOptionsView();return e?{type:"image-icon",id:e.id}:void 0},...this.getSharedDropdownWrapperProps()},sA(this.bindFn(this.getActiveImageModelForOptionsView),e=>wt.createElement(ZI,{controller:this.props.controller,model:e})))),wt.createElement(md,{predicate:()=>this.isOptionsViewOpen("slider")},()=>wt.createElement(td,{menuType:this.const("slider"),menuButtonFocusLocation:()=>{let e=this.getActiveSliderModelForOptionsView();return e?{type:"slider-icon",id:e.id}:void 0},...this.getSharedDropdownWrapperProps()},sA(this.bindFn(this.getActiveSliderModelForOptionsView),e=>wt.createElement(tA,{controller:this.props.controller,model:e})))),wt.createElement(md,{predicate:()=>this.isOptionsViewOpen("table-column")},()=>wt.createElement(td,{menuType:this.const("table-column"),menuButtonFocusLocation:()=>{let e=this.getActiveColumnModelForOptionsView();return e?{type:"table-icon",id:e.table.id,columnId:e.id}:void 0},...this.getSharedDropdownWrapperProps()},sA(this.bindFn(this.getActiveColumnModelForOptionsView),e=>wt.createElement(rA,{controller:this.props.controller,model:e})))))}getSharedDropdownWrapperProps(){return{rootElSelector:this.const(".dcg-container"),openAriaAlert:this.const(this.controller.s("graphing-calculator-narration-options-menu-open")),closeAriaAlert:this.const(this.controller.s("graphing-calculator-narration-options-menu-closed")),focusOnOpen:this.bindFn(this.optionsViewFocusLocation),shouldHandleTabAndEscape:this.const(!0),controller:this.props.controller}}optionsViewFocusLocation(){let e=this.controller.getOpenItemMenu();if(!e||!("model"in e))return"none";let{model:t}=e;if(!t)return"none";let i=this.controller.getFocusLocation();if(!i||i.type!=="expression-menu"||i.id!==t.id)return"none";switch(i.location){case"start":return"first";case"end":return"last";default:return"none"}}getActiveSliderModelForOptionsView(){let e=this.controller.getOpenItemMenu();return e&&e.type==="slider"&&"model"in e?e.model:void 0}getActiveImageModelForOptionsView(){let e=this.controller.getOpenItemMenu();return e&&e.type==="image"&&"model"in e?e.model:void 0}getActiveExpressionModelForOptionsView(){let e=this.controller.getOpenItemMenu();return e&&e.type==="expression"&&"model"in e?e.model:void 0}getActiveColumnModelForOptionsView(){let e=this.controller.getOpenItemMenu();return e&&e.type==="table-column"&&"model"in e?e.model:void 0}isOptionsViewOpen(e){let t=this.controller.getOpenItemMenu();return!!t&&t.type===e}makeShellViewForModel(e){return wt.createElement(MS,{controller:this.props.controller,model:()=>e,onDragPending:()=>{},isDragCopy:()=>!1})}computeExppanelOuterStyle(){this.getListBottomAndUpdateLastExpressionPadding();let{list:e}=this.controller.computeMajorLayout(),t=0,i=e.top;return e.top>0&&!this.controller.isListVisible()&&(i-=e.height),{position:"absolute",left:t+"px",top:i+"px",width:e.width+"px",height:e.height+"px"}}makeDragCopyViewForModel(e){return this.makeViewForModel(e,!0)}makeViewForModel(e,t=!1){var i;if(e.type==="table")i=wt.createElement(SS,{controller:this.props.controller,model:()=>e,onDragPending:o=>this.onDragPending(o,{type:"expression",calcId:e.id}),isDragCopy:()=>t});else if(e.type==="folder")i=wt.createElement(DS,{controller:this.props.controller,model:()=>e,onDragPending:o=>this.onDragPending(o,{type:"expression",calcId:e.id}),isDragCopy:()=>t});else if(e.type==="text")i=wt.createElement(xS,{controller:this.props.controller,model:()=>e,onDragPending:o=>this.onDragPending(o,{type:"expression",calcId:e.id}),isDragCopy:()=>t});else if(e.type==="image")i=wt.createElement(GS,{controller:this.props.controller,model:()=>e,onDragPending:o=>this.onDragPending(o,{type:"expression",calcId:e.id}),isDragCopy:()=>t});else if(e.type==="expression")i=wt.createElement(wX,{key:()=>t&&this.controller.shouldRenderDraggedItemAsToken()},o=>o?wt.createElement($p,{showParentChildrenHover:this.const(!1),controller:this.props.controller,identifier:()=>this.controller.getDraggedIdentifier(),insideMQ:this.const(!1),insideGroup:this.const(!1),putInTabOrder:()=>!1}):wt.createElement(hb,{controller:this.props.controller,model:()=>e,onDragPending:n=>this.onDragPending(n,{type:"expression",calcId:e.id}),isDragCopy:()=>t}));else return;return i}didUnmount(){ie(document.documentElement).off("."+this.guid)}didMountContainer(e){this.node=e,ie(document.documentElement).on("keydown."+this.guid,this.bindFn(this.handleKeyDown))}didMountExppanel(e){this.exppanel=e,e.onscroll=()=>this.controller.markTickRequiredNextFrame()}getListBottomAndUpdateLastExpressionPadding(){let e=this.controller.getKeypadHeight(),t=this.__listBottom||0;return this.__listBottom=e,e===0&&t!==0&&KP()&&this.padLastExpressionUntilTapEnd(t),e}padLastExpression(e){let t=this.node.querySelector(".dcg-expressionitem.dcg-new-expression");t.style.marginBottom=e+"px"}unpadLastExpression(){let e=this.node.querySelector(".dcg-expressionitem.dcg-new-expression");e.style.marginBottom="0"}padLastExpressionUntilTapEnd(e){this.padLastExpression(e),ie(document).on("dcg-tap.animating-bottom",()=>{this.unpadLastExpression(),ie(document).off("dcg-tap.animating-bottom")})}handleKeyDown(e){var a;if(this.controller.inAudioTraceMode())return;let t=Be(e),i=ji(e),o=this.controller.getSelectedItem();if(!o){(t===Nc||t===cy)&&!this.controller.needsFakeKeypad()&&this.controller.hasMultipleItemsSelected()&&this.controller.dispatch({type:"delete-all-selected-items"});return}if(e.altKey&&!e.ctrlKey&&!e.metaKey&&e.shiftKey&&i==="T"&&o){if(!this.controller.isGeometry()||!Xc(o))return;e.preventDefault(),e.stopPropagation(),this.controller.convertToTokenAssignment(o);let s=this.controller.getGeometryFolder();if(s){let c=s.index+this.controller.getNumberOfItemsInFolder(s.id);Ba(o,s.id),o.index!==c&&Mg(this.controller.getListModel(),o.index,c,1)}this.controller.ensureAtLeastOneVisibleItem();let l=(a=mn(o))==null?void 0:a.identifier;l&&this.controller.getShowConstructionsOpen()&&this.controller.dispatch({type:"set-focus-location",location:{type:"geo-token",identifier:l}});return}let n=this.controller.getFocusLocation();if(e.ctrlKey&&e.shiftKey&&!e.metaKey&&!e.altKey&&n!==void 0){if(i==="O"){e.preventDefault(),e.stopPropagation();let s;if(o.type==="expression")!o.sliderExists&&!Uy(o)?(s={type:"expression",model:o,guid:o.guid,focusFirstOption:!0,previousFocusLocation:n},this.controller.dispatch({type:"set-focus-location",location:{type:"expression-icon",id:o.id}})):o.sliderExists&&(s={type:"slider",model:o,guid:"slider-"+o.guid,focusFirstOption:!0,previousFocusLocation:n},this.controller.dispatch({type:"set-focus-location",location:{type:"slider-animation-properties-icon",id:o.id}}));else if(o.type==="image")s={type:"image",model:o,guid:o.guid,focusFirstOption:!0,previousFocusLocation:n},this.controller.dispatch({type:"set-focus-location",location:{type:"image-icon",id:o.id}});else if(o.type==="table"&&n.type==="table"){let l=n.location;if(!l)return;let c=o.columnModels[l.column];if(!c||c.latex===""||!this.controller.getGraphSettings().config.graphpaper||c.error||c.index===0)return;s={type:"table-column",model:c,guid:c.guid,focusFirstOption:!0,previousFocusLocation:n},this.controller.dispatch({type:"set-focus-location",location:{type:"table-icon",id:o.id,columnId:c.id}})}if(!s)return;this.controller.dispatch({type:"toggle-item-settings-menu",menu:s});return}else if(i==="D"){if(this.controller.isItemReadonly(o.id)&&!this.controller.isInEditListMode())return;e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"delete-item-and-animate-out",id:o.id,setFocusAfterDelete:!0});return}}if(this.controller.isInEditListMode()&&!e.altKey&&!e.ctrlKey&&!e.metaKey){if(t===cl&&n!==void 0){let s=this.controller.getItemModelByIndex(0);if(!s)return;let l=(n.type==="readonly-expression"&&s.type==="expression"||n.type==="table-container"&&s.type==="table"||n.type===s.type)&&n.id===s.id,c={type:"edit-list-toggle"},d=this.controller.isFocusLocationFocused(c);e.shiftKey&&l?(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-focus-location",location:c})):!e.shiftKey&&d&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"move-focus-to-item",id:s.id,where:s.type==="table"?"container":void 0}))}else if(t===un||t===hn){let s=this.controller.getListModel(),l=t===un?bf(s,o.index):yf(s,o.index);if(!l)return;this.controller.dispatch({type:"move-focus-to-item",id:l.id,where:l.type==="table"?"container":"start"})}return}if(t===rn&&this.controller.getExpressionSearchOpen()&&this.controller.dispatch({type:"close-expression-search"}),!(document.activeElement&&ie.contains(document.body,document.activeElement))&&!this.exppanel.contains(e.target)&&ie.contains(document.documentElement,e.target))switch(t){case un:e.preventDefault(),this.controller.dispatch({type:"select-previous-expression"});break;case hn:e.preventDefault(),this.controller.dispatch({type:"select-next-expression"});break;case rn:e.preventDefault(),this.controller.dispatch({type:"set-none-selected"});break;case Gp:e.preventDefault(),o&&(o.type==="expression"&&o.sliderExists?(this.controller.dispatch({type:"adjust-slider-by-keyboard",id:o.id,adjustment:"up"}),this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:o.id}})):this.controller.dispatch({type:"move-focus-to-item",id:o.id,where:"start"}));break;case cl:e.preventDefault(),o&&this.controller.dispatch({type:"move-focus-to-item",id:o.id,where:"start"});break;case kp:e.preventDefault(),o&&(o.type==="expression"&&o.sliderExists?(this.controller.dispatch({type:"adjust-slider-by-keyboard",id:o.id,adjustment:"down"}),this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:o.id}})):this.controller.dispatch({type:"move-focus-to-item",id:o.id,where:"end"}));break;case Nc:e.preventDefault(),o&&!this.controller.isItemReadonly(o.id)&&this.controller.dispatch({type:"upward-delete-selected-expression"});break;case cy:e.preventDefault(),o&&!this.controller.isItemReadonly(o.id)&&this.controller.dispatch({type:"downward-delete-selected-expression"});break;case dl:e.wasHandled("create-expression-with-keyboard")||(e.preventDefault(),e.handle("create-expression-with-keyboard"),o&&this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"}));break;default:if(e.metaKey||e.ctrlKey||t===Kv||t===lg)return;o&&(o.type==="table"||this.controller.dispatch({type:"move-focus-to-item",id:o.id,where:"end"}))}}onDragPending(e,t){e.preventDefault(),pi();var i={x:e.touches[0].clientX,y:e.touches[0].clientY},o={x:i.x,y:i.y},n=setTimeout(()=>{ie(document).off(".dragpending"),this.onDragStart(e,t,i,o)},500);ie(document).on("dcg-tapmove.dragpending",a=>{o={x:a.touches[0].clientX,y:a.touches[0].clientY},(Math.abs(o.y-i.y)>3||Math.abs(o.x-i.x)>3)&&(clearTimeout(n),ie(document).off(".dragpending"),this.onDragStart(e,t,i,o))}),ie(document).on("dcg-tapend.dragpending",function(){clearTimeout(n),ie(document).off(".dragpending")})}onDragStart(e,t,i,o){e.touches.length===1&&(e.wasHandled("dcg-longhold")||this.controller.dispatch({type:"start-dragdrop",dragTarget:t,grabPt:i,mousePt:o}))}onExppanelTapstart(e){e.device!=="mouse"&&(e.target.closest(".dcg-expressionitem")||pi())}onPaste(e){let t=this.controller.getGraphSettings().config;var i=ZY(e);if(!i)return;var o=this.controller.getSelectedItem();if(this.controller.canLoadPastedLink(i)&&o&&o.type==="folder"&&o.title===""){e.stopPropagation(),e.preventDefault(),_I(this.controller,i,(a,s)=>s(null,a));return}if(o&&(o.type==="text"||o.type==="folder"))return;if(this.controller.canLoadPastedLink(i)){e.stopPropagation(),e.preventDefault();let a=t.pasteGraphLinkCallback?t.pasteGraphLinkCallback:(s,l)=>l(null,s);_I(this.controller,i,a);return}if(t.pasteTableData){let a=JY(i);if(a!==void 0)return e.stopPropagation(),e.preventDefault(),this.controller.dispatch({type:"paste-table",data:a})}let n=XY(i);if(n!==void 0){e.stopPropagation(),e.preventDefault();let a=[];n.length===1&&n[0].numberList?this.controller.dispatch({type:"append-number-list",latex:n[0].content}):(n.forEach(s=>{a.push({type:"expression",id:this.controller.generateId(),latex:s.content})}),this.controller.dispatch({type:"insert-several-expressions",expressions:a}));return}}onDrop(e){if(!this.controller.areImagesEnabled())return;let t=e.dataTransfer&&e.dataTransfer.files;t&&t.length&&this.controller.dispatch({type:"new-images",files:t})}};var sr=__dcg_shared_module_exports__['e'](te());var vX=__dcg_shared_module_exports__['e'](te());var c3=class c3 extends vX.Class{init(){this.controller=this.props.controller(),this.dispatch=this.controller.dispatch,this.s=this.controller.s}};c3.uuid=Ng();var an=c3;var Bw=__dcg_shared_module_exports__['e'](te());var Fh=__dcg_shared_module_exports__['e'](te()),Ar=class extends Fh.Class{template(){return Fh.createElement("div",{class:()=>({"dcg-keypad-btn-container":!0,"dcg-disabled":this.isDisabled()}),style:()=>({"flex-grow":this.getColSpan()})},Fh.createElement("span",{role:Fh.const("button"),class:this.bindFn(this.getClasses),"dcg-command":this.props.command,"aria-label":this.bindFn(this.getAriaLabel),"aria-disabled":this.bindFn(this.isDisabled),"aria-controls":this.props.ariaControls?this.props.ariaControls:this.const(void 0),"aria-expanded":this.props.ariaExpanded?this.bindFn(this.getAriaExpanded):this.const(void 0),onTap:()=>{this.isDisabled()||this.props.onTap()}},Fh.createElement("span",{class:Fh.const("dcg-keypad-btn-content")},this.children)))}getClasses(){let e={"dcg-keypad-btn":!0,"dcg-keypad-btn-active":this.isActive()},t=this.props.style();switch(t){case"default":e["dcg-btn-light-on-gray"]=!0;break;case"highlight":e["dcg-btn-dark-on-gray"]=!0;break;case"popover":e["dcg-btn-light-gray"]=!0;break;case"blue":e["dcg-btn-short-blue"]=!0;break;case"tall-blue":e["dcg-btn-tall-blue"]=!0;break;default:return t}return e}isActive(){return this.props.active?this.props.active():!1}getAriaLabel(){return this.props.ariaLabel?this.props.ariaLabel():this.props.command()}getColSpan(){if(this.props.colspan)return this.props.colspan()}isDisabled(){return this.props.disabled&&this.props.disabled()}getAriaExpanded(){return this.props.ariaExpanded?this.props.ariaExpanded():void 0}};var ue=__dcg_shared_module_exports__['e'](te()),{IfElse:SX,If:CX,Switch:ehe}=ue.Components;function Xr(r,e){return r===void 0?ue.const(e):typeof r=="function"?r:ue.const(r)}function Rw(r){return(e,t,i={},o)=>ue.createElement(Ar,{command:ue.const(r.command||r.typedText||r.keys[0]),ariaLabel:()=>r.ariaLabelKey?o(r.ariaLabelKey):r.typedText||r.keys[0],colspan:Xr(i.colspan,1),style:()=>i.style||"default",onTap:()=>t({type:"keypad/type-text",text:r.typedText||r.keys[0]})},SX(()=>r.keys[0]==="{"||r.keys[0]==="[",{true:()=>ue.createElement("span",{class:ue.const("dcg-mq-math-mode"),style:ue.const("font-size: 120%")},ue.const(r.keys[0]),ue.const("\xA0"),ue.createElement("span",{style:ue.const("color: #999")},ue.const(r.keys[1]))),false:()=>ue.createElement("span",{class:ue.const("dcg-either-or-btn")},ue.createElement(lt,{config:ue.const({}),latex:ue.const(r.keys[0])}),ue.createElement("span",{style:ue.const("color: #999")},ue.createElement(lt,{config:ue.const({}),latex:ue.const(r.keys[1])})))}))}function Fw(r){return(e,t,i={},o)=>ue.createElement(Ar,{command:ue.const(r.command||r.typedText||r.keys[1]),ariaLabel:()=>r.ariaLabelKey?o(r.ariaLabelKey):r.typedText||r.keys[0],colspan:Xr(i.colspan,1),style:Xr(i.style,"default"),onTap:()=>t({type:"keypad/type-text",text:r.typedText||r.keys[1]})},SX(()=>r.keys[1]==="}"||r.keys[1]==="]",{true:()=>ue.createElement("span",{class:ue.const("dcg-mq-math-mode"),style:ue.const("font-size: 120%")},ue.createElement("span",{style:ue.const("color: #999")},ue.const(r.keys[0])),ue.const("\xA0"),ue.const(r.keys[1])),false:()=>ue.createElement("span",null,ue.createElement("span",{style:ue.const("color: #999")},ue.createElement(lt,{config:ue.const({}),latex:ue.const(r.keys[0])})),ue.createElement(lt,{config:ue.const({}),latex:ue.const(r.keys[1])}))}))}function the(r){return(e,t,i={},o)=>ue.createElement(Ar,{command:ue.const(r.command),ariaLabel:()=>r.ariaLabelKey?o(r.ariaLabelKey):e,colspan:Xr(i.colspan,1),style:()=>i.style||"default",onTap:()=>{t({type:"keypad/audio-trace",command:r.command})}},ue.createElement(CX,{predicate:ue.const(r.iconClass!==void 0)},()=>ue.createElement("span",{class:()=>({"dcg-button-icon":!0,"dcg-icon-only":r.contentKey===void 0})},ue.createElement("i",{class:ue.const(r.iconClass),"aria-hidden":ue.const("true")}))),ue.createElement(CX,{predicate:ue.const(r.contentKey!==void 0)},()=>ue.createElement("span",null,()=>o(r.contentKey)||e)))}function ze(r){return(e,t,i={},o)=>ue.createElement(Ar,{command:ue.const(r.command||e),ariaLabel:()=>r.ariaLabelKey?o(r.ariaLabelKey):e,colspan:Xr(i.colspan,1),style:()=>i.style||"default",onTap:()=>t({type:"keypad/type-text",text:r.typedText||e})},ue.createElement(lt,{config:ue.const({}),latex:ue.const(r.content||e)}))}function EX(r){return(e,t,i={},o)=>ue.createElement(Ar,{command:ue.const(r.command||e),ariaLabel:()=>r.ariaLabelKey?o(r.ariaLabelKey):e,colspan:Xr(i.colspan,1),style:()=>i.style||"default",onTap:()=>t({type:"keypad/type-text",text:r.typedText||e})},ue.createElement("span",{class:ue.const("dcg-mq-math-mode")},ue.const(r.content||e)))}function Xe(r){return(e,t,i={},o)=>ue.createElement(Ar,{command:ue.const(e),ariaLabel:()=>r.ariaLabelKey?o(r.ariaLabelKey):e,colspan:Xr(i.colspan,1),style:()=>i.style||"default",onTap:()=>t({type:"keypad/type-text",text:e+"("})},ue.createElement(ehe,{key:()=>e.match(/^[a-z]{2,}$/)},n=>n?ue.createElement("span",{class:ue.const("dcg-mq-math-mode dcg-static-mathquill-view")},ue.createElement("span",{class:ue.const("dcg-mq-root-block")},ue.createElement("span",{class:ue.const("dcg-mq-operator-name")},()=>e))):ue.createElement(lt,{config:ue.const({}),latex:ue.const(e)})))}function ts(r){return(e,t,i={},o)=>ue.createElement(Ar,{command:ue.const(r.command),ariaLabel:()=>r.ariaLabelKey?o(r.ariaLabelKey):r.command,colspan:Xr(i.colspan,1),style:()=>i.style||"default",onTap:()=>{t({type:"keypad/custom-command",command:r.command})}},ue.createElement(lt,{config:ue.const({}),latex:ue.const(r.content)}))}var rhe={"{":EX({ariaLabelKey:"shared-calculator-narration-keypad-key-left-bracket"}),"}":EX({ariaLabelKey:"shared-calculator-narration-keypad-key-right-bracket"}),"(":ze({ariaLabelKey:"shared-calculator-narration-keypad-key-left-paren"}),")":ze({ariaLabelKey:"shared-calculator-narration-keypad-key-right-paren"}),sqrt:ze({content:"\\sqrt{}",ariaLabelKey:"shared-calculator-narration-keypad-key-sqrt"}),"/":ze({ariaLabelKey:"shared-calculator-narration-keypad-key-divide"}),division:ze({content:"\xF7",typedText:"/",command:"/",ariaLabelKey:"shared-calculator-narration-keypad-key-divide"}),obelus:ze({content:"\xF7",typedText:"\xF7",ariaLabelKey:"shared-calculator-narration-keypad-key-divide"}),"*":ze({ariaLabelKey:"shared-calculator-narration-keypad-key-times"}),multiplication:ze({content:"\xD7",typedText:"*",command:"*",ariaLabelKey:"shared-calculator-narration-keypad-key-times"}),"\xB1":ze({ariaLabelKey:"shared-calculator-narration-keypad-plus-minus"}),"-":ze({ariaLabelKey:"shared-calculator-narration-keypad-key-minus"}),"+":ze({ariaLabelKey:"shared-calculator-narration-keypad-key-plus"}),".":ze({ariaLabelKey:"shared-calculator-narration-keypad-key-decimal"}),ans:(r,e,t={},i)=>ue.createElement(Ar,{command:ue.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-ans"),colspan:Xr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/type-text",text:r})},ue.const("ans")),enter:(r,e,t={},i)=>ue.createElement(Ar,{command:ue.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-enter"),colspan:Xr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/press-key",key:"Enter"})},ue.createElement("i",{class:ue.const("dcg-icon-arrow-enter"),"aria-hidden":ue.const("true")})),shift:(r,e,t={},i)=>ue.createElement(Ar,{command:ue.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-shift"),colspan:Xr(t.colspan,1),style:()=>t.style||"default",active:Xr(t.active,!1),onTap:()=>e({type:"keypad/shift"})},ue.createElement("i",{class:ue.const("dcg-icon-shift"),"aria-hidden":ue.const("true")})),left:(r,e,t={},i)=>ue.createElement(Ar,{command:ue.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-left-arrow"),colspan:Xr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/press-key",key:"Left"})},ue.createElement("i",{class:ue.const("dcg-icon-arrow-left"),"aria-hidden":ue.const("true")})),right:(r,e,t={},i)=>ue.createElement(Ar,{command:ue.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-right-arrow"),colspan:Xr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/press-key",key:"Right"})},ue.createElement("i",{class:ue.const("dcg-icon-arrow-right"),"aria-hidden":ue.const("true")})),123:(r,e,t={},i)=>ue.createElement(Ar,{command:ue.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-toggle-numbers"),colspan:Xr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/123"})},ue.const("1 2 3")),ABC:(r,e,t={},i)=>ue.createElement(Ar,{command:ue.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-toggle-letters"),colspan:Xr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/abc"})},ue.const("A B C")),Audio:(r,e,t={},i)=>ue.createElement(Ar,{command:ue.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-toggle-audio-trace"),colspan:Xr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"on"})},ue.createElement("i",{class:ue.const("dcg-icon-volume"),"aria-hidden":ue.const("true")})),backspace:(r,e,t={},i)=>ue.createElement(Ar,{command:ue.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-backspace"),colspan:Xr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/press-key",key:"Backspace"})},ue.createElement("i",{class:ue.const("dcg-icon-delete"),"aria-hidden":ue.const("true")})),pi:ze({content:"\\pi",ariaLabelKey:"shared-calculator-narration-keypad-key-pi"}),alpha:ze({content:"\\alpha",ariaLabelKey:"shared-calculator-narration-keypad-key-alpha"}),beta:ze({content:"\\beta",ariaLabelKey:"shared-calculator-narration-keypad-key-beta"}),theta:ze({content:"\\theta",ariaLabelKey:"shared-calculator-narration-keypad-key-theta"}),tau:ze({content:"\\tau",ariaLabelKey:"shared-calculator-narration-keypad-key-tau"}),phi:ze({content:"\\phi",ariaLabelKey:"shared-calculator-narration-keypad-key-phi"}),rho:ze({content:"\\rho",ariaLabelKey:"shared-calculator-narration-keypad-key-rho"}),"a^2":ts({command:"a^2",content:"a^2",ariaLabelKey:"shared-calculator-narration-keypad-key-squared"}),"a^3":ts({command:"a^3",content:"a^3",ariaLabelKey:"shared-calculator-narration-keypad-key-cubed"}),"x^3":ts({command:"a^3",content:"x^3",ariaLabelKey:"shared-calculator-narration-keypad-key-cubed"}),"a^b":ze({content:"a^b",typedText:"^",ariaLabelKey:"shared-calculator-narration-keypad-key-superscript"}),a_b:ze({content:"a_b",typedText:"_",ariaLabelKey:"shared-calculator-narration-keypad-key-subscript"}),"a/b":ts({content:"\\frac{a}{b}",command:"a/b",ariaLabelKey:"shared-calculator-narration-keypad-key-fraction"}),"x^2":ts({command:"a^2",content:"x^2",ariaLabelKey:"shared-calculator-narration-keypad-key-squared"}),"x^y":ze({content:"x^y",typedText:"^",ariaLabelKey:"shared-calculator-narration-keypad-key-superscript"}),"x/y":ze({content:"\\frac{x}{y}",typedText:"/",ariaLabelKey:"shared-calculator-narration-keypad-key-fraction"}),nthroot:ts({command:"nthroot",content:"\\sqrt[n]{}",ariaLabelKey:"shared-calculator-narration-keypad-key-nthroot"}),ythroot:ts({command:"nthroot",content:"\\sqrt[y]{}",ariaLabelKey:"shared-calculator-narration-keypad-key-ythroot"}),sin:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-sin"}),cos:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-cos"}),tan:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-tan"}),tone:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-tone"}),sec:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-sec"}),csc:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-csc"}),cot:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-cot"}),sinh:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-sinh"}),cosh:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-cosh"}),tanh:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-tanh"}),sech:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-csch"}),csch:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-csch"}),coth:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-coth"}),arcsin:ts({command:"arcsin",content:"sin^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arcsin"}),arccos:ts({command:"arccos",content:"cos^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arccos"}),arctan:ts({command:"arctan",content:"tan^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arctan"}),arccsc:ts({command:"arccsc",content:"csc^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arccsc"}),arcsec:ts({command:"arcsec",content:"sec^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arcsec"}),arccot:ts({command:"arccot",content:"cot^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arccot"}),"|a|":ze({typedText:"|",ariaLabelKey:"shared-calculator-narration-keypad-key-abs"}),"|x|":ze({typedText:"|",ariaLabelKey:"shared-calculator-narration-keypad-key-abs"}),ln:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-ln"}),midpoint:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-midpoint"}),segment:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-segment"}),line:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-line"}),ray:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-ray"}),parallel:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-parallel"}),perpendicular:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-perpendicular"}),circle:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-circle"}),arc:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-arc"}),angle:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-angle"}),directedangle:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-directed-angle"}),glider:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-glider"}),coterminal:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-coterminal"}),supplement:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-supplement"}),dilate:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-dilate"}),rotate:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-rotate"}),translate:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-translate"}),reflect:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-reflect"}),vertices:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-vertices"}),angles:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-angles"}),directedangles:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-directed-angles"}),segments:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-segments"}),radius:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-radius"}),center:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-center"}),intersection:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-intersection"}),area:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-area"}),perimeter:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-perimeter"}),log:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-log"}),quantile:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-quantile"}),quartile:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-quartile"}),var:Xe({}),varp:Xe({}),nCr:Xe({}),loga:ts({command:"loga",content:"log_a",ariaLabelKey:"shared-calculator-narration-keypad-key-loga"}),stdev:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-stdev"}),mad:Xe({}),nPr:Xe({}),total:Xe({}),count:Xe({}),length:Xe({}),for:Xe({}),min:Xe({}),max:Xe({}),cov:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-cov"}),covp:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-covp"}),corr:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-corr"}),spearman:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-spearman"}),stats:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-stats"}),polygon:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-polygon"}),distance:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-distance"}),triangle:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-triangle"}),sphere:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-sphere"}),vector:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-vector"}),mean:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-mean"}),stdevp:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-stdevp"}),mod:Xe({}),"e^x":ze({typedText:"e^",ariaLabelKey:"shared-calculator-narration-keypad-key-exp"}),"10^n":ze({content:"\\times10^{n}",typedText:"*10^",ariaLabelKey:"shared-calculator-narration-keypad-key-10-n"}),"a^{-1}":ze({typedText:"^-1",ariaLabelKey:"shared-calculator-narration-keypad-key-reciprocal"}),sum:ze({content:"\\sum",ariaLabelKey:"shared-calculator-narration-keypad-key-sum"}),prod:ze({content:"\\prod",ariaLabelKey:"shared-calculator-narration-keypad-key-product"}),floor:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-floor"}),ceil:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-ceil"}),round:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-round"}),abs:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-abs"}),"!":ze({ariaLabelKey:"shared-calculator-narration-keypad-key-factorial"}),"n!":ze({typedText:"!",ariaLabelKey:"shared-calculator-narration-keypad-key-factorial"}),median:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-median"}),lcm:Xe({}),gcd:Xe({}),gcf:Xe({}),ddx:ts({command:"ddx",content:"\\frac{d}{dx}"}),integral:ts({command:"integral",content:"\\int",ariaLabelKey:"shared-calculator-narration-keypad-key-int"}),"%":ze({content:"\\%",ariaLabelKey:"shared-calculator-narration-keypad-key-percent-of"}),"->":ze({content:"\\to",ariaLabelKey:"shared-calculator-narration-keypad-key-action-to"}),with:ze({typedText:"with",content:"with",ariaLabelKey:"shared-calculator-narration-keypad-key-action-with"}),prime:ze({typedText:"'",content:"f'",ariaLabelKey:"shared-calculator-narration-keypad-key-prime"}),exp:ze({}),sign:Xe({}),normaldist:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-normaldist"}),poissondist:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-poissondist"}),binomialdist:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-binomialdist"}),uniformdist:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-uniformdist"}),erf:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-erf"}),histogram:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-histogram"}),boxplot:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-boxplot"}),dotplot:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-dotplot"}),tscore:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-tscore"}),ittest:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-ittest"}),ttest:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-ttest"}),tdist:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-tdist"}),pdf:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-pdf"}),cdf:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-pdf"}),random:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-random"}),inversecdf:Xe({ariaLabelKey:"shared-calculator-narration-keypad-key-inversecdf"}),hsv:Xe({}),rgb:Xe({}),sort:Xe({}),shuffle:Xe({}),unique:Xe({}),join:Xe({}),"A^-1":ts({command:"A^-1",content:"A^{-1}",ariaLabelKey:"matrix-calculator-narration-keypad-key-inverse"}),"A^T":ts({command:"A^T",content:"A^T",ariaLabelKey:"matrix-calculator-narration-keypad-key-transpose"}),"A^2":ts({command:"A^2",content:"A^2",ariaLabelKey:"shared-calculator-narration-keypad-key-squared"}),"A^n":ze({content:"A^n",typedText:"^",ariaLabelKey:"shared-calculator-narration-keypad-key-exp"}),det:Xe({ariaLabelKey:"matrix-calculator-narration-keypad-key-det"}),trace:Xe({ariaLabelKey:"matrix-calculator-narration-keypad-key-trace"}),rref:Xe({ariaLabelKey:"matrix-calculator-narration-keypad-key-rref"}),a:ze({}),b:ze({}),c:ze({}),d:ze({}),e:ze({}),f:ze({}),g:ze({}),h:ze({}),i:ze({}),j:ze({}),k:ze({}),l:ze({}),m:ze({}),n:ze({}),o:ze({}),p:ze({}),q:ze({}),r:ze({}),s:ze({}),t:ze({}),u:ze({}),v:ze({}),w:ze({}),x:ze({}),boldX:ze({content:"x",typedText:"x"}),y:ze({}),boldY:ze({content:"y",typedText:"y"}),z:ze({}),boldZ:ze({content:"z",typedText:"z"}),A:ze({}),B:ze({}),C:ze({}),D:ze({}),E:ze({}),F:ze({}),G:ze({}),H:ze({}),I:ze({}),J:ze({}),K:ze({}),L:ze({}),M:ze({}),N:ze({}),O:ze({}),P:ze({}),Q:ze({}),R:ze({}),S:ze({}),T:ze({}),U:ze({}),V:ze({}),W:ze({}),X:ze({}),Y:ze({}),Z:ze({}),0:ze({}),1:ze({}),2:ze({}),3:ze({}),4:ze({}),5:ze({}),6:ze({}),7:ze({}),8:ze({}),9:ze({}),",":ze({}),"=":ze({}),"[":ze({}),"]":ze({}),"{}_left":Rw({keys:["{","}"]}),"{}_right":Fw({keys:["{","}"]}),"()_left":Rw({keys:["(",")"]}),"()_right":Fw({keys:["(",")"]}),"[]_left":Rw({keys:["[","]"]}),"[]_right":Fw({keys:["[","]"]}),",'_left":Rw({keys:[",","\u2032"]}),",'_right":Fw({keys:[",","\u2032"],typedText:"'"}),'"':ze({}),"'":ze({}),"~":ze({}),":":ze({}),">":ze({}),"<":ze({}),">=":ze({content:"\\ge"}),"<=":ze({content:"\\le"}),"!%_left":Rw({keys:["!","{}^{%}"]}),"!%_right":Fw({keys:["!","{}^{%}"],typedText:"%"}),"~:_left":Rw({keys:["~","{}^{:}"]}),"~:_right":Fw({keys:["~","{}^{:}"],typedText:":"}),"audio-trace-off":the({contentKey:"graphing-calculator-button-keypad-audio-trace-off",command:"off"}),"hear-graph":(r,e,t={},i)=>ue.createElement(Ar,{command:ue.const(r),disabled:Xr(t.disabled,!1),colspan:Xr(t.colspan,1),style:Xr(t.style,"blue"),ariaLabel:ue.const(void 0),onTap:()=>{e({type:"keypad/audio-trace",command:"hear-graph"})}},ue.createElement("span",{class:ue.const("dcg-play-icon-container")},ue.createElement("i",{class:ue.const("dcg-icon-play"),"aria-hidden":ue.const("true")})),ue.createElement("span",null,()=>i("graphing-calculator-button-audio-trace-hear-graph"))),"stop-graph":(r,e,t={},i)=>ue.createElement(Ar,{command:ue.const(r),disabled:Xr(t.disabled,!1),colspan:Xr(t.colspan,1),style:Xr(t.style,"blue"),onTap:()=>{e({type:"keypad/audio-trace",command:"stop-graph"})}},ue.createElement("span",{class:ue.const("dcg-stop-icon-container")},ue.createElement("span",{class:ue.const("dcg-stop-icon")})),ue.createElement("span",null,()=>i("graphing-calculator-button-audio-trace-stop-graph"))),"volume-down":(r,e,t={},i)=>ue.createElement(Ar,{command:ue.const(r),ariaLabel:()=>i("graphing-calculator-narration-keypad-key-volume-down"),disabled:Xr(t.disabled,!1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"volume-down"})},ue.createElement("span",{class:ue.const("dcg-button-icon dcg-icon-only")},ue.createElement("i",{class:ue.const("dcg-icon-volume-down"),"aria-hidden":ue.const("true")}))),"volume-up":(r,e,t={},i)=>ue.createElement(Ar,{command:ue.const(r),ariaLabel:()=>i("graphing-calculator-narration-keypad-key-volume-up"),disabled:Xr(t.disabled,!1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"volume-up"})},ue.createElement("span",{class:ue.const("dcg-button-icon dcg-icon-only")},ue.createElement("i",{class:ue.const("dcg-icon-volume-up"),"aria-hidden":ue.const("true")}))),"speed-down":(r,e,t={},i)=>ue.createElement(Ar,{command:ue.const(r),ariaLabel:()=>i("graphing-calculator-narration-keypad-key-speed-down"),disabled:Xr(t.disabled,!1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"speed-down"})},ue.createElement("span",{class:ue.const("dcg-button-icon dcg-icon-only")},ue.createElement("i",{class:ue.const("dcg-icon-hide"),"aria-hidden":ue.const("true")}))),"speed-up":(r,e,t={},i)=>ue.createElement(Ar,{command:ue.const(r),ariaLabel:()=>i("graphing-calculator-narration-keypad-key-speed-up"),disabled:Xr(t.disabled,!1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"speed-up"})},ue.createElement("span",{class:ue.const("dcg-button-icon dcg-icon-only")},ue.createElement("i",{class:ue.const("dcg-icon-show"),"aria-hidden":ue.const("true")}))),"previous-point":(r,e,t={},i)=>ue.createElement(Ar,{ariaLabel:()=>i("graphing-calculator-narration-keypad-key-previous-point"),command:ue.const(r),disabled:Xr(t.disabled,!1),colspan:Xr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"previous-point"})},ue.createElement("span",{class:ue.const("dcg-button-icon dcg-icon-only")},ue.createElement("i",{class:ue.const("dcg-icon-thin-arrow-left"),"aria-hidden":ue.const("true")}))),"next-point":(r,e,t={},i)=>ue.createElement(Ar,{ariaLabel:()=>i("graphing-calculator-narration-keypad-key-next-point"),command:ue.const(r),disabled:Xr(t.disabled,!1),colspan:Xr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"next-point"})},ue.createElement("span",{class:ue.const("dcg-button-icon dcg-icon-only")},ue.createElement("i",{class:ue.const("dcg-icon-thin-arrow-right"),"aria-hidden":ue.const("true")}))),"previous-poi":(r,e,t={},i)=>ue.createElement(Ar,{ariaLabel:()=>i("graphing-calculator-narration-keypad-key-previous-poi"),command:ue.const(r),disabled:Xr(t.disabled,!1),colspan:Xr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"previous-poi"})},ue.createElement("span",{class:ue.const("dcg-button-icon dcg-icon-only")},ue.createElement("i",{class:ue.const("dcg-icon-hide"),"aria-hidden":ue.const("true")}))),"next-poi":(r,e,t={},i)=>ue.createElement(Ar,{ariaLabel:()=>i("graphing-calculator-narration-keypad-key-next-poi"),command:ue.const(r),disabled:Xr(t.disabled,!1),colspan:Xr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"next-poi"})},ue.createElement("span",{class:ue.const("dcg-button-icon dcg-icon-only")},ue.createElement("i",{class:ue.const("dcg-icon-show"),"aria-hidden":ue.const("true")}))),"previous-curve":(r,e,t={},i)=>ue.createElement(Ar,{ariaLabel:()=>i("graphing-calculator-narration-keypad-key-previous-curve"),command:ue.const(r),disabled:Xr(t.disabled,!1),colspan:Xr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"previous-curve"})},ue.createElement("span",{class:ue.const("dcg-button-icon dcg-icon-only")},ue.createElement("i",{class:ue.const("dcg-icon-caret-up"),"aria-hidden":ue.const("true")}))),"next-curve":(r,e,t={},i)=>ue.createElement(Ar,{ariaLabel:()=>i("graphing-calculator-narration-keypad-key-next-curve"),command:ue.const(r),disabled:Xr(t.disabled,!1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"next-curve"})},ue.createElement("span",{class:ue.const("dcg-button-icon dcg-icon-only")},ue.createElement("i",{class:ue.const("dcg-icon-caret-down"),"aria-hidden":ue.const("true")})))};function k(r,e,t={}){let i=r.dispatch;return rhe[e](e,i,t,r.s)}function Jr(r=1){return ue.createElement("div",{style:ue.const(`flex-grow:${r}`)})}var lA=__dcg_shared_module_exports__['e'](te());var DX=__dcg_shared_module_exports__['e'](te()),Nh=class extends DX.Class{init(){this.controller=this.props.controller()}};var Er=class extends Nh{template(){return lA.createElement("div",{class:lA.const("dcg-basic-keypad dcg-do-not-blur")},this.children)}};var Nw=__dcg_shared_module_exports__['e'](te()),je=class extends Nw.Class{template(){return Nw.createElement("div",{class:Nw.const("dcg-keypad-row")},this.children)}};var cA=class extends an{template(){return Bw.createElement(Er,{controller:this.props.controller},Bw.createElement(je,null,k(this,"q"),k(this,"w"),k(this,"e"),k(this,"r"),k(this,"t"),k(this,"y"),k(this,"u"),k(this,"i"),k(this,"o"),k(this,"p")),Bw.createElement(je,null,k(this,"a"),k(this,"s"),k(this,"d"),k(this,"f"),k(this,"g"),k(this,"h"),k(this,"j"),k(this,"k"),k(this,"l"),k(this,"theta")),Bw.createElement(je,null,k(this,"shift",{colspan:1.364,style:"highlight"}),Jr(.136),k(this,"z"),k(this,"x"),k(this,"c"),k(this,"v"),k(this,"b"),k(this,"n"),k(this,"m"),Jr(.136),k(this,"backspace",{colspan:1.364,style:"highlight"})),Bw.createElement(je,null,k(this,"123",{colspan:1.818,style:"highlight"}),Jr(.182),k(this,"a_b"),k(this,"!%_left"),k(this,"[]_left"),k(this,"{}_left"),k(this,"~:_left"),k(this,",'_left"),Jr(.182),k(this,"enter",{colspan:1.818,style:"blue"})))}};var Uw=__dcg_shared_module_exports__['e'](te());var dA=class extends an{template(){return Uw.createElement(Er,{controller:this.props.controller},Uw.createElement(je,null,k(this,"Q"),k(this,"W"),k(this,"E"),k(this,"R"),k(this,"T"),k(this,"Y"),k(this,"U"),k(this,"I"),k(this,"O"),k(this,"P")),Uw.createElement(je,null,k(this,"A"),k(this,"S"),k(this,"D"),k(this,"F"),k(this,"G"),k(this,"H"),k(this,"J"),k(this,"K"),k(this,"L"),k(this,"tau")),Uw.createElement(je,null,k(this,"shift",{colspan:1.364,active:!0,style:"highlight"}),Jr(.136),k(this,"Z"),k(this,"X"),k(this,"C"),k(this,"V"),k(this,"B"),k(this,"N"),k(this,"M"),Jr(.136),k(this,"backspace",{colspan:1.364,style:"highlight"})),Uw.createElement(je,null,k(this,"123",{colspan:1.818,style:"highlight"}),Jr(.182),k(this,"a^b"),k(this,"!%_right"),k(this,"[]_right"),k(this,"{}_right"),k(this,"~:_right"),k(this,",'_right"),Jr(.182),k(this,"enter",{colspan:1.818,style:"blue"})))}};var Os=__dcg_shared_module_exports__['e'](te());var pA=class extends an{template(){return Os.createElement(Er,{controller:this.props.controller},Os.createElement(je,null,k(this,"boldX"),k(this,"boldY"),k(this,"a^2"),k(this,"a^b"),Jr(.5),k(this,"7",{style:"highlight"}),k(this,"8",{style:"highlight"}),k(this,"9",{style:"highlight"}),k(this,"division"),Jr(.5),Os.createElement(Ar,{command:this.const("functions"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-functions"),colspan:this.const(2),style:this.const("highlight"),active:()=>this.controller.isKeypadFunctionsPopoverOpen(),onTap:()=>this.dispatch({type:"keypad/functions"}),ariaControls:this.const(`dcg-functions-popover-${an.uuid}`),ariaExpanded:()=>this.controller.isKeypadFunctionsPopoverOpen()},this.bindFn(this.getFuncsBtnText))),Os.createElement(je,null,k(this,"("),k(this,")"),k(this,"<"),k(this,">"),Jr(.5),k(this,"4",{style:"highlight"}),k(this,"5",{style:"highlight"}),k(this,"6",{style:"highlight"}),k(this,"multiplication"),Jr(.5),k(this,"left",{style:"highlight"}),k(this,"right",{style:"highlight"})),Os.createElement(je,null,k(this,"|a|"),k(this,","),k(this,"<="),k(this,">="),Jr(.5),k(this,"1",{style:"highlight"}),k(this,"2",{style:"highlight"}),k(this,"3",{style:"highlight"}),k(this,"-"),Jr(1),k(this,"backspace",{colspan:1.5,style:"highlight"})),Os.createElement(je,null,Os.createElement("div",{class:Os.const("dcg-abc-audio-container")},Os.createElement(Ar,{command:Os.const("ABC"),colspan:this.const(1),ariaLabel:()=>this.controller.s("graphing-calculator-narration-toggle-letters"),style:this.const("highlight"),onTap:()=>{this.dispatch({type:"keypad/abc"})}},()=>this.controller.getLayoutMeasurements().width<=600?this.controller.raw("ABC"):this.controller.raw("A B C")),Os.createElement(Ar,{command:Os.const("Audio"),disabled:()=>!this.controller.canAudioTrace(),ariaLabel:()=>this.controller.s("graphing-calculator-narration-toggle-audio-trace"),colspan:this.const(1),style:()=>"highlight",onTap:()=>this.dispatch({type:"keypad/audio-trace",command:"on"})},Os.createElement("i",{class:Os.const("dcg-icon-volume"),"aria-hidden":Os.const("true")}))),k(this,"sqrt"),k(this,"pi"),Jr(.5),k(this,"0",{style:"highlight"}),k(this,".",{style:"highlight"}),k(this,"="),k(this,"+"),Jr(.5),k(this,"enter",{colspan:2,style:"blue"})))}getFuncsBtnText(){return this.controller.isNarrow()?this.controller.s("graphing-calculator-button-funcs"):this.controller.s("graphing-calculator-button-functions")}};var fd=__dcg_shared_module_exports__['e'](te());var uA=class extends an{template(){return fd.createElement(Er,{controller:this.props.controller},fd.createElement(je,null,k(this,"boldX"),k(this,"boldY"),k(this,"boldZ"),k(this,"a^b"),Jr(.5),k(this,"7",{style:"highlight"}),k(this,"8",{style:"highlight"}),k(this,"9",{style:"highlight"}),k(this,"division"),Jr(.5),fd.createElement(Ar,{command:this.const("functions"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-functions"),colspan:this.const(2),style:this.const("highlight"),active:()=>this.controller.isKeypadFunctionsPopoverOpen(),onTap:()=>this.dispatch({type:"keypad/functions"}),ariaControls:this.const(`dcg-functions-popover-${an.uuid}`),ariaExpanded:()=>this.controller.isKeypadFunctionsPopoverOpen()},this.bindFn(this.getFuncsBtnText))),fd.createElement(je,null,k(this,"("),k(this,")"),k(this,"<"),k(this,">"),Jr(.5),k(this,"4",{style:"highlight"}),k(this,"5",{style:"highlight"}),k(this,"6",{style:"highlight"}),k(this,"multiplication"),Jr(.5),k(this,"left",{style:"highlight"}),k(this,"right",{style:"highlight"})),fd.createElement(je,null,k(this,"|a|"),k(this,","),k(this,"<="),k(this,">="),Jr(.5),k(this,"1",{style:"highlight"}),k(this,"2",{style:"highlight"}),k(this,"3",{style:"highlight"}),k(this,"-"),Jr(1),k(this,"backspace",{colspan:1.5,style:"highlight"})),fd.createElement(je,null,fd.createElement("div",{class:fd.const("dcg-abc-audio-container")},fd.createElement(Ar,{command:fd.const("ABC"),colspan:this.const(2),ariaLabel:()=>this.controller.s("graphing-calculator-narration-toggle-letters"),style:this.const("highlight"),onTap:()=>{this.dispatch({type:"keypad/abc"})}},()=>this.controller.raw("A B C"))),k(this,"sqrt"),k(this,"pi"),Jr(.5),k(this,"0",{style:"highlight"}),k(this,".",{style:"highlight"}),k(this,"="),k(this,"+"),Jr(.5),k(this,"enter",{colspan:2,style:"blue"})))}getFuncsBtnText(){return this.controller.isNarrow()?this.controller.s("graphing-calculator-button-funcs"):this.controller.s("graphing-calculator-button-functions")}};var zw=__dcg_shared_module_exports__['e'](te());var hA=class extends an{template(){return zw.createElement(Er,{controller:this.props.controller},zw.createElement(je,null,k(this,"a"),k(this,"b"),k(this,"c"),k(this,"d"),k(this,"e"),k(this,"f"),k(this,"g"),k(this,"h"),k(this,"i"),k(this,"j")),zw.createElement(je,null,k(this,"k"),k(this,"l"),k(this,"m"),k(this,"n"),k(this,"o"),k(this,"p"),k(this,"q"),k(this,"r"),k(this,"s"),k(this,"t")),zw.createElement(je,null,k(this,"shift",{style:"highlight"}),k(this,"u"),k(this,"v"),k(this,"w"),k(this,"x"),k(this,"y"),k(this,"z"),k(this,"theta"),k(this,"backspace",{colspan:2,style:"highlight"})),zw.createElement(je,null,k(this,"123",{colspan:2,style:"highlight"}),k(this,"a_b"),k(this,"!%_left"),k(this,"[]_left"),k(this,"{}_left"),k(this,"~:_left"),k(this,",'_left"),k(this,"enter",{colspan:2,style:"blue"})))}};var Kw=__dcg_shared_module_exports__['e'](te());var gA=class extends an{template(){return Kw.createElement(Er,{controller:this.props.controller},Kw.createElement(je,null,k(this,"A"),k(this,"B"),k(this,"C"),k(this,"D"),k(this,"E"),k(this,"F"),k(this,"G"),k(this,"H"),k(this,"I"),k(this,"J")),Kw.createElement(je,null,k(this,"K"),k(this,"L"),k(this,"M"),k(this,"N"),k(this,"O"),k(this,"P"),k(this,"Q"),k(this,"R"),k(this,"S"),k(this,"T")),Kw.createElement(je,null,k(this,"shift",{style:"highlight"}),k(this,"U"),k(this,"V"),k(this,"W"),k(this,"X"),k(this,"Y"),k(this,"Z"),k(this,"tau"),k(this,"backspace",{colspan:2,style:"highlight"})),Kw.createElement(je,null,k(this,"123",{colspan:2,style:"highlight"}),k(this,"a^b"),k(this,"!%_right"),k(this,"[]_right"),k(this,"{}_right"),k(this,"~:_right"),k(this,",'_right"),k(this,"enter",{colspan:2,style:"blue"})))}};var st=__dcg_shared_module_exports__['e'](te());var{IfElse:ihe}=st.Components,mA=460,fA=class extends an{template(){return st.createElement(Er,{controller:this.props.controller},st.createElement("div",{class:st.const("dcg-audio-keypad-container")},st.createElement("div",{class:st.const("dcg-audio-keypad-column dcg-playback-column")},st.createElement($e,{tooltip:this.bindFn(this.getDisabledTooltipText),gravity:this.const("s"),sticky:this.const(!1)},st.createElement("div",{class:st.const("dcg-btn-playback")},ihe(()=>this.controller.isAudioTracing(),{true:()=>k(this,"stop-graph",{disabled:this.bindFn(this.isAudioDisabled)}),false:()=>k(this,"hear-graph",{disabled:this.bindFn(this.isAudioDisabled)})}))),st.createElement("div",{class:st.const("dcg-key-nav-section-container")},st.createElement($e,{tooltip:this.bindFn(this.getDisabledTooltipText),gravity:this.const("s"),sticky:this.const(!1)},st.createElement("div",{class:st.const("dcg-key-nav-section")},k(this,"volume-down",{disabled:this.bindFn(this.isVolumeDownDisabled)}),st.createElement("div",{role:st.const("heading"),"aria-level":st.const("2"),class:()=>({"dcg-key-nav-section-title-container":!0,"dcg-disabled":this.isAudioDisabled()})},st.createElement("span",{class:st.const("dcg-key-nav-section-title")},()=>this.controller.s("graphing-calculator-label-audio-trace-volume")),st.createElement("span",{class:st.const("dcg-keypad-volume-value dcg-key-nav-section-value")},()=>this.getAudioTraceVolume())),k(this,"volume-up",{disabled:this.bindFn(this.isVolumeUpDisabled)})))),st.createElement("div",{class:st.const("dcg-key-nav-section-container")},st.createElement($e,{tooltip:this.bindFn(this.getDisabledTooltipText),gravity:this.const("s"),sticky:this.const(!1)},st.createElement("div",{class:st.const("dcg-key-nav-section")},k(this,"speed-down",{disabled:this.bindFn(this.isSpeedDownDisabled)}),st.createElement("div",{class:()=>({"dcg-key-nav-section-title-container":!0,"dcg-disabled":this.isAudioDisabled()}),role:st.const("heading"),"aria-level":st.const("2")},st.createElement("span",{class:st.const("dcg-key-nav-section-title")},()=>this.controller.s("graphing-calculator-label-audio-trace-speed")),st.createElement("span",{class:st.const("dcg-keypad-speed-value dcg-key-nav-section-value")},()=>this.getAudioTraceSpeed())),k(this,"speed-up",{disabled:this.bindFn(this.isSpeedUpDisabled)})))),k(this,"audio-trace-off",{style:"highlight"})),st.createElement("div",{class:st.const("dcg-audio-keypad-spacer")}),st.createElement("div",{class:st.const("dcg-audio-keypad-column dcg-navigation-column")},st.createElement("span",{class:st.const("dcg-key-section-title dcg-center-col"),role:st.const("heading"),"aria-level":st.const("2")},()=>this.controller.s("graphing-calculator-heading-audio-trace-navigation")),st.createElement("div",{class:st.const("dcg-key-nav-section dcg-center-col")},k(this,"previous-point",{disabled:this.bindFn(this.isPrevPointDisabled)}),st.createElement("div",{class:st.const("dcg-key-nav-section-title-container"),role:st.const("heading"),"aria-level":st.const("2")},()=>this.controller.s("graphing-calculator-label-audio-trace-point")),k(this,"next-point",{disabled:this.bindFn(this.isNextPointDisabled)})),st.createElement("div",{class:st.const("dcg-key-nav-section")},k(this,"previous-poi",{disabled:this.bindFn(this.isPrevPOIDisabled)}),st.createElement("div",{class:st.const("dcg-key-nav-section-title-container dcg-poi-section-container"),role:st.const("heading"),"aria-level":st.const("2")},st.createElement(yi,{i18n:this.const(this.controller),key:this.const("graphing-calculator-heading-keypad-audio-trace-point-of-interest")},st.createElement("span",{class:st.const("dcg-key-nav-section-value")},st.const("Point")),st.createElement("span",{class:st.const("dcg-key-nav-section-title")},st.const("of Interest")))),k(this,"next-poi",{disabled:this.bindFn(this.isNextPOIDisabled)})),st.createElement("div",{class:st.const("dcg-key-nav-section dcg-center-col")},k(this,"previous-curve",{disabled:this.bindFn(this.isPrevCurveDisabled)}),st.createElement("div",{class:st.const("dcg-key-nav-section-title-container"),role:st.const("heading"),"aria-level":st.const("2")},()=>this.controller.s("graphing-calculator-label-audio-trace-curve")),k(this,"next-curve",{disabled:this.bindFn(this.isNextCurveDisabled)}))),st.createElement("div",{class:st.const("dcg-audio-keypad-spacer")}),st.createElement("div",{class:st.const("dcg-audio-keypad-column dcg-screenreader-options")},st.createElement("span",{class:st.const("dcg-key-section-title"),role:st.const("heading"),"aria-level":st.const("2")},()=>this.layoutWidth()<=mA?this.controller.s("graphing-calculator-heading-audio-trace-describe"):this.controller.s("graphing-calculator-heading-audio-trace-screen-reader"),st.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-audio-trace-need-screen-reader"),gravity:this.const("s"),sticky:this.const(!0)},st.createElement("i",{class:st.const("dcg-icon-question-sign"),"aria-hidden":st.const("true")}))),st.createElement(Ar,{command:st.const("describe-point"),colspan:this.const(1),style:this.const("default"),onTap:()=>{this.dispatch({type:"keypad/audio-trace",command:"describe-point"})}},st.createElement("span",null,()=>this.layoutWidth()<=mA?this.controller.s("graphing-calculator-button-keypad-describe-point-short"):this.controller.s("graphing-calculator-button-keypad-describe-point"))),st.createElement(Ar,{command:st.const("describe-curve"),colspan:this.const(1),style:this.const("default"),onTap:()=>{this.dispatch({type:"keypad/audio-trace",command:"describe-curve"})}},st.createElement("span",null,()=>this.layoutWidth()<=mA?this.controller.s("graphing-calculator-button-keypad-describe-curve-short"):this.controller.s("graphing-calculator-button-keypad-describe-curve"))),st.createElement(Ar,{command:st.const("describe-axes"),colspan:this.const(1),style:this.const("default"),onTap:()=>{this.dispatch({type:"keypad/audio-trace",command:"describe-axes"})}},st.createElement("span",null,()=>this.layoutWidth()<=mA?this.controller.s("graphing-calculator-label-axes"):this.controller.s("graphing-calculator-button-keypad-describe-axes"))))))}layoutWidth(){return this.controller.getLayoutMeasurements().width}isPrevPointDisabled(){let r=this.controller.getAudioGraph();return r?!r.agNavigator.canMoveToPrevPoint():!0}isNextPointDisabled(){let r=this.controller.getAudioGraph();return r?!r.agNavigator.canMoveToNextPoint():!0}isPrevPOIDisabled(){let r=this.controller.getAudioGraph();return r?!r.agNavigator.canMoveToPrevPOI():!0}isNextPOIDisabled(){let r=this.controller.getAudioGraph();return r?!r.agNavigator.canMoveToNextPOI():!0}isPrevCurveDisabled(){let r=this.controller.getAudioGraph();return r?!r.agNavigator.canMoveToPrevCurve():!0}isNextCurveDisabled(){let r=this.controller.getAudioGraph();return r?!r.agNavigator.canMoveToNextCurve():!0}isAudioDisabled(){return!this.controller.getAudio()}getAudioTraceVolume(){let r=this.controller.getAudioGraph();return!r||this.isAudioDisabled()?"0%":`${r.getAudioVolume()*100}%`}isVolumeDownDisabled(){let r=this.controller.getAudioGraph();return!r||this.isAudioDisabled()?!0:r.getAudioVolume()<=0}isVolumeUpDisabled(){let r=this.controller.getAudioGraph();return!r||this.isAudioDisabled()?!0:r.getAudioVolume()>=1}getAudioTraceSpeed(){let r=this.controller.getAudioGraph();return!r||this.isAudioDisabled()?"0":eE[r.getAudioSpeedIndex()].displayedSpeed}isSpeedDownDisabled(){let r=this.controller.getAudioGraph();return!r||this.isAudioDisabled()?!0:r.getAudioSpeedIndex()<=0}isSpeedUpDisabled(){let r=this.controller.getAudioGraph();return!r||this.isAudioDisabled()?!0:r.getAudioSpeedIndex()===eE.length-1}getDisabledTooltipText(){return this.isAudioDisabled()?this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"):""}};var oi=__dcg_shared_module_exports__['e'](te());var{If:bA,For:kX}=oi.Components,yA=class extends an{template(){return oi.createElement("div",{class:()=>({"dcg-functions-popover":!0,"dcg-popover":!0,"dcg-top":!0,"dcg-two-column":this.shouldRenderWithTwoColumns()}),id:this.const(`dcg-functions-popover-${an.uuid}`),role:oi.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-button-functions")},oi.createElement("div",{class:oi.const("dcg-popover-interior")},oi.createElement("div",{class:oi.const("dcg-interior-buttons")},oi.createElement(kX,{each:this.bindFn(this.getKeypadKeys),key:r=>r.id},oi.createElement("div",{class:oi.const("dcg-basic-keypad dcg-do-not-blur")},r=>oi.createElement("div",{class:oi.const("dcg-keypad-keys-section")},oi.createElement(bA,{predicate:()=>r.title!==void 0},()=>oi.createElement("div",{class:oi.const("dcg-section-heading"),role:oi.const("heading"),"aria-level":oi.const("2")},()=>r.title,oi.createElement(bA,{predicate:()=>!!r.beta},()=>oi.createElement("span",{class:oi.const("dcg-beta-tag")},()=>this.controller.s("shared-calculator-narration-keypad-key-beta"))),oi.createElement(bA,{predicate:()=>!!r.helpLink},()=>oi.createElement("a",{href:()=>r.helpLink.url,target:oi.const("_blank"),"aria-label":()=>r.helpLink.tooltip},oi.createElement("i",{class:oi.const("dcg-icon-question-sign"),"aria-hidden":oi.const("true")}))))),oi.createElement(bA,{predicate:()=>r.title===void 0},()=>oi.createElement("div",{class:oi.const("dcg-popover-section-separator"),role:oi.const("separator")})),oi.createElement(kX,{each:()=>r.keys},oi.createElement("div",{class:oi.const("dcg-keypad-keys-buttons")},e=>this.b(e)))))))),oi.createElement("div",{class:oi.const("dcg-arrow")}))}shouldRenderWithTwoColumns(){let r=this.controller.getGraphSettings().config.projectorMode?410:375;return this.controller.getLayoutMeasurements().width<r}getInverseTrigSection(){let r=this.controller.areFunctionsRestricted()?["arcsin","arccos","arctan"]:["arcsin","arccos","arctan","arccsc","arcsec","arccot"];return{id:"inversetrig",title:this.controller.s("graphing-calculator-heading-inverse-trig"),keys:r}}getGeometryTools(){let r=["midpoint","intersection","segment","line","ray","vector","parallel","perpendicular","circle","arc","angle","directedangle","polygon","glider"];return{id:"geometry-tools",title:this.controller.s("graphing-calculator-heading-geometry-tools"),keys:r}}getGeometryTransformations(){let r=["dilate","rotate","reflect","translate"];return{id:"geometry-transformations",title:this.controller.s("graphing-calculator-heading-geometry-transformations"),keys:r}}getGeometryMeasurements(){let r=["distance","length","area","perimeter","vertices","angles","directedangles","segments","radius","center","coterminal","supplement"];return{id:"geometry-measurements",title:this.controller.s("graphing-calculator-heading-geometry-measurements"),keys:r}}getCalculatorGeometryMethods(){let r=!this.controller.areFunctionsRestricted()||this.controller.areGeometryFunctionsForceEnabled(),e=this.controller.isThreeDMode()?["segment","triangle","sphere","vector"]:["polygon"],t=this.controller.isThreeDMode()?["length","distance","midpoint"]:["distance","midpoint"],i=r?t:[];return{id:"geometry",title:this.controller.s("graphing-calculator-heading-geometry"),keys:[...e,...i]}}getTrigSection(){let r=this.controller.areFunctionsRestricted()?["sin","cos","tan"]:["sin","cos","tan","csc","sec","cot"];return{id:"trig",title:this.controller.s("graphing-calculator-heading-trig"),keys:r}}getHyperbolicTrigSection(){let r=this.controller.areFunctionsRestricted()?["sinh","cosh","tanh"]:["sinh","cosh","tanh","csch","sech","coth"];return{id:"hyperbtrig",title:this.controller.s("graphing-calculator-heading-hyperbolic-trig"),keys:r}}getListFunctions(){return{id:"lists",title:this.controller.s("graphing-calculator-heading-lists"),keys:["join","sort","shuffle","unique","for"]}}getStatTests(){return{id:"stat-tests",title:this.controller.s("graphing-calculator-heading-stat-tests"),keys:["ttest","tscore","ittest"]}}getStatsSection(){let r=["mean","median","min","max","quartile","quantile","stdev","stdevp","var"];return this.controller.areFunctionsRestricted()||(r=r.concat(["mad","cov","covp"])),r=r.concat(["corr","spearman","stats","count","total"]),{id:"stats",title:this.controller.s("graphing-calculator-heading-stats"),keys:r}}getMiscSection(){return{title:this.controller.s("graphing-calculator-button-functions-menu-number-theory"),id:"misc",keys:["lcm","gcd","mod","ceil","floor","round","sign","nthroot","nPr","nCr"]}}getVisualizationsSection(){return{title:this.controller.s("graphing-calculator-heading-dist-tab-visualizations"),id:"visualizations",keys:["histogram","dotplot","boxplot"],helpLink:{url:"https://help.desmos.com/hc/en-us/articles/360022405991-Data-Visualizations",tooltip:this.controller.s("graphing-calculator-narration-dist-tab-visualizations")}}}getCalculusSection(){return{title:this.controller.s("graphing-calculator-heading-calculus"),id:"calculus",keys:["exp","ln","log","loga","ddx","prime","integral","sum","prod"]}}getDistributionsSection(){return{title:this.controller.s("graphing-calculator-heading-dist-tab-distributions"),id:"distributions",keys:["normaldist","tdist","poissondist","binomialdist","uniformdist","pdf","cdf","inversecdf","random"],helpLink:{url:"https://help.desmos.com/hc/en-us/articles/360022401451-Distributions",tooltip:this.controller.s("graphing-calculator-narration-dist-tab-distributions")}}}getColorsSection(){return{title:this.controller.s("graphing-calculator-button-functions-menu-custom-colors"),id:"colors",keys:["rgb","hsv"],helpLink:{url:"https://help.desmos.com/hc/en-us/articles/4406795899533-Custom-Colors",tooltip:this.controller.s("graphing-calculator-button-functions-menu-custom-colors")}}}getAdvancedSection(){return{title:this.controller.s("graphing-calculator-heading-functions-menu-advanced"),id:"advanced",keys:["->","with"],helpLink:{url:"https://help.desmos.com/hc/en-us/sections/4406370087053-Advanced-Features",tooltip:this.controller.s("graphing-calculator-heading-functions-menu-advanced")}}}getPolarSection(){return{title:this.controller.s("graphing-calculator-heading-functions-menu-polar"),id:"polar",keys:["rho","theta","phi"],helpLink:{url:"https://help.desmos.com/hc/en-us/articles/15824510769805",tooltip:this.controller.s("graphing-calculator-heading-functions-menu-polar")}}}getSoundSection(){return{title:this.controller.s("graphing-calculator-heading-functions-menu-sound"),beta:!0,id:"sound",keys:["tone"],helpLink:{url:"https://help.desmos.com/hc/en-us/articles/21373904717197-Tone",tooltip:this.controller.s("graphing-calculator-heading-functions-menu-sound")}}}getKeypadKeys(){let r=[this.getTrigSection(),this.getInverseTrigSection(),this.getStatsSection(),this.getListFunctions()];return this.controller.areDistributionsEnabled()&&(this.controller.isThreeDMode()||r.push(this.getVisualizationsSection()),r.push(this.getDistributionsSection()),r.push(this.getStatTests())),r.push(this.getCalculusSection()),r.push(this.getHyperbolicTrigSection()),this.controller.is3dProduct()&&r.push(this.getPolarSection()),this.controller.isGeometry()?(r.push(this.getGeometryTools()),r.push(this.getGeometryMeasurements()),r.push(this.getGeometryTransformations())):r.push(this.getCalculatorGeometryMethods()),r.push(this.getColorsSection()),this.controller.toneAllowed()&&r.push(this.getSoundSection()),r.push(this.getMiscSection()),this.controller.areActionsEnabled()&&r.push(this.getAdvancedSection()),r}b(r){return k(this,r,{style:"popover"})}};var{SwitchUnion:ohe,If:d3}=sr.Components,xA=class extends an{template(){return sr.createElement("div",{class:sr.const("dcg-keypad"),role:sr.const("region"),"aria-label":()=>this.controller.s("shared-calculator-narration-keypad")},sr.createElement("div",{class:()=>({"dcg-keys-container":!0,"dcg-smaller-functions-text":this.controller.getLayoutMeasurements().width<650,"dcg-small-ABC":this.controller.getLayoutMeasurements().width<490,"dcg-smaller-ABC":this.controller.getLayoutMeasurements().width<420,"dcg-smallest-ABC":this.controller.getLayoutMeasurements().width<380}),style:this.bindFn(this.computeStyles),didMount:this.bindFn(this.didMountContainer),"aria-hidden":()=>!this.controller.isKeypadOpen()},sr.createElement("div",{class:sr.const("dcg-keys-background dcg-do-not-blur"),style:()=>({background:this.controller.getPillboxBackgroundColor()})},sr.createElement("div",{class:sr.const("dcg-keys")},ohe(()=>this.controller.getKeypadLayout(),{letters:()=>sr.createElement(cA,{controller:this.props.controller}),capitalLetters:()=>sr.createElement(dA,{controller:this.props.controller}),mainNumbers:()=>sr.createElement(pA,{controller:this.props.controller}),mainNumbers3D:()=>sr.createElement(uA,{controller:this.props.controller}),noQwertyLetters:()=>sr.createElement(hA,{controller:this.props.controller}),noQwertyCapitalLetters:()=>sr.createElement(gA,{controller:this.props.controller}),audio:()=>sr.createElement(fA,{controller:this.props.controller})}),sr.createElement(d3,{predicate:()=>this.controller.isKeypadFunctionsPopoverOpen()},()=>sr.createElement(yA,{controller:this.props.controller}))),sr.createElement(d3,{predicate:()=>this.controller.isHideKeypadButtonVisible()},()=>sr.createElement("div",{class:sr.const("dcg-minimize-keypad-container")},sr.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-hide-keypad"),gravity:this.const("n"),offset:this.const({left:6})},sr.createElement("div",{role:sr.const("button"),"aria-expanded":sr.const("true"),"aria-controls":this.const(an.uuid),"aria-label":()=>this.controller.s("graphing-calculator-label-hide-keypad"),class:sr.const("dcg-minimize-keypad"),style:()=>({"border-bottom-color":this.controller.getPillboxBackgroundColor(),background:this.controller.getPillboxBackgroundColor()}),onTap:()=>{this.controller.dispatch({type:"keypad/set-minimized",minimized:!0})}},sr.createElement("i",{class:sr.const("dcg-icon-keyboard"),"aria-hidden":sr.const("true")}),sr.createElement("i",{class:sr.const("dcg-icon-caret-down"),"aria-hidden":sr.const("true")}))))))),sr.createElement(d3,{predicate:this.bindFn(this.isShowKeypadButtonVisible)},()=>sr.createElement("div",{class:sr.const("dcg-show-keypad-container")},sr.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-show-keypad"),gravity:this.const("n")},sr.createElement("div",{role:sr.const("button"),"aria-expanded":sr.const("false"),"aria-controls":this.const(an.uuid),"aria-label":()=>this.controller.s("graphing-calculator-label-show-keypad"),class:sr.const("dcg-btn-flat-gray dcg-show-keypad dcg-do-not-blur"),style:()=>({background:this.controller.getPillboxBackgroundColor()}),onTap:()=>{this.controller.dispatch({type:"keypad/set-minimized",minimized:!1})}},sr.createElement("i",{class:sr.const("dcg-icon-keyboard"),"aria-hidden":sr.const("true")}),sr.createElement("i",{class:sr.const("dcg-icon-caret-up dcg-do-not-blur"),"aria-hidden":sr.const("true")}))))))}didMountContainer(r){this.containerElt=r}isShowKeypadButtonVisible(){return this.controller.getBrailleMode()!=="none"?!1:!this.controller.isKeypadOpen()&&!this.controller.isNarrow()&&!this.controller.isInEditListMode()&&(this.controller.isListVisible()||this.controller.inAudioTraceMode())}didMount(){this.updatePopoverPosition()}didUpdate(){this.updatePopoverPosition()}computeStyles(){let r={};return this.controller.isNarrow()||(r.transition="transform .3s, opacity .3s"),this.controller.isKeypadOpen()||(r.opacity="0",r.transform="translate3d(0, 255px, 0)"),r}updatePopoverPosition(){if(!this.controller.isKeypadFunctionsPopoverOpen()){this.__popoverCache=void 0;return}let r=this.controller.computeMajorLayout(),e={keypadTop:r.keypad.top,keypadWidth:r.keypad.width,keypadHeight:r.keypad.height,showToLeft:r.grapher.height<525};if(__dcg_shared_module_exports__['E'](e,this.__popoverCache))return;this.__popoverCache=e;let t=this.containerElt,i=t.querySelector("[dcg-command=functions]"),o=t.querySelector(".dcg-functions-popover"),n=t.querySelector(".dcg-arrow");if(e.showToLeft){o.classList.remove("dcg-top"),o.classList.add("dcg-left");var a=e.keypadHeight-(go(i).top-go(t).top),s=a-i.offsetHeight/2-2-10;n.style.left="auto",n.style.bottom=`${s}px`}else o.classList.remove("dcg-left"),o.classList.add("dcg-top"),n.style.left=`${o.offsetWidth-i.offsetWidth/2}px`,n.style.bottom="auto"}};var to=__dcg_shared_module_exports__['e'](te());var Zi=__dcg_shared_module_exports__['e'](te()),{SwitchUnion:nhe}=Zi.Components,NS=class extends Zi.Class{template(){return this.controller=this.props.controller(),nhe(()=>this.controller.getBrandingMode(),{"static-edit-link":()=>Zi.createElement("div",{class:Zi.const("dcg-graphpaper-branding")},Zi.createElement("a",{href:()=>this.controller.getEditLink(),target:Zi.const("_blank")},Zi.createElement("span",{class:Zi.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-on-desmos")},()=>this.controller.s("graphing-calculator-link-edit-on-desmos")),Zi.createElement("i",{class:Zi.const("dcg-icon-desmos"),"aria-hidden":Zi.const("true")}))),"edit-link":()=>Zi.createElement("div",{class:Zi.const("dcg-graphpaper-branding")},Zi.createElement("span",{class:Zi.const("dcg-edit-branding"),onTap:()=>this.controller.dispatch({type:"open-on-web"})},Zi.createElement("span",{class:Zi.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-on-desmos")},()=>this.controller.s("graphing-calculator-link-edit-on-desmos")),Zi.createElement("i",{class:Zi.const("dcg-icon-desmos"),"aria-hidden":Zi.const("true")}))),"powered-by":()=>Zi.createElement("div",{class:Zi.const("dcg-graphpaper-branding dcg-unclickable")},Zi.createElement("span",{class:Zi.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-powered-by-desmos")},()=>this.controller.s("graphing-calculator-label-powered-by")),Zi.createElement("i",{class:Zi.const("dcg-icon-desmos"),"aria-hidden":Zi.const("true")}))})}};var Ie=__dcg_shared_module_exports__['e'](te());qt();var fs=__dcg_shared_module_exports__['e'](te());var{If:ahe}=fs.Components,wm=class extends fs.Class{init(){this.controller=this.props.controller()}template(){return fs.createElement($e,{tooltip:this.bindFn(this.getTooltip),gravity:this.const("w")},fs.createElement("div",{class:()=>({"dcg-action-settings":!0,"dcg-pillbox-btn-interior":!0,"dcg-icon-btn":!0,"dcg-btn-flat-gray":this.isPillbox(),"dcg-settings-pillbox":this.isPillbox()}),style:()=>({background:this.isPillbox()?this.controller.getPillboxBackgroundColor():void 0}),role:fs.const("button"),tabindex:fs.const("0"),"aria-haspopup":fs.const("true"),"aria-expanded":()=>this.controller.isGraphSettingsOpen(),"aria-label":this.bindFn(this.getTooltip),onTap:this.bindFn(this.onTapSettingsButton),manageFocus:this.const(ft({controller:this.controller,location:{type:"settings",location:"icon"}}))},fs.createElement("i",{class:fs.const("dcg-icon-wrench"),"aria-hidden":fs.const("true")}),fs.createElement(ahe,{predicate:()=>this.controller.getLockViewportUserSetting()},()=>fs.createElement("i",{class:fs.const("dcg-icon-lock"),"aria-hidden":fs.const("true")}))))}getTooltip(){return this.controller.isGeometry()?this.controller.s("graphing-calculator-label-tooltip-geometry-settings"):this.controller.s("graphing-calculator-label-tooltip-graph-settings")}isPillbox(){return this.props.isPillbox&&this.props.isPillbox()}onTapSettingsButton(e){this.controller.dispatch({type:"toggle-graph-settings",focusOnOpen:e.device==="keyboard"})}};var eo=__dcg_shared_module_exports__['e'](te());var vm=__dcg_shared_module_exports__['e'](te());var xb=class extends vm.Class{template(){return vm.createElement("div",{class:vm.const("dcg-checkbox-title dcg-lock-viewport-option")},vm.createElement(xt,{ariaLabel:()=>this.props.controller().s("graphing-calculator-label-settings-lock-viewport"),onChange:()=>{this.props.controller().dispatch({type:"toggle-lock-viewport"})},checked:()=>this.props.controller().getLockViewportUserSetting()},()=>this.props.controller().s("graphing-calculator-label-settings-lock-viewport")),vm.createElement(hu,{href:this.const("https://help.desmos.com/hc/en-us/articles/4405296853517#h_01FZX4DBWKD83TZVMH615XF3QA"),controller:this.props.controller}))}};var{If:wA}=eo.Components,vA=class extends eo.Class{init(){this.controller=this.props.controller(),this.isOpen=this.getAxisScale("x")==="logarithmic"||this.getAxisScale("y")==="logarithmic"||this.props.controller().getLockViewportUserSetting()}template(){return eo.createElement("div",{class:eo.const("dcg-advanced-viewport-settings-view")},eo.createElement(wA,{predicate:()=>this.shouldShowLogScalesOption()},()=>eo.createElement("div",null,eo.createElement("div",{class:()=>({"dcg-advanced-toggle":!0,"dcg-margin-top":!0,"dcg-opened":this.isOpen}),onTap:this.bindFn(this.toggleOpen),tabindex:eo.const(0),role:eo.const("button"),"aria-pressed":()=>this.isOpen},eo.createElement("div",{class:eo.const("dcg-caret-container")},eo.createElement("i",{class:eo.const("dcg-icon-caret-down"),"aria-hidden":eo.const("true")})),()=>this.controller.s("graphing-calculator-label-more-viewport-options")),eo.createElement(wA,{predicate:()=>this.isOpen},()=>eo.createElement("div",{class:eo.const("dcg-advanced-contents")},eo.createElement("div",{class:eo.const("dcg-log-axes-container")},eo.createElement("div",null,()=>this.getAxisScaleLabel("x")),eo.createElement(Xi,{ariaGroupLabel:()=>this.getAxisScaleLabel("x"),theme:this.const("mini"),staticConfig:this.const(this.getStaticConfigForAxis("x"))}),eo.createElement("div",null,()=>this.getAxisScaleLabel("y")),eo.createElement(Xi,{ariaGroupLabel:()=>this.getAxisScaleLabel("y"),theme:this.const("mini"),staticConfig:this.const(this.getStaticConfigForAxis("y"))})),eo.createElement(wA,{predicate:()=>!this.controller.getLockViewportConfigSetting()},()=>eo.createElement(xb,{...this.props})))))),eo.createElement(wA,{predicate:()=>!this.controller.getLockViewportConfigSetting()&&!this.shouldShowLogScalesOption()},()=>eo.createElement(xb,{...this.props})))}toggleOpen(){this.isOpen=!this.isOpen,this.update()}getAxisScaleLabel(e){return e==="x"?this.controller.s("graphing-calculator-label-settings-x-axis")+":":this.controller.s("graphing-calculator-label-settings-y-axis")+":"}getStaticConfigForAxis(e){return[{key:"linear",label:()=>"Linear",selected:()=>this.getAxisScale(e)==="linear",onSelect:()=>this.setAxisScale({axis:e,scale:"linear"})},{key:"logarithmic",label:()=>"Logarithmic",selected:()=>this.getAxisScale(e)==="logarithmic",onSelect:()=>this.setAxisScale({axis:e,scale:"logarithmic"})}]}shouldShowLogScalesOption(){return this.controller.getGraphSettings().config.logScales&&!this.controller.isThreeDMode()}getAxisScale(e){return this.controller.getGraphSettings()[e==="x"?"xAxisScale":"yAxisScale"]}setAxisScale({axis:e,scale:t}){return this.controller.dispatch({type:"set-graph-settings",[e==="x"?"xAxisScale":"yAxisScale"]:t})}};var wb=__dcg_shared_module_exports__['e'](te());var Cm=class extends wb.Class{init(){this.controller=this.props.controller()}template(){return wb.createElement("div",{class:wb.const("dcg-options-menu-section dcg-radiangroup")},wb.createElement(Xi,{ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-settings-angle"),staticConfig:this.bindFn(this.getAngleModeOptions)}))}getAngleModeOptions(){return[{key:"radians",label:()=>this.controller.s("graphing-calculator-button-settings-radians"),selected:()=>!this.getDegreeMode(),onSelect:()=>this.setDegreeMode(!1),focusHelperOptions:{controller:this.controller,location:{type:"settings",location:"radian-mode"}}},{key:"degrees",label:()=>this.controller.s("graphing-calculator-button-settings-degrees"),selected:()=>this.getDegreeMode(),onSelect:()=>this.setDegreeMode(!0),focusHelperOptions:{controller:this.controller,location:{type:"settings",location:"degree-mode"}}}]}getDegreeMode(){return!!this.controller.getGraphSettings().degreeMode}setDegreeMode(e){this.controller.dispatch({type:"set-graph-settings",degreeMode:e})}};var Bh=__dcg_shared_module_exports__['e'](te());var qw=class extends Bh.Class{init(){this.controller=this.props.controller()}template(){return Bh.createElement("div",null,Bh.createElement("div",{class:Bh.const("dcg-displaysizegroup")},Bh.createElement(Xi,{ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size"),staticConfig:this.bindFn(this.getProjectorModeOptions)})),Bh.createElement(xt,{onChange:this.bindFn(this.toggleInvertedColors),checked:()=>this.controller.getInvertedColors(),manageFocus:this.const(ft({controller:this.controller,location:{type:"settings",location:"reverse-contrast"}}))},()=>this.controller.s("graphing-calculator-label-settings-reverse-contrast")))}getProjectorModeOptions(){return[{key:"default",label:()=>"A",ariaLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size-default"),class:()=>"dcg-displaysize-default",selected:()=>!this.getProjectorMode(),onSelect:()=>this.onSelectProjectorModeOption(!1),focusHelperOptions:{controller:this.controller,location:{type:"settings",location:"default-size"}}},{key:"large",label:()=>"A",ariaLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size-large"),class:()=>"dcg-displaysize-large",selected:()=>this.getProjectorMode(),onSelect:()=>this.onSelectProjectorModeOption(!0),focusHelperOptions:{controller:this.controller,location:{type:"settings",location:"large-size"}}}]}onSelectProjectorModeOption(e){this.controller.dispatch({type:"set-projector-mode",value:e})}getProjectorMode(){return!!this.controller.getGraphSettings().config.projectorMode}toggleInvertedColors(){this.controller.dispatch({type:"set-inverted-colors",value:!this.controller.getInvertedColors()})}};var La=__dcg_shared_module_exports__['e'](te());var{If:she}=La.Components,Em=class extends La.Class{init(){this.controller=this.props.controller()}template(){return La.createElement("div",null,La.createElement("div",{class:La.const("dcg-braille-options-buttons")},La.createElement(Xi,{ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-braille-mode"),staticConfig:this.bindFn(this.getBrailleOptions)})),La.createElement("div",{class:La.const("dcg-six-key-checkbox")},La.createElement(xt,{onChange:e=>this.controller.dispatch({type:"set-six-key-input",useSixKeyInput:e}),checked:()=>this.controller.getSixKeyInput()},()=>this.controller.s("graphing-calculator-label-settings-six-key-braille")),La.createElement(hu,{href:this.const("https://www.desmos.com/accessibility#braille"),controller:this.props.controller})),La.createElement(she,{predicate:this.props.showBrailleNote},()=>La.createElement("div",{class:La.const("dcg-refreshable-braille-note")},()=>this.controller.s("graphing-calculator-text-refreshable-braille-display-note")+" ",La.createElement("a",{href:()=>"https://www.desmos.com/braille-examples?"+this.controller.getBrailleMode(),class:La.const("dcg-blue-link"),target:La.const("_blank")},()=>this.controller.s("graphing-calculator-link-view-braille-examples")))))}getBrailleOptions(){return[{key:"nemeth",label:()=>this.controller.s("shared-calculator-button-braille-mode-nemeth"),selected:()=>this.controller.getBrailleMode()==="nemeth",onSelect:()=>this.setBrailleMode("nemeth")},{key:"ueb",label:()=>this.controller.s("shared-calculator-button-braille-mode-ueb"),selected:()=>this.controller.getBrailleMode()==="ueb",onSelect:()=>this.setBrailleMode("ueb")}]}setBrailleMode(e){this.controller.dispatch({type:"set-braille-mode",mode:e})}};var{Input:GX,If:Tl,IfElse:TX}=Ie.Components,wu=class extends Ie.Class{template(){return Ie.createElement(_r,{isFocused:()=>this.props.parent().getFocusedLimit()===this.props.limit(),latex:()=>this.props.parent().getLimitLatex(this.props.limit()),ariaLabel:this.props.ariaLabel,handleLatexChanged:e=>this.props.parent().setLimitLatex(this.props.limit(),e),handleFocusChanged:e=>this.props.parent().onFocusedChanged(this.props.limit(),e),hasError:()=>this.props.parent().isLimitInvalid(this.props.limit()),dataLabelAttributeValue:this.props.limit,controller:this.props.controller,readonly:this.const(!1),containerClass:()=>({"dcg-log-scale":this.props.axisScale()==="logarithmic"})})}},CA=class extends Ie.Class{init(){this.controller=this.props.controller(),this.uuid=Ng()}template(){return Ie.createElement("div",{class:Ie.const("dcg-settings-view-container")},Ie.createElement(wm,{...this.props,isPillbox:this.const(!0)}),Ie.createElement(Tl,{predicate:()=>this.controller.isGraphSettingsOpen()},()=>Ie.createElement("div",{class:Ie.const("dcg-settings-container dcg-left dcg-popover dcg-constrained-height-popover"),style:this.bindFn(this.getContainerStyle),didMount:this.bindFn(this.didMountContainer),didUnmount:this.bindFn(this.didUnmountContainer)},Ie.createElement("div",{class:Ie.const("dcg-popover-interior"),role:Ie.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-graph-settings")},Ie.createElement("div",{class:Ie.const("dcg-visual-settings")},Ie.createElement(qw,{controller:this.props.controller}),Ie.createElement(Tl,{predicate:()=>this.controller.getBrailleControls()},()=>Ie.createElement("div",{class:Ie.const("dcg-braille-container dcg-braille-mode")},Ie.createElement(xt,{onChange:this.bindFn(this.toggleBrailleMode),checked:()=>this.controller.getBrailleMode()!=="none"},()=>this.controller.s("shared-calculator-narration-braille-mode")),Ie.createElement(Tl,{predicate:()=>this.controller.getBrailleMode()!=="none"},()=>Ie.createElement("div",{class:Ie.const("dcg-braille-options-container")},Ie.createElement(Em,{controller:this.props.controller,showBrailleNote:this.const(!0)})))))),Ie.createElement("div",{class:Ie.const("dcg-top-section-flex dcg-grid-settings-container")},Ie.createElement("div",{class:Ie.const("dcg-grid-settings")},Ie.createElement(xt,{class:this.const("dcg-settings-grid-toggle"),onChange:this.bindFn(this.toggleGrid),checked:this.bindFn(this.getShowGrid)},()=>this.controller.s("graphing-calculator-label-settings-grid")),Ie.createElement(Tl,{predicate:this.bindFn(this.getShowGrid)},()=>Ie.createElement("div",{class:Ie.const("dcg-circle-icon-group dcg-grid-group")},Ie.createElement("div",{class:()=>({"dcg-circle-icon":!0,"dcg-action-cartesian":!0,"dcg-selected":!this.getPolarMode()}),role:Ie.const("button"),tabindex:Ie.const("0"),"aria-pressed":()=>!this.getPolarMode(),"aria-label":()=>this.controller.s("graphing-calculator-narration-settings-cartesian-grid"),onTap:this.bindFn(this.setCartesianMode)},Ie.createElement("i",{class:Ie.const("dcg-icon-cartesian")})),Ie.const("\xA0"),Ie.createElement("div",{class:()=>({"dcg-circle-icon":!0,"dcg-action-polar":!0,"dcg-selected":this.getPolarMode()}),role:Ie.const("button"),tabindex:Ie.const("0"),"aria-pressed":()=>this.getPolarMode(),"aria-label":()=>this.controller.s("graphing-calculator-narration-settings-polar-grid"),onTap:this.bindFn(this.setPolarMode)},Ie.createElement("i",{class:Ie.const("dcg-icon-polar")})))),Ie.createElement(xt,{onChange:this.bindFn(this.toggleArrows),checked:()=>this.getAxisArrowMode()!=="NONE"},()=>this.controller.s("graphing-calculator-label-settings-arrows")),Ie.createElement(Tl,{predicate:()=>this.getAxisArrowMode()!=="NONE"},()=>Ie.createElement("div",{class:Ie.const("dcg-circle-icon-group dcg-arrow-group")},Ie.createElement("div",{role:Ie.const("button"),tabindex:Ie.const("0"),class:()=>({"dcg-circle-icon":!0,"dcg-arrows":!0,"dcg-selected":this.getAxisArrowMode()==="BOTH"}),"dcg-arrows":Ie.const("BOTH"),"aria-label":()=>this.controller.s("graphing-calculator-narration-settings-show-both"),"aria-pressed":()=>this.getAxisArrowMode()==="BOTH",onTap:()=>this.setAxisArrowMode("BOTH")},Ie.createElement("i",{class:Ie.const("dcg-icon-arrows-two"),"aria-hidden":Ie.const("true")})),Ie.const("\xA0"),Ie.createElement("div",{role:Ie.const("button"),tabindex:Ie.const("0"),class:()=>({"dcg-circle-icon":!0,"dcg-arrows":!0,"dcg-selected":this.getAxisArrowMode()==="POSITIVE"}),"dcg-arrows":Ie.const("POSITIVE"),"aria-label":()=>this.controller.s("graphing-calculator-narration-settings-show-positive"),"aria-pressed":()=>this.getAxisArrowMode()==="POSITIVE",onTap:()=>this.setAxisArrowMode("POSITIVE")},Ie.createElement("i",{class:Ie.const("dcg-icon-arrows-one"),"aria-hidden":Ie.const("true")}))))),Ie.createElement("div",{class:Ie.const("dcg-top-checkboxes-container")},Ie.createElement(xt,{onChange:this.bindFn(this.toggleAxisNumbers),checked:this.bindFn(this.getAxisNumbers),small:this.const(!0)},()=>this.controller.s("graphing-calculator-label-settings-axis-numbers")),Ie.createElement(Tl,{predicate:()=>this.getShowGrid()&&!this.getPolarMode()},()=>Ie.createElement(xt,{onChange:this.bindFn(this.toggleMinorGridlines),checked:this.bindFn(this.getMinorGridlines),small:this.const(!0)},()=>this.controller.s("graphing-calculator-label-settings-minor-gridlines"))),Ie.createElement(Tl,{predicate:()=>this.controller.canUseAdvancedStyling()&&!this.getPolarMode()},()=>Ie.createElement(xt,{checked:()=>this.controller.getGraphSettings().restrictGridToFirstQuadrant,onChange:e=>this.controller.dispatch({type:"set-graph-settings",restrictGridToFirstQuadrant:e}),small:this.const(!0)},()=>this.controller.s("graphing-calculator-label-settings-one-quadrant"))),Ie.createElement(Tl,{predicate:this.bindFn(this.showZoomSquareButton)},()=>Ie.createElement("div",{role:Ie.const("button"),tabindex:Ie.const("0"),class:Ie.const("dcg-action-zoom-square dcg-btn-light-gray"),onTap:this.bindFn(this.zoomSquare)},()=>this.controller.s("graphing-calculator-button-settings-zoom-square"))))),Ie.createElement("div",{class:Ie.const("dcg-axes-settings-container")},Ie.createElement(Tl,{predicate:()=>!this.controller.isThreeDMode()},()=>Ie.createElement("div",{class:Ie.const("dcg-checkbox-title dcg-x-axis-title")},Ie.createElement(xt,{onChange:this.bindFn(this.toggleXAxis),checked:this.bindFn(this.getShowXAxis)},Ie.createElement("span",{id:this.const(`x-axis-description-${this.uuid}`)},()=>this.controller.s("graphing-calculator-label-settings-x-axis"))),Ie.createElement(Tl,{predicate:this.bindFn(this.getShowXAxis)},()=>Ie.createElement("div",{class:Ie.const("dcg-axis-label")},Ie.createElement("label",{for:this.const(`x-axis-label-${this.uuid}`)},()=>this.controller.s("graphing-calculator-button-label")),Ie.createElement(GX,{class:this.const("dcg-x-axis-label"),disabled:()=>this.getShowXAxis()?void 0:!0,onInput:this.bindFn(this.onXAxisLabelInput),value:this.bindFn(this.getXAxisLabel),"aria-describedby":this.const(`x-axis-description-${this.uuid}`),id:this.const(`x-axis-label-${this.uuid}`),placeholder:()=>this.controller.s("graphing-calculator-narration-settings-x-axis-label-placeholder")}))))),Ie.createElement("div",{class:Ie.const("dcg-editable-mathquill-container dcg-x-axis-options")},Ie.createElement(wu,{limit:this.const("xmin"),axisScale:()=>this.getAxisScale("x"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-x-axis-min"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),Ie.createElement(lt,{config:this.const({}),latex:this.const("\\le x\\le")},Ie.createElement("span",{class:Ie.const("dcg-interval-interior")})),Ie.createElement(wu,{limit:this.const("xmax"),axisScale:()=>this.getAxisScale("x"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-x-axis-max"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),Ie.createElement(Tl,{predicate:()=>!this.getPolarMode()&&!this.controller.isThreeDMode()},()=>TX(()=>this.getAxisScale("x")==="linear",{true:()=>Ie.createElement("span",{class:Ie.const("dcg-step-container")},Ie.createElement("span",{class:Ie.const("dcg-step-label"),"aria-hidden":Ie.const("true")},()=>this.controller.s("graphing-calculator-label-settings-step")),Ie.createElement(wu,{limit:this.const("xstep"),axisScale:this.const("linear"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-x-axis-step"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller})),false:()=>Ie.createElement("span",{style:Ie.const("display: none")})}))),Ie.createElement(Tl,{predicate:()=>!this.controller.isThreeDMode()},()=>Ie.createElement("div",{class:Ie.const("dcg-checkbox-title dcg-y-axis-title")},Ie.createElement(xt,{onChange:this.bindFn(this.toggleYAxis),checked:this.bindFn(this.getShowYAxis)},Ie.createElement("span",{id:this.const(`y-axis-description-${this.uuid}`)},()=>this.controller.s("graphing-calculator-label-settings-y-axis"))),Ie.createElement(Tl,{predicate:this.bindFn(this.getShowYAxis)},()=>Ie.createElement("div",{class:Ie.const("dcg-axis-label")},Ie.createElement("label",{for:this.const(`y-axis-label-${this.uuid}`)},()=>this.controller.s("graphing-calculator-button-label")),Ie.createElement(GX,{class:this.const("dcg-y-axis-label"),onInput:this.bindFn(this.onYAxisLabelInput),value:this.bindFn(this.getYAxisLabel),"aria-describedby":this.const(`y-axis-description-${this.uuid}`),id:this.const(`y-axis-label-${this.uuid}`),placeholder:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-label-placeholder")}))))),Ie.createElement("div",{class:Ie.const("dcg-editable-mathquill-container dcg-y-axis-options")},Ie.createElement(wu,{limit:this.const("ymin"),axisScale:()=>this.getAxisScale("y"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-min"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),Ie.createElement(lt,{config:this.const({}),latex:this.const("\\le y\\le")},Ie.createElement("span",{class:Ie.const("dcg-interval-interior")})),Ie.createElement(wu,{limit:this.const("ymax"),axisScale:()=>this.getAxisScale("y"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-max"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),Ie.createElement(Tl,{predicate:()=>!this.getPolarMode()&&!this.controller.isThreeDMode()},()=>TX(()=>this.getAxisScale("y")==="linear",{true:()=>Ie.createElement("span",{class:Ie.const("dcg-step-container")},Ie.createElement("span",{class:Ie.const("dcg-step-label"),"aria-hidden":Ie.const("true")},()=>this.controller.s("graphing-calculator-label-settings-step")),Ie.createElement(wu,{limit:this.const("ystep"),axisScale:this.const("linear"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-step"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller})),false:()=>Ie.createElement("span",{style:Ie.const("display: none")})}))),Ie.createElement(Tl,{predicate:()=>this.controller.isThreeDMode()},()=>Ie.createElement("div",null,Ie.createElement("div",{class:Ie.const("dcg-editable-mathquill-container dcg-z-axis-options")},Ie.createElement(wu,{limit:this.const("zmin"),axisScale:this.const("linear"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-z-axis-min"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),Ie.createElement(lt,{config:this.const({}),latex:this.const("\\le z\\le")},Ie.createElement("span",{class:Ie.const("dcg-interval-interior")})),Ie.createElement(wu,{limit:this.const("zmax"),axisScale:this.const("linear"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-z-axis-max"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller})))),Ie.createElement(vA,{controller:this.props.controller})),Ie.createElement(Cm,{controller:this.props.controller}),Ie.createElement("div",{class:Ie.const("dcg-arrow")})))))}toggleBrailleMode(){this.controller.dispatch({type:"set-braille-mode",mode:this.controller.getBrailleMode()==="none"?"nemeth":"none"})}didMountContainer(e){this.node=e,ie(document.documentElement).on("dcg-tapstart.settings-view wheel.settings-view",t=>{this.eventShouldClosePopover(t)&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:t.device==="keyboard"})}),ie(document.documentElement).on("keydown.settings-view",t=>{let i=Be(t);if(i==="Esc"&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:!0}),this.controller.isGraphSettingsOpen()&&i==="Tab"&&!t.altKey&&!t.metaKey&&!t.ctrlKey){let o=this.controller.getFocusLocation();if(!o||o.type!=="settings")return;t.shiftKey?t.shiftKey&&(o.location==="default-size"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation()):o.location==="icon"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"degree-mode"}}),t.preventDefault(),t.stopPropagation())):o.location==="icon"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"default-size"}}),t.preventDefault(),t.stopPropagation()):o.location==="degree-mode"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation())}})}didUnmountContainer(){ie(document.documentElement).off(".settings-view")}didUpdate(){if(!this.controller.isGraphSettingsOpen())return;let e=this.controller.getKeypadHeight();e!==this.cachedKeypadHeight&&document.activeElement&&this.node.contains(document.activeElement)&&yc(document.activeElement,this.node.querySelector(".dcg-popover-interior"),50),this.cachedKeypadHeight=e}eventShouldClosePopover(e){let t=e.target,i=this.node.contains(t),o=!!t.closest(".dcg-action-settings"),n=this.isMathquillFocused()&&!!t.closest(".dcg-keypad"),a=!!t.closest(".dcg-action-undo")||!!t.closest(".dcg-action-redo");return!(i||o||n||a)}isMathquillFocused(){return this.getFocusedLimit()!==void 0}getLimitLatex(e){return this.controller.getSettingsViewModel().limitLatex[e]||""}setLimitLatex(e,t){t!==this.controller.getSettingsViewModel().limitLatex[e]&&this.controller.dispatch({type:"set-axis-limit-latex",limit:e,latex:t})}getFocusedLimit(){let e=this.controller.getFocusLocation();if(e&&e.type==="settings")return e.location}getInvalidLimits(){let e=!!this.controller.getGraphSettings().degreeMode,t=Bi(this.getLimitLatex("xmin"),e),i=Bi(this.getLimitLatex("xmax"),e),o=Bi(this.getLimitLatex("ymin"),e),n=Bi(this.getLimitLatex("ymax"),e),a=this.getLimitLatex("xstep")===""?0:Bi(this.getLimitLatex("xstep"),e),s=this.getLimitLatex("ystep")===""?0:Bi(this.getLimitLatex("ystep"),e),l={},c=new di(t,i,o,n);return isFinite(t)&&isFinite(i)?(l.xmin=!c.isXValid(this.controller.getGraphSettings().xAxisScale),l.xmax=l.xmin):(l.xmin=!isFinite(t),l.xmax=!isFinite(i)),isFinite(o)&&isFinite(n)?(l.ymin=!c.isYValid(this.controller.getGraphSettings().yAxisScale),l.ymax=l.ymin):(l.ymin=!isFinite(o),l.ymax=!isFinite(n)),l.xstep=!yy(a),l.ystep=!yy(s),l}isLimitInvalid(e){return this.getInvalidLimits()[e]}onFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"settings",location:e}})}onXAxisLabelInput(e){this.controller.dispatch({type:"set-graph-settings",xAxisLabel:e})}onYAxisLabelInput(e){this.controller.dispatch({type:"set-graph-settings",yAxisLabel:e})}getXAxisLabel(){return this.controller.getGraphSettings().xAxisLabel}getYAxisLabel(){return this.controller.getGraphSettings().yAxisLabel}getShowXAxis(){return!!this.controller.getGraphSettings().showXAxis}toggleXAxis(){this.controller.dispatch({type:"set-graph-settings",showXAxis:!this.getShowXAxis()})}getShowYAxis(){return!!this.controller.getGraphSettings().showYAxis}toggleYAxis(){this.controller.dispatch({type:"set-graph-settings",showYAxis:!this.getShowYAxis()})}getAxisNumbers(){return!!this.controller.getGraphSettings().xAxisNumbers}toggleAxisNumbers(){let e=this.getAxisNumbers();this.controller.dispatch({type:"set-graph-settings",xAxisNumbers:!e,yAxisNumbers:!e,polarNumbers:!e})}getMinorGridlines(){return this.controller.getGraphSettings().xAxisMinorSubdivisions===0}toggleMinorGridlines(){let e=this.getMinorGridlines()?1:0;this.controller.dispatch({type:"set-graph-settings",yAxisMinorSubdivisions:e,xAxisMinorSubdivisions:e})}getPolarMode(){return!!this.controller.getGraphSettings().polarMode}setPolarMode(){this.controller.dispatch({type:"set-polar-mode",polarMode:!0})}setCartesianMode(){this.controller.dispatch({type:"set-polar-mode",polarMode:!1})}getAxisScale(e){return this.controller.getGraphSettings()[e==="x"?"xAxisScale":"yAxisScale"]}getAxisArrowMode(){return this.controller.getGraphSettings().xAxisArrowMode}setAxisArrowMode(e){this.controller.dispatch({type:"set-graph-settings",xAxisArrowMode:e,yAxisArrowMode:e})}getShowGrid(){return this.controller.getGraphSettings().showGrid}toggleGrid(){this.controller.dispatch({type:"set-graph-settings",showGrid:!this.getShowGrid()})}toggleArrows(){let e=this.getAxisArrowMode()==="NONE"?"BOTH":"NONE";this.controller.dispatch({type:"set-graph-settings",xAxisArrowMode:e,yAxisArrowMode:e})}showZoomSquareButton(){let e=this.controller.getAxisScaleSettings();return!this.controller.isThreeDMode()&&e.xAxisScale===e.yAxisScale&&!this.controller.getGraphSettings().squareAxes}getContainerStyle(){return this.controller.getKeypadHeight()?"bottom: 0":""}zoomSquare(){this.controller.dispatch({type:"zoom",direction:"square"})}};var si=__dcg_shared_module_exports__['e'](te());qt();var gt=__dcg_shared_module_exports__['e'](te());var{If:Sm}=gt.Components,Dm=class extends gt.Class{template(){return gt.createElement(_r,{isFocused:()=>this.props.parent().getFocusedLimit()===this.props.limit(),latex:()=>this.props.parent().getLimitLatex(this.props.limit()),ariaLabel:this.props.ariaLabel,handleLatexChanged:e=>this.props.parent().setLimitLatex(this.props.limit(),e),handleFocusChanged:e=>this.props.parent().onFocusedChanged(this.props.limit(),e),hasError:()=>this.props.parent().isLimitInvalid(this.props.limit()),dataLabelAttributeValue:this.props.limit,controller:this.props.controller,readonly:this.const(!1)})}},EA=class extends gt.Class{init(){this.controller=this.props.controller(),this.isOpen=this.mustBeOpen()}willUpdate(){this.mustBeOpen()&&(this.isOpen=!0)}mustBeOpen(){var t;let e=(t=this.controller.getGrapher3d())==null?void 0:t.viewportController.getViewport();return e?e.xmin!==e.ymin||e.xmin!==e.zmin||e.xmax!==e.ymax||e.xmax!==e.zmax:!1}template(){return gt.createElement("div",{class:gt.const("dcg-three-d-domain dcg-advanced-viewport-settings-view dcg-options-menu-section")},gt.createElement("div",{class:gt.const("dcg-options-menu-section-title dcg-flex-container")},gt.createElement("div",null,()=>this.controller.s("graphing-calculator-label-edit-graph-bounds")),gt.createElement("div",null,gt.createElement(Sm,{predicate:this.bindFn(this.showRecenterButton)},()=>gt.createElement("div",{role:gt.const("button"),tabindex:gt.const("0"),class:gt.const("dcg-action-zoom-recenter dcg-btn-light-gray"),onTap:this.bindFn(this.zoomRecenter)},()=>this.controller.s("graphing-calculator-label-recenter"))))),gt.createElement("div",{class:gt.const("dcg-three-d-domain-toggle-container")},gt.createElement("div",{class:()=>({"dcg-advanced-toggle":!0,"dcg-opened":this.isOpen,"dcg-disabled":this.mustBeOpen()}),onTap:this.bindFn(this.toggleOpen),tabindex:()=>this.mustBeOpen()?-1:0,"aria-disabled":()=>this.mustBeOpen(),role:gt.const("button"),"aria-pressed":()=>this.isOpen,"aria-expanded":()=>this.isOpen,"aria-label":()=>this.controller.s("graphing-calculator-label-edit-graph-bounds")},gt.createElement("div",{class:gt.const("dcg-caret-container")},gt.createElement("i",{class:gt.const("dcg-icon-caret-down"),"aria-hidden":gt.const("true")})),gt.createElement(Sm,{predicate:()=>this.isOpen},()=>gt.createElement("span",{class:gt.const("dcg-axis-label")},gt.createElement(lt,{config:this.const({}),latex:this.const("x")}),gt.const("-axis:"))),gt.createElement(Sm,{predicate:()=>!this.isOpen},()=>gt.createElement("span",{class:gt.const("dcg-axis-label")},()=>this.controller.s("graphing-calculator-label-settings-all-axes")))),gt.createElement("div",{class:gt.const("dcg-editable-mathquill-container dcg-x-axis-options")},gt.createElement(Dm,{limit:this.const("xmin"),ariaLabel:()=>this.isOpen?this.controller.s("graphing-calculator-narration-settings-x-axis-min"):this.controller.s("graphing-calculator-narration-settings-all-axes-min"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),gt.createElement(Sm,{predicate:()=>this.isOpen},()=>gt.createElement(lt,{config:this.const({}),latex:this.const("\\le x\\le")},gt.createElement("span",{class:gt.const("dcg-interval-interior")}))),gt.createElement(Sm,{predicate:()=>!this.isOpen},()=>gt.createElement("span",{class:gt.const("dcg-axis-label-to")},()=>this.controller.s("shared-label-to"))),gt.createElement(Dm,{limit:this.const("xmax"),ariaLabel:()=>this.isOpen?this.controller.s("graphing-calculator-narration-settings-x-axis-max"):this.controller.s("graphing-calculator-narration-settings-all-axes-max"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}))),gt.createElement(Sm,{predicate:()=>this.isOpen},()=>gt.createElement("div",{class:gt.const("dcg-advanced-contents")},gt.createElement("div",{class:gt.const("dcg-editable-mathquill-container dcg-y-axis-options")},gt.createElement("span",{class:gt.const("dcg-axis-label")},gt.createElement(lt,{config:this.const({}),latex:this.const("y")}),gt.const("-axis:")),gt.createElement(Dm,{limit:this.const("ymin"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-min"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),gt.createElement(lt,{config:this.const({}),latex:this.const("\\le y\\le")},gt.createElement("span",{class:gt.const("dcg-interval-interior")})),gt.createElement(Dm,{limit:this.const("ymax"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-max"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller})),gt.createElement("div",null,gt.createElement("div",{class:gt.const("dcg-editable-mathquill-container dcg-z-axis-options")},gt.createElement("span",{class:gt.const("dcg-axis-label")},gt.createElement(lt,{config:this.const({}),latex:this.const("z")}),gt.const("-axis:")),gt.createElement(Dm,{limit:this.const("zmin"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-z-axis-min"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),gt.createElement(lt,{config:this.const({}),latex:this.const("\\le z\\le")},gt.createElement("span",{class:gt.const("dcg-interval-interior")})),gt.createElement(Dm,{limit:this.const("zmax"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-z-axis-max"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}))),gt.createElement(Sm,{predicate:this.bindFn(this.showZoomSquareButton)},()=>gt.createElement("div",null,gt.createElement("div",{role:gt.const("button"),tabindex:gt.const("0"),class:gt.const("dcg-action-zoom-square-3d dcg-btn-primary"),onTap:this.bindFn(this.zoomSquare)},()=>this.controller.s("graphing-calculator-button-settings-zoom-square")))))),gt.createElement(Sm,{predicate:()=>!this.controller.getLockViewportConfigSetting()},()=>gt.createElement(xt,{ariaLabel:()=>this.props.controller().s("graphing-calculator-label-disable-zoom"),onChange:()=>{this.props.controller().dispatch({type:"toggle-lock-viewport"})},checked:()=>this.props.controller().getLockViewportUserSetting()},()=>this.props.controller().s("graphing-calculator-label-disable-zoom"))))}showRecenterButton(){var t;let e=(t=this.controller.getGrapher3d())==null?void 0:t.webglLayer.domain();return!!e&&!vY(e,0)}zoomRecenter(e){this.controller.dispatch({type:"zoom",direction:"recenter"}),e.device==="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"xmin"}})}getFocusedLimit(){let e=this.controller.getFocusLocation();if(e&&e.type==="settings")return e.location}getLimitLatex(e){return this.controller.getSettingsViewModel().limitLatex[e]||""}setLimitLatex(e,t){t!==this.controller.getSettingsViewModel().limitLatex[e]&&this.controller.dispatch({type:"set-axis-limit-latex",limit:e,latex:t,updateYZAlso:!this.isOpen&&(e==="xmin"||e==="xmax")})}getInvalidLimits(){let e=!!this.controller.getGraphSettings().degreeMode,t=Bi(this.getLimitLatex("xmin"),e),i=Bi(this.getLimitLatex("xmax"),e),o=Bi(this.getLimitLatex("ymin"),e),n=Bi(this.getLimitLatex("ymax"),e),a=Bi(this.getLimitLatex("zmin"),e),s=Bi(this.getLimitLatex("zmax"),e),l={},c=new di(t,i,o,n,a,s);return isFinite(t)&&isFinite(i)?(l.xmin=!c.isXValid(this.controller.getGraphSettings().xAxisScale),l.xmax=l.xmin):(l.xmin=!isFinite(t),l.xmax=!isFinite(i)),isFinite(o)&&isFinite(n)?(l.ymin=!c.isYValid(this.controller.getGraphSettings().yAxisScale),l.ymax=l.ymin):(l.ymin=!isFinite(o),l.ymax=!isFinite(n)),isFinite(a)&&isFinite(s)?(l.zmin=!c.isZValid(),l.zmax=l.zmin):(l.zmin=!isFinite(a),l.zmax=!isFinite(s)),l}isLimitInvalid(e){return this.getInvalidLimits()[e]}onFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"settings",location:e}})}toggleOpen(){this.mustBeOpen()||(this.isOpen=!this.isOpen,this.update())}showZoomSquareButton(){return!this.controller.getGraphSettings().squareAxes}zoomSquare(e){this.controller.dispatch({type:"zoom",direction:"square"}),e.device==="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"zmax"}})}};var rl=__dcg_shared_module_exports__['e'](te());var{If:MX}=rl.Components,Hw=class extends rl.Class{init(){this.controller=this.props.controller()}template(){return rl.createElement(MX,{predicate:this.bindFn(this.shouldShowBrailleSection)},()=>rl.createElement("div",{class:rl.const("dcg-options-menu-section")},rl.createElement("div",{class:rl.const("dcg-options-menu-section-title")},()=>this.controller.s("shared-calculator-narration-braille-mode"),rl.createElement(yo,{ariaLabel:()=>this.controller.s("shared-calculator-narration-braille-mode"),onChange:this.bindFn(this.toggleBrailleMode),toggled:()=>this.controller.getBrailleMode()!=="none"})),rl.createElement(MX,{predicate:()=>this.controller.getBrailleMode()!=="none"},()=>rl.createElement("div",{class:rl.const("dcg-braille-options-container")},rl.createElement(Em,{controller:this.props.controller,showBrailleNote:this.const(!0)})))))}shouldShowBrailleSection(){return this.controller.getBrailleControls()&&this.controller.getGraphSettings().config.expressions}toggleBrailleMode(){this.controller.dispatch({type:"set-braille-mode",mode:this.controller.getBrailleMode()==="none"?"nemeth":"none"})}};var{If:IX}=si.Components,SA=class extends si.Class{init(){this.controller=this.props.controller()}template(){return si.createElement("div",{class:si.const("dcg-settings-view-container dcg-settings-view-3d-container")},si.createElement("div",{class:si.const("dcg-3d-settings-flex-container")},si.createElement(wm,{...this.props,isPillbox:this.const(!0)})),si.createElement(IX,{predicate:()=>this.controller.isGraphSettingsOpen()},()=>si.createElement("div",{class:si.const("dcg-settings-container dcg-left dcg-popover dcg-constrained-height-popover"),style:this.bindFn(this.getContainerStyle),didMount:this.bindFn(this.didMountContainer),didUnmount:this.bindFn(this.didUnmountContainer)},si.createElement("div",{class:si.const("dcg-popover-interior dcg-generic-options-menu"),role:si.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-graph-settings")},si.createElement(EI,{controller:this.props.controller}),si.createElement(EA,{controller:this.props.controller}),si.createElement("div",{class:si.const("dcg-options-menu-section")},si.createElement("div",{class:si.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-label-axes"),si.createElement(yo,{ariaLabel:()=>this.controller.s("graphing-calculator-label-axes"),onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showAxis3D:!this.controller.getGraphSettings().showAxis3D})},toggled:()=>!!this.controller.getGraphSettings().showAxis3D})),si.createElement(IX,{predicate:()=>this.controller.getGraphSettings().showAxis3D},()=>si.createElement("div",{class:si.const("dcg-show-axis-labels-section")},si.createElement("div",null,si.createElement(xt,{onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showPlane3D:!this.controller.getGraphSettings().showPlane3D})},checked:()=>!!this.controller.getGraphSettings().showPlane3D},()=>this.controller.s("graphing-calculator-label-settings-domain-plane"))),si.createElement("div",null,si.createElement(xt,{onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showNumbers3D:!this.controller.getGraphSettings().showNumbers3D})},checked:()=>!!this.controller.getGraphSettings().showNumbers3D},()=>this.controller.s("graphing-calculator-label-settings-numbers-3d"))),si.createElement("div",null,si.createElement(xt,{onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showAxisLabels3D:!this.controller.getGraphSettings().showAxisLabels3D})},checked:()=>!!this.controller.getGraphSettings().showAxisLabels3D},()=>this.controller.s("graphing-calculator-label-settings-axis-labels-3d")))))),si.createElement(Hw,{controller:this.props.controller}),si.createElement(Cm,{controller:this.props.controller}),si.createElement("div",{class:si.const("dcg-arrow")})))))}didMountContainer(e){this.node=e,ie(document.documentElement).on("dcg-tapstart.settings-view wheel.settings-view",t=>{this.eventShouldClosePopover(t)&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:t.device==="keyboard"})}),ie(document.documentElement).on("keydown.settings-view",t=>{let i=Be(t);if(i==="Esc"&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:!0}),this.controller.isGraphSettingsOpen()&&i==="Tab"&&!t.altKey&&!t.metaKey&&!t.ctrlKey){let o=this.controller.getFocusLocation();if(!o||o.type!=="settings")return;t.shiftKey?t.shiftKey&&(o.location==="reverse-contrast"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation()):o.location==="icon"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"degree-mode"}}),t.preventDefault(),t.stopPropagation())):o.location==="icon"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"reverse-contrast"}}),t.preventDefault(),t.stopPropagation()):o.location==="degree-mode"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation())}})}didUnmountContainer(){ie(document.documentElement).off(".settings-view")}didUpdate(){if(!this.controller.isGraphSettingsOpen())return;let e=this.controller.getKeypadHeight();e!==this.cachedKeypadHeight&&document.activeElement&&this.node.contains(document.activeElement)&&yc(document.activeElement,this.node.querySelector(".dcg-popover-interior"),50),this.cachedKeypadHeight=e}eventShouldClosePopover(e){let t=e.target,i=this.node.contains(t),o=!!t.closest(".dcg-action-settings"),n=this.isMathquillFocused()&&t.closest(".dcg-keypad"),a=!!t.closest(".dcg-action-undo")||!!t.closest(".dcg-action-redo");return!(i||o||n||a)}isMathquillFocused(){let e=this.controller.getFocusLocation();return(e==null?void 0:e.type)==="settings"}getContainerStyle(){return this.controller.getKeypadHeight()?"bottom: 0":""}};var sn=__dcg_shared_module_exports__['e'](te());var DA=class extends sn.Class{init(){this.controller=this.props.controller()}template(){return sn.createElement("div",{class:sn.const("dcg-zoom-container")},sn.createElement("div",{class:sn.const("dcg-zoominout-pillbox dcg-btn-flat-gray dcg-btn-flat-gray-group dcg-group-vertical"),style:()=>({background:this.controller.getPillboxBackgroundColor()}),role:sn.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-narration-zoom-options-label")},sn.createElement($e,{tooltip:this.bindFn(this.getZoomInLabel),displayBlock:this.const(!0),gravity:this.const("w")},sn.createElement("div",{class:sn.const("dcg-action-zoomin dcg-pillbox-btn-interior"),role:sn.const("button"),tabindex:sn.const("0"),"aria-label":this.bindFn(this.getZoomInLabel),onTap:this.bindFn(this.zoomIn),manageFocus:this.const(ft({controller:this.controller,location:{type:"zoom-in-btn"}}))},sn.createElement("i",{class:sn.const("dcg-icon-plus"),"aria-hidden":sn.const("true")}))),sn.createElement($e,{tooltip:this.bindFn(this.getZoomOutLabel),displayBlock:this.const(!0),gravity:this.const("w")},sn.createElement("div",{class:sn.const("dcg-action-zoomout dcg-pillbox-btn-interior"),role:sn.const("button"),tabindex:sn.const("0"),"aria-label":this.bindFn(this.getZoomOutLabel),onTap:this.bindFn(this.zoomOut)},sn.createElement("i",{class:sn.const("dcg-icon-minus"),"aria-hidden":sn.const("true")})))))}zoomIn(){this.controller.dispatch({type:"zoom",direction:"in"})}zoomOut(){this.controller.dispatch({type:"zoom",direction:"out"})}getZoomInLabel(){return this.controller.s("graphing-calculator-label-tooltip-zoom-in")}getZoomOutLabel(){return this.controller.s("graphing-calculator-label-tooltip-zoom-out")}};var ac=__dcg_shared_module_exports__['e'](te());var BS=class extends ac.Class{init(){this.controller=this.props.controller()}template(){return ac.createElement("div",{class:ac.const("dcg-reset-container")},ac.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-reset"),gravity:this.props.tooltipGravity},ac.createElement("div",{class:ac.const("dcg-reset-pillbox dcg-action-reset dcg-btn-flat-gray dcg-pillbox-btn-interior"),role:ac.const("button"),tabindex:ac.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-reset"),onTap:this.bindFn(this.reset),style:()=>({background:this.controller.getPillboxBackgroundColor()})},ac.createElement("i",{class:ac.const("dcg-icon-reset"),"aria-hidden":ac.const("true")}))))}reset(){this.controller.dispatch({type:"reset-graph"})}};var sp=__dcg_shared_module_exports__['e'](te());var kA=class extends sp.Class{init(){this.controller=this.props.controller()}template(){return sp.createElement($e,{tooltip:this.bindFn(this.getZoomRestoreLabel),gravity:this.const("w")},sp.createElement("div",{class:()=>({"dcg-btn-flat-gray":!0,"dcg-pillbox-btn-interior":!0,"dcg-action-zoomrestore":!0}),role:sp.const("button"),tabindex:sp.const("0"),"aria-label":this.bindFn(this.getZoomRestoreLabel),onTap:this.bindFn(this.setDefaultViewport),style:()=>({background:this.controller.getPillboxBackgroundColor()}),manageFocus:this.const(ft({controller:this.controller,location:{type:"zoom-restore-btn"}}))},sp.createElement("i",{class:sp.const("dcg-icon-home"),"aria-hidden":sp.const("true")})))}setDefaultViewport(){this.controller.dispatch({type:"zoom",direction:"default"}),this.controller.dispatch({type:"set-focus-location",location:{type:"zoom-in-btn"}})}getZoomRestoreLabel(){return this.controller.s("graphing-calculator-label-tooltip-viewport-default")}};var bs=__dcg_shared_module_exports__['e'](te());var US=class extends bs.Class{init(){this.controller=this.props.controller()}template(){return bs.createElement("div",{class:()=>({"dcg-3d-orientation-pillbox":!0,"dcg-btn-flat-gray":!0,"dcg-btn-flat-gray-group":!0,"dcg-group-horizontal":this.props.layout()==="horizontal","dcg-group-vertical":this.props.layout()==="vertical"}),style:()=>({background:this.controller.getPillboxBackgroundColor()}),role:bs.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-narration-3d-orientation-options-label")},bs.createElement($e,{disabled:this.bindFn(this.isDefaultOrientation),tooltip:this.bindFn(this.getDefaultOrientationLabel),gravity:this.bindFn(this.getTooltipGravity),displayBlock:this.const(!0)},bs.createElement("div",{class:()=>({"dcg-action-defaultorientation":!0,"dcg-pillbox-btn-interior":!0,"dcg-disabled":this.isDefaultOrientation()}),role:bs.const("button"),"aria-disabled":this.bindFn(this.isDefaultOrientation),tabindex:()=>this.isDefaultOrientation()?-1:0,"aria-label":this.bindFn(this.getDefaultOrientationLabel),onTap:this.bindFn(this.rotateToDefaultOrientation)},bs.createElement("i",{class:bs.const("dcg-icon-3d-cube"),"aria-hidden":bs.const("true")}))),bs.createElement($e,{tooltip:this.bindFn(this.getXYOrientationLabel),gravity:this.bindFn(this.getTooltipGravity),disabled:this.bindFn(this.isXYPlaneOrientation),displayBlock:this.const(!0)},bs.createElement("div",{class:()=>({"dcg-action-xyorientation":!0,"dcg-pillbox-btn-interior":!0,"dcg-disabled":this.isXYPlaneOrientation()}),role:bs.const("button"),"aria-disabled":this.bindFn(this.isXYPlaneOrientation),tabindex:()=>this.isXYPlaneOrientation()?-1:0,"aria-label":this.bindFn(this.getXYOrientationLabel),onTap:this.bindFn(this.rotateToXyOrientation)},bs.createElement("i",{class:bs.const("dcg-icon-xy-plane"),"aria-hidden":bs.const("true")}))))}getTooltipGravity(){return this.props.layout()==="horizontal"?"s":"w"}rotateToDefaultOrientation(){this.controller.dispatch({type:"zoom",direction:"default3dOrientation"})}rotateToXyOrientation(){this.controller.dispatch({type:"zoom",direction:"xy3dOrientation"})}isDefaultOrientation(){var t;let e=(t=this.controller.getGrapher3d())==null?void 0:t.controls;return!!(e!=null&&e.isDefaultOrientation())}isXYPlaneOrientation(){var t;let e=(t=this.controller.getGrapher3d())==null?void 0:t.controls;return!!(e!=null&&e.isXYPlaneOrientation())}getDefaultOrientationLabel(){return this.controller.s("graphing-calculator-label-tooltip-zoom-default-orientation")}getXYOrientationLabel(){return this.controller.s("graphing-calculator-label-tooltip-zoom-xy-orientation")}};var{Each:lhe,If:zS}=to.Components,GA=class extends to.Class{init(){this.controller=this.props.controller()}template(){return to.createElement("div",null,to.createElement(zS,{predicate:this.bindFn(this.shouldShowLeftPillboxes)},()=>to.createElement("div",{class:()=>({"dcg-left-pillboxes":!0,"dcg-geometry-toolbar-present":this.controller.shouldShowGeoToolbar()})},to.createElement(zS,{predicate:this.bindFn(this.shouldShowUndoRedo)},()=>to.createElement(Mw,{controller:this.props.controller,isPillbox:this.const(!0)})),to.createElement(zS,{predicate:this.bindFn(this.shouldShowGeoReset)},()=>to.createElement(BS,{controller:this.props.controller,tooltipGravity:this.const("s")})))),to.createElement("div",{class:()=>({"dcg-pillbox-container":!0,"dcg-geometry-toolbar-present":this.controller.shouldShowGeoToolbar()}),role:()=>this.controller.isGeoUIActive()?void 0:"region","aria-label":()=>this.controller.isGeoUIActive()?void 0:this.controller.s("graphing-calculator-narration-graph-settings-controls")},to.createElement("div",{class:to.const("dcg-overgraph-pillbox-elements"),style:this.bindFn(this.getContainerStyle)},to.createElement(zS,{predicate:()=>this.shouldShowOrientationPillbox()&&!this.onSmallScreen()},()=>to.createElement("div",{class:to.const("dcg-left-pillbox-elements")},to.createElement(US,{controller:this.props.controller,layout:this.const("horizontal")}))),to.createElement(zS,{predicate:()=>this.getRightPillboxElements().length>0},()=>to.createElement("div",{class:to.const("dcg-right-pillbox-elements")},lhe(()=>this.getRightPillboxElements(),{item:e=>{switch(e){case"settings2d":return to.createElement(CA,{controller:this.props.controller});case"settings3d":return to.createElement(SA,{controller:this.props.controller});case"settings-geo":return to.createElement(wm,{...this.props,isPillbox:this.const(!0)});case"reset":return to.createElement(BS,{controller:this.props.controller,tooltipGravity:this.const("w")});case"zoom-in-out":return to.createElement(DA,{controller:this.props.controller});case"orientation":return to.createElement(US,{layout:this.const("vertical"),controller:this.props.controller});case"zoom-home":return to.createElement(kA,{controller:this.props.controller})}}}))))),to.createElement(NS,{controller:()=>this.props.controller()}))}shouldShowLeftPillboxes(){return this.shouldShowGeoReset()||this.shouldShowUndoRedo()}shouldShowGeoReset(){return this.controller.isGeometry()&&this.shouldShowResetButton()&&!this.controller.isListEnabled()}shouldShowUndoRedo(){return this.controller.isGeometry()&&!this.controller.isListEnabled()&&!(this.controller.getGeoToolbarSuppressedByAuthor()||this.controller.getGraphSettings().config.hideGeoUI)}getRightPillboxElements(){let e=[];return this.shouldShowGraphSettings()&&e.push("settings2d"),this.shouldShow3DGraphSettings()&&e.push("settings3d"),this.shouldShowGeometrySettings()&&e.push("settings-geo"),this.shouldShowResetButton()&&!this.shouldShowGeoReset()&&e.push("reset"),this.shouldShowZoomInOutButtons()&&e.push("zoom-in-out"),this.shouldShowOrientationPillbox()&&this.onSmallScreen()&&e.push("orientation"),this.shouldShowZoomHomeButton()&&e.push("zoom-home"),e}shouldShowOrientationPillbox(){return this.controller.is3dProduct()}getContainerStyle(){let e=this.controller.isKeypadOpen()?this.controller.getKeypadHeight():0;return this.controller.isGraphSettingsOpen()?`bottom: ${e}px;`:"bottom: auto"}shouldShow3DGraphSettings(){return this.controller.getGraphSettings().config.settingsMenu&&this.controller.is3dProduct()}shouldShowGraphSettings(){return this.controller.getGraphSettings().config.settingsMenu&&!this.controller.isGeometry()&&!this.controller.is3dProduct()}shouldShowGeometrySettings(){return this.controller.getGraphSettings().config.settingsMenu?this.controller.isGeometry():!1}zoomEnabled(){return this.controller.getGraphSettings().config.zoomButtons&&!this.isViewportLocked()}onSmallScreen(){let e=this.controller.getLayoutMeasurements();return e.width<450||e.height<450}shouldShowZoomInOutButtons(){return this.onSmallScreen()?!1:this.zoomEnabled()}shouldShowZoomHomeButton(){return this.zoomEnabled()&&!this.controller.isDefaultViewportRestored()}isViewportLocked(){return this.controller.getGraphSettings().config.lockViewport||this.controller.getGraphSettings().userLockedViewport}shouldShowResetButton(){return this.controller.getGraphSettings().config.showResetButtonOnGraphpaper&&this.controller.hasDefaultState()}};var Pi=__dcg_shared_module_exports__['e'](te());var Qr=__dcg_shared_module_exports__['e'](te());var TA=__dcg_shared_module_exports__['e'](te());function VX(r,e,t){r.save();for(let i of t)switch(i.type){case"point":{let o;!i.color||i.color==="dark"?o=dT({isPoint:!0,color:e.point,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1}):i.color==="light"?o=__dcg_shared_module_exports__['P'](e.point,.7):o=i.color;let n;switch(i.size){case"small":n=5;break;case"large":n=10;break;case"medium":default:n=5;break}i.hollow?(r.lineWidth=2,r.strokeStyle=o,r.beginPath(),r.arc(i.x,i.y,n-1,0,2*Math.PI),r.stroke()):(r.fillStyle=o,r.beginPath(),r.arc(i.x,i.y,n,0,2*Math.PI),r.fill())}break;case"circle":{let o;!i.color||i.color==="dark"?o=RC({isPoint:!1,color:e.circle,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1}):i.color==="light"?o=__dcg_shared_module_exports__['P'](e.circle,.7):o=i.color;let n;switch(i.lineWidth){case"small":n=2;break;case"large":n=7;break;case"medium":default:n=4;break}r.lineWidth=n,r.strokeStyle=o,r.beginPath(),r.arc(i.x,i.y,i.radius,0,2*Math.PI),r.stroke()}break;case"arc":{let o;!i.color||i.color==="dark"?o=RC({isPoint:!1,color:e.circle,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1}):i.color==="light"?o=__dcg_shared_module_exports__['P'](e.circle,.7):o=i.color;let n;switch(i.lineWidth){case"small":n=2;break;case"large":n=7;break;case"medium":default:n=4;break}r.lineWidth=n,r.strokeStyle=o,r.beginPath(),r.arc(i.x,i.y,i.radius,i.startAngle,i.endAngle),r.stroke()}break;case"stroked-path":{let o;!i.color||i.color==="dark"?o=RC({isPoint:!1,color:e.line,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1}):i.color==="light"?o=__dcg_shared_module_exports__['P'](e.line,.7):o=i.color;let n=i.path,a;switch(i.lineWidth){case"small":a=1;break;case"large":a=5;break;case"medium":default:a=3;break}r.lineCap="round",r.lineJoin="round",r.strokeStyle=o,r.lineWidth=a,r.beginPath(),r.moveTo(n[0],n[1]);for(let s=2;s<n.length;s+=2)r.lineTo(n[s],n[s+1]);if(i.arrow){let s=[],l=n.length-1;dhe(s,n[l-3],n[l-2],n[l-1],n[l],a/2+9.5);for(let c=0;c<s.length;c+=2)r.lineTo(s[c],s[c+1])}r.stroke()}break;case"filled-polygon":{let o;i.color?o=i.color:o=dT({isPoint:!1,color:e.polygon,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1,isTransparentObject:!0});let n=i.path;r.fillStyle=o,r.beginPath(),r.moveTo(n[0],n[1]);for(let a=2;a<n.length;a+=2)r.lineTo(n[a],n[a+1]);r.fill()}break;case"angle":{let o=RC({isPoint:!1,color:e.angle,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1,isTransparentObject:!0}),n=dT({isPoint:!1,color:e.angle,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1,isTransparentObject:!0});che(r,{type:"angle-indicator",lineWidth:4,strokeStyle:o,fillStyle:n,isRightAngle:!1,x:i.x,y:i.y,isDirected:i.isDirected,radius:i.radius,startAngle:i.startAngle,deltaAngle:i.deltaAngle})}break;default:return i}r.restore()}function che(r,e){r.beginPath(),AX(r,e),r.lineTo(e.x,e.y),r.lineTo(e.x+e.radius*Math.cos(e.startAngle),e.y+e.radius*Math.sin(e.startAngle)),e.isDirected||(r.fillStyle=e.fillStyle,r.fill()),r.strokeStyle=e.strokeStyle,r.lineWidth=e.lineWidth,r.beginPath(),AX(r,e),r.stroke()}function AX(r,e){let t=e.startAngle+e.deltaAngle;if(e.isRightAngle){let i=e.radius*Math.cos(e.startAngle),o=e.radius*Math.cos(t),n=e.radius*Math.sin(e.startAngle),a=e.radius*Math.sin(t);r.moveTo(e.x+i,e.y+n),r.lineTo(e.x+i+o,e.y+n+a),r.lineTo(e.x+o,e.y+a)}else r.arc(e.x,e.y,e.radius,e.startAngle,t)}function dhe(r,e,t,i,o,n=12){let a=Math.atan2(o-t,i-e),s=i-n*Math.cos(a-Math.PI/9),l=o-n*Math.sin(a-Math.PI/9),c=i-n*Math.cos(a+Math.PI/9),d=o-n*Math.sin(a+Math.PI/9),p=i-(n-2)*Math.cos(a-Math.PI/18),g=o-(n-2)*Math.sin(a-Math.PI/18),h=i-(n-2)*Math.cos(a+Math.PI/18),f=o-(n-2)*Math.sin(a+Math.PI/18);r.push(s,l,c,d,i,o,p,g,h,f,i,o)}var vb=class extends TA.Class{template(){return TA.createElement("canvas",{didMount:this.bindFn(this.didMountCanvas),width:()=>this.props.width(),height:()=>this.props.height(),style:()=>({width:this.props.width()/2+"px",height:this.props.height()/2+"px"})})}didMountCanvas(e){this.canvas=e,this.redraw()}didUpdate(){this.redraw()}redraw(){let e=this.props.instructions()||[],t=this.props.model().getNonObjectsState().ui.colors;if(__dcg_shared_module_exports__['E'](e,this.lastInstructions)&&__dcg_shared_module_exports__['E'](t,this.lastColors))return;this.lastInstructions=e,this.lastColors=t;let i=this.canvas.getContext("2d");i.clearRect(0,0,i.canvas.width,i.canvas.height),VX(i,t,e)}};var Ml=__dcg_shared_module_exports__['e'](te());var{For:phe}=Ml.Components;function p3(r,e){switch(e){case"selection":return r.s("graphing-calculator-label-geometry-tools-dropdown-menu-selection");case"point":return r.s("graphing-calculator-label-geometry-tools-dropdown-menu-point");case"line":return r.s("graphing-calculator-label-geometry-tools-dropdown-menu-line");case"circle":return r.s("graphing-calculator-label-geometry-tools-dropdown-menu-circle");case"angle":return r.s("graphing-calculator-label-geometry-tools-dropdown-menu-angle");case"polygon":return r.s("graphing-calculator-label-geometry-tools-dropdown-menu-polygon");case"transformation":return r.s("graphing-calculator-label-geometry-tools-dropdown-menu-transformation")}}var MA=class extends Ml.Class{init(){this.controller=this.props.controller(),this.geoModel=this.controller.getGeoModel()}getTools(){let e=this.controller.getOpenItemMenu();return!e||e.type!=="geo-tool-dropdown"||e.group!==this.props.group()?[]:e.tools}getAriaLabel(){let e=this.props.group();return p3(this.controller,e)}template(){return Ml.createElement("div",{class:()=>({"dcg-options-menu":!0,"dcg-select-tools-dropdown":!0,"dcg-shift-menu-left":this.getTools()[0]==="angle"}),role:Ml.const("menu"),"aria-label":this.bindFn(this.getAriaLabel),onKeyDown:this.bindFn(this.handleKeyPress),"dcg-geo-tool-group":this.bindFn(this.props.group)},Ml.createElement(phe,{each:()=>this.getTools()},Ml.createElement("div",{class:Ml.const("dcg-options-menu-section")},e=>Ml.createElement("button",{role:Ml.const("menuitemradio"),"aria-disabled":()=>!this.isToolEnabled(e),"aria-description":()=>this.isToolEnabled(e)?void 0:this.controller.s("graphing-calculator-narration-geometry-tool-disabled",{tool:e}),"aria-checked":()=>this.controller.getActiveTool()===e,onTap:t=>{this.isToolEnabled(e)&&this.chooseTool({tool:e,fromKeyboard:t.device==="keyboard"})},"dcg-geo-tool":this.const(e),class:()=>({"dcg-dropdown-tool":!0,"dcg-selected-tool":this.controller.getActiveTool()===e,"dcg-disabled":!this.isToolEnabled(e),"dcg-will-be-hidden-or-disabled":this.controller.toolWillBeHiddenOrDisabled(e)}),manageFocus:this.const(ft({controller:this.controller,location:{type:"geo-basic-tool-menu-item",tool:e}}))},Ml.createElement(vb,{model:()=>this.geoModel,width:this.const(100),height:this.const(100),instructions:()=>this.geoModel.getIconInstructionsForTool(e)}),Ml.createElement("span",null,()=>this.geoModel.getDisplayNameForTool(e))))))}isToolEnabled(e){return this.controller.isGeoToolEnabled(e)}chooseTool(e){this.props.controller().dispatch({type:"select-geo-tool",tool:e.tool,focusGraphPaper:!!e.fromKeyboard})}handleKeyPress(e){let t=this.props.guid();if(!t)return;let i=Be(e);if(i!=="Up"&&i!=="Down"&&i!=="Esc")return;let o=this.getTools(),n=this.controller.getFocusLocation();if(i==="Esc"){let c=this.props.group();(n==null?void 0:n.type)==="geo-basic-tool-menu-item"&&this.focusMenuIcon(),c&&this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"geo-tool-dropdown",guid:t,tools:o,group:c,focusFirstOption:!1}}),e.stopPropagation(),e.preventDefault();return}if((n==null?void 0:n.type)!=="geo-basic-tool-menu-item")return;let a=i==="Down"?1:-1,l=(o.indexOf(n.tool)+a)%o.length;l<0&&(l=o.length+l),l>=0&&(this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool-menu-item",tool:o[l]}}),e.preventDefault(),e.stopPropagation())}focusMenuIcon(){let e=this.props.group();if(!e)return;let t=this.controller.getGeoToolbarItemsForGroup(e),i=t==null?void 0:t.current;if(i)return this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:i}})}};var{If:LX,For:uhe,Switch:hhe}=Qr.Components,u3=class extends Qr.Class{getAriaLabel(){let e=this.props.controller(),t=p3(e,this.props.group());if(t)return e.s("graphing-calculator-label-geometry-tools-open-dropdown-menu-transformation",{item:t})}template(){return Qr.createElement("span",{style:Qr.const("position:relative;"),class:Qr.const("dcg-tool-dropdown"),role:Qr.const("button"),tabindex:Qr.const("-1"),"aria-label":this.bindFn(this.getAriaLabel),"aria-expanded":this.props.ariaExpanded,onTap:this.bindFn(this.handleOnTap)},Qr.createElement("span",{class:Qr.const("dcg-dropdown-icon")},Qr.createElement("i",{class:Qr.const("dcg-icon-caret-down")})))}handleOnTap(e){e.handle(),this.props.openDropDown()}},IA=class extends Qr.Class{init(){this.controller=this.props.controller(),this.geoModel=this.controller.getGeoModel()}getGroups(){return this.controller.getGeoToolbarGroupKeys()}template(){return Qr.createElement("div",{role:Qr.const("toolbar"),"aria-label":()=>this.controller.s("graphing-calculator-label-geometry-tools"),class:Qr.const("dcg-geo-basic-tools dcg-animate-in-after-initial-load"),onKeydown:e=>this.handleToolbarKeydown(e)},Qr.createElement(uhe,{each:()=>this.getGroups()},Qr.createElement("div",{class:Qr.const("dcg-geo-basic-tools-row")},e=>Qr.createElement("div",{class:Qr.const("dcg-tool-button-container")},Qr.createElement("button",{class:()=>({"dcg-split-btn":!!this.getGroup(e).dropdown,"dcg-selected":this.isGroupSelected(this.getGroup(e)),"dcg-disabled":!this.isGroupEnabled(this.getGroup(e)),"dcg-will-be-hidden-or-disabled":this.controller.toolWillBeHiddenOrDisabled(this.getGroup(e).current)}),"dcg-geo-tool":()=>this.getGroup(e).current,"dcg-geo-tool-group":()=>e,tabindex:()=>this.isGroupSelected(this.getGroup(e))?0:-1,"aria-label":()=>this.geoModel.getDisplayNameForTool(this.getGroup(e).current),"aria-disabled":()=>!this.isGroupEnabled(this.getGroup(e)),"aria-haspopup":()=>!!this.getGroup(e).dropdown,"aria-pressed":()=>this.isGroupSelected(this.getGroup(e)),onTap:t=>this.handleTap(t,this.getGroup(e)),onLongHold:()=>this.openMenuFromLongHold(this.getGroup(e)),"dcg-open-menu-guid":()=>this.getGuid(this.getGroup(e)),manageFocus:()=>ft({controller:this.controller,location:{type:"geo-basic-tool",tool:this.getGroup(e).current}}),"aria-controls":()=>this.getGuid(this.getGroup(e)),"aria-expanded":()=>this.getGroup(e).dropdown?this.isGroupDropdownOpen(this.getGroup(e)):void 0},Qr.createElement("span",{class:()=>({"dcg-basic-tool-btn":!0,"dcg-icon":!0})},Qr.createElement(vb,{model:()=>this.geoModel,width:this.const(100),height:this.const(100),instructions:()=>this.geoModel.getIconInstructionsForTool(this.getGroup(e).current)})),Qr.createElement(LX,{predicate:()=>!!this.getGroup(e).dropdown},()=>Qr.createElement(u3,{group:()=>e,controller:this.props.controller,ariaExpanded:()=>this.isGroupDropdownOpen(this.getGroup(e)),openDropDown:()=>this.openDropdownMenu(this.getGroup(e))}))),Qr.createElement(LX,{predicate:()=>this.isGroupDropdownOpen(this.getGroup(e))},()=>Qr.createElement(td,{controller:this.props.controller,shouldHandleTabAndEscape:this.const(!1),menuType:this.const("geo-tool-dropdown"),menuButtonFocusLocation:this.const({type:"geo-basic-tool",tool:this.getGroup(e).current}),rootElSelector:this.const(".dcg-geometry-toolbar-view")},Qr.createElement(MA,{controller:this.props.controller,group:()=>e,guid:()=>this.getGuid(this.getGroup(e))})))))),Qr.createElement(hhe,{key:()=>this.controller.getGeometryGettingStartedMessageState()},e=>{switch(e){case"hidden":return Qr.createElement("span",null);case"construct":case"pick-a-tool":return Qr.createElement("div",{class:()=>({"dcg-3d-getting-started-pointer":!0,"dcg-3d-getting-started-has-tool":this.controller.getGeometryGettingStartedMessageState()!=="pick-a-tool"})},this.bindFn(this.getPointerMessage),Qr.createElement("span",{class:Qr.const("dcg-curved-icon-container")},Qr.createElement("i",{class:Qr.const("dcg-icon-curved-arrow")})))}}))}isGroupSelected(e){return this.selectedTool()===e.current}isGroupEnabled(e){return this.controller.isGeoToolEnabled(e.current)}getGroup(e){let t=this.controller.getGeoToolbarItemsForGroup(e);if(!t)throw new Error("Programing error: "+e+" not found");return t}getPointerMessage(){return this.controller.getGeometryGettingStartedMessageState()==="pick-a-tool"?this.controller.s("geometry-label-pick-tool-instruction"):this.controller.s("geometry-label-construct-instruction")}getFocusedOrActiveTool(){let e=this.controller.getAllVisibleGeoToolbarItems(),t=this.controller.getFocusLocation();if(!t)return;let i;return t.type==="geo-basic-tool"||t.type==="geo-basic-tool-menu-item"?i=t.tool:i=this.controller.getActiveTool(),e.find(o=>{var n,a;return o.current===i||o.dropdown&&((a=(n=o.dropdown)==null?void 0:n.indexOf)==null?void 0:a.call(n,i))>-1})}handleToolbarKeydown(e){var l,c,d,p,g;let t=Be(e);if(t!=="Up"&&t!=="Down"&&t!=="Left"&&t!=="Right"&&t!=="Home"&&t!=="End"||(e.preventDefault(),e.stopPropagation(),!this.controller.getFocusLocation()))return;let o=this.controller.getAllVisibleGeoToolbarItems(),n=this.getFocusedOrActiveTool();if(!n)return;let a=o.findIndex(h=>h.group===n.group),s;if(t==="Home")s=(l=o[0])==null?void 0:l.current;else if(t==="End")s=(c=o[o.length-1])==null?void 0:c.current;else if(t==="Left"||t==="Right"){let h=t==="Left"?-1:1,f=Math.max(0,Math.min(o.length-1,a+h));s=(d=o[f])==null?void 0:d.current;let y=((p=o[f].dropdown)!=null?p:[]).length>1;if(((g=this.controller.getOpenItemMenu())==null?void 0:g.type)==="geo-tool-dropdown"){if(y)return this.openDropdownMenu(o[f],!0);if(s)this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"geo-tool-dropdown",guid:this.getGuid(n),tools:[],group:n.group}});else return}}else(t==="Up"||t==="Down")&&this.openDropdownMenu(n);s&&this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:s}})}selectedTool(){let e=this.controller.getActiveTool();return e==="expression-edit"?"selection":e}openDropdownMenu(e,t){e.dropdown&&(this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"geo-tool-dropdown",guid:this.getGuid(e),tools:e.dropdown,group:e.group,focusFirstOption:t}}),this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool-menu-item",tool:e.current}}))}getGuid(e){return e.dropdown?"geo-dropdown-"+e.dropdown[0]:""}openMenuFromLongHold(e){this.controller.dispatch({type:"select-geo-tool",tool:e.current}),this.openDropdownMenu(e)}handleTap(e,t){e.wasLongheld()||e.wasHandled()||(this.controller.dispatch({type:"select-geo-tool",tool:t.current,focusGraphPaper:e.device==="keyboard"}),e.shiftKey?this.openDropdownMenu(t):e.device!=="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:t.current}}))}isGroupDropdownOpen(e){let t=this.controller.getOpenItemMenu();return(t==null?void 0:t.type)==="geo-tool-dropdown"&&t.group===e.group}};var ro=__dcg_shared_module_exports__['e'](te());var{Each:ghe,SwitchUnion:mhe,If:fhe}=ro.Components,AA=class extends ro.Class{init(){this.controller=this.props.controller()}template(){return ro.createElement("div",{role:ro.const("toolbar"),"aria-label":()=>this.controller.s("graphing-calculator-label-geometry-tools"),class:ro.const("dcg-geo-basic-tools dcg-animate-in-after-initial-load dcg-complex-tool-instruction-view")},ro.createElement(Mx,{ariaLabel:()=>this.controller.s("account-shell-button-mygraphs-cancel"),controller:this.props.controller,message:()=>this.getTransformationName(this.controller.getActiveTool()),onBack:this.bindFn(this.onCancel)}),ghe(()=>this.getInputIndexes(),{item:e=>ro.createElement(h3,{activeStep:this.bindFn(this.getInputIndex),controller:this.props.controller,toolSpec:()=>this.getToolSpec(),stepIdx:()=>e})}))}onCancel(){this.controller.dispatch({type:"select-geo-tool",tool:"selection"}),this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:"selection"}})}getTransformationName(e){switch(e){case"dilate":return this.controller.s("graphing-calculator-text-geometry-tool-dilate-display-name");case"reflect":return this.controller.s("graphing-calculator-text-geometry-tool-reflect-display-name");case"rotate":return this.controller.s("graphing-calculator-text-geometry-tool-rotate-display-name");case"translate":return this.controller.s("graphing-calculator-text-geometry-tool-translate-display-name");case"parallel":return this.controller.s("graphing-calculator-text-geometry-tool-parallel-display-name");case"perpendicular":return this.controller.s("graphing-calculator-text-geometry-tool-perpendicular-display-name");case"compass":return this.controller.s("graphing-calculator-text-geometry-tool-compass-display-name");default:return this.controller.s("shared-calculator-narration-item-unknown")}}getInputIndex(){return this.controller.getGeoModel().getNonObjectsState().ui.currentTool.inputIndex}getInputIndexes(){return this.getToolSpec().inputs.map((e,t)=>t)}getToolSpec(){return this.controller.getGeoModel().getCurrentTool().getSpec()}},h3=class extends ro.Class{init(){this.controller=this.props.controller()}template(){return mhe(()=>this.getInputType(),{completed:()=>ro.createElement("span",{class:ro.const("dcg-step-completed")},ro.createElement("i",{class:ro.const("dcg-icon-check"),"aria-hidden":ro.const("true")})),upcoming:()=>ro.createElement("span",{class:ro.const("dcg-step-upcoming")},ro.createElement("span",null)),active:()=>ro.createElement("span",{class:ro.const("dcg-active-step")},ro.createElement("span",{class:ro.const("dcg-step-active-icon")},ro.createElement("span",null,()=>this.props.stepIdx()+1)),this.bindFn(this.getActiveString),ro.createElement(fhe,{predicate:this.bindFn(this.isNumberInputStep)},()=>ro.createElement("span",{class:ro.const("dcg-input-flex-container"),didMount:this.bindFn(this.didMountNumberInput)},ro.createElement(_r,{containerClass:()=>({"dcg-suffix-degree":this.getNumberUnits()==="\xB0","dcg-suffix-radian":this.getNumberUnits()==="rad"}),readonly:()=>!1,latex:()=>this.getNumberInputLatex(),ariaLabel:this.bindFn(this.getActiveString),isFocused:()=>this.isNumberInputFocused(),handleFocusChanged:(e,t)=>this.handleFocusedChanged(e,t),hasError:this.bindFn(this.doesNumberInputHaveError),controller:this.props.controller,handlePressedKey:(e,t)=>{this.handlePressedKey(e,t)},handleLatexChanged:e=>{this.handleLatexChanged(e)},handleSelectionChanged:e=>{this.handleLatexChanged(e.latex,!0)},dataLabelAttributeValue:this.const("transformation-number")}),ro.createElement("span",{class:()=>({"dcg-action-submit":!0,"dcg-disabled":this.isSubmitNumberDisabled(),"dcg-btn-blue":!0}),role:ro.const("button"),tabindex:()=>this.isSubmitNumberDisabled()?-1:0,"aria-disabled":this.bindFn(this.isSubmitNumberDisabled),onTap:e=>this.submitNumberInput({device:e.device})},()=>this.controller.s("shared-calculator-button-go")))))})}getNumberUnits(){return this.controller.getActiveTool()==="rotate"?this.controller.isDegreeMode()?"\xB0":"rad":""}didMountNumberInput(){this.controller.dispatch({type:"set-focus-location",location:{type:"new-transformation-number"}})}isNumberInputFocused(){let e=this.controller.getFocusLocation();return!!(e&&e.type==="new-transformation-number")}doesNumberInputHaveError(){var l;if(!this.getNumberInputLatex()||this.getNumberInputLatex()===((l=this.getStep().numberInputInfo)==null?void 0:l.defaultLatex))return!1;let t=this.props.toolSpec().outputs[0].id,{idMap:i}=this.controller.getGeoModel().getNonObjectsState().ui.currentTool,o=i[t];if(!o)return!0;let n=ix(this.controller.getListModel()).filter(c=>{var d;if(c.type==="expression")return o===((d=mn(c))==null?void 0:d.latex)}),a=n[0];if(!a||n.length===0||n.length>1||a.error)return!0;let s=a.formula.typed_constant_value;if(!s)return!0;if(__dcg_shared_module_exports__['ib'](s.valueType,__dcg_shared_module_exports__['Ta'])){let c=__dcg_shared_module_exports__['db'](s.valueType)?s.value:[s.value];for(let d of c){let[[p,g],[h,f]]=d;if(isNaN(p)||isNaN(g)||isNaN(h)||isNaN(f))return!0}return!1}return!0}handlePressedKey(e,t){let i=Ze.getFocusedMathquill();if(e==="Enter"){this.submitNumberInput({device:"keyboard"});return}i&&(i.keystroke(e,t),this.handleLatexChanged(i.latex()))}getNumberInputLatex(){return this.controller.getGeoModel().getCurrentTool().getNumberInputLatex()}isSubmitNumberDisabled(){return!!(this.doesNumberInputHaveError()||!this.getNumberInputLatex())}submitNumberInput(e){var s,l;if(this.isSubmitNumberDisabled())return;let t=this.controller.getGeoModel(),i=this.controller.getActiveTool(),o=t.getCurrentTool(),n=(s=o.getSpec)==null?void 0:s.call(o),a=o.tryCommitResults();a.committed&&(this.controller.dispatch({type:"commit-geo-objects",...a}),(l=this.controller.get2dPOIController())==null||l.speakGeoReleaseAction(i,n,a.committed),e.device==="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"graph-paper"}}))}handleLatexChanged(e,t){(this.getNumberInputLatex()!==e||t)&&(this.controller.getGeoModel().getCurrentTool().onNumberInput(e),this.controller.getGeoModel().onPreviewChange())}handleFocusedChanged(e,t){e&&!this.isNumberInputFocused()?this.controller.dispatch({type:"set-focus-location",location:{type:"new-transformation-number"}}):this.isNumberInputFocused()&&this.controller.dispatch({type:"blur-focus-location",location:{type:"new-transformation-number"}})}getActiveString(){let e=this.props.controller(),t=this.getStep().hint;return t?e.s(t):e.s("shared-calculator-narration-item-unknown")}isNumberInputStep(){return!!this.getStep().numberInputInfo}getStep(){return this.props.toolSpec().inputs[this.props.stepIdx()]}getInputType(){let e=this.props.activeStep(),t=this.props.stepIdx();return t<e?"completed":t>e?"upcoming":"active"}};var{SwitchUnion:bhe,If:PX}=Pi.Components,VA=class extends Pi.Class{constructor(){super(...arguments),this.afterInitialLoad=!1}init(){this.controller=this.props.controller()}template(){return Pi.createElement("div",{class:()=>({"dcg-geometry-toolbar-view":!0,"dcg-after-initial-load":this.afterInitialLoad}),style:()=>({left:`${this.controller.computeMajorLayout().grapher.left}px`}),onTapStart:this.bindFn(this.onTapStart)},Pi.createElement("div",{class:Pi.const("dcg-header-left dcg-do-blur")},Pi.createElement(PX,{predicate:this.bindFn(this.showHamburger)},()=>Pi.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-open-graph"),gravity:this.const("s")},Pi.createElement("div",{role:Pi.const("button"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-open-graph"),tabindex:Pi.const("0"),class:Pi.const("dcg-action-opendrawer dcg-icon-btn dcg-in-api-action-opendrawer"),onTap:()=>this.controller.dispatch({type:"open-drawer"})},Pi.createElement("i",{class:Pi.const("dcg-icon-hamburger"),"aria-hidden":Pi.const("true")})))),Pi.createElement(PX,{predicate:this.bindFn(this.showOpenExpressionsButton)},()=>Pi.createElement("div",{class:Pi.const("dcg-show-expressions-tab dcg-icon-btn"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-show-list"),role:Pi.const("button"),tabindex:Pi.const("0"),onTap:e=>{this.controller.dispatch({type:"show-expressions-list",focusHideIcon:e.device==="keyboard"})},manageFocus:this.const(ft({controller:this.controller,location:{type:"show-expression-list-btn"}}))},Pi.createElement("i",{class:Pi.const("dcg-icon-show"),"aria-hidden":Pi.const("true")})))),Pi.createElement("div",{class:Pi.const("dcg-flex-spacer")}),bhe(this.bindFn(this.getViewToShow),{tools:()=>Pi.createElement(IA,{controller:this.props.controller}),selectedItems:()=>Pi.createElement(i1,{controller:this.props.controller}),complexToolInstructions:()=>Pi.createElement(AA,{controller:this.props.controller})}),Pi.createElement("div",{class:Pi.const("dcg-flex-spacer")}))}showHamburger(){return this.controller.getGraphSettings().config.showHamburger?!this.controller.isListEnabled()||!this.controller.isListVisible()||this.controller.isNarrow():!1}showOpenExpressionsButton(){return this.controller.isListEnabled()&&!this.controller.isListVisible()&&!this.controller.isNarrow()}willUpdate(){this.afterInitialLoad||this.getViewToShow()==="selectedItems"&&(this.afterInitialLoad=!0)}onTapStart(e){e.target.classList.contains("dcg-do-blur")&&this.controller.dispatch({type:"set-none-selected"})}getViewToShow(){let e=this.controller.getActiveTool();return __dcg_shared_module_exports__['oc'](e)||NY(e)?"complexToolInstructions":this.controller.shouldShowMultiSelectHeader()?"selectedItems":"tools"}};var Or=__dcg_shared_module_exports__['e'](te()),{If:KS}=Or.Components,g3=class extends Or.Class{init(){this.controller=this.props.controller()}template(){return Or.createElement("span",{class:Or.const("dcg-toast")},Or.createElement("i",{class:Or.const("dcg-icon-error"),"aria-hidden":Or.const("true")}),Or.createElement(KS,{predicate:()=>!this.showUndo()},()=>Or.createElement("i",{class:Or.const("dcg-icon-remove"),onTap:()=>this.controller.dispatch({type:"toast/close"}),role:Or.const("link"),tabindex:Or.const(0),"aria-label":Or.const("Dismiss Notice")})),Or.createElement("span",{class:Or.const("dcg-msg"),"aria-atomic":()=>this.shouldLiveUpdateAria(),"aria-live":()=>this.shouldLiveUpdateAria()?"assertive":""},()=>this.controller.toastData.message),Or.createElement(KS,{predicate:this.bindFn(this.showUndo)},()=>Or.createElement("a",{role:Or.const("link"),tabindex:Or.const(0),class:Or.const("dcg-undo"),onTap:()=>this.controller.dispatch({type:"toast/undo"})},()=>this.controller.s("shared-calculator-label-toast-undo"))),Or.createElement(KS,{predicate:this.bindFn(this.showLearnMore)},()=>Or.createElement("a",{role:Or.const("link"),tabindex:Or.const(0),target:Or.const("_blank"),onTap:()=>this.controller.dispatch({type:"toast/learn-more"})},()=>this.controller.s("shared-calculator-label-toast-learn-more"))),Or.createElement(KS,{predicate:()=>!!this.controller.toastData.link},()=>Or.createElement("a",{role:Or.const("link"),tabindex:Or.const(0),target:Or.const("_blank"),href:()=>{var e;return((e=this.controller.toastData.link)==null?void 0:e.url)||""}},()=>{var e;return((e=this.controller.toastData.link)==null?void 0:e.text)||""})))}showUndo(){return!!this.controller.toastData.undoCallback}showLearnMore(){return!!this.controller.toastData.learnMoreCallback}shouldUpdate(){return!!this.controller.toastData.message}shouldLiveUpdateAria(){return!this.controller.toastData.noAria}},LA=class extends Or.Class{template(){return Or.createElement("div",{class:()=>({"dcg-toast-view":!0,"dcg-visible":!!this.props.controller().toastData.message,"dcg-below-geo-toolbar":this.isGeometryInCalculator()}),"toast-style":()=>this.props.controller().toastData.toastStyle},Or.createElement(KS,{predicate:()=>!!this.props.controller().toastData.message},()=>Or.createElement("div",{class:Or.const("dcg-toast-wrapper")},Or.createElement("div",{class:Or.const("dcg-toast-cover")}),Or.createElement(g3,{...this.props}))))}isGeometryInCalculator(){var t;let e=this.props.controller();return(t=e.isGeometry)==null?void 0:t.call(e)}};qt();function qS(r){ie(r).on("drag dragend dragenter dragover dragleave drop",t=>{t.preventDefault(),t.stopPropagation()})}var Zr=__dcg_shared_module_exports__['e'](te());qt();var ea=__dcg_shared_module_exports__['e'](te());var Kr=__dcg_shared_module_exports__['e'](te());var _i=__dcg_shared_module_exports__['e'](te());qt();var m3=class{constructor(){this.handlers=[],ie(document).on("keydown.delegator",e=>this.handleEvent(e))}push(e){let t=__dcg_shared_module_exports__['K']("delegator_");return this.handlers.push({token:t,handler:e}),()=>this.handlers=__dcg_shared_module_exports__['i'](this.handlers,i=>i.token!=t)}handleEvent(e){if(!e.isDefaultPrevented()&&this.handlers.length){let t=!1,i=()=>t=!0;for(let{handler:o}of this.handlers.slice().reverse())if(o(e,i),t)return}}},PA=new m3;var{If:_X}=_i.Components,Qo=class extends _i.Class{init(){this.i18n=this.props.i18n(),this.isMounted=!1}template(){return _i.createElement("div",{class:()=>({"dcg-shared-modal-container":!0,[this.props.class?this.props.class():""]:!!this.props.class}),didMount:this.bindFn(this.didMount),didUnmount:this.bindFn(this.didUnmount)},_i.createElement("div",{class:()=>({"dcg-shared-modal-cover":!0,"dcg-shared-has-close-button":this.showX(),"dcg-shared-modal-fullscreen":this.props.size()==="fullscreen","dcg-shared-modal-wide":this.props.size()==="wide","dcg-shared-modal-medium":this.props.size()==="medium","dcg-shared-modal-narrow":this.props.size()==="narrow"})},_i.createElement("div",{class:_i.const("dcg-shared-modal-background"),onTap:this.props.onClose}),_i.createElement("div",{class:_i.const("dcg-shared-modal-transition-container")},_i.createElement("div",{class:_i.const("dcg-shared-modal"),role:_i.const("dialog"),"aria-modal":_i.const("true"),"aria-label":()=>{let e="";return this.props.ariaLabel?e=this.props.ariaLabel():this.props.title&&(e=this.props.title()),e}},_i.createElement(_X,{predicate:()=>this.showX()},()=>_i.createElement("div",{class:_i.const("dcg-shared-close-cross-container")},_i.createElement($e,{tooltip:()=>this.i18n.s("shared-button-close-dialog")},_i.createElement("div",{role:_i.const("button"),tabindex:_i.const("0"),"aria-label":()=>this.i18n.s("shared-button-close-dialog"),class:_i.const("dcg-shared-close-cross"),onTap:this.props.onClose},_i.createElement("i",{class:_i.const("dcg-icon-remove"),"aria-hidden":_i.const("true")}))))),_i.createElement("div",{class:_i.const("dcg-shared-modal-contents-wrapper")},_i.createElement(_X,{predicate:()=>!!this.props.title&&!!this.props.title()},()=>_i.createElement("h1",{class:()=>({"dcg-shared-modal-title":!0,"dcg-shared-left-align-title":this.leftAlignTitle()})},()=>this.props.title())),_i.createElement("div",{class:_i.const("dcg-shared-modal-scrollable-content")},this.children))))))}showX(){return!!this.props.showX&&this.props.showX()}leftAlignTitle(){return!!this.props.leftAlignTitle&&this.props.leftAlignTitle()}didMount(){var s,l;if(this.isMounted)return;this.isMounted=!0;let e=this.findRootNode();function t(){let c=e.querySelector(".dcg-shared-close-cross");c&&c.focus()}function i(){let c=e.querySelector(".dcg-shared-modal-scrollable-content");c&&(c.tabIndex>=0||(c.tabIndex=0),c.focus())}let o=e.querySelector(".dcg-shared-modal-scrollable-content"),n=(l=(s=this.props).setFocus)==null?void 0:l.call(s);n==="close"?this.showX()?t():o&&i():n==="content"&&i();let a=f6(e);this.unsub=PA.push((c,d)=>{Be(c)==rn&&(this.onClose(),d());let p=c.altKey||c.shiftKey||c.metaKey||c.ctrlKey;this.props.onArrowKey&&Be(c)===kp&&!p&&this.props.onArrowKey("Left"),this.props.onArrowKey&&Be(c)===Gp&&!p&&this.props.onArrowKey("Right"),a(c)})}onClose(){this.props.onClose&&this.props.onClose()}didUnmount(){this.isMounted&&(this.isMounted=!1,this.unsub())}};var{If:_A,Each:OX}=Kr.Components,OA=class extends Kr.Class{init(){this.controller=this.props.controller()}template(){return Kr.createElement(_A,{predicate:this.props.visible},()=>Kr.createElement(Qo,{size:this.const("medium"),onClose:this.props.onClose,i18n:this.const(this.controller),class:this.const("dcg-custom-toolbar-settings-modal")},Kr.createElement("div",{class:Kr.const("dcg-btn-blue dcg-done-btn"),"aria-role":Kr.const("button"),tabindex:Kr.const(0),didMount:e=>e.focus(),onTap:this.props.onClose},()=>this.controller.s("graphing-calculator-button-done")),Kr.createElement("h1",{class:Kr.const("dcg-shared-left-align-title")},()=>this.controller.s("shared-calculator-text-customize-toolbar")),OX(this.bindFn(this.getToolGroups),{key:e=>e.group,item:e=>Kr.createElement("div",null,Kr.createElement("div",{class:Kr.const("dcg-configuration-heading-row dcg-configuration-grid-row")},Kr.createElement("div",{class:Kr.const("dcg-first-column")},()=>e.group,Kr.const(" Tools")),Kr.createElement("div",{class:Kr.const("dcg-second-column")},Kr.const("Disabled when:"))),OX(()=>e.dropdown||[e.current],{item:t=>Kr.createElement("div",{class:Kr.const("dcg-configuration-grid-row"),"dcg-geo-tool":this.const(t)},Kr.createElement("div",{class:Kr.const("dcg-first-column")},Kr.createElement(xt,{disabled:()=>!this.isToolCustomizable(t),checked:()=>this.getToolInfo(t).visible,onChange:i=>{this.controller.dispatch({type:"set-geometry-custom-toolbar-setting",tool:t,value:{...this.getToolInfo(t),visible:i}})}},()=>t)),Kr.createElement("div",{class:()=>({"dcg-disabled":!this.getToolInfo(t).visible||!this.isToolCustomizable(t),"dcg-mathquill-condition-container":!0,"dcg-second-column":!0})},Kr.createElement(_A,{predicate:()=>!!this.getToolLatexError(t)&&this.getToolInfo(t).visible},()=>Kr.createElement("div",{class:Kr.const("dcg-latex-error-container")},Kr.createElement($a,{error:()=>this.getToolLatexError(t)||"",gravity:this.const("s")}))),Kr.createElement(_A,{predicate:()=>this.isToolCustomizable(t)&&this.getToolInfo(t).visible},()=>Kr.createElement(_o,{latex:()=>this.getToolLatex(t),operatorNames:this.bindFn(this.autoOperatorNames),ariaLabel:()=>this.getToolAria(t),brailleShouldFocus:()=>this.focusedLatexTool===t,onBrailleInput:i=>{this.controller.dispatch({type:"set-geometry-custom-toolbar-setting",tool:t,value:{...this.getToolInfo(t),disabledLatex:i}})},onBrailleFocusedChanged:i=>{this.focusedLatexTool===t&&!i?this.focusedLatexTool=void 0:i&&(this.focusedLatexTool=t)},onBrailleKeydown:()=>{},...Bn(this.controller)},Kr.createElement(Ze,{latex:()=>this.getToolLatex(t),getAriaLabel:()=>this.getToolAria(t),noFadeout:this.const(!0),getAriaPostLabel:()=>this.getToolLatexError(t)||"",isFocused:()=>this.focusedLatexTool===t,tokenController:this.props.controller,capExpressionSize:()=>this.controller.getCapExpressionSize(),config:()=>this.controller.getMathquillConfig({}),hasError:()=>!!this.getToolLatexError(t),onUserChangedLatex:i=>{this.controller.dispatch({type:"set-geometry-custom-toolbar-setting",tool:t,value:{...this.getToolInfo(t),disabledLatex:i}})},onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:i=>{this.focusedLatexTool===t&&!i?this.focusedLatexTool=void 0:i&&(this.focusedLatexTool=t)},onSelectionChanged:()=>{this.controller.runAfterDispatch(()=>{this.controller.dispatch({type:"render"})})},needsSystemKeypad:()=>!this.controller.isKeypadEnabled()}))),Kr.createElement(_A,{predicate:()=>!this.getToolInfo(t).visible},()=>Kr.createElement("div",{class:Kr.const("dcg-disabled-condition-wrapper")},Kr.createElement(_o,{latex:()=>this.getToolLatex(t),operatorNames:this.bindFn(this.autoOperatorNames),ariaLabel:()=>this.getToolAria(t),isStatic:this.const(!0),brailleShouldFocus:this.const(!1),onBrailleFocusedChanged:()=>{},...Bn(this.controller)},Kr.createElement(lt,{latex:()=>this.getToolLatex(t),config:()=>this.controller.getMathquillConfig({}),getAriaLabel:()=>this.getToolAria(t)}))))))}))})))}getToolAria(e){return this.controller.s("shared-calculator-narration-disable-tool",{tool:e})}autoOperatorNames(){return this.props.controller().getMathquillConfig({}).autoOperatorNames}getToolLatex(e){return this.getToolInfo(e).disabledLatex||""}isToolCustomizable(e){return e!=="selection"&&e!=="box-selection"}getToolGroups(){let e={group:"transformation",current:"translate",dropdown:Px};return[...aO(),e]}getToolLatexError(e){let t=this.controller.getGeometryToolbarModel(),i=CK(t,e);if(i)return this.controller.unpack(i)}getToolInfo(e){let t=this.controller.getGeometryToolbarModel();return{tool:e,...t.toolbarState[e]}}};var{If:RX}=ea.Components,RA=class extends ea.Class{init(){this.controller=this.props.controller()}template(){return ea.createElement(RX,{predicate:()=>this.shouldShowAuthorFeaturesSection()},()=>ea.createElement("div",{class:ea.const("dcg-options-menu-section dcg-author-mode-section")},ea.createElement("div",{class:ea.const("dcg-options-menu-section-title")},()=>this.controller.s("shared-calculator-narration-author-mode"),ea.createElement(yo,{ariaLabel:()=>this.controller.s("shared-calculator-narration-author-mode"),toggled:this.bindFn(this.isAuthorMode),onChange:()=>{this.controller.dispatch({type:"set-author-mode",enabled:!this.isAuthorMode()})}})),ea.createElement(RX,{predicate:()=>this.isAuthorMode()},()=>ea.createElement("div",{class:ea.const("dcg-author-features-container")},ea.createElement("div",{class:ea.const("dcg-toolbar-customization")},ea.createElement("span",null,ea.const("Geometry Tools:")),ea.createElement(Xi,{theme:this.const("mini"),ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-configure-toolbar"),staticConfig:this.bindFn(this.getConfigurationOptions)})),ea.createElement(xt,{checked:()=>this.controller.getGraphSettings().hideCustomColors,onChange:e=>this.controller.dispatch({type:"set-graph-settings",hideCustomColors:e})},()=>this.controller.s("shared-calculator-label-hide-custom-colors")),ea.createElement(OA,{controller:this.props.controller,onClose:()=>{this.customGeometryToolsSettingsModal=!1,this.controller.dispatch({type:"render"})},visible:()=>this.customGeometryToolsSettingsModal})))))}getToolbar(){return this.controller.getGeometryToolbarModel().toolbar}setToolbar(e){e==="custom"&&(this.customGeometryToolsSettingsModal=!0),this.controller.dispatch({type:"set-geometry-toolbar",toolbar:e})}getConfigurationOptions(){return[{key:"all",label:()=>this.controller.raw("All"),selected:()=>this.getToolbar()==="all",onSelect:()=>this.setToolbar("all")},{key:"none",label:()=>this.controller.raw("None"),selected:()=>this.getToolbar()==="none",onSelect:()=>this.setToolbar("none")},{key:"custom",label:()=>this.controller.raw("Custom"),selected:()=>this.getToolbar()==="custom",onSelect:()=>this.setToolbar("custom")}]}shouldShowAuthorFeaturesSection(){return this.controller.authorFeaturesAvailable()}isAuthorMode(){return this.controller.shouldShowAuthorFeatures()}};var{If:FA}=Zr.Components,HS=class extends Zr.Class{init(){this.controller=this.props.controller()}template(){return Zr.createElement("div",{class:()=>({"dcg-geometry-settings-container":!0,"dcg-popover":!0,"dcg-left":!0,"dcg-constrained-height-popover":!0,"dcg-generic-options-menu":!0,"dcg-no-geometry-header":!this.controller.shouldShowGeoToolbar()}),style:this.bindFn(this.getContainerStyle),didMount:this.bindFn(this.didMountContainer),didUnmount:this.bindFn(this.didUnmountContainer)},Zr.createElement("div",{class:Zr.const("dcg-popover-interior"),role:Zr.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-geometry-settings")},Zr.createElement("div",{class:Zr.const("dcg-options-menu-section")},Zr.createElement(qw,{controller:this.props.controller}),Zr.createElement(FA,{predicate:()=>!this.controller.getLockViewportConfigSetting()},()=>Zr.createElement(xb,{controller:this.props.controller})),Zr.createElement(FA,{predicate:()=>this.controller.getHiddenGeoItemCount()>0},()=>Zr.createElement(xt,{onChange:this.bindFn(this.toggleGhostMode),checked:()=>this.controller.getGhostMode(),manageFocus:this.const(ft({controller:this.controller,location:{type:"settings",location:"hidden-objects"}}))},()=>this.controller.s("graphing-calculator-label-settings-hidden-objects",{count:this.controller.getHiddenGeoItemCount()})))),Zr.createElement("div",{class:Zr.const("dcg-options-menu-section")},Zr.createElement("div",{class:Zr.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-label-settings-grid"),Zr.createElement(yo,{ariaLabel:()=>this.controller.s("graphing-calculator-label-settings-grid"),toggled:this.bindFn(this.getShowGrid),onChange:this.bindFn(this.toggleGrid)})),Zr.createElement(FA,{predicate:this.bindFn(this.getShowGrid)},()=>Zr.createElement(xt,{onChange:this.bindFn(this.toggleMinorGridlines),checked:this.bindFn(this.getMinorGridlines)},()=>this.controller.s("graphing-calculator-label-settings-minor-gridlines")))),Zr.createElement("div",{class:Zr.const("dcg-options-menu-section")},Zr.createElement("div",{class:Zr.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-label-axes"),Zr.createElement(yo,{ariaLabel:()=>this.controller.s("graphing-calculator-label-axes"),toggled:this.bindFn(this.getShowAxes),onChange:this.bindFn(this.toggleAxes)})),Zr.createElement(FA,{predicate:this.bindFn(this.getShowAxes)},()=>Zr.createElement("div",null,Zr.createElement(xt,{onChange:this.bindFn(this.toggleAxisNumbers),checked:this.bindFn(this.getAxisNumbers)},()=>this.controller.s("graphing-calculator-label-settings-axis-numbers")),Zr.createElement("div",null,Zr.createElement(xt,{onChange:this.bindFn(this.toggleArrows),checked:()=>this.getAxisArrowMode()!=="NONE"},()=>this.controller.s("graphing-calculator-label-settings-arrows")))))),Zr.createElement(Hw,{controller:this.props.controller}),Zr.createElement(RA,{controller:this.props.controller}),Zr.createElement(Cm,{controller:this.props.controller}),Zr.createElement("div",{class:Zr.const("dcg-arrow")})))}toggleGhostMode(){this.controller.dispatch({type:"set-ghost-mode",value:!this.controller.getGhostMode()})}didMountContainer(e){this.node=e,ie(document.documentElement).on("dcg-tapstart.geometry-settings-view wheel.geometry-settings-view",t=>{this.eventShouldClosePopover(t)&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:t.device==="keyboard"})}),this.unsub=PA.push(t=>{let i=Be(t);if(i==="Esc"&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:!0}),this.controller.isGraphSettingsOpen()&&i==="Tab"&&!t.altKey&&!t.metaKey&&!t.ctrlKey){let o=this.controller.getFocusLocation();if(!o||o.type!=="settings")return;t.shiftKey?t.shiftKey&&(o.location==="default-size"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation()):o.location==="icon"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"degree-mode"}}),t.preventDefault(),t.stopPropagation())):o.location==="icon"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"default-size"}}),t.preventDefault(),t.stopPropagation()):o.location==="degree-mode"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation())}})}didUnmountContainer(){ie(document.documentElement).off(".geometry-settings-view"),this.unsub()}didUpdate(){if(!this.controller.isGraphSettingsOpen())return;let e=this.controller.getKeypadHeight();e!==this.cachedKeypadHeight&&document.activeElement&&this.node.contains(document.activeElement)&&yc(document.activeElement,this.node.querySelector(".dcg-popover-interior"),50),this.cachedKeypadHeight=e}eventShouldClosePopover(e){let t=e.target,i=this.node.contains(t),o=!!t.closest(".dcg-action-settings"),n=this.isMathquillFocused()&&!!t.closest(".dcg-keypad"),a=!!t.closest(".dcg-action-undo")||!!t.closest(".dcg-action-redo");return!(i||o||n||a)}isMathquillFocused(){return this.getFocusedLimit()!==void 0}getFocusedLimit(){let e=this.controller.getFocusLocation();if(e&&e.type==="settings")return e.location}getShowXAxis(){return!!this.controller.getGraphSettings().showXAxis}toggleAxes(){this.controller.dispatch({type:"set-graph-settings",showXAxis:!this.getShowXAxis(),showYAxis:!this.getShowXAxis()})}getShowAxes(){return!!this.controller.getGraphSettings().showXAxis}getAxisNumbers(){return!!this.controller.getGraphSettings().xAxisNumbers}toggleAxisNumbers(){let e=this.getAxisNumbers();this.controller.dispatch({type:"set-graph-settings",xAxisNumbers:!e,yAxisNumbers:!e,polarNumbers:!e})}getMinorGridlines(){return this.controller.getGraphSettings().xAxisMinorSubdivisions===0}toggleMinorGridlines(){let e=this.getMinorGridlines()?1:0;this.controller.dispatch({type:"set-graph-settings",yAxisMinorSubdivisions:e,xAxisMinorSubdivisions:e})}getAxisArrowMode(){return this.controller.getGraphSettings().xAxisArrowMode}getShowGrid(){return this.controller.getGraphSettings().showGrid}toggleGrid(){this.controller.dispatch({type:"set-graph-settings",showGrid:!this.getShowGrid()})}toggleArrows(){let e=this.getAxisArrowMode()==="NONE"?"BOTH":"NONE";this.controller.dispatch({type:"set-graph-settings",xAxisArrowMode:e,yAxisArrowMode:e})}getContainerStyle(){return this.controller.getKeypadHeight()?"bottom: 0":""}};var vu=__dcg_shared_module_exports__['e'](te());var{Switch:yhe}=vu.Components,UA=class extends vu.Class{constructor(){super(...arguments),this.frames=0,this.prevTime=0}init(){var t;this.current=0,this.panels={},this.panels.fps=new $S({name:"fps",yMax:120,fg:"#0ff",bg:"#002"}),this.panels.evaluator=new $S({name:"eval",yMax:250,fg:"#f80",bg:"#210"}),this.panels.mem=new $S({name:"MB",yMax:this.getMemory().jsHeapSizeLimit/2**20,fg:"#f08",bg:"#201"}),this.list=Object.keys(this.panels),this.props.controller().onEvaluatorChangesSpy=(i,o)=>{var n;this.props.controller().isThreeDMode()||this.frame(),this.panels.evaluator.update((n=o.timeInWorker)!=null?n:NaN)};let e=(t=this.props.controller().getGrapher3d())==null?void 0:t.webglLayer;e&&(e.debugOnlyMeasureGPUTiming=!0,e.onRenderSpy=()=>{this.frame()})}willUnmount(){this.props.controller().onEvaluatorChangesSpy=void 0}template(){return vu.createElement("div",{class:vu.const("dcg-performance-meter"),onTap:()=>{this.current=(this.current+1)%this.list.length,this.update()}},vu.createElement(yhe,{key:()=>this.list[this.current]},e=>vu.createElement("div",{didMount:t=>{t.appendChild(this.panels[e].dom)}})))}frame(){this.frames++;let e=(performance||Date).now();return e>=this.prevTime+1e3&&(this.panels.fps.update(this.frames*1e3/(e-this.prevTime)),this.prevTime=e,this.frames=0,this.panels.mem.update(this.getMemory().usedJSHeapSize/2**20)),e}getMemory(){if(self.performance&&"memory"in self.performance){let e=self.performance.memory;return{usedJSHeapSize:e.usedJSHeapSize,totalJSHeapSize:e.totalJSHeapSize,jsHeapSizeLimit:e.jsHeapSizeLimit}}else return{usedJSHeapSize:NaN,totalJSHeapSize:NaN,jsHeapSizeLimit:NaN}}},sc=Math.round(window.devicePixelRatio||1),f3=80*sc,FX=48*sc,NX=3*sc,BX=2*sc,NA=3*sc,WS=15*sc,b3=74*sc,BA=30*sc,$S=class{constructor(e){this.values=[],this.minValue=1/0,this.maxValue=0,this.dom=document.createElement("canvas"),this.name=e.name,this.yMax=e.yMax,this.fg=e.fg,this.bg=e.bg,this.dom.width=f3,this.dom.height=FX,this.dom.style.cssText="width:80px;height:48px";let t=this.dom.getContext("2d");if(!t)throw new Error("Could not get context");this.context=t,t.font="bold "+9*sc+"px Helvetica,Arial,sans-serif",t.textBaseline="top",t.fillStyle=this.bg,t.fillRect(0,0,f3,FX),t.fillStyle=this.fg,t.fillText(this.name,NX,BX),t.fillRect(NA,WS,b3,BA),t.fillStyle=this.bg,t.globalAlpha=.9,t.fillRect(NA,WS,b3,BA)}update(e){this.values.push(e),this.values.length>b3/sc&&this.values.shift(),this.minValue=Math.min(this.minValue,e),this.maxValue=Math.max(this.maxValue,e),this.draw()}draw(){this.context.fillStyle=this.bg,this.context.globalAlpha=1,this.context.fillRect(0,0,f3,WS),this.context.fillStyle=this.fg,this.context.fillText(Math.round(this.values[this.values.length-1])+" "+this.name+" ("+Math.round(this.minValue)+"-"+Math.round(this.maxValue)+")",NX,BX),this.context.fillStyle=this.fg,this.context.fillRect(NA+sc,WS,this.values.length*sc,BA),this.context.fillStyle=this.bg,this.context.globalAlpha=.9;for(let e=0;e<this.values.length;e++){let t=this.values[e];this.context.fillRect(NA+(e+1)*sc,WS,sc,Math.round((1-t/this.yMax)*BA))}}};var{If:km}=ur.Components,jS=class extends ur.Class{init(){this.controller=this.props.controller()}settings(){return this.controller.getGraphSettings()}template(){return ur.createElement("div",{class:ur.const("dcg-calculator-api-container"),style:ur.const("width: 100%; height: 100%; position: relative;")},ur.createElement("div",{class:()=>({"dcg-container":!0,"dcg-fullscreen":!this.controller.isListVisible(),"dcg-narrow":this.controller.isNarrow(),"dcg-PROJECTOR-MODE":this.settings().config.projectorMode,"dcg-inverted-colors":!!this.settings().config.invertedColors,"dcg-inverted-swatches":this.controller.invertSwatches(),"dcg-EDIT-LIST-MODE":this.controller.isInEditListMode(),"dcg-no-graphpaper":!this.settings().config.graphpaper,"dcg-no-branding":!this.settings().config.branding,"dcg-no-expression-topbar":!this.settings().config.expressionsTopbar,"dcg-default-border":!!this.settings().config.border,"dcg-no-hyperlinks":!this.settings().config.links,"dcg-has-background-color":this.controller.hasBackgroundColor(),"dcg-is-interactive":this.settings().config.expressions||!(this.settings().config.lockViewport||this.settings().userLockedViewport)}),style:()=>({"font-size":this.settings().config.fontSize+"px",background:this.getContainerBackgroundColor(),color:this.controller.getTextColor()}),role:ur.const("application"),"aria-label":()=>this.controller.isGeometry()?this.controller.s("graphing-calculator-narration-main-desmos-geometry"):this.controller.s("graphing-calculator-narration-main-desmos-graphing-calculator"),"x-ms-format-detection":ur.const("none"),didMount:this.bindFn(this.didMountRoot)},ur.createElement(km,{predicate:()=>this.controller.getGraphSettings().config.expressions},()=>ur.createElement(FS,{controller:this.props.controller})),ur.createElement(km,{predicate:()=>this.controller.isListEnabled()&&!this.controller.isListVisible()&&(!this.controller.isGeometry()||this.controller.isNarrow())},()=>ur.createElement("div",{class:()=>({"dcg-overgraph-icon-container":!0,"dcg-bottom-right":this.controller.isNarrow()})},ur.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-show-list"),gravity:()=>this.controller.isNarrow()?"n":"s"},ur.createElement("div",{class:()=>({"dcg-show-expressions-tab":!0,"dcg-overgraph-icon":!0,"dcg-rotated":this.controller.isNarrow()}),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-show-list"),role:ur.const("button"),tabindex:ur.const("0"),onTap:e=>{this.controller.dispatch({type:"show-expressions-list",focusHideIcon:e.device==="keyboard"})},manageFocus:this.const(ft({controller:this.controller,location:{type:"show-expression-list-btn"}}))},ur.createElement("i",{class:ur.const("dcg-icon-show"),"aria-hidden":ur.const("true")}))))),ur.createElement(km,{predicate:this.bindFn(this.showHamburger)},()=>ur.createElement("div",{class:ur.const("dcg-overgraph-icon-container")},ur.createElement($e,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-open-graph"),gravity:this.const("s")},ur.createElement("div",{role:ur.const("button"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-open-graph"),class:ur.const("dcg-action-opendrawer dcg-in-api-action-opendrawer dcg-overgraph-icon"),onTap:()=>this.controller.dispatch({type:"open-drawer"})},ur.createElement("i",{class:ur.const("dcg-icon-hamburger"),"aria-hidden":ur.const("true")}))))),ur.createElement(GA,{controller:this.props.controller}),ur.createElement(km,{predicate:()=>this.controller.isGeoUIActive()&&this.controller.getGraphSettings().config.settingsMenu&&this.controller.isGraphSettingsOpen()},()=>ur.createElement(HS,{controller:this.props.controller})),ur.createElement(km,{predicate:()=>this.controller.shouldShowGeoToolbar()},()=>ur.createElement(VA,{controller:this.props.controller})),ur.createElement(LA,{controller:this.props.controller}),ur.createElement("div",{class:ur.const("dcg-grapher dcg-grapher-2d"),style:()=>({visibility:this.controller.isThreeDMode()?"hidden":"visible","pointer-events":this.controller.isThreeDMode()?"none":"auto"})}),ur.createElement(km,{predicate:()=>this.controller.is3dProduct()},()=>ur.createElement("div",{class:ur.const("dcg-grapher dcg-grapher-3d"),style:()=>({visibility:this.controller.isThreeDMode()?"visible":"hidden","pointer-events":this.controller.isThreeDMode()?"auto":"none"})})),ur.createElement(km,{predicate:()=>this.settings().config.showPerformanceMeter&&!!this.props.controller().getGrapher()},()=>ur.createElement(UA,{controller:this.props.controller})),ur.createElement(km,{predicate:()=>this.controller.getGraphSettings().config.keypad},()=>ur.createElement(xA,{controller:this.props.controller}))))}showHamburger(){return!this.controller.getGraphSettings().config.showHamburger||this.controller.isGeometry()?!1:this.controller.isNarrow()}getContainerBackgroundColor(){return this.controller.hasTransparentBackground()?"none":this.controller.getBackgroundColor()}didMountRoot(e){rh(e),this.controller.getGraphSettings().config.disableScrollFix||SI(e),this.setupFileDragDrop(e)}setupFileDragDrop(e){qS(e);let t=new Set,i=this;function o(){t=new Set,ie(e).off(".filedraggedover"),i.controller.dispatch({type:"file-is-not-dragged-over"})}ie(e).on("dragenter",n=>{this.controller.areImagesEnabled()&&(n.target.closest(".dcg-notice")||(t.size===0&&ie(e).on("dcg-tapstart.filedraggedover",o),t=t.add(n.target),this.controller.dispatch({type:"file-is-dragged-over"})))}).on("dragleave",n=>{t.delete(n.target),t.size===0&&o()}).on("drop",o)}};var zA=class extends Yr{constructor(e){super(),this.workerPool=e,this.guid=__dcg_shared_module_exports__['K']("worker-pool-connection"),this.worker=e.allocateWorker(),this.worker.__connections[this.guid]=this}destroy(){this.sendMessage({type:"destroy"}),delete this.worker.__connections[this.guid]}killWorker(){this.worker.__isFake||this.workerPool.killWorker(this.worker)}onWorkerKilled(){}onResponse(e){}sendMessage(e){this.worker.__isFake?this.worker.postMessage(e):this.worker.postMessage({connectionId:this.guid,originalMessage:e})}};function UX(r){var e={},t=new __dcg_shared_module_exports__['Jd'](i);function i(o,n){r({type:o,payload:n})}return e.postMessage=function(o){setTimeout(function(){t.processChangeSet(o)},0)},e}af();var YS="";try{YS=oh(window.location.search,"workerThrottle"),YS==null&&(YS=oh(window.top.location.search,"workerThrottle"))}catch(r){}var zX=parseInt(YS,10),y3=0;function KX(r){return zX?function(e){y3=Math.max(Date.now(),y3)+zX,setTimeout(r,y3-Date.now(),e)}:r}var Ww=class extends Yr{constructor(e=1/0){super(),this.workers=[],this.maxWorkers=e}allowedToSpawnWorker(){return!!__dcg_worker_source_exports__['createWorker']&&this.workers.length<this.maxWorkers}killWorker(e){var t=__dcg_shared_module_exports__['x'](this.workers,e);t!==-1&&(e.terminate(),this.workers=__dcg_shared_module_exports__['u'](this.workers,e),__dcg_shared_module_exports__['p'](__dcg_shared_module_exports__['C'](e.__connections)).forEach(function(i){i&&i.onWorkerKilled&&i.onWorkerKilled()}))}spawnWorker(){if(!__dcg_worker_source_exports__['createWorker'])return null;try{var e=__dcg_worker_source_exports__['createWorker']();return e.__connections={},e.__isFake=!1,e.onerror=function(t){__dcg_shared_module_exports__['M'].log(t)},e.addEventListener("message",KX(function(t){var i=t.data;if(!(i&&i.log)&&i&&i.connectionId){var o=e.__connections[i.connectionId];o&&o.onResponse(i.originalMessage)}})),this.workers.push(e),e}catch(t){return null}}spawnFakeWorker(){var e=UX(KX(function(t){var i=__dcg_shared_module_exports__['C'](e.__connections)[0];i&&i.onResponse(t)}));return e.__isFake=!0,e.__connections={},e}findLeastUsedWorker(){var e=function(i){return __dcg_shared_module_exports__['s'](i.__connections)},t=__dcg_shared_module_exports__['q'](this.workers,e)[0];return t}allocateWorker(){var e=null;return this.allowedToSpawnWorker()&&(e=this.spawnWorker()),e||(e=this.findLeastUsedWorker()),e||(e=this.spawnFakeWorker()),e}};var xhe=4e3,Gm=class{constructor(e){this.__ticksEnabled=!0;this.listeners={processChangeSet(e){var t={},i={};for(var o in e.graphChanges){var n=e.graphChanges[o];n===void 0?i[o]=!0:(__dcg_shared_module_exports__['hc'](n),t[o]=n)}var a={};for(var o in e.intersectionChanges)i[o]||(a[o]=e.intersectionChanges[o]);var s=!!this.changeSet;this.onEvaluatorResults({evaluationStates:e.statusChanges,graphData:{addedGraphs:t,removedGraphs:i,intersections:a},renderSlowly:!!e.isCompleteState,timingData:e.timingData,eventUpdates:e.eventUpdates});let l=e.syncId;for(;this.syncRequests.length&&l!==void 0&&this.syncRequests[0].id<=l;)this.syncRequests.shift().callback();this.markJobFinished(),s&&this._processChangeSet()}};this.__state={},this.changeSet=null,this.cumulativeChangeSet={},this.syncId=1,this.syncRequests=[],e||(e=new Ww),this.workerPool=e,this.createWorkerPoolConnection()}privateGetWorkerPool(){return this.workerPool}privateGetWorkerPoolConnection(){return this.workerPoolConnection}createWorkerPoolConnection(){this.workerPoolConnection&&(this.workerPoolConnection.onResponse=function(){},this.workerPoolConnection.onWorkerKilled=function(){}),this.workerPoolConnection=new zA(this.workerPool),this.markJobFinished(),this.workerPoolConnection.onResponse=e=>{this.shouldIgnoreWorkerMessage(e)?e.type==="processChangeSet"&&(this.markJobFinished(),this._processChangeSet()):this.listeners[e.type].call(this,e.payload)},this.workerPoolConnection.onWorkerKilled=()=>{var e=this.hasJobInWorker();this.createWorkerPoolConnection(),e?(this.changeSet=__dcg_shared_module_exports__['Z'](this.cumulativeChangeSet),this.__state.changed=!0,this.__state.droppedMessage=!0):(this.changeSet=__dcg_shared_module_exports__['Z'](this.cumulativeChangeSet),this.__state.changed=!1),this.processChangeSet()}}destroy(){this.workerPoolConnection&&(this.workerPoolConnection.onResponse=function(){},this.workerPoolConnection.onWorkerKilled=function(){},this.workerPoolConnection.destroy())}shouldIgnoreWorkerMessage(e){return this.__suspendUntilSyncId?!e||!e.payload?!0:!(e.payload.syncId>=this.__suspendUntilSyncId):!1}suspend(){(!this.changeSet||!this.changeSet.syncId)&&(this.syncId++,this.applyToChangeSets(e=>{e.syncId=this.syncId})),this.__suspendUntilSyncId=this.changeSet.syncId}markJobFinished(){this.__state.droppedMessage=!1,this.__jobStartTime=-1,this.__suspendUntilSyncId=void 0}startJobTimer(){this.__jobStartTime=new Date().getTime()}hasJobInWorker(){return this.__jobStartTime!==-1}getJobElapsedTime(){return this.hasJobInWorker()?new Date().getTime()-this.__jobStartTime:NaN}setTicksEnabled(e){this.__ticksEnabled=e}tick(){this.__ticksEnabled&&this._processChangeSet()}processChangeSet(){this.__processChangeSetRequested=!0}_processChangeSet(){if(this._syncEvaluatorConfig(),!this.__processChangeSetRequested)return;let e=this.getJobElapsedTime()>=xhe;if(this.__state.droppedMessage&&e){this.workerPoolConnection.killWorker();return}if(this.__state.changed&&this.changeSet)if(this.changeSet.syncId||(this.syncId++,this.changeSet.syncId=this.syncId),this.hasJobInWorker())this.changeSet.isCompleteState&&e&&this.workerPoolConnection.killWorker();else{let t=this.changeSet;this.changeSet=null,this.__state.changed=!1,this.startJobTimer(),this.workerPoolConnection.sendMessage(t),this.__processChangeSetRequested=!1}}notifyWhenSynced(e){if(this._syncEvaluatorConfig(),!this.hasJobInWorker()&&!this.changeSet){setTimeout(e,0);return}this.syncId++,this.syncRequests.push({id:this.syncId,callback:e}),this.applyToChangeSets(t=>{t.syncId=this.syncId})}applyToChangeSets(e){this.__state.changed=!0,this.changeSet||(this.changeSet={}),this.cumulativeChangeSet||(this.cumulativeChangeSet={}),e(this.changeSet),e(this.cumulativeChangeSet),this.processChangeSet()}clearStatementsAndStartCompleteState(){this.hasJobInWorker()&&this.suspend(),this.applyToChangeSets(function(e){e.isCompleteState=!0,delete e.statements})}markUndoRedoState(){this.applyToChangeSets(function(e){e.isUndoRedoState=!0})}addStatement(e){this.applyToChangeSets(function(t){t.statements||(t.statements={}),t.statements[e.id]=__dcg_shared_module_exports__['Z'](e)})}removeStatement(e){this.applyToChangeSets(function(t){t.statements||(t.statements={}),t.removes||(t.removes={}),delete t.statements[e],t.removes[e]=!0})}addActionStepEvent(e){this.applyToChangeSets(function(t){t.events||(t.events=[]),t.events.push({type:"step",expressionId:e})})}addClockTickEvent(e,t){this.applyToChangeSets(function(i){i.events||(i.events=[]),i.events.push({type:"clock-tick",id:e,isFirstTick:t})})}addClickEvent(e,t){this.applyToChangeSets(function(i){i.events||(i.events=[]),t===void 0&&(t=0),i.events.push({type:"click",expressionId:e,indexVar:t})})}_syncEvaluatorConfig(){if(this.readEvaluatorConfig){var e=this.readEvaluatorConfig();for(let t in e)this._applyIfChanged(e,t)}}_applyIfChanged(e,t){let i=this.cumulativeChangeSet&&this.cumulativeChangeSet[t],o=e[t];__dcg_shared_module_exports__['E'](i,o)||this.applyToChangeSets(function(n){n[t]=o})}};function Cu(r){return r==="es-ES"?(__dcg_shared_module_exports__['M'].warn("{language: 'es-ES'} has been deprecated. Proceeding with {language: 'es'}"),"es"):r}var qA=class{constructor(){this.seen=new Set;this.samples=[];this.button=document.createElement("button");this.isRecording=!1;this.reset(),this.button.addEventListener("click",()=>{if(this.isRecording){this.isRecording=!1;let e=this.reportAsCalcState();console.log("Profiler result (also set on window.profilerResult):"),console.log(e),window.profilerResult=e;let t=JSON.stringify(e);Che(t)}else this.reset(),this.isRecording=!0;this.updateButtonText()})}updateButtonText(){this.button.innerText=this.isRecording?"\u25FC\uFE0F":"\u{1F534}"}add(e,t){this.seen.has(e)||this.samples.push(t)}reset(){this.seen=new Set,this.samples=[],this.isRecording=!1,this.updateButtonText()}reportAsCalcState(){let e={};for(let i of this.samples)for(let o in i)e[o]||(e[o]=[]),e[o].push(i[o]);return whe(window.location.href,e)}},qX=[__dcg_shared_module_exports__['W'].RED,__dcg_shared_module_exports__['W'].BLUE,__dcg_shared_module_exports__['W'].GREEN,__dcg_shared_module_exports__['W'].PURPLE,__dcg_shared_module_exports__['W'].ORANGE,__dcg_shared_module_exports__['W'].BLACK];function whe(r,e){let t=[];for(let o in e){let n=e[o].map(__dcg_shared_module_exports__['Oc']);t.push({latex:vhe(o),values:n,color:qX[t.length%qX.length]})}return{...Ug,expressions:{list:[{id:"1",type:"text",text:r},{id:"2",type:"table",columns:t}]}}}function vhe(r){if(r.length===1)return r;let e=r.replace(/[^a-zA-Z0-9_]/g,"").replace(/^[0-9]/,"").replace(/__+/g,"_");return`${e[0]}_{${e.slice(1)}}`}async function Che(r){if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(r);else{let e=document.createElement("textarea");e.value=r,e.style.position="absolute",e.style.left="-999999px",document.body.prepend(e),e.select();try{document.execCommand("copy")}catch(t){console.error(t)}finally{e.remove()}}}Rc();var HX=new URLSearchParams(window.location.search).get("recursionDepth"),Ehe=HX?parseInt(HX):void 0,She=0,XS=class{constructor(e,t,i,o){e||(e=document.createElement("div"));let n=document.createElement("div");n.className="dcg-dom-change-wrapper",n.style.width="100%",n.style.height="100%",e.appendChild(n),this.__id=She++;let a=new ih;this.graphSettings=a;for(let h in i)a.config.setProperty(h,i[h]);let s=new cb(a);this.controller=s,o&&s.dispatch({type:"ui/container-resized",size:o}),this.rootElt=n,this.view=$w.mountToNode(jS,this.rootElt,{controller:$w.const(s)});let l=new Gm(t);this.controller.setEvaluator(l),this.controller.setRootElt(this.rootElt);let c=this.controller.findEl(".dcg-grapher-2d"),d=new Kf(c,a,this.controller,l);this.controller.setGrapher2d(d),this.grapher=d,this.controller.initStateStack(),l.readEvaluatorConfig=()=>({product:a.config.product,beta3d:!!pr("beta3d"),evaluationMode:s.isGeometry()?"geometry":this.controller.isThreeDMode()?"graphing_3d":"graphing",globalRandomSeed:a.randomSeed,degreeMode:a.degreeMode,viewState:s.getViewState(),selectedIds:s.getPropagatedSelectedIds(),restrictedFunctions:a.config.restrictedFunctions,forceEnableGeometryFunctions:a.config.forceEnableGeometryFunctions,distributions:a.config.distributions,pointsOfInterest:a.config.pointsOfInterest,plotSingleVariableImplicitEquations:a.config.plotSingleVariableImplicitEquations,plotImplicits:a.config.plotImplicits,plotInequalities:a.config.plotInequalities,sliders:a.config.sliders,actions:!!a.config.actions,substitutions:!!a.config.substitutions,intervalComprehensions:!!a.config.intervalComprehensions,recursion:!!a.config.recursion,recursionDepthLimit:Ehe,dimensions:s.getGrapherDimensions(),logInternalErrors:!!tn().logInternalErrors}),l.onEvaluatorResults=h=>{this.controller.dispatch({type:"on-evaluator-changes",changes:h.evaluationStates,timingData:h.timingData,graphData:h.graphData,eventUpdates:h.eventUpdates}),this.controller.requestRedrawGraph()},this.unsubFunc=this.controller.subscribeToChanges(()=>{this.controller.doesDOMHaveSize()&&(this.view.update(),this.grapher=this.controller.isThreeDMode()?this.controller.getGrapher3d()||this.controller.getGrapher2d():this.controller.getGrapher2d(),this.grapher.update());var h=!1;g()&&(h=!0),h&&this.controller.doesDOMHaveSize()&&(this.view.update(),this.grapher.update())});let p=new Yr;p.setProperties({pixelCoordinates:{top:0,bottom:0,left:0,right:0,width:0,height:0},mathCoordinates:{top:0,bottom:0,left:0,right:0,width:0,height:0}}),this.graphpaperBounds=p;let g=()=>{var h=!1,f=s.computeMajorLayout(),y={left:f.grapher.left,right:f.grapher.left+f.grapher.width,width:f.grapher.width,top:f.grapher.top,bottom:f.grapher.top+f.grapher.height,height:f.grapher.height},x=this.grapher.getCurrentViewport(),E={top:x.ymax,bottom:x.ymin,left:x.xmin,right:x.xmax,width:x.xmax-x.xmin,height:x.ymax-x.ymin};__dcg_shared_module_exports__['E'](E,p.mathCoordinates)||(p.setProperty("mathCoordinates",E),h=!0);var C=y.height>0&&y.width>0;return C&&!__dcg_shared_module_exports__['E'](y,p.pixelCoordinates)&&(p.setProperty("pixelCoordinates",y),h=!0),h};ie(this.rootElt).on("keydown.calculator-"+this.__id,h=>{this.grapher instanceof Kf&&this.grapher.audioGraph.handleKeydown(h),this.instanceHotkeys.handleKeydown(h)}),ie(document.documentElement).on("dcg-tapstart.calculator-"+this.__id,h=>{var v;let f=h.target,y=!!this.rootElt.contains(f),x=h.wasHandled("create-expression-with-keyboard"),E=!!f.closest(".dcg-api-shared-keypad-root"),C=!!f.classList.contains("dcg-shell");!y&&!E&&!C&&!x&&s.dispatch({type:"set-none-selected"});let S=(v=this.controller.getGrapher2d())==null?void 0:v.traceLayer;if(!h.wasHandled("do-not-clear-poi-labels")&&S&&(S.clearOpenedPOI(),this.controller.requestRedrawGraph()),s.isInEditListMode()){let M=!f.closest(".dcg-exppanel")&&!f.closest(".dcg-options-menu")&&!f.closest(".dcg-expression-top-bar")&&!f.closest(".dcg-keypad");(!y||M)&&s.dispatch({type:"set-edit-list-mode",isEditListMode:!1,focusExpressionList:!1})}}),this.evaluator=l,this.controller.dispatch({type:"set-blank",degreeMode:!!i.degreeMode}),a.config.expressionsCollapsed&&this.setOptions({expressionsCollapsed:!0}),a.config.capExpressionSize&&this.setOptions({capExpressionSize:!0}),a.config.hasOwnProperty("pointsOfInterest")&&this.setOptions({pointsOfInterest:a.config.pointsOfInterest}),a.config.hasOwnProperty("backgroundColor")&&this.setOptions({backgroundColor:a.config.backgroundColor}),a.config.hasOwnProperty("textColor")&&this.setOptions({textColor:a.config.textColor}),a.config.observe("language",()=>{let h=this.controller.getState();this.controller.dispatch({type:"set-state",state:h})}),a.config.observe("forceLogModeRegressions",()=>{a.config.forceLogModeRegressions&&this.controller.setAllRegressionsToLogMode()}),this.instanceHotkeys=new aS(s)}initializeGrapher3d(e){let t=this.controller.findEl(".dcg-grapher-3d"),i=new e(t,this.controller.getGraphSettings(),this.controller,this.controller.getEvaluator());this.controller.setGrapher3d(i),this.grapher=i,this.controller.dispatch({type:"set-blank"}),this.controller.clearUndoRedoHistory()}setOption(e,t){this.controller.getGraphSettings().config.setProperty(e,t)}setOptions(e){let t,i=this.controller.getGraphSettings().config,o={...e};e.hasOwnProperty("backgroundColor")&&(__dcg_shared_module_exports__['O'](e.backgroundColor)||(__dcg_shared_module_exports__['M'].warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)"),delete o.backgroundColor)),e.hasOwnProperty("textColor")&&(__dcg_shared_module_exports__['O'](e.textColor)||(__dcg_shared_module_exports__['M'].warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)"),delete o.textColor)),e.hasOwnProperty("menus")&&(__dcg_shared_module_exports__['M'].warn("Deprecated option: menus. Setting settingsMenu and expressionsTopbar instead."),e.hasOwnProperty("settingsMenu")||(o.settingsMenu=!!e.menus),e.hasOwnProperty("expressionsTopbar")||(o.expressionsTopbar=!!e.menus),delete o.menus),e.hasOwnProperty("solutions")&&(__dcg_shared_module_exports__['M'].warn("Deprecated option: solutions. Setting pointsOfInterest instead."),e.hasOwnProperty("pointsOfInterest")||(o.pointsOfInterest=!!e.solutions),delete o.solutions),e.hasOwnProperty("administerSecretFolders")&&(__dcg_shared_module_exports__['M'].warn("Deprecated option: administerSecretFolders. Setting authorFeatures instead."),e.hasOwnProperty("authorFeatures")||(o.authorFeatures=!!e.administerSecretFolders),delete o.administerSecretFolders),e.hasOwnProperty("singleVariableSolutions")&&(__dcg_shared_module_exports__['M'].warn("Deprecated option: singleVariableSolutions has been removed."),delete o.singleVariableSolutions),e.graphpaper===!1&&(e.expressionsCollapsed&&(o.expressionsCollapsed=!1,__dcg_shared_module_exports__['M'].warn("Cannot set graphpaper: false with expressionsCollapsed: true. Proceeding with expressionsCollapsed: false.")),i.expressionsCollapsed&&(o.expressionsCollapsed=!1,__dcg_shared_module_exports__['M'].warn("Disabling the graphpaper with the expressions list collapsed is not supported.Setting expressionsCollapsed: false.")),e.zoomButtons&&(o.zoomButtons=!1,__dcg_shared_module_exports__['M'].warn("Cannot set graphpaper: false with zoomButtons: true. Proceeding with zoomButtons: false.")),e.showResetButtonOnGraphpaper&&(o.showResetButtonOnGraphpaper=!1,__dcg_shared_module_exports__['M'].warn("Cannot set graphpaper: false with showResetButtonOnGraphpaper: true. Proceeding with showResetButtonOnGraphpaper: false.")),i.zoomButtons&&(o.zoomButtons=!1,__dcg_shared_module_exports__['M'].warn("Disabling the graphpaper with the zoomButtons visible is not supported. Setting zoomButtons: false.")),i.showResetButtonOnGraphpaper&&(o.showResetButtonOnGraphpaper=!1,__dcg_shared_module_exports__['M'].warn("Disabling the graphpaper with the reset button visible is not supported. Setting showResetButtonOnGraphpaper: false."))),i.graphpaper===!1&&(e.expressionsCollapsed||e.zoomButtons||e.showResetButtonOnGraphpaper)&&(o.graphpaper=!0,__dcg_shared_module_exports__['M'].warn("Must have visible graphpaper to proceed. Setting graphpaper: true.")),e.lockViewport&&e.zoomButtons&&(o.zoomButtons=!1,__dcg_shared_module_exports__['M'].warn("Cannot set zoomButtons: true and lockViewport: true. Proceeding with zoomButtons: false.")),i.lockViewport&&e.zoomButtons&&(o.lockViewport=!1,__dcg_shared_module_exports__['M'].warn("Cannot set zoomButtons: true while the viewport is locked. Setting lockViewport: false.")),i.zoomButtons&&e.lockViewport&&(o.zoomButtons=!1,__dcg_shared_module_exports__['M'].warn("Cannot lock the viewport without hiding the zoom buttons. Setting zoomButtons: false."));function n(d){let{notes:p,folders:g,images:h}=d;return p===!1||g===!1||h===!1}let a=n(e),s=n({...i,...e}),l=i.pasteGraphLink,c=e.pasteGraphLink;a?(c||l)&&(o.pasteGraphLink=!1,__dcg_shared_module_exports__['M'].warn("Cannot disable creating note, folder, or image expressions without disabling graph link pasting. Setting pasteGraphLink: false.")):c&&s&&(o.notes=!0,o.folders=!0,o.images=!0,__dcg_shared_module_exports__['M'].warn("Cannot enable graph link pasting while the creation of notes, folders, or images is disable. Setting notes: true, folders: true, images: true.")),e.language&&(o.language=Cu(e.language)),e.logScales&&this.controller.isGeometry()&&(__dcg_shared_module_exports__['M'].warn("Cannot set logScales: true in the geometry calculator"),delete o.logScales);for(t in o)if(o.hasOwnProperty(t))switch(t){case"expressionsCollapsed":this.setOption("expressionsCollapsed",!!o.expressionsCollapsed),o.expressionsCollapsed?this.controller.dispatch({type:"hide-expressions-list",focusShowIcon:!1}):this.controller.dispatch({type:"show-expressions-list",focusHideIcon:!1});break;case"qwertyKeyboard":this.setOption("qwertyKeyboard",!!o.qwertyKeyboard),this.controller.isLetterKeypadOpen()&&this.controller.dispatch({type:"keypad/abc"});break;case"degreeMode":this.setOption("degreeMode",!!o.degreeMode),this.controller.dispatch({type:"set-graph-settings",degreeMode:!!o.degreeMode});break;case"actions":{let p=o[t];if(p===void 0||p===this.controller.getGraphSettings().config.actions)break;this.setOption(t,p),this.setState(this.getState(),{allowUndo:!0});break}case"substitutions":{let p=o[t];if(p===void 0||p===this.controller.getGraphSettings().config.substitutions)break;this.setOption(t,p),this.setState(this.getState(),{allowUndo:!0});break}case"intervalComprehensions":{let p=o[t];if(p===void 0||p===this.controller.getGraphSettings().config.intervalComprehensions)break;this.setOption(t,p),this.setState(this.getState(),{allowUndo:!0});break}case"recursion":{let p=o[t];if(p===void 0||p===this.controller.getGraphSettings().config.recursion)break;this.setOption(t,p),this.setState(this.getState(),{allowUndo:!0});break}case"product":case"beta3d":{__dcg_shared_module_exports__['M'].warn(`Cannot update '${t}' setting.`);break}case"logScales":{let p=o[t];p!==void 0&&(p===!1&&this.controller.dispatch({type:"set-graph-settings",xAxisScale:"linear",yAxisScale:"linear"}),this.setOption(t,p));break}case"graphDescription":{let p=o[t];typeof p=="string"||typeof p=="undefined"?this.setOption(t,p):__dcg_shared_module_exports__['M'].warn("Invalid graphDescription. graphDescription must be of type string or undefined.");break}case"keypad":case"graphpaper":case"expressions":case"settingsMenu":case"zoomButtons":case"showResetButtonOnGraphpaper":case"expressionsTopbar":case"pointsOfInterest":case"trace":case"border":case"lockViewport":case"authorFeatures":case"authorMode":case"advancedStyling":case"images":case"imageUploadCallback":case"folders":case"notes":case"sliders":case"links":case"restrictedFunctions":case"forceEnableGeometryFunctions":case"distributions":case"pasteGraphLink":case"pasteTableData":case"clearIntoDegreeMode":case"autosize":case"plotSingleVariableImplicitEquations":case"plotImplicits":case"plotInequalities":case"colors":case"branding":case"disableScrollFix":case"invertedColors":case"fontSize":case"projectorMode":case"ghostMode":case"language":case"onlyTraceSelected":case"disableMouseInteractions":case"nativeOnscreenKeypad":case"functionDefinition":case"plaidMode":case"wireframe":case"pasteGraphLinkCallback":case"editOnWeb":case"crossOriginSaveTest":case"backgroundColor":case"textColor":case"enableTabindex":case"audioTraceReverseExpressions":case"showHamburger":case"decimalToFraction":case"capExpressionSize":case"transparentBackground":case"pauseWhenOffscreen":case"hideGeoUI":case"brailleMode":case"sixKeyInput":case"brailleControls":case"zoomFit":case"forceLogModeRegressions":case"cacheRenderedSvgs":case"audio":case"showKeyboardShortcutsInTooltips":case"tone":case"translucentSurfaces":case"perspectiveDistortion":case"showPerformanceMeter":{let p=o[t];p!==void 0&&this.setOption(t,p);break}default:return t}}setViewport(e){let t=new di(e[0],e[1],e[2],e[3]);this.grapher.viewportController.setViewport(t),this.controller.dispatch({type:"commit-user-requested-viewport",viewport:t})}resize(e){e&&this.controller.dispatch({type:"ui/container-resized",size:e})}destroy(){var t;ie(document.documentElement).off(".calculator-"+this.__id),ie(this.rootElt).off(".calculator-"+this.__id),this.unsubFunc(),this.graphSettings.unobserveAll(),this.controller&&((t=this.controller.toneController)==null||t.unload()),this.evaluator&&this.evaluator.destroy(),this.grapher&&this.grapher.remove(),$w.unmountFromNode(this.rootElt),this.rootElt.remove()}tick(e,t){t||(this.controller.handleTick(e),this.controller.updateRenderShellsAfterDispatch()),this.evaluator.tick(),this.grapher&&this.grapher.tick(e)}getState(e){return this.controller.getState(e)}setBlank(e){this.controller.dispatch({type:"set-blank",opts:e||{}})}setState(e,t){this.controller.dispatch({type:"set-state",state:e,opts:t||{}})}};function Dhe(){let r=document.createElement("div");aa(r,{zIndex:"99999",position:"absolute",left:"0px",top:"0px",background:"#FFF"}),document.body.append(r);let e=document.createElement("div");e.innerText="waiting...",e.style.display="inline-block";let t=new qA;r.appendChild(t.button),r.appendChild(e);var i=window,o=[],n=[];i.Calc.controller.onEvaluatorChangesSpy=function(){o.push(Date.now())};let a=new WeakSet;i.__dcgKnownPrograms=a;let s=0;if(i.Calc.controller.isThreeDMode()){let l=i.Calc.controller.grapher3d.webglLayer;l.debugOnlyMeasureGPUTiming=!0,l.onRenderSpy=function(){let c=l.debugGetPrograms(),d=c.reduce((g,h)=>g+h.usedTimes,0),p=0;for(let g of c)a.has(g)||(p+=1,s+=1,a.add(g));n.push({ts:Date.now(),programCount:c.length,programUses:d,newProgramCount:p,frame:l.lastRenderInfo})},l.debugOnlyTrackBufferUploads()}setInterval(function(){for(var l=Date.now();l-o[0]>1e3;)o.shift();for(;n.length&&l-n[0].ts>1e3;)n.shift();let c=n.length,d=n.slice(-100);if(t.isRecording)for(let I of d){let{startTimeCPU:P,durationCPU:_,endTimeGPU:U}=I.frame;U&&t.add(P,{t0:P,tcpu:_,tgpu0:U[0]-P,tgpu1:U[1]-P})}let p=Uh(d.map(I=>I.frame.durationCPU),2),g=[],h=[];for(let{frame:I}of d)I.endTimeGPU&&(g.push((I.endTimeGPU[0]+I.endTimeGPU[1])/2-I.startTimeCPU),h.push((I.endTimeGPU[0]-I.startTimeCPU)/2));let f=Uh(g,2),y=Uh(h,0),x=Uh(d.map(I=>I.programUses)),E=Uh(d.map(I=>I.programCount)),C=Uh(d.map(I=>I.newProgramCount)),S=Uh(d.map(I=>I.frame.triangles/1e3)),v=Uh(d.map(I=>I.frame.bufferUploads,0)),M=Uh(d.map(I=>I.frame.bufferUploadItems/1e3,1)),A=i.Calc.controller.isThreeDMode()?[`compute: <span dcg-fps-metric="computeFPS">${o.length}</span> fps`,`3d render: <span dcg-fps-metric="fps">${c}</span> fps`,`Redraw (CPU): <span dcg-fps-metric="redraw">${p}</span> ms`,`Redraw (CPU+GPU): <span dcg-fps-metric="cpu-gpu-redraw">${f}</span> \xB1<span dcg-fps-metric="cpu-gpu-redraw-error">${y}</span>ms`,`triangles: <span dcg-fps-metric="triangles">${S}</span>K/fr`,`buffers: <span dcg-fps-metric="uploadsPerFrame">${v}</span> uploads/fr, <span dcg-fps-metric="itemsPerFrame">${M}</span>K items/fr`,`programs: <span dcg-fps-metric="programsPerFrame">${x} uses/fr, <span dcg-fps-metric="programsCurrentPerFrame">${E} current/fr, <span dcg-fps-metric="programsNewPerFrame">${C}</span> new/fr, <span dcg-fps-metric="programsTotal">${s}</span> total`].join(" | "):`${o.length} fps`;e.innerHTML=A},100)}function Uh(r,e=1){let t=0;for(let o of r)t+=o;return(t/r.length).toFixed(e)}function khe(){let r=document.createElement("div");aa(r,{zIndex:"99999",position:"absolute",left:"0px",top:"0px",background:"#FFF"}),r.innerText="waiting...",document.body.append(r);var e=window,t=[],i=0;e.Calc.controller.onEvaluatorChangesSpy=function(s,l){let{timeInWorker:c}=l;t[i%100]=c,i+=1};function o(){let s=0;for(let c of t)s+=c;let l=s/t.length;r.innerText=l.toFixed(1)+" ms"}let n;function a(){cancelAnimationFrame(n),n=requestAnimationFrame(a),o()}a()}var Ghe=!!tn().simulationFPS;Ghe&&(JS=setInterval(function(){var r=window.Calc;r&&(clearInterval(JS),Dhe())},1));var JS,The=!!tn().timeInWorker;The&&(JS=setInterval(function(){var e=window.Calc;e&&(clearInterval(JS),setTimeout(khe,1e3))},1));var JS;function Mhe(r){ny?setTimeout(r,25):requestAnimationFrame(r)}var WX=1,jw={},QS=!1;function jX(){QS=!0,Mhe(Ihe)}var $X={};function Ihe(){$X.rafSPY&&$X.rafSPY(),QS=!1;for(let r in jw)jw[r].detectAndEnqueueEvent(),QS=!0;if(QS){jX();for(let r in jw)jw[r].dispatchQueuedEvent()}}var Cb=class{constructor(e,t){this.elt=e;this.cb=t;this.destroyed=!1;this.lastOffscreen=!1;this.id=WX.toString(),this.appliedScale={x:1,y:1},WX++}stopWatching(){delete jw[this.id]}startWatching(){this.checkForChanges(),jw[this.id]=this,QS||jX()}resetAppliedScalingAndGetBoundingClientRect(){var e=this.elt.getBoundingClientRect(),t={x:e.width/this.elt.offsetWidth,y:e.height/this.elt.offsetHeight};if(t.x===this.appliedScale.x&&t.y===this.appliedScale.y)return e;let i=this.elt.querySelector(".dcg-dom-change-wrapper");return i&&(this.appliedScale=t,aa(i,{transform:"scale("+1/this.appliedScale.x+","+1/this.appliedScale.y+")",width:100*this.appliedScale.x+"%",height:100*this.appliedScale.y+"%",transformOrigin:"0 0"})),e}detectAndEnqueueEvent(){if(this.destroyed)return;let e=!0;if(!(document.body&&document.body.contains(this.elt)))this.lastSize&&(this.lastSize=void 0,this.queuedEvent={type:"removed",target:this.elt,isOffscreen:!0});else{let i=this.resetAppliedScalingAndGetBoundingClientRect();e=i.top>window.innerHeight||i.bottom<0||i.left>window.innerWidth||i.right<0,this.lastSize?(i.width!==this.lastSize.width||i.height!==this.lastSize.height||window.devicePixelRatio!==this.lastSize.pixelRatio)&&(this.lastSize.width=i.width,this.lastSize.height=i.height,this.lastSize.pixelRatio=window.devicePixelRatio,this.queuedEvent={type:"resized",target:this.elt,size:{...this.lastSize},isOffscreen:e}):(this.lastSize={width:i.width,height:i.height,pixelRatio:window.devicePixelRatio},this.queuedEvent={type:"added",target:this.elt,size:{...this.lastSize},isOffscreen:e})}e!==this.lastOffscreen&&(this.lastOffscreen=e,this.queuedEvent||(this.queuedEvent={type:"offscreen-noop",target:this.elt,isOffscreen:e}))}dispatchQueuedEvent(){let e=this.queuedEvent;e&&(this.queuedEvent=void 0,this.cb(e))}checkForChanges(){this.detectAndEnqueueEvent(),this.dispatchQueuedEvent()}destroy(){this.stopWatching();for(var e in this)this.hasOwnProperty(e)&&delete this[e];this.destroyed=!0}};function YX(r){var e=r.mode,t=r.width,i=r.height,o=r.currentBounds,n=r.graphpaperAspectRatio,a=r.mathAspectRatio,s=r.mathBounds,l=t/i,c={x:o.left+o.width/2,y:o.bottom+o.height/2};if(s.left===void 0!=(s.right===void 0)||s.bottom===void 0!=(s.top===void 0))return __dcg_shared_module_exports__['M'].warn('asyncScreenshot: cannot specify "left" bound without "right" or "bottom" bound without "top". Got: '+s),o;var d=s.left!==void 0&&s.right!==void 0,p=s.bottom!==void 0&&s.top!==void 0,g=d&&p,h,f,y,x,E,C,S,v,M,A;switch(e){case"stretch":return g?s:d?{left:s.left,right:s.right,bottom:o.bottom,top:o.top}:p?{left:o.left,right:o.right,bottom:s.bottom,top:s.top}:o;case"contain":return g?(x=s.right-s.left,E=s.top-s.bottom,C={x:s.left+x/2,y:s.bottom+E/2},y=x/E,l>y?(f=E/i,h=f*a,{left:C.x-h*t/2,right:C.x+h*t/2,bottom:s.bottom,top:s.top}):(h=x/t,f=h/a,{left:s.left,right:s.right,bottom:C.y-f*i/2,top:C.y+f*i/2})):d?(S=s.right-s.left,v=s.left+S/2,y=S/o.height,l>y?(f=o.height/i,h=f*a,{left:v-h*t/2,right:v+h*t/2,bottom:o.bottom,top:o.top}):(h=S/t,f=h/a,{left:s.left,right:s.right,bottom:c.y-f*i/2,top:c.y+f*i/2})):p?(M=s.top-s.bottom,A=s.bottom+M/2,y=o.width/M,l>y?(f=M/i,h=f*a,{left:c.x-h*t/2,right:c.x+h*t/2,bottom:s.bottom,top:s.top}):(h=o.width/t,f=h/a,{left:o.left,right:o.right,bottom:A-f*i/2,top:A+f*i/2})):l>n?(f=o.height/i,h=f*a,{left:c.x-h*t/2,right:c.x+h*t/2,bottom:o.bottom,top:o.top}):(h=o.width/t,f=h/a,{left:o.left,right:o.right,bottom:c.y-f*i/2,top:c.y+f*i/2});case"preserveX":return g?(x=s.right-s.left,E=s.top-s.bottom,C={x:s.left+x/2,y:s.bottom+E/2},y=x/E,h=x/t,f=h/a,{left:s.left,right:s.right,bottom:C.y-f*i/2,top:C.y+f*i/2}):p?(M=s.top-s.bottom,A=s.bottom+M/2,y=o.width/M,h=o.width/t,f=h/a,{left:o.left,right:o.right,bottom:A-f*i/2,top:A+f*i/2}):d?(S=s.right-s.left,h=S/t,f=h/a,{left:s.left,right:s.right,bottom:c.y-f*i/2,top:c.y+f*i/2}):(S=o.right-o.left,h=S/t,f=h/a,{left:o.left,right:o.right,bottom:c.y-f*i/2,top:c.y+f*i/2});case"preserveY":return g?(x=s.right-s.left,E=s.top-s.bottom,C={x:s.left+x/2,y:s.bottom+E/2},y=x/E,f=E/i,h=f*a,{left:C.x-h*t/2,right:C.x+h*t/2,bottom:s.bottom,top:s.top}):d?(S=s.right-s.left,v=s.left+S/2,y=S/o.height,f=o.height/i,h=f*a,{left:v-h*t/2,right:v+h*t/2,bottom:o.bottom,top:o.top}):p?(M=s.top-s.bottom,f=M/i,h=f*a,{left:c.x-h*t/2,right:c.x+h*t/2,bottom:s.bottom,top:s.top}):(M=o.top-o.bottom,f=M/i,h=f*a,{left:c.x-h*t/2,right:c.x+h*t/2,bottom:o.bottom,top:o.top});default:return o}}function e0(r,e){for(var t in e)if(e.hasOwnProperty(t)&&e[t]===r)return!0;return!1}function x3(r){return e0(r,v3)}function w3(r){return e0(r,C3)}function XX(r){return e0(r,E3)}function Ahe(r){return e0(r,ZS)}function Vhe(r){return e0(r,S3)}var v3={OPEN:"OPEN",CROSS:"CROSS",POINT:"POINT"},C3={SOLID:"SOLID",DASHED:"DASHED",DOTTED:"DOTTED"},E3={NONE:"NONE",AUTO:"AUTO",X:"X",Y:"Y",XY:"XY"},ZS={POINTS:"POINTS",LINES:"LINES",POINTS_AND_LINES:"POINTS_AND_LINES"},S3={DEFAULT:"default",CENTER:"center",CENTER_AUTO:"center_auto",AUTO_CENTER:"auto_center",ABOVE:"above",ABOVE_LEFT:"above_left",ABOVE_RIGHT:"above_right",ABOVE_AUTO:"above_auto",BELOW:"below",BELOW_LEFT:"below_left",BELOW_RIGHT:"below_right",BELOW_AUTO:"below_auto",LEFT:"left",AUTO_LEFT:"auto_left",RIGHT:"right",AUTO_RIGHT:"auto_right"};function Lhe(r){return{id:r.id,type:r.type,columns:r.columns.map(Phe)}}function Phe(r){return{id:r.id,latex:r.latex,color:r.color,hidden:r.hidden,pointStyle:r.pointStyle,pointSize:r.pointSize,pointOpacity:r.pointOpacity,lineStyle:r.lineStyle,lineWidth:r.lineWidth,lineOpacity:r.lineOpacity,points:r.points,lines:r.lines,dragMode:r.dragMode,values:r.values.slice()}}function _he(r){var e=["latex","color","lineStyle","lineWidth","lineOpacity","pointStyle","pointSize","movablePointSize","pointOpacity","points","lines","fill","fillOpacity","hidden","secret","dragMode","label","showLabel","labelSize","labelOrientation","interactiveLabel","readonly"],t={id:r.id,type:r.type};return e.forEach(function(i){r.hasOwnProperty(i)&&(t[i]=r[i])}),r.hasOwnProperty("parametricDomain")&&(t.parametricDomain={min:r.parametricDomain.min,max:r.parametricDomain.max}),r.hasOwnProperty("parametricDomain3Du")&&(t.parametricDomain3Du={min:r.parametricDomain3Du.min,max:r.parametricDomain3Du.max}),r.hasOwnProperty("parametricDomain3Dv")&&(t.parametricDomain3Dv={min:r.parametricDomain3Dv.min,max:r.parametricDomain3Dv.max}),r.hasOwnProperty("parametricDomain3Dr")&&(t.parametricDomain3Dr={min:r.parametricDomain3Dr.min,max:r.parametricDomain3Dr.max}),r.hasOwnProperty("parametricDomain3Dphi")&&(t.parametricDomain3Dphi={min:r.parametricDomain3Dphi.min,max:r.parametricDomain3Dphi.max}),r.hasOwnProperty("polarDomain")&&(t.polarDomain={min:r.polarDomain.min,max:r.polarDomain.max}),r.hasOwnProperty("domain")&&(t.domain={min:r.domain.min,max:r.domain.max}),r.slider&&(r.slider.hardMin&&(t.sliderBounds=t.sliderBounds||{},t.sliderBounds.min=r.slider.min),r.slider.hardMax&&(t.sliderBounds=t.sliderBounds||{},t.sliderBounds.max=r.slider.max),r.slider.step&&(t.sliderBounds=t.sliderBounds||{},t.sliderBounds.step=r.slider.step),t.playing=!!r.slider.isPlaying),t}function Ohe(r){return{id:r.id,type:r.type,hidden:r.hidden,secret:r.secret}}function Rhe(r){return{id:r.id,type:r.type,hidden:r.hidden,secret:r.secret}}function Fhe(r){return{id:r.id,type:r.type,secret:r.secret}}function HA(r){switch(r.type){case"expression":return _he(r);case"table":return Lhe(r);case"folder":return Rhe(r);case"image":return Ohe(r);case"text":return Fhe(r);default:return r}}function Yw(r,e){return r.hasOwnProperty("id")?r.id+"":e.generateId()}function Nhe(r,e){var t={type:"expression",id:Yw(r,e)};if(t.type="expression",t.id=Yw(r,e),r.hasOwnProperty("latex")&&(t.latex=r.latex+""),r.hasOwnProperty("color")&&(t.color=r.color+""),r.hasOwnProperty("points")&&(t.points=!!r.points),r.hasOwnProperty("lines")&&(t.lines=!!r.lines),r.hasOwnProperty("style")&&(__dcg_shared_module_exports__['M'].warn("As of API v1.1 the 'style' property is deprecated and has been split into 'pointStyle' and 'lineStyle'."),x3(r.style)?t.pointStyle=r.style:w3(r.style)?t.lineStyle=r.style:__dcg_shared_module_exports__['M'].warn("Invalid style: '"+r.style+"'.")),r.hasOwnProperty("pointStyle")&&(x3(r.pointStyle)?t.pointStyle=r.pointStyle:__dcg_shared_module_exports__['M'].warn("Invalid pointStyle: '"+r.pointStyle+"'.")),r.hasOwnProperty("pointSize")&&(t.pointSize=""+r.pointSize),r.hasOwnProperty("movablePointSize")&&(t.movablePointSize=""+r.movablePointSize),r.hasOwnProperty("pointOpacity")&&(t.pointOpacity=""+r.pointOpacity),r.hasOwnProperty("lineStyle")&&(w3(r.lineStyle)?t.lineStyle=r.lineStyle:__dcg_shared_module_exports__['M'].warn("Invalid lineStyle: '"+r.lineStyle+"'.")),r.hasOwnProperty("lineWidth")&&(t.lineWidth=""+r.lineWidth),r.hasOwnProperty("lineOpacity")&&(t.lineOpacity=""+r.lineOpacity),r.hasOwnProperty("hidden")&&(t.hidden=!!r.hidden),r.hasOwnProperty("readonly")&&(t.readonly=!!r.readonly),r.hasOwnProperty("secret")&&(t.secret=!!r.secret),r.hasOwnProperty("sliderBounds")&&r.sliderBounds&&(t.slider={min:__dcg_shared_module_exports__['Nc'](r.sliderBounds.min),max:__dcg_shared_module_exports__['Nc'](r.sliderBounds.max),step:__dcg_shared_module_exports__['Nc'](r.sliderBounds.step)},t.slider.min&&(t.slider.hardMin=!0),t.slider.max&&(t.slider.hardMax=!0)),r.hasOwnProperty("playing")){let{playing:i}=r;typeof i!="boolean"?__dcg_shared_module_exports__['M'].warn(`Invalid value for 'playing'. Expected a boolean but got '${i}'.`):(t.slider||(t.slider={}),t.slider.isPlaying=i)}return r.hasOwnProperty("parametricDomain3Du")&&r.parametricDomain3Du&&(t.parametricDomain3Du={min:__dcg_shared_module_exports__['Nc'](r.parametricDomain3Du.min),max:__dcg_shared_module_exports__['Nc'](r.parametricDomain3Du.max)}),r.hasOwnProperty("parametricDomain3Dv")&&r.parametricDomain3Dv&&(t.parametricDomain3Dv={min:__dcg_shared_module_exports__['Nc'](r.parametricDomain3Dv.min),max:__dcg_shared_module_exports__['Nc'](r.parametricDomain3Dv.max)}),r.hasOwnProperty("parametricDomain3Dr")&&r.parametricDomain3Dr&&(t.parametricDomain3Dr={min:__dcg_shared_module_exports__['Nc'](r.parametricDomain3Dr.min),max:__dcg_shared_module_exports__['Nc'](r.parametricDomain3Dr.max)}),r.hasOwnProperty("parametricDomain3Dphi")&&r.parametricDomain3Dphi&&(t.parametricDomain3Dphi={min:__dcg_shared_module_exports__['Nc'](r.parametricDomain3Dphi.min),max:__dcg_shared_module_exports__['Nc'](r.parametricDomain3Dphi.max)}),r.hasOwnProperty("parametricDomain")&&r.parametricDomain?(t.parametricDomain={min:__dcg_shared_module_exports__['Nc'](r.parametricDomain.min),max:__dcg_shared_module_exports__['Nc'](r.parametricDomain.max)},r.hasOwnProperty("domain")&&__dcg_shared_module_exports__['M'].warn("Both 'parametricDomain' and the deprecated 'domain' property were specified. Using 'parametricDomain'.")):r.hasOwnProperty("domain")&&(__dcg_shared_module_exports__['M'].warn("The 'domain' property is deprecated.Use 'parametricDomain' to specify the domain for parametric functions"),t.parametricDomain={min:__dcg_shared_module_exports__['Nc'](r.domain.min),max:__dcg_shared_module_exports__['Nc'](r.domain.max)}),r.hasOwnProperty("polarDomain")&&r.polarDomain&&(t.polarDomain={min:__dcg_shared_module_exports__['Nc'](r.polarDomain.min),max:__dcg_shared_module_exports__['Nc'](r.polarDomain.max)}),r.hasOwnProperty("dragMode")&&(XX(r.dragMode)?t.dragMode=r.dragMode:__dcg_shared_module_exports__['M'].warn("Invalid dragMode: '"+r.dragMode+"'.")),r.hasOwnProperty("label")&&(t.label=r.label+""),r.hasOwnProperty("showLabel")&&(t.showLabel=!!r.showLabel),r.hasOwnProperty("showAngleLabel")&&(t.showAngleLabel=!!r.showAngleLabel),r.hasOwnProperty("labelSize")&&(typeof r.labelSize=="string"?t.labelSize=r.labelSize:__dcg_shared_module_exports__['M'].warn("Invalid labelSize: "+r.labelSize)),r.hasOwnProperty("labelOrientation")&&(Vhe(r.labelOrientation)?t.labelOrientation=r.labelOrientation:__dcg_shared_module_exports__['M'].warn("Invalid labelOrientation: "+r.labelOrientation)),r.hasOwnProperty("fill")&&(t.fill=!!r.fill),r.hasOwnProperty("fillOpacity")&&(t.fillOpacity=""+r.fillOpacity),t}function Bhe(r,e){var t={id:Yw(r,e)};return r.hasOwnProperty("latex")&&(t.latex=r.latex+""),r.hasOwnProperty("color")&&(t.color=r.color+""),r.hasOwnProperty("hidden")&&(t.hidden=!!r.hidden),r.hasOwnProperty("points")&&(t.points=!!r.points),r.hasOwnProperty("lines")&&(t.lines=!!r.lines),r.hasOwnProperty("values")&&r.values&&(t.values=r.values.map(function(i){return i+""})),r.hasOwnProperty("pointStyle")&&(x3(r.pointStyle)?t.pointStyle=r.pointStyle:__dcg_shared_module_exports__['M'].warn("Invalid pointStyle: '"+r.pointStyle+"'.")),r.hasOwnProperty("pointSize")&&(t.pointSize=""+r.pointSize),r.hasOwnProperty("pointOpacity")&&(t.pointOpacity=""+r.pointOpacity),r.hasOwnProperty("lineStyle")&&(w3(r.lineStyle)?t.lineStyle=r.lineStyle:__dcg_shared_module_exports__['M'].warn("Invalid lineStyle: '"+r.lineStyle+"'.")),r.hasOwnProperty("lineWidth")&&(t.lineWidth=""+r.lineWidth),r.hasOwnProperty("lineOpacity")&&(t.lineOpacity=""+r.lineOpacity),r.hasOwnProperty("columnMode")&&(__dcg_shared_module_exports__['M'].warn("As of API v1.1 the 'columnMode' property is deprecated and has been split into individual 'points' and 'lines' properties."),r.columnMode===ZS.POINTS_AND_LINES?(t.points=!0,t.lines=!0):r.columnMode===ZS.LINES?(t.points=!1,t.lines=!0):(t.points=!0,t.lines=!1),t.lines&&!t.points&&r.hasOwnProperty("dragMode")&&r.dragMode!=="NONE"&&(__dcg_shared_module_exports__['M'].warn("A 'lines' value of true and 'points' value of false is only compatible with a dragMode of 'NONE'. Proceeding by setting 'points' to true."),t.points=!0),Ahe(r.columnMode)&&__dcg_shared_module_exports__['M'].warn("Invalid columnMode: '"+r.columnMode+"'.")),r.hasOwnProperty("dragMode")&&(XX(r.dragMode)?t.dragMode=r.dragMode==="AUTO"?"NONE":r.dragMode:__dcg_shared_module_exports__['M'].warn("Invalid dragMode: '"+r.dragMode+"'.")),t}function Uhe(r,e){var t={type:"table",id:Yw(r,e)};return r.hasOwnProperty("columns")&&r.columns&&(t.columns=r.columns.map(function(i){return Bhe(i,e)})),t}function zhe(r,e){var t={type:"folder",id:Yw(r,e)};return r.hasOwnProperty("hidden")&&(t.hidden=!!r.hidden),t}function Khe(r,e){var t={type:"image",id:Yw(r,e)};return r.hasOwnProperty("hidden")&&(t.hidden=!!r.hidden),t}function WA(r,e,t){var i=r.type;if(e&&i&&i!==e){__dcg_shared_module_exports__['M'].warn("Cannot change type of expression from '"+e+"' to '"+i+"'.");return}switch(i){case void 0:case"expression":return Nhe(r,t);case"image":return Khe(r,t);case"table":return Uhe(r,t);case"folder":return zhe(r,t);default:if(e){__dcg_shared_module_exports__['M'].warn("Cannot modify expressions of type: '"+e+"' through the API.");return}else{__dcg_shared_module_exports__['M'].warn("Invalid expression type: '"+i+"'.");return}}}var $A=class{constructor(e){this.mq=e,this.id=e.id,this.data=e.data}simulateUserChangedLatex(){Ze.simulateUserChangedLatex(this.mq)}simulateKeypress(e){Ze.simulateKeypress(this.mq,e)}config(e){return this.mq.config(e),this}latex(e){return e===void 0?this.mq.latex():(this.mq.latex(e),this.simulateUserChangedLatex(),this)}reflow(){this.mq.reflow()}el(){return this.mq.el()}getAriaLabel(){return this.mq.getAriaLabel()}setAriaLabel(e){return this.mq.setAriaLabel(e)}html(){return this.mq.html()}mathspeak(){return this.mq.mathspeak()}text(){return this.mq.text()}selection(){return this.mq.selection()}select(){return this.mq.select(),this}moveToRightEnd(){return this.mq.moveToRightEnd(),this}moveToLeftEnd(){return this.mq.moveToLeftEnd(),this}cmd(e){return this.mq.cmd(e),this.simulateUserChangedLatex(),this}write(e){return this.mq.write(e),this.simulateUserChangedLatex(),this}keystroke(e){return this.simulateKeypress(e),this}typedText(e){return this.mq.typedText(e),this.simulateUserChangedLatex(),this}clearSelection(){return this.mq.clearSelection(),this}getAriaPostLabel(){return this.mq.getAriaPostLabel()}setAriaPostLabel(e,t){return this.mq.setAriaPostLabel(e,t),this}blur(){return this.mq.blur(),this}focus(){return this.mq.focus(),this}revert(){return this.mq.revert()}ignoreNextMousedown(e){return this.mq.ignoreNextMousedown(e),this}clickAt(e,t,i){return this.mq.clickAt(e,t,i),this}};Rc();function qhe(r){function e(t){requestAnimationFrame(e),r(t)}requestAnimationFrame(e)}function Hhe(r){function e(){setTimeout(e,Xw),r(Date.now())}setTimeout(e,Xw)}var JX=tn().timeoutLoop,Xw=0;typeof JX=="string"&&(Xw=parseFloat(JX),isNaN(Xw)&&(Xw=1e3/60));var QX=Xw>0?Hhe:qhe;var k3=new Yr;QX(function(r){k3.triggerEvent("tick",r)});var D3=0;function Il(r){return D3+=1,k3.observeEvent("tick."+D3,function(e,t){r(t)}),D3}function Al(r){k3.unobserveEvent("tick."+r)}af();var ZX=oh(location.search,"nworkers"),eJ=4;ZX&&(eJ=parseInt(ZX,10));var Jw=new Ww(eJ);var jA={};__dcg_shared_module_exports__['d'](jA,{LARGE:()=>jhe,MEDIUM:()=>G3,SMALL:()=>$he,VERY_LARGE:()=>Yhe,VERY_SMALL:()=>Whe});var Whe=9,$he=12,G3=16,jhe=20,Yhe=24;var Ot=function(r,e,t){var i=document.createElement("img"),o,n;if(i.onerror=e,i.onload=function(){n&&!(t&&t.noRevoke)&&Ot.revokeObjectURL(n),e&&e(Ot.scale(i,t))},Ot.isInstanceOf("Blob",r)||Ot.isInstanceOf("File",r))o=n=Ot.createObjectURL(r),i._type=r.type;else if(typeof r=="string")o=r,t&&t.crossOrigin&&(i.crossOrigin=t.crossOrigin);else return!1;return o?(i.src=o,i):Ot.readFile(r,function(a){var s=a.target;s&&s.result?i.src=s.result:e&&e(a)})},YA=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;Ot.isInstanceOf=function(r,e){return Object.prototype.toString.call(e)==="[object "+r+"]"};Ot.transformCoordinates=function(){};Ot.getTransformedOptions=function(r){return r};Ot.renderImageToCanvas=function(r,e,t,i,o,n,a,s,l,c){return r.getContext("2d").drawImage(e,t,i,o,n,a,s,l,c),r};Ot.hasCanvasOption=function(r){return r.canvas||r.crop};Ot.scale=function(r,e){e=e||{};var t=document.createElement("canvas"),i=r.getContext||Ot.hasCanvasOption(e)&&t.getContext,o=r.naturalWidth||r.width,n=r.naturalHeight||r.height,a=o,s=n,l,c,d,p,g,h,f,y,x,E=function(){var S=Math.max((d||a)/a,(p||s)/s);S>1&&(a=Math.ceil(a*S),s=Math.ceil(s*S))},C=function(){var S=Math.min((l||a)/a,(c||s)/s);S<1&&(a=Math.ceil(a*S),s=Math.ceil(s*S))};return i&&(e=Ot.getTransformedOptions(e),f=e.left||0,y=e.top||0,e.sourceWidth?(g=e.sourceWidth,e.right!==void 0&&e.left===void 0&&(f=o-g-e.right)):g=o-f-(e.right||0),e.sourceHeight?(h=e.sourceHeight,e.bottom!==void 0&&e.top===void 0&&(y=n-h-e.bottom)):h=n-y-(e.bottom||0),a=g,s=h),l=e.maxWidth,c=e.maxHeight,d=e.minWidth,p=e.minHeight,i&&l&&c&&e.crop?(a=l,s=c,x=g/h-l/c,x<0?(h=c*g/l,e.top===void 0&&e.bottom===void 0&&(y=(n-h)/2)):x>0&&(g=l*h/c,e.left===void 0&&e.right===void 0&&(f=(o-g)/2))):((e.contain||e.cover)&&(d=l=l||d,p=c=c||p),e.cover?(C(),E()):(E(),C())),i?(t.width=a,t.height=s,Ot.transformCoordinates(t,e),Ot.renderImageToCanvas(t,r,f,y,g,h,0,0,a,s)):(r.width=a,r.height=s,r)};Ot.createObjectURL=function(r){return YA?YA.createObjectURL(r):!1};Ot.revokeObjectURL=function(r){return YA?YA.revokeObjectURL(r):!1};Ot.readFile=function(r,e,t){if(window.FileReader){var i=new FileReader;if(i.onload=i.onerror=e,t=t||"readAsDataURL",i[t])return i[t](r),i}return!1};(!window.navigator||!window.navigator.platform||!/iP(hone|od|ad)/.test(window.navigator.platform))&&(tJ=Ot.renderImageToCanvas,Ot.detectSubsampling=function(r){var e,t;return r.width*r.height>1024*1024?(e=document.createElement("canvas"),e.width=e.height=1,t=e.getContext("2d"),t.drawImage(r,-r.width+1,0),t.getImageData(0,0,1,1).data[3]===0):!1},Ot.detectVerticalSquash=function(r,e){var t=r.naturalHeight||r.height,i=document.createElement("canvas"),o=i.getContext("2d"),n,a,s,l,c;for(e&&(t/=2),i.width=1,i.height=t,o.drawImage(r,0,0),n=o.getImageData(0,0,1,t).data,a=0,s=t,l=t;l>a;)c=n[(l-1)*4+3],c===0?s=l:a=l,l=s+a>>1;return l/t||1},Ot.renderImageToCanvas=function(r,e,t,i,o,n,a,s,l,c){if(e._type==="image/jpeg"){var d=r.getContext("2d"),p=document.createElement("canvas"),g=1024,h=p.getContext("2d"),f,y,x,E;if(p.width=g,p.height=g,d.save(),f=Ot.detectSubsampling(e),f&&(t/=2,i/=2,o/=2,n/=2),y=Ot.detectVerticalSquash(e,f),f||y!==1){for(i*=y,l=Math.ceil(g*l/o),c=Math.ceil(g*c/n/y),s=0,E=0;E<n;){for(a=0,x=0;x<o;)h.clearRect(0,0,g,g),h.drawImage(e,t,i,o,n,-x,-E,o,n),d.drawImage(p,0,0,g,g,a,s,l,c),x+=g,a+=l;E+=g,s+=c}return d.restore(),r}}return tJ(r,e,t,i,o,n,a,s,l,c)});var tJ,Xhe=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);Ot.blobSlice=Xhe&&function(){var r=this.slice||this.webkitSlice||this.mozSlice;return r.apply(this,arguments)};Ot.metaDataParsers={jpeg:{65505:[]}};Ot.parseMetaData=function(r,e,t){t=t||{};var i=this,o=t.maxMetaDataSize||262144,n={},a=!(window.DataView&&r&&r.size>=12&&r.type==="image/jpeg"&&Ot.blobSlice);(a||!Ot.readFile(Ot.blobSlice.call(r,0,o),function(s){var l=s.target.result,c=new DataView(l),d=2,p=c.byteLength-4,g=d,h,f,y,x;if(c.getUint16(0)===65496){for(;d<p&&(h=c.getUint16(d),h>=65504&&h<=65519||h===65534);){if(f=c.getUint16(d+2)+2,d+f>c.byteLength){console.log("Invalid meta data: Invalid segment size.");break}if(y=Ot.metaDataParsers.jpeg[h],y)for(x=0;x<y.length;x+=1)y[x].call(i,c,d,f,n,t);d+=f,g=d}!t.disableImageHead&&g>6&&(l.slice?n.imageHead=l.slice(0,g):n.imageHead=new Uint8Array(l).subarray(0,g))}else console.log("Invalid JPEG file: Missing JPEG marker.");e(n)},"readAsArrayBuffer"))&&e(n)};var Jhe=Ot.hasCanvasOption;Ot.hasCanvasOption=function(r){return Jhe(r)||r.orientation};Ot.transformCoordinates=function(r,e){var t=r.getContext("2d"),i=r.width,o=r.height,n=e.orientation;if(n)switch(n>4&&(r.width=o,r.height=i),n){case 2:t.translate(i,0),t.scale(-1,1);break;case 3:t.translate(i,o),t.rotate(Math.PI);break;case 4:t.translate(0,o),t.scale(1,-1);break;case 5:t.rotate(.5*Math.PI),t.scale(1,-1);break;case 6:t.rotate(.5*Math.PI),t.translate(0,-o);break;case 7:t.rotate(.5*Math.PI),t.translate(i,-o),t.scale(-1,1);break;case 8:t.rotate(-.5*Math.PI),t.translate(-i,0);break}};Ot.getTransformedOptions=function(r){if(!r.orientation||r.orientation===1)return r;var e={},t;for(t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);switch(r.orientation){case 2:e.left=r.right,e.right=r.left;break;case 3:e.left=r.right,e.top=r.bottom,e.right=r.left,e.bottom=r.top;break;case 4:e.top=r.bottom,e.bottom=r.top;break;case 5:e.left=r.top,e.top=r.left,e.right=r.bottom,e.bottom=r.right;break;case 6:e.left=r.top,e.top=r.right,e.right=r.bottom,e.bottom=r.left;break;case 7:e.left=r.bottom,e.top=r.right,e.right=r.top,e.bottom=r.left;break;case 8:e.left=r.bottom,e.top=r.left,e.right=r.top,e.bottom=r.right;break}return r.orientation>4&&(e.maxWidth=r.maxHeight,e.maxHeight=r.maxWidth,e.minWidth=r.minHeight,e.minHeight=r.minWidth,e.sourceWidth=r.sourceHeight,e.sourceHeight=r.sourceWidth),e};Ot.ExifMap=function(){return this};Ot.ExifMap.prototype.map={Orientation:274};Ot.ExifMap.prototype.get=function(r){return this[r]||this[this.map[r]]};Ot.getExifThumbnail=function(r,e,t){var i,o,n;if(!t||e+t>r.byteLength){console.log("Invalid Exif data: Invalid thumbnail data.");return}for(i=[],o=0;o<t;o+=1)n=r.getUint8(e+o),i.push((n<16?"0":"")+n.toString(16));return"data:image/jpeg,%"+i.join("%")};Ot.exifTagTypes={1:{getValue:function(r,e){return r.getUint8(e)},size:1},2:{getValue:function(r,e){return String.fromCharCode(r.getUint8(e))},size:1,ascii:!0},3:{getValue:function(r,e,t){return r.getUint16(e,t)},size:2},4:{getValue:function(r,e,t){return r.getUint32(e,t)},size:4},5:{getValue:function(r,e,t){return r.getUint32(e,t)/r.getUint32(e+4,t)},size:8},9:{getValue:function(r,e,t){return r.getInt32(e,t)},size:4},10:{getValue:function(r,e,t){return r.getInt32(e,t)/r.getInt32(e+4,t)},size:8}};Ot.exifTagTypes[7]=Ot.exifTagTypes[1];Ot.getExifValue=function(r,e,t,i,o,n){var a=Ot.exifTagTypes[i],s,l,c,d,p,g;if(!a){console.log("Invalid Exif data: Invalid tag type.");return}if(s=a.size*o,l=s>4?e+r.getUint32(t+8,n):t+8,l+s>r.byteLength){console.log("Invalid Exif data: Invalid data offset.");return}if(o===1)return a.getValue(r,l,n);for(c=[],d=0;d<o;d+=1)c[d]=a.getValue(r,l+d*a.size,n);if(a.ascii){for(p="",d=0;d<c.length&&(g=c[d],g!=="\0");d+=1)p+=g;return p}return c};Ot.parseExifTag=function(r,e,t,i,o){var n=r.getUint16(t,i);o.exif[n]=Ot.getExifValue(r,e,t,r.getUint16(t+2,i),r.getUint32(t+4,i),i)};Ot.parseExifTags=function(r,e,t,i,o){var n,a,s;if(t+6>r.byteLength){console.log("Invalid Exif data: Invalid directory offset.");return}if(n=r.getUint16(t,i),a=t+2+12*n,a+4>r.byteLength){console.log("Invalid Exif data: Invalid directory size.");return}for(s=0;s<n;s+=1)this.parseExifTag(r,e,t+2+12*s,i,o);return r.getUint32(a,i)};Ot.parseExifData=function(r,e,t,i,o){if(!o.disableExif){var n=e+10,a,s,l;if(r.getUint32(e+4)===1165519206){if(n+8>r.byteLength){console.log("Invalid Exif data: Invalid segment size.");return}if(r.getUint16(e+8)!==0){console.log("Invalid Exif data: Missing byte alignment offset.");return}switch(r.getUint16(n)){case 18761:a=!0;break;case 19789:a=!1;break;default:console.log("Invalid Exif data: Invalid byte alignment marker.");return}if(r.getUint16(n+2,a)!==42){console.log("Invalid Exif data: Missing TIFF marker.");return}s=r.getUint32(n+4,a),i.exif=new Ot.ExifMap,s=Ot.parseExifTags(r,n,n+s,a,i),s&&!o.disableExifThumbnail&&(l={exif:{}},s=Ot.parseExifTags(r,n,n+s,a,l),l.exif[513]&&(i.exif.Thumbnail=Ot.getExifThumbnail(r,n+l.exif[513],l.exif[514]))),i.exif[34665]&&!o.disableExifSub&&Ot.parseExifTags(r,n,n+i.exif[34665],a,i),i.exif[34853]&&!o.disableExifGps&&Ot.parseExifTags(r,n,n+i.exif[34853],a,i)}}};Ot.metaDataParsers.jpeg[65505].push(Ot.parseExifData);Ot.ExifMap.prototype.tags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"};Ot.ExifMap.prototype.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"top-left",2:"top-right",3:"bottom-right",4:"bottom-left",5:"left-top",6:"right-top",7:"right-bottom",8:"left-bottom"}};Ot.ExifMap.prototype.getText=function(r){var e=this.get(r);switch(r){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[r][e];case"ExifVersion":case"FlashpixVersion":return String.fromCharCode(e[0],e[1],e[2],e[3]);case"ComponentsConfiguration":return this.stringValues[r][e[0]]+this.stringValues[r][e[1]]+this.stringValues[r][e[2]]+this.stringValues[r][e[3]];case"GPSVersionID":return e[0]+"."+e[1]+"."+e[2]+"."+e[3]}return String(e)};(function(r){var e=r.tags,t=r.map,i;for(i in e)e.hasOwnProperty(i)&&(t[e[i]]=i)})(Ot.ExifMap.prototype);Ot.ExifMap.prototype.getAll=function(){var r={},e,t;for(e in this)this.hasOwnProperty(e)&&(t=this.tags[e],t&&(r[t]=this.getText(t)));return r};function rJ(r,e){for(var t=[.92,.86,.8,.7,.6,.5,.4,.3,.2,.1],i,o=0;o<t.length;o++)if(i=r.toDataURL("image/jpeg",t[o]),i.length<e)return i;return i}function Qhe(r,e){for(var t=r.toDataURL().length,i=r.width,o=r.height,n=document.createElement("canvas"),a,s=0;s<2;s++){var l=Math.sqrt(e/t);i=Math.round(l*i),o=Math.round(l*o),n.height=o,n.width=i;var c=n.getContext("2d");if(c.drawImage(r,0,0,i,o),a=n.toDataURL(),t=a.length,t<e)return a}return a}function Zhe(r){for(var e=r.getContext("2d"),t=e.getImageData(0,0,r.width,r.height).data,i=3;i<t.length;i+=4)if(t[i]!==255)return!0;return!1}function XA(r,e){var t={orientation:!0,canvas:!0,maxWidth:1600,maxHeight:1600};Ot(r,function(i){if(!i.toDataURL){e(!0);return}var o=2e5,n;if(r.type==="image/jpeg")n=rJ(i,o);else if(n=i.toDataURL(),n.length>o){var a=n.length>.75*i.width*i.height,s=a&&!Zhe(i);n=s?rJ(i,o):Qhe(i,o)}e(null,n)},t)}var T3={keypad:!0,graphpaper:!0,expressions:!0,settingsMenu:!0,zoomButtons:!0,showResetButtonOnGraphpaper:!1,expressionsTopbar:!0,capExpressionSize:!1,pointsOfInterest:!0,trace:!0,border:!0,lockViewport:!1,expressionsCollapsed:!1,authorFeatures:!1,authorMode:!0,advancedStyling:!1,images:!0,imageUploadCallback:XA,folders:!0,notes:!0,sliders:!0,links:!0,qwertyKeyboard:!0,restrictedFunctions:!1,forceEnableGeometryFunctions:!1,pasteGraphLink:!1,pasteTableData:!0,degreeMode:!1,clearIntoDegreeMode:!1,autosize:!0,plotSingleVariableImplicitEquations:!0,plotImplicits:!0,plotInequalities:!0,colors:{RED:BG,BLUE:UG,GREEN:zG,ORANGE:qG,PURPLE:KG,BLACK:HG},invertedColors:!1,functionDefinition:!0,projectorMode:!1,decimalToFraction:!0,fontSize:16,language:"en",backgroundColor:"#fff",textColor:"#000",distributions:!0,brailleMode:"none",sixKeyInput:!1,brailleControls:!0,graphDescription:void 0,zoomFit:!0,forceLogModeRegressions:!1,actions:"auto",audio:!0,logScales:!0,translucentSurfaces:!1,perspectiveDistortion:1,showKeyboardShortcutsInTooltips:!1,tone:!0,showPerformanceMeter:!1},iJ=Object.keys(T3),oJ={product:"graphing",showHamburger:!1,disableScrollFix:!1,branding:!0,onlyTraceSelected:!1,disableMouseInteractions:!1,nativeOnscreenKeypad:!1,plaidMode:!1,wireframe:!1,pasteGraphLinkCallback:void 0,editOnWeb:!1,crossOriginSaveTest:!1,enableTabindex:!0,audioTraceReverseExpressions:!1,transparentBackground:!1,pauseWhenOffscreen:!1,hideGeoUI:!1,substitutions:!0,intervalComprehensions:!0,recursion:!1,beta3d:!1,cacheRenderedSvgs:!1,ghostMode:!1},ege={solutions:!0,menus:!0,singleVariableSolutions:!0,clickableObjects:!1,administerSecretFolders:!1},JA={...T3,...oJ};function nJ(r){return!!(T3.hasOwnProperty(r)||oJ.hasOwnProperty(r)||ege.hasOwnProperty(r))}function QA(r){var e=__dcg_shared_module_exports__['Z'](JA);for(var t in r)e.hasOwnProperty(t)&&(e[t]=r[t]);return __dcg_shared_module_exports__['O'](e.backgroundColor)||(e.backgroundColor=JA.backgroundColor,__dcg_shared_module_exports__['M'].warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)")),__dcg_shared_module_exports__['O'](e.textColor)||(e.textColor=JA.textColor,__dcg_shared_module_exports__['M'].warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)")),e.actions!==!0&&e.actions!==!1&&e.actions!=="auto"&&(e.actions=JA.actions,__dcg_shared_module_exports__['M'].warn("Invalid actions setting. Must be true, false, or 'auto'.")),r.zoomButtons===void 0&&(!e.graphpaper||e.lockViewport)&&(e.zoomButtons=!1),r.images===void 0&&(e.graphpaper||(e.images=!1)),r.hasOwnProperty("menus")&&(__dcg_shared_module_exports__['M'].warn("As of API version 0.4, the 'menus' option is deprecated and has been split into 'settingsMenu' (boolean) and 'expressionsTopbar' (boolean)."),r.hasOwnProperty("settingsMenu")||(e.settingsMenu=!!r.menus),r.hasOwnProperty("expressionsTopbar")||(e.expressionsTopbar=!!r.menus)),r.hasOwnProperty("solutions")&&(__dcg_shared_module_exports__['M'].warn("As of API v1.0, the 'solutions' option is deprecated and has been replaced with 'pointsOfInterest' (boolean)."),r.hasOwnProperty("pointsOfInterest")||(e.pointsOfInterest=!!r.solutions)),r.hasOwnProperty("singleVariableSolutions")&&__dcg_shared_module_exports__['M'].warn("As of API v1.0, the 'singleVariableSolutions' has been removed. The calculator no longer displays solutions to single variable equations."),r.hasOwnProperty("clickableObjects")&&(__dcg_shared_module_exports__['M'].warn("As of API v1.7, the 'clickableObjects' option is deprecated and has been replaced with 'actions'."),r.clickableObjects===!0&&!r.hasOwnProperty("actions")&&(e.actions=!0)),r.hasOwnProperty("administerSecretFolders")&&(__dcg_shared_module_exports__['M'].warn("As of API v1.8, the 'administerSecretFolders' option is deprecated and has been subsumed under 'authorFeatures'."),r.administerSecretFolders===!0&&!r.hasOwnProperty("authorFeatures")&&(e.authorFeatures=!0)),e.graphpaper||(e.expressionsCollapsed&&(e.expressionsCollapsed=!1,__dcg_shared_module_exports__['M'].warn("Desmos API initialized with bad options. graphpaper: false and expressionsCollapsed: true are incompatible. Proceeding with expressionsCollapsed: false.")),e.zoomButtons&&(e.zoomButtons=!1,__dcg_shared_module_exports__['M'].warn("Desmos API initialized with bad options. graphpaper: false and zoomButtons: true are incompatible. Proceeding with zoomButtons: false.")),e.showResetButtonOnGraphpaper&&(e.showResetButtonOnGraphpaper=!1,__dcg_shared_module_exports__['M'].warn("Desmos API initialized with bad options. graphpaper: false and showResetButtonOnGraphpaper: true are incompatible. Proceeding with showResetButtonOnGraphpaper: false."))),e.lockViewport&&e.zoomButtons&&(e.zoomButtons=!1,__dcg_shared_module_exports__['M'].warn("Desmos API initialized with bad options. lockViewport: true and zoomButtons: true are incompatible. Proceeding with zoomButtons: false.")),(e.notes===!1||e.folders===!1||e.images===!1)&&e.pasteGraphLink===!0&&(e.pasteGraphLink=!1,__dcg_shared_module_exports__['M'].warn("Desmos API initialized with bad options. pasteGraphLink: true is incompatible with disabling the creation of note, folder, or image expressions. Proceeding with pasteGraphLink: false.")),e.language&&(e.language=Cu(e.language)),e}function aJ(r,e){var t={},i={};for(var o in r)nJ(o)?t[o]=r[o]:SU(o)?i[o]=r[o]:e||__dcg_shared_module_exports__['M'].warn("Unrecognized setting: "+o+". Ignoring.");return{configOptions:t,settingsOptions:i}}function sJ(r,e){var t={};return e.hasOwnProperty("x")&&(t.x=r.mapX(e.x)),e.hasOwnProperty("y")&&(t.y=r.mapY(e.y)),t}var cJ=[],M3=!1,lJ=new Map;function tge(r){let e=lJ.get(r);return e||(e=new r,lJ.set(r,e)),e}function dJ(r){if(!r||M3)return;let e;for(;(e=cJ.shift())&&e.api._destroyed;);if(!e)return;let t=e;M3=!0;let{options:i,mathBounds:o,state:n,callback:a}=t;var s=tge(r);s.setState(n),s.setMathBounds(o),["majorAxisOpacity","minorAxisOpacity","axisLineOffset","axisLineWidth","labelSize","graphLineWidth","pointLineWidth"].forEach(h=>{h==="axisLineWidth"?s._calc.grapher.settings.setProperty(h,t.api._calc.grapher.settings[h]):s._calc.grapher.settings[h]=t.api._calc.grapher.settings[h]});var c=s._calc.evaluator,d=()=>{s._calc.grapher.asyncScreenshot(i,h=>{M3=!1,dJ(r),a(h)})},p=t.api._calc.controller,g=Il(function(){p.areAnyImagesLoading()||(Al(g),c.notifyWhenSynced(d))})}var zh=class extends Yr{constructor(t,i,o){super();this._destroyed=!1;this.isOffscreen=!1;var n=aJ(i||{},!0),a=QA(n.configOptions),s=n.settingsOptions;this._calc=new XS(t,Jw,a),this.controller=this._calc.controller,this.controller.onEventsEmitted=l=>{let c=this.controller.getSelectedItem();this.setProperty("isAnyExpressionSelected",!!c),this.setProperty("selectedExpressionId",c?c.id:void 0),this.setProperty("expressionAnalysis",this.controller.getExpressionAnalysis());var d=Ze.getFocusedMathquill();this.setProperty("focusedMathQuill",d?new $A(d):void 0);for(var p in l){if(!l.hasOwnProperty(p))continue;let g=l[p];g&&this.triggerEvent(p,g)}},this._calc.graphpaperBounds.observeAndSync("mathCoordinates",this._syncGraphpaperBounds.bind(this)),this._calc.graphpaperBounds.observeAndSync("pixelCoordinates",this._syncGraphpaperBounds.bind(this)),this.colors=this.controller.getColors(),this._initGraphSettings(),this.updateSettings(s),this._sharedClockBusToken=Il(l=>this.withControllerInAPIMode(()=>{var c=this._calc.grapher.settings.config.pauseWhenOffscreen&&this.isOffscreen;this._calc.tick(l,c)})),this.domChangeDetector=new Cb(t,l=>this.withControllerInAPIMode(()=>{switch(this.isOffscreen=l.isOffscreen,l.type){case"offscreen-noop":break;case"added":this._calc.resize(l.size);break;case"removed":break;case"resized":this._calc.resize(l.size);break}})),a.autosize?this.domChangeDetector.startWatching():this.domChangeDetector.checkForChanges(),typeof o=="function"&&o(this)}destroy(){this.controller.onEventsEmitted=function(){},this._calc.destroy(),Al(this._sharedClockBusToken),this.domChangeDetector.destroy();function t(a){__dcg_shared_module_exports__['M'].warn("You've destroyed this API instance. You can no longer call ."+a+"()")}for(var i={},o=this;o;)Object.getOwnPropertyNames(o).forEach(s=>i[s]=!0),o=Object.getPrototypeOf(o);for(var n in i)typeof this[n]=="function"?this[n]=t.bind(this,n):this.hasOwnProperty(n)&&delete this[n];this.destroy=function(){},this._destroyed=!0}withHistoryReplacement(t){try{this.controller.pushWithHistoryReplacement(),t()}finally{this.controller.popWithHistoryReplacement()}}withControllerInAPIMode(t){try{return this.controller.pushAPIMethodCall(),t()}finally{this.controller.popAPIMethodCall()}}_syncGraphpaperBounds(){return this.withControllerInAPIMode(()=>{this.controller.runAfterDispatch(()=>{this.setProperty("graphpaperBounds",{mathCoordinates:this._calc.graphpaperBounds.mathCoordinates,pixelCoordinates:this._calc.graphpaperBounds.pixelCoordinates})})})}_initGraphSettings(){return this.withControllerInAPIMode(()=>{var t=new Yr;this.settings=this.graphSettings=t,EU.forEach(i=>{this._calc.grapher.settings.observeAndSync(i,()=>{this.controller.runAfterDispatch(()=>{t.setProperty(i,this._calc.grapher.settings[i])})})}),iJ.forEach(i=>{this._calc.grapher.settings.config.observeAndSync(i,()=>{this.controller.runAfterDispatch(()=>{t.setProperty(i,this._calc.grapher.settings.config[i])})})})})}updateSettings(t){return this.withControllerInAPIMode(()=>{var i=aJ(t,!1),o=i.configOptions,n=i.settingsOptions;__dcg_shared_module_exports__['F'](o)||this._calc.setOptions(o),__dcg_shared_module_exports__['F'](n)||this.controller.dispatch({type:"set-graph-settings",...this.controller.getGraphSettings().validateSettings(n)}),this.notifyControllerOfAPICall()})}setGraphSettings(t){return this.withControllerInAPIMode(()=>{__dcg_shared_module_exports__['M'].warn("As of API v0.8 the 'setGraphSettings' method is deprecated and has been renamed 'updateSettings.'"),this.updateSettings(t),this.setGraphSettings=this.updateSettings,this.notifyControllerOfAPICall()})}setDefaultState(t){return this.withControllerInAPIMode(()=>{this._calc.grapher.settings.setProperty("defaultState",t),this.notifyControllerOfAPICall()})}mathToPixels(t){return this.withControllerInAPIMode(()=>{var i=__dcg_shared_module_exports__['_c'].fromRects(this.graphpaperBounds.mathCoordinates,this.graphpaperBounds.pixelCoordinates,{xAxisScale:this._calc.grapher.settings.xAxisScale,yAxisScale:this._calc.grapher.settings.yAxisScale});return sJ(i,t)})}pixelsToMath(t){return this.withControllerInAPIMode(()=>{var i=__dcg_shared_module_exports__['_c'].fromRects(this.graphpaperBounds.mathCoordinates,this.graphpaperBounds.pixelCoordinates,{xAxisScale:this._calc.grapher.settings.xAxisScale,yAxisScale:this._calc.grapher.settings.yAxisScale}).inverse();return sJ(i,t)})}notifyControllerOfAPICall(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"render"})})}setExpression(t){return this.withControllerInAPIMode(()=>{var i=this.controller,o=i.getItemModel(t.id),n=o&&o.type,a=WA(t,n,this.controller);if(a)if(n)this.controller.dispatch({type:"set-expression-properties-from-api",id:a.id,properties:a});else{if(a.type==="image")return;this.controller.dispatch({type:"add-item-to-end-from-api",state:a})}})}setExpressions(t){return this.withControllerInAPIMode(()=>{t.forEach(this.setExpression.bind(this))})}removeExpression(t){return this.withControllerInAPIMode(()=>{var i=t.id.toString();this.controller.dispatch({type:"remove-item-by-id",id:i})})}removeExpressions(t){return this.withControllerInAPIMode(()=>{t.forEach(this.removeExpression.bind(this))})}removeSelected(){return this.withControllerInAPIMode(()=>{var t=this.controller.getSelectedItem();if(!t)return;let{id:i}=t;return this.controller.dispatch({type:"remove-item-by-id",id:i}),i})}setMathBounds(t){return this.withControllerInAPIMode(()=>{t&&t.left<t.right&&t.bottom<t.top?(this._calc.setViewport([t.left,t.right,t.bottom,t.top]),this._calc.controller.unmarkLastChangedAxis(),this._calc.controller.markSquareAxesAfterUserEditedViewport()):__dcg_shared_module_exports__['M'].warn("Invalid bounds argument. Expected a bounds object with bounds.bottom < bounds.top, and bounds.left < bounds.right. Got "+JSON.stringify(t)),this.notifyControllerOfAPICall()})}setViewport(t){return this.withControllerInAPIMode(()=>{t.length==4&&t[1]>t[0]&&t[3]>t[2]?(this._calc.setViewport(t),this._calc.controller.markSquareAxesAfterUserEditedViewport()):__dcg_shared_module_exports__['M'].warn("Invalid viewport.  Expected [xmin, xmax, ymin, ymax].  Got "+t),this.notifyControllerOfAPICall()})}resize(){return this.withControllerInAPIMode(()=>{this.domChangeDetector.checkForChanges()})}getState(t){return this.withControllerInAPIMode(()=>this.controller.getState(t))}getExpressions(){return this.withControllerInAPIMode(()=>{var t=this.getState({stripDefaults:!1}).expressions.list;return t.map(HA)})}setBlank(t){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"set-blank",opts:t||{}})})}setState(t,i){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"set-state",state:t,opts:i||{}})})}undo(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"undo"})})}redo(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"redo"})})}clearHistory(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"clear-undoredo-history"})})}newRandomSeed(){return this.withControllerInAPIMode(()=>{this.updateSettings({randomSeed:Xp()})})}screenshot(t){return this.withControllerInAPIMode(()=>(t||(t={}),t=this._validateBrailleScreenshotOptions(t),this._calc.grapher.screenshot(t)))}_getMathAspectRatio(){return this.withControllerInAPIMode(()=>{var t=this.graphpaperBounds.mathCoordinates,i=this._calc.grapher.getProjection().pixelCoordinates,o=i.right-i.left,n=i.bottom-i.top,a=t.width/o,s=t.height/n;return a/s})}isProjectionUniform(){return this.withControllerInAPIMode(()=>!!this._calc.grapher.getProjection().settings.squareAxes)}_validateBrailleScreenshotOptions(t){return this.withControllerInAPIMode(()=>{t=__dcg_shared_module_exports__['Z'](t);var i=t.braille;if(i){let o=i.embosserModel;if(!o)return __dcg_shared_module_exports__['M'].warn("Screenshot braille options requires an embosser model to be specified. "),__dcg_shared_module_exports__['M'].warn("Continuing with non-braille screenshot."),delete t.braille,t;if(o==="etc"&&(i.embosserModel="etc11"),o==="vpmax"&&(i.embosserModel="vpmax11"),i.embosserModel!=="etc8"&&i.embosserModel!=="etc11"&&i.embosserModel!=="vpmax8"&&i.embosserModel!=="vpmax11")return __dcg_shared_module_exports__['M'].warn('Unknown screenshot braille embosser model. Valid models are "etc" and "vpmax".'),__dcg_shared_module_exports__['M'].warn("Continuing with non-braille screenshot."),delete t.braille,t;i.brailleMode!=="nemeth"&&i.brailleMode!=="ueb"&&(__dcg_shared_module_exports__['M'].warn("Screenshot options braille.brailleMode must be nemeth or ueb. Proceeding with nemeth."),i.brailleMode="nemeth"),t.width&&(__dcg_shared_module_exports__['M'].warn("Screenshot width option is ignored when exporting Braille."),delete t.width),t.height&&(__dcg_shared_module_exports__['M'].warn("Screenshot height option is ignored when exporting Braille."),delete t.height),t.targetPixelRatio&&(__dcg_shared_module_exports__['M'].warn("Screenshot targetPixelRatio option is ignored when exporting Braille."),delete t.targetPixelRatio),t.preserveAxisNumbers&&(__dcg_shared_module_exports__['M'].warn("Screenshot preserveAxisNumbers option is ignored when exporting Braille."),delete t.preserveAxisNumbers)}return t})}_validateAsyncScreenshotOpts(t){return this.withControllerInAPIMode(()=>{t=__dcg_shared_module_exports__['Z'](t);let i=t.mode||"contain",o=t.width||t.height||this.graphpaperBounds.pixelCoordinates.width,n=t.height||t.width||this.graphpaperBounds.pixelCoordinates.height,a=t.targetPixelRatio||1;a<1&&(a=1);let s=t.preserveAxisNumbers;t.hasOwnProperty("format")||(t.svg?(t.format="svg",delete t.svg):t.format="png");let l=t.mathBounds||{},c=this._getMathAspectRatio(),d=this.graphpaperBounds.pixelCoordinates.width/this.graphpaperBounds.pixelCoordinates.height,p=YX({mode:i,width:o,height:n,currentBounds:this.graphpaperBounds.mathCoordinates,graphpaperAspectRatio:d,mathAspectRatio:c,mathBounds:l});return{opts:{...t,width:o,height:n,targetPixelRatio:a,preserveAxisNumbers:s},mathBounds:p}})}asyncScreenshot(t,i){if(!arguments.length){__dcg_shared_module_exports__['M'].warn("asyncScreenshot expects a callback");return}if(arguments.length===1)if(typeof t!="function"){__dcg_shared_module_exports__['M'].warn("asyncScreenshot expects a callback");return}else i=t,t={};return this.withControllerInAPIMode(()=>{t||(t={}),t=this._validateBrailleScreenshotOptions(t);let{opts:o,mathBounds:n}=this._validateAsyncScreenshotOpts(t);cJ.push({api:this,options:o,mathBounds:n,state:this.getState(),callback:i}),dJ(this.constructor)})}setOptions(t){return this.withControllerInAPIMode(()=>{var i=this._calc.setOptions(t);return this.notifyControllerOfAPICall(),i})}focusFirstExpression(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"focus-first-expression"})})}openKeypad(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"keypad/set-minimized",minimized:!1})})}HelperExpression(t){return this.withControllerInAPIMode(()=>{var i=t&&t.latex||"",o=new Yr;return o.latex=i,this.controller.dispatch({type:"add-helper-expression",state:{type:"helper-expression",id:this.controller.generateId(),latex:i,proxy:o}}),o})}};var Eu=class extends zh{constructor(e,t,i){super(e,{...t,product:"graphing"},i)}};qt();var Kh=ie(document.body).data("load-data");qt();function pJ(r){let e={};return ie.extend(!0,e,r),ie.param(e)}var ZA="";function Tm(){return ZA}var uJ=[];function hJ(r){uJ.push(r)}function rge(r){if(r.status===401)for(let e of uJ)e()}async function ige(r){if(r&&r.routeDeprecated)throw r.js&&new Function(r.js)(),r}function oge(){throw{status:0,responseJSON:{errors:[{message:"Connection failed. Check your internet connection?"}]}}}async function I3(r){let e=await r.catch(oge);if(rge(e),!e.ok){let i;try{i=await e.json()}catch(o){}throw{status:e.status,responseJSON:i}}let t=await e.json();return await ige(t),t}async function ta(r,e){let t={method:"POST",credentials:"include",headers:{Accept:"application/json, text/javascript, */*; q=0.01"}};return e!==void 0&&(t.body=pJ(e),t.headers["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8"),await I3(fetch(ZA+r,t))}async function gJ(r,e){let t={method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Accept:"application/json, text/javascript, */*; q=0.01"},body:JSON.stringify(e||null)};return await I3(fetch(ZA+r,t))}async function Ic(r,e){e===void 0&&(e={}),e={...e,...Ip};let t={method:"GET",credentials:"include",headers:{Accept:"application/json, text/javascript, */*; q=0.01"}},i=/\?/.test(r)?"&":"?";return await I3(fetch(`${ZA}${r}${i}${new URLSearchParams(e)}`,t))}var mJ=["i18nKey","title","thumbURL","stateURL","hash","parentHash","recovery","recoveryParentHash","graphData","access","created","example","draft","easterEgg","isMigratedFromLegacyGeometry","questHash"],ra=class r extends Yr{constructor(t){super();this.isMigratedFromLegacyGeometry=!1;t&&mJ.forEach(i=>{t.hasOwnProperty(i)&&this.setProperty(i,t[i])}),this.access&&this.setProperty("access","all"),this.example||this.setProperty("example",!1),this.draft||this.setProperty("draft",!1),this.now=new Date}copy(){return new r(this)}getCollectionKey(){var t="";return this.example?t="example-":this.draft&&(t="draft-"),t+this.hash}displayDate(){var t=Date.now(),i=(t-this.created.getTime())/1e3,o=i/60,n=o/60,a=n/24,s=a/7,l=[__dcg_shared_module_exports__['sa']("account-shell-label-month-jan"),__dcg_shared_module_exports__['sa']("account-shell-label-month-feb"),__dcg_shared_module_exports__['sa']("account-shell-label-month-mar"),__dcg_shared_module_exports__['sa']("account-shell-label-month-apr"),__dcg_shared_module_exports__['sa']("account-shell-label-month-may"),__dcg_shared_module_exports__['sa']("account-shell-label-month-jun"),__dcg_shared_module_exports__['sa']("account-shell-label-month-jul"),__dcg_shared_module_exports__['sa']("account-shell-label-month-aug"),__dcg_shared_module_exports__['sa']("account-shell-label-month-sep"),__dcg_shared_module_exports__['sa']("account-shell-label-month-oct"),__dcg_shared_module_exports__['sa']("account-shell-label-month-nov"),__dcg_shared_module_exports__['sa']("account-shell-label-month-dec")];return s>=5?__dcg_shared_module_exports__['sa']("account-shell-label-created-on-date",{month:l[this.created.getMonth()],day:this.created.getDate(),year:this.created.getFullYear()}):s>=2?__dcg_shared_module_exports__['sa']("account-shell-label-created-weeks-ago",{number:String(Math.floor(s))}):a>=7?__dcg_shared_module_exports__['sa']("account-shell-label-created-last-week"):a>=2?__dcg_shared_module_exports__['sa']("account-shell-label-created-days-ago",{number:String(Math.floor(a))}):n>=24?__dcg_shared_module_exports__['sa']("account-shell-label-created-yesterday"):n>=2?__dcg_shared_module_exports__['sa']("account-shell-label-created-hours-ago",{number:String(Math.floor(n))}):o>=60?__dcg_shared_module_exports__['sa']("account-shell-label-created-one-hour-ago"):o>=2?__dcg_shared_module_exports__['sa']("account-shell-label-created-minutes-ago",{number:String(Math.floor(o))}):o>=1?__dcg_shared_module_exports__['sa']("account-shell-label-created-one-minute-ago"):__dcg_shared_module_exports__['sa']("account-shell-label-created-seconds-ago")}plainObject(){var t={};return mJ.forEach(i=>{t[i]=this[i]}),t}getURL(){var t;if(window.location.protocol==="file:"){var i="/calculator";if(!Tm())return i;t=Tm()+i}else{var o="/"+document.location.pathname.split("/")[1];t=window.location.href.split(o)[0]+o}return t+(this.hash&&!this.recovery?"/"+this.hash:"")}static fromAjax(t){return new r({i18nKey:t.i18nKey,title:t.title,thumbURL:t.thumbUrl,stateURL:t.stateUrl,graphData:t.state,hash:t.hash,parentHash:t.parent_hash,recoveryParentHash:t.recovery_parent_hash,access:t.access,created:new Date(t.created),example:!!t.example,draft:!!t.draft,easterEgg:t.easterEgg,isMigratedFromLegacyGeometry:!!t.isMigratedFromLegacyGeometry})}static toAjax(t){return{title:t.title,thumbUrl:t.thumbURL,stateUrl:t.stateURL,state:t.graphData,hash:t.hash,parent_hash:t.parentHash,recovery_parent_hash:t.recoveryParentHash,access:t.access,created:t.created.toString(),isMigratedFromLegacyGeometry:t.isMigratedFromLegacyGeometry}}static updateFromSync(t,i){t.setProperty("title",i.title),t.setProperty("hash",i.hash),t.setProperty("parentHash",i.parent_hash),t.setProperty("recoveryParentHash",i.recovery_parent_hash),t.setProperty("graphData",t.graphData),t.setProperty("thumbURL",i.thumbUrl),t.setProperty("stateURL",i.stateUrl),t.setProperty("created",new Date(i.created)),t.setProperty("questHash",i.questHash)}};qt();Rc();var nge=2023;function A3(){return ta("/account/logout_xhr")}function fJ(r){let e=function(){return ta("/account/login_xhr",r)};return A3().then(e,e).then(()=>Zw({lang:r.lang}))}function Zw(r){return Ic("/account/user_info",r)}async function V3(){let r=await Ic("/account/user_info?no401");if(r.loggedIn===!1)throw r;return r}function bJ(r){return ta("/account/check_account_status",r)}function yJ(r){return ta("/account/register_xhr",r).then(()=>Zw({lang:r.lang}))}function xJ(r){r===void 0&&(r={});let e="?source="+(r.fromUI||"");return r.teacher&&(e+="&teacher=true"),Tm()+"/drive_api/calculator/login"+e}function wJ(r){r===void 0&&(r={});let e="?source="+(r.fromUI||"");return r.teacher&&(e+="&teacher=true"),Tm()+"/apple_api/calculator/login"+e}function vJ(r){return ta("/account/change_name",r).then(()=>Zw({lang:r.lang}))}function CJ(r){return ta("/account/change_name_detail",{lang:r.lang,userProvidedName:{given:r.given,family:r.family}}).then(()=>Zw({lang:r.lang}))}function EJ(r){return ta("/account/recover_xhr",r)}function SJ(r){return Ic("/account/initiate_delete_account",r)}function DJ(r){return Ic("/account/initiate_email_change",r)}function kJ(r){return ta("/account/set_email",r).then(()=>Zw({lang:r.lang}))}function GJ(r){return gJ("/account/update_feature_flags",r).then(()=>Zw({lang:r.lang}))}function TJ(r){return ta(`/account/art_contest_submissions${r.submission_id?`/${r.submission_id}`:""}`,r)}async function ev(r="",e=nge){let t=tn().userId;try{return await Ic("/account/art_contest_submissions",{year:String(e),product:r,userId:typeof t=="string"?t:""})}catch(i){if(i.status!==401)throw i}return[]}function AJ(r,e){r.closed?e.askServerIfLoggedIn():setTimeout(()=>{AJ(r,e)},1e3)}function IJ(r){var e=window.open(r.url,"login_window","width=650,height=530,resizable,scrollbars");e?AJ(e,r.userController):alert(r.blockedMessage)}function VJ(r,e){window.userController=r,r.observeEvent("googleLogin",function(t,i){IJ({url:xJ(i),userController:r,blockedMessage:e("account-shell-text-login-window-blocked-google")})}),r.observeEvent("appleLogin",function(t,i){IJ({url:wJ(i),userController:r,blockedMessage:e("account-shell-text-login-window-blocked-apple")})})}var sge=1;function xo(r){eV&&lge(r)}var eV=!1;function PJ(){eV=!0}function lge(r){var t,i;if(!eV)return;let e=["trackEvent",r.category,r.action,r.name,r.value];pr("testing")?(t=window.paqTest)==null||t.push(e):(i=window._paq)==null||i.push(e)}var LJ;function tV(r=!0){if(!eV)return;let e=document.location.href,t=document.referrer,i=window._paq=window._paq||[];LJ!==e&&(LJ=e,r&&!pr("testing")&&(i==null||i.push(["setReferrerUrl",t]),i==null||i.push(["setDocumentTitle",window.document.title]),i==null||i.push(["setCustomDimension",sge,window.location!==window.parent.location]),i==null||i.push(["trackPageView"])))}var cge=50,rV=class{constructor(e,t){this.throttledFlushBatchedLogs=__dcg_shared_module_exports__['z'](async()=>{if(this.requestInFlight||this.batchedLogs.length==0)return;let e=this.batchedLogs.splice(0,cge);this.requestInFlight=!0;try{await fetch(this.apiUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({events:e})})}catch(t){}this.requestInFlight=!1,this.throttledFlushBatchedLogs()},1e3,{leading:!1});this.batchedLogs=[],this.requestInFlight=!1,this.getSessionData=t,this.apiUrl=e}log(e){this.batchedLogs.push({...this.getSessionData(),...e}),this.throttledFlushBatchedLogs()}};var dge={event_type:"eventType",page_load_id:window.pageLoadId||Ng(),source:"browser",app:"knox",user_agent:navigator.userAgent},pge=new rV("/usage-stats",()=>dge);function _J(r,e){pge.log({event_type:r,url:document.location.href,payload:JSON.stringify(e)})}var L3={};__dcg_shared_module_exports__['d'](L3,{isDegreeMode:()=>hge,isProjectorMode:()=>uge});function uge(r){return r.isProjectorMode()}function hge(r){return r.model.getDegreeMode()}var P3={};__dcg_shared_module_exports__['d'](P3,{isLoggedIn:()=>gge});function gge(r){return r.userController.isLoggedIn()}var _3={};__dcg_shared_module_exports__['d'](_3,{expressionCount:()=>wge,expressionErrors:()=>Dge,folderCount:()=>vge,hasAction:()=>bge,hasCustomColors:()=>xge,hasMovablePoints:()=>yge,hasRegression:()=>fge,hasSlider:()=>mge,imageCount:()=>Cge,tableCount:()=>Ege,textCount:()=>Sge});function mge(r){return r.getAllModelsWithSliders().length>0}function fge(r){for(let e of r.getAllItemModels())if(e.type==="expression"&&zy(e))return!0;return!1}function bge(r){if(r.getListModel().ticker.open)return!0;for(let e of r.getAllItemModels())if(e&&"formula"in e&&e.formula){if(e.type!=="expression"&&e.type!=="image")continue;let{formula:t}=e;if(t.hasOwnProperty("action_value")||t.hasOwnProperty("click_handler"))return!0}return!1}function yge(r){return r.getAllItemModels().some(e=>e.type==="expression"&&mo(e)!=="NONE")}function xge(r){for(let e of r.getAllItemModels()){if(e.type!=="expression"||!sa(e))continue;let i=r.getEvaluationValueForItem(e.id);if(typeof i=="string"||Array.isArray(i)&&typeof i[0]=="string")return!0}return!1}function wge(r){return r.getAllItemModels().filter(e=>e.type==="expression").length}function vge(r){return r.getAllItemModels().filter(e=>e.type==="folder").length}function Cge(r){return r.getAllItemModels().filter(e=>e.type==="image").length}function Ege(r){return r.getAllItemModels().filter(e=>e.type==="table").length}function Sge(r){return r.getAllItemModels().filter(e=>e.type==="text").length}function Dge(r){let e=new Set;for(let t of r.getAllItemModels())if(t.type==="expression"&&t.error){let{key:i}=t.error;i!=="shared-calculator-error-blank-expression"&&e.add(i)}return Array.from(e)}var kge="usage-ping",OJ=60*1e3,RJ=1/50,Gge=60*1e3,t0=class{constructor(e={}){this.minutesOfMathData={lastCheckedMinutesOfMath:Date.now(),lastChangeEventTime:void 0,minutesOfMath:0};this.minutesOfMathCheckInterval=Gge;if(this.samplingInterval=OJ,this.shouldSample=Math.random()<RJ,this.lastConsideredTime=Date.now(),this.pageLoadTime=Date.now(),this.graphLoadTime=Date.now(),this.basicController=e.basicController,this.frontendController=e.frontendController,this.calcController=e.calcController,this.graphsController=e.graphsController,this.featureQueryMap={"basic-controller-feature":[],"frontend-controller-feature":[],"graph-feature":[]},this.focused=document.hasFocus(),this.focused&&(this.focusIntervalStart=Date.now()),this.totalTimeFocused=0,window.addEventListener("focus",()=>{this.focused=!0,this.focusIntervalStart=Date.now()}),window.addEventListener("blur",()=>{this.focused=!1,this.addTimeFocused(),this.focusIntervalStart=void 0}),document.visibilityState==="visible"&&(this.visibleIntervalStart=Date.now()),this.totalTimeVisible=0,document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?(this.addTimeVisible(),this.visibleIntervalStart=void 0):this.visibleIntervalStart=Date.now()}),this.graphsController&&this.graphsController.observeEvent("onLoadGraph",()=>{this.graphLoadTime=Date.now()}),this.calcController){let t=this.calcController.onEventsEmitted;this.calcController.onEventsEmitted=i=>{var o;t==null||t(i),(o=i.change)!=null&&o.isUserInitiated&&(this.minutesOfMathData.lastChangeEventTime=Date.now(),this.getTotalMinutesOfMath())}}}getUsageData(){return{...this.getBasicUsageData(),...this.getBasicControllerUsageData(),...this.getFrontendControllerUsageData(),...this.getGraphFeatureUsageData(),version:2}}getBasicUsageData(){let e={timeSincePageload:this.getTimeSincePageload(),totalTimeFocused:this.getTotalTimeFocused(),totalTimeVisible:this.getTotalTimeVisible(),...this.getTotalMinutesOfMath(),samplingInterval:OJ,samplingProbability:RJ};return this.graphsController&&(e.timeSinceGraphLoaded=Date.now()-this.graphLoadTime),e}getDataFromController(e,t,i){let o={};for(let n of this.featureQueryMap[e]){let a=t[n];if(!a)throw new Error(`'${n}' is not a valid feature name.`);let s=a(i);(Array.isArray(s)&&s.length>0||typeof s=="boolean"&&s||typeof s=="number")&&(o[n]=s)}return o}getBasicControllerUsageData(){return this.getDataFromController("basic-controller-feature",L3,this.basicController)}getFrontendControllerUsageData(){return this.getDataFromController("frontend-controller-feature",P3,this.frontendController)}getGraphFeatureUsageData(){return this.getDataFromController("graph-feature",_3,this.calcController)}callLogger(){if(!this.shouldSample)return;let e=Date.now();e-this.lastConsideredTime>this.samplingInterval&&(this.lastConsideredTime=e,_J(kge,this.getUsageData()))}addTimeFocused(){if(this.focusIntervalStart===void 0)return;let e=Date.now(),t=e-this.focusIntervalStart;this.totalTimeFocused+=t,this.focusIntervalStart=e}addTimeVisible(){if(this.visibleIntervalStart===void 0)return;let e=Date.now(),t=e-this.visibleIntervalStart;this.totalTimeVisible+=t,this.visibleIntervalStart=e}getTotalTimeFocused(){return this.focused?(this.addTimeFocused(),this.totalTimeFocused):this.totalTimeFocused}getTotalTimeVisible(){return document.visibilityState==="hidden"?this.totalTimeVisible:(this.addTimeVisible(),this.totalTimeVisible)}start(){this.shouldSample&&setInterval(this.callLogger.bind(this))}trackFeatureUsage(e,t){if(!this.calcController)throw new Error("Monitoring graph feature usage requires a calculator controller.");this.featureQueryMap[e].push(t)}getTimeSincePageload(){return Date.now()-this.pageLoadTime}setMinutesOfMathCheckInterval(e){this.minutesOfMathCheckInterval=e}getTotalMinutesOfMath(){var t;let e=Date.now();return(!this.minutesOfMathData.lastCheckedMinutesOfMath||e-this.minutesOfMathData.lastCheckedMinutesOfMath>=this.minutesOfMathCheckInterval)&&(((t=this.minutesOfMathData.lastChangeEventTime)!=null?t:0)>e-this.minutesOfMathCheckInterval&&(this.minutesOfMathData.minutesOfMath+=this.minutesOfMathCheckInterval*1/(60*1e3)),this.minutesOfMathData.lastCheckedMinutesOfMath=e),{minutesOfMath:this.minutesOfMathData.minutesOfMath}}};var Sv=__dcg_shared_module_exports__['e'](te());var lv=__dcg_shared_module_exports__['e'](te());var kt=__dcg_shared_module_exports__['e'](te());var bd=__dcg_shared_module_exports__['e'](te());var iV=class extends bd.Class{template(){return bd.createElement("span",{role:bd.const("button"),tabindex:bd.const(0),"aria-label":()=>this.openGraphText(),class:bd.const("dcg-header-btn dcg-action-opendrawer dcg-tooltip"),tooltip:()=>this.openGraphText(),onTap:()=>this.props.controller().dispatch({type:"open-mygraphs"})},bd.createElement($e,{tooltip:()=>this.openGraphText(),disabled:()=>!this.props.tooltip(),gravity:this.const("s"),offset:()=>({top:12})},bd.createElement("i",{class:bd.const("dcg-icon-hamburger"),"aria-hidden":bd.const("true")})))}openGraphText(){let e=this.props.controller().getOpenText();return Ti?this.props.controller().s("account-shell-label-open-graph-mac",{open_graph:e}):this.props.controller().s("account-shell-label-open-graph-pc",{open_graph:e})}};var ei=__dcg_shared_module_exports__['e'](te());var ia=__dcg_shared_module_exports__['e'](te());var Vl=__dcg_shared_module_exports__['e'](te());qt();var{If:Tge}=Vl.Components,ys=class extends Vl.Class{init(){this.controller=this.props.controller(),this.focusHelper=new _x({getIconSelector:()=>`[dcg-menu-button=${this.props.type()}]`,isIconFocused:()=>{var e;return(e=document.querySelector(`[dcg-menu-button=${this.props.type()}]`))==null?void 0:e.matches(":focus")},focusIcon:()=>{var e;return(e=document.querySelector(`[dcg-menu-button=${this.props.type()}]`))==null?void 0:e.focus()},closeMenu:()=>{this.controller.dispatch({type:"toggle-menu",payload:"none"})},getContainerEl:()=>this.containerEl})}onMountContainer(e){this.containerEl=e,document.addEventListener("keydown",this.focusHelper.globalKeyDownListener),ie(document.body).on(`dcg-tapstart.${this.guid}`,this.focusHelper.tapListener),this.focusHelper.focusFirstOption()}didUnmount(){document.removeEventListener("keydown",this.focusHelper.globalKeyDownListener),ie(document.body).off(`.${this.guid}`)}getTypeClass(){switch(this.props.type()){case"art-contest":return"dcg-art-contest-container";case"account":case"account-mygraphs":return"dcg-account-container";case"graph-actions":return"dcg-graph-actions-container";case"help":return"dcg-help-container";case"language":return"dcg-language-container";case"share":return"dcg-share-container"}}getProductClass(){switch(this.props.controller().getProduct()){case"geometry":return"dcg-product-geometry";case"geometry-calculator":return"dcg-product-geometry-calculator";case"graphing":return"dcg-product-graphing";case"graphing-3d":return"dcg-product-graphing-3d"}}template(){return Vl.createElement("div",{class:()=>({"dcg-popover":!0,"dcg-bottom":!0,"dcg-constrained-height-popover":!0,[this.getTypeClass()]:!0,[this.getProductClass()]:!0}),style:()=>({display:"block",left:this.props.left?`${this.props.left()}px`:void 0,right:this.props.left?"auto":void 0}),role:Vl.const("region"),onMount:this.bindFn(this.onMountContainer),willUnmount:()=>{this.containerEl=void 0}},Vl.createElement("div",{class:Vl.const("dcg-popover-interior")},Vl.createElement(Tge,{predicate:()=>{var e,t;return!!((t=(e=this.props).title)!=null&&t.call(e))}},()=>Vl.createElement("h2",{class:Vl.const("dcg-unstyled-heading dcg-popover-title")},()=>this.props.title())),this.children),Vl.createElement("div",{class:Vl.const("dcg-arrow"),style:()=>({left:this.props.arrowLeft?`${this.props.arrowLeft()}px`:void 0,right:this.props.arrowLeft?"auto":void 0})}))}didMount(){let e=this.props.type();this.guid=`menu-${e}`}};var{If:Mge}=ia.Components,tv=class extends ia.Class{init(){this.controller=this.props.controller(),this.userController=this.controller.userController}template(){return ia.createElement(Mge,{predicate:()=>this.userController.isLoggedIn()},()=>ia.createElement(ys,{type:this.props.type,label:()=>this.controller.s("account-shell-label-account-information"),left:this.props.left,arrowLeft:this.props.arrowLeft,controller:this.props.controller},ia.createElement("div",{class:ia.const("user-info")},ia.createElement("span",{class:ia.const("account-name")},()=>this.userController.getFullName()),ia.createElement("span",{class:ia.const("account-email")},()=>this.userController.getEmail()),ia.createElement("a",{class:ia.const("dcg-action-accountsettings"),role:ia.const("link"),tabindex:ia.const(0),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"account-settings",device:e.device})},()=>this.controller.s("account-shell-link-account-settings"))),ia.createElement("a",{class:ia.const("dcg-action-logout"),role:ia.const("link"),tabindex:ia.const(0),onTap:()=>this.logout()},()=>this.controller.s("account-shell-link-sign-out"))))}logout(){this.controller.dispatch({type:"toggle-menu",payload:"none"}),this.userController.logout()}};var{If:r0}=ei.Components,oV=class extends ei.Class{getAccountMenuArrowOffset(){var e,t;return this.props.controller().getProduct()==="geometry"?220:(t=(e=this.props).withArtContest)!=null&&t.call(e)?60:100}template(){let e=this.props.controller().userController;return ei.createElement("span",null,ei.createElement(r0,{predicate:()=>e.isLoggedIn()&&!this.props.disableAccounts()},()=>ei.createElement("span",null,ei.createElement(r0,{predicate:()=>e.isLoggingOut()},()=>ei.createElement("span",{class:ei.const("logout-progress-notice")},ei.createElement("span",{class:ei.const("dcg-spinner-dark")}))),ei.createElement(r0,{predicate:()=>!e.isLoggingOut()&&!this.props.disableAccounts()},()=>ei.createElement("button",{class:ei.const("dcg-unstyled-button dcg-account-link"),"dcg-menu-button":ei.const("account"),"aria-haspopup":ei.const("true"),"aria-expanded":()=>this.props.controller().getOpenMenu()==="account","aria-label":()=>this.props.controller().s("account-shell-label-account-information"),onTap:()=>{this.props.controller().dispatch({type:"toggle-menu",payload:"account"})}},ei.createElement("span",{class:ei.const("email")},ei.createElement("div",{class:ei.const("header-account-name dcg-variable-name")},()=>e.getFirstName()),ei.createElement("i",{class:ei.const("dcg-icon-caret-down"),"aria-hidden":ei.const("true")})))),ei.createElement(r0,{predicate:()=>this.props.controller().getOpenMenu()=="account"},()=>ei.createElement(tv,{type:this.const("account"),controller:this.props.controller,arrowLeft:this.bindFn(this.getAccountMenuArrowOffset)})))),ei.createElement(r0,{predicate:()=>!e.isLoggedIn()&&!this.props.disableAccounts()},()=>ei.createElement("span",{class:ei.const("dcg-login")},ei.createElement("a",{role:ei.const("link"),tabindex:ei.const(0),class:ei.const("dcg-sign-in dcg-action-login dcg-btn-white-outline"),onTap:t=>{this.props.controller().dispatch({type:"show-modal",modal:"login",device:t.device})}},()=>this.props.controller().s("account-shell-button-log-in")),()=>this.props.controller().s("account-shell-text-or"),ei.createElement("a",{role:ei.const("link"),tabindex:ei.const(0),class:ei.const("dcg-create-account dcg-btn dcg-btn-primary dcg-action-createaccount"),onTap:t=>{this.props.controller().dispatch({type:"show-modal",modal:"signup",device:t.device})}},()=>this.props.controller().s("account-shell-button-sign-up")))))}};var qh=__dcg_shared_module_exports__['e'](te());var Sb=class extends qh.Class{init(){this.controller=this.props.controller()}template(){return this.controller=this.props.controller(),qh.createElement($e,{tooltip:this.props.tooltip,gravity:this.bindFn(this.getGravity)},qh.createElement("button",{"aria-haspopup":qh.const("true"),"aria-label":()=>this.props.label(),"aria-expanded":()=>this.isMenuOpen(),class:()=>({"dcg-unstyled-button":!0,"dcg-header-btn":!0,[this.getBtnClass()]:!0,"dcg-tooltip":!0,"dcg-active":this.isMenuOpen()}),"dcg-menu-button":this.props.name,onTap:this.props.onTap},qh.createElement("i",{class:this.props.icon,"aria-hidden":qh.const("true")})))}getBtnClass(){switch(this.props.name()){case"help":return"dcg-action-help";case"language":return"dcg-action-language";case"share":return"dcg-action-share";case"art-contest":return"dcg-action-contest"}}getGravity(){return this.props.gravity?this.props.gravity():"s"}isMenuOpen(){return this.controller.getOpenMenu()===this.props.name()}};var zn=__dcg_shared_module_exports__['e'](te());var ha=__dcg_shared_module_exports__['e'](te());var{SwitchUnion:Ige}=ha.Components,nV=class extends ha.Class{init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController}getSaveStatus(){return this.graphsController.isSaving()?"saving":this.graphsController.didSaveSucceed()?"save-success":"default"}getSaveMessage(){return this.graphsController.willSaveCopy()?this.controller.s("account-shell-button-save-copy"):this.controller.s("account-shell-button-save")}template(){return ha.createElement("span",null,Ige(()=>this.getSaveStatus(),{saving:()=>ha.createElement("span",{class:ha.const("dcg-if-user save-btn-container")},ha.createElement("span",{class:ha.const("saving-notice")},ha.createElement("span",{class:ha.const("dcg-spinner-dark")}))),"save-success":()=>ha.createElement("span",{class:ha.const("dcg-save-success")},ha.createElement("i",{class:ha.const("dcg-icon-check")}),()=>this.controller.s("shared-calculator-label-saved")),default:()=>ha.createElement("span",{class:()=>({"dcg-if-user save-btn-container":!0})},ha.createElement($e,{tooltip:()=>this.controller.isSaveEnabled()?this.saveChangesText():this.controller.s("account-shell-label-no-unsaved-changes"),offset:()=>({top:7})},ha.createElement("span",{role:ha.const("button"),class:()=>({"dcg-action-save":!0,"tooltip-offset":!0,"dcg-btn-primary":this.controller.isSaveEnabled(),"dcg-disabled":!this.controller.isSaveEnabled()}),onTap:e=>{this.controller.isSaveEnabled()&&this.controller.simpleSave(e.device)}},()=>this.getSaveMessage())))}))}saveChangesText(){return Ti?this.controller.s("account-shell-label-save-changes-mac"):this.controller.s("account-shell-label-save-changes-pc")}};var o0=__dcg_shared_module_exports__['e'](te());var Rr=__dcg_shared_module_exports__['e'](te());var i0=__dcg_shared_module_exports__['e'](te());qt();var{If:Tit}=i0.Components;var{For:FJ,If:aV,IfDefined:Age,Switch:Vge}=Rr.Components,sV=class extends Rr.Class{template(){return Rr.createElement(FJ,{each:this.props.options,key:e=>`${e.key?e.key:e.title()}${e.disabled?"-disabled":""}`},Rr.createElement("div",{role:Rr.const("list"),class:()=>{var e,t;return{"dcg-shared-options-dropdown":!0,[((t=(e=this.props).class)==null?void 0:t.call(e))||""]:!!this.props.class}}},e=>Rr.createElement("div",{role:Rr.const("listitem"),class:Rr.const("dropdown-option-container")},Rr.createElement(Vge,{key:()=>e},t=>"href"in t?Rr.createElement("a",{"aria-disabled":()=>t.disabled,class:()=>({[t.class||""]:!!t.class,"dcg-standard-link-styling":!t.class,"dropdown-choice":!0,"dropdown-choice-disabled":t.disabled}),onTap:()=>!t.disabled&&this.props.onTap(t),href:()=>t.href,target:()=>t.target!==void 0?t.target:"",rel:()=>t.noreferrer?"noreferrer noopener":""},Rr.createElement(aV,{predicate:()=>t.icon!=null},()=>Rr.createElement("div",{class:Rr.const("option-icon-container")},Rr.createElement("i",{"aria-hidden":Rr.const("true"),class:()=>`${t.icon} option-icon`}))),t.title):Rr.createElement("div",{role:Rr.const("link"),tabindex:Rr.const(0),"aria-disabled":()=>t.disabled,class:()=>({[t.class||""]:!!t.class,"dcg-standard-link-styling":!t.class,"dropdown-choice":!0,"dropdown-choice-disabled":t.disabled}),onTap:()=>!t.disabled&&this.props.onTap(t)},Rr.createElement(aV,{predicate:()=>t.icon!=null},()=>Rr.createElement("div",{class:Rr.const("option-icon-container")},Rr.createElement("i",{"aria-hidden":Rr.const("true"),class:()=>`${t.icon} option-icon`}))),Rr.createElement("span",{class:Rr.const("option-title")},t.title),Age(()=>t.subtitle&&t.subtitle(),i=>Rr.createElement("span",{class:Rr.const("option-subtitle")},i)))),Rr.createElement(aV,{predicate:()=>!!e.explanations},()=>Rr.createElement(FJ,{each:()=>e.explanations||[],key:t=>t.flag},Rr.createElement("div",{class:Rr.const("dropdown-explanations")},t=>Rr.createElement("div",{class:Rr.const("explanation")},()=>t.explanation,Rr.const(" "),Rr.createElement(aV,{predicate:()=>!!t.link},()=>Rr.createElement("a",{class:Rr.const("learn-more"),href:()=>t.link!==void 0?t.link:"",target:Rr.const("_blank")},()=>t.linkText?t.linkText:Pn("shared-button-learn-more-capitalized"))))))))))}};var Lge=28,Pge=10,O3=4,lV=class extends o0.Class{template(){return o0.createElement(ys,{type:this.const("graph-actions"),label:()=>this.props.controller().s("account-shell-label-graph-actions"),controller:this.props.controller,left:()=>this.left,arrowLeft:()=>this.arrowLeft},o0.createElement(sV,{class:this.const("dcg-graph-actions-list"),options:this.bindFn(this.getOptions),onTap:this.bindFn(this.tapOption)}))}didMount(){var n,a,s,l;let e=document.querySelector(".dcg-graph-actions-dropdown-anchor"),t=((a=(n=go(e))==null?void 0:n.left)!=null?a:0)+((s=e.getBoundingClientRect().width)!=null?s:0)/2,o=((l=document.querySelector(".dcg-graph-actions-container").getBoundingClientRect().width)!=null?l:0)-Lge/2-Pge;t<=o+O3?(this.left=O3,this.arrowLeft=t-O3):(this.left=t-o,this.arrowLeft=o),this.update()}getOptions(){let e=[];return e.push({title:()=>this.props.controller().s("account-shell-button-rename"),icon:"dcg-icon-pencil",class:"dcg-blue-link",action:()=>{this.props.controller().dispatch({type:"show-modal",modal:"rename",device:"mouse"})}}),this.props.controller().graphsController.wasCurrentGraphEverSaved()&&e.push({title:()=>this.props.controller().s("account-shell-button-duplicate"),icon:"dcg-icon-duplicate",action:()=>this.props.controller().dispatch({type:"show-modal",modal:"duplicate",device:"mouse"})},{title:()=>this.props.controller().s("account-shell-button-delete"),icon:"dcg-icon-remove",class:"dcg-red-link",action:()=>{this.props.controller().dispatch({type:"show-modal",modal:"delete",device:"mouse"})}}),e}tapOption(e){e.action!==void 0&&e.action(),!e.preventClose&&("href"in e?e.isDeepLink&&setTimeout(()=>this.closeMenu()):this.closeMenu())}closeMenu(){this.props.controller().dispatch({type:"toggle-menu",payload:"graph-actions"})}};var{If:R3}=zn.Components,cV=class extends zn.Class{init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController}getTitle(){return this.graphsController.getCurrentGraphTitle()||this.graphsController.getUntitledString()}template(){return zn.createElement("span",{class:zn.const("title-div")},zn.createElement("span",{role:zn.const("button"),class:zn.const("dcg-variable-title-container"),"dcg-menu-button":()=>this.shouldShowDropdown()?"graph-actions":void 0,tabindex:zn.const(0),onTap:e=>{this.shouldShowDropdown()?this.openGraphActionsDropdown(e):this.shouldOpenSaveDialog()&&this.controller.dispatch({type:"edit-title"})},"aria-haspopup":()=>this.shouldShowDropdown(),"aria-expanded":()=>this.props.controller().getOpenMenu()=="graph-actions","aria-label":()=>this.shouldShowDropdown()?this.controller.s("account-shell-label-graph-actions"):void 0},zn.createElement("h1",{class:()=>({"dcg-variable-title dcg-tooltip":!0,"dcg-action-savedialog":this.shouldOpenSaveDialog()})},()=>this.getTitle()),zn.createElement(R3,{predicate:this.bindFn(this.shouldShowDropdown)},()=>zn.createElement("span",{class:zn.const("dcg-graph-actions-dropdown-anchor")},zn.createElement("i",{class:zn.const("dcg-icon-caret-down"),"aria-hidden":zn.const("true")}))),zn.createElement(R3,{predicate:()=>this.controller.getOpenMenu()==="graph-actions"},()=>zn.createElement(lV,{controller:this.props.controller}))),zn.createElement(R3,{predicate:()=>!this.controller.getPreviewParams()&&!this.controller.isInMaintenanceMode()},()=>zn.createElement(nV,{controller:this.props.controller})))}shouldOpenSaveDialog(){return this.controller.product==="geometry"}shouldShowDropdown(){return this.controller.product!=="geometry"&&this.graphsController.wasCurrentGraphEverSaved()}openGraphActionsDropdown(e){this.props.controller().dispatch({type:"toggle-menu",payload:"graph-actions"}),e&&e.device==="keyboard"&&this.controller.getOpenMenu()!=="share"&&document.querySelectorAll(".dcg-graph-actions-container .dropdown-choice:not(.dropdown-choice-disabled)")[0].focus()}};var pV=__dcg_shared_module_exports__['e'](te());var dV=class extends pV.Class{template(){return pV.createElement("span",{onMount:this.bindFn(this.addSVGLogo)})}addSVGLogo(e){e.innerHTML=`
    <svg version="1.1" class="dcg-desmos-svg-logo" id="svg-desmos" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
    viewBox="0 0 909.3 188.4" xml:space="preserve">
    <title>${Pn("frontpage-narration-shared-desmos-logo")}</title>
    <g>
      <path d="M129.6,0c-6.8,0-12.4,5.5-12.4,12.4v48c-27.7-25.4-70.6-24-96.7,3.1c-27.4,28.4-27.4,73.4,0,101.8
        c26.1,27.1,69.1,28.4,96.8,3v8.8c2,6.5,9,10.2,15.5,8.2c3.9-1.2,7-4.3,8.2-8.2V12.4C141.1,5.9,136.1,0.5,129.6,0z M103.9,148.7
        c-17.3,18.2-46.1,18.9-64.3,1.6c-0.6-0.5-1.1-1.1-1.6-1.6c-18.4-19.2-18.4-49.5,0-68.7c17.3-18.2,46.1-18.9,64.3-1.6
        c0.6,0.5,1.1,1.1,1.6,1.6C122.3,99.3,122.3,129.6,103.9,148.7z"/>
      <path d="M298.3,124c2.2-2.3,3.4-5.3,3.5-8.4c-0.1-19-7.6-37.2-20.9-50.7c-26.6-27.6-70.6-28.4-98.2-1.8c-0.6,0.6-1.2,1.2-1.8,1.8
        c-27.4,28.4-27.4,73.4,0,101.8c21.8,22.6,56.2,27.7,83.7,12.4c10-5.6,18.5-13.5,24.8-23.1c3.4-5.5,1.9-12.7-3.3-16.5
        c-5.5-3.3-12.6-1.7-16.4,3.5c-4.2,6.4-9.9,11.6-16.6,15.4c-6.8,3.8-14.4,5.8-22.2,5.8c-12.5,0-24.4-5.1-33.1-14.1
        c-6-6.3-10.3-14-12.4-22.4h104C292.7,127.6,296,126.3,298.3,124z M231.3,67.2c12.4,0.1,24.3,5.2,33,14.1
        c6.1,6.3,10.4,14.1,12.4,22.6h-90.7c2.1-8.5,6.3-16.3,12.4-22.6C207,72.4,218.8,67.3,231.3,67.2z"/>
      <path d="M763.5,63c-26.7-28.1-71.1-29.2-99.2-2.5c-0.8,0.8-1.7,1.6-2.5,2.5c-13.7,13.9-21.3,32.7-20.9,52.2
        c-0.2,19.3,7.2,37.8,20.7,51.6c27.7,28.2,73.1,28.7,101.3,0.9c0.3-0.3,0.6-0.6,0.9-0.9c13.4-13.8,20.9-32.4,20.7-51.7
        c0.2-19.4-7.3-38.2-21.1-51.9 M712.8,66.7c12.4,0,24.2,5.2,32.5,14.4c8.9,9.2,13.8,21.5,13.6,34.3c0.2,12.7-4.6,25-13.5,34.1
        c-8.5,9.2-20.5,14.2-33,13.9c-12.3,0.3-24.2-4.7-32.5-13.8c-8.8-9.1-13.6-21.4-13.3-34.1c-0.3-12.9,4.7-25.4,13.8-34.6
        c8.2-9.3,20-14.6,32.4-14.4"/>
      <path d="M623.8,92.6v81.9c0.3,6.8-4.9,12.7-11.8,13c-6.8,0.3-12.7-4.9-13-11.8V93.1c0-7.5-3-14.6-8.3-19.8
        c-4.3-4.7-10.2-7.6-16.5-8.1h-1.9c-7-0.1-13.6,2.9-18.2,8.2c-4.8,4.9-7.5,11.5-7.7,18.3v2l0,0v81.1c0,6.8-5.5,12.4-12.4,12.4
        c-6.5,0-11.9-4.9-12.4-11.4V91.5c-0.6-4.3-1.8-8.4-3.5-12.4c-1.2-2.3-2.6-4.5-4.3-6.4c-4.7-5.2-11.3-8.3-18.3-8.3
        c-7,0-13.6,3-18.1,8.3c-5.1,5.2-8,12.3-7.9,19.6V176c-0.8,6.3-6.1,11-12.4,10.9c-6.8,0-12.4-5.5-12.4-12.4V52.9
        c-0.7-6.8,4.2-12.9,11-13.6c5.9-0.6,11.4,3,13.1,8.7l2.9-1.9c7.4-3.9,15.6-6,23.9-5.9c12.3-0.1,24.1,4.3,33.3,12.4
        c1.1,0.9,2.1,2,3,3.1c0.9,0.7,1.7,1.5,2.5,2.4l2.2-2.4c0.9-1.1,1.9-2.2,3-3.1c9.2-8.1,21-12.5,33.2-12.4h4.3
        c10.8,0.8,21,5.1,29,12.4c0.9,1,2,1.9,3,2.9C618.9,65.3,624,78.7,623.8,92.6"/>
      <path d="M427.2,145.4c0.1,23.4-18.6,42.5-42,43h-50.8c-6.8,0-12.4-5.5-12.4-12.4s5.5-12.4,12.4-12.4H384c10-0.2,17.9-8.4,17.8-18.3
        c0.1-9.9-7.9-18-17.8-18.1c0,0-0.1,0-0.1,0h-24.8c-23.8-1.3-42-21.6-40.8-45.4c1.2-22,18.8-39.6,40.8-40.8h50.2
        c6.8,0,12.4,5.5,12.4,12.4s-5.5,12.4-12.4,12.4h-49.1c-10,0.8-17.5,9.6-16.7,19.7c0.7,8.9,7.8,15.9,16.7,16.7H385
        c5.9,0,11.8,1.2,17.2,3.7C417.7,112.8,427.2,128.4,427.2,145.4"/>
      <path d="M908.9,145.2c0,23.4-18.3,42.7-41.6,43.3h-50.8c-6.8,0-12.4-5.5-12.4-12.4s5.5-12.4,12.4-12.4h50.2
        c10-0.2,17.9-8.4,17.8-18.3c0.1-9.9-7.9-18-17.8-18.1c0,0-0.1,0-0.1,0h-24.8c-23.8-1.3-42-21.6-40.8-45.4
        c1.2-22,18.8-39.6,40.8-40.8h49.6c6.8,0,12.4,5.5,12.4,12.4s-5.5,12.4-12.4,12.4h-49.6c-10.1,0-18.2,8.2-18.2,18.2c0,0,0,0,0,0
        c0,9.9,8,18,17.8,18.1h24.8c5.9,0,11.8,1.3,17.2,3.7C898.9,112.8,908.9,128.2,908.9,145.2"/>
    </g>
    </svg>
    `}};var pt=__dcg_shared_module_exports__['e'](te());Rc();var{For:NJ,If:F3,IfElse:N3,SwitchUnion:_ge}=pt.Components,BJ=["graphing","geometry-calculator","graphing-3d"],uV=class extends pt.Class{init(){this.entry=this.props.entry(),this.controller=this.props.controller()}getThumbAlt(){var e,t;return(e=this.entry)!=null&&e.title&&this.entry.title!==""?this.controller.s("frontpage-narration-art-contest-image-of-graph",{graphTitle:this.entry.title}):(t=this.entry)!=null&&t.name?this.controller.s("frontpage-narration-art-contest-image-of-graph-by",{name:this.entry.name}):""}template(){return pt.createElement("div",null,N3(()=>!!this.entry&&!!this.entry.url,{true:()=>pt.createElement("img",{class:pt.const("dcg-submission-image"),src:()=>{var e;return(e=this.entry)==null?void 0:e.thumb},alt:this.bindFn(this.getThumbAlt)}),false:()=>pt.createElement("i",{class:()=>this.getIconName(this.props.product()),"aria-hidden":pt.const("true")})}))}getIconName(e){switch(e){case"geometry-calculator":return"dcg-icon-geometry";case"graphing":return"dcg-icon-graphing";case"graphing-3d":return"dcg-icon-3d"}}},hV=class extends pt.Class{init(){this.controller=this.props.controller(),this.checkForExistingSubmission()}getScreen(){let e=tn().artStatus;if(e==="fetching")return"fetching";if(e==="failed")return"fetch-failed";if(this.controller.userController.isLoggedIn()){if(this.isFetchingSubmissions)return"fetching";if(this.fetchSubmissionsFailed)return"fetch-failed"}else return"needs-authentication";return"showing-submissions"}getTitle(e){switch(e){case"geometry-calculator":return this.controller.s("frontpage-link-shared-geometry-short");case"graphing":return this.controller.s("frontpage-link-shared-graphing-calculator-short");case"graphing-3d":return this.controller.s("frontpage-link-shared-3d-calculator-short")}}isSubmissionEligible(){return this.controller.isGraphComplexEnoughForContest()&&!this.controller.graphsController.willSaveCopy()}template(){return pt.createElement(ys,{type:()=>"art-contest",label:()=>this.controller.s("account-shell-heading-math-art-contest"),controller:this.props.controller},pt.createElement("h2",{class:pt.const("dcg-art-contest-header")},()=>this.controller.s("account-shell-heading-math-art-contest")),pt.createElement("div",{class:pt.const("dcg-art-contest-announcement")},pt.createElement("div",{class:pt.const("dcg-contest-top-paragraph")},pt.createElement(F3,{predicate:()=>this.controller.getArtContestStatus()==="open"},()=>pt.createElement(yi,{key:this.const("account-shell-text-art-contest-has-arrived"),i18n:this.props.controller},pt.const("Have a graph that you're proud of? We'd love to see it! Learn more at"),pt.const(" "),pt.createElement("a",{href:pt.const("/art"),target:pt.const("_blank"),class:pt.const("dcg-blue-link")},pt.const("desmos.com/art"),pt.createElement("span",{class:pt.const("dcg-sr-only")},pt.const(" (opens in new tab)"))),pt.const("."))),pt.createElement(F3,{predicate:()=>this.controller.getArtContestStatus()!=="open"},()=>pt.createElement(yi,{key:this.const("account-shell-text-art-contest-has-closed"),i18n:this.props.controller},pt.const("This year's contest is now closed. We're hard at work looking through all of the incredible creations, and will post results soon at"),pt.const(" "),pt.createElement("a",{href:pt.const("/art"),target:pt.const("_blank"),class:pt.const("dcg-blue-link")},pt.const("desmos.com/art"),pt.createElement("span",{class:pt.const("dcg-sr-only")},pt.const(" (opens in new tab)"))),pt.const("."))))),pt.createElement(F3,{predicate:()=>this.controller.getArtContestStatus()==="open"},()=>_ge(()=>this.getScreen(),{"needs-authentication":()=>pt.createElement("div",{class:pt.const("dcg-contest-status-section")},pt.createElement("button",{class:pt.const("dcg-btn-secondary"),onTap:({device:e})=>{this.props.controller().dispatch({type:"show-modal",modal:"login",device:e})}},()=>this.controller.s("account-shell-error-art-contest-logged-out")),pt.createElement("div",{class:pt.const("dcg-contest-deadline-notice")},()=>this.controller.s("account-shell-text-art-contest-deadline-notice"))),fetching:()=>pt.createElement("div",{class:pt.const("dcg-contest-status-section")},pt.createElement(NJ,{each:()=>BJ},pt.createElement("ul",{class:pt.const("dcg-submissions")},e=>pt.createElement("li",{class:pt.const("dcg-submission dcg-submission-loading")}))),pt.createElement("div",{class:pt.const("dcg-contest-deadline-notice")},()=>this.controller.s("account-shell-text-art-contest-loading-submissions"))),"fetch-failed":()=>pt.createElement("div",{class:pt.const("dcg-contest-status-section")},pt.createElement("div",{class:pt.const("dcg-error-message")},()=>this.controller.s("frontpage-error-something-went-wrong-try-again-later")),pt.createElement("button",{class:pt.const("dcg-btn-secondary"),onTap:this.bindFn(this.checkForExistingSubmission)},()=>this.controller.s("account-shell-button-mygraphs-try-again"))),"showing-submissions":()=>pt.createElement("div",{class:pt.const("dcg-contest-status-section")},pt.createElement(NJ,{each:()=>BJ},pt.createElement("ul",{class:pt.const("dcg-submissions")},e=>{var i;let t=(i=this.submissions)==null?void 0:i.find(o=>(o==null?void 0:o.product)===e);return pt.createElement("li",null,N3(()=>this.isCurrentProduct(e),{false:()=>pt.createElement("a",{class:()=>({"dcg-submission":!0,"dcg-not-yet-submitted":!t}),href:()=>this.getEntryURL(e,t),target:pt.const("_blank"),"aria-label":()=>this.getTileAriaLabel(e,t)},pt.createElement(uV,{entry:()=>t,product:()=>e,controller:()=>this.controller})),true:()=>pt.createElement("button",{class:()=>({"dcg-disabled":this.disableTileLink(e,t),"dcg-submission":!0,"dcg-not-yet-submitted":!t}),disabled:()=>this.disableTileLink(e,t)?!0:void 0,"aria-label":()=>this.getTileAriaLabel(e,t),onTap:({device:o})=>{this.disableTileLink(e,t)||this.controller.dispatch({type:"show-modal",modal:"contest-submission",device:o,currentSubmission:this.currentToolSubmission})}},pt.createElement(uV,{entry:()=>t,product:()=>e,controller:()=>this.controller}))}),pt.createElement("h3",{class:pt.const("dcg-submission-title")},this.const(this.getTitle(e))))})),pt.createElement("div",null,pt.createElement("button",{class:()=>({"dcg-btn-primary":!0,"dcg-disabled":this.disableButtonLink()}),onTap:e=>{this.controller.logEvent({category:"art-contest",action:"open-modal"}),this.controller.dispatch({type:"show-modal",modal:"contest-submission",device:e.device,currentSubmission:this.getCurrentSubmission()})},disabled:()=>this.disableButtonLink()?"true":void 0},N3(()=>!!this.getCurrentSubmission().submission_id,{true:()=>pt.createElement("span",null,()=>this.controller.isGraphComplexEnoughForContest()?this.controller.s("account-shell-text-art-contest-view-or-update-submission"):this.controller.s("account-shell-text-art-contest-view-submission")),false:()=>pt.createElement("span",null,()=>this.controller.getProduct()==="geometry-calculator"?this.controller.s("account-shell-text-art-contest-submit-construction"):this.controller.s("account-shell-text-art-contest-submit-graph"))}))),pt.createElement("div",{class:pt.const("dcg-contest-deadline-notice")},()=>this.isSubmissionEligible()?this.controller.s("account-shell-text-art-contest-deadline-notice"):this.controller.s("account-shell-text-art-contest-create-graph-notice")))})))}disableButtonLink(){return!this.isSubmissionEligible()&&!this.currentToolSubmission}disableTileLink(e,t){return this.isCurrentProduct(e)&&!t&&!this.isSubmissionEligible()}getEntryURL(e,t){if(t&&t.url)return t.url;switch(e){case"geometry-calculator":return"/geometry";case"graphing":return"/calculator";case"graphing-3d":return"/3d"}}getTileAriaLabel(e,t){if(this.disableTileLink(e,t))return;let i="";if(t)switch(e){case"geometry-calculator":i=this.controller.s("account-shell-text-art-contest-your-geometry-submission");break;case"graphing":i=this.controller.s("account-shell-text-art-contest-your-2d-submission");break;case"graphing-3d":i=this.controller.s("account-shell-text-art-contest-your-3d-submission");break}else switch(e){case"geometry-calculator":i=this.controller.s("frontpage-link-shared-geometry-short");break;case"graphing":i=this.controller.s("frontpage-link-shared-graphing-calculator-short");break;case"graphing-3d":i=this.controller.s("frontpage-link-shared-3d-calculator-short");break}return this.isCurrentProduct(e)?i:this.controller.s("shared-label-opens-in-new-tab-suffix",{title:i})}isCurrentProduct(e){return this.controller.getProduct()===e}getCurrentSubmission(){var t,i,o,n;if(this.currentToolSubmission)return this.currentToolSubmission;let e=this.controller.getProduct();if(e==="geometry")throw new Error("Art contest does not work on legacy geometry tool.");return{product:e,graph_hash:this.controller.graphsController.getCurrentGraphHash(),title:this.controller.graphsController.getCurrentGraphTitle(),submitting_for_someone_else:!1,birth_year:(i=(t=this.submissions)==null?void 0:t[0])==null?void 0:i.birth_year,country:(n=(o=this.submissions)==null?void 0:o[0])==null?void 0:n.country}}async checkForExistingSubmission(){if(this.controller.userController.isLoggedIn()){this.isFetchingSubmissions=!0,this.fetchSubmissionsFailed=!1;try{let e=await ev();if(!this._isMounted)return;let t=e.filter(i=>(i==null?void 0:i.user_id)===this.controller.userController.getUserId()&&!(i!=null&&i.submitting_for_someone_else));this.currentToolSubmission=t.find(i=>i.product===this.controller.getProduct()),this.submissions=t}catch(e){if(!this._isMounted)return;this.fetchSubmissionsFailed=!0}finally{this._isMounted&&(this.isFetchingSubmissions=!1,this.update())}}}};var Ft=__dcg_shared_module_exports__['e'](te());var En=__dcg_shared_module_exports__['e'](te()),{Input:Oge,Switch:Rge}=En.Components,rv=class extends En.Class{template(){return En.createElement("div",{class:En.const("dcg-selectable-input-container")},En.createElement(Oge,{class:this.const("dcg-permalink select-all dcg-variable-permalink"),"aria-label":()=>this.props.controller().s("graphing-calculator-narration-share-graph-link"),name:()=>this.props.controller().s("graphing-calculator-text-share-graph-link"),value:this.props.link,didMount:e=>{this.inputEl=e,this.inputEl.focus(),this.inputEl.select()},onTap:()=>this.inputEl.select(),onInput:()=>{}}),En.createElement("div",{role:En.const("button"),tabindex:En.const(0),class:En.const("dcg-copy-button"),onTap:this.bindFn(this.copyLink)},En.createElement(Rge,{key:()=>this.copyStatus},e=>e=="success"?En.createElement("span",{"aria-label":()=>this.props.controller().s("graphing-calculator-narration-share-graph-link-copied")},En.createElement("i",{class:En.const("dcg-icon-check"),"aria-hidden":En.const("true")})):e=="error"?En.createElement("span",{"aria-label":()=>this.props.controller().s("graphing-calculator-narration-share-graph-link-unable-to-copy")},En.createElement("i",{class:En.const("dcg-icon-error"),"aria-hidden":En.const("true")})):En.createElement("span",{class:En.const("dcg-copy-text")},()=>this.props.controller().s("graphing-calculator-button-share-graph-link-copy")))))}copyLink(){var e,t;if(this.inputEl){this.inputEl.select(),this.copyStatus="success";try{document.execCommand("copy")}catch(i){this.copyStatus="error"}this._isMounted&&((t=(e=this.props).triggerLogEvent)==null||t.call(e),this.update(),clearTimeout(this.copyStatusTimeout),this.copyStatusTimeout=setTimeout(this.bindIfMounted(()=>{this.copyStatus=null,this.update()}),2500))}}};var{If:Mm,Textarea:Fge}=Ft.Components,gV=class extends Ft.Class{init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController,this.graph=null,this.shareInProgress=!0,this.didSharingFail=!1,xo({category:"share",action:"open-menu"})}template(){return Ft.createElement(ys,{title:()=>this.controller.s("account-shell-heading-share-graph"),type:Ft.const("share"),label:()=>this.controller.s("account-shell-narration-share-options"),controller:this.props.controller},Ft.createElement("div",{class:Ft.const("dcg-popover-content")},Ft.createElement(Mm,{predicate:()=>this.shareInProgress},()=>Ft.createElement("div",{class:Ft.const("dcg-loading")},Ft.createElement("span",{class:Ft.const("dcg-spinner")}),()=>this.controller.s("account-shell-label-loading"))),Ft.createElement(Mm,{predicate:()=>this.didSharingFail},()=>Ft.createElement("div",{class:Ft.const("dcg-failed")},Ft.createElement("span",{"aria-live":Ft.const("assertive"),"aria-atomic":Ft.const(!0)},()=>this.controller.s("account-shell-error-sharing-link")+" "),Ft.createElement("button",{class:Ft.const("dcg-unstyled-button dcg-action-retry"),onTap:()=>(this.controller.dispatch({type:"toggle-menu",payload:"none"}),this.controller.dispatch({type:"toggle-menu",payload:"share"}))},()=>this.controller.s("account-shell-button-retry-now")),()=>` ${this.controller.s("account-shell-text-or")} `,Ft.createElement("button",{class:Ft.const("dcg-unstyled-button dcg-action-close"),onTap:()=>this.controller.dispatch({type:"toggle-menu",payload:"share"})},()=>this.controller.s("account-shell-button-cancel")),Ft.const("."))),Ft.createElement(Mm,{predicate:()=>!this.shareInProgress&&!this.didSharingFail},()=>Ft.createElement("div",{class:Ft.const("dcg-loaded"),didMount:this.bindFn(this.didMountLoaded)},()=>this.controller.s("account-shell-label-share-link"),Ft.createElement(rv,{controller:this.props.controller,link:()=>this.getGraphPath(),triggerLogEvent:()=>xo({category:"share",action:"copy-link"})}),Ft.createElement(Mm,{predicate:()=>!this.controller.shouldDisablePrintAndExport()},()=>Ft.createElement("div",{class:Ft.const("dcg-share-actions")},Ft.createElement(Mm,{predicate:()=>this.controller.product!=="geometry-calculator"},()=>Ft.createElement("span",{class:Ft.const("dcg-print-link"),onTap:this.bindFn(this.print),tabindex:Ft.const("0"),role:Ft.const("link")},Ft.createElement("i",{class:Ft.const("dcg-icon-print"),"aria-hidden":Ft.const("true")}),Ft.createElement("span",null,()=>this.controller.s("account-shell-button-print")))),Ft.createElement(Mm,{predicate:()=>this.controller.product!=="graphing-3d"},()=>Ft.createElement("span",{class:Ft.const("dcg-export-image-link"),onTap:this.bindFn(this.exportImage),tabindex:Ft.const("0"),role:Ft.const("link")},Ft.createElement("i",{class:Ft.const("dcg-icon-export"),"aria-hidden":Ft.const("true")}),Ft.createElement("span",null,()=>this.controller.s("account-shell-button-export-image")))),Ft.createElement(Mm,{predicate:()=>this.controller.product!=="geometry-calculator"},()=>Ft.createElement("button",{class:()=>({"dcg-unstyled-button":!0,"dcg-embed-link":!0,"dcg-selected":this.embedVisible}),onTap:this.bindFn(this.toggleEmbedVisible),"aria-pressed":()=>this.embedVisible},Ft.createElement("i",{class:Ft.const("dcg-icon-embed"),"aria-hidden":Ft.const("true")}),Ft.createElement("span",null,()=>this.controller.s("account-shell-button-embed")))))),Ft.createElement(Mm,{predicate:()=>this.embedVisible},()=>Ft.createElement("div",{class:Ft.const("dcg-embed-div share-div"),didMount:this.bindFn(this.didMountTextarea)},Ft.createElement(Fge,{rows:Ft.const("6"),class:Ft.const("select-all first-input dcg-variable-htmlembedcode"),value:()=>this.getGraphEmbedCode(),onInput:()=>{}})))))))}didMountTextarea(e){let t=e.querySelector("textarea");t.select(),t.focus()}toggleEmbedVisible(){this.embedVisible=!this.embedVisible,xo({category:"share",action:"embed-graph"}),this._isMounted&&this.update()}didMountLoaded(){this.embedVisible=!1}print(){xo({category:"share",action:"print-graph"}),window.print()}exportImage(e){xo({category:"share",action:"export-image"}),this.controller.dispatch({type:"show-modal",modal:"export-image",device:e.device})}getGraphPath(){return this.graph!=null?this.graph.getURL():void 0}getGraphEmbedCode(){return this.graph?`<iframe src="${`${this.getGraphPath()}?embed`}" width="500" height="500" style="border: 1px solid #ccc" frameborder=0></iframe>`:""}async didMount(){try{let e=await this.graphsController.shareGraph();if(!this._isMounted)return;this.graph=e}catch(e){if(!this._isMounted)return;this.didSharingFail=!0}finally{this._isMounted&&(this.shareInProgress=!1,this.update())}}};var Sn=__dcg_shared_module_exports__['e'](te());var Ci=__dcg_shared_module_exports__['e'](te());var yd=class extends Ci.Class{template(){return Ci.createElement("a",{href:()=>this.props.href(),target:Ci.const("_blank"),class:Ci.const("dcg-resource-link")},Ci.createElement("i",{class:()=>this.props.icon(),"aria-hidden":Ci.const("true")}),Ci.createElement("span",null,()=>this.props.title(),Ci.const(" ")))}},mV=class extends Ci.Class{init(){this.controller=this.props.controller()}template(){return Ci.createElement("div",{class:Ci.const("dcg-popover-content dcg-resources-content"),role:Ci.const("region"),"aria-label":()=>this.controller.s("account-shell-heading-resources")},Ci.createElement(yd,{href:Ci.const("https://help.desmos.com/hc/en-us/articles/4406040715149-Getting-Started-Desmos-Graphing-Calculator"),icon:Ci.const("dcg-icon-rocket"),title:()=>this.controller.s("account-shell-link-getting-started")}),Ci.createElement(yd,{href:Ci.const("https://www.youtube.com/playlist?list=PLfM6zMGnbgOGLZc-_Yj3QVK3Vz_L4Cw59"),icon:Ci.const("dcg-icon-film"),title:()=>this.controller.s("account-shell-link-video-tutorials")}),Ci.createElement(yd,{href:()=>{let e=this.controller.languageController.getLanguage();return pc[e]?pc[e].userGuideURL:pc.en.userGuideURL},icon:Ci.const("dcg-icon-book"),title:()=>this.controller.s("account-shell-link-user-guide")}),Ci.createElement(yd,{href:Ci.const("https://help.desmos.com/"),icon:Ci.const("dcg-icon-comments"),title:()=>this.controller.s("account-shell-link-help-center")}),Ci.createElement("div",{class:Ci.const("dcg-resource-link dcg-action-show-hotkeys"),role:Ci.const("link"),tabindex:Ci.const(0),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"hotkeys",device:e.device})},Ci.createElement("i",{class:Ci.const("dcg-icon-keyboard"),"aria-hidden":Ci.const("true")}),Ci.createElement("span",null,()=>this.controller.s("account-shell-link-keyboard-shortcuts"))))}};var zi=__dcg_shared_module_exports__['e'](te());function fV(r,e){if(!e.hasOwnProperty("myGraphs"))throw new Error("Argument Error: saveGraph options must specify myGraphs");if(!e.hasOwnProperty("isUpdate"))throw new Error("Argument Error: saveGraph options must specify isUpdate");let t={parent_hash:r.parentHash,recovery_parent_hash:r.recoveryParentHash,thumb_data:r.thumbURL,graph_hash:r.hash,my_graphs:e.myGraphs,is_update:e.isUpdate,recovery:e.recovery,title:r.title||void 0,calc_state:r.graphData,lang:e.lang,product:e.product};return ta("/api/v1/calculator/save",t).then(i=>(ra.updateFromSync(r,i),r))}function UJ(r){return ta("/api/v1/calculator/email_feedback",r)}function B3(r){return Ic("/api/v1/calculator/my_graphs",r)}function zJ(r){return Ic("/api/v1/calculator/recovery_graphs",r)}function KJ(r){return ta("/api/v1/calculator/my_graphs/remove",r)}function qJ(){return ta("/api/v1/calculator/recovery_graphs/clear")}function U3(r,e){if(!e.hasOwnProperty("myGraphs"))throw new Error("Argument Error: saveGraph options must specify myGraphs");if(!e.hasOwnProperty("isUpdate"))throw new Error("Argument Error: saveGraph options must specify isUpdate");var t={parent_hash:r.parentHash,thumb_data:r.thumbURL,graph_hash:r.hash,my_graphs:e.myGraphs,is_update:e.isUpdate,title:r.title||void 0};return t.state=r.graphData,ta("/api/v1/calculator_3d/save",t).then(function(i){return ra.updateFromSync(r,i),r})}function WJ(r){return ta("/api/v1/calculator_3d/email_feedback",r)}function $J(){return Ic("/api/v1/calculator_3d/my_graphs")}function jJ(r){return ta("/api/v1/calculator_3d/my_graphs/remove",{hash:r.hash})}var Yt=__dcg_shared_module_exports__['e'](te());qt();function z3(r){var t;let e=(t=r==null?void 0:r.responseJSON)==null?void 0:t.errors;return Array.isArray(e)?e:[{message:"Unexpected server error. Try again, or e-mail calculator@desmos.com."}]}function bV(r){return z3(r).map(e=>e.message)}var xd="[^@\\s]+@[^@\\s]+\\.[^@\\s]+";var{If:n0,For:Nge,Input:Bge,Textarea:Uge}=Yt.Components,yV=class extends Yt.Class{init(){this.controller=this.props.controller(),this.userController=this.controller.userController,this.formErrors=[],this.feedbackInProgress=!1,this.feedbackFromEmail=this.userController.getEmail(),this.didSendFeedbackEmail=!1}template(){return Yt.createElement("div",{class:Yt.const("dcg-suggestions")},Yt.createElement("div",{class:Yt.const("template-errors")},Yt.createElement(n0,{predicate:()=>!!this.formErrors.length},()=>Yt.createElement(Nge,{each:()=>this.formErrors},Yt.createElement("span",null,e=>Yt.createElement("div",{class:Yt.const("errors")},Yt.createElement("span",null,()=>e)))))),Yt.createElement("form",{didMount:this.bindFn(this.didMountContactForm),class:Yt.const("dcg-action-submit"),id:Yt.const("support-contact-us-form")},Yt.createElement("div",{class:Yt.const("dcg-feedback-message-label")},()=>this.controller.s("account-shell-label-feedback-message")),Yt.createElement(Uge,{placeholder:()=>this.controller.s("account-shell-label-feedback-placeholder"),didMount:this.bindFn(this.didMountTextArea),disabled:()=>!this.shouldAllowSubmission(),class:Yt.const("dcg-shared-input-blue-outline"),name:Yt.const("message"),value:()=>this.controller.getFeedbackMessage(),onInput:e=>{if(this.controller.setFeedbackMessage(e),this._isMounted)return this.update()}}),Yt.createElement("div",{class:Yt.const("dcg-suggestions-expansion")},Yt.createElement("div",{class:Yt.const("dcg-feedback-email-label")},()=>this.controller.s("account-shell-label-feedback-email")),Yt.createElement(Bge,{name:Yt.const("provided-email"),class:Yt.const("dcg-provided-email dcg-shared-input-blue-outline"),placeholder:()=>this.controller.s("account-shell-label-email-placeholder"),disabled:()=>!this.shouldAllowSubmission(),type:Yt.const("email"),pattern:this.const(xd),value:()=>this.feedbackFromEmail,onInput:e=>{if(this.feedbackFromEmail=e,this._isMounted)return this.update()}}),Yt.createElement("div",{class:Yt.const("dcg-feedback-action-container")},Yt.createElement(n0,{predicate:()=>this.feedbackInProgress},()=>Yt.createElement("div",{class:Yt.const("dcg-template-processing")},Yt.createElement("span",{class:Yt.const("dcg-spinner")}),()=>this.controller.s("account-shell-label-feedback-sending"))),Yt.createElement(n0,{predicate:()=>this.didSendFeedbackEmail},()=>Yt.createElement("div",{class:Yt.const("dcg-template-sent")},Yt.createElement("i",{class:Yt.const("dcg-icon-check"),"aria-hidden":Yt.const("true")}),()=>this.controller.s("account-shell-text-feedback-sent"))),Yt.createElement(n0,{predicate:this.bindFn(this.shouldAllowSubmission)},()=>Yt.createElement("span",{class:Yt.const("dcg-feedback-btns")},Yt.createElement(n0,{predicate:()=>this.controller.product!=="geometry-calculator"},()=>Yt.createElement("button",{class:Yt.const("dcg-unstyled-button dcg-action-closesuggestion"),onTap:this.bindFn(this.onCancel)},()=>this.controller.s("account-shell-button-cancel"))),Yt.createElement("button",{class:()=>({"dcg-btn-blue":!0,"dcg-disabled":this.submitDisabled()}),name:Yt.const("submit"),type:Yt.const("submit")},()=>this.controller.s("account-shell-button-contact-us"))))))))}submitDisabled(){let e=document.querySelector('textarea[name="message"]');return!e||e.value.trim().length===0}didMountContactForm(e){return ie(e).on("submit",t=>(t.preventDefault(),this.submitForm()))}didMountTextArea(e){this._isMounted&&e.focus()}shouldAllowSubmission(){return!this.feedbackInProgress&&!this.didSendFeedbackEmail}onCancel(){this.controller.setFeedbackMessage(""),this.controller.dispatch({type:"show-contact-form",showForm:!1})}async submitForm(){if(this.submitDisabled())return;this.didSendFeedbackEmail=!1,this.feedbackInProgress=!0,this.formErrors=[];let e=document.querySelector('textarea[name="message"]').value.trim(),t=this.controller.product;if(t!=="graphing"&&t!=="graphing-3d"&&t!=="geometry-calculator")throw new Error(`Unexpected product: ${t}`);let i=document.querySelector('input[name="provided-email"]'),o={message:e,state:JSON.stringify(this.controller.api.getState()),userAgent:navigator.userAgent,"provided-email":i?i.value:"",product:t,lang:this.controller.getLanguage()};this._isMounted&&this.update();try{if(t==="graphing-3d"?await WJ(o):await UJ(o),!this._isMounted)return;this.didSendFeedbackEmail=!0,this.controller.setFeedbackMessage(""),setTimeout(this.bindIfMounted(()=>{this.didSendFeedbackEmail=!1,this.update()}),2e3)}catch(n){this.formErrors=bV(n).map(a=>this.controller.raw(a))}finally{this.feedbackInProgress=!1,this._isMounted&&this.update()}}};var{IfElse:XJ,If:JJ}=zi.Components,Im=class extends zi.Class{handleClick(){this.props.controller().dispatch({type:"show-contact-form",showForm:!0})}template(){return zi.createElement("div",{class:zi.const("dcg-popover-content dcg-hide-on-mobile"),"aria-label":()=>this.props.controller().s("account-shell-label-feedback")},zi.createElement(JJ,{predicate:()=>this.props.controller().product==="geometry-calculator"},()=>zi.createElement("div",{class:zi.const("dcg-contact-warning")},zi.createElement(yi,{i18n:this.props.controller,key:this.const("account-shell-text-geometry-beta-notice")},zi.const("Thank you for visiting our new Geometry Tool! Please share any bugs, questions, or suggestions with us below.")))),zi.createElement(JJ,{predicate:()=>this.props.controller().product==="graphing-3d"},()=>zi.createElement("div",{class:zi.const("dcg-contact-warning")},zi.createElement(yi,{i18n:this.props.controller,key:this.const("account-shell-text-3d-beta-notice")},zi.const("Thank you for visiting our Beta 3D Calculator! Please share any bugs, questions, or suggestions with us below.")))),XJ(()=>this.props.controller().requestedContactForm(),{true:()=>zi.createElement("div",{class:zi.const("dcg-resources-content dcg-feedback-content")},zi.createElement(yV,{controller:this.props.controller})),false:()=>zi.createElement("div",{class:zi.const("dcg-contact-us")},zi.createElement("button",{class:zi.const("dcg-unstyled-button dcg-contact-link"),"aria-expanded":zi.const("false"),"aria-controls":zi.const("support-contact-us-form"),onTap:this.bindFn(this.handleClick)},zi.createElement("i",{class:zi.const("dcg-icon-mail"),"aria-hidden":zi.const("true")}),XJ(()=>this.props.controller().product==="graphing-3d",{true:()=>zi.createElement("span",null,()=>this.props.controller().s("account-shell-link-send-feedback")),false:()=>zi.createElement("span",null,()=>this.props.controller().s("account-shell-link-email-support"))})))}))}};var xV=class extends Sn.Class{init(){this.controller=this.props.controller()}template(){return Sn.createElement(ys,{title:()=>this.controller.s("account-shell-heading-resources"),type:()=>"help",label:()=>this.controller.s("account-shell-label-help-menu"),controller:this.props.controller},Sn.createElement("div",{class:Sn.const("dcg-popover-content dcg-resources-content"),role:Sn.const("region"),"aria-label":()=>this.controller.s("account-shell-heading-resources")},Sn.createElement(yd,{href:()=>"https://docs.google.com/document/d/1u4fhQsXWzdCWRGfTdJSuAg9xtyiDk-wmkIAsUkb2L20/preview",icon:Sn.const("dcg-icon-book"),title:()=>this.controller.s("account-shell-link-geometry-user-guide")}),Sn.createElement(yd,{href:Sn.const("https://help.desmos.com/"),icon:Sn.const("dcg-icon-comments"),title:()=>this.controller.s("account-shell-link-help-center")}),Sn.createElement("div",{class:Sn.const("dcg-resource-link dcg-action-show-hotkeys"),role:Sn.const("link"),tabindex:Sn.const(0),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"hotkeys",device:e.device})},Sn.createElement("i",{class:Sn.const("dcg-icon-keyboard"),"aria-hidden":Sn.const("true")}),Sn.createElement("span",null,()=>this.controller.s("account-shell-link-keyboard-shortcuts")))),Sn.createElement("h2",{class:Sn.const("dcg-unstyled-heading dcg-popover-title dcg-interior-title dcg-hide-on-mobile")},()=>this.controller.s("account-shell-heading-contact-us")),Sn.createElement(Im,{controller:this.props.controller}))}};var Fr=__dcg_shared_module_exports__['e'](te());function iv(r,e){return QJ(r)||ZJ(r)}iv.is3d=!0;function QJ(r,e){return r.type!=="expression"?!1:!!r.formula&&r.formula.expression_type==="POINT3D_LIST"}QJ.is3d=!0;function ZJ(r,e){return r.type!=="expression"?!1:!!r.formula&&r.formula.expression_type==="POINT3D"}ZJ.is3d=!0;function zge(r,e){return r.type!=="expression"?!1:(!r.formula||!!r.formula.error)&&!!r.latex&&r.latex.startsWith("\\left(")||r.formula.expression_type==="POINT3D"}zge.is3d=!0;function K3(r,e){return!e||!iv(r)?!1:e.branches.some(t=>t.position[2]>0)}K3.is3d=!0;function q3(r,e){return!e||!iv(r)?!1:e.branches.some(t=>t.position[2]<0)}q3.is3d=!0;function H3(r,e){return!e||!iv(r)?!1:e.branches.some(t=>"position"in t&&t.position[0]===0&&t.position[1]===0)}H3.is3d=!0;function wV(r,e){return r.type!=="expression"?!1:!!r.extendTo3D}wV.is3d=!0;function W3(r,e){return e?e.branches.every(t=>{if(t.graphMode!==100&&t.graphMode!==128)return!1;let i=t.points[1];return t.points.every((o,n)=>n%3!==1||Math.abs(o-i)<=1e-4||isNaN(o))}):!1}W3.is3d=!0;function vV(r,e){return e?e.branches.every(t=>{if(t.graphMode!==100&&t.graphMode!==128)return!1;let i=t.points[0],o=t.points[1],n=t.points[2];return t.points.every((a,s)=>s%3!==0||Math.abs(a-i)<=1e-4||isNaN(a))||t.points.every((a,s)=>s%3!==1||Math.abs(a-o)<=1e-4||isNaN(a))||t.points.every((a,s)=>s%3!==2||Math.abs(a-n)<=1e-4||isNaN(a))}):!1}vV.is3d=!0;function CV(r,e){return e?e.branches.every(t=>t.graphMode===118):!1}CV.is3d=!0;function Kge(r,e){return e?e.branches[0].graphMode===118&&e.branches[0].position[2]<=1:!1}Kge.is3d=!0;function EV(r,e){return __dcg_shared_module_exports__['ja'](1/__dcg_shared_module_exports__['Ad'](__dcg_shared_module_exports__['zd'](r)),0,e)}function qge(r,e,t,i,o,n){return EV([[r,e,1],[t,i,1],[o,n,1]])}function Hge(r,e,t,i,o,n,a,s){return EV([[r*r+e*e,r,e,1],[t*t+i*i,t,i,1],[o*o+n*n,o,n,1],[a*a+s*s,a,s,1]])}function Wge(r,e,t,i,o,n,a,s,l,c,d,p){return EV([[r*r,e*e,2*r*e,r,e,1],[t*t,i*i,2*t*i,t,i,1],[o*o,n*n,2*o*n,o,n,1],[a*a,s*s,2*a*s,a,s,1],[l*l,c*c,2*l*c,l,c,1],[d*d,p*p,2*d*p,d,p,1]])}function $ge(r,e,t,i,o,n,a,s,l,c){return{a:__dcg_shared_module_exports__['yd'].det([[e*e,2*r*e,r,e,1],[i*i,2*t*i,t,i,1],[n*n,2*o*n,o,n,1],[s*s,2*a*s,a,s,1],[c*c,2*l*c,l,c,1]]),b:__dcg_shared_module_exports__['yd'].det([[r*r,e*e,r,e,1],[t*t,i*i,t,i,1],[o*o,n*n,o,n,1],[a*a,s*s,a,s,1],[l*l,c*c,l,c,1]]),c:-__dcg_shared_module_exports__['yd'].det([[r*r,2*r*e,r,e,1],[t*t,2*t*i,t,i,1],[o*o,2*o*n,o,n,1],[a*a,2*a*s,a,s,1],[l*l,2*l*c,l,c,1]])}}function jge(r,e,t,i,o,n,a,s,l,c,d,p){if(qge(r,e,o,n,d,p))return"line";if(Hge(r,e,t,i,l,c,d,p))return"circle";if(!Wge(r,e,t,i,o,n,a,s,l,c,d,p))return"none";var g=$ge(r,e,t,i,o,n,a,s,l,c);return EV([[g.a,g.b],[g.b,g.c]],20)?"parabola":g.b*g.b>g.a*g.c?"hyperbola":"ellipse"}function eQ(r){let e,t;if(r.length===1&&r[0].length===4)return"line";for(let i of r){let o=i.length;if(o<12)return"unknown";if(t=jge(i[0],i[1],i[2*Math.floor(1*o/12)],i[2*Math.floor(1*o/12)+1],i[2*Math.floor(2*o/12)],i[2*Math.floor(2*o/12)+1],i[2*Math.floor(3*o/12)],i[2*Math.floor(3*o/12)+1],i[2*Math.floor(4*o/12)],i[2*Math.floor(4*o/12)+1],i[o-2],i[o-1]),t==="none"||e&&t!==e)return"none";e=t}return e}function SV(r){return Na(r)&&r.type==="expression"}function ov(r,e){return Na(r)&&r.type==="expression"?!0:r.type==="expression"&&Hl(r)}function tQ(r){return eQ(r)}function a0(r,e){return r.type==="expression"}function rQ(r,e){return r.type==="expression"&&xg(r)}function $3(r,e){return r.type==="expression"&&!!r.error&&!Hl(r)}function j3(r){return function(e,t){return e.type==="expression"&&e.formula&&e.formula.variables&&e.formula.variables.length>=r}}function Xge(r){if(r.type!=="expression"||!r.formula||!r.formula.constant_value)return!1;let e=r.formula.constant_value;return typeof e=="number"&&isFinite(e)}function Y3(r,e){return!!e&&tQ(e.branches[0].segments)==="line"&&!Xge(r)}function X3(r,e){return Y3(r,e)&&Q3(r,e)}function J3(r,e){return a0(r,e)&&!X3(r,e)}function s0(r,e){return!!e&&e.branches&&e.branches.some(function(t){return tQ(t.segments)==="parabola"})}function Q3(r,e){return!r||r.type!=="expression"||!r.latex?!1:!!r.latex.match(/\\left\\{(.+)\\right\\}/)}function iQ(r,e){return!r||r.type!=="expression"||!r.latex?!1:!!r.latex.match(/\\left\\{x(.+)\\right\\}/)}function oQ(r,e){return!r||r.type!=="expression"||!r.latex?!1:!!r.latex.match(/\\left\\{y(.+)\\right\\}/)}function nQ(r,e){if(!s0(r,e)||!e)return!1;let t=e.branches[0].compiled.fn;return t(0)!==0||t(1)!==1}function aQ(r,e){return r.type==="expression"&&r.formula.assignment==="y"}function l0(r){return(e,t)=>e.type==="expression"&&ky(e.latex,r).length>0}var Hot=l0("x");function lp(r,e){return r.type==="expression"&&!!r.sliderExists&&!xg(r)}function sQ(r,e){return r.type==="expression"&&!!r.sliderExists&&r.slider.isPlaying}function c0(r,e){return r.type==="expression"&&!!r.sliderExists&&!xg(r)&&hl(r)!==1}function DV(r,e){return r.type==="table"}function nv(r,e){return r.type==="expression"&&!!r.formula&&!!r.formula.regression}function Db(r,e){if(r.type!=="table")return!1;for(let t=1;t<r.columnModels.length;t++)if(r.columnModels[t].discrete)return!0;return!1}var kV=r=>e=>e.getMatchingExpModels(lp).filter(o=>o.type==="expression").map(o=>o.formula.assignment&&__dcg_shared_module_exports__['ub'](o.formula.assignment)).some(o=>!!o&&e.hasMatchingExpression([r,l0(o)]));var Qge={version:10,randomSeed:"c13e89605fe04a21e53d878aa0a7202d",graph:{viewport:{xmin:-5,ymin:-5,zmin:-5,xmax:5,ymax:5,zmax:5},threeDMode:!0,worldRotation3D:[-.5132799671593364,-.8314696123025455,-.212607523691814,.7681777567114166,-.555570233019602,.3181896451432085,-.3826834323650897,0,.9238795325112867],axis3D:[-.9389975190442629,-.3439239154086105,-26438544160422738e-28],product:"graphing-3d"},expressions:{list:[{type:"text",id:"3",text:"3-dimensional points have three coordinates. For example, the point below is at x=1, y=2, and z=0.",readonly:!0},{type:"expression",id:"1",color:"#6042a6",latex:"\\left(1,2,0\\right)",readonly:!0}]}},lQ={title:"Plot Points in 3D",thumb:"points-2x.png",prompt:"Update the graph so that it has a point that is...",startingState:Qge,goals:[{text:"above the XY plane",expressionCriteria:[K3]},{text:"below the XY plane",expressionCriteria:[q3]},{text:"on the z-axis",expressionCriteria:[H3]},{text:"connected to a slider",complexCriterion:kV(iv)}],hintMiniTours:["add_slider"]};var Z3=r=>{if(!r.is3dProduct())return!1;let t=r.getGrapher3d();if(!t)return!1;let i=t.getCurrentViewport().zmax,o=t.mathCoordinatesToScreenCoordinates({x:0,y:0,z:0}),n=t.mathCoordinatesToScreenCoordinates({x:0,y:0,z:i!=null?i:1});return Math.abs(n.x-o.x)+Math.abs(n.y-o.y)<20},cQ=r=>{if(!r.is3dProduct())return!1;let e=r.getGrapher3d();return e?e.settings.speed3D!==0:!1},eN=r=>e=>!r(e);var Zge={version:10,randomSeed:"dc76b01fd3183b4066c467ba113fbef9",graph:{viewport:{xmin:-5,ymin:-5,zmin:-5,xmax:5,ymax:5,zmax:5},threeDMode:!0,worldRotation3D:[3749399456654644e-48,-1,6123233995736766e-32,6123233995736766e-32,6123233995736766e-32,1,-1,0,6123233995736766e-32],axis3D:[.9999999996978197,-6123233993886446e-32,59328897079605555e-46],product:"graphing-3d"},expressions:{list:[{type:"expression",id:"1",color:"#388c46",latex:"y=a\\left(x\\right)^{2}+k",readonly:!0,lines:!0,surfaces:!1},{type:"expression",id:"5",color:"#388c46",latex:"y=\\sin x",readonly:!0,lines:!0,surfaces:!1},{type:"expression",id:"6",color:"#c74440",latex:"a=0.5",hidden:!0,readonly:!0,slider:{hardMin:!0,hardMax:!0}},{type:"expression",id:"4",color:"#6042a6",latex:"k=-1.5",hidden:!0,readonly:!0,slider:{hardMin:!0,hardMax:!0}}]}},dQ={title:"Make a 3D Surface",thumb:"surfaces-2x.png",prompt:"Update this graph so that...",startingState:Zge,goals:[{text:"it's tilted so you can see the z-axis",controllerCriteria:eN(Z3)},{text:"you see the 3d surfaces for both equations",complexCriterion:r=>{let e=r.getModelById("1"),t=r.getModelById("5");return!!(e&&e.type==="expression"&&e.extendTo3D&&t&&t.type==="expression"&&t.extendTo3D)}},{text:"the colors of the two surfaces are different",complexCriterion:r=>{let e=r.getModelById("1"),t=r.getModelById("5");return!!(e&&e.type==="expression"&&t&&t.type==="expression"&&e.color!==t.color)}},{text:"it has momentum, rotating around the z-axis",controllerCriteria:[cQ,eN(Z3)]}],hintMiniTours:["change_line_to_surface","change_color_3d"]};var eme={version:10,randomSeed:"4fd2b19fe0ef32598432e66d6dea4a8d",graph:{viewport:{xmin:-5,ymin:-5,zmin:-5,xmax:5,ymax:5,zmax:5},threeDMode:!0,worldRotation3D:[-.4034467850661228,-.9130294825148988,-.0600654283128971,.9030757945548551,-.4078935695234748,.13445053079307687,-.14725760051335893,-4673193812242393e-29,.9890981746475297],axis3D:[0,0,-1.0000000000030735],product:"graphing-3d"},expressions:{list:[{type:"text",id:"6",text:'The "sphere" function requires a center point and a radius. For example: sphere((0,0,0), 3) will draw a sphere of radius 3 at the origin.',readonly:!0},{type:"expression",id:"1",color:"#c74440",latex:"\\operatorname{sphere}\\left(\\left(0,0,-2\\right),\\ 2\\right)",readonly:!0},{type:"expression",id:"2",color:"#2d70b3",latex:"\\operatorname{sphere}\\left(\\left(0,0,H\\right),R\\right)",readonly:!0},{type:"expression",id:"4",color:"#6042a6",latex:"H=2",hidden:!0,readonly:!0,slider:{hardMin:!0,min:"-2"}},{type:"expression",id:"3",color:"#388c46",latex:"R=2",hidden:!0,readonly:!0,slider:{hardMin:!0,min:"0"}}]}},pQ={title:"Build a Snowman",thumb:"snowman-2x.png",prompt:"Update this graph so that...",startingState:eme,goals:[{text:"the top sphere is smaller than the bottom one, but still touching",complexCriterion:r=>{let e=r.getExpSketchById("2");if(!e||e.branches.length!==1||e.branches[0].graphMode!==118)return!1;let t=e.branches[0],i=Math.abs(t.radius[2]);return i<2&&t.position[2]<=i&&t.position[2]>=-i}},{text:"it has a third sphere that's even smaller and on top of the other two",complexCriterion:r=>{var i;let e=(i=r.getExpSketchById("2"))==null?void 0:i.branches[0];return(e==null?void 0:e.graphMode)!==118?!1:r.getMatchingExpIds(CV).some(o=>{var s;let n=(s=r.getExpSketchById(o))==null?void 0:s.branches[0];return(n==null?void 0:n.graphMode)!==118?!1:Math.sqrt(Math.pow(n.position[0]-e.position[0],2)+Math.pow(n.position[1]-e.position[1],2)+Math.pow(n.position[2]-e.position[2],2))<=Math.abs(e.radius[2])+Math.abs(n.radius[2])+1e-4&&n.position[2]>e.position[2]&&n.radius[2]<e.radius[2]})}},{text:"the spheres are all the same color",complexCriterion:r=>{let t=r.getMatchingExpIds(CV).map(o=>r.getModelById(o)),{color:i}=t[0];return t.every(o=>o.color===i)}},{text:"the axes and grid are hidden",complexCriterion:r=>r.getState().graph.showAxis3D===!1}],hintMiniTours:["change_color_3d","turn_off_axes"]};var tme={version:10,randomSeed:"c60138920fbda2e34d39e64024c81e8f",graph:{viewport:{xmin:-5,ymin:-5,zmin:-5,xmax:5,ymax:5,zmax:5},threeDMode:!0,worldRotation3D:[-.7911610162161196,.5672186659200341,-.22875146218502837,-.5448994070006874,-.8235672316404455,-.15754888517028243,-.27775687690890294,1234910249295711e-28,.960651402606498],axis3D:[0,0,-.9999999999834579],product:"graphing-3d"},expressions:{list:[{type:"text",id:"6",text:'If you restrict a surface to a single x, y, or z value it graphs a "slice" of that surface. Here we can use that to show conic sections.',readonly:!0},{type:"expression",id:"1",color:"#c74440",latex:"z^{2}=x^{2}+y^{2}",readonly:!0},{type:"expression",id:"4",color:"#6042a6",latex:"z^{2}=x^{2}+y^{2}\\left\\{x=1\\right\\}",readonly:!0}]}},uQ={title:"Slice a Surface",thumb:"slices-2x.png",prompt:"Update this graph so that...",startingState:tme,goals:[{text:"there is a slice with a constant y value (y-slice)",expressionCriteria:W3},{text:"there are at least 3 z-slices",complexCriterion:r=>r.getUniqueSliceValues("z").length>=3},{text:"at least 1 slice is connected to a slider",complexCriterion:kV(vV)},{text:"all of the slices are the same color",complexCriterion:r=>{let e=r.getMatchingExpModels(vV);if(e.length===0)return!1;let t=e[0].color;return e.every(i=>i.color===t)}}],hintMiniTours:["change_color_3d","add_slider"]};var rme={version:10,randomSeed:"303b2b2529c124fd179bcf0928c52bf1",graph:{viewport:{xmin:-5,ymin:-5,zmin:-5,xmax:5,ymax:5,zmax:5},threeDMode:!0,worldRotation3D:[-.4566162267528601,-.8805869756969109,-.126760402725266,.848498419860239,-.47388456213838426,.23555010775147064,-.2674921549518761,-53011017512727e-26,.9635600381083326],axis3D:[-.8805869757112816,-.4738845621467119,17425479990120072e-28],product:"graphing-3d"},expressions:{list:[{type:"text",id:"3",text:"You can use lists to slice a surface in several places at once. Lists are are defined by [start ... end]. You can also set a step size with the second number. For example [0, 2, ... 20] will just be the evens from 0 to 20.",readonly:!0},{type:"expression",id:"1",color:"#aaaaaa",latex:"f\\left(x,y\\right)=\\frac{x^{2}-y^{2}}{6}",readonly:!0},{type:"expression",id:"4",color:"#2d70b3",latex:"z=f\\left(x,y\\right)\\left\\{x=a\\right\\}",readonly:!0},{type:"expression",id:"5",color:"#6042a6",latex:"a=\\left[-5...5\\right]",hidden:!0}]}},hQ={title:"Make a Mesh",thumb:"mesh-2x.png",prompt:"Update this graph so that...",startingState:rme,goals:[{text:"it also has a list of y-slices",complexCriterion:r=>r.getUniqueSliceValues("y").length>1},{text:"the slices are denser, so there are at least 20 x-slices and 20 y-slices",complexCriterion:r=>{let e=r.getUniqueSliceValues("x"),t=r.getUniqueSliceValues("y");return e.length>=20&&t.length>=20}},{text:"the surface is hidden so that you only see the mesh",complexCriterion:r=>{let e=r.getModelById("1");return!!e&&e.type==="expression"&&e.hidden===!0}},{text:"the axes and grid are hidden",complexCriterion:r=>r.getState().graph.showAxis3D===!1}],hintMiniTours:["turn_off_axes"]};var Ll={"0aab81de":lQ,"46fc0484":dQ,ecd99f28:pQ,"3a96cffc":uQ,be0997b4:hQ};var{For:ime,If:ome}=Fr.Components,gQ=6,GV=class extends Fr.Class{init(){this.controller=this.props.controller()}template(){return Fr.createElement(ys,{title:()=>this.controller.s("graphing-calculator-heading-quests"),type:()=>"help",label:()=>this.controller.s("account-shell-label-help-menu"),controller:this.props.controller},Fr.createElement("div",{class:Fr.const("dcg-popover-content dcg-resources-content dcg-3d-help-resources"),role:Fr.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-heading-quests")},Fr.createElement(ime,{each:()=>Object.keys(Ll).slice(0,gQ)},Fr.createElement("ul",{class:Fr.const("dcg-unstyled-list")},e=>Fr.createElement("li",null,Fr.createElement("a",{class:Fr.const("dcg=unstyled-link dcg-resource-link"),tabindex:Fr.const("0"),role:Fr.const("link"),onTap:()=>this.launchQuest(e)},Fr.createElement("span",null,()=>this.controller.raw(Ll[e].title)))))),Fr.createElement(ome,{predicate:()=>Object.keys(Ll).length>gQ},()=>Fr.createElement("button",{class:Fr.const("dcg-unstyled-button dcg-resource-link dcg-resources-view-all-quests"),onTap:()=>this.showQuestsModal()},Fr.createElement("span",null,()=>this.controller.s("account-shell-link-view-all-quests"))))),Fr.createElement("h2",{class:Fr.const("dcg-unstyled-heading dcg-popover-title")},()=>this.controller.s("account-shell-heading-resources")),Fr.createElement("div",{class:Fr.const("dcg-popover-content dcg-resources-content"),role:Fr.const("region")},Fr.createElement(yd,{href:()=>"https://docs.google.com/document/d/1jDJC0Zw7cB82SNEc04m5HGQHaXYaJK62iZM88ojNYwI/preview",icon:Fr.const("dcg-icon-book"),title:()=>this.controller.s("account-shell-link-3d-user-guide")}),Fr.createElement(yd,{href:Fr.const("https://help.desmos.com/"),icon:Fr.const("dcg-icon-comments"),title:()=>this.controller.s("account-shell-link-help-center")}),Fr.createElement("button",{class:Fr.const("dcg-unstyled-button dcg-resource-link dcg-action-show-hotkeys"),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"hotkeys",device:e.device})},Fr.createElement("i",{class:Fr.const("dcg-icon-keyboard"),"aria-hidden":Fr.const("true")}),Fr.createElement("span",null,()=>this.controller.s("account-shell-link-keyboard-shortcuts")))),Fr.createElement("h2",{class:Fr.const("dcg-unstyled-heading dcg-popover-title dcg-interior-title dcg-hide-on-mobile")},()=>this.controller.s("account-shell-heading-contact-us")),Fr.createElement(Im,{controller:this.props.controller}))}launchQuest(e){xo({category:"quest",action:"select-from-help-menu",name:Ll[e].title}),this.controller.tourController.startQuest(e),this.controller.dispatch({type:"toggle-menu",payload:"none"})}showQuestsModal(){this.controller.tourController.setQuestsListModalVisibility(!0),this.controller.dispatch({type:"toggle-menu",payload:"none"})}};var wd=__dcg_shared_module_exports__['e'](te());var Rs=__dcg_shared_module_exports__['e'](te());var{For:nme,If:ame}=Rs.Components,tN=class extends Rs.Class{init(){this.controller=this.props.controller(),this.tourController=this.controller.tourController}getBaseUrl(){switch(this.controller.getProduct()){case"graphing-3d":return"3d";case"geometry-calculator":return"geometry";default:return"calculator"}}template(){return Rs.createElement("a",{class:Rs.const("dcg-feature"),href:()=>`/${this.getBaseUrl()}?tour=${this.props.name()}`,target:Rs.const("_blank"),ignoreRealClick:()=>!this.tourController.shouldPopupTour(this.props.name()),onTap:e=>{if(!this.tourController.shouldPopupTour(this.props.name()))return e.originalEvent.preventDefault(),this.controller.dispatch({type:"toggle-menu",payload:"none"}),this.tourController.startTour(this.props.name())}},Rs.createElement("span",{class:()=>({"dcg-thumb":!0,[this.getTourClassName()]:!0})}),()=>this.controller.s(this.props.titleKey()))}getTourClassName(){switch(this.props.name()){case"regressions":return"dcg-regressions-thumb";case"restrictions":return"dcg-restrictions-thumb";case"sliders":return"dcg-sliders-thumb";case"tables":return"dcg-tables-thumb";default:return"dcg-unknown-thumb"}}},TV=class extends Rs.Class{init(){this.controller=this.props.controller()}template(){return Rs.createElement(nme,{each:()=>Object.keys(this.props.tours())},Rs.createElement("div",{class:Rs.const("dcg-popover-content dcg-tours-content"),role:Rs.const("region"),"aria-label":()=>this.controller.s("account-shell-heading-tours")},e=>Rs.createElement(ame,{predicate:()=>!this.props.tours()[e].hideInHelp},()=>Rs.createElement(tN,{name:()=>e,titleKey:()=>this.props.tours()[e]?this.props.tours()[e].titleKey:"",controller:this.props.controller}))))}};var Mo=__dcg_shared_module_exports__['e'](te());var{IfDefined:sme,For:lme,Switch:cme}=Mo.Components;function iN(r,e){if(!r||!e||r.innerHTML!==e.innerHTML)return!1;let t=Array.isArray(r.content);return t!==Array.isArray(e.content)||t&&__dcg_shared_module_exports__['v'](r.content,e.content).length>0?!1:!(!t&&r.content!==e.content)}var rN=class extends Mo.Class{setInnerHtml(){var t;let e=this.props.innerHTML();if(e){let i=document.getElementById("dcg-trip-content--inner");i&&(i.innerHTML=e),(t=this.findRootNode())==null||t.querySelectorAll(".dcg-trip-math:not(.dcg-mq-math-mode)").forEach(o=>{Zc.StaticMath(o)})}}didMount(){this.setInnerHtml()}didUpdate(){this.setInnerHtml()}template(){return Mo.createElement("div",{id:Mo.const("dcg-trip-content--inner")})}},av=class extends Mo.Class{init(){this.controller=this.props.controller()}getTargetElement(){var t;let e=this.props.target();if("element"in e)return e.element!==null&&e.element?e.element:void 0;if("selector"in e){let i=(t=this.controller.getRootElt())==null?void 0:t.querySelector(e.selector);return i!==null&&i?i:void 0}else return}getTargetPosition(){let e=this.props.target(),t=this.getTargetElement(),i="getCanvasPos"in e&&e.getCanvasPos();if(t){let o=go(t);return t.closest("#graph-container")&&(o.top-=go(this.controller.getRootElt()).top),{top:o.top,left:o.left,width:t.clientWidth,height:t.clientHeight}}else return i?(i.top-=go(this.controller.getRootElt()).top,{...i,width:0,height:0}):this.cachedTargetPos}getFallbackPosition(){var i;let e=(i=this.controller.getRootElt())==null?void 0:i.querySelector(".dcg-exppanel-outer");if(!e)return;let t=go(e);return e.closest("#graph-container")&&(t.top-=go(this.controller.getRootElt()).top),{top:t.top,left:t.left,width:e.clientWidth,height:e.clientHeight}}withinTolerance(e,t){return Math.abs(e.height-t.height)<=30&&Math.abs(e.width-t.width)<=30&&Math.abs(e.top-t.top)<=30&&Math.abs(e.left-t.left)<=30}updatePosition(){var g,h,f;if(this.isSameStep()&&((g=this.props.target())==null?void 0:g.updatePosition)==="never")return;let e=this.findRootNode(),t=this.getTargetPosition();if(!e||!this.props.position||!t||!("getCanvasPos"in this.props.target())&&t.width===0&&t.height===0||this.isSameStep()&&((h=this.props.target())==null?void 0:h.updatePosition)!=="always"&&this.cachedTargetPos&&this.withinTolerance(t,this.cachedTargetPos))return;let i=e.offsetWidth||0,o=e.offsetHeight||0,n=10,a=10,s=window.innerWidth||0,l=0,c=t.left+(t.width-i)/2,d=t.top-n-o;switch(this.props.position()){case"e":c=t.left+t.width+a,d=t.top-(o-t.height)/2;break;case"s":c=t.left+(t.width-i)/2,d=t.top+t.height+n,c+i>s-1&&(l=s-1-c-i),c<1&&(l=1-c);break;case"n":c=t.left+(t.width-i)/2,d=t.top-t.height-n-o,c+i>s-1&&(l=s-1-c-i),c<1&&(l=1-c);break;case"w":c=t.left-(a+i),d=t.top-(o-t.height)/2;break}aa(e,{left:`${c}px`,top:`${d}px`});let p=e.querySelector(".dcg-trip-interior");p&&(p.style.transform="translate("+l+"px, 0)"),this.cachedBlock={target:this.props.target(),innerHTML:this.props.innerHTML(),header:this.props.header(),content:this.props.content()},this.cachedRootEltTop=(f=go(this.controller.getRootElt()))==null?void 0:f.top,this.cachedTargetPos=t}onMount(){this.clockBusId=Il(()=>this.updatePosition()),this.updatePosition()}willUnmount(){this.clockBusId&&Al(this.clockBusId)}didUpdate(){this.updatePosition()}getClasses(){var e,t;return{"dcg-tour-step":!0,[`dcg-tour-step-${this.props.position()}`]:!0,"dcg-tour-step--update-always":((t=(e=this.props).target)==null?void 0:t.call(e).updatePosition)==="always"}}getContent(){let e=this.props.content();return Array.isArray(e)?e:e?[e]:[]}isSameStep(){var i,o;let e=this.props.target(),t=(i=this.cachedBlock)==null?void 0:i.target;return!t||!e||((o=go(this.controller.getRootElt()))==null?void 0:o.top)!==this.cachedRootEltTop||"selector"in e&&"selector"in t&&(t==null?void 0:t.selector)!==e.selector||"element"in e&&"element"in t&&(t==null?void 0:t.element)!==e.element||"selector"in e&&"element"in t||"element"in e&&"selector"in t?!1:iN(this.cachedBlock,{target:e,innerHTML:this.props.innerHTML(),header:this.props.header(),content:this.props.content()})}template(){return Mo.createElement("div",{class:()=>this.getClasses()},Mo.createElement("div",{class:Mo.const("dcg-trip-interior")},Mo.createElement("a",{class:Mo.const("dcg-trip-close"),onTap:()=>this.props.tourController().stopTour("exit"),"aria-label":()=>this.controller.s("graphing-tours-label-close-tour")},Mo.const("\xD7")),Mo.createElement("div",{class:Mo.const("dcg-trip-content"),"aria-live":Mo.const("polite")},sme(()=>this.props.header(),e=>Mo.createElement("h2",null,e)),Mo.createElement(lme,{each:this.bindFn(this.getContent)},Mo.createElement("div",null,e=>Mo.createElement("div",{class:Mo.const("dcg-trip-content-sentence")},()=>e))),Mo.createElement(cme,{key:()=>this.props.innerHTML()},e=>e?Mo.createElement(rN,{innerHTML:()=>e}):Mo.createElement("div",null)))),Mo.createElement("div",{class:Mo.const("dcg-trip-arrow")}))}};var kb=__dcg_shared_module_exports__['e'](te());var{IfDefined:dme}=kb.Components,pme=5e3,ume=500,d0=class{constructor(e){this.controller=e}getState(){return this.controller.getState()}expressionCount(){return this.controller.getItemCount()}getExpSketch(e){return this.getExpSketchById(e.id)}getExpSketchById(e){var t;if(e)return(t=this.controller.getGrapher())==null?void 0:t.graphSketches[e]}getAvailableExp(e){let t=this.getMatchingExpNode(ov,e);return t||document.querySelector(".dcg-new-math-div")}getExpressionNodeById(e){if(e)return this.controller.getItemNodeById(e)}getModelById(e){if(e)return this.controller.getItemModel(e)}expMatches(e,t){return e?typeof t=="function"?this.safeCall(t,e,this.getExpSketch(e)):t.every(i=>this.safeCall(i,e,this.getExpSketch(e))):!1}safeCall(e,t,i){return"is3d"in e&&e.is3d?i instanceof Fx?e.call(null,t,i):e.call(null,t,void 0):i instanceof Rx?e.call(null,t,i):e.call(null,t,void 0)}getMatchingExpIds(e,t=[]){return this.controller.getAllItemModels().filter(i=>t.indexOf(i.id)===-1&&jG(i)!=="none"&&this.expMatches(i,e)).map(i=>i.id)}getMatchingExpId(e,t=[]){let i=this.getMatchingExpIds(e,t);if(i.length===0)return;let o=this.controller.getSelectedItem();return o&&i.indexOf(o.id)>=0?o.id:i[0]}hasMatchingExpression(e,t=[]){return this.getMatchingExpIds(e,t).length>0}getMatchingExpNode(e,t){let i=this.getMatchingExpId(e,t);return this.getExpressionNodeById(i)}getMatchingExpModel(e,t){let i=this.getMatchingExpId(e,t);return i?this.getModelById(i):void 0}getMatchingExpModels(e,t){return this.getMatchingExpIds(e,t).map(o=>this.getModelById(o)).filter(o=>o&&o.type==="expression")}getUniqueSliceValues(e){let t=e==="x"?0:e==="y"?1:2,i=this.getMatchingExpIds([]),o=[];for(let n of i){let a=this.getExpSketchById(n);a==null||a.branches.forEach(s=>{if(s.graphMode!==100&&s.graphMode!==128)return;let l=s.points[t];o.indexOf(l)===-1&&s.points.every((c,d)=>d%3!==t||Math.abs(c-l)<=1e-4||isNaN(c))&&o.push(l)})}return o}},p0=class extends kb.Class{constructor(){super(...arguments),this.controller=this.props.controller(),this.tourController=this.props.tourController(),this.s=this.controller.s,this.raw=this.controller.raw,this.validator=new d0(this.controller),this.expressionCount=()=>this.validator.expressionCount(),this.getAvailableExp=e=>this.validator.getAvailableExp(e),this.getExpressionNodeById=e=>this.validator.getExpressionNodeById(e),this.getModelById=e=>this.validator.getModelById(e),this.expMatches=(e,t)=>this.validator.expMatches(e,t),this.getMatchingExpIds=(e,t)=>this.validator.getMatchingExpIds(e,t),this.getMatchingExpId=(e,t)=>this.validator.getMatchingExpId(e,t),this.hasMatchingExpression=(e,t)=>this.validator.hasMatchingExpression(e,t),this.getMatchingExpNode=(e,t)=>this.validator.getMatchingExpNode(e,t),this.getMatchingExpModel=(e,t)=>this.validator.getMatchingExpModel(e,t)}},Am=class extends p0{constructor(){super(...arguments),this.currentStepIndex=0,this.currentSubStepIndex=0,this.steps=[]}editListMode(){return this.controller.isInEditListMode()}requireNotEditListMode(){return{type:"guardrail-only",shouldAdvance:()=>!this.controller.isInEditListMode(),getBlock:()=>({position:"s",content:this.controller.s("graphing-tours-label-require-not-edit-list-mode"),target:{element:document.querySelector(".dcg-action-toggle-edit")}})}}expressionsVisible(){return this.controller.isListVisible()}requireExpressionsVisible(){return{type:"guardrail-only",shouldAdvance:()=>this.expressionsVisible(),getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-require-expressions-visible"),target:{element:document.querySelector(".dcg-show-expressions-tab")}})}}resourcesOpen(){var e;return!!((e=document.querySelector("body"))!=null&&e.classList.contains("resources-open"))}requireResourcesNotOpen(){return{type:"guardrail-only",shouldAdvance:()=>!this.resourcesOpen(),getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-require-resources-not-open"),target:{element:document.querySelector(".dcg-action-opendrawer")}})}}addCountdown(e,t,i){if(!e)return;if(!t)return e;let o=Math.round(t/1e3),n=e.content;return n?Array.isArray(n)||(n=[n]):n=[],i==="final"?{...e,content:[...n,this.controller.s("graphing-tours-label-self-destruct",{seconds:o})]}:{...e,content:[...n,this.controller.s("graphing-tours-label-next-step-countdown",{seconds:o})]}}advanceTour(){do this.currentSubStepIndex===this.steps[this.currentStepIndex].length-1?(this.currentStepIndex++,this.currentSubStepIndex=0):this.currentSubStepIndex++;while(this.steps[this.currentStepIndex][this.currentSubStepIndex].shouldAdvance()&&this.steps[this.currentStepIndex][this.currentSubStepIndex].type!=="final")}checkGuardrails(){let{currentStepIndex:e,currentSubStepIndex:t}=this,i,o;for(i=0;i<=e;i++)if(o=this.steps[i].find((n,a)=>((n.type==="guardrail"||n.type==="guardrail-only")&&(i<e||a<t)||(n.type==="guardrail-only--this-step"||n.type==="guardrail--this-step")&&i===e&&a<t)&&!n.shouldAdvance()),o)return o}getCurrentStep(){if(!(!this.steps||this.steps.length===0||this.currentStepIndex>=this.steps.length||this.currentSubStepIndex>=this.steps[this.currentStepIndex].length))return this.steps[this.currentStepIndex][this.currentSubStepIndex]}handleDelayOrCountdown(e){var i;let t;if(e)return e.delayBeforeExit?typeof e.delayBeforeExit=="function"?t=e.delayBeforeExit():t=e.delayBeforeExit:t=pme,this.nextUpdateTime=Date.now()+t-1,e.type==="countdown"||e.type==="final"?(this.tourController.addInterval(ume),this.addCountdown(e.getBlock(),t,(i=e.type)!=null?i:"countdown")):(this.tourController.addUpdateTimeout(t),e.getBlock())}getTourStep(){var n;let e=Date.now(),t=this.getCurrentStep();if(!t)return;if(this.nextUpdateTime&&e<this.nextUpdateTime)return t.type==="countdown"||t.type==="final"?this.addCountdown(t.getBlock(),this.nextUpdateTime-Date.now(),t.type):this.curTripBlock;if(t.type==="final"&&this.nextUpdateTime&&e>=this.nextUpdateTime){setTimeout(()=>this.tourController.stopTour());return}let i=!1;if(t.shouldAdvance()){if(this.nextUpdateTime===void 0&&t.delayBeforeExit)return this.handleDelayOrCountdown(t);this.nextUpdateTime=void 0,i=!0,this.advanceTour()}let o=(n=this.checkGuardrails())!=null?n:this.getCurrentStep();return o?(i&&o.beforeStep&&o.beforeStep(),o.updateEveryTick?i&&this.clockBusId===void 0&&(this.clockBusId=Il(()=>this.update())):this.clockBusId!==void 0&&(Al(this.clockBusId),this.clockBusId=void 0),o.type==="final"||o.type==="countdown"?this.handleDelayOrCountdown(o):o.getBlock()):this.curTripBlock}willUpdate(){let e=this.getTourStep();e&&(this.curTripBlock=e)}onMount(){this.updateListener||(this.updateListener=this.controller.subscribeToChanges(()=>this.update()))}willUnmount(){this.updateListener!==void 0&&(this.updateListener(),this.updateListener=void 0),this.clockBusId!==void 0&&Al(this.clockBusId),this.tourController.clearTimeouts()}template(){return kb.createElement("div",null,dme(()=>this.curTripBlock,e=>kb.createElement(av,{tourController:this.props.tourController,controller:this.props.controller,content:()=>e().content,header:()=>e().header,innerHTML:()=>e().innerHTML,position:()=>e().position,target:()=>e().target})))}shouldPopup(){return!1}};var Vm=class extends Am{checkGuardrails(){}advanceTour(){}getCurrentStep(){let e=this.getCurrentStepBase();if(e){let t=e.getBlock();return this.cachedLastBlock&&(iN(t,this.cachedLastBlock)||(this.nextUpdateTime=void 0)),this.cachedLastBlock=t,e.type==="final"&&(this.nextUpdateTime||(this.nextUpdateTime=Date.now()+5e3-1,this.tourController.addInterval(500))),e}}};var MV=class extends Vm{shouldPopup(){return!!this.getMatchingExpNode(lp)}getCurrentStepBase(){var a;if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();if(this.editListMode())return this.requireNotEditListMode();let e=this.getMatchingExpModel(rQ),t=this.getMatchingExpNode(lp),i=this.getMatchingExpNode(sQ),o=this.getMatchingExpNode(c0);if(e&&i)return{type:"final",shouldAdvance:()=>!0,getBlock:()=>({position:"s",header:this.controller.s("graphing-tours-label-sliders-pro"),content:[],target:{element:i==null?void 0:i.querySelector(".dcg-circular-icon-container")}})};if(e&&o&&!((a=o.querySelector(".dcg-thumb"))!=null&&a.classList.contains("dcg-depressed")))return{shouldAdvance:()=>!0,getBlock:()=>({position:"s",header:this.controller.s("graphing-tours-label-sliders-hands-free"),content:this.controller.s("graphing-tours-label-sliders-press-play"),target:{element:o==null?void 0:o.querySelector(".dcg-circular-icon-container")}})};if(e&&t){let s=t==null?void 0:t.querySelector(".dcg-thumb .dcg-graphic");return{shouldAdvance:()=>!0,getBlock:()=>s?{position:"s",content:this.controller.s("graphing-tours-label-sliders-drag-handle"),target:{element:s,updatePosition:"never"}}:{position:"e",content:this.controller.s("graphing-tours-label-sliders-change-value"),target:{element:t}},updateEveryTick:!0}}let n;return this.expressionCount()>1?n=this.getMatchingExpNode(j3(1)):n=this.getMatchingExpNode(j3(2)),n&&(n!=null&&n.querySelector(".dcg-slider-btn-container:last-child .dcg-btn-blue"))?{shouldAdvance:()=>!0,getBlock:()=>({position:"s",header:this.controller.s("graphing-tours-label-awesome"),content:this.controller.s("graphing-tours-label-sliders-add"),target:{element:n==null?void 0:n.querySelector(".dcg-slider-btn-container:last-child .dcg-btn-blue")}})}:(n=this.getMatchingExpNode(ov),n?{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-sliders-make-sliders"),content:[],innerHTML:this.controller.s("graphing-tours-label-sliders-try-typing",{sample_expression:'<span class="dcg-trip-math">y=mx+b</span>'}),target:{element:n}}),delayBeforeExit:600}:{shouldAdvance:()=>!0,getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-sliders-blank-expression"),target:{selector:".dcg-action-newmath"}})})}};var IV=class extends Am{constructor(){super(...arguments);this.steps=[[this.requireExpressionsVisible(),this.requireResourcesNotOpen(),this.requireNotEditListMode(),{shouldAdvance:()=>!!this.hasMatchingExpression(Db),getBlock:()=>{let t=document.querySelector(".dcg-action-newtable");return t?{position:"e",content:this.controller.s("graphing-tours-label-tables-select-table"),target:{element:t}}:{position:"e",header:this.controller.s("graphing-tours-label-tables-start"),content:this.controller.s("graphing-tours-label-new-item"),target:{selector:".dcg-add-expression-btn"}}},type:"guardrail"}],[{shouldAdvance:()=>{let t=this.getTableEl(),i=0;return t==null||t.querySelectorAll(".dcg-row").forEach(o=>{o.querySelectorAll(".dcg-cell:not(.dcg-empty):not(.dcg-error):not(.dcg-table-header)").length>=2&&i++}),i>=3},getBlock:()=>{var c,d;let t=this.getTableEl();if(!t)return;let i=t.querySelector(".dcg-row .dcg-cell.dcg-error");if(i)return{position:"e",content:this.controller.s("graphing-tours-label-tables-valid-number"),target:{element:i}};let o=ds(this.getTable());if(!o)return t.getBoundingClientRect().y<0?{position:"e",content:this.controller.s("graphing-tours-label-tables-scroll"),target:{selector:".dcg-expressionlist"}}:{position:"e",content:this.controller.s("graphing-tours-label-tables-back"),target:{element:(d=(c=t==null?void 0:t.querySelector(".dcg-row .dcg-cell.dcg-empty:first-of-type"))==null?void 0:c.parentElement)==null?void 0:d.querySelector(".dcg-cell:nth-of-type(2)")}};let n=-1,a=0;if(t==null||t.querySelectorAll(".dcg-row").forEach(p=>{n++,p.querySelectorAll(".dcg-cell:not(.dcg-empty):not(.dcg-error):not(.dcg-table-header)").length>=2&&a++}),n===2&&a===1&&o&&o.row===1)return{position:"e",content:this.controller.s("graphing-tours-label-tables-next-row"),target:{element:t.querySelector(`.dcg-row:nth-of-type(${o.row+1}) .dcg-cell:nth-of-type(2)`)}};if(a===0&&(t==null?void 0:t.querySelectorAll(".dcg-row:nth-of-type(2) .dcg-cell:not(.dcg-empty):not(.dcg-error)").length)===1)return{position:"e",header:this.controller.s("graphing-tours-label-tables-fill-cell"),content:this.controller.s("graphing-tours-label-tables-type-number"),target:{element:t==null?void 0:t.querySelector(".dcg-row:nth-of-type(2) .dcg-cell:nth-of-type(2)")}};let s=this.controller.s("graphing-tours-label-tables-fill-row"),l;return a===2&&o.row===2?(l=this.controller.s("graphing-tours-label-awesome"),s=this.controller.s("graphing-tours-label-tables-enter")):a===2&&(s=this.controller.s("graphing-tours-label-tables-fill-another")),{position:"e",content:s,header:l,target:{element:t==null?void 0:t.querySelector(`.dcg-row:nth-of-type(${o.row+1}) .dcg-cell:nth-of-type(2)`)}}}}],[{shouldAdvance:()=>!!document.querySelector(".dcg-table-column-menu"),getBlock:()=>{var t;return{header:this.controller.s("graphing-tours-label-tables-last-trick"),content:this.controller.s("graphing-tours-label-tables-open-options"),position:"e",target:{element:(t=this.getTableEl())==null?void 0:t.querySelector(".dcg-row:nth-of-type(1) .dcg-cell:nth-of-type(2) .dcg-circular-icon")}}},type:"guardrail--this-step"},{shouldAdvance:()=>{let t=this.getTable();return!!t&&t.columnModels[1].points&&t.columnModels[1].lines},getBlock:()=>({content:this.controller.s("graphing-tours-label-tables-dots"),position:"e",target:{selector:".dcg-table-column-menu .dcg-options-menu-section:nth-of-type(2)"}})}],[{shouldAdvance:()=>!document.querySelector(".dcg-table-column-menu"),getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-tables-close-options"),target:{element:this.getTableEl()}})},{shouldAdvance:()=>!1,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-tables-whiz"),content:[],target:{element:this.getTableEl()}}),type:"final"}]]}shouldPopup(){return!!this.getMatchingExpNode(DV)}getTableEl(){let t=this.getMatchingExpId(Db);if(t)return this.getExpressionNodeById(t)}getTable(){let t=this.getMatchingExpId(Db);if(!t)return;let i=this.getModelById(t);if((i==null?void 0:i.type)==="table")return i}};var AV=class extends Vm{shouldPopup(){return!!this.getMatchingExpNode(Q3)}restrictedLineTour(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();let e=this.getMatchingExpNode([X3,iQ]),t=this.getMatchingExpNode(J3);if(e)return t?(this.completedPhase1=!0,this.getCurrentStepBase()):{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-brilliant"),content:this.controller.s("graphing-tours-label-restrictions-new-expression"),target:{selector:".dcg-new-math-div"}})};let i=this.getMatchingExpId(ov),o=this.getExpressionNodeById(i),n=this.getModelById(i);if(o&&n){let a=this.expMatches(n,Y3);return this.expMatches(n,$3)?void 0:a?{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-awesome"),content:[],innerHTML:[this.controller.s("graphing-tours-label-restrictions-domain",{sample_expression:'<span class="dcg-trip-math">\\left\\{x<0\\right\\}</span>'}),"<br><i>"+this.controller.s("graphing-tours-label-restrictions-abc",{buttons:"{ }"})+"</i>"].join(""),target:{element:o}})}:{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-restrictions-start"),content:[],innerHTML:this.controller.s("graphing-tours-label-restrictions-straight-line",{sample_expression:'<span class="dcg-trip-math">y=2x</span>'}),target:{element:o}}),delayBeforeExit:500}}return{shouldAdvance:()=>!0,getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-restrictions-blank-expression"),target:{selector:".dcg-new-math-div"}})}}restrictedParabolaTour(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();if(this.getMatchingExpNode([oQ,s0]))return{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-restrictions-star"),content:[],target:{selector:".dcg-exppanel-container"}}),type:"final"};let t=this.getMatchingExpId([J3,SV]),i=this.getExpressionNodeById(t),o=this.getModelById(t);if(i&&o){let n=this.expMatches(o,[s0,aQ]),a=this.expMatches(o,nQ),s=this.expMatches(o,s0);return this.expMatches(o,$3)?void 0:s?n?a?{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-nice"),content:[],innerHTML:this.controller.s("graphing-tours-label-restrictions-range",{sample_expression:'<span class="dcg-trip-math">\\left\\{y<4\\right\\}</span>'}),target:{element:i}})}:{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-restrictions-move-parabola"),content:[],innerHTML:this.controller.s("graphing-tours-label-restrictions-change-equation",{sample_expression:'<span class="dcg-trip-math">y=x^2-2</span>'}),target:{element:i,updatePosition:"always"}})}:{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-restrictions-dont-forget"),content:[],innerHTML:this.controller.s("graphing-tours-label-restrictions-type-all",{sample_expression:'<span class="dcg-trip-math">y=x^2</span>'}),target:{element:i}})}:{shouldAdvance:()=>!0,getBlock:()=>({position:"e",content:[],innerHTML:[this.controller.s("graphing-tours-label-restrictions-graph-parabola",{sample_expression:'<span class="dcg-trip-math">y=x^2</span>'})+"<br><i>"+this.controller.s("graphing-tours-label-restrictions-typing-hint",{suggestion1:"y=x^2",suggestion2:'<span class="dcg-trip-math">a^2</span>'})+"</i>"].join(""),target:{element:i,updatePosition:"always"}})}}return{shouldAdvance:()=>!0,getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-restrictions-blank-expression"),target:{selector:".dcg-new-math-div"}})}}getCurrentStepBase(){return this.completedPhase1?this.restrictedParabolaTour():this.restrictedLineTour()}};var VV=class extends Vm{constructor(){super(...arguments);this.hasCreatedLinearRegression=!1;this.hasInitiallyRenderedSampleDataLink=!1}shouldPopup(){return this.hasMatchingExpression(DV)}getRegressionExpId(){return this.getMatchingExpId(nv)||this.getMatchingExpId(a0)}getRegressionExp(){return this.getMatchingExpModel(nv)||this.getMatchingExpModel(a0)}hasRegression(){var n;let t=this.getRegressionExp(),i=(n=t==null?void 0:t.formula)==null?void 0:n.regression,o=i==null?void 0:i.statistics;return!!o&&o.r}hasFilledTable(){let t=this.getMatchingExpNode(Db);return!!t&&t.querySelectorAll(".dcg-row .dcg-cell:nth-of-type(2):not(.dcg-table-header):not(.dcg-empty)").length>=5}getCurrentStepBase(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();if(this.editListMode())return this.requireNotEditListMode();let t=this.getMatchingExpId(nv)||this.getMatchingExpId(a0),i=this.getExpressionNodeById(t),o=this.getModelById(t),n=this.getMatchingExpId(Db),a=this.getExpressionNodeById(n),s=this.getModelById(n);if(!s||s.type!=="table"||!s.columnModels[1]){let E=document.querySelector(".dcg-action-newtable");return!E&&(!ll&&!Sp)?{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-regressions-data"),content:[],innerHTML:this.controller.s("graphing-tours-label-regressions-docs",{sample_data_link:'<a class="dcg-trip-link" target="_blank" href="https://docs.google.com/spreadsheets/d/1h4kYwWka_1PvI5G-hPYz_QBe1FrYLo9Gb1XvxJz-QYE/edit#gid=0">'+this.controller.s("graphing-tours-label-regressions-sample-data")+"</a>"})+' <div class="dcg-trip-hint"><br>'+this.controller.s("graphing-tours-label-regressions-own-data",{plus_icon:'<i class="dcg-icon-plus" aria-hidden="true"></i>'}),target:{element:i||document.querySelector(".dcg-exppanel")}})}:E?{shouldAdvance:()=>!0,getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-regressions-new-table"),target:{element:E}}),delayBeforeExit:250}:{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-regressions-data-2"),content:this.controller.s("graphing-tours-label-new-item"),target:{selector:".dcg-add-expression-btn"}}),delayBeforeExit:150}}let l=s.columnModels[0].values.length;if(a&&l<5)return{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-regressions-fill-sample-data"),content:[],innerHTML:"<table class='dcg-regression-tour-table'><tr><td><span class='dcg-trip-math'>x_1</span></td><td><span class='dcg-trip-math'>y_1</span></td></tr><tr><td>1</td><td>0.8</td></tr><tr><td>2</td><td>2.7</td></tr><tr><td>3</td><td>3.9</td></tr><tr><td>4</td><td>4.6</td></tr><tr><td>5</td><td>5</td></tr></table>",target:{element:a.querySelector(".dcg-row:nth-of-type(2) .dcg-cell:nth-of-type(2)")}})};let c=this.getMatchingExpModel(nv)||this.getMatchingExpModel(SV)||this.controller.getItemModelByIndex(0);if(!c||c.type!=="expression"){let E=document.querySelector(".dcg-action-newexpression");return E?{shouldAdvance:()=>!0,getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-regressions-expression-option"),target:{element:E}}),delayBeforeExit:150}:{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-awesome"),content:this.controller.s("graphing-tours-label-new-item"),target:{selector:".dcg-add-expression-btn"}}),delayBeforeExit:150}}let d=o&&o.type==="expression"&&o.formula,p=d?d.regression:void 0,g=p?p.statistics:void 0,h=p?p.parameters:void 0;if(g&&g.r&&(this.hasCreatedLinearRegression=!0),!this.hasCreatedLinearRegression&&i)return{shouldAdvance:()=>!0,getBlock:()=>({position:"e",content:[],innerHTML:this.controller.s("graphing-tours-label-regressions-equation",{equation:"<span class='dcg-trip-math'>y_1\\sim mx_1+b</span>"})+"<div class='trip-hint'>"+this.controller.s("graphing-tours-label-regressions-hint-1",{y_1:"<span class='dcg-trip-math'>y_1</span>",y1:"<span class='dcg-trip-math'>y1</span>"})+"</div><div class='dcg-trip-hint'>"+this.controller.s("graphing-tours-label-regressions-hint-2",{twiddle:"<span class='dcg-trip-math'>~</span>"})+"</div>",target:{element:i,updatePosition:"never"}}),delayBeforeExit:250};if(document.querySelector(".dcg-residual-suggestion"))return{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-regressions-check-model"),content:this.controller.s("graphing-tours-label-regressions-residuals"),target:{selector:".dcg-residual-suggestion"}}),delayBeforeExit:250};if(g&&(g.Rsquared>=.99||g.r>=.99||h&&h.a&&h.k&&h.h))return{shouldAdvance:()=>!0,type:"final",getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-regressions-keep-exploring"),content:[],target:{selector:".dcg-exppanel"}})};if(!i)return;let y,x=this.getMatchingExpIds(nv);return x.length>1?y=this.getExpressionNodeById(x.pop()):y=this.getExpressionNodeById(x[0]),{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-regressions-new-model"),content:[],innerHTML:this.controller.s("graphing-tours-label-regressions-better-fit",{equation:"<span class='dcg-trip-math'>y_1~a(x_1-h)^2+b</span>"}),target:{element:y,updatePosition:"never"}}),delayBeforeExit:300}}};var u0={sliders:{tour:MV,titleKey:"graphing-tours-heading-sliders",thumb:""},tables:{tour:IV,titleKey:"graphing-tours-heading-tables",thumb:""},restrictions:{tour:AV,titleKey:"graphing-tours-heading-restrictions",thumb:""},regressions:{tour:VV,titleKey:"graphing-tours-heading-regressions",thumb:""}};var LV=class extends wd.Class{init(){this.controller=this.props.controller()}template(){return wd.createElement(ys,{title:()=>this.controller.s("account-shell-heading-tours"),type:()=>"help",label:()=>this.controller.s("account-shell-label-help-menu"),controller:this.props.controller},wd.createElement(TV,{controller:this.props.controller,tours:this.const(u0)}),wd.createElement("h2",{class:wd.const("dcg-unstyled-heading dcg-popover-title")},()=>this.controller.s("account-shell-heading-resources")),wd.createElement(mV,{controller:this.props.controller}),wd.createElement("h2",{class:wd.const("dcg-unstyled-heading dcg-popover-title dcg-interior-title dcg-hide-on-mobile")},()=>this.controller.s("account-shell-heading-contact-us")),wd.createElement(Im,{controller:this.props.controller}))}};var h0=__dcg_shared_module_exports__['e'](te());var xs=__dcg_shared_module_exports__['e'](te());var{For:hme}=xs.Components,PV=class extends xs.Class{init(){this.i18n=this.props.i18n()}template(){return xs.createElement("div",{class:()=>({"dcg-language-picker":!0,"dcg-popover":!0,"dcg-two-columns":this.getLanguages().length>7})},xs.createElement("div",{class:xs.const("dcg-popover-title"),role:xs.const("heading"),"aria-level":xs.const("2")},()=>this.i18n.s("shared-title-language-menu")),xs.createElement(hme,{each:()=>this.getLanguages()},xs.createElement("ul",{class:xs.const("dcg-unstyled-list dcg-languages-list dcg-popover-content"),role:xs.const("menu")},e=>xs.createElement("li",{class:()=>({"dcg-listitem":!0,"dcg-language-option":!0,"dcg-selected":this.isLanguageSelected(e)}),lang:this.const(this.getLangCode(e)),role:xs.const("menuitem"),tabindex:xs.const("0"),"aria-current":()=>this.isLanguageSelected(e),onTap:()=>this.updateLang(e)},()=>this.i18n.raw(this.getLanguageDisplayName(e))))))}getCurrentLang(){return this.props.currentLang()}getLanguages(){return Object.keys(this.props.getAllLangs())}getLanguageDisplayName(e){return this.props.getAllLangs()[e].display_name}updateLang(e){let t=this.props.getAllLangs()[e].code;return this.props.onLangChosen(t)}getLangCode(e){return this.props.getAllLangs()[e].code}isLanguageSelected(e){return this.getLangCode(e)===this.getCurrentLang()}};var gme=DU(),_V=class extends h0.Class{init(){this.controller=this.props.controller(),this.languageController=this.controller.languageController}template(){return h0.createElement(ys,{type:()=>"language",label:()=>this.controller.s("account-shell-narration-language-menu"),controller:this.props.controller},h0.createElement(PV,{getAllLangs:()=>gme,currentLang:()=>this.languageController.getLanguage(),onLangChosen:e=>{this.languageController.fetchAndSetLanguage(e),this.controller.dispatch({type:"toggle-menu",payload:"none"})},i18n:this.props.controller}))}};var{SwitchUnion:mme,If:cp}=kt.Components,OV=class extends kt.Class{init(){this.controller=this.props.controller(),this.userController=this.controller.userController}template(){let e=this.controller.isInMaintenanceMode(),t=this.controller.getPreviewParams();return kt.createElement("div",{class:kt.const("dcg-header")},kt.createElement("div",{class:kt.const("dcg-header-desktop")},kt.createElement("div",{class:kt.const("align-left-container")},kt.createElement(iV,{controller:this.props.controller,tooltip:kt.const(!0)}),kt.createElement(cV,{controller:this.props.controller})),kt.createElement("div",{class:kt.const("align-center-container")},kt.createElement("a",{href:kt.const("/"),target:kt.const("_blank"),class:kt.const("dcg-home-link")},kt.createElement(dV,null))),kt.createElement(cp,{predicate:()=>this.userController.didLogoutFail()},()=>kt.createElement("div",{class:kt.const("dcg-toast-container")},kt.createElement("div",{class:kt.const("dcg-toast")},()=>this.controller.s("account-shell-error-logging-out")))),kt.createElement("div",{class:kt.const("align-right-container")},kt.createElement(oV,{controller:this.props.controller,disableAccounts:()=>t!=null||e,withArtContest:()=>this.controller.getArtContestStatus()==="open"||this.controller.getArtContestStatus()==="closed"}),kt.createElement(cp,{predicate:()=>this.controller.getArtContestStatus()==="open"||this.controller.getArtContestStatus()==="closed"},()=>kt.createElement("span",null,kt.createElement(Sb,{controller:this.props.controller,label:()=>Pn("account-shell-label-math-art-contest"),tooltip:()=>this.controller.s("account-shell-label-math-art-contest"),icon:kt.const("dcg-icon-art-contest"),name:()=>"art-contest",onTap:()=>{this.controller.dispatch({type:"toggle-menu",payload:"art-contest"})}}),kt.createElement(cp,{predicate:()=>this.controller.getOpenMenu()==="art-contest"},()=>kt.createElement(hV,{controller:this.props.controller})))),kt.createElement(Sb,{controller:this.props.controller,label:()=>Pn("account-shell-label-share"),tooltip:()=>this.controller.s("account-shell-label-share-graph"),icon:kt.const("dcg-icon-share"),name:()=>"share",onTap:()=>{this.controller.dispatch({type:"toggle-menu",payload:"share"})}}),kt.createElement(cp,{predicate:()=>this.controller.getOpenMenu()==="share"},()=>kt.createElement(gV,{controller:this.props.controller})),kt.createElement(Sb,{controller:this.props.controller,label:()=>Pn("account-shell-label-help"),tooltip:()=>this.controller.s("account-shell-label-help"),icon:kt.const("dcg-icon-question-sign"),name:kt.const("help"),onTap:()=>{this.controller.dispatch({type:"toggle-menu",payload:"help"})}}),kt.createElement(cp,{predicate:()=>this.controller.getOpenMenu()==="help"},()=>mme(()=>this.props.controller().product,{"geometry-calculator":()=>kt.createElement(xV,{controller:this.props.controller}),"graphing-3d":()=>kt.createElement(GV,{controller:this.props.controller}),graphing:()=>kt.createElement(LV,{controller:this.props.controller}),geometry:()=>kt.createElement("span",null)})),kt.createElement(Sb,{controller:this.props.controller,gravity:this.const("s"),label:()=>Pn("account-shell-label-language"),tooltip:()=>this.controller.s("account-shell-label-language"),icon:kt.const("dcg-icon-world"),name:kt.const("language"),onTap:()=>{this.controller.dispatch({type:"toggle-menu",payload:"language"})}}),kt.createElement(cp,{predicate:()=>this.controller.getOpenMenu()==="language"},()=>kt.createElement(_V,{controller:this.props.controller})))),kt.createElement(cp,{predicate:()=>t!=null||e},()=>kt.createElement("div",{class:kt.const("dcg-toast-container")},kt.createElement("span",{class:kt.const("dcg-toast dcg-maintenance-toast")},kt.createElement("span",{class:kt.const("dcg-msg")},kt.createElement(cp,{predicate:()=>e},()=>kt.createElement("span",null,()=>this.controller.s("account-shell-text-maintenance-mode"))),kt.createElement(cp,{predicate:()=>t!=null},()=>kt.createElement("span",null,()=>t!=null?t.message:void 0))),kt.createElement(cp,{predicate:()=>e},()=>kt.createElement("a",{class:kt.const("undo"),target:kt.const("_blank"),href:kt.const("http://desmos.zendesk.com/entries/25429616-What-is-Maintenance-Mode-/")},()=>this.controller.s("account-shell-link-learn-more"))),kt.createElement(cp,{predicate:()=>t!=null},()=>kt.createElement("a",{class:kt.const("undo"),target:kt.const("_blank"),href:()=>t!=null?t.url:void 0},()=>this.controller.s("account-shell-link-share-thoughts")))))))}focusElement(e){var t;(t=document.querySelector(e))==null||t.focus()}};var Cd=__dcg_shared_module_exports__['e'](te());var hr=__dcg_shared_module_exports__['e'](te());var oN={};(function r(e,t,i,o){var n=!!(e.Worker&&e.Blob&&e.Promise&&e.OffscreenCanvas&&e.OffscreenCanvasRenderingContext2D&&e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype.transferControlToOffscreen&&e.URL&&e.URL.createObjectURL),a=typeof Path2D=="function"&&typeof DOMMatrix=="function",s=function(){if(!e.OffscreenCanvas)return!1;var F=new OffscreenCanvas(1,1),j=F.getContext("2d");j.fillRect(0,0,1,1);var pe=F.transferToImageBitmap();try{j.createPattern(pe,"no-repeat")}catch(le){return!1}return!0}();function l(){}function c(F){var j=t.exports.Promise,pe=j!==void 0?j:e.Promise;return typeof pe=="function"?new pe(F):(F(l,l),null)}var d=function(F,j){return{transform:function(pe){if(F)return pe;if(j.has(pe))return j.get(pe);var le=new OffscreenCanvas(pe.width,pe.height),ne=le.getContext("2d");return ne.drawImage(pe,0,0),j.set(pe,le),le},clear:function(){j.clear()}}}(s,new Map),p=function(){var F=Math.floor(16.666666666666668),j,pe,le={},ne=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(j=function(X){var ae=Math.random();return le[ae]=requestAnimationFrame(function J(ge){ne===ge||ne+F-1<ge?(ne=ge,delete le[ae],X()):le[ae]=requestAnimationFrame(J)}),ae},pe=function(X){le[X]&&cancelAnimationFrame(le[X])}):(j=function(X){return setTimeout(X,F)},pe=function(X){return clearTimeout(X)}),{frame:j,cancel:pe}}(),g=function(){var F,j,pe={};function le(ne){function X(ae,J){ne.postMessage({options:ae||{},callback:J})}ne.init=function(J){var ge=J.transferControlToOffscreen();ne.postMessage({canvas:ge},[ge])},ne.fire=function(J,ge,be){if(j)return X(J,null),j;var Ee=Math.random().toString(36).slice(2);return j=c(function(Le){function Se(et){et.data.callback===Ee&&(delete pe[Ee],ne.removeEventListener("message",Se),j=null,d.clear(),be(),Le())}ne.addEventListener("message",Se),X(J,Ee),pe[Ee]=Se.bind(null,{data:{callback:Ee}})}),j},ne.reset=function(){ne.postMessage({reset:!0});for(var J in pe)pe[J](),delete pe[J]}}return function(){if(F)return F;if(!i&&n){var ne=["var CONFETTI, SIZE = {}, module = {};","("+r.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{F=new Worker(URL.createObjectURL(new Blob([ne])))}catch(X){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("\u{1F38A} Could not load worker",X),null}le(F)}return F}}(),h={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function f(F,j){return j?j(F):F}function y(F){return F!=null}function x(F,j,pe){return f(F&&y(F[j])?F[j]:h[j],pe)}function E(F){return F<0?0:Math.floor(F)}function C(F,j){return Math.floor(Math.random()*(j-F))+F}function S(F){return parseInt(F,16)}function v(F){return F.map(M)}function M(F){var j=String(F).replace(/[^0-9a-f]/gi,"");return j.length<6&&(j=j[0]+j[0]+j[1]+j[1]+j[2]+j[2]),{r:S(j.substring(0,2)),g:S(j.substring(2,4)),b:S(j.substring(4,6))}}function A(F){var j=x(F,"origin",Object);return j.x=x(j,"x",Number),j.y=x(j,"y",Number),j}function I(F){F.width=document.documentElement.clientWidth,F.height=document.documentElement.clientHeight}function P(F){var j=F.getBoundingClientRect();F.width=j.width,F.height=j.height}function _(F){var j=document.createElement("canvas");return j.style.position="fixed",j.style.top="0px",j.style.left="0px",j.style.pointerEvents="none",j.style.zIndex=F,j}function U(F,j,pe,le,ne,X,ae,J,ge){F.save(),F.translate(j,pe),F.rotate(X),F.scale(le,ne),F.arc(0,0,1,ae,J,ge),F.restore()}function Y(F){var j=F.angle*(Math.PI/180),pe=F.spread*(Math.PI/180);return{x:F.x,y:F.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:F.startVelocity*.5+Math.random()*F.startVelocity,angle2D:-j+(.5*pe-Math.random()*pe),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:F.color,shape:F.shape,tick:0,totalTicks:F.ticks,decay:F.decay,drift:F.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:F.gravity*3,ovalScalar:.6,scalar:F.scalar,flat:F.flat}}function R(F,j){j.x+=Math.cos(j.angle2D)*j.velocity+j.drift,j.y+=Math.sin(j.angle2D)*j.velocity+j.gravity,j.velocity*=j.decay,j.flat?(j.wobble=0,j.wobbleX=j.x+10*j.scalar,j.wobbleY=j.y+10*j.scalar,j.tiltSin=0,j.tiltCos=0,j.random=1):(j.wobble+=j.wobbleSpeed,j.wobbleX=j.x+10*j.scalar*Math.cos(j.wobble),j.wobbleY=j.y+10*j.scalar*Math.sin(j.wobble),j.tiltAngle+=.1,j.tiltSin=Math.sin(j.tiltAngle),j.tiltCos=Math.cos(j.tiltAngle),j.random=Math.random()+2);var pe=j.tick++/j.totalTicks,le=j.x+j.random*j.tiltCos,ne=j.y+j.random*j.tiltSin,X=j.wobbleX+j.random*j.tiltCos,ae=j.wobbleY+j.random*j.tiltSin;if(F.fillStyle="rgba("+j.color.r+", "+j.color.g+", "+j.color.b+", "+(1-pe)+")",F.beginPath(),a&&j.shape.type==="path"&&typeof j.shape.path=="string"&&Array.isArray(j.shape.matrix))F.fill(T(j.shape.path,j.shape.matrix,j.x,j.y,Math.abs(X-le)*.1,Math.abs(ae-ne)*.1,Math.PI/10*j.wobble));else if(j.shape.type==="bitmap"){var J=Math.PI/10*j.wobble,ge=Math.abs(X-le)*.1,be=Math.abs(ae-ne)*.1,Ee=j.shape.bitmap.width*j.scalar,Le=j.shape.bitmap.height*j.scalar,Se=new DOMMatrix([Math.cos(J)*ge,Math.sin(J)*ge,-Math.sin(J)*be,Math.cos(J)*be,j.x,j.y]);Se.multiplySelf(new DOMMatrix(j.shape.matrix));var et=F.createPattern(d.transform(j.shape.bitmap),"no-repeat");et.setTransform(Se),F.globalAlpha=1-pe,F.fillStyle=et,F.fillRect(j.x-Ee/2,j.y-Le/2,Ee,Le),F.globalAlpha=1}else if(j.shape==="circle")F.ellipse?F.ellipse(j.x,j.y,Math.abs(X-le)*j.ovalScalar,Math.abs(ae-ne)*j.ovalScalar,Math.PI/10*j.wobble,0,2*Math.PI):U(F,j.x,j.y,Math.abs(X-le)*j.ovalScalar,Math.abs(ae-ne)*j.ovalScalar,Math.PI/10*j.wobble,0,2*Math.PI);else if(j.shape==="star")for(var Z=Math.PI/2*3,W=4*j.scalar,De=8*j.scalar,Ne=j.x,me=j.y,ve=5,Pe=Math.PI/ve;ve--;)Ne=j.x+Math.cos(Z)*De,me=j.y+Math.sin(Z)*De,F.lineTo(Ne,me),Z+=Pe,Ne=j.x+Math.cos(Z)*W,me=j.y+Math.sin(Z)*W,F.lineTo(Ne,me),Z+=Pe;else F.moveTo(Math.floor(j.x),Math.floor(j.y)),F.lineTo(Math.floor(j.wobbleX),Math.floor(ne)),F.lineTo(Math.floor(X),Math.floor(ae)),F.lineTo(Math.floor(le),Math.floor(j.wobbleY));return F.closePath(),F.fill(),j.tick<j.totalTicks}function H(F,j,pe,le,ne){var X=j.slice(),ae=F.getContext("2d"),J,ge,be=c(function(Ee){function Le(){J=ge=null,ae.clearRect(0,0,le.width,le.height),d.clear(),ne(),Ee()}function Se(){i&&!(le.width===o.width&&le.height===o.height)&&(le.width=F.width=o.width,le.height=F.height=o.height),!le.width&&!le.height&&(pe(F),le.width=F.width,le.height=F.height),ae.clearRect(0,0,le.width,le.height),X=X.filter(function(et){return R(ae,et)}),X.length?J=p.frame(Se):Le()}J=p.frame(Se),ge=Le});return{addFettis:function(Ee){return X=X.concat(Ee),be},canvas:F,promise:be,reset:function(){J&&p.cancel(J),ge&&ge()}}}function O(F,j){var pe=!F,le=!!x(j||{},"resize"),ne=!1,X=x(j,"disableForReducedMotion",Boolean),ae=n&&!!x(j||{},"useWorker"),J=ae?g():null,ge=pe?I:P,be=F&&J?!!F.__confetti_initialized:!1,Ee=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,Le;function Se(Z,W,De){for(var Ne=x(Z,"particleCount",E),me=x(Z,"angle",Number),ve=x(Z,"spread",Number),Pe=x(Z,"startVelocity",Number),He=x(Z,"decay",Number),ot=x(Z,"gravity",Number),Ge=x(Z,"drift",Number),Et=x(Z,"colors",v),Oe=x(Z,"ticks",Number),Tr=x(Z,"shapes"),Q=x(Z,"scalar"),ke=!!x(Z,"flat"),Ue=A(Z),xe=Ne,ct=[],it=F.width*Ue.x,li=F.height*Ue.y;xe--;)ct.push(Y({x:it,y:li,angle:me,spread:ve,startVelocity:Pe,color:Et[xe%Et.length],shape:Tr[C(0,Tr.length)],ticks:Oe,decay:He,gravity:ot,drift:Ge,scalar:Q,flat:ke}));return Le?Le.addFettis(ct):(Le=H(F,ct,ge,W,De),Le.promise)}function et(Z){var W=X||x(Z,"disableForReducedMotion",Boolean),De=x(Z,"zIndex",Number);if(W&&Ee)return c(function(Pe){Pe()});pe&&Le?F=Le.canvas:pe&&!F&&(F=_(De),document.body.appendChild(F)),le&&!be&&ge(F);var Ne={width:F.width,height:F.height};J&&!be&&J.init(F),be=!0,J&&(F.__confetti_initialized=!0);function me(){if(J){var Pe={getBoundingClientRect:function(){if(!pe)return F.getBoundingClientRect()}};ge(Pe),J.postMessage({resize:{width:Pe.width,height:Pe.height}});return}Ne.width=Ne.height=null}function ve(){Le=null,le&&(ne=!1,e.removeEventListener("resize",me)),pe&&F&&(document.body.removeChild(F),F=null,be=!1)}return le&&!ne&&(ne=!0,e.addEventListener("resize",me,!1)),J?J.fire(Z,Ne,ve):Se(Z,Ne,ve)}return et.reset=function(){J&&J.reset(),Le&&Le.reset()},et}var q;function w(){return q||(q=O(null,{useWorker:!0,resize:!0})),q}function T(F,j,pe,le,ne,X,ae){var J=new Path2D(F),ge=new Path2D;ge.addPath(J,new DOMMatrix(j));var be=new Path2D;return be.addPath(ge,new DOMMatrix([Math.cos(ae)*ne,Math.sin(ae)*ne,-Math.sin(ae)*X,Math.cos(ae)*X,pe,le])),be}function B(F){if(!a)throw new Error("path confetti are not supported in this browser");var j,pe;typeof F=="string"?j=F:(j=F.path,pe=F.matrix);var le=new Path2D(j),ne=document.createElement("canvas"),X=ne.getContext("2d");if(!pe){for(var ae=1e3,J=ae,ge=ae,be=0,Ee=0,Le,Se,et=0;et<ae;et+=2)for(var Z=0;Z<ae;Z+=2)X.isPointInPath(le,et,Z,"nonzero")&&(J=Math.min(J,et),ge=Math.min(ge,Z),be=Math.max(be,et),Ee=Math.max(Ee,Z));Le=be-J,Se=Ee-ge;var W=10,De=Math.min(W/Le,W/Se);pe=[De,0,0,De,-Math.round(Le/2+J)*De,-Math.round(Se/2+ge)*De]}return{type:"path",path:j,matrix:pe}}function de(F){var j,pe=1,le="#000000",ne='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof F=="string"?j=F:(j=F.text,pe="scalar"in F?F.scalar:pe,ne="fontFamily"in F?F.fontFamily:ne,le="color"in F?F.color:le);var X=10*pe,ae=""+X+"px "+ne,J=new OffscreenCanvas(X,X),ge=J.getContext("2d");ge.font=ae;var be=ge.measureText(j),Ee=Math.ceil(be.actualBoundingBoxRight+be.actualBoundingBoxLeft),Le=Math.ceil(be.actualBoundingBoxAscent+be.actualBoundingBoxDescent),Se=2,et=be.actualBoundingBoxLeft+Se,Z=be.actualBoundingBoxAscent+Se;Ee+=Se+Se,Le+=Se+Se,J=new OffscreenCanvas(Ee,Le),ge=J.getContext("2d"),ge.font=ae,ge.fillStyle=le,ge.fillText(j,et,Z);var W=1/pe;return{type:"bitmap",bitmap:J.transferToImageBitmap(),matrix:[W,0,0,W,-Ee*W/2,-Le*W/2]}}t.exports=function(){return w().apply(this,arguments)},t.exports.reset=function(){w().reset()},t.exports.create=O,t.exports.shapeFromPath=B,t.exports.shapeFromText=de})(function(){return typeof window!="undefined"?window:typeof self!="undefined"?self:this||{}}(),oN,!1);var qat=oN.exports,mQ=oN.exports.create;var xi=__dcg_shared_module_exports__['e'](te());var RV=class extends xi.Class{init(){this.tourController=this.props.tourController(),this.controller=this.tourController.controller}launchConfetti(){var e;if(this.props.showAnimation()){let t=document.createElement("canvas");t.id="dcg-quest-success-canvas",t.width=window.innerWidth,t.height=window.innerHeight,(e=document.querySelector("#dcg-quest-success-container .dcg-shared-modal-transition-container"))==null||e.before(t),mQ(t,{resize:!0,useWorker:!0})({particleCount:150,spread:60,colors:["#d53b90","#af2067","#ff8856"]})}}template(){return xi.createElement("div",{id:xi.const("dcg-quest-success-container")},xi.createElement(Qo,{title:this.const(""),size:this.const("narrow"),class:this.const("dcg-quest__success"),showX:this.const(!0),onClose:()=>this.tourController.closeSuccessModal(),i18n:()=>this.controller,ariaLabel:()=>this.controller.s("account-shell-label-success")},xi.createElement("div",{class:xi.const("dcg-quest-success-interior"),didMount:()=>this.launchConfetti()},xi.createElement("div",{class:xi.const("dcg-quest-success-image")},xi.createElement("img",{src:()=>{var e;return`/assets/img/quests/${(e=this.tourController.getCurrentQuest())==null?void 0:e.thumb}`},width:xi.const("120"),height:xi.const("120"),alt:()=>{var e;return this.controller.s("graphing-tours-narration-quest-thumbnail",{title:this.controller.raw(((e=this.tourController.getCurrentQuest())==null?void 0:e.title)||"")})}})),xi.createElement("div",{class:xi.const("dcg-quest-success-content")},xi.createElement("h1",{class:xi.const("dcg-unstyled-heading")},()=>this.controller.s("account-shell-label-success")),xi.createElement("div",{class:xi.const("quest-title")},()=>{var e;return this.controller.s("graphing-tours-heading-quest-success",{title:this.controller.raw(((e=this.tourController.getCurrentQuest())==null?void 0:e.title)||"")})}),xi.createElement("div",{class:xi.const("dcg-modal-actions")},xi.createElement("button",{class:xi.const("dcg-btn-gray-outline"),onTap:()=>this.tourController.stopQuest()},()=>this.controller.s("graphing-tours-label-close-quests")),xi.createElement("button",{class:xi.const("dcg-btn-pink"),onTap:()=>this.tourController.startNextQuest()},()=>this.controller.s("account-shell-link-try-next-quest"))),xi.createElement("div",{class:xi.const("dcg-footer-option")},xi.createElement(yi,{i18n:this.const(this.controller),key:this.const("account-shell-text-continue-with-quest")},xi.const("...or"),xi.const(" "),xi.createElement("button",{class:xi.const("dcg-unstyled-button dcg-blue-link"),onTap:()=>this.tourController.continueCurrentQuest()},xi.const("keep playing with this quest")),xi.const(".")))))))}};var vd=__dcg_shared_module_exports__['e'](te());var FV=class extends vd.Class{init(){this.controller=this.props.controller()}template(){return vd.createElement("li",{class:()=>({"dcg-list-item":!0,"dcg-active":this.props.validationStatus()==="validating"})},vd.createElement("div",{class:vd.const("dcg-quest__step-status-container")},vd.createElement("div",{class:()=>({"dcg-quest__step-status":!0,"dcg-unvalidated":this.props.validationStatus()==="unvalidated","dcg-validating":this.props.validationStatus()==="validating","dcg-satisfied":this.props.validationStatus()==="satisfied","dcg-unsatisfied":this.props.validationStatus()==="unsatisfied"})},vd.createElement("div",{class:vd.const("dcg-validation-checkmark")}))),vd.createElement("div",{class:vd.const("dcg-quest__step-text")},this.props.title))}};var ga=__dcg_shared_module_exports__['e'](te());var g0=__dcg_shared_module_exports__['e'](te());var{IfDefined:bme}=g0.Components,Su=class extends p0{constructor(){super(...arguments),this.currentStepIndex=0,this.currentSubStepIndex=0,this.steps=[]}editListMode(){return this.controller.isInEditListMode()}requireNotEditListMode(){return{type:"guardrail-only",shouldAdvance:()=>!this.controller.isInEditListMode(),getBlock:()=>({position:"s",content:this.controller.s("graphing-tours-label-require-not-edit-list-mode"),target:{element:document.querySelector(".dcg-action-toggle-edit")}})}}expressionsVisible(){return this.controller.isListVisible()}requireExpressionsVisible(){return{type:"guardrail-only",shouldAdvance:()=>this.expressionsVisible(),getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-require-expressions-visible"),target:{element:document.querySelector(".dcg-show-expressions-tab")}})}}resourcesOpen(){var e;return!!((e=document.querySelector("body"))!=null&&e.classList.contains("resources-open"))}requireResourcesNotOpen(){return{type:"guardrail-only",shouldAdvance:()=>!this.resourcesOpen(),getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-require-resources-not-open"),target:{element:document.querySelector(".dcg-action-opendrawer")}})}}advanceTour(){if(!this.isLastStep())do this.currentSubStepIndex===this.steps[this.currentStepIndex].length-1?(this.currentStepIndex++,this.currentSubStepIndex=0):this.currentSubStepIndex++;while(this.steps[this.currentStepIndex][this.currentSubStepIndex].shouldAdvance()&&!this.isLastStep())}checkGuardrails(){let{currentStepIndex:e,currentSubStepIndex:t}=this,i,o;for(i=0;i<=e;i++)if(o=this.steps[i].find((n,a)=>((n.type==="guardrail"||n.type==="guardrail-only")&&(i<e||a<t)||(n.type==="guardrail-only--this-step"||n.type==="guardrail--this-step")&&i===e&&a<t)&&!n.shouldAdvance()),o)return o}getCurrentStep(){if(!(!this.steps||this.steps.length===0||this.currentStepIndex>=this.steps.length||this.currentSubStepIndex>=this.steps[this.currentStepIndex].length))return this.steps[this.currentStepIndex][this.currentSubStepIndex]}isLastStep(){return this.currentStepIndex===this.steps.length-1&&this.currentSubStepIndex===this.steps[this.currentStepIndex].length-1}getTourStep(){var o;let e=this.getCurrentStep();if(!e)return;let t=!1;e.shouldAdvance()&&(t=!0,this.advanceTour());let i=(o=this.checkGuardrails())!=null?o:this.getCurrentStep();return i?(i.updateEveryTick?t&&this.clockBusId===void 0&&(this.clockBusId=Il(()=>this.update())):this.clockBusId!==void 0&&(Al(this.clockBusId),this.clockBusId=void 0),i.getBlock()):this.curTripBlock}willUpdate(){var t;let e=this.getTourStep();e&&(this.curTripBlock=e),this.isLastStep()&&((t=this.getCurrentStep())!=null&&t.shouldAdvance())&&setTimeout(()=>this.tourController.stopTour())}onMount(){this.updateListener||(this.updateListener=this.controller.subscribeToChanges(__dcg_shared_module_exports__['z'](()=>{this._isMounted&&this.update()},600)))}willUnmount(){this.updateListener!==void 0&&(this.updateListener(),this.updateListener=void 0),this.clockBusId!==void 0&&Al(this.clockBusId),this.tourController.clearTimeouts()}template(){return g0.createElement("div",null,bme(()=>this.curTripBlock,e=>g0.createElement(av,{tourController:this.props.tourController,controller:this.props.controller,content:()=>e().content,header:()=>e().header,innerHTML:()=>e().innerHTML,position:()=>e().position,target:()=>e().target})))}};var NV=class extends Su{constructor(){super(...arguments);this.steps=[[this.requireExpressionsVisible(),this.requireNotEditListMode(),{shouldAdvance:()=>!!document.querySelector(".dcg-extend-to-3d"),getBlock:()=>({position:"e",content:"Start by graphing a 2-dimensional equation, like y=2x+3",target:{element:this.getAvailableExp()}}),type:"guardrail"},{shouldAdvance:()=>!document.querySelector(".dcg-extend-to-3d .dcg-component-checkbox.dcg-checked"),getBlock:()=>({position:"e",content:"This graph was extended to 3D, so it shows every (x,y,z) value that satisfies the equation, not just the ones in the plane where z=0.",target:{element:this.getMatchingExpNode(wV)}})},{shouldAdvance:()=>this.hasMatchingExpression(wV),getBlock:()=>({position:"s",content:this.raw("Check this box to see the surface."),target:{selector:".dcg-extend-to-3d .dcg-component-checkbox:not(.dcg-checked) .dcg-checkbox"}})}]]}};var BV=class extends Su{constructor(){super(...arguments);this.steps=[[this.requireExpressionsVisible(),{shouldAdvance:()=>document.getElementsByClassName("dcg-colored-icon").length>0,getBlock:()=>({position:"e",content:"Start by graphing something. For example, type (1,2,0) to plot a point",target:{element:this.getAvailableExp()}}),type:"guardrail"},{shouldAdvance:()=>{var t;return((t=this.controller.getOpenItemMenu())==null?void 0:t.type)==="expression"},getBlock:()=>({position:"e",content:this.raw("To open display properties, click and hold on the icon."),target:{element:document.getElementsByClassName("dcg-colored-icon")[0]}}),type:"guardrail"},{shouldAdvance:()=>{let t=this.controller.getOpenItemMenu();return(t==null?void 0:t.type)!=="expression"?!1:this.currentlySelectedColor?t.model.color!==this.currentlySelectedColor:(this.currentlySelectedColor=t.model.color,!1)},getBlock:()=>({position:"e",content:this.raw("Click on a new tile to change the color."),target:{selector:".dcg-color-picker-container"}})}]]}};var UV=class extends Su{constructor(){super(...arguments);this.steps=[[this.requireExpressionsVisible(),this.requireNotEditListMode(),{shouldAdvance:()=>this.hasMatchingExpression(lp),getBlock:()=>({position:"e",content:"To create a slider, type something like a=1",target:{element:this.getAvailableExp()}}),type:"guardrail"},{shouldAdvance:()=>{let t=this.getMatchingExpModel(lp);if(!t||t.type!=="expression")return!1;let i=t.latex.match(/(\w+)\=/);if(!i)return!1;let o=i[1];return this.hasMatchingExpression([l0(o)],[t.id])},getBlock:()=>{let t=this.getMatchingExpIds(lp);return{position:"e",content:"Now use that new parameter somewhere else in this graph.",target:{element:this.getAvailableExp(t)}}},type:"guardrail"},{shouldAdvance:()=>!this.hasMatchingExpression(c0),getBlock:()=>({position:"e",content:'This graph already has a slider! Drag it to change the value, or press "play" to animate.',target:{updatePosition:"never",element:this.getMatchingExpNode(lp)}})},{shouldAdvance:()=>this.hasMatchingExpression(c0),getBlock:()=>{var t;return{position:"s",content:"Drag the handle to watch your graph update.",target:{updatePosition:"never",element:(t=this.getMatchingExpNode(lp))==null?void 0:t.querySelector(".dcg-slider-container .dcg-thumb .dcg-graphic")}}}}]]}};var zV=class extends Su{constructor(){super(...arguments);this.steps=[[{shouldAdvance:()=>this.controller.getState().graph.showAxis3D!==!1||document.getElementsByClassName("dcg-settings-container").length>0,getBlock:()=>({position:"w",content:"The axes are already off. To turn them on, or adjust other settings, click on this wrench.",target:{selector:".dcg-action-settings"}})},{shouldAdvance:()=>document.getElementsByClassName("dcg-settings-container").length>0||this.controller.getState().graph.showAxis3D===!1,getBlock:()=>({position:"w",content:this.raw("To change graph settings, click on this wrench."),target:{selector:".dcg-action-settings"}}),type:"guardrail"},{shouldAdvance:()=>this.controller.getState().graph.showAxis3D===!1,getBlock:()=>({position:"s",content:this.raw("Click here to turn off the axes, plane, and labels all at once."),target:{selector:".dcg-toggle-switch"}})}]]}};var sv={change_color_3d:{tour:BV,titleKey:"graphing-tours-label-change-color",thumb:"change-color-2x.png"},change_line_to_surface:{tour:NV,titleKey:"graphing-tours-label-show-surface",thumb:"show-3D-surface-2x.png"},add_slider:{tour:UV,titleKey:"graphing-tours-label-add-slider",thumb:"add-slider-2x.png"},turn_off_axes:{tour:zV,titleKey:"graphing-tours-label-turn-off-axes",thumb:"turn-off-axes-2x.png"}};var{Each:yme}=ga.Components,KV=class extends ga.Class{init(){this.tourController=this.props.tourController(),this.controller=this.tourController.controller}template(){return ga.createElement("div",{class:ga.const("dcg-mini-tours-container")},ga.createElement("h2",{class:ga.const("dcg-unstyled-heading"),id:ga.const("dcg-quest-mini-tours-heading")},()=>this.controller.s("graphing-tours-label-quest-tours")),ga.createElement("ul",{class:ga.const("dcg-quest-mini-tours dcg-unstyled-list"),"aria-labelledby":ga.const("#dcg-quest-mini-tours-heading")},yme(()=>this.getMiniTours(),{item:e=>ga.createElement("li",null,ga.createElement("button",{class:()=>({"dcg-unstyled-button":!0,"dcg-tour-tile":!0,"dcg-active":this.tourController.getActiveMinitour()===e}),"aria-current":()=>this.tourController.getActiveMinitour()===e,onTap:()=>this.onTapMinitour(e),manageFocus:this.const(ft({controller:this.controller,location:{type:"quest",location:"mini-tour-button",tour:e}}))},ga.createElement("img",{src:()=>`/assets/img/quests/${sv[e].thumb}`,width:ga.const("90"),height:ga.const("90"),alt:()=>this.controller.s("graphing-tours-narration-tour-thumbnail",{title:this.getTourTitle(e)})}),ga.createElement("div",{class:ga.const("dcg-tour-title")},()=>this.getTourTitle(e))))})))}getTourTitle(e){return this.controller.s(sv[e].titleKey)}onTapMinitour(e){this.tourController.getActiveMinitour()===e?this.tourController.stopTour():this.tourController.startMiniTour(e)}getMiniTours(){var e;return((e=this.tourController.getCurrentQuest())==null?void 0:e.hintMiniTours)||[]}};var{For:xme,If:m0}=hr.Components,qV=class extends hr.Class{constructor(){super(...arguments),this.resizeListener=()=>{this.clampPosition()}}init(){this.tourController=this.props.tourController(),this.controller=this.tourController.controller}startDrag(e){e.device!=="keyboard"&&e.target&&(e.preventDefault(),pi(),this.previousCursor=document.body.style.cursor,document.body.style.setProperty("cursor","move","important"),this.dragDrop.startDrag(e))}onMountRoot(e){this.dragDrop=new ew;let t=this.tourController.getQuestWindowPos();t&&(this.setPosition(t.left,t.top),this.cachePosition()),this.dragDrop.observeEvent("onDrop",()=>{this.isDragging=!1,document.body.style.cursor=this.previousCursor,this.cachedPos&&this.tourController.setQuestWindowPos(this.cachedPos.left,this.cachedPos.top),this.update()}),this.dragDrop.observeEvent("onGrab",()=>{this.cachePosition(),this.isDragging=!0}),this.dragDrop.observeEvent("onDrag",(i,o)=>{this.updatePosition(o.dx,o.dy)}),window.addEventListener("resize",this.resizeListener),this.resizeObserver=new ResizeObserver(()=>this.resizeListener()),this.resizeObserver.observe(e)}willUnmount(){this.resizeObserver.disconnect(),window.removeEventListener("resize",this.resizeListener)}getQuestNode(){var e;return(e=this.findRootNode())==null?void 0:e.querySelector(".dcg-quest")}cachePosition(){var t;let e=(t=this.getQuestNode())==null?void 0:t.getBoundingClientRect();e&&(this.cachedPos={left:e.left,top:e.top,width:e.width,height:e.height})}setPosition(e,t){let i=this.getQuestNode();i&&(i.style.bottom="unset",i.style.right="unset",i.style.top=`${t}px`,i.style.left=`${e}px`)}clampPosition(){var n;let e=this.getQuestNode(),t=e==null?void 0:e.getBoundingClientRect();if(!t)return;let i=(n=document.getElementById("dcg-header-container"))==null?void 0:n.getBoundingClientRect(),o=i?i.height:0;e.style.top&&e.style.top!=="unset"&&t.top>window.innerHeight-t.height-5&&(e.style.top=`${Math.max(o+5,window.innerHeight-t.height-5)}px`),e.style.left&&e.style.left!=="unset"&&t.left>window.innerWidth-t.width-5&&(e.style.left=`${Math.max(5,window.innerWidth-t.width-5)}px`)}updatePosition(e,t){var n;if(this.cachedPos||this.cachePosition(),!this.cachedPos)return;let i=(n=document.getElementById("dcg-header-container"))==null?void 0:n.getBoundingClientRect(),o=i?i.height:0;this.setPosition(__dcg_shared_module_exports__['Cb'](this.cachedPos.left+e,5,window.innerWidth-this.cachedPos.width-5),__dcg_shared_module_exports__['Cb'](this.cachedPos.top+t,o+5,window.innerHeight-this.cachedPos.height-5))}getPaneTabIndex(){let e=this.controller.getFocusLocation();if(e&&e.type==="quest"&&e.location==="quest-pane")return 0}template(){return hr.createElement("div",null,hr.createElement(m0,{predicate:()=>this.tourController.getSuccessModalIsOpen()},()=>hr.createElement(RV,{tourController:this.props.tourController,showAnimation:()=>!ay})),hr.createElement("aside",{class:()=>({"dcg-quest":!0,"dcg-closing":!!this.tourController.getCurrentQuestIsClosing()}),id:hr.const("dcg-quest"),"aria-labelledby":hr.const("dcg-quest__title"),"aria-describedby":hr.const("dcg-quest__instructions"),onMount:this.bindFn(this.onMountRoot),tabIndex:this.bindFn(this.getPaneTabIndex),manageFocus:this.const(ft({controller:this.controller,location:{type:"quest",location:"quest-pane"}}))},hr.createElement("div",{class:hr.const("dcg-quest__header"),onTapStart:this.bindFn(this.startDrag)},hr.createElement("h1",{class:hr.const("dcg-title"),id:hr.const("dcg-quest__title")},()=>{var e;return(e=this.tourController.getCurrentQuest())==null?void 0:e.title}),hr.createElement("div",{class:hr.const("dcg-sr-only"),id:hr.const("dcg-quest__instructions")},()=>this.controller.raw("Press F6 to switch keyboard focus back and forth between this quest and the calculator.")),hr.createElement("button",{class:hr.const("dcg-tours-btn dcg-btn-gray-outline"),manageFocus:this.const(ft({controller:this.controller,location:{type:"quest",location:"close-button"}})),"aria-label":()=>this.controller.s("graphing-tours-label-close-quest"),onTap:()=>{this.tourController.stopQuest()}},()=>this.controller.s("graphing-tours-label-close-quest"))),hr.createElement("div",{class:hr.const("dcg-quest__body")},hr.createElement(m0,{predicate:()=>!this.tourController.getHintsVisible()},()=>hr.createElement("div",null,hr.createElement("div",{class:hr.const("dcg-quest__prompt")},()=>{var e;return(e=this.tourController.getCurrentQuest())==null?void 0:e.prompt}),hr.createElement(xme,{each:()=>this.tourController.getQuestGoals(),key:e=>e.text},hr.createElement("ul",{class:hr.const("dcg-unstyled-list dcg-quest__steps")},e=>hr.createElement(FV,{validationStatus:()=>this.tourController.getGoalValidationStatus(e),title:()=>e.text,controller:()=>this.controller}))))),hr.createElement(m0,{predicate:()=>this.tourController.getHintsVisible()},()=>hr.createElement(KV,{tourController:this.props.tourController}))),hr.createElement("div",{class:hr.const("dcg-footer")},hr.createElement("button",{class:()=>({"dcg-main-quest-btn":!0,"dcg-btn-gray-outline":this.tourController.getHintsVisible(),"dcg-btn-pink":!this.tourController.getHintsVisible(),"dcg-disabled":this.validationButtonDisabled()}),disabled:()=>this.validationButtonDisabled()?!0:void 0,onTap:()=>this.tourController.getHintsVisible()?this.tourController.setHintsVisible(!1):!this.validationButtonDisabled()&&this.tourController.checkQuestGoals(),manageFocus:this.const(ft({controller:this.controller,location:{type:"quest",location:"check-button"}}))},hr.createElement(m0,{predicate:()=>this.tourController.getHintsVisible()},()=>hr.createElement("i",{class:hr.const("dcg-icon-chevron-left"),"aria-hidden":hr.const("true")})),()=>this.tourController.getHintsVisible()?this.controller.s("graphing-tours-label-quest-back-to-quest"):this.controller.s("graphing-tours-label-check-progress")),hr.createElement(m0,{predicate:()=>{var e;return(((e=this.tourController.getCurrentQuest())==null?void 0:e.hintMiniTours)||[]).length>0}},()=>hr.createElement($e,{gravity:this.const("n"),tooltip:()=>this.tourController.getHintsVisible()?this.controller.s("graphing-tours-label-quest-back-to-quest"):this.controller.s("graphing-tours-label-quest-take-a-tour")},hr.createElement("button",{class:()=>({"dcg-unstyled-button":!0,"dcg-gray-outline-icon":!0,"dcg-active":this.tourController.getHintsVisible()}),"aria-label":()=>this.tourController.getHintsVisible()?this.controller.s("graphing-tours-label-quest-back-to-quest"):this.controller.s("graphing-tours-label-quest-tours-aria"),onTap:()=>{this.tourController.setHintsVisible(!this.tourController.getHintsVisible())},manageFocus:this.const(ft({controller:this.controller,location:{type:"quest",location:"hints-button"}}))},hr.createElement("i",{class:hr.const("dcg-icon-map"),"aria-hidden":hr.const("true")})))))))}validationButtonDisabled(){let e=this.tourController.getQuestValidationStatus();return e==="validating"||e==="complete"&&this.tourController.getSuccessModalIsOpen()}};var Io=__dcg_shared_module_exports__['e'](te());var{For:wme}=Io.Components,HV=class extends Io.Class{init(){this.tourController=this.props.tourController(),this.controller=this.tourController.controller}template(){return Io.createElement(Qo,{title:()=>this.controller.s("account-shell-label-try-a-quest-title"),size:this.const("narrow"),class:this.const("dcg-quests-modal"),showX:this.const(!0),onClose:this.bindFn(this.closeModal),i18n:()=>this.controller},Io.createElement(wme,{each:()=>Object.keys(Ll)},Io.createElement("ul",{class:Io.const("dcg-all-quest-buttons dcg-unstyled-list")},e=>Io.createElement("li",null,Io.createElement("a",{class:Io.const("dcg-quest-button"),tabindex:Io.const("0"),role:Io.const("link"),onTap:()=>this.launchQuest(e)},Io.createElement("img",{width:Io.const("180"),height:Io.const("180"),alt:()=>this.controller.s("graphing-tours-narration-quest-thumbnail",{title:this.controller.raw(Ll[e].title)}),src:()=>`/assets/img/quests/${Ll[e].thumb}`}),Io.createElement("div",null,()=>this.controller.raw(Ll[e].title)))))),Io.createElement("div",{class:Io.const("dcg-quests-disclaimer")},Io.const("Quests are an experimental new feature. Please share your thoughts with us at"),Io.const(" "),Io.createElement("a",{class:Io.const("dcg-blue-link"),href:Io.const("mailto:feedback@desmos.com")},Io.const("feedback@desmos.com")),Io.const(".")))}closeModal(){this.tourController.setQuestsListModalVisibility(!1)}launchQuest(e){this.tourController.startQuest(e),this.closeModal()}};var{If:fQ}=Cd.Components,WV=class extends Cd.Class{init(){this.tourController=this.props.tourController(),window.addEventListener("hashchange",this.bindFn(this.update))}isQuestsModalOpen(){return this.tourController.getQuestsListModalIsOpen()}isQuestOpen(){return!!this.tourController.getQuestActive()}onMount(){this.tourController.setRootView(this)}template(){return Cd.createElement("div",{id:Cd.const("dcg-quest-container")},Cd.createElement(fQ,{predicate:this.bindFn(this.isQuestsModalOpen)},()=>Cd.createElement(HV,{tourController:()=>this.tourController})),Cd.createElement(fQ,{predicate:this.bindFn(this.isQuestOpen)},()=>Cd.createElement(qV,{tourController:()=>this.tourController})))}};var $V=class extends lv.Class{init(){this.controller=this.props.controller()}template(){return lv.createElement("div",null,lv.createElement(OV,{controller:this.props.controller}),lv.createElement(WV,{tourController:()=>this.controller.tourController}))}};var Zt=__dcg_shared_module_exports__['e'](te());var Ki=__dcg_shared_module_exports__['e'](te());var jV=__dcg_shared_module_exports__['e'](te()),Du=class extends jV.Class{hasShellController(){return"getOpenModal"in this.props.controller()}template(){return jV.createElement("div",{class:()=>({modal_section:!0,"dcg-hotkeys-dialog":this.hasShellController()&&this.props.controller().getOpenModal()==="hotkeys"})},this.children)}};qt();var{Input:vme,Checkbox:Cme,If:Eme}=Ki.Components,cv=class extends Ki.Class{init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController,this.lastSavedTitle=this.graphsController.getCurrentGraphTitle(),this.controller.getOpenModal()==="duplicate"?this.newSaveTitle=this.controller.s("account-shell-text-copy-of-title",{originalTitle:this.lastSavedTitle}):this.newSaveTitle=this.lastSavedTitle||this.graphsController.getUntitledString(),this.controller.state.saveDialog==null&&(this.controller.state.saveDialog={copyOnSave:!0})}template(){return Ki.createElement(Du,{controller:this.props.controller},Ki.createElement("div",{id:Ki.const("save-dialog")},Ki.createElement("h1",null,()=>this.getTitle()),Ki.createElement("div",{class:Ki.const("dcg-clear")}),Ki.createElement("form",{didMount:this.bindFn(this.didMountForm)},Ki.createElement("label",{class:Ki.const("input-label")},Ki.createElement("div",{class:Ki.const("graph-title-title")},()=>this.controller.s("account-shell-label-graph-title"),Ki.const("\xA0")),Ki.createElement(vme,{class:Ki.const("title-input dcg-input-blue-outline"),name:Ki.const("title"),placeholder:()=>this.graphsController.getUntitledString(),value:()=>this.newSaveTitle,maxlength:Ki.const("140"),onInput:e=>this.newSaveTitle=e,didMount:e=>ie(e).trigger("focus").trigger("select")})),Ki.createElement("div",null,Ki.createElement("button",{type:Ki.const("submit"),class:Ki.const("dcg-btn dcg-btn-primary pull-right dcg-action-save")},()=>this.controller.s("account-shell-button-save")),Ki.createElement(Eme,{predicate:()=>this.shouldShowDuplicateOption()&&this.graphsController.wasCurrentGraphEverSaved()},()=>Ki.createElement("label",{class:Ki.const("dcg-new-copy pull-right")},Ki.createElement(Cme,{checked:()=>this.controller.state.saveDialog.copyOnSave,onChange:e=>{if(this.controller.state.saveDialog.copyOnSave=e,this._isMounted)return this.update()}}),Ki.createElement("span",{class:Ki.const("duplicate-label")},()=>this.getDuplicateLabel())))))))}didMountForm(e){ie(e).on("submit",t=>{t.preventDefault(),this.newSaveTitle===""&&(this.newSaveTitle="Untitled Graph");let i;this.shouldShowDuplicateOption()?i=this.controller.state.saveDialog.copyOnSave:i=this.controller.getOpenModal()!=="rename",this.controller.dispatch({type:"save-graph",payload:{title:this.newSaveTitle,saveAs:i},device:"mouse"})})}getTitle(){if(this.controller.product==="geometry")return this.controller.s("account-shell-heading-save-construction");switch(this.controller.getOpenModal()){case"rename":return this.controller.s("account-shell-heading-rename-graph");case"save":return this.controller.s("account-shell-heading-save-graph");case"duplicate":return this.controller.s("account-shell-heading-duplicate-graph");default:return""}}getDuplicateLabel(){return this.controller.product==="geometry"?this.controller.s("account-shell-heading-duplicate-construction"):this.controller.s("account-shell-heading-duplicate-graph")}shouldShowDuplicateOption(){if(this.controller.product==="geometry")return!0;let e=this.controller.getModalState();return!!(e.modal==="save"&&e.fromSaveInProgress)}};var Ve=__dcg_shared_module_exports__['e'](te());qt();var il=__dcg_shared_module_exports__['e'](te());var Gb=class extends il.Class{template(){return il.createElement("div",{class:il.const("dcg-shared-cookie-notice")},il.createElement(yi,{key:this.const("shared-message-cookie-notice"),i18n:this.props.i18n},il.createElement("b",null,il.const("Note:")),il.const(" Desmos uses cookies to enable persistence when you are signed in. If you do not wish to use cookies, please use Desmos without logging in."),il.const(" "),il.createElement("a",{class:il.const("dcg-shared-cookie-notice-learn-more dcg-gray-link"),href:il.const("/privacy"),target:il.const("_blank")},il.const("Learn More."))))}};var Ac=__dcg_shared_module_exports__['e'](te());var{If:Sme,For:Dme}=Ac.Components,ma=class extends Ac.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller}template(){return Ac.createElement(Sme,{predicate:()=>!!this.props.errors().length},()=>Ac.createElement(Dme,{each:this.props.errors},Ac.createElement("span",null,e=>Ac.createElement("div",{class:Ac.const("dcg-shared-account-modal-errors"),role:Ac.const("alert")},Ac.createElement("span",null,()=>this.i18n.raw(e))))))}};var{If:f0,Input:YV,Switch:kme}=Ve.Components,XV=0,nN=1,JV=class extends Ve.Class{template(){return Ve.createElement("span",{class:Ve.const("dcg-shared-terms-notice")},Ve.createElement(yi,{key:this.const("shared-message-privacy-notice"),i18n:this.props.i18n},Ve.const("I have read, understand, and accept the"),Ve.const(" "),Ve.createElement("a",{href:Ve.const("/terms"),target:Ve.const("_blank"),class:Ve.const("dcg-blue-link")},Ve.const("Terms of Service")),Ve.const(" "),Ve.const("and"),Ve.const(" "),Ve.createElement("a",{href:Ve.const("/privacy"),target:Ve.const("_blank"),class:Ve.const("dcg-blue-link")},Ve.const("Privacy Policy")),Ve.const(".")))}},QV=class extends Ve.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.selectedView=XV,this.givenName="",this.familyName="",this.email="",this.password="",this.consentChecked=!1,this.isSubmittingForm=!1,this.formErrors=[],this.breakPoint=660,this.measureWindow(),this.controller.getModalStartingError()&&this.formErrors.push(this.controller.getModalStartingError())}template(){return Ve.createElement(Qo,{title:()=>this.i18n.s("shared-title-signup"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},Ve.createElement("div",{class:()=>({"dcg-shared-signup-dialog":!0,"dcg-shared-account-dialog":!0})},Ve.createElement("div",{class:Ve.const("dcg-shared-switch-account-message")},()=>this.i18n.s("shared-prompt-already-have-account"),this.const(this.i18n.raw(" ")),Ve.createElement("a",{role:Ve.const("link"),tabindex:Ve.const("0"),class:Ve.const("dcg-gray-link"),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"login",device:e.device})},()=>this.i18n.s("shared-button-login")),Ve.const(".")),Ve.createElement("div",{class:Ve.const("dcg-shared-navigation-tabs"),role:Ve.const("tablist")},Ve.createElement("div",{role:Ve.const("tab"),tabindex:Ve.const("0"),"aria-selected":this.bindFn(this.isGoogleSelected),class:()=>({"dcg-shared-tab-gray-underline":!0,"dcg-shared-tab-always-underline":!0,"dcg-shared-profile-view-button":!0,"dcg-selected":this.isGoogleSelected()}),onTap:()=>this.updateView(XV)},this.bindFn(this.externalTitle)),Ve.createElement("div",{role:Ve.const("tab"),tabindex:Ve.const("0"),"aria-selected":this.bindFn(this.isDesmosSelected),class:()=>({"dcg-shared-tab-gray-underline":!0,"dcg-shared-tab-always-underline":!0,"dcg-shared-password-view-button":!0,"dcg-selected":this.isDesmosSelected()}),onTap:()=>this.updateView(nN)},this.bindFn(this.desmosTitle))),Ve.createElement("div",{class:Ve.const("dcg-shared-account-content-container")},Ve.createElement(kme,{key:()=>this.selectedView},e=>e===XV?Ve.createElement("div",{class:Ve.const("dcg-shared-notice-checkbox-google")},Ve.createElement(xt,{checked:()=>this.consentChecked,disabled:this.const(!1),onChange:()=>{if(this.consentChecked=!this.consentChecked,this._isMounted)return this.update()}},this.bindFn(this.consentText)),Ve.createElement(xt,{checked:()=>this.privacyChecked,disabled:this.const(!1),onChange:()=>{if(this.privacyChecked=!this.privacyChecked,this._isMounted)return this.update()}},Ve.createElement(JV,{i18n:this.const(this.i18n)})),Ve.createElement(f0,{predicate:()=>window.googleAuthConnectionFailed},()=>Ve.createElement("div",{class:Ve.const("dcg-shared-google-auth-unavailable")},()=>this.i18n.s("shared-message-google-login-not-available"))),Ve.createElement(f0,{predicate:()=>!window.googleAuthConnectionFailed},()=>Ve.createElement("div",{class:()=>({"dcg-btn-gray-outline":!0,"dcg-shared-google-login":!0,"dcg-disabled":this.hasNotConsented()}),role:Ve.const("button"),tabindex:()=>this.hasNotConsented()?"-1":"0","aria-disabled":this.bindFn(this.hasNotConsented),onTap:()=>this.googleLogin()},Ve.createElement("div",{class:Ve.const("dcg-shared-google-icon dcg-shared-external-login-logo")}),Ve.createElement("span",null,this.bindFn(this.getGoogleLoginText)))),Ve.createElement(f0,{predicate:()=>this.controller.allowSignInWithApple()},()=>Ve.createElement("div",{class:()=>({"dcg-btn-gray-outline":!0,"dcg-shared-apple-login":!0,"dcg-disabled":this.hasNotConsented()}),role:Ve.const("button"),tabindex:()=>this.hasNotConsented()?"-1":"0","aria-disabled":this.bindFn(this.hasNotConsented),onTap:()=>this.appleLogin()},Ve.createElement("div",{class:Ve.const("dcg-shared-apple-icon dcg-shared-external-login-logo")}),Ve.createElement("span",null,this.bindFn(this.getAppleLoginText))))):e===nN?Ve.createElement("div",null,Ve.createElement(ma,{controller:this.props.controller,errors:()=>this.formErrors}),Ve.createElement("form",{class:Ve.const("dcg-shared-action-submit"),onSubmit:this.bindFn(this.onSubmit),didMount:this.bindFn(this.didMountForm)},Ve.createElement("div",{class:Ve.const("dcg-shared-email-form-container")},Ve.createElement("label",null,Ve.createElement("span",{class:Ve.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-email")),Ve.createElement(YV,{type:Ve.const("email"),pattern:this.const(xd),name:Ve.const("email"),class:Ve.const("dcg-shared-input-blue-outline"),required:Ve.const("true"),"aria-describedby":Ve.const("email-description"),didMount:t=>{Id||t.focus()},value:()=>this.email,onInput:t=>{if(this.email=t,this._isMounted)return this.update()}})),Ve.createElement("div",{class:Ve.const("dcg-shared-name-container")},Ve.createElement("div",{class:Ve.const("dcg-shared-name-input")},Ve.createElement("label",null,Ve.createElement("span",{class:Ve.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-given-name-or-nickname")),Ve.createElement(YV,{type:Ve.const("text"),name:Ve.const("given-name"),class:Ve.const("dcg-shared-input-blue-outline"),required:Ve.const("true"),"aria-describedby":Ve.const("given-name-description"),value:()=>this.givenName,onInput:t=>{if(this.givenName=t,this._isMounted)return this.update()}}))),Ve.createElement("div",{class:Ve.const("dcg-shared-name-input")},Ve.createElement("label",null,Ve.createElement("span",{class:Ve.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-family-name")),Ve.createElement(YV,{type:Ve.const("text"),name:Ve.const("family-name"),class:Ve.const("dcg-shared-input-blue-outline"),"aria-describedby":Ve.const("family-name-description"),value:()=>this.familyName,onInput:t=>{if(this.familyName=t,this._isMounted)return this.update()}})))),Ve.createElement("label",null,Ve.createElement("span",null,()=>this.i18n.s("shared-label-password")),Ve.createElement(YV,{type:Ve.const("password"),class:Ve.const("dcg-shared-input-blue-outline"),name:Ve.const("password"),required:Ve.const("true"),value:()=>this.password,onInput:t=>{if(this.password=t,this._isMounted)return this.update()}})),Ve.createElement("div",{class:Ve.const("dcg-shared-notice-checkbox-email")},Ve.createElement(xt,{checked:()=>this.consentChecked,disabled:this.const(!1),onChange:()=>{if(this.consentChecked=!this.consentChecked,this._isMounted)return this.update()}},this.bindFn(this.consentText))),Ve.createElement(xt,{checked:()=>this.privacyChecked,disabled:this.const(!1),onChange:()=>{if(this.privacyChecked=!this.privacyChecked,this._isMounted)return this.update()}},Ve.createElement(JV,{i18n:this.const(this.i18n)})),Ve.createElement("div",{class:Ve.const("dcg-shared-sign-in-options")},Ve.createElement(f0,{predicate:()=>this.isSubmittingForm},()=>Ve.createElement("div",{class:Ve.const("dcg-shared-progress-indicator dcg-shared-create-account-progress")},Ve.createElement("div",{class:Ve.const("dcg-shared-spinner")}))),Ve.createElement(f0,{predicate:()=>!this.isSubmittingForm},()=>Ve.createElement("div",{class:Ve.const("dcg-shared-submit-container")},Ve.createElement("button",{type:Ve.const("submit"),class:()=>({"dcg-btn-blue":!0,"dcg-disabled":!this.submitEnabled()}),"aria-disabled":()=>!this.submitEnabled(),tabindex:()=>this.submitEnabled()?"0":"-1"},()=>this.i18n.s("shared-button-create-account")))))))):Ve.createElement("span",null)),Ve.createElement(Gb,{i18n:this.const(this.i18n)}))))}canSwitchRoles(){return!this.controller.getLimitedSignupRole()}didMountForm(e){this.form=e}submitEnabled(){var o,n,a;if(!this.consentChecked||!this.privacyChecked||!this.form)return!1;let e=(o=this.form.querySelector('[name="password"]'))==null?void 0:o.value,t=(n=this.form.querySelector('[name="email"]'))==null?void 0:n.value,i=(a=this.form.querySelector('[name="given-name"]'))==null?void 0:a.value;return!!(e&&t&&i)}onSubmit(e){e.preventDefault(),this.submitEnabled()&&this.submitForm()}googleLogin(){this.controller.dispatch({type:"close-modal"}),this.controller.userController.googleLogin({fromUI:"create"})}appleLogin(){this.controller.dispatch({type:"close-modal"}),this.controller.userController.appleLogin({fromUI:"create"})}getGoogleLoginText(){return this.consentChecked&&this.privacyChecked?this.i18n.s("shared-prompt-sign-up-with-google"):this.i18n.s("shared-prompt-please-consent-to-sign-up-with-google")}getAppleLoginText(){return this.consentChecked&&this.privacyChecked?this.i18n.s("shared-prompt-sign-up-with-apple"):this.i18n.s("shared-prompt-please-consent-to-sign-up-with-apple")}async submitForm(){this.formErrors=[],this.isSubmittingForm=!0,this._isMounted&&this.update();try{if(await this.controller.userController.createAccount({userProvidedName:{given:this.givenName,family:this.familyName.length?this.familyName:void 0},email:this.email,password:this.password,teacher:!1,lang:this.controller.getLanguage()}),this._isMounted)return this.controller.dispatch({type:"close-modal"})}catch(e){this.formErrors=this.controller.parseJSONErrors(e)}finally{this.isSubmittingForm=!1,this._isMounted&&this.update()}}updateView(e){this.selectedView=e,this._isMounted&&this.update()}externalTitle(){return this.controller.allowSignInWithApple()?this.windowWidth>this.breakPoint?this.i18n.s("shared-button-external-account-wide"):this.i18n.s("shared-button-external-account-narrow"):this.windowWidth>this.breakPoint?this.i18n.s("shared-button-google-account-wide"):this.i18n.s("shared-button-google-account-narrow")}desmosTitle(){return this.windowWidth>this.breakPoint?this.i18n.s("shared-button-email-address-wide"):this.i18n.s("shared-button-email-address-narrow")}measureWindow(){return this.windowWidth=ie(window).width()}didMount(){ie(window).on("resize.create-account",__dcg_shared_module_exports__['z'](()=>{this.measureWindow(),this.update()},200))}didUnmount(){ie(window).off("resize.create-account")}consentText(){return this.i18n.s("shared-message-consent-text")}isGoogleSelected(){return this.selectedView===XV}isDesmosSelected(){return this.selectedView===nN}hasNotConsented(){return!this.consentChecked||!this.privacyChecked}};var tt=__dcg_shared_module_exports__['e'](te());var{If:b0,Input:bQ,IfElse:Gme}=tt.Components,ZV=class extends tt.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.email="",this.password="",this.isSubmittingForm=!1,this.formErrors=[],this.controller.getModalStartingError()&&this.formErrors.push(this.controller.getModalStartingError())}template(){return tt.createElement(Qo,{title:()=>this.i18n.s("shared-title-login"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},tt.createElement("div",{class:tt.const("dcg-shared-login-dialog dcg-shared-account-dialog")},Gme(()=>this.canChooseRole(),{true:()=>tt.createElement("div",{class:tt.const("dcg-shared-switch-account-message")},tt.createElement(yi,{key:this.const("shared-prompt-new-to-desmos-teacher-or-student"),i18n:this.props.controller},tt.const("New to Desmos?"),tt.const(" "),tt.createElement("a",{role:tt.const("link"),tabindex:tt.const("0"),class:tt.const("dcg-gray-link"),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"signup",device:e.device})},tt.const("Sign up!")))),false:()=>tt.createElement("div",{class:tt.const("dcg-shared-switch-account-message")},tt.createElement(yi,{key:this.const("shared-prompt-new-to-desmos-sign-up-here"),i18n:this.props.controller},tt.const("New to Desmos?"),tt.const(" "),tt.createElement("a",{role:tt.const("link"),tabindex:tt.const("0"),class:tt.const("dcg-gray-link"),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"signup",device:e.device})},tt.const("Sign up")),tt.const(".")))}),tt.createElement("div",{class:tt.const("dcg-shared-account-content-container")},tt.createElement(b0,{predicate:()=>window.googleAuthConnectionFailed},()=>tt.createElement("div",{class:tt.const("dcg-shared-google-auth-unavailable")},()=>this.i18n.s("shared-message-google-login-not-available"))),tt.createElement(b0,{predicate:()=>!window.googleAuthConnectionFailed},()=>tt.createElement("div",{class:tt.const("dcg-btn-gray-outline dcg-shared-google-login"),role:tt.const("button"),tabindex:tt.const("0"),onTap:()=>this.googleLogin()},tt.createElement("div",{class:tt.const("dcg-shared-google-icon dcg-shared-external-login-logo")}),tt.createElement("span",null,()=>this.i18n.s("shared-button-sign-in-with-google")))),tt.createElement(b0,{predicate:()=>this.controller.allowSignInWithApple()},()=>tt.createElement("div",{class:tt.const("dcg-btn-gray-outline dcg-shared-apple-login"),role:tt.const("button"),tabindex:tt.const("0"),onTap:()=>this.appleLogin()},tt.createElement("div",{class:tt.const("dcg-shared-apple-icon dcg-shared-external-login-logo")}),tt.createElement("span",null,()=>this.i18n.s("shared-button-sign-in-with-apple"))))),tt.createElement("div",{class:tt.const("dcg-shared-bg-line")},tt.createElement("span",null,()=>this.i18n.s("shared-message-or-login-with-desmos"))),tt.createElement(ma,{controller:this.props.controller,errors:()=>this.formErrors}),tt.createElement("form",{class:tt.const("dcg-shared-action-submit"),onSubmit:this.bindFn(this.onSubmit)},tt.createElement("div",{class:tt.const("dcg-shared-email-form-container")},tt.createElement("label",null,tt.createElement("span",{class:tt.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-email")),tt.createElement(bQ,{type:tt.const("email"),pattern:this.const(xd),name:tt.const("email"),class:tt.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-email"),required:tt.const("required"),didMount:e=>{Id||e.focus()},value:()=>this.email,onInput:e=>{this.email=e,this._isMounted&&this.update()}})),tt.createElement("div",{class:tt.const("dcg-shared-password-container")},tt.createElement("label",{for:tt.const("password")},tt.createElement("span",null,()=>this.i18n.s("shared-label-password")),tt.createElement(bQ,{type:tt.const("password"),class:tt.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-password"),required:tt.const("true"),value:()=>this.password,name:this.const("password"),onInput:e=>{if(this.password=e,this._isMounted)return this.update()}}),tt.createElement("span",{class:tt.const("dcg-shared-password-recovery-link")},tt.createElement("a",{role:tt.const("link"),tabindex:tt.const(0),class:tt.const("dcg-shared-action-password"),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"recover-password",device:e.device})},()=>this.i18n.s("shared-prompt-forgot-your-password"))))),tt.createElement("div",{class:tt.const("dcg-shared-sign-in-options")},tt.createElement(b0,{predicate:()=>this.isSubmittingForm},()=>tt.createElement("div",{class:tt.const("dcg-shared-progress-indicator dcg-shared-create-account-progress")},tt.createElement("div",{class:tt.const("dcg-shared-spinner")}))),tt.createElement(b0,{predicate:()=>!this.isSubmittingForm},()=>tt.createElement("div",{class:tt.const("dcg-shared-submit-container")},tt.createElement("button",{type:tt.const("submit"),class:()=>({"dcg-btn-blue":!0,"dcg-disabled":!this.submitEnabled()}),"aria-disabled":()=>!this.submitEnabled(),tabindex:()=>this.submitEnabled()?"0":"-1"},()=>this.i18n.s("shared-button-login-capitalized"))))),tt.createElement(Gb,{i18n:this.const(this.i18n)})))))}canChooseRole(){return!this.controller.getLimitedSignupRole()}onSubmit(e){e.preventDefault(),this.submitForm()}googleLogin(){this.controller.dispatch({type:"close-modal"}),this.controller.userController.googleLogin({fromUI:"login"})}appleLogin(){this.controller.dispatch({type:"close-modal"}),this.controller.userController.appleLogin({fromUI:"login"})}submitEnabled(){return!!(this.email&&this.password)}async submitForm(){if(this.submitEnabled()){this.isSubmittingForm=!0,this.formErrors=[];try{let e=await this.controller.userController.checkPendingDeletion({email:this.email,lang:this.controller.getLanguage()});this._pendingDeletion=e.pendingDeletion}catch(e){this._pendingDeletion=!1}this._isMounted&&this.update();try{await this.controller.userController.desmosLogin({email:this.email,password:this.password,lang:this.controller.getLanguage()}),this._pendingDeletion?this.controller.dispatch({type:"show-modal",modal:"account-reenabled",device:"mouse"}):this.controller.dispatch({type:"close-modal"})}catch(e){this.formErrors=this.controller.parseJSONErrors(e)}this._isMounted&&(this.isSubmittingForm=!1,this.controller.dispatch({type:"render"}))}}};var qr=__dcg_shared_module_exports__['e'](te());var{If:eL,Input:Tme}=qr.Components,tL=class extends qr.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.email=this.controller.userController.getEmail(),this.formErrors=[],this.isSubmittingForm=!1,this.didSendRecoveryEmail=!1}template(){return qr.createElement(Qo,{title:()=>this.i18n.s("shared-title-recover-password"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},qr.createElement("div",{class:qr.const("dcg-shared-recover-password-dialog dcg-shared-account-dialog")},qr.createElement(ma,{controller:this.props.controller,errors:()=>this.formErrors}),qr.createElement(eL,{predicate:()=>this.didSendRecoveryEmail},()=>qr.createElement("div",{role:qr.const("alert"),class:qr.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-message-check-email-for-password-recovery-link"),qr.const(" "),qr.createElement("a",{href:qr.const("#"),class:qr.const("dcg-blue-link"),onTap:e=>(this.didSendRecoveryEmail=!1,this.controller.dispatch({type:"show-modal",modal:"recover-password",device:e.device}))},()=>this.i18n.s("shared-button-try-again")))),qr.createElement(eL,{predicate:()=>!this.didSendRecoveryEmail},()=>qr.createElement("form",{class:qr.const("dcg-shared-email-form-container"),onSubmit:this.bindFn(this.onSubmit)},qr.createElement("div",{class:qr.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-prompt-enter-email-for-password-recovery-link")),qr.createElement("label",null,qr.createElement("span",{class:qr.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-email")),qr.createElement(Tme,{type:qr.const("email"),pattern:this.const(xd),name:qr.const("email"),class:qr.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-email"),required:qr.const("true"),didMount:e=>{Id&&e.focus()},value:()=>this.email,onInput:e=>{this.email=e,this._isMounted&&this.update()}})),qr.createElement("div",{class:qr.const("dcg-shared-sign-in-options")},qr.createElement(eL,{predicate:()=>this.isSubmittingForm},()=>qr.createElement("div",{class:qr.const("dcg-shared-progress-indicator dcg-shared-create-account-progress")},qr.createElement("div",{class:qr.const("dcg-shared-spinner")}))),qr.createElement(eL,{predicate:()=>!this.isSubmittingForm},()=>qr.createElement("button",{class:()=>({"dcg-btn-blue":!0}),type:qr.const("submit")},()=>this.i18n.s("shared-button-recover-password"))))))))}onSubmit(e){e.preventDefault(),this.submitForm()}async submitForm(){this.formErrors=[],this.isSubmittingForm=!0;try{if(await this.controller.userController.recoverPassword({email:this.email,lang:this.controller.getLanguage()}),!this._isMounted)return;this.didSendRecoveryEmail=!0}catch(e){if(!this._isMounted)return;this.formErrors=this.controller.parseJSONErrors(e)}finally{this._isMounted&&(this.isSubmittingForm=!1,this.update())}}};var bt=__dcg_shared_module_exports__['e'](te());var yQ={i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-braille",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-nemeth-mode",standard:"<key>ALT</key> + <key>N</key>",apple:"<key>CTRL</key> + <key>N</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-ueb-mode",standard:"<key>ALT</key> + <key>U</key>",apple:"<key>CTRL</key> + <key>U</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-print-mode",standard:"<key>ALT</key> + <key>Q</key>",apple:"<key>CTRL</key> + <key>Q</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-braille-typing",standard:"<key>ALT</key> + <key>6</key>",apple:"<key>CTRL</key> + <key>6</key>"}]};var rL=function(r){let e={i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-expression-entry-and-navigation",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-expression",standard:"<key>UP ARROW</key>, <key>SHIFT</key> + <key>Tab</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-expression",standard:"<key>DOWN ARROW</key>, <key>Tab</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-remove-empty-expression",standard:"<key>Backspace</key>",apple:"<key>Delete</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-character",standard:"<key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-character",standard:"<key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-move-to-numerator",standard:"<key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-move-to-denominator",standard:"<key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-exit-block",standard:"<key>Tab</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-beginning-of-block",standard:"<key>Home</key>",apple:"<key>Fn</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-end-of-block",standard:"<key>End</key>",apple:"<key>Fn</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-beginning-of-expression",standard:"<key>CTRL</key> + <key>Home</key>",apple:"<key>CTRL</key> + <key>Fn</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-end-of-expression",standard:"<key>CTRL</key> + <key>End</key>",apple:"<key>CTRL</key> + <key>Fn</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-selection-left",standard:"<key>SHIFT</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-selection-right",standard:"<key>SHIFT</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-delete-selection",standard:"<key>Backspace</key>",apple:"<key>Delete</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-select-all",standard:"<key>CTRL</key> + <key>A</key>",apple:"<key>COMMAND</key> + <key>A</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-parent-block",standard:"<key>CTRL</key> + <key>ALT</key> + <key>UP ARROW</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-focused-block",standard:"<key>CTRL</key> + <key>ALT</key> + <key>DOWN ARROW</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-left-adjacent-block",standard:"<key>CTRL</key> + <key>ALT</key> + <key>LEFT ARROW</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-right-adjacent-block",standard:"<key>CTRL</key> + <key>ALT</key> + <key>RIGHT ARROW</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-selection",standard:"<key>CTRL</key> + <key>ALT</key> + <key>SHIFT</key> + <key>DOWN ARROW</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>SHIFT</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-answer",standard:"<key>CTRL</key> + <key>ALT</key> + <key>=</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>SHIFT</key> + <key>RIGHT ARROW</key>"}]};return r.decimalToFraction&&e.shortcuts.push({i18nKey:"shared-calculator-text-keyboard-shortcut-show-answer-as-decimal-or-fraction",standard:"<key>ALT</key> + <key>SHIFT</key> + <key>A</key>",apple:"<key>COMMAND</key> + <key>SHIFT</key> + <key>A</key>"}),e};function aN(r){return{common:sN(r),tables:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-tables",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-table-previous-cell",standard:"<key>SHIFT</key> + <key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-next-cell",standard:"<key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-previous-row",standard:"<key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-next-row",standard:"<key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-previous-column",standard:"<key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-next-column",standard:"<key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-first-row",standard:"<key>CTRL</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-last-row",standard:"<key>CTRL</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-first-column",standard:"<key>CTRL</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-last-column",standard:"<key>CTRL</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-speak-column-header",standard:"<key>CTRL</key> + <key>H</key>"}]},sliders:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-sliders",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-decrease",standard:"<key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-decrease-larger",standard:"<key>PAGE DOWN</key>",apple:"<key>FN</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-increase",standard:"<key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-increase-larger",standard:"<key>PAGE UP</key>",apple:"<key>FN</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-minimum",standard:"<key>HOME</key>",apple:"<key>FN</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-maximum",standard:"<key>END</key>",apple:"<key>FN</key> + <key>RIGHT ARROW</key>"}]},audiotrace:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-audio-tracing",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-audio-trace",standard:"<key>ALT</key> + <key>T</key>",apple:"<key>OPTION</key> + <key>T</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-summarize-graph",standard:"<key>ALT</key> + <key>S</key>",apple:"<key>OPTION</key> + <key>S</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-describe-axes",standard:"<key>ALT</key> + <key>G</key>",apple:"<key>OPTION</key> + <key>G</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-point",standard:"<key>LEFT ARROW</key>, <key>UP ARROW</key>, <key>J</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-point",standard:"<key>RIGHT ARROW</key>, <key>DOWN ARROW</key>, <key>L</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-poi",standard:"<key>PAGE UP</key>, <key>SHIFT</key> + <key>TAB</key>, <key>K</key>",apple:"<key>FN</key> + <key>UP ARROW</key>, <key>SHIFT</key> + <key>TAB</key>, <key>K</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-poi",standard:"<key>PAGE DOWN</key>, <key>TAB</key>, <key>I</key>",apple:"<key>FN</key> + <key>DOWN ARROW</key>, <key>TAB</key>, <key>I</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-first-point",standard:"<key>HOME</key>, <key>U</key>",apple:"<key>FN</key> + <key>LEFT ARROW</key>, <key>U</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-last-point",standard:"<key>END</key> <key>N</key>",apple:"<key>FN</key> + <key>RIGHT ARROW</key> <key>N</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-poi-count",standard:"<key>P</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-x",standard:"<key>X</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-y",standard:"<key>Y</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-color",standard:"<key>C</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-branch",standard:"<key>B</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-point-type",standard:"<key>T</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-move-to-origin",standard:"<key>O</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-curve",standard:"<key>ALT</key> + <key>UP ARROW</key>",apple:"<key>OPTION</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-curve",standard:"<key>ALT</key> + <key>DOWN ARROW</key>",apple:"<key>OPTION</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-hear-graph",standard:"<key>H</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-hear-specific-branch",standard:"<key>1</key> - <key>0</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-adjust-playback-speed",standard:"<key>ALT</key> + <key>1</key> - <key>5</key>",apple:"<key>OPTION</key> + <key>1</key> - <key>5</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-volume",standard:"<key>V</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-decrease-volume",standard:"<key>SHIFT</key> + <key>V</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-announce-slider-animations",standard:"<key>A</key>"}]},slidertrace:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-slider-trace",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-slider-trace",standard:"<key>S</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-decrease",standard:"<key>LEFT ARROW</key> <key>J</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-decrease-larger",standard:"<key>PAGE DOWN</key>",apple:"<key>FN</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-increase",standard:"<key>RIGHT ARROW</key> <key>L</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-increase-larger",standard:"<key>PAGE UP</key>",apple:"<key>FN</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-minimum",standard:"<key>HOME</key> <key>U</key>",apple:"<key>FN</key> + <key>LEFT ARROW</key> <key>U</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-maximum",standard:"<key>END</key> <key>N</key>",apple:"<key>FN</key> + <key>RIGHT ARROW</key> <key>N</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-next-slider",standard:"<key>DOWN ARROW</key>, <key>TAB</key>, <key>K</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-previous-slider",standard:"<key>UP ARROW</key>, <key>SHIFT</key> + <key>TAB</key>, <key>I</key>"}]},interactivepoints:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-interactive-points",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-focus-first-interactive-point",standard:"<key>CTRL</key> + <key>ALT</key> + <key>P</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>P</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-interactive-point",standard:"<key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-interactive-point",standard:"<key>SHIFT</key> + <key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-x",standard:"<key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-decrease-x",standard:"<key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-y",standard:"<key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-decrease-y",standard:"<key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-x-larger",standard:"<key>SHIFT</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-decrease-x-larger",standard:"<key>SHIFT</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-y-larger",standard:"<key>SHIFT</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-decrease-y-larger",standard:"<key>SHIFT</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-x",standard:"<key>X</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-y",standard:"<key>Y</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-label",standard:"<key>L</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-color",standard:"<key>C</key>"}]},commonactions:y0({folders:!0,notes:!0,images:!0,authorFeatures:!1}),desmoscomonly:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-desmos-com-only",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-open-shortcuts-dialog",standard:"<key>CTRL</key> + <key>/</key>",apple:"<key>COMMAND</key> + <key>/</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-open-a-graph",standard:"<key>CTRL</key> + <key>O</key>",apple:"<key>COMMAND</key> + <key>O</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-save-a-graph",standard:"<key>CTRL</key> + <key>S</key>",apple:"<key>COMMAND</key> + <key>S</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-print-a-graph",standard:"<key>CTRL</key> + <key>P</key>",apple:"<key>COMMAND</key> + <key>P</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-account-menu",standard:"<key>CTRL</key> + <key>ALT</key> + <key>A</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>A</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-help-menu",standard:"<key>CTRL</key> + <key>ALT</key> + <key>H</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>H</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-language-menu",standard:"<key>CTRL</key> + <key>ALT</key> + <key>L</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>L</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-share-menu",standard:"<key>CTRL</key> + <key>ALT</key> + <key>S</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>S</key>"}]},braille:yQ,mathquill:rL({decimalToFraction:!0})}}function sN(r){let e={i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-common-symbols",shortcuts:[{latex:"a^b",standard:"<key>^</key> (<key>SHIFT</key> + <key>6</key>)"},{latex:"a_b",standard:"<key>_</key> (<key>SHIFT</key> + <key>-</key>)"},{latex:"\\le",standard:"<key><</key><key>=</key>"},{latex:"\\ge",standard:"<key>></key><key>=</key>"},{latex:"a'",standard:"<key>'</key>"},{latex:"\\frac{a}{b}",standard:"<key>f</key><key>r</key><key>a</key><key>c</key>"},{latex:"\\sqrt{a}",standard:"<key>s</key><key>q</key><key>r</key><key>t</key>"},{latex:"\\sqrt[3]{a}",standard:"<key>c</key><key>b</key><key>r</key><key>t</key>"},{latex:"\\sqrt[n]{a}",standard:"<key>n</key><key>t</key><key>h</key><key>r</key><key>o</key><key>o</key><key>t</key>"},{latex:"\\sum_{n=a}^b",standard:"<key>s</key><key>u</key><key>m</key>"}]};return e.shortcuts.push({latex:"\\int_a^b",standard:r.isGeometry?"<key>i</key><key>n</key><key>t</key><key>e</key><key>g</key><key>r</key><key>a</key><key>l</key>":"<key>i</key><key>n</key><key>t</key>"}),e.shortcuts=e.shortcuts.concat([{latex:"\\prod_{n=a}^b",standard:"<key>p</key><key>r</key><key>o</key><key>d</key>"},{latex:"\\pi",standard:"<key>p</key><key>i</key>"},{latex:"\\theta",standard:"<key>t</key><key>h</key><key>e</key><key>t</key><key>a</key>"},{latex:"\\to",standard:"<key>-</key><key>></key>"}]),e}function y0(r){let e={i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-common-actions",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-close-a-dialog",standard:"<key>ESC</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-show-or-hide-expression-list",standard:"<key>SHIFT</key> + <key>ALT</key> + <key>E</key>",apple:"<key>SHIFT</key> + <key>COMMAND</key> + <key>E</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-focus-expression-list",standard:"<key>CTRL</key> + <key>ALT</key> + <key>E</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>E</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-open-expression-options",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>O</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-show-or-hide-expression",standard:"<key>SHIFT</key> + <key>ALT</key> + <key>H</key>",apple:"<key>SHIFT</key> + <key>COMMAND</key> + <key>H</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-delete-expression",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>D</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-degrees-toggle",standard:"<key>ALT</key> + <key>D</key>",apple:"<key>CTRL</key> + <key>D</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-keypad-toggle",standard:"<key>ALT</key> + <key>K</key>",apple:"<key>CTRL</key> + <key>K</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-mute-toggle",standard:"<key>ALT</key> + <key>M</key>",apple:"<key>CTRL</key> + <key>M</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-add-expression",standard:"<key>CTRL</key> + <key>ALT</key> + <key>X</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>X</key>"}]};return r.notes&&e.shortcuts.push({i18nKey:"shared-calculator-text-keyboard-shortcut-add-note",standard:"<key>CTRL</key> + <key>ALT</key> + <key>O</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>O</key>"}),r.folders&&(e.shortcuts=e.shortcuts.concat([{i18nKey:"shared-calculator-text-keyboard-shortcut-add-folder",standard:"<key>CTRL</key> + <key>ALT</key> + <key>F</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>F</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-collapse-folder",standard:"<key>ALT</key> + <key>UP ARROW</key>",apple:"<key>COMMAND</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-expand-folder",standard:"<key>ALT</key> + <key>DOWN ARROW</key>",apple:"<key>COMMAND</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-collapse-all-folders",standard:"<key>ALT</key> + <key>SHIFT</key> + <key>UP ARROW</key>",apple:"<key>COMMAND</key> + <key>SHIFT</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-expand-all-folders",standard:"<key>ALT</key> + <key>SHIFT</key> + <key>DOWN ARROW</key>",apple:"<key>COMMAND</key> + <key>SHIFT</key> + <key>DOWN ARROW</key>"}])),r.images&&e.shortcuts.push({i18nKey:"shared-calculator-text-keyboard-shortcut-add-image",standard:"<key>CTRL</key> + <key>ALT</key> + <key>I</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>I</key>"}),e.shortcuts=e.shortcuts.concat([{i18nKey:"shared-calculator-text-keyboard-shortcut-add-table",standard:"<key>CTRL</key> + <key>ALT</key> + <key>T</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>T</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-undo",standard:"<key>CTRL</key> + <key>Z</key>",apple:"<key>COMMAND</key> + <key>Z</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-redo",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>Z</key>",apple:"<key>COMMAND</key> + <key>SHIFT</key> + <key>Z</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-zoom-in",standard:"<key>ALT</key> + <key>+</key>",apple:"<key>CTRL</key> + <key>+</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-zoom-out",standard:"<key>ALT</key> + <key>-</key>",apple:"<key>CTRL</key> + <key>-</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-zoom-restore-default",standard:"<key>ALT</key> + <key>0</key>",apple:"<key>CTRL</key> + <key>0</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-zoom-fit",standard:"<key>SHIFT</key> + <key>ALT</key> + <key>Z</key>",apple:"<key>SHIFT</key> + <key>OPTION</key> + <key>Z</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-edit-list-mode",standard:"<key>CTRL</key> + <key>ALT</key> + <key>D</key>",apple:"<key>CTRL</key> + <key>OPTION</key> + <key>D</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-graph-settings-menu",standard:"<key>CTRL</key> + <key>ALT</key> + <key>G</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>G</key>"}]),r.authorFeatures&&e.shortcuts.push({i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-author-mode",standard:"<key>ALT</key> + <key>SHIFT</key> + <key>O</key>",apple:"<key>COMMAND</key> + <key>SHIFT</key> + <key>O</key>"}),e}var ku=aN({isGeometry:!1});var x0={toolSelection:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-geometry-tool-selection",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-focus-toolbar",standard:"<key>CTRL</key> + <key>ALT</key> + <key>M</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>M</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-between-toolbar-categories",standard:"<key>LEFT ARROW</key>, <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-between-toolbar-dropdown-items",standard:"<key>UP ARROW</key>, <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-choose-toolbar-item-and-focus-graph",standard:"<key>ENTER</key>",apple:"<key>RETURN</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-cancel-active-tool",standard:"<key>ESC</key>"}]},graphNavigation:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-geometry-graph-navigation-during-construction",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-focus-graph-paper",standard:"<key>CTRL</key> + <key>ALT</key> + <key>P</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>P</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-navigate-graph",standard:"<key>UP ARROW</key>, <key>DOWN ARROW</key>, <key>LEFT ARROW</key>, <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-to-top-of-graph",standard:"<key>CTRL</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-to-bottom-of-graph",standard:"<key>CTRL</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-to-left-of-graph",standard:"<key>CTRL</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-to-right-of-graph",standard:"<key>CTRL</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-next-object",standard:"<key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-previous-object",standard:"<key>SHIFT</key> + <key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-describe-object",standard:"<key>D</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-repeat-active-tool-prompt",standard:"<key>?</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-select-tool-by-number",standard:"<key>1</key>, <key>2</key>, <key>3</key>, ..., <key>6</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-select-next-category",standard:"<key>=</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-select-previous-category",standard:"<key>-</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-select-next-tool-within-category",standard:"<key>]</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-select-previous-tool-within-category",standard:"<key>[</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-add-object-to-selection",standard:"<key>ENTER</key>",apple:"<key>RETURN</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-drag-movable-objects",standard:"<key>UP ARROW</key>, <key>DOWN ARROW</key>, <key>LEFT ARROW</key>, <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-delete-selected-objects",standard:"<key>DELETE</key>, <key>BACKSPACE</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-focus-selected-objects-toolbar",standard:"<key>CTRL</key> + <key>ALT</key> + <key>M</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>M</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-open-options",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>O</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-open-transformation-options",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>A</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-deselect-all-objects",standard:"<key>ESC</key>"}]},expressionEdit:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-geometry-expression-edit",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-focus-graph-paper",standard:"<key>CTRL</key> + <key>ALT</key> + <key>P</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>P</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-navigate-graph",standard:"<key>UP ARROW</key>, <key>DOWN ARROW</key>, <key>LEFT ARROW</key>, <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-to-top-of-graph",standard:"<key>CTRL</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-expression-edit-next-object",standard:"<key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-expression-edit-previous-object",standard:"<key>SHIFT</key> + <key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-expression-edit-add-object",standard:"<key>ENTER</key>",apple:"<key>RETURN</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-expression-edit-complete",standard:"<key>ENTER</key>",apple:"<key>RETURN</key>"}]},tokenNavigator:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-geometry-token-navigator",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-open-token-navigator",standard:"<key>CTRL</key> + <key>ALT</key> + <key>C</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>C</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-close-token-navigator",standard:"<key>ESC</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-navigate-tokens-at-current-level",standard:"<key>LEFT ARROW</key>, <key>RIGHT ARROW</key"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-navigate-object-levels",standard:"<key>UP ARROW</key>, <key>DOWN ARROW</key"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-token-between-expression-list-and-navigator",standard:"<key>ALT</key> + <key>SHIFT</key> + <key>T</key>",apple:"<key>OPTION</key> + <key>SHIFT</key> + <key>T</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-select-single-object-token",standard:"<key>ENTER</key>",apple:"<key>RETURN</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-add-object-token-to-selection",standard:"<key>SHIFT</key> + <key>ENTER</key>",apple:"<key>SHIFT</key> + <key>RETURN</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-delete-selected-objects",standard:"<key>DELETE</key>, <key>BACKSPACE</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-focus-selected-objects-toolbar",standard:"<key>CTRL</key> + <key>ALT</key> + <key>M</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>M</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-open-options",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>O</key>"}]},...aN({isGeometry:!0})};var{audiotrace:zlt,slidertrace:Klt,interactivepoints:qlt,...Mme}=JSON.parse(JSON.stringify(ku));Mme.commonactions=lN({folders:!0,notes:!0,images:!0,authorFeatures:!1});function lN(r){let e=y0(r);return e.shortcuts.unshift({i18nKey:"shared-calculator-text-keyboard-shortcut-focus-graph-paper",standard:"<key>CTRL</key> + <key>ALT</key> + <key>P</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>P</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-rotate-3d-cube",i18nStandard:"shared-calculator-text-keyboard-shortcut-rotate-3d-cube-command"},{i18nKey:"shared-calculator-text-keyboard-shortcut-spin-3d-cube",i18nStandard:"shared-calculator-text-keyboard-shortcut-spin-3d-cube-command"},{i18nKey:"shared-calculator-text-keyboard-shortcut-switch-pane-in-3d-quest",standard:"<key>F6</key>"}),e}var ws=__dcg_shared_module_exports__['e'](te());var{For:cN,If:Ime}=ws.Components,vs=class extends ws.Class{template(){return ws.createElement("table",{class:ws.const("dcg-shortcuts-table")},ws.createElement(cN,{each:this.bindFn(this.getCols)},ws.createElement("tr",null,e=>ws.createElement("th",null,()=>this.getHeader(e)))),ws.createElement(cN,{each:()=>__dcg_shared_module_exports__['B'](this.props.section().shortcuts)},ws.createElement("tbody",null,e=>ws.createElement(cN,{each:this.bindFn(this.getCols)},ws.createElement("tr",null,t=>ws.createElement("td",{didMount:i=>this.populateContent(i,e,t)},ws.createElement(Ime,{predicate:()=>!!this.getLatex(e)},()=>ws.createElement(lt,{latex:()=>this.getLatex(e),config:this.const({})}))))))))}getLatex(e){return this.props.section().shortcuts[e].latex||""}populateContent(e,t,i){let o=this.props.section().shortcuts[t];switch(i){case"heading":if(o.latex)return;o.i18nKey&&(e.innerHTML=this.props.controller().s(o.i18nKey));return;case"windows":o.i18nStandard?e.innerHTML=this.replaceKey(this.props.controller().s(o.i18nStandard)):e.innerHTML=this.replaceKey(o.standard||"");return;case"mac":o.i18nApple?e.innerHTML=this.replaceKey(this.props.controller().s(o.i18nApple)):o.i18nStandard?e.innerHTML=this.replaceKey(this.props.controller().s(o.i18nStandard)):e.innerHTML=this.replaceKey(o.apple||o.standard||"");return}}getHeader(e){let t=this.props.controller().s;switch(e){case"heading":return t("shared-calculator-heading-function-table-column-header");case"windows":return t("shared-calculator-heading-windows-chrome-table-column-header");case"mac":return t("shared-calculator-heading-mac-table-column-header")}}getCols(){return this.props.os?this.props.os()==="windows"?["heading","windows"]:["heading","mac"]:["heading","windows","mac"]}replaceKey(e){return e.replace(/\<key\>/g,"<span class='dcg-key-command'>").replace(/\<\/key\>/g,"</span>")}};var{If:ol}=bt.Components,iL=class extends bt.Class{init(){this.controller=this.props.controller(),this.controller.state.hotkeysDialog==null&&(this.controller.state.hotkeysDialog={shortcutOS:Ti?"mac":"windows"})}showGeoShortcuts(){return this.controller.product==="geometry-calculator"}show3dShortcuts(){return this.controller.product==="graphing-3d"}template(){return bt.createElement(Du,{controller:this.props.controller},bt.createElement("div",{id:bt.const("dcg-hotkeys-dialog")},bt.createElement("h1",null,()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts")),bt.createElement("div",{class:bt.const("dcg-hotkeys-toggle-container")},bt.createElement(Xi,{staticConfig:this.bindFn(this.getOSOptions),ariaGroupLabel:()=>this.controller.s("shared-calculator-label-os")})),bt.createElement("div",{class:bt.const("dcg-hotkey-container")},bt.createElement("div",{class:bt.const("dcg-hotkey-section")},bt.createElement(ol,{predicate:this.bindFn(this.showGeoShortcuts)},()=>bt.createElement("h2",{class:bt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-geometry-tool-selection"))),bt.createElement(ol,{predicate:this.bindFn(this.showGeoShortcuts)},()=>bt.createElement(vs,{controller:this.props.controller,section:this.const(x0.toolSelection),os:this.bindFn(this.getShortcutOS)})),bt.createElement(ol,{predicate:this.bindFn(this.showGeoShortcuts)},()=>bt.createElement("h2",{class:bt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-geometry-expression-edit"))),bt.createElement(ol,{predicate:this.bindFn(this.showGeoShortcuts)},()=>bt.createElement(vs,{controller:this.props.controller,section:this.const(x0.expressionEdit),os:this.bindFn(this.getShortcutOS)})),bt.createElement(ol,{predicate:this.bindFn(this.showGeoShortcuts)},()=>bt.createElement("h2",{class:bt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-geometry-token-navigator"))),bt.createElement(ol,{predicate:this.bindFn(this.showGeoShortcuts)},()=>bt.createElement(vs,{controller:this.props.controller,section:this.const(x0.tokenNavigator),os:this.bindFn(this.getShortcutOS)})),bt.createElement("h2",{class:bt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-common-actions")),bt.createElement(ol,{predicate:this.bindFn(this.show3dShortcuts)},()=>bt.createElement(vs,{controller:this.props.controller,section:()=>lN({folders:!0,notes:!0,images:!0,authorFeatures:!!pr("authorFeatures")}),os:this.bindFn(this.getShortcutOS)})),bt.createElement(ol,{predicate:()=>!this.show3dShortcuts()},()=>bt.createElement(vs,{controller:this.props.controller,section:()=>y0({folders:!0,notes:!0,images:!0,authorFeatures:!!pr("authorFeatures")}),os:this.bindFn(this.getShortcutOS)})),bt.createElement("h2",{class:bt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-desmos-com-only")),bt.createElement(vs,{controller:this.props.controller,section:this.const(ku.desmoscomonly),os:this.bindFn(this.getShortcutOS)}),bt.createElement("h2",{class:bt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-expression-entry-and-navigation")),bt.createElement(vs,{controller:this.props.controller,section:()=>rL({decimalToFraction:this.controller.isDecimalToFractionEnabled()}),os:this.bindFn(this.getShortcutOS)}),bt.createElement(ol,{predicate:()=>!this.show3dShortcuts()},()=>bt.createElement("h2",{class:bt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-interactive-points"))),bt.createElement(ol,{predicate:()=>!this.show3dShortcuts()},()=>bt.createElement(vs,{controller:this.props.controller,section:this.const(ku.interactivepoints),os:this.bindFn(this.getShortcutOS)}))),bt.createElement("div",{class:bt.const("dcg-hotkey-section")},bt.createElement(ol,{predicate:this.bindFn(this.showGeoShortcuts)},()=>bt.createElement("h2",{class:bt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-text-keyboard-shortcut-geometry-navigate-graph"))),bt.createElement(ol,{predicate:this.bindFn(this.showGeoShortcuts)},()=>bt.createElement(vs,{controller:this.props.controller,section:this.const(x0.graphNavigation),os:this.bindFn(this.getShortcutOS)})),bt.createElement("h2",{class:bt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-symbols")),bt.createElement(vs,{controller:this.props.controller,section:()=>sN({isGeometry:this.showGeoShortcuts()}),os:this.bindFn(this.getShortcutOS)}),bt.createElement(ol,{predicate:()=>!this.show3dShortcuts()},()=>bt.createElement("h2",{class:bt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-audio-tracing"))),bt.createElement(ol,{predicate:()=>!this.show3dShortcuts()},()=>bt.createElement(vs,{controller:this.props.controller,section:this.const(ku.audiotrace),os:this.bindFn(this.getShortcutOS)})),bt.createElement(ol,{predicate:()=>!this.show3dShortcuts()},()=>bt.createElement("h2",{class:bt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-slider-trace"))),bt.createElement(ol,{predicate:()=>!this.show3dShortcuts()},()=>bt.createElement(vs,{controller:this.props.controller,section:this.const(ku.slidertrace),os:this.bindFn(this.getShortcutOS)})),bt.createElement("h2",{class:bt.const("dcg-hotkey-section-header tables-section")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-sliders")),bt.createElement(vs,{controller:this.props.controller,section:this.const(ku.sliders),os:this.bindFn(this.getShortcutOS)}),bt.createElement("h2",{class:bt.const("dcg-hotkey-section-header tables-section")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-tables")),bt.createElement(vs,{controller:this.props.controller,section:this.const(ku.tables),os:this.bindFn(this.getShortcutOS)}),bt.createElement("h2",{class:bt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-braille")),bt.createElement(vs,{controller:this.props.controller,section:this.const(ku.braille),os:this.bindFn(this.getShortcutOS)})))))}getOSOptions(){return[{key:"windows",label:()=>this.controller.s("shared-calculator-button-windows-chrome"),selected:()=>this.getShortcutOS()==="windows",onSelect:()=>this.setShortcutOS("windows")},{key:"mac",label:()=>this.controller.s("shared-calculator-button-mac"),selected:()=>this.getShortcutOS()==="mac",onSelect:()=>this.setShortcutOS("mac")}]}getShortcutOS(){return this.controller.state.hotkeysDialog.shortcutOS}setShortcutOS(e){this.controller.state.hotkeysDialog.shortcutOS=e,this._isMounted&&this.update()}didMount(){this.updateVisibleShortcuts()}didUpdate(){this.updateVisibleShortcuts()}updateVisibleShortcuts(){let e=this.getShortcutOS(),t=document.querySelector(".dcg-os-mac"),i=document.querySelector(".dcg-os-windows");!t||!i||(e==="mac"?(t.style.display="block",i.style.display="none"):e==="windows"&&(t.style.display="none",i.style.display="block"))}};var Dn=__dcg_shared_module_exports__['e'](te());var oL=class extends Dn.Class{init(){this.controller=this.props.controller()}template(){return Dn.createElement(Du,{controller:this.props.controller},Dn.createElement("div",{id:Dn.const("unsupported-browser")},Dn.createElement("div",{id:Dn.const("unsupported-browser-title"),style:Dn.const("color:black; font-size:150%;")},()=>this.controller.s("account-shell-heading-unsupported-browser")),Dn.createElement("div",{style:Dn.const("padding:20px 0px; color:#666")},()=>this.controller.s("account-shell-text-unsupported-browser-android"),Dn.createElement("br",null),Dn.createElement("br",null),Dn.createElement("a",{href:Dn.const("https://play.google.com/store/apps/details?id=com.android.chrome")},()=>this.controller.s("account-shell-link-download-chrome"),Dn.createElement("br",null),Dn.createElement("br",null)),Dn.createElement("div",{style:Dn.const("text-align: center; margin-top: 25px; margin-bottom:-16px")},Dn.createElement("a",{role:Dn.const("link"),tabindex:Dn.const("0"),class:Dn.const("dcg-btn dcg-action-hide dcg-do-not-blur"),onTap:()=>this.controller.dispatch({type:"close-modal"})},()=>this.controller.s("account-shell-button-hide-browser-warning"))))))}};var kn=__dcg_shared_module_exports__['e'](te());var rt=__dcg_shared_module_exports__['e'](te());var Oi=__dcg_shared_module_exports__['e'](te());var nL=class extends Oi.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.formErrors=[]}template(){return Oi.createElement("div",{class:Oi.const("dcg-shared-delete-account dcg-shared-account-settings-section")},Oi.createElement("h1",{class:Oi.const("dcg-shared-left-align-title")},()=>this.i18n.s("shared-title-delete-account")),Oi.createElement("div",{class:Oi.const("dcg-shared-account-paragraph")},Oi.createElement(yi,{key:this.const("shared-message-delete-account-notice"),i18n:this.props.controller},Oi.const("When you delete your account,"),Oi.const(" "),Oi.createElement("b",null,Oi.const("we will retain your data for 30 days.")),Oi.const(" You can reactivate your account at any time during those 30 days by logging back in. If there's something about Desmos we can improve, please"),Oi.const(" "),Oi.createElement("a",{href:Oi.const("mailto:support@desmos.com"),class:Oi.const("dcg-blue-link")},Oi.const("let us know.")))),Oi.createElement("div",{class:Oi.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-message-delete-account-will-send-email",{email:this.i18n.raw(this.controller.userController.getEmail())})),Oi.createElement("form",{onSubmit:this.bindFn(this.onSubmit)},Oi.createElement(ma,{controller:this.props.controller,errors:()=>this.formErrors}),Oi.createElement("div",{class:Oi.const("dcg-shared-modal-actions-container")},Oi.createElement("div",{role:Oi.const("link"),tabindex:Oi.const(0),class:Oi.const("dcg-gray-link"),onTap:()=>this.props.hideForm()},()=>this.i18n.s("shared-button-cancel")),Oi.createElement("button",{class:()=>({"dcg-btn-red":!0,"dcg-disabled":this.disabled}),"aria-disabled":()=>this.disabled,tabindex:()=>this.disabled?"-1":"0",type:Oi.const("submit")},()=>this.i18n.s("shared-button-send-delete-account-email")))))}onAccountDeleted(){this.props.submitForm()}onAccountDeletionFailed(){this.formErrors=[this.controller.getSomethingWentWrongText()],this.update()}doDeleteAccount(){this.disabled||(this.controller.logEvent({category:"accounts",action:"send-delete-email"}),this.controller.userController.initiateAccountDeletion({lang:this.controller.getLanguage()}).then(this.bindFn(this.onAccountDeleted),this.bindIfMounted(this.onAccountDeletionFailed)))}onSubmit(e){e.preventDefault(),this.doDeleteAccount()}};var lr=__dcg_shared_module_exports__['e'](te());var{If:dN}=lr.Components,dv=0,xQ=1,Ame=2,wQ=3,aL=class extends lr.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.formStatus=dv,this.emailDisabled=null}template(){return lr.createElement("div",{class:lr.const("dcg-shared-email-field-container")},lr.createElement(dN,{predicate:()=>this.formStatus===dv},()=>lr.createElement("div",{class:lr.const("dcg-shared-email-field")},lr.createElement("div",{class:lr.const("dcg-shared-profile-info-container")},lr.createElement("span",{class:lr.const("dcg-shared-profile-info-title"),role:lr.const("heading"),"aria-level":lr.const("1")},()=>this.i18n.s("shared-title-email-settings")),lr.createElement("div",{class:lr.const("dcg-shared-profile-info-content")},()=>this.i18n.raw(this.controller.userController.getEmail()),lr.createElement("div",{class:lr.const("dcg-shared-message-container")},lr.createElement("div",{role:lr.const("link"),tabindex:lr.const(0),class:lr.const("dcg-blue-link"),onTap:()=>this.setFormStatus(xQ)},()=>this.i18n.s("shared-button-change-email-address"))))))),lr.createElement(dN,{predicate:()=>this.formStatus===xQ},()=>lr.createElement("div",{class:lr.const("dcg-shared-change-email-container")},lr.createElement("div",{class:lr.const("dcg-shared-change-email-description")},()=>this.i18n.s("shared-message-email-settings-will-send-email",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})),lr.createElement(ma,{controller:this.props.controller,errors:()=>this.formErrors}),lr.createElement("div",{class:lr.const("dcg-shared-modal-actions-container")},lr.createElement("span",{role:lr.const("link"),tabindex:lr.const(0),class:lr.const("dcg-gray-link"),onTap:()=>this.setFormStatus(dv)},()=>this.i18n.s("shared-button-cancel")),lr.createElement("button",{class:()=>({"dcg-btn-blue":!0,"dcg-disabled":this.emailDisabled}),"aria-disabled":()=>this.disabled,tabindex:()=>this.disabled?"-1":"0",type:lr.const("submit"),onTap:()=>this.emailDisabled||this.sendChangeEmail()},()=>this.i18n.s("shared-button-send-email"))))),lr.createElement(dN,{predicate:()=>this.formStatus===wQ},()=>lr.createElement("div",{"aria-live":lr.const("assertive"),"aria-atomic":lr.const("true"),class:lr.const("dcg-shared-confirmation-message-container")},lr.createElement("div",{class:lr.const("dcg-shared-confirmation-message")},lr.createElement("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0}),"aria-hidden":lr.const("true")}),()=>this.i18n.s("shared-message-email-sent")),lr.createElement("div",null,()=>this.i18n.s("shared-message-check-email-for-link",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})))))}setToast(e){this._isMounted&&(this.toastMessage||(this.toastMessage=e,this.update(),setTimeout(this.bindIfMounted(()=>{this.toastMessage=null,this.update()}),5e3),this.formStatus===Ame&&setTimeout(this.bindIfMounted(()=>{this.setFormStatus(dv),this.update()}),5200)))}setFormStatus(e){this.formStatus=e,this.toastMessage=null,this.formErrors=[],this.update()}onEmailSent(){this.formStatus=wQ,this.emailDisabled=null,this.update(),setTimeout(this.bindIfMounted(()=>{this.formStatus=dv,this.update()}),5e3),setTimeout(this.bindIfMounted(()=>{this.formStatus=dv,this.update()}),5200)}onEmailSendingFailed(){this.formErrors=[this.controller.getSomethingWentWrongText()],this.emailDisabled=null,this.update()}sendChangeEmail(){this.emailDisabled=!0,this.update(),this.controller.userController.initiateEmailChange({lang:this.controller.getLanguage()}).then(this.bindIfMounted(this.onEmailSent),this.bindIfMounted(this.onEmailSendingFailed))}};var{If:sL,Input:hN,Switch:Vme,SwitchUnion:Lme}=rt.Components,pN=0,vQ=1,uN=2,lL=class extends rt.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.deleteAccount=pN}template(){return rt.createElement("div",{class:rt.const("dcg-shared-profile-info dcg-shared-account-settings-section")},rt.createElement(Vme,{key:()=>this.deleteAccount},e=>{switch(e){case pN:return rt.createElement("div",null,rt.createElement("div",{class:rt.const("dcg-shared-email-form-container")},rt.createElement(gN,{controller:this.props.controller})),rt.createElement(aL,{controller:this.props.controller}),rt.createElement("button",{class:rt.const("dcg-gray-link dcg-shared-delete-link"),onTap:()=>this.confirmDeletion()},()=>this.i18n.s("shared-button-delete-account-question")));case vQ:return rt.createElement(nL,{hideForm:()=>this.setDeleteAccount(pN),submitForm:()=>this.setDeleteAccount(uN),controller:this.props.controller});case uN:return rt.createElement("div",{"aria-live":rt.const("assertive"),"aria-atomic":rt.const("true"),class:rt.const("dcg-shared-confirmation-message-container")},rt.createElement("div",{class:rt.const("dcg-shared-confirmation-message")},rt.createElement("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0}),"aria-hidden":rt.const("true")}),()=>this.i18n.s("shared-message-email-sent")),rt.createElement("div",null,()=>this.i18n.s("shared-message-check-email-for-delete-link",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})))}}))}setDeleteAccount(e){this.deleteAccount=e,e===uN&&setTimeout(()=>{this.controller.userController.logout().then(()=>{this.controller.dispatch({type:"close-modal"})})},5e3),this._isMounted&&this.update()}confirmDeletion(){this.setDeleteAccount(vQ)}},gN=class extends rt.Class{init(){this.controller=this.props.controller(),this.saveNameFailed=!1;let e=this.controller.userController.getNameDetail();e.source=="legacy"?this.state={state:"legacy",name:e.given,previousName:e.given}:e.source=="parsed"?this.state={state:"name-detail",confirm:!0,given:e.given,family:e.family||"",previousGiven:"",previousFamily:""}:this.state={state:"name-detail",confirm:!1,given:e.given,family:e.family||"",previousGiven:e.given,previousFamily:e.family||""}}template(){return Lme("state",()=>this.state)({legacy:e=>rt.createElement(mN,{state:e,controller:this.props.controller,onSaveName:this.bindFn(this.onSaveName),saveNameFailed:()=>this.saveNameFailed,showSavedNotice:()=>this.showSavedNotice,updateState:t=>{this.state.state=="legacy"&&(this.state={...this.state,...t},this._isMounted&&this.update())}}),"name-detail":e=>rt.createElement(fN,{state:e,controller:this.props.controller,showSavedNotice:()=>this.showSavedNotice,onSaveName:this.bindFn(this.onSaveName),saveNameFailed:()=>this.saveNameFailed,updateState:t=>{this.state.state=="name-detail"&&(this.state={...this.state,...t},this._isMounted&&this.update())}})})}onSaveName(){switch(this.saveNameFailed=!1,this.state.state){case"legacy":this.controller.userController.setNameLegacy({name:this.state.name,lang:this.controller.getLanguage()}).then(this.bindIfMounted(this.onSaved)).catch(this.bindIfMounted(()=>{this.saveNameFailed=!0,this.update()}));break;case"name-detail":this.controller.userController.setNameDetail({given:this.state.given,family:this.state.family,lang:this.controller.getLanguage()}).then(this.bindIfMounted(this.onSaved)).catch(this.bindIfMounted(()=>{this.saveNameFailed=!0,this.update()}));break}}onSaved(){switch(this.state.state){case"legacy":this.state.previousName=this.state.name;break;case"name-detail":this.state.previousGiven=this.state.given,this.state.previousFamily=this.state.family,this.state.confirm=!1;break}this.showSavedNotice=!0,this.update(),setTimeout(this.bindIfMounted(()=>{this.showSavedNotice=!1,this.update()}),3e3)}},mN=class extends rt.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller}template(){return rt.createElement("form",{class:rt.const("dcg-shared-name-field"),onSubmit:this.bindFn(this.onSaveName)},rt.createElement("div",{class:rt.const("dcg-shared-profile-info-container")},rt.createElement("label",{class:rt.const("dcg-shared-profile-info-title"),for:rt.const("name")},()=>this.i18n.s("shared-label-name")),rt.createElement(hN,{type:rt.const("text"),name:rt.const("name"),class:rt.const("dcg-shared-input-blue-outline dcg-shared-profile-info-content"),didMount:this.bindFn(this.didMountName),onInput:this.bindFn(this.onNameInput),"aria-label":()=>this.i18n.s("shared-label-name"),value:()=>this.props.state().name,autocomplete:rt.const("off")})),rt.createElement("div",{class:rt.const("dcg-shared-modal-actions-container")},rt.createElement(cL,{showSavedNotice:this.props.showSavedNotice,i18n:this.props.controller}),rt.createElement("button",{type:rt.const("submit"),disabled:()=>this.nameFieldDisabled()?!0:void 0,class:()=>({"dcg-btn-blue":!0,"dcg-disabled":this.nameFieldDisabled()})},()=>this.i18n.s("shared-button-save"))),rt.createElement(sL,{predicate:()=>this.props.saveNameFailed()},()=>rt.createElement(ma,{controller:this.props.controller,errors:()=>[this.controller.getSomethingWentWrongText()]})))}onNameInput(e){this.props.updateState({name:e})}didMountName(e){Id||e.focus()}onSaveName(e){e.preventDefault(),!this.nameFieldDisabled()&&this.props.onSaveName()}nameFieldDisabled(){let e=this.props.state();return!e.name||e.name===e.previousName}},fN=class extends rt.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller}template(){return rt.createElement("form",{class:rt.const("dcg-shared-name-field"),onSubmit:this.bindFn(this.onSaveName)},rt.createElement("div",{class:()=>({"dcg-shared-confirm-name":this.props.state().confirm})},rt.createElement(sL,{predicate:()=>this.props.state().confirm},()=>rt.createElement("span",null,()=>this.i18n.s("shared-message-please-review-name"))),rt.createElement("div",{class:rt.const("dcg-shared-profile-info-container")},rt.createElement("div",{class:rt.const("dcg-shared-name-input")},rt.createElement("label",{class:rt.const("dcg-shared-profile-info-title"),for:rt.const("given-name")},()=>this.i18n.s("shared-label-given-name-or-nickname")),rt.createElement(hN,{type:rt.const("text"),name:rt.const("given-name"),id:rt.const("given-name"),class:rt.const("dcg-shared-input-blue-outline dcg-shared-profile-info-content"),didMount:this.bindFn(this.didMountName),onInput:e=>this.props.updateState({given:e}),"aria-label":()=>this.i18n.s("shared-label-given-name-or-nickname"),value:()=>this.props.state().given,autocomplete:rt.const("off")})),rt.createElement("div",{class:rt.const("dcg-shared-name-input")},rt.createElement("label",{class:rt.const("dcg-shared-profile-info-title"),for:rt.const("family-name")},()=>this.i18n.s("shared-label-family-name")),rt.createElement(hN,{type:rt.const("text"),name:rt.const("family-name"),id:rt.const("family-name"),class:rt.const("dcg-shared-input-blue-outline dcg-shared-profile-info-content"),onInput:e=>this.props.updateState({family:e}),"aria-label":()=>this.i18n.s("shared-label-family-name"),value:()=>this.props.state().family,autocomplete:rt.const("off")}))),rt.createElement("div",{class:rt.const("dcg-shared-modal-actions-container")},rt.createElement(cL,{i18n:this.props.controller,showSavedNotice:this.props.showSavedNotice}),rt.createElement("button",{type:rt.const("submit"),disabled:()=>this.canSubmit()?void 0:!0,class:()=>({"dcg-btn-blue":!0,"dcg-disabled":!this.canSubmit()})},()=>this.props.state().confirm?this.i18n.s("shared-button-confirm-name"):this.i18n.s("shared-button-save"))),rt.createElement(sL,{predicate:()=>this.props.saveNameFailed()},()=>rt.createElement(ma,{controller:this.props.controller,errors:()=>[this.controller.getSomethingWentWrongText()]}))))}didMountName(e){Id||e.focus()}onSaveName(e){e.preventDefault(),this.canSubmit()&&this.props.onSaveName()}canSubmit(){let e=this.props.state();return e.given?e.confirm?!0:!(e.given===e.previousGiven&&e.family===e.previousFamily):!1}},cL=class extends rt.Class{template(){return rt.createElement(sL,{predicate:()=>this.props.showSavedNotice()},()=>rt.createElement("span",{"aria-live":rt.const("assertive"),"aria-atomic":rt.const("true"),class:rt.const("dcg-shared-confirmation-message")},rt.createElement("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0}),"aria-hidden":rt.const("true")}),()=>this.props.i18n().s("shared-message-information-saved")))}};var Ao=__dcg_shared_module_exports__['e'](te());var{If:CQ}=Ao.Components,Pme=0,bN=1,EQ=2,dL=class extends Ao.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.mode=bN,this.formErrors=[]}template(){return Ao.createElement("div",{class:Ao.const("dcg-shared-change-password dcg-shared-account-settings-section")},Ao.createElement(CQ,{predicate:()=>this.mode===bN},()=>Ao.createElement("div",{class:Ao.const("dcg-shared-reset-by-email")},Ao.createElement("div",{class:Ao.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-message-change-password-email-sent",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})),Ao.createElement(ma,{controller:this.props.controller,errors:()=>this.formErrors}),Ao.createElement("div",{class:Ao.const("dcg-shared-modal-actions-container")},Ao.createElement("div",{role:Ao.const("button"),"aria-disabled":()=>this.emailDisabled,tabindex:()=>this.emailDisabled?"-1":"0",class:()=>({"dcg-btn-blue":!0,"dcg-disabled":this.emailDisabled}),onTap:()=>this.sendResetPasswordEmail()},()=>this.i18n.s("shared-button-send-email"))))),Ao.createElement(CQ,{predicate:()=>this.mode===EQ},()=>Ao.createElement("div",{"aria-live":Ao.const("assertive"),"aria-atomic":Ao.const("true"),class:Ao.const("dcg-shared-confirmation-message-container")},Ao.createElement("div",{class:Ao.const("dcg-shared-confirmation-message")},Ao.createElement("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0}),"aria-hidden":Ao.const("true")}),()=>this.i18n.s("shared-message-email-sent")),Ao.createElement("div",null,()=>this.i18n.s("shared-message-check-email-for-password-link",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})))))}onEmailSent(){this.mode=EQ,setTimeout(this.bindIfMounted(()=>{this.mode=Pme,this.update()}),5e3),setTimeout(this.bindIfMounted(()=>{this.mode=bN,this.update()}),5200)}onEmailSendingFailed(){this.formErrors=[this.controller.getSomethingWentWrongText()],this.update()}sendResetPasswordEmail(){this.controller.userController.recoverPassword({email:this.controller.userController.getEmail(),lang:this.controller.getLanguage()}).then(this.bindIfMounted(this.onEmailSent),this.bindIfMounted(this.onEmailSendingFailed))}};qt();var{For:_me,Switch:Ome}=kn.Components,pL="profile-info",yN="change-password",uL=class extends kn.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.settingsView=this.props.initialTab&&this.props.initialTab()||pL,this.breakPoint=660,this.measureWindow()}template(){return kn.createElement(Qo,{title:()=>this.i18n.s("shared-title-account-settings"),size:this.const("wide"),showX:this.const(!0),leftAlignTitle:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},kn.createElement("div",{class:kn.const("dcg-shared-account-settings-dialog dcg-shared-account-dialog")},kn.createElement(_me,{each:()=>this.getTabs(),key:e=>""+e.key},kn.createElement("div",{class:kn.const("dcg-shared-navigation-tabs"),role:kn.const("tablist")},e=>kn.createElement("div",{role:kn.const("tab"),tabindex:kn.const("0"),"aria-selected":()=>this.settingsView===e.key,class:()=>({"dcg-shared-tab-gray-underline":!0,[e.class]:!0,"dcg-selected":this.settingsView===e.key}),onTap:()=>this.updateSettingsView(e.key)},e.label))),kn.createElement("div",{class:kn.const("dcg-shared-content-container")},kn.createElement(Ome,{key:()=>this.settingsView},e=>e===pL?kn.createElement(lL,{controller:this.props.controller}):e===yN?kn.createElement(dL,{controller:this.props.controller}):this.props.extraTabs?kn.createElement("div",{class:kn.const("dcg-shared-profile-info dcg-shared-account-settings-section")},this.props.extraTabs().createView(e)):kn.createElement("span",null)))))}getTabs(){let e=[{key:pL,label:this.bindFn(this.profileTitle),class:"profile-view-button"},{key:yN,label:this.bindFn(this.passwordTitle),class:"change-password-view-button"}];return this.props.extraTabs?[...e,...this.props.extraTabs().tabs.map(({key:t,narrowLabel:i,wideLabel:o,class:n})=>({key:t,label:()=>this.windowWidth>this.breakPoint?i():o(),class:`${n}-button`}))]:e}updateSettingsView(e){this.settingsView=e,this._isMounted&&this.update()}profileTitle(){return this.windowWidth>this.breakPoint?this.i18n.s("shared-title-profile-information-wide"):this.i18n.s("shared-title-profile-information-narrow")}passwordTitle(){return this.windowWidth>this.breakPoint?this.i18n.s("shared-title-change-password-wide"):this.i18n.s("shared-title-change-password-narrow")}measureWindow(){return this.windowWidth=ie(window).width()}didMount(){ie(window).on("resize.account-dialog",__dcg_shared_module_exports__['z'](()=>{this.measureWindow(),this._isMounted&&this.update()},200))}didUnmount(){ie(window).off("resize.account-dialog")}isProfileSelected(){return this.settingsView===pL}isChangePasswordSelected(){return this.settingsView===yN}};var Ei=__dcg_shared_module_exports__['e'](te());var{Input:SQ}=Ei.Components,hL=class extends Ei.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.formErrors=[]}template(){return Ei.createElement(Qo,{title:()=>this.i18n.s("shared-title-change-email-address"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},Ei.createElement("div",{class:Ei.const("dcg-shared-change-email dcg-shared-account-dialog")},Ei.createElement("div",{class:Ei.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-message-set-new-email-address")),Ei.createElement("form",{onSubmit:this.bindFn(this.onSubmit),method:Ei.const("post"),class:Ei.const("dcg-shared-email-form-container")},Ei.createElement("label",null,Ei.createElement("span",{class:Ei.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-new-email-address")),Ei.createElement(SQ,{type:Ei.const("email"),pattern:this.const(xd),name:Ei.const("newEmail"),class:Ei.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-new-email-address"),required:Ei.const("true"),didMount:e=>{Id||e.focus()},value:()=>this.newEmail,onInput:e=>{this.newEmail=e,this._isMounted&&this.update()}})),Ei.createElement("label",{for:Ei.const("password")},Ei.createElement("span",null,()=>this.i18n.s("shared-label-password")),Ei.createElement(SQ,{type:Ei.const("password"),class:Ei.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-password"),required:Ei.const("true"),value:()=>this.password,name:this.const("password"),onInput:e=>{if(this.password=e,this._isMounted)return this.update()}})),Ei.createElement(ma,{controller:this.props.controller,errors:()=>this.formErrors}),Ei.createElement("div",{class:Ei.const("dcg-shared-sign-in-options")},Ei.createElement("button",{class:()=>({"dcg-btn-blue":!0,"dcg-disabled":!this.submitEnabled()}),"aria-disabled":()=>!this.submitEnabled(),tabindex:()=>this.submitEnabled()?"0":"-1",type:Ei.const("submit")},()=>this.i18n.s("shared-button-change-email-and-password"))))))}submitEnabled(){return!!(this.password&&this.newEmail)}async onSubmit(e){if(e.preventDefault(),this.submitEnabled())try{await this.controller.userController.setEmail({changeToken:this.getChangeToken(),password:this.password,newEmail:this.newEmail,lang:this.controller.getLanguage()}),this.controller.dispatch({type:"close-modal"}),history.replaceState(null,null,document.location.pathname)}catch(t){if(!this._isMounted)return;t.status===409?this.formErrors=["Sorry, someone has already registered with this email address."]:this.formErrors=[this.controller.getSomethingWentWrongText()],this.update()}}getChangeToken(){return this.controller.userController.getEmailChangeToken()||""}};var gL=class{constructor(e,t){var i=new ih;for(var o in t)i.config.setProperty(o,t[o]);this.controller=new cb(i);var n=new Gm(e);this.controller.setEvaluator(n),n.readEvaluatorConfig=()=>({product:this.controller.getGraphSettings().config.product,beta3d:t.beta3d,evaluationMode:this.controller.isGeometry()?"geometry":"graphing",globalRandomSeed:i.randomSeed,degreeMode:i.degreeMode,restrictedFunctions:i.config.restrictedFunctions,distributions:i.config.distributions,pointsOfInterest:i.config.pointsOfInterest,plotSingleVariableImplicitEquations:i.config.plotSingleVariableImplicitEquations,plotImplicits:i.config.plotImplicits,plotInequalities:i.config.plotInequalities,sliders:i.config.sliders,actions:i.config.actions}),n.onEvaluatorResults=s=>{this.controller.dispatch({type:"on-evaluator-changes",changes:s.evaluationStates,timingData:s.timingData,eventUpdates:s.eventUpdates})};var a=new Yr;a.setProperties({pixelCoordinates:{top:0,bottom:0,left:0,right:0,width:0,height:0},mathCoordinates:{top:0,bottom:0,left:0,right:0,width:0,height:0}}),this.graphpaperBounds=a,this.evaluator=n,this.setBlank()}setBlank(e){this.controller.dispatch({type:"set-blank",opts:e})}tick(){this.evaluator.tick()}destroy(){this.evaluator.destroy()}};var pv=class{constructor(e){this._calc=new gL(Jw,QA({...e})),this.controller=this._calc.controller,this._sharedClockBusToken=Il(()=>{this._calc.tick()})}destroy(){this._calc.destroy(),Al(this._sharedClockBusToken);function e(n){__dcg_shared_module_exports__['M'].warn("You've destroyed this API instance. You can no longer call ."+n+"()")}for(var t={},i=this;i;)Object.getOwnPropertyNames(i).forEach(a=>t[a]=!0),i=Object.getPrototypeOf(i);for(var o in t)typeof this[o]=="function"?this[o]=e.bind(this,o):this.hasOwnProperty(o)&&delete this[o];this.destroy=function(){}}setExpression(e){var t=this.controller,i=t.getItemModel(e.id),o=i&&i.type,n=WA(e,o,this.controller);if(n)if(o)this.controller.dispatch({type:"set-expression-properties-from-api",id:n.id,properties:n});else{if(n.type==="image")return;this.controller.dispatch({type:"add-item-to-end-from-api",state:n})}}setExpressions(e){e.forEach(this.setExpression.bind(this))}removeExpression(e){var t=e.id.toString();this.controller.dispatch({type:"remove-item-by-id",id:t})}removeExpressions(e){e.forEach(this.removeExpression.bind(this))}getState(e){return this.controller.getState(e)}getExpressions(){var e=this.getState({stripDefaults:!1}).expressions.list;return e.map(HA)}setBlank(e){this.controller.dispatch({type:"set-blank",opts:e||{}})}setState(e,t){this.controller.dispatch({type:"set-state",state:e,opts:t||{}})}HelperExpression(e){var t=e&&e.latex||"",i=new Yr;return i.latex=t,this.controller.dispatch({type:"add-helper-expression",state:{type:"helper-expression",id:this.controller.generateId(),latex:t,proxy:i}}),i}resize(){}};var yv=__dcg_shared_module_exports__['e'](te());var Tb=class{constructor(e){if(this.rootElt=e,this.eventModel=new Yr,!e)throw new Error("must pass an HTMLElement to the API")}setupDomChangeDetector(e){this.autoSize=e,SI(this.rootElt),this.domChangeDetector=new Cb(this.rootElt,t=>{switch(t.type){case"added":this.view=this.onCreateView(),this.onResizeView(t.size);break;case"removed":this.onDestroyView(),this.view=void 0;break;case"resized":this.onResizeView(t.size);break}}),this.autoSize!==!1?this.domChangeDetector.startWatching():this.domChangeDetector.checkForChanges()}detach(){__dcg_shared_module_exports__['M'].warn(".detach() is deprecated. It should no longer be necessary")}destroy(){this.view&&this.onDestroyView(),this.domChangeDetector.destroy();function e(n){__dcg_shared_module_exports__['M'].warn("You've destroyed this API instance. You can no longer call ."+n+"()")}for(var t={},i=this;i;)Object.getOwnPropertyNames(i).forEach(a=>t[a]=!0),i=Object.getPrototypeOf(i);for(var o in t)typeof this[o]=="function"?this[o]=e.bind(this,o):this.hasOwnProperty(o)&&delete this[o];this.destroy=function(){}}resize(){this.domChangeDetector.checkForChanges()}updateView(){this.view&&document.body&&document.body.contains(this.rootElt)&&this.view.update()}triggerEvent(e,t){this.eventModel.triggerEvent(e,t)}observeEvent(e,t){this.eventModel.observeEvent(e,t)}unobserveEvent(e){this.eventModel.unobserveEvent(e)}};var w0=class{constructor({evaluationMode:e,additionalFunctions:t,functionDefinition:i,replaceRoundWithReciprocal:o,workerPool:n}){this._evaluations={};this._nextObjectId=0;this.store=new Qd({expressions:{1:{id:"1",latex:"",braille:"",type:"latex",displayAsFraction:!1}},order:["1"],settings:{degreeMode:!1},ui:{focus:void 0}});this.evaluationMode=e,this.additionalFunctions=t,this.functionDefinition=i,this.replaceRoundWithReciprocal=o,this.workerPool=n,this._setupEvaluator(),this.clear(),this._sharedClockBusToken=Il(()=>{this._evaluator.tick()})}isSingleExpression(){return this.evaluationMode==="singleExpressionScientific"||this.evaluationMode==="singleExpressionFourFunction"}destroy(){Al(this._sharedClockBusToken)}generateObjectId(){return(this._nextObjectId++).toString()}updateNextObjectId(){let e=this.store.getState().order;this._nextObjectId=0;let t=/^[0-9]+$/;for(let i of e)if(t.test(i)){let o=parseInt(i,10);o>=this._nextObjectId&&(this._nextObjectId=o+1)}}clearShouldDebounceUndoRedo(){this._shouldDebounceUndoRedo=!1}markShouldDebounceUndoRedo(){this._shouldDebounceUndoRedo=!0}getShouldDebounceUndoRedo(){return this._shouldDebounceUndoRedo}clearCachedBrailleValues(){for(let e of this.getExpressionOrder())this.store.set(["expressions",e,"braille"],"")}getState(){return this.store.getState()}getPersistedState(){let{expressions:e,order:t,settings:i}=this.getState();return{expressions:{list:t.map(o=>{var n=e[o];return{id:n.id,latex:n.latex,displayAsFraction:n.displayAsFraction}})},settings:i}}setState(e){this.store.set(e),this._updateIndexes(),this.updateNextObjectId()}setStateFromAPI(e){let t=[],i={};e.expressions.list.forEach(o=>{t.push(o.id),i[o.id]={id:o.id,latex:o.latex,braille:"",type:"latex",displayAsFraction:!!o.displayAsFraction}}),this.setState({expressions:i,order:t,settings:e.settings,ui:{focus:void 0}})}canClear(){if(this.getNumberOfExpressions()>1)return!0;let e=this.getExpressionOrder()[0];return this.getExpressionLatex(e)!==""}clear(){this.setState({expressions:{1:{id:"1",type:"latex",latex:"",braille:"",displayAsFraction:!1}},ui:{focus:void 0},order:["1"],settings:this.getState().settings})}getExpressionOrder(){return this.store.getState().order}getNumberOfExpressions(){return this.getExpressionOrder().length}getExpressionById(e){return this.getState().expressions[e]}getExpressionIndex(e){return this._indexes[e]}_getExpressionByIndex(e){let t=this.getExpressionOrder()[e];return this.getExpressionById(t)}_updateIndexes(){this._indexes={};let e=0;for(let t of this.getExpressionOrder())this._indexes[t]=e,e+=1;this._evaluate()}_usesAnsById(e){return this.getExpressionById(e).latex.indexOf("\\operatorname{ans}")!==-1}_getPreviousExpById(e){let t=this.getExpressionIndex(e);return this._getExpressionByIndex(t-1)}createBlankAfterId(e){if(this.isSingleExpression()||!this.getExpressionById(e).latex)return;let t=this.getExpressionIndex(e),i=this.generateObjectId();this.store.shallowMutate("order",o=>{o.splice(t+1,0,i)}),this.store.shallowMutate("expressions",o=>{o[i]={id:i,latex:"",braille:"",type:"latex",displayAsFraction:!1}}),this._updateIndexes(),this.setFocusedById(i,!0)}conditionallyCopyPrevious(e){let t=this._getPreviousExpById(e),i=this.getExpressionById(e);t!=null&&i.latex===""&&this._usesAnsById(t.id)&&this.setLatexById(e,t.latex)}backspaceAtFrontOfId(e){if(this.getExpressionById(e).latex!==""||this.getNumberOfExpressions()===1)return;let i=this.getExpressionIndex(e);this.store.shallowMutate("order",o=>{o.splice(i,1)}),this.store.shallowMutate("expressions",o=>{delete o[e]}),this._updateIndexes(),this._setFocusedByIndex(Math.max(i-1,0),!0)}setLatexById(e,t){this.store.set(["expressions",e,"latex"],t),this.store.set(["expressions",e,"braille"],""),t===""&&this.setFractionEvaluation(e,!1),this._evaluate()}setLatexAndBrailleById(e,t,i){this.store.set(["expressions",e,"latex"],t),this.store.set(["expressions",e,"braille"],i),t===""&&this.setFractionEvaluation(e,!1),this._evaluate()}setFractionEvaluation(e,t){this.store.set(["expressions",e,"displayAsFraction"],t)}setLatexOfFocusedExpression(e){let t=this.getFocusedExpressionId();t&&this.setLatexById(t,e)}isExpressionFocused(e){return this.getFocusedExpressionId()===e}getExpressionLatex(e){return this.getExpressionById(e).latex}getExpressionError(e){let t=this._evaluations[e];return t?t.error:""}getExpressionValue(e){let t=this._evaluations[e];if(t)return t.value}getExpressionAns(e){let t=this._evaluations[e];if(t)return t.ans}getExpressionAnsId(e){let t=this._evaluations[e];if(t)return t.ansId}shouldShowEvaluationForExpression(e){let t=this._evaluations[e];return t?t.showEvaluation:!1}isRationalizableConstant(e){let t=this._evaluations[e];return t?t.isRationalizableConstant:!1}canDisplayEvaluationAsFraction(e){let t=this.getExpressionValue(e);return t?__dcg_shared_module_exports__['qb'](t):!1}_setFocusedByIndex(e,t){let i=this._getExpressionByIndex(e),o=this.store.getState().ui.focus,n=t?{type:"latex-expression",id:i.id}:void 0;if(!__dcg_shared_module_exports__['E'](o,n)){if(o){let a=o.id;this.store.deepMutate("expressions",s=>{var l=s[a];l&&(l.braille="")})}!t&&this.getFocusedExpressionId()!==i.id||this.store.shallowMutate("ui",a=>{a.focus=n})}}setFocusedById(e,t){let i=this.getExpressionIndex(e);this._setFocusedByIndex(i,t)}focusPrevById(e){let t=this.getExpressionIndex(e)-1;t>=0&&this._setFocusedByIndex(t,!0)}focusNextById(e){let t=this.getExpressionIndex(e)+1;t<this.getNumberOfExpressions()?this._setFocusedByIndex(t,!0):this.createAtEnd()}getFocusedExpression(){let e=this.getFocusedExpressionId();if(e)return this.getExpressionById(e)}getFocusedExpressionId(){let e=this.getState().ui.focus;return e&&e.id}clearFocusedExpression(){let e=this.getFocusedExpression();e&&this.setLatexById(e.id,"")}shouldShowClear(){if(this.getNumberOfExpressions()===1)return!1;let e=this.getFocusedExpression();return!!e&&!!e.latex}getLastExpression(){return this._getExpressionByIndex(this.getNumberOfExpressions()-1)}isLastExpressionEmpty(){return!!this.getLastExpression().latex}createAtEnd(){this.createBlankAfterId(this.getLastExpression().id)}focusLastExpression(){this._setFocusedByIndex(this.getNumberOfExpressions()-1,!0)}focusFirstExpression(){this._setFocusedByIndex(0,!0)}getDegreeMode(){return this.getState().settings.degreeMode}setDegreeMode(e){this.store.set(["settings","degreeMode"],!!e),this._evaluate()}_cleanupLatex(e){return e=__dcg_shared_module_exports__['xb'](e),e.substr(e.length-1)==="="&&(e=e.substr(0,e.length-1)),e}_evaluate(){this._evaluator.clearStatementsAndStartCompleteState(),this.getExpressionOrder().forEach(e=>this._evaluator.addStatement({id:e,index:this.getExpressionIndex(e),latex:this._cleanupLatex(this.getExpressionLatex(e)),shouldGraph:!1,type:"statement"}))}_setupEvaluator(){this._evaluator=new Gm(this.workerPool),this._evaluator.readEvaluatorConfig=()=>({degreeMode:this.getDegreeMode(),evaluationMode:this.evaluationMode,additionalFunctions:this.additionalFunctions,functionDefinition:this.functionDefinition,replaceRoundWithReciprocal:this.replaceRoundWithReciprocal,actions:!1}),this._evaluator.onEvaluatorResults=e=>{let t=e.evaluationStates;this._evaluations={};for(let n in t){let a=t[n];if(!this.getExpressionById(n))continue;let l=a.constant_value;l===void 0&&a.zero_values&&a.zero_values.length&&(l=a.zero_values[0].val);let c=a.hasOwnProperty("constant_value")&&__dcg_shared_module_exports__['qb'](a.constant_value),d=!a.is_evaluable&&c,p=!!a.is_evaluable||d||Array.isArray(l);this._evaluations[n]={error:a.error,ans:void 0,ansId:void 0,value:l,showEvaluation:p,isRationalizableConstant:d}}let i,o;for(let n of this.getExpressionOrder()){let a=this._evaluations[n];if(i&&a){let s=i.value;typeof s=="number"?(a.ans=s,a.ansId=o):Array.isArray(s)&&(a.ans="[...]")}i=a,o=n}typeof this.onEvaluationUpdate=="function"&&this.onEvaluationUpdate()}}reloadState(){this.setState(this.getState())}getFunctionDefinition(){return!!this.functionDefinition}enableFunctionDefinition(){this.functionDefinition=!0,this.reloadState()}disableFunctionDefinition(){this.functionDefinition=!1,this.reloadState()}getReplaceRoundWithReciprocal(){return!!this.replaceRoundWithReciprocal}enableReplaceRoundWithReciprocal(){this.replaceRoundWithReciprocal=!0,this.reloadState()}disableReplaceRoundWithReciprocal(){this.replaceRoundWithReciprocal=!1,this.reloadState()}};as();var v0=class{constructor(e,t){this.keyboardMode="main";this.fontSize=16;this.invertedColors=!1;this.backgroundColor="";this.textColor="";this.projectorMode=!1;this.capExpressionSize=!1;this.decimalToFraction=!0;this.settingsMenu=!0;this.settingsMenuOpen=!1;this.language="en";this.brailleMode="none";this.sixKeyInput=!1;this.brailleControls=!0;this.brailleExpressionDownload=!0;this.replaceCommaWith10Exp=!1;this.typingAsteriskWritesTimesSymbol=!1;this.stateStack=new vh;this.dispatcher=new iu;this.s=uc(()=>this.language);this.dispatch=e=>{nf("dispatch",{type:e.type}),this.dispatcher.dispatch(e);let t;for(;t=this._queuedCallbacks.shift();)t()};this._queuedCallbacks=[];this.stateStack=new vh,this.dispatcher=new iu,this.options=e,this.model=new w0({evaluationMode:this.options.evaluationMode,additionalFunctions:this.options.additionalFunctions,functionDefinition:this.options.functionDefinition,replaceRoundWithReciprocal:this.options.replaceRoundWithReciprocal,workerPool:t.workerPool}),this.model=this.model,this.model.setDegreeMode(e.degreeMode),this.setLanguage(e.language),this.setBrailleMode(e.brailleMode),this.setSixKeyInput(e.sixKeyInput),this.setBrailleControls(e.brailleControls),this.setBrailleExpressionDownload(e.brailleExpressionDownload),this.setReplaceCommaWith10Exp(e.replaceCommaWith10Exp),this.setReplaceRoundWithReciprocal(e.replaceRoundWithReciprocal),this.setTypingAsteriskWritesTimesSymbol(e.typingAsteriskWritesTimesSymbol),this.setProjectorMode(e.projectorMode),this.setCapExpressionSize(e.capExpressionSize),this.setDecimalToFraction(e.decimalToFraction),this.invertedColors=e.invertedColors,this.backgroundColor=e.backgroundColor,this.textColor=e.textColor,this.settingsMenu=e.settingsMenu,this.model.onEvaluationUpdate=()=>this.dispatch({type:"render"}),this.settingsProxy=t.settingsProxy,this.syncPublicSettings(),this.hookUpDispatcher(),this.containerSize={width:0,height:0}}runAfterDispatch(e){this._queuedCallbacks.push(e)}enqueueEvent(e){this.runAfterDispatch(()=>{this.onEventEmitted&&this.onEventEmitted(e)})}getFunctionDefinition(){return this.options.functionDefinition}getSettingsMenu(){return this.settingsMenu}getBrailleMode(){return this.brailleMode}renderAsBraille(){return this.brailleMode!=="none"}setBrailleMode(e){this.brailleMode=e}getSixKeyInput(){return this.sixKeyInput}setSixKeyInput(e){this.sixKeyInput=e}getBrailleControls(){return this.brailleControls}setBrailleControls(e){this.brailleControls=e}getBrailleExpressionDownload(){return this.brailleExpressionDownload}setBrailleExpressionDownload(e){this.brailleExpressionDownload=e}getRestrictedEditing(){return this.options.restrictedEditing}getKeyboardMode(){return this.keyboardMode}getFontSize(){return this.fontSize}getInvertedColors(){return this.invertedColors}hasBackgroundColor(){return this.getBackgroundColor()!=="#ffffff"}getBackgroundColor(){let e=__dcg_shared_module_exports__['N'](this.backgroundColor||"#fff");return this.getInvertedColors()&&e!=="#ffffff"?__dcg_shared_module_exports__['R'](e):e}getTextColor(){let e=__dcg_shared_module_exports__['N'](this.textColor||"#000");return this.getInvertedColors()&&e!=="#000000"?__dcg_shared_module_exports__['R'](e):e}getAdditionalFunctions(){return this.options.additionalFunctions}getTypingSlashWritesDivisionSymbol(){return this.options.typingSlashWritesDivisionSymbol}setTypingAsteriskWritesTimesSymbol(e){this.typingAsteriskWritesTimesSymbol=e}getTypingAsteriskWritesTimesSymbol(){return this.typingAsteriskWritesTimesSymbol}setProjectorMode(e){this.projectorMode=e}isProjectorMode(){return this.projectorMode}getReplaceCommaWith10Exp(){return this.replaceCommaWith10Exp}setReplaceCommaWith10Exp(e){this.replaceCommaWith10Exp=e}getReplaceRoundWithReciprocal(){return this.model.getReplaceRoundWithReciprocal()}setReplaceRoundWithReciprocal(e){e?this.model.enableReplaceRoundWithReciprocal():this.model.disableReplaceRoundWithReciprocal()}setCapExpressionSize(e){this.capExpressionSize=e}getCapExpressionSize(){return this.capExpressionSize}setDecimalToFraction(e){this.decimalToFraction=e}setLanguage(e){e!=="en"&&!hk(e)?__dcg_shared_module_exports__['M'].warn(`Translation for '${e}' isn't currently available. Using '${this.language}' instead.`):this.language=e}getLanguage(){return this.language}getDecimalToFraction(){return this.decimalToFraction}isScientificCalc(){let e=this.options.evaluationMode;return e==="scientific"||e==="singleExpressionScientific"}isFourFunctionCalc(){return this.options.evaluationMode==="fourFunction"||this.options.evaluationMode==="singleExpressionFourFunction"}getAllowLinks(){return this.options.links}canUndo(){return this.stateStack.canUndo()}canRedo(){return this.stateStack.canRedo()}undo(e){if(!this.canUndo())return;this.stateStack.undo();let t=this.stateStack.getState();e.restoreFocus||(t={...t,ui:{focus:void 0}}),this.model.setState(t),this.enqueueEvent("change")}redo(e){if(!this.canRedo())return;this.stateStack.redo();let t=this.stateStack.getState();e.restoreFocus||(t={...t,ui:{focus:void 0}}),this.model.setState(t),this.enqueueEvent("change")}clearHistory(){this.stateStack.clear()}canBackspace(){let e=this.model.getFocusedExpression();return e&&(e.latex.length>0||this.model.getNumberOfExpressions()>1)}focusLastExpression(){this.model.focusLastExpression()}shouldRender(){return this.containerSize.width>0&&this.containerSize.height>0}canClear(){return this.model.canClear()}shouldShowClear(){return this.model.shouldShowClear()}enableSettingsMenu(){this.settingsMenu=!0}disableSettingsMenu(){this.closeSettingsMenu(),this.settingsMenu=!1}closeSettingsMenu(){this.settingsMenuOpen=!1}toggleSettingsMenu(){this.settingsMenuOpen=!this.settingsMenuOpen}isSettingsMenuOpen(){return this.settingsMenuOpen}isLastExpressionEmpty(){return this.model.isLastExpressionEmpty()}createAtEnd(){this.model.createAtEnd()}clearFocusedExpression(){this.model.clearFocusedExpression()}setLatexById(e,t){this.model.setLatexById(e,t)}setLatexAndBrailleById(e,t,i){this.model.setLatexAndBrailleById(e,t,i)}setLatexOfFocusedExpression(e){this.model.setLatexOfFocusedExpression(e)}toggleFractionEvaluationById(e){this.model.setFractionEvaluation(e,!this.model.getExpressionById(e).displayAsFraction)}conditionallyCopyPrevious(e){this.model.conditionallyCopyPrevious(e)}createBlankAfterId(e){this.model.createBlankAfterId(e)}backspaceAtFrontOfId(e){this.model.backspaceAtFrontOfId(e)}areStatesDifferentEnoughForUndoRedo(e,t){let i={focus:void 0};return __dcg_shared_module_exports__['E']({...e,ui:i},{...t,ui:i})}commitUndoRedoDebounced(){let e=this.model.getState(),t=this.stateStack.getState();if(this.areStatesDifferentEnoughForUndoRedo(e,t))return;let i=new Date().getTime();i-this._lastDebouncedTime<1e3?this.stateStack.replaceState(e):this.stateStack.addState(e),this._lastDebouncedTime=i,this.enqueueEvent("change")}commitUndoRedoSynchronously(){let e=this.model.getState(),t=this.stateStack.getState();this.areStatesDifferentEnoughForUndoRedo(e,t)||(this._lastDebouncedTime=0,this.stateStack.addState(e),this.enqueueEvent("change"))}updateKeyboardMode(e){this.keyboardMode=e}getFocusedMathquill(){if(this.model.getFocusedExpressionId())return Ze.getFocusedMathquill()}ensureMathquillIsFocusedAndReturnFocusedMathquill(){let e=this.getFocusedMathquill();return e||(this.isLastExpressionEmpty()&&!this.model.isSingleExpression()?this.createAtEnd():this.focusLastExpression(),this.onEventEmitted&&this.onEventEmitted("render"),this.getFocusedMathquill())}typeIntoFocusedMathquill(e){e=e.replace(/\r|\n/g,"");let t=this.ensureMathquillIsFocusedAndReturnFocusedMathquill();t&&Ze.canAcceptText(t,this.getCapExpressionSize(),e)&&(t.typedText(e),this.setLatexOfFocusedExpression(t.latex()),this.model.markShouldDebounceUndoRedo())}pressKeyInFocusedMathquill(e,t){if(this.getBrailleMode()!=="none")return;let i=this.ensureMathquillIsFocusedAndReturnFocusedMathquill();i&&(e==="Up"||e==="Down"||e==="Left"||e==="Right"?Ze.applyArrowKeyAndReturnIfWasAtBounds(i,e,t)&&this.moveFocusInDirection(e):e==="Enter"?(t&&(t.preventDefault(),t.stopPropagation()),this.handleEnter()):e==="Backspace"?this.attemptToMoveFocusWithBackspace()||(i.keystroke(e,t),this.setLatexOfFocusedExpression(i.latex())):e==="Delete"?(i.keystroke(e,t),this.setLatexOfFocusedExpression(i.latex())):(i.keystroke(e,t),this.setLatexOfFocusedExpression(i.latex())))}moveFocusInDirection(e){let t=this.model.getFocusedExpressionId();t&&(e==="Up"?this.model.focusPrevById(t):e==="Down"&&this.model.focusNextById(t))}handleEnter(){if(this.model.isSingleExpression())return;let e=this.model.getFocusedExpressionId();e&&(this.conditionallyCopyPrevious(e),this.createBlankAfterId(e))}attemptToMoveFocusWithBackspace(){let e=this.model.getFocusedExpression();if(!e)return!1;let{latex:t,id:i}=e;return t===""?(this.backspaceAtFrontOfId(i),!0):!1}executeCommandInFocusedMathquill(e){let t=this.ensureMathquillIsFocusedAndReturnFocusedMathquill();t&&(Xx(t,e,{capExpressionSize:this.getCapExpressionSize()}),this.setLatexOfFocusedExpression(t.latex()))}syncPublicSettings(){this.settingsProxy.setProperty("language",this.language),this.settingsProxy.setProperty("fontSize",this.fontSize),this.settingsProxy.setProperty("degreeMode",this.model.getDegreeMode()),this.settingsProxy.setProperty("invertedColors",this.invertedColors),this.settingsProxy.setProperty("backgroundColor",this.backgroundColor),this.settingsProxy.setProperty("textColor",this.textColor),this.settingsProxy.setProperty("brailleMode",this.brailleMode),this.settingsProxy.setProperty("sixKeyInput",this.sixKeyInput),this.settingsProxy.setProperty("brailleControls",this.brailleControls),this.settingsProxy.setProperty("brailleExpressionDownload",this.brailleExpressionDownload),this.settingsProxy.setProperty("projectorMode",this.projectorMode),this.settingsProxy.setProperty("capExpressionSize",this.capExpressionSize),this.settingsProxy.setProperty("decimalToFraction",this.decimalToFraction),this.settingsProxy.setProperty("qwertyKeyboard",this.options.qwertyKeyboard),this.settingsProxy.setProperty("links",this.options.links),this.settingsProxy.setProperty("settingsMenu",this.settingsMenu),this.settingsProxy.setProperty("functionDefinition",this.model.getFunctionDefinition()),this.settingsProxy.setProperty("replaceCommaWith10Exp",this.replaceCommaWith10Exp),this.settingsProxy.setProperty("replaceRoundWithReciprocal",this.model.getReplaceRoundWithReciprocal()),this.settingsProxy.setProperty("typingAsteriskWritesTimesSymbol",this.typingAsteriskWritesTimesSymbol)}hookUpDispatcher(){this.dispatcher.register(e=>{this.enqueueEvent("render");let t=!1,i=this.getRestrictedEditing();switch(e.type){case"update-options":{this.options={...this.options,...e.options};break}case"keypad/shift":{let s;switch(this.keyboardMode){case"qwerty":s="capitalQwerty";break;case"capitalQwerty":s="qwerty";break;case"letters":s="capitalLetters";break;case"capitalLetters":s="letters";break;default:s="qwerty"}this.updateKeyboardMode(s)}break;case"undo":i||(this.undo({restoreFocus:e.source==="keyboard-shortcut"}),t=!0);break;case"redo":i||(this.redo({restoreFocus:e.source==="keyboard-shortcut"}),t=!0);break;case"clear-history":this.clearHistory();break;case"set-state-from-api":e.opts.allowUndo||this.clearHistory(),this.model.setStateFromAPI(e.state);break;case"main":this.updateKeyboardMode("main");break;case"ABC":this.options.qwertyKeyboard?this.updateKeyboardMode("qwerty"):this.updateKeyboardMode("letters");break;case"functions":this.updateKeyboardMode("functions");break;case"degrees":this.model.setDegreeMode(!this.model.getDegreeMode());break;case"update-degree-mode":this.model.setDegreeMode(!!e.mode);break;case"update-font-size":var o=e.size;if(typeof o!="number"&&(o=parseInt(o,10)),isNaN(o))return;this.fontSize=o;break;case"update-inverted-colors":this.invertedColors=!!e.mode;break;case"update-background-color":this.backgroundColor=e.color;break;case"update-text-color":this.textColor=e.color;break;case"update-projector-mode":this.setProjectorMode(!!e.mode);break;case"update-cap-expression-size":this.setCapExpressionSize(!!e.mode);break;case"update-decimal-to-fraction":this.setDecimalToFraction(!!e.mode);break;case"update-language":this.setLanguage(e.language);break;case"set-blank":e.opts.allowUndo||this.clearHistory(),this.model.clear(),this.focusLastExpression();break;case"clear":this.model.clearFocusedExpression();break;case"set-braille-mode":let n=e.mode;n!=="nemeth"&&n!=="ueb"&&n!=="none"?__dcg_shared_module_exports__['M'].warn(`Valid Braille modes are 'nemeth', 'none', and 'ueb'. You passed '${n}'.`):(this.model.clearCachedBrailleValues(),this.setBrailleMode(e.mode));break;case"set-six-key-input":this.setSixKeyInput(!!e.useSixKeyInput);break;case"set-braille-controls":this.setBrailleControls(!!e.value);break;case"set-braille-expression-download":this.setBrailleExpressionDownload(!!e.mode);break;case"set-replace-comma-with-10-exp":this.setReplaceCommaWith10Exp(!!e.replace);break;case"set-replace-round-with-reciprocal":this.setReplaceRoundWithReciprocal(!!e.replace);break;case"set-typing-asterisk-writes-times-symbol":this.setTypingAsteriskWritesTimesSymbol(!!e.mode);break;case"update-latex":this.model.markShouldDebounceUndoRedo(),this.setLatexById(e.id,e.latex);break;case"update-latex-from-braille":this.model.markShouldDebounceUndoRedo(),this.setLatexAndBrailleById(e.id,e.latex,e.braille);break;case"focusin":this.model.setFocusedById(e.id,!0);break;case"focusout":this.model.setFocusedById(e.id,!1);break;case"focus-first-expression":this.model.focusFirstExpression();break;case"focus-prev-expression":this.moveFocusInDirection("Up");break;case"focus-next-expression":this.moveFocusInDirection("Down");break;case"focus-last-expression":this.model.focusLastExpression();break;case"insert-blank-expression":this.handleEnter();break;case"backspace-from-braille":this.attemptToMoveFocusWithBackspace();break;case"keypad/type-text":this.typeIntoFocusedMathquill(e.text);break;case"keypad/press-key":this.pressKeyInFocusedMathquill(e.key,e.evt);break;case"keypad/custom-command":this.executeCommandInFocusedMathquill(e.command);break;case"keypad/123":case"keypad/abc":case"keypad/audio-trace":break;case"enable-settings-menu":this.enableSettingsMenu();break;case"disable-settings-menu":this.disableSettingsMenu();break;case"toggle-settings-menu":this.toggleSettingsMenu();break;case"close-settings-menu":this.closeSettingsMenu();break;case"render":break;case"ui/container-resized":this.containerSize=e.size;break;case"toggle-fraction-evaluation":this.toggleFractionEvaluationById(e.id);break;default:return e}this.runAfterDispatch(()=>this.syncPublicSettings()),t||(this.model.getShouldDebounceUndoRedo()?(this.commitUndoRedoDebounced(),this.model.clearShouldDebounceUndoRedo()):this.commitUndoRedoSynchronously())})}getMathquillConfig(){let e=this.getAdditionalFunctions(),t=this.isFourFunctionCalc()&&(!e||e.indexOf("fraction")===-1);return{typingAsteriskWritesTimesSymbol:this.getTypingAsteriskWritesTimesSymbol(),typingSlashWritesDivisionSymbol:this.getTypingSlashWritesDivisionSymbol(),disableCopyPaste:this.getRestrictedEditing(),autoCommands:Hp({disallowFrac:t}),autoOperatorNames:Wp(),infixOperatorNames:wx()}}};var Hr=__dcg_shared_module_exports__['e'](te());var DQ=__dcg_shared_module_exports__['e'](te()),Nr=class extends DQ.Class{init(){this.controller=this.props.controller(),this.model=this.controller.model,this.dispatch=this.controller.dispatch,this.s=this.controller.s}};var No=__dcg_shared_module_exports__['e'](te());var Mb=__dcg_shared_module_exports__['e'](te());var Vc=class extends Nh{template(){return Mb.createElement("div",{class:Mb.const("dcg-keypad-control-bar dcg-do-not-blur"),role:Mb.const("group"),"aria-label":()=>this.controller.s("shared-calculator-narration-keypad-controlbar")},Mb.createElement("div",{class:Mb.const("dcg-keypad-control-bar-contents")},this.children))}};var uv=__dcg_shared_module_exports__['e'](te()),Ri=class extends uv.Class{template(){return uv.createElement("div",{class:()=>({"dcg-keypad-control-btn":!0,"dcg-disabled":this.isDisabled(),"dcg-selected":!this.isDisabled()&&this.isSelected(),"dcg-selectable-btn":!this.isDisabled()&&this.isSelectable(),"dcg-narrow-control-btn":this.props.narrowButton&&this.props.narrowButton()}),didMount:this.bindFn(this.didMount),role:uv.const("button"),"aria-disabled":()=>this.isDisabled()||void 0,"aria-label":()=>this.getAriaLabel(),"dcg-command":this.props.command,onTap:this.bindFn(this.handleTap),"aria-pressed":()=>!this.hasPopup()&&!this.isDisabled()&&this.isSelectable()?this.isSelected():void 0,"aria-expanded":()=>this.hasPopup()&&!this.isDisabled()?this.isSelected():void 0,tabindex:this.bindFn(this.getTabIndex)},this.children)}getTabIndex(){if(!this.isDisabled())return this.props.ignoreInTabOrder&&this.props.ignoreInTabOrder()?-1:0}handleTap(e){this.isDisabled()||this.props.onTap(e)}getAriaLabel(){return this.props.ariaLabel?this.props.ariaLabel():this.props.command()}hasPopup(){return this.props.ariaPopup?this.props.ariaPopup():!1}isDisabled(){return this.props.disabled?this.props.disabled():!1}isSelected(){return this.props.selected?this.props.selected():!1}isSelectable(){return this.props.selectable?this.props.selectable():!1}didMount(e){this.props.didMount&&this.props.didMount(e)}};var Ed=__dcg_shared_module_exports__['e'](te());var so=__dcg_shared_module_exports__['e'](te());qt();var Gu=__dcg_shared_module_exports__['e'](te());function Rme(){if(!oU)return!1;let r=navigator.userAgent.match(/Version\/(\d+)/);return!r||!r[1]?!1:parseFloat(r[1])<11}function kQ(){return!rU&&!Rme()&&typeof document.createElement("a").download!="undefined"}function mL(){return kQ()||navigator.msSaveBlob!==void 0}var Hh=class extends Gu.Class{init(){this.supportsDirectDownload=kQ()}template(){return Gu.createElement("a",{role:Gu.const("button"),tabindex:()=>this.props.enabled()?0:-1,"aria-disabled":()=>this.props.enabled()?void 0:!0,class:()=>{var e,t,i,o,n,a;return{"dcg-download-button":!0,"dcg-btn-primary":((t=(e=this.props).buttonType)==null?void 0:t.call(e))==="primary","dcg-btn-secondary":((o=(i=this.props).buttonType)==null?void 0:o.call(i))==="secondary","dcg-primary-link":((a=(n=this.props).buttonType)==null?void 0:a.call(n))==="link","dcg-disabled":!this.props.enabled()}},didMount:this.bindFn(this.didMountDownload),didUnmount:this.bindFn(this.didUnmountDownload),didUpdate:this.bindFn(this.didUpdate),download:()=>this.supportsDirectDownload?this.props.filename():void 0,onTap:e=>{var i,o;if((o=(i=this.props).triggerLogEvent)==null||o.call(i),this.supportsDirectDownload||!navigator.msSaveOrOpenBlob)return;let t=this.props.data();t&&(navigator.msSaveOrOpenBlob(t,this.props.filename()),e.preventDefault())}},Gu.createElement("i",{class:Gu.const("dcg-icon-download"),"aria-hidden":Gu.const("true")}),Gu.createElement("span",null,()=>this.props.text()))}didMountDownload(e){this.downloadLink=e,this.didUpdate()}didUnmountDownload(){this.revokeBlobURL()}didUpdate(){this.updateDownloadURL(),this.cachedObjectURL&&(this.downloadLink.href=this.cachedObjectURL)}updateDownloadURL(){if(this.revokeBlobURL(),!this.supportsDirectDownload)return;let e=this.props.data();e&&(this.cachedObjectURL=URL.createObjectURL(e))}revokeBlobURL(){this.cachedObjectURL&&URL.revokeObjectURL(this.cachedObjectURL)}};function ln(r,e,t=!1){if(t&&(r=r.replace(/ /g,"\\ ")),e==="none")return r;let i=e==="nemeth"?bh(r):yh(r);return i.isError?"":As.toBrailleAscii(i.value)}function GQ(r,e){if(e==="none")return"";let t=[];t.push(ln("Expression List",e,!0)),t.push(""),t.push("");let i="",o=r.getItemCount();for(let n=0;n<o;n++){let a=r.getItemModelByIndex(n);if(a&&!a.secret){i!==""&&a.type!=="folder"&&i!==a.folderId&&(t.push(C0(ln("End Folder",e,!0))),i="");let s="";switch(a.type){case"expression":if(!a.hidden){let c=MQ(a.displayIndex,e);s=a.latex;let d=[],p=a.formula;if(p&&!Hl(a)){if(r.shouldShowEvaluationForItem(a.id)){let g=p.zero_values&&p.zero_values.length?p.zero_values[0].val:p.constant_value;Array.isArray(g)?s+=`\\ ${g.length}\\ element\\ list`:s+=`=${g}`}else if(Rp(a))d.push(ln(`Min=${wC(a)}`,e,!1)),d.push(ln(`Max=${vC(a)}`,e,!1)),EC(a)&&CC(a)&&d.push(ln(`CDF=${nG(a)}`,e,!1));else if(eG(a)){let g=Iy(a);g&&(d.push(ln(`<${__dcg_shared_module_exports__['Pc'](g.lessThan,5)}`,e,!1)),d.push(ln(`>${__dcg_shared_module_exports__['Pc'](g.greaterThan,5)}`,e,!1)),d.push(ln(`\\ne${__dcg_shared_module_exports__['Pc'](g.notEqual,5)}`,e,!1)))}else if(p.is_regression&&p.regression){let g=p.regression,h=g.statistics,f=g.parameters;h.hasOwnProperty("Rsquared")&&d.push(ln(`R^2=${Gc(g,"Rsquared")}`,e,!1)),h.hasOwnProperty("rsquared")&&d.push(ln(`r^2=${Gc(g,"rsquared")}`,e,!1)),h.hasOwnProperty("r")&&d.push(ln(`r=${Gc(g,"r")}`,e,!1)),h.hasOwnProperty("RMSE")&&d.push(ln(`\\operatorname{RMSE}=${Gc(g,"RMSE")}`,e,!1));for(let y in f)d.push(ln(`${y}=${MI(g,y)}`,e,!1))}}t.push(`${c}  ${ln(s,e,!1)}`),t.push.apply(t,d)}break;case"text":t.push(ln(a.text,e,!0));break;case"folder":a.collapsed?s=`Collapsed Folder ${a.title}`:(s=`Start Folder ${a.title}`,i=a.id),t.push(C0(ln(s,e,!0)));break;case"image":t.push(ln("Image",e,!1));break;case"table":t.push(C0(ln("Start Table",e,!0)));for(let c=0;c<bc(a);c++){let d=[],p;for(let h=0;h<hx(a);h++)c===0?p=a.columnModels[h].latex||"":p=AC(a,c-1,h),d.push(ln(p,e));let g=d.join("	");/^\t/.test(g)||t.push(g)}t.push(C0(ln("End Table",e,!0)));break;default:return a}}}return i!==""&&t.push(C0(ln("End Folder",e,!0))),t.join(`
`)}function TQ(r,e){if(e==="none")return"";let t=[];t.push(ln("Expression List",e,!0)),t.push(""),t.push("");for(let i of r.getExpressionOrder()){let o=MQ(r.getExpressionIndex(i)+1,e),n=r.getExpressionLatex(i),a=r.getExpressionValue(i);a!==void 0&&(n+=`=${a}`),t.push(`${o}  ${ln(n,e,!1)}`)}return t.join(`
`)}function C0(r){let e="--------------------";return`${e}
${r}
${e}`}function MQ(r,e){let t=""+r;return e==="nemeth"?`${ln(t,e,!1)}_4`:e==="ueb"?ln(`${t}.`,e,!1):""}var{If:fL}=so.Components,bL=class extends Nr{template(){return so.createElement("div",{class:()=>({"dcg-settings-dropdown":!0,"dcg-popover":!0,"dcg-has-background-color":this.controller.hasBackgroundColor(),"dcg-point-left":this.controller.containerSize.height<=420}),role:so.const("region"),"aria-label":so.const("Settings Menu"),didMount:this.bindFn(this.didMountSettingsDropdown),didUnmount:this.bindFn(this.didUnmountSettingsDropdown)},so.createElement("div",{class:so.const("dcg-popover-interior"),style:()=>({background:this.controller.getBackgroundColor()})},so.createElement("div",{class:()=>({"dcg-settings-menu-option":!0,"dcg-displaysize-container":!0})},so.createElement(Xi,{ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size"),staticConfig:this.bindFn(this.getProjectorModeOptions)})),so.createElement(xt,{onChange:this.bindFn(this.onToggleInvertedColors),checked:()=>this.controller.getInvertedColors(),class:this.const("dcg-settings-menu-option dcg-do-not-blur dcg-reverse-contrast")},so.createElement("span",{class:so.const("dcg-checkbox-label")},()=>this.controller.s("basic-calculator-label-reverse-contrast"))),so.createElement(fL,{predicate:()=>this.controller.getBrailleControls()},()=>so.createElement("div",null,so.createElement(xt,{onChange:this.bindFn(this.onToggleBrailleMode),checked:()=>this.controller.renderAsBraille(),class:this.const("dcg-settings-menu-option dcg-do-not-blur dcg-braille-mode")},so.createElement("span",{class:so.const("dcg-checkbox-label")},()=>this.controller.s("shared-calculator-narration-braille-mode"))),so.createElement(fL,{predicate:()=>this.controller.renderAsBraille()},()=>so.createElement("div",{class:()=>({"dcg-settings-menu-option":!0,"dcg-braille-container":!0})},so.createElement(Em,{showBrailleNote:this.const(!1),controller:this.props.controller}),so.createElement("div",{class:so.const("dcg-braille-options-container")},so.createElement(fL,{predicate:()=>!Sp&&mL()&&this.controller.getBrailleExpressionDownload()},()=>so.createElement(Hh,{data:()=>{let e=TQ(this.model,this.controller.getBrailleMode());return new Blob([e],{type:"text/plain"})},enabled:this.const(!0),filename:this.const("desmos-equations.brl"),text:()=>this.controller.s("basic-calculator-link-download-braille-equations"),buttonType:this.const("link")}))))))),so.createElement(fL,{predicate:()=>!!this.getVersionNumber()},()=>so.createElement("div",{class:so.const("dcg-version-number")},so.const("Version: "),()=>this.getVersionNumber()))))}getProjectorModeOptions(){return[{key:"default",label:()=>"A",ariaLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size-default"),class:()=>"dcg-displaysize-default",selected:()=>!this.getProjectorMode(),onSelect:()=>this.onSelectProjectorModeOption(!1)},{key:"large",label:()=>"A",ariaLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size-large"),class:()=>"dcg-displaysize-large",selected:()=>this.getProjectorMode(),onSelect:()=>this.onSelectProjectorModeOption(!0)}]}onSelectProjectorModeOption(e){this.controller.dispatch({type:"update-projector-mode",mode:e})}getVersionNumber(){let e=window;if(e&&e.AppBridge)return e.AppBridge.versionNumber}didUnmountSettingsDropdown(){ie(document).off(".dcg-settings-view")}didMountSettingsDropdown(e){this.settingsGroupNode=e,ie(document).on("dcg-tapstart.dcg-settings-view",t=>{t.target.closest(".dcg-basic-settings-container")||this.controller.dispatch({type:"close-settings-menu"})}),ie(document).on("keydown.dcg-settings-view",t=>{if(Be(t)==="Esc"&&(this.controller.dispatch({type:"close-settings-menu"}),this.controller.dispatch({type:"focus-last-expression"})),Be(t)==="Tab"&&!t.altKey&&!t.metaKey&&!t.ctrlKey){let i=document.activeElement,o=this.props.settingsButtonNode(),n=[...this.settingsGroupNode.querySelectorAll(".dcg-settings-menu-option")].slice(-1)[0];!t.shiftKey&&i===n?(o.focus(),t.preventDefault(),t.stopPropagation()):t.shiftKey&&i===o&&(n.focus(),t.preventDefault(),t.stopPropagation())}})}onToggleBrailleMode(){this.controller.dispatch({type:"set-braille-mode",mode:this.controller.renderAsBraille()?"none":"nemeth"})}onToggleInvertedColors(){let e=!this.controller.getInvertedColors();this.controller.dispatch({type:"update-inverted-colors",mode:e})}getProjectorMode(){return this.controller.isProjectorMode()}};var{If:Fme}=Ed.Components,hv=class extends Nr{template(){let r=this.props.controller();return Ed.createElement("div",{class:Ed.const("dcg-basic-settings-container")},Ed.createElement(Ri,{didMount:e=>this.settingsButtonNode=e,command:this.const("settings"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-settings"),onTap:this.bindFn(this.onToggleSettingsMenu),selected:()=>this.controller.isSettingsMenuOpen(),ariaPopup:this.const(!0)},Ed.createElement("i",{class:Ed.const("dcg-icon-wrench"),"aria-hidden":Ed.const("true")})),Ed.createElement(Fme,{predicate:()=>this.controller.isSettingsMenuOpen()},()=>Ed.createElement(bL,{controller:this.props.controller,settingsButtonNode:()=>this.settingsButtonNode})))}onToggleSettingsMenu(){this.controller.dispatch({type:"toggle-settings-menu"})}};var{If:E0,IfElse:Nme}=No.Components,yL=class extends Nr{template(){let r=this.props.controller();return No.createElement(Vc,{controller:this.props.controller},No.createElement(E0,{predicate:()=>!this.controller.getRestrictedEditing()},()=>No.createElement(Ri,{command:this.const("undo"),disabled:()=>!r.canUndo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-undo"),onTap:e=>r.dispatch({type:"undo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},No.createElement("i",{class:No.const("dcg-icon-undo"),"aria-hidden":No.const("true")}))),No.createElement(E0,{predicate:()=>!this.controller.getRestrictedEditing()},()=>No.createElement(Ri,{command:this.const("redo"),disabled:()=>!r.canRedo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-redo"),onTap:e=>r.dispatch({type:"redo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},No.createElement("i",{class:No.const("dcg-icon-redo"),"aria-hidden":No.const("true")}))),Nme(()=>r.shouldShowClear(),{true:()=>No.createElement(Ri,{command:this.const("clear"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-clear"),onTap:()=>r.dispatch({type:"clear"})},()=>r.s("basic-calculator-button-controlbar-clear")),false:()=>No.createElement(Ri,{command:this.const("clearall"),disabled:()=>!r.canClear(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-clear-all"),onTap:()=>r.dispatch({type:"set-blank",opts:{allowUndo:!0}})},()=>r.s("basic-calculator-button-controlbar-clear-all"))}),No.createElement(E0,{predicate:()=>this.controller.getRestrictedEditing()},()=>No.createElement("div",{class:No.const("dcg-spacer-2")})),No.createElement(E0,{predicate:()=>r.getBrailleMode()==="none"},()=>No.createElement(Ri,{command:this.const("backspace"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-backspace"),disabled:()=>!r.canBackspace(),onTap:()=>r.dispatch({type:"keypad/press-key",key:"Backspace"})},No.createElement("i",{class:No.const("dcg-icon-delete"),"aria-hidden":No.const("true")}))),No.createElement(E0,{predicate:()=>this.props.controller().getSettingsMenu()},()=>No.createElement(hv,{controller:this.props.controller})))}onToggleSettingsMenu(){this.controller.dispatch({type:"toggle-settings-menu"})}};var Gn=__dcg_shared_module_exports__['e'](te());var{If:xL}=Gn.Components,wL=class extends Nr{template(){let r=this.props.controller();return Gn.createElement(Vc,{controller:this.props.controller},Gn.createElement(xL,{predicate:()=>!this.controller.getRestrictedEditing()},()=>Gn.createElement(Ri,{command:this.const("undo"),disabled:()=>!r.canUndo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-undo"),onTap:e=>r.dispatch({type:"undo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},Gn.createElement("i",{class:Gn.const("dcg-icon-undo"),"aria-hidden":Gn.const("true")}))),Gn.createElement(xL,{predicate:()=>!this.controller.getRestrictedEditing()},()=>Gn.createElement(Ri,{command:this.const("redo"),disabled:()=>!r.canRedo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-redo"),onTap:e=>r.dispatch({type:"redo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},Gn.createElement("i",{class:Gn.const("dcg-icon-redo"),"aria-hidden":Gn.const("true")}))),Gn.createElement(Ri,{command:this.const("clear"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-clear"),onTap:()=>r.dispatch({type:"clear"})},()=>r.s("basic-calculator-button-controlbar-clear")),Gn.createElement(xL,{predicate:()=>this.controller.getRestrictedEditing()},()=>Gn.createElement("div",{class:Gn.const("dcg-spacer-2")})),Gn.createElement(xL,{predicate:()=>r.getBrailleMode()==="none"},()=>Gn.createElement(Ri,{command:this.const("backspace"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-backspace"),disabled:()=>!r.canBackspace(),onTap:()=>r.dispatch({type:"keypad/press-key",key:"Backspace"})},Gn.createElement("i",{class:Gn.const("dcg-icon-delete"),"aria-hidden":Gn.const("true")}))))}};var Kn=__dcg_shared_module_exports__['e'](te());var dp=__dcg_shared_module_exports__['e'](te());var Ib=class extends Nh{template(){return dp.createElement("div",{class:()=>({"dcg-keypad-control-toggle":!0,"dcg-toggled":this.props.toggled()}),role:dp.const("button"),tabindex:dp.const("0"),"aria-label":this.bindFn(this.getAriaLabel),onTap:this.bindFn(this.handleTap)},dp.createElement("div",{class:dp.const("dcg-ctrl-toggle-option")},this.props.defaultOption),dp.createElement("div",{class:dp.const("dcg-ctrl-toggle-option")},this.props.toggledOption),dp.createElement("div",{class:dp.const("dcg-ctrl-toggle-cover"),style:()=>({background:__dcg_shared_module_exports__['P'](this.controller.getBackgroundColor(),-.1)})}))}getAriaLabel(){let e={toggled:this.props.toggledAriaLabel(),default:this.props.defaultAriaLabel()};return this.props.toggled()?this.controller.s("shared-calculator-narration-control-toggle-switch-to-default",e):this.controller.s("shared-calculator-narration-control-toggle-switch-to-toggled",e)}handleTap(){this.props.toggled()?Te(this.props.defaultAriaLabel()):Te(this.props.toggledAriaLabel()),this.props.onTap(this.props.command())}};var{If:xN,IfElse:Bme}=Kn.Components,vL=class extends Nr{template(){let r=this.props.controller();return Kn.createElement(Vc,{controller:this.props.controller},Kn.createElement(Ri,{command:this.const("main"),selected:()=>r.getKeyboardMode()==="main",disabled:()=>this.controller.renderAsBraille(),ignoreInTabOrder:this.const(!0),selectable:this.const(!0),onTap:()=>r.dispatch({type:"main"}),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-main")},()=>r.s("basic-calculator-button-controlbar-main")),Kn.createElement(Ri,{command:this.const("ABC"),selected:()=>["qwerty","capitalQwerty","letters"].indexOf(r.getKeyboardMode())!==-1,disabled:()=>this.controller.renderAsBraille(),ignoreInTabOrder:this.const(!0),selectable:this.const(!0),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-abc"),onTap:()=>r.dispatch({type:"ABC"})},()=>r.s("basic-calculator-button-controlbar-abc")),Kn.createElement(Ri,{command:this.const("functions"),selected:()=>["functions","restrictedFunctions"].indexOf(r.getKeyboardMode())!==-1,ariaLabel:()=>r.s("basic-calculator-narration-controlbar-functions"),disabled:()=>this.controller.renderAsBraille(),ignoreInTabOrder:this.const(!0),selectable:this.const(!0),onTap:()=>r.dispatch({type:"functions"})},()=>r.s("basic-calculator-button-controlbar-func")),Kn.createElement(Ib,{command:this.const("degrees"),toggled:()=>this.model.getDegreeMode(),defaultOption:()=>r.s("basic-calculator-label-controlbar-rad"),toggledOption:()=>r.s("basic-calculator-label-controlbar-deg"),defaultAriaLabel:()=>r.s("basic-calculator-narration-controlbar-radians"),toggledAriaLabel:()=>r.s("basic-calculator-narration-controlbar-degrees"),onTap:()=>r.dispatch({type:"degrees"}),controller:this.props.controller}),Kn.createElement(xN,{predicate:()=>!this.controller.getRestrictedEditing()},()=>Kn.createElement(Ri,{command:this.const("undo"),disabled:()=>!r.canUndo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-undo"),onTap:e=>r.dispatch({type:"undo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},Kn.createElement("i",{class:Kn.const("dcg-icon-undo"),"aria-hidden":Kn.const("true")}))),Kn.createElement(xN,{predicate:()=>!this.controller.getRestrictedEditing()},()=>Kn.createElement(Ri,{command:this.const("redo"),disabled:()=>!r.canRedo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-redo"),onTap:e=>r.dispatch({type:"redo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},Kn.createElement("i",{class:Kn.const("dcg-icon-redo"),"aria-hidden":Kn.const("true")}))),Bme(()=>r.shouldShowClear(),{true:()=>Kn.createElement(Ri,{command:this.const("clear"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-clear"),onTap:()=>r.dispatch({type:"clear"})},()=>r.s("basic-calculator-button-controlbar-clear")),false:()=>Kn.createElement(Ri,{command:this.const("clearall"),disabled:()=>!r.canClear(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-clear-all"),onTap:()=>r.dispatch({type:"set-blank",opts:{allowUndo:!0}})},()=>r.s("basic-calculator-button-controlbar-clear-all"))}),Kn.createElement(xN,{predicate:()=>this.props.controller().getSettingsMenu()},()=>Kn.createElement(hv,{controller:this.props.controller})))}};var cn=__dcg_shared_module_exports__['e'](te());var{If:AQ}=cn.Components,CL=class extends Nr{template(){let r=this.props.controller();return cn.createElement(Vc,{controller:this.props.controller},cn.createElement(Ib,{command:this.const("degrees"),toggled:()=>this.model.getDegreeMode(),defaultOption:()=>r.s("basic-calculator-label-controlbar-rad"),toggledOption:()=>r.s("basic-calculator-label-controlbar-deg"),defaultAriaLabel:()=>r.s("basic-calculator-narration-controlbar-radians"),toggledAriaLabel:()=>r.s("basic-calculator-narration-controlbar-degrees"),onTap:()=>r.dispatch({type:"degrees"}),controller:this.props.controller}),cn.createElement("div",{class:cn.const("dcg-spacer")}),cn.createElement(AQ,{predicate:()=>!this.controller.getRestrictedEditing()},()=>cn.createElement(Ri,{command:this.const("undo"),disabled:()=>!r.canUndo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-undo"),onTap:e=>r.dispatch({type:"undo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},cn.createElement("i",{class:cn.const("dcg-icon-undo"),"aria-hidden":cn.const("true")}))),cn.createElement(AQ,{predicate:()=>!this.controller.getRestrictedEditing()},()=>cn.createElement(Ri,{command:this.const("redo"),disabled:()=>!r.canRedo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-redo"),onTap:e=>r.dispatch({type:"redo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},cn.createElement("i",{class:cn.const("dcg-icon-redo"),"aria-hidden":cn.const("true")}))),cn.createElement("div",{class:cn.const("dcg-spacer")}),cn.createElement(Ri,{narrowButton:this.const(!0),command:this.const("clear"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-clear"),onTap:()=>r.dispatch({type:"clear"})},()=>r.s("basic-calculator-button-controlbar-clear")),cn.createElement(Ri,{narrowButton:this.const(!0),command:this.const("backspace"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-backspace"),onTap:()=>r.dispatch({type:"keypad/press-key",key:"Backspace"})},cn.createElement("i",{class:cn.const("dcg-icon-delete"),"aria-hidden":cn.const("true")})))}};var Tu=__dcg_shared_module_exports__['e'](te());var S0=class extends Nr{template(){return Tu.createElement("div",{role:Tu.const("region"),"aria-label":()=>this.s("shared-calculator-narration-keypad")},Tu.createElement(Er,{controller:this.props.controller},Tu.createElement(je,null,k(this,"(",{colspan:this.parenColspan()}),k(this,")",{colspan:this.parenColspan()}),this.makeAdditionalFunctionKey(0),this.makeAdditionalFunctionKey(1),k(this,"division")),Tu.createElement(je,null,k(this,"7",{style:"highlight"}),k(this,"8",{style:"highlight"}),k(this,"9",{style:"highlight"}),k(this,"multiplication")),Tu.createElement(je,null,k(this,"4",{style:"highlight"}),k(this,"5",{style:"highlight"}),k(this,"6",{style:"highlight"}),k(this,"-")),Tu.createElement(je,null,k(this,"1",{style:"highlight"}),k(this,"2",{style:"highlight"}),k(this,"3",{style:"highlight"}),k(this,"+")),Tu.createElement(je,null,k(this,"0",{style:"highlight"}),k(this,".",{style:"highlight"}),k(this,"ans"),k(this,"enter",{style:"blue"}))))}parenColspan(){return this.controller.getAdditionalFunctions().length>1?.5:1}makeAdditionalFunctionKey(e){let t=this.controller.getAdditionalFunctions()[e];return t==="exponent"?k(this,"a^b"):t==="percent"?k(this,"%"):t==="sqrt"?k(this,"sqrt"):t==="fraction"?k(this,"a/b"):void 0}};var Mu=__dcg_shared_module_exports__['e'](te());var D0=class extends Nr{template(){return Mu.createElement("div",{role:Mu.const("region"),"aria-label":()=>this.s("shared-calculator-narration-keypad")},Mu.createElement(Er,{controller:this.props.controller},Mu.createElement(je,null,k(this,"(",{colspan:this.parenColspan()}),k(this,")",{colspan:this.parenColspan()}),this.makeAdditionalFunctionKey(1)),Mu.createElement(je,null,k(this,"7",{style:"highlight"}),k(this,"8",{style:"highlight"}),k(this,"9",{style:"highlight"}),k(this,"division")),Mu.createElement(je,null,k(this,"4",{style:"highlight"}),k(this,"5",{style:"highlight"}),k(this,"6",{style:"highlight"}),k(this,"multiplication")),Mu.createElement(je,null,k(this,"1",{style:"highlight"}),k(this,"2",{style:"highlight"}),k(this,"3",{style:"highlight"}),k(this,"-")),Mu.createElement(je,null,k(this,"0",{style:"highlight"}),k(this,".",{style:"highlight",colspan:this.dotColspan()}),this.makeAdditionalFunctionKey(0),k(this,"+"))))}parenColspan(){return this.controller.getAdditionalFunctions().length===2?1.5:2}dotColspan(){return this.controller.getAdditionalFunctions().length?1:2}makeAdditionalFunctionKey(e){let t=this.controller.getAdditionalFunctions()[e];return t==="exponent"?k(this,"a^b"):t==="percent"?k(this,"%"):t==="sqrt"?k(this,"sqrt"):void 0}};var Cs=__dcg_shared_module_exports__['e'](te());var k0=class extends Nr{template(){return Cs.createElement(Er,{controller:this.props.controller},Cs.createElement(je,null,k(this,"("),k(this,")"),k(this,"x^2"),k(this,"sqrt"),Cs.createElement("div",{class:Cs.const("dcg-partition-placeholder")}),k(this,"x^3"),k(this,"x^y"),k(this,"ythroot")),Cs.createElement(je,null,k(this,"7",{style:"highlight"}),k(this,"8",{style:"highlight"}),k(this,"9",{style:"highlight"}),k(this,"division"),Cs.createElement("div",{class:Cs.const("dcg-partition-placeholder")}),k(this,"pi"),k(this,"e^x"),k(this,"!")),Cs.createElement(je,null,k(this,"4",{style:"highlight"}),k(this,"5",{style:"highlight"}),k(this,"6",{style:"highlight"}),k(this,"multiplication"),Cs.createElement("div",{class:Cs.const("dcg-partition-placeholder")}),k(this,"log"),k(this,"ln"),k(this,"|x|")),Cs.createElement(je,null,k(this,"1",{style:"highlight"}),k(this,"2",{style:"highlight"}),k(this,"3",{style:"highlight"}),k(this,"-"),Cs.createElement("div",{class:Cs.const("dcg-partition-placeholder")}),k(this,"sin"),k(this,"cos"),k(this,"tan")),Cs.createElement(je,null,k(this,"0",{style:"highlight"}),k(this,".",{style:"highlight"}),k(this,"x/y"),k(this,"+"),Cs.createElement("div",{class:Cs.const("dcg-partition-placeholder")}),k(this,"arcsin"),k(this,"arccos"),k(this,"arctan")))}};var Sd=__dcg_shared_module_exports__['e'](te());var dn=__dcg_shared_module_exports__['e'](te());var{IfElse:Ume}=dn.Components,G0=class extends Nr{template(){return dn.createElement(Er,{controller:this.props.controller},dn.createElement(je,null,k(this,"a^2"),k(this,"a^b"),k(this,"|a|"),dn.createElement("div",{class:dn.const("dcg-partition-placeholder")}),k(this,"7",{style:"highlight"}),k(this,"8",{style:"highlight"}),k(this,"9",{style:"highlight"}),k(this,"division"),dn.createElement("div",{class:dn.const("dcg-partition-placeholder")}),k(this,"%"),k(this,"a/b")),dn.createElement(je,null,k(this,"sqrt"),k(this,"nthroot"),k(this,"pi"),dn.createElement("div",{class:dn.const("dcg-partition-placeholder")}),k(this,"4",{style:"highlight"}),k(this,"5",{style:"highlight"}),k(this,"6",{style:"highlight"}),k(this,"multiplication"),dn.createElement("div",{class:dn.const("dcg-partition-placeholder")}),k(this,"left",{style:"highlight"}),k(this,"right",{style:"highlight"})),dn.createElement(je,null,k(this,"sin"),k(this,"cos"),k(this,"tan"),dn.createElement("div",{class:dn.const("dcg-partition-placeholder")}),k(this,"1",{style:"highlight"}),k(this,"2",{style:"highlight"}),k(this,"3",{style:"highlight"}),k(this,"-"),dn.createElement("div",{class:dn.const("dcg-partition-placeholder")}),Jr(.5),k(this,"backspace",{style:"highlight",colspan:1.5})),dn.createElement(je,null,k(this,"("),k(this,")"),Ume(()=>this.controller.getReplaceCommaWith10Exp(),{true:()=>k(this,"10^n"),false:()=>k(this,",")}),dn.createElement("div",{class:dn.const("dcg-partition-placeholder")}),k(this,"0",{style:"highlight"}),k(this,".",{style:"highlight"}),k(this,"ans"),k(this,"+"),dn.createElement("div",{class:dn.const("dcg-partition-placeholder")}),k(this,"enter",{style:"blue",colspan:2})))}};var pp=__dcg_shared_module_exports__['e'](te());var T0=class extends Nr{template(){return pp.createElement(Er,{controller:this.props.controller},pp.createElement(je,null,k(this,"q"),k(this,"w"),k(this,"e"),k(this,"r"),k(this,"t"),k(this,"y"),k(this,"u"),k(this,"i"),k(this,"o"),k(this,"p")),pp.createElement(je,null,pp.createElement("div",{class:pp.const("dcg-half-width-placeholder")}),k(this,"a"),k(this,"s"),k(this,"d"),k(this,"f"),k(this,"g"),k(this,"h"),k(this,"j"),k(this,"k"),k(this,"l"),pp.createElement("div",{class:pp.const("dcg-half-width-placeholder")})),pp.createElement(je,null,k(this,"=",{style:"highlight"}),k(this,"z"),k(this,"x"),k(this,"c"),k(this,"v"),k(this,"b"),k(this,"n"),k(this,"m"),k(this,","),k(this,"backspace",{style:"highlight"})),pp.createElement(je,null,k(this,"shift",{style:"highlight",colspan:1.5}),k(this,"("),k(this,")"),k(this,"["),k(this,"]"),k(this,"!"),k(this,"'"),k(this,"pi"),k(this,"enter",{style:"blue",colspan:1.5})))}};var gv=__dcg_shared_module_exports__['e'](te());var M0=class extends Nr{template(){return gv.createElement(Er,{controller:this.props.controller},gv.createElement(je,null,k(this,"a"),k(this,"b"),k(this,"c"),k(this,"d"),k(this,"e"),k(this,"f"),k(this,"g"),k(this,"h"),k(this,"i"),k(this,"j")),gv.createElement(je,null,k(this,"k"),k(this,"l"),k(this,"m"),k(this,"n"),k(this,"o"),k(this,"p"),k(this,"q"),k(this,"r"),k(this,"s"),k(this,"t")),gv.createElement(je,null,k(this,"=",{style:"highlight"}),k(this,","),k(this,"u"),k(this,"v"),k(this,"w"),k(this,"x"),k(this,"y"),k(this,"z"),k(this,"pi"),k(this,"backspace",{style:"highlight"})),gv.createElement(je,null,k(this,"shift",{style:"highlight",colspan:2}),k(this,"("),k(this,")"),k(this,"["),k(this,"]"),k(this,"!"),k(this,"'"),k(this,"enter",{style:"blue",colspan:2})))}};var up=__dcg_shared_module_exports__['e'](te());var I0=class extends Nr{template(){return up.createElement(Er,{controller:this.props.controller},up.createElement(je,null,k(this,"Q"),k(this,"W"),k(this,"E"),k(this,"R"),k(this,"T"),k(this,"Y"),k(this,"U"),k(this,"I"),k(this,"O"),k(this,"P")),up.createElement(je,null,up.createElement("div",{class:up.const("dcg-half-width-placeholder")}),k(this,"A"),k(this,"S"),k(this,"D"),k(this,"F"),k(this,"G"),k(this,"H"),k(this,"J"),k(this,"K"),k(this,"L"),up.createElement("div",{class:up.const("dcg-half-width-placeholder")})),up.createElement(je,null,k(this,"=",{style:"highlight"}),k(this,"Z"),k(this,"X"),k(this,"C"),k(this,"V"),k(this,"B"),k(this,"N"),k(this,"M"),k(this,","),k(this,"backspace",{style:"highlight"})),up.createElement(je,null,k(this,"shift",{style:"highlight",colspan:1.5}),k(this,"("),k(this,")"),k(this,"["),k(this,"]"),k(this,"!"),k(this,"'"),k(this,"pi"),k(this,"enter",{style:"blue",colspan:1.5})))}};var mv=__dcg_shared_module_exports__['e'](te());var A0=class extends Nr{template(){return mv.createElement(Er,{controller:this.props.controller},mv.createElement(je,null,k(this,"A"),k(this,"B"),k(this,"C"),k(this,"D"),k(this,"E"),k(this,"F"),k(this,"G"),k(this,"H"),k(this,"I"),k(this,"J")),mv.createElement(je,null,k(this,"K"),k(this,"L"),k(this,"M"),k(this,"N"),k(this,"O"),k(this,"P"),k(this,"Q"),k(this,"R"),k(this,"S"),k(this,"T")),mv.createElement(je,null,k(this,"=",{style:"highlight"}),k(this,","),k(this,"U"),k(this,"V"),k(this,"W"),k(this,"X"),k(this,"Y"),k(this,"Z"),k(this,"pi"),k(this,"backspace",{style:"highlight"})),mv.createElement(je,null,k(this,"shift",{style:"highlight",colspan:2}),k(this,"("),k(this,")"),k(this,"["),k(this,"]"),k(this,"!"),k(this,"'"),k(this,"enter",{style:"blue",colspan:2})))}};var rs=__dcg_shared_module_exports__['e'](te());var{IfElse:zme}=rs.Components,V0=class extends Nr{template(){return rs.createElement("div",{class:rs.const("dcg-sci-func-keypad")},rs.createElement(Er,{controller:this.props.controller},rs.createElement(je,null,k(this,"sin"),k(this,"cos"),k(this,"tan"),rs.createElement("div",{class:rs.const("dcg-partition-placeholder")}),k(this,"a^b"),k(this,"sqrt"),k(this,"nthroot")),rs.createElement(je,null,k(this,"arcsin"),k(this,"arccos"),k(this,"arctan"),rs.createElement("div",{class:rs.const("dcg-partition-placeholder")}),k(this,"e^x"),k(this,"abs"),zme(()=>this.controller.getReplaceRoundWithReciprocal(),{true:()=>k(this,"a^{-1}"),false:()=>k(this,"round")})),rs.createElement(je,null,k(this,"mean"),k(this,"stdev"),k(this,"stdevp"),rs.createElement("div",{class:rs.const("dcg-partition-placeholder")}),k(this,"ln"),k(this,"log"),k(this,"backspace",{style:"highlight"})),rs.createElement(je,null,k(this,"nPr"),k(this,"nCr"),k(this,"!"),rs.createElement("div",{class:rs.const("dcg-partition-placeholder")}),k(this,"e"),k(this,"pi"),k(this,"enter",{style:"blue"}))))}};var{SwitchUnion:Kme}=Sd.Components,L0=class extends Nr{template(){return Sd.createElement("div",{role:Sd.const("region"),"aria-label":()=>this.s("shared-calculator-narration-keypad")},Kme(()=>this.controller.getKeyboardMode(),{qwerty:()=>Sd.createElement(T0,{controller:this.props.controller}),letters:()=>Sd.createElement(M0,{controller:this.props.controller}),capitalQwerty:()=>Sd.createElement(I0,{controller:this.props.controller}),capitalLetters:()=>Sd.createElement(A0,{controller:this.props.controller}),functions:()=>Sd.createElement(V0,{controller:this.props.controller}),main:()=>Sd.createElement(G0,{controller:this.props.controller})}))}};var lo=__dcg_shared_module_exports__['e'](te());var Pl=__dcg_shared_module_exports__['e'](te());var{For:qme}=Pl.Components,fv=class extends Pl.Class{template(){return Pl.createElement("tr",null,Pl.createElement(qme,{each:()=>this.getBrailleAscii(this.props.latex()),key:e=>e.key},Pl.createElement("td",null,e=>Pl.createElement("span",{class:Pl.const("dcg-key-press")},()=>e.char))),Pl.createElement("td",{class:Pl.const("dcg-braille-font")},()=>this.getBrailleUnicode(this.props.latex())),Pl.createElement("td",null,Pl.createElement(lt,{config:this.const({}),latex:()=>this.props.latex()})))}getBrailleAscii(e){let t=As.toExpandedBrailleAscii(this.getBrailleUnicode(e)),i=[];for(let o=0;o<t.length;o++)i.push({char:t[o],key:o+")"+t[o]});return i}getBrailleUnicode(e){let t;return this.props.brailleMode()==="nemeth"?t=bh(e):this.props.brailleMode()==="ueb"&&(t=yh(e)),t&&t.value?t.value:""}};var Ab=class extends Nr{template(){return lo.createElement("div",{class:()=>({"dcg-braille-io-keypad-container":!0,"dcg-has-background-color":this.controller.hasBackgroundColor()})},lo.createElement("div",{class:lo.const("dcg-braille-io-keypad")},lo.createElement("div",{class:lo.const("dcg-braille-description")},lo.createElement("div",{class:lo.const("dcg-braille-title")},()=>this.controller.s("basic-calculator-text-braille-mode-is-on",{mode:this.brailleType()})),lo.createElement("div",{class:lo.const("dcg-braille-info-text")},()=>this.controller.s("basic-calculator-text-how-to-type-braille")),lo.createElement("div",{class:lo.const("dcg-btn-primary"),role:lo.const("button"),tabindex:lo.const(0),onTap:()=>this.controller.dispatch({type:"set-braille-mode",mode:"none"})},()=>this.controller.s("basic-calculator-button-turn-braille-mode-off",{mode:this.brailleType()}))),lo.createElement("div",{class:lo.const("dcg-braille-examples-table-container")},lo.createElement("table",{class:lo.const("dcg-braille-examples-table")},lo.createElement("tr",null,lo.createElement("th",null,()=>this.controller.s("basic-calculator-heading-braille-table-type-this")),lo.createElement("th",null,()=>this.brailleType()),lo.createElement("th",null,()=>this.controller.s("basic-calculator-heading-braille-table-typeset"))),lo.createElement(fv,{brailleMode:()=>this.controller.getBrailleMode(),latex:this.const("2+2")}),lo.createElement(fv,{brailleMode:()=>this.controller.getBrailleMode(),latex:this.const("\\frac{1}{2}")}),lo.createElement(fv,{brailleMode:()=>this.controller.getBrailleMode(),latex:this.const("\\sqrt{4}")})),lo.createElement("div",{class:lo.const("dcg-more-examples-link")},lo.createElement("a",{href:()=>"https://www.desmos.com/braille-examples?"+this.controller.getBrailleMode(),target:lo.const("_blank")},()=>this.controller.s("basic-calculator-link-view-braille-examples"))))))}brailleType(){return this.controller.getBrailleMode()==="nemeth"?"Nemeth":this.controller.getBrailleMode()==="ueb"?"UEB":""}};var Fs=__dcg_shared_module_exports__['e'](te());var Qt=__dcg_shared_module_exports__['e'](te());var{If:Wh,Input:Hme,Textarea:Wme}=Qt.Components,P0=class extends Nr{constructor(){super(...arguments),this.lastBrailleModeDuringFocusChange="none"}getAriaLabel(){let e=this.getIndex()+1+"";return this.s("shared-calculator-narration-expression-index",{index:e})}didUpdate(){this.renderAnsValue()}didMountMQ(e){this.mq=e}getExp(){return this.model.getExpressionById(this.props.id())}getAns(){return this.model.getExpressionAns(this.props.id())}getAnsId(){return this.model.getExpressionAnsId(this.props.id())}getLatex(){return this.getExp().latex}getValue(){return this.model.getExpressionValue(this.props.id())}getBraille(){let e=this.getExp().braille;if(e!=="")return e;{let t=Jx(this.getLatex(),this.controller.getBrailleMode());return t.isError?"":As.toExpandedBrailleAscii(t.value)}}getIndex(){return this.model.getExpressionIndex(this.props.id())}getShowEvaluation(){return this.model.shouldShowEvaluationForExpression(this.props.id())}isFractionEvaluation(){return this.getExp().displayAsFraction}canDisplayEvaluationAsFraction(){return this.controller.getDecimalToFraction()&&this.model.canDisplayEvaluationAsFraction(this.props.id())}shouldDisplayEvaluationAsFraction(){return this.canDisplayEvaluationAsFraction()&&this.getExp().displayAsFraction}toggleFractionEvaluation(){this.dispatch({type:"toggle-fraction-evaluation",id:this.props.id()})}getFractionDisplayAriaLabel(){return this.shouldDisplayEvaluationAsFraction()?this.controller.s("basic-calculator-narration-convert-to-decimal"):this.controller.s("basic-calculator-narration-convert-to-fraction")}getError(){let e=this.model.getExpressionError(this.props.id());return e&&this.getLatex().length>0?Mp(e,this.controller.getLanguage()):""}showError(){return!!this.getError()}getFractionMessage(){return this.shouldDisplayEvaluationAsFraction()?this.s("basic-calculator-label-convert-to-decimal"):this.s("basic-calculator-label-convert-to-fraction")}getIsFocused(){return!this.controller.isSettingsMenuOpen()&&this.model.isExpressionFocused(this.props.id())}onFocusedChanged(e){let t=this.controller.getBrailleMode(),i=t!==this.lastBrailleModeDuringFocusChange;this.lastBrailleModeDuringFocusChange=t,!(!this.getExp()||i)&&(e?this.dispatch({type:"focusin",id:this.props.id()}):this.dispatch({type:"focusout",id:this.props.id()}))}onMQReflow(){this.renderedAnsData=void 0,this.renderAnsValue()}renderAnsValue(){if(!this.mq)return;let e=this.getAns(),t=!1,i=this.getAnsId();if(i){let o=this.model.getExpressionById(i);t=o&&o.displayAsFraction}this.renderedAnsData&&this.renderedAnsData.value==e&&this.renderedAnsData.displayAsFraction===t||(this.renderedAnsData={value:e,displayAsFraction:t},this.mq.querySelectorAll(".dcg-mq-ans").forEach(o=>{let n=o,a;typeof e=="number"?a=__dcg_shared_module_exports__['sb'](e,{digits:this.getEvaluationDigits(),bigCutoff:1e9,displayAsFraction:t}):typeof e=="string"&&(a=e),a?(n.classList.remove("dcg-invalid"),n.innerHTML=a):(n.classList.add("dcg-invalid"),n.innerHTML='<i class="dcg-icon-error" aria-hidden="true"></i>')}))}getEvaluationLatex(){let e=this.getValue();if(e===void 0&&(e=NaN),this.model.isRationalizableConstant(this.props.id())&&!this.shouldDisplayEvaluationAsFraction())return"";let t;if(Array.isArray(e))t=`\\mathrm{${e.length}\\ element\\ list}`;else{var i=__dcg_shared_module_exports__['tb'](e,{digits:this.getEvaluationDigits(),bigCutoff:1e9,displayAsFraction:this.shouldDisplayEvaluationAsFraction()});return i==="undefined"?"=\\mathrm{undefined}":"="+i}return t}getEvaluationBraille(){let e=this.getEvaluationLatex(),t=Jx(e,this.controller.getBrailleMode());return t.isError?"":As.toExpandedBrailleAscii(t.value)}didMountBrailleInput(e){this.brailleInputNode=e}didUnmountBrailleInput(){this.brailleInputNode=void 0}handleBrailleFocus(e){let t=e.target;t&&setTimeout(this.bindIfMounted(()=>{t.setSelectionRange(0,0)}))}handleBrailleKeydown(e){!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&(Be(e)===un?(this.forceModelFocus(),this.dispatch({type:"focus-prev-expression"}),e.preventDefault()):Be(e)===hn?(this.forceModelFocus(),this.dispatch({type:"focus-next-expression"}),e.preventDefault()):Be(e)===dl?(this.forceModelFocus(),this.dispatch({type:"insert-blank-expression"}),e.preventDefault()):Be(e)===Nc&&document.activeElement===this.brailleInputNode&&this.getBraille()===""&&(this.dispatch({type:"backspace-from-braille"}),e.preventDefault()))}forceModelFocus(){document.activeElement!==this.brailleInputNode&&this.onFocusedChanged(!0)}focusBrailleInput(){this.brailleInputNode&&document.activeElement!==this.brailleInputNode&&this.brailleInputNode.focus()}getPostLabel(){if(this.showError())return this.getError();if(this.getShowEvaluation()){let e=this.getValue();return e===void 0&&(e=NaN),Array.isArray(e)?`${e.length} element list`:"equals "+Ua(__dcg_shared_module_exports__['tb'](e,{digits:this.getEvaluationDigits(),bigCutoff:1e9,displayAsFraction:this.shouldDisplayEvaluationAsFraction()}))}return""}onBrailleInput(e){this.controller.isSettingsMenuOpen()&&this.controller.dispatch({type:"close-settings-menu"});let t=K1(As.coerceToSixDotCells(e),this.controller.getBrailleMode()),i=t.isError?"":t.value;(!this.controller.getCapExpressionSize()||Sx(i)<=Dx)&&this.controller.dispatch({type:"update-latex-from-braille",latex:i,braille:e,id:this.props.id()})}getIndexSubscript(){return`_{${this.getIndex()+1}}`}getEvaluationDigits(){return this.controller.isScientificCalc()?10:7}onMountContainer(e){this.containerNode=e}onTapContainer(e){e.target===this.containerNode&&!this.getShowEvaluation()&&!this.showError()&&this.forceModelFocus()}template(){return Qt.createElement("div",{class:()=>({"dcg-basic-expression":!0,"dcg-focused":this.getIsFocused(),"dcg-braille-io":this.controller.renderAsBraille()}),onTap:this.bindFn(this.onTapContainer),onMount:this.bindFn(this.onMountContainer)},Qt.createElement(Wh,{predicate:()=>this.controller.renderAsBraille()},()=>Qt.createElement("div",{class:Qt.const("dcg-braille-input")},Qt.createElement($f,{ariaLabel:()=>{let e=Jx(`eq${this.getIndexSubscript()}`,this.controller.getBrailleMode());return e.isError?"":As.toExpandedBrailleAscii(e.value)},didMount:this.bindFn(this.didMountBrailleInput),didUnmount:this.bindFn(this.didUnmountBrailleInput),onFocusedChanged:this.bindFn(this.onFocusedChanged),shouldFocus:this.bindFn(this.getIsFocused),onKeydown:this.bindFn(this.handleBrailleKeydown),onInput:this.bindFn(this.onBrailleInput),sixKeyInput:()=>this.controller.getSixKeyInput(),value:()=>this.getBraille(),isStatic:this.const(!1)}))),Qt.createElement(Wh,{predicate:()=>this.controller.renderAsBraille()},()=>Qt.createElement("div",{class:Qt.const("dcg-braille-evaluation-container")},Qt.createElement(Wh,{predicate:()=>this.getShowEvaluation()},()=>Qt.createElement("div",{class:Qt.const("dcg-braille-evaluation")},Qt.createElement(Hme,{readonly:this.const("true"),class:this.const("dcg-braille-evaluation-inner"),value:()=>this.getEvaluationBraille(),onFocus:this.bindFn(this.handleBrailleFocus),onKeydown:this.bindFn(this.handleBrailleKeydown),onInput:()=>{}}))),Qt.createElement(Wh,{predicate:()=>this.showError()},()=>Qt.createElement("div",{class:Qt.const("dcg-braille-error")},Qt.createElement("div",{class:Qt.const("dcg-basic-expression-error")},Qt.createElement("i",{class:Qt.const("dcg-icon-error"),"aria-hidden":Qt.const("true")})),Qt.createElement(Wme,{readonly:this.const("true"),class:this.const("dcg-braille-error-inner"),value:()=>this.getError(),onFocus:this.bindFn(this.handleBrailleFocus),onKeydown:this.bindFn(this.handleBrailleKeydown),onInput:()=>{}}))))),Qt.createElement(Wh,{predicate:()=>this.controller.renderAsBraille()},()=>Qt.createElement("div",{class:Qt.const("dcg-exp-mathquill-container"),didMount:this.bindFn(this.didMountMQ),onTap:this.bindFn(this.forceModelFocus)},Qt.createElement(lt,{latex:()=>this.getLatex(),config:this.const({}),onReflow:this.bindFn(this.onMQReflow)}))),Qt.createElement(Wh,{predicate:()=>!this.controller.renderAsBraille()},()=>Qt.createElement("div",{class:Qt.const("dcg-exp-mathquill-container"),didMount:this.bindFn(this.didMountMQ)},Qt.createElement(Ze,{latex:()=>this.getLatex(),onReflow:this.bindFn(this.onMQReflow),isFocused:this.bindFn(this.getIsFocused),capExpressionSize:()=>this.controller.getCapExpressionSize(),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabel(),getAriaPostLabel:()=>this.getPostLabel(),hasError:()=>!1,onUserPressedKey:(e,t)=>{this.controller.isSettingsMenuOpen()&&this.controller.dispatch({type:"close-settings-menu"}),this.dispatch({type:"keypad/press-key",key:e,evt:t})},onUserTypedText:e=>this.dispatch({type:"keypad/type-text",text:e}),onUserChangedLatex:e=>{this.dispatch({type:"update-latex",id:this.props.id(),latex:e})},onFocusedChanged:this.bindFn(this.onFocusedChanged),disableSpace:()=>this.controller.getRestrictedEditing()}))),Qt.createElement("div",{class:Qt.const("dcg-exp-output-container")},Qt.createElement(Wh,{predicate:()=>this.showError()&&!this.controller.renderAsBraille()},()=>Qt.createElement($e,{tooltip:this.bindFn(this.getError),gravity:this.const("w"),sticky:this.const(!0)},Qt.createElement("div",{class:Qt.const("dcg-basic-expression-error")},Qt.createElement("i",{class:Qt.const("dcg-icon-error"),"aria-hidden":Qt.const("true")})))),Qt.createElement(Wh,{predicate:()=>this.getShowEvaluation()},()=>Qt.createElement("div",{class:()=>({"dcg-basic-expression-value":!0,"dcg-basic-evaluation-gray":Array.isArray(this.getValue())})},Qt.createElement(lt,{config:this.const({}),latex:()=>this.getEvaluationLatex()}),Qt.createElement(Wh,{predicate:this.bindFn(this.canDisplayEvaluationAsFraction)},()=>Qt.createElement($e,{tooltip:this.bindFn(this.getFractionMessage),gravity:this.const("s")},Qt.createElement("span",{role:Qt.const("button"),tabindex:Qt.const("0"),"aria-label":this.bindFn(this.getFractionDisplayAriaLabel),class:()=>({"dcg-basic-fraction-toggle":!0,"dcg-selected":this.isFractionEvaluation()}),onTap:this.bindFn(this.toggleFractionEvaluation)},Qt.createElement("i",{class:Qt.const("dcg-icon-fraction"),"aria-hidden":Qt.const("true")}))))))))}getMQConfig(){return this.controller.getMathquillConfig()}};qt();var{For:$me,If:jme}=Fs.Components,_0=class extends Nr{constructor(){super(...arguments),this.didShowAnswerHint=!1,this.didHideAnswerHint=!1}template(){return Fs.createElement("div",{class:Fs.const("dcg-basic-list-container"),role:Fs.const("region"),"aria-label":()=>this.controller.s("shared-calculator-narration-expression-list"),didMount:this.bindFn(this.didMountContainer)},Fs.createElement("div",{class:Fs.const("dcg-basic-list-placeholder"),didMount:this.bindFn(this.didMountPlaceholder)},Fs.createElement(jme,{predicate:this.bindFn(this.showAnswerHint)},()=>Fs.createElement("div",{class:Fs.const("dcg-answer-hint")},()=>this.controller.s("basic-calculator-label-answer-hint"),Fs.createElement("i",{class:Fs.const("dcg-icon-curved-arrow")})))),Fs.createElement($me,{each:()=>this.model.getExpressionOrder()},Fs.createElement("div",{class:()=>({"dcg-basic-list":!0,"dcg-projector-mode":this.controller.isProjectorMode()})},e=>Fs.createElement(P0,{controller:this.props.controller,id:this.const(e)}))))}didMountPlaceholder(e){ie(e).on("dcg-tap",pi)}showAnswerHint(){if(this.didHideAnswerHint)return!1;let e=this.model.getExpressionOrder()[0];return this.model.shouldShowEvaluationForExpression(e)||this.didShowAnswerHint?(this.didShowAnswerHint=!0,this.model.getNumberOfExpressions()>1||this.model.getExpressionLatex(e)===""?(this.didHideAnswerHint=!0,!1):!0):!1}didUpdate(){if(!this.container)return;let e=this.container.querySelector(".dcg-focused");e&&yc(e,this.container,50)}didMountContainer(e){this.container=e}};var{If:O0,IfElse:EL}=Hr.Components,R0=class extends Nr{template(){return Hr.createElement(O0,{predicate:()=>this.controller.shouldRender()},()=>Hr.createElement("div",{class:Hr.const("dcg-calculator-api-container"),style:Hr.const("width: 100%; height: 100%; position: relative;")},Hr.createElement("div",{class:()=>({"dcg-calc-basic-main-wrapper":!0,"dcg-narrow":this.controller.containerSize.width<570,"dcg-short":this.controller.containerSize.height<=540,"dcg-scientific-calculator":this.controller.isScientificCalc(),"dcg-four-function-calculator":this.controller.isFourFunctionCalc(),"dcg-container":!0}),onKeydown:this.bindFn(this.handleRootKeydown),didMount:this.bindFn(this.didMountRoot),"x-ms-format-detection":Hr.const("none")},Hr.createElement("div",{role:Hr.const("application"),"aria-label":()=>this.controller.isScientificCalc()?this.controller.s("basic-calculator-narration-calc-description-scientific"):this.controller.isFourFunctionCalc()?this.controller.s("basic-calculator-narration-calc-description-fourfunction"):"",class:()=>({"dcg-calc-basic-main":!0,"dcg-inverted-colors":this.controller.getInvertedColors(),"dcg-projector-mode":this.controller.isProjectorMode(),"dcg-ipad":ll,"dcg-has-background-color":this.controller.hasBackgroundColor(),"dcg-no-hyperlinks":!this.controller.getAllowLinks()}),style:()=>({"font-size":`${this.controller.getFontSize()}px`,background:this.controller.getBackgroundColor(),color:this.controller.getTextColor(),filter:this.controller.getInvertedColors()?"invert(100%)":"none"})},Hr.createElement(_0,{controller:this.props.controller}),Hr.createElement(O0,{predicate:()=>this.controller.isScientificCalc()&&this.model.isSingleExpression()},()=>Hr.createElement("div",null,Hr.createElement(CL,{controller:this.props.controller}),Hr.createElement("div",{class:Hr.const("dcg-basic-keypad-container")},EL(()=>this.controller.renderAsBraille(),{true:()=>Hr.createElement(Ab,{controller:this.props.controller}),false:()=>Hr.createElement(k0,{controller:this.props.controller})})))),Hr.createElement(O0,{predicate:()=>this.controller.isScientificCalc()&&!this.model.isSingleExpression()},()=>Hr.createElement("div",null,Hr.createElement(vL,{controller:this.props.controller}),Hr.createElement("div",{class:Hr.const("dcg-basic-keypad-container")},EL(()=>this.controller.renderAsBraille(),{true:()=>Hr.createElement(Ab,{controller:this.props.controller}),false:()=>Hr.createElement(L0,{controller:this.props.controller})})))),Hr.createElement(O0,{predicate:()=>this.controller.isFourFunctionCalc()&&this.model.isSingleExpression()},()=>Hr.createElement("div",null,Hr.createElement(wL,{controller:this.props.controller}),Hr.createElement("div",{class:Hr.const("dcg-basic-keypad-container")},EL(()=>this.controller.renderAsBraille(),{true:()=>Hr.createElement(Ab,{controller:this.props.controller}),false:()=>Hr.createElement(D0,{controller:this.props.controller})})))),Hr.createElement(O0,{predicate:()=>this.controller.isFourFunctionCalc()&&!this.model.isSingleExpression()},()=>Hr.createElement("div",null,Hr.createElement(yL,{controller:this.props.controller}),Hr.createElement("div",{class:Hr.const("dcg-basic-keypad-container")},EL(()=>this.controller.renderAsBraille(),{true:()=>Hr.createElement(Ab,{controller:this.props.controller}),false:()=>Hr.createElement(S0,{controller:this.props.controller})}))))))))}didMountRoot(e){rh(e)}handleRootKeydown(e){let t=ji(e),i=this.controller.model;if(tf(e))return this.dispatch({type:"undo",source:"keyboard-shortcut"}),!1;if(rf(e))return this.dispatch({type:"redo",source:"keyboard-shortcut"}),!1;if(e.altKey!==Ti&&e.metaKey===Ti&&!e.ctrlKey&&e.shiftKey&&t==="A"&&this.controller.getDecimalToFraction()){let o=i.getFocusedExpression();o&&i.canDisplayEvaluationAsFraction(o.id)&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"toggle-fraction-evaluation",id:o.id}),this.controller.runAfterDispatch(()=>{i.getFocusedExpression().displayAsFraction?Te(this.controller.s("shared-calculator-narration-show-as-fraction")):Te(this.controller.s("shared-calculator-narration-show-as-decimal"))}))}else if(!e.metaKey&&!e.shiftKey){if(!e.ctrlKey&&!e.altKey&&Be(e)===Nc){if(!document.activeElement||ug(document.activeElement))return!1}else if(e.ctrlKey===Ti&&e.altKey===!Ti){if(t==="N")return this.controller.getBrailleControls()?(this.dispatch({type:"set-braille-mode",mode:"nemeth"}),Te(this.controller.s("shared-calculator-narration-hotkey-braille-mode-nemeth")),!1):void 0;if(t==="U")return this.controller.getBrailleControls()?(this.dispatch({type:"set-braille-mode",mode:"ueb"}),Te(this.controller.s("shared-calculator-narration-hotkey-braille-mode-ueb")),!1):void 0;if(t==="Q"||t==="X")return this.controller.getBrailleControls()?(this.dispatch({type:"set-braille-mode",mode:"none"}),Te(this.controller.s("shared-calculator-narration-hotkey-braille-mode-off")),!1):void 0;if(t==="6"){if(!this.controller.getBrailleControls())return;let o=!this.controller.getSixKeyInput();return this.dispatch({type:"set-six-key-input",useSixKeyInput:o}),Te(o?this.controller.s("basic-calculator-narration-hotkey-six-key-input-on"):this.controller.s("basic-calculator-narration-hotkey-six-key-input-off")),!1}else if(t==="D")return this.controller.isScientificCalc()?(e.preventDefault(),this.controller.dispatch({type:"degrees"}),Te(i.getDegreeMode()?this.controller.s("basic-calculator-narration-controlbar-degrees"):this.controller.s("basic-calculator-narration-controlbar-radians")),!1):void 0}}return!0}};var bv=class extends Tb{constructor(e){super(e)}init(e){e=__dcg_shared_module_exports__['Z'](e),e.backgroundColor&&!__dcg_shared_module_exports__['O'](e.backgroundColor)&&(__dcg_shared_module_exports__['M'].warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)"),delete e.backgroundColor),e.textColor&&!__dcg_shared_module_exports__['O'](e.textColor)&&(__dcg_shared_module_exports__['M'].warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)"),delete e.textColor);let t={language:"en",qwertyKeyboard:!0,links:!0,degreeMode:!1,settingsMenu:!0,invertedColors:!1,backgroundColor:"#fff",textColor:"#000",brailleMode:"none",sixKeyInput:!1,brailleControls:!0,brailleExpressionDownload:!0,projectorMode:!1,capExpressionSize:!1,functionDefinition:!0,autosize:!0,evaluationMode:"scientific",restrictedEditing:!1,additionalFunctions:["sqrt"],typingSlashWritesDivisionSymbol:!1,typingAsteriskWritesTimesSymbol:!1,decimalToFraction:!0,replaceCommaWith10Exp:!1,replaceRoundWithReciprocal:!1,...e};this.settings=new Yr;let i={workerPool:Jw,settingsProxy:this.settings};this.controller=new v0(t,i),this.controller.onEventEmitted=o=>{o==="render"&&this.updateView(),this.triggerEvent(o,void 0)},this.setupDomChangeDetector(t.autosize)}onCreateView(){return yv.mountToNode(R0,this.rootElt,{controller:yv.const(this.controller)})}setState(e,t){t||(t={}),this.controller.dispatch({type:"set-state-from-api",state:e,opts:{allowUndo:!!t.allowUndo}})}getState(){return __dcg_shared_module_exports__['Z'](this.controller.model.getPersistedState())}undo(){this.controller.dispatch({type:"undo",source:"api"})}redo(){this.controller.dispatch({type:"redo",source:"api"})}clearHistory(){this.controller.dispatch({type:"clear-history"})}setBlank(e){e||(e={}),this.controller.dispatch({type:"set-blank",opts:{allowUndo:!!e.allowUndo}})}updateSettings(e){if(e!=null)for(let t in e)switch(t){case"fontSize":let i=e[t];if(i===void 0)continue;this.controller.dispatch({type:"update-font-size",size:i});break;case"invertedColors":let o=e[t];if(o===void 0)continue;this.controller.dispatch({type:"update-inverted-colors",mode:o});break;case"backgroundColor":let n=e[t];if(n===void 0||!__dcg_shared_module_exports__['O'](n)){__dcg_shared_module_exports__['M'].warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)");continue}this.controller.dispatch({type:"update-background-color",color:n});break;case"textColor":let a=e[t];if(a===void 0||!__dcg_shared_module_exports__['O'](a)){__dcg_shared_module_exports__['M'].warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)");continue}this.controller.dispatch({type:"update-text-color",color:a});break;case"degreeMode":let s=e[t];if(s===void 0)continue;this.controller.dispatch({type:"update-degree-mode",mode:s});break;case"brailleMode":let l=e[t];this.controller.dispatch({type:"set-braille-mode",mode:l});break;case"sixKeyInput":let c=e[t];if(c===void 0)continue;this.controller.dispatch({type:"set-six-key-input",useSixKeyInput:c});break;case"brailleControls":{let C=e[t];if(C===void 0)continue;this.controller.dispatch({type:"set-braille-controls",value:C});break}case"brailleExpressionDownload":let d=e[t];if(d===void 0)continue;this.controller.dispatch({type:"set-braille-expression-download",mode:d});break;case"projectorMode":let p=e[t];if(p===void 0)continue;this.controller.dispatch({type:"update-projector-mode",mode:p});break;case"capExpressionSize":let g=e[t];if(g===void 0)continue;this.controller.dispatch({type:"update-cap-expression-size",mode:g});break;case"language":let h=e[t];if(h===void 0)continue;this.controller.dispatch({type:"update-language",language:Cu(h)});break;case"settingsMenu":e.settingsMenu?this.controller.dispatch({type:"enable-settings-menu"}):this.controller.dispatch({type:"disable-settings-menu"});break;case"qwertyKeyboard":{this.controller.dispatch({type:"update-options",options:{qwertyKeyboard:!!e.qwertyKeyboard}});let C=this.controller.getKeyboardMode();(C==="qwerty"||C==="letters")&&this.controller.dispatch({type:"ABC"})}break;case"functionDefinition":e.functionDefinition?this.controller.model.enableFunctionDefinition():this.controller.model.disableFunctionDefinition();break;case"links":this.controller.dispatch({type:"update-options",options:{links:!!e.links}});break;case"decimalToFraction":let f=e[t];if(f===void 0)continue;this.controller.dispatch({type:"update-decimal-to-fraction",mode:f});break;case"replaceCommaWith10Exp":let y=e[t];if(y===void 0)continue;this.controller.dispatch({type:"set-replace-comma-with-10-exp",replace:y});break;case"replaceRoundWithReciprocal":let x=e[t];if(x===void 0)continue;this.controller.dispatch({type:"set-replace-round-with-reciprocal",replace:x});break;case"restrictedEditing":{this.controller.dispatch({type:"update-options",options:{restrictedEditing:!!e.restrictedEditing}});break}case"typingAsteriskWritesTimesSymbol":let E=e[t];if(E===void 0)continue;this.controller.dispatch({type:"set-typing-asterisk-writes-times-symbol",mode:E});break}}focusFirstExpression(){this.controller.dispatch({type:"focus-first-expression"})}onResizeView(e){this.controller.dispatch({type:"ui/container-resized",size:e})}onDestroyView(){yv.unmountFromNode(this.rootElt)}destroy(){this.controller.model.destroy(),super.destroy()}};var xv=class extends bv{constructor(e,t){super(e),this.init(Yme(t||{}))}};function Yme(r){if(r=__dcg_shared_module_exports__['Z'](r),r.hasOwnProperty("typingSlashWritesDivisionSymbol")||(r.typingSlashWritesDivisionSymbol=!0),r.hasOwnProperty("typingAsteriskWritesTimesSymbol")||(r.typingAsteriskWritesTimesSymbol=!0),r.exponentButtonForSquareRoot&&(__dcg_shared_module_exports__['M'].warn(`As of API version 1.0, the 'exponentButtonForSquareRoot' option is deprecated.Use 'additionalFunctions: "exponent"' instead.`),r.additionalFunctions=["exponent"]),r.additionalFunctions){var e=r.additionalFunctions;typeof e=="string"&&(e=[e]),e.length>2&&(__dcg_shared_module_exports__['M'].warn("additionalFunctions can only take up to 2 new functions. Using the first two."),e=e.slice(0,2));let i=!0;for(var t=0;t<e.length;t++)["sqrt","exponent","percent","fraction"].indexOf(e[t])===-1&&(__dcg_shared_module_exports__['M'].warn("Unrecognized value: '"+e[t]+`' for 'additionalFunction'. Valid values are 'sqrt', 'percent', 'exponent', or 'fraction'. Using default ("sqrt")`),i=!1);r.additionalFunctions=i?e:["sqrt"]}return(!r.additionalFunctions||!r.additionalFunctions.length)&&(r.additionalFunctions=["sqrt"]),r.singleExpression?r.evaluationMode="singleExpressionFourFunction":r.evaluationMode="fourFunction",delete r.singleExpression,r.hasOwnProperty("decimalToFraction")||(r.decimalToFraction=!1),r.language&&(r.language=Cu(r.language)),r}var wv=class extends bv{constructor(e,t){super(e),this.init(Xme(t||{}))}};function Xme(r){return r=__dcg_shared_module_exports__['Z'](r),r.singleExpression?r.evaluationMode="singleExpressionScientific":r.evaluationMode="scientific",delete r.singleExpression,r.language&&(r.language=Cu(r.language)),r}var Cv=__dcg_shared_module_exports__['e'](te());var F0=class{constructor(e){this.keypadType="scientific";this.projectorMode="none";this.scientificKeyboardMode="main";this.dispatcher=new iu;this.s=uc(()=>"en");this.dispatch=e=>{this.dispatcher.dispatch(e);let t;for(;t=this._queuedCallbacks.shift();)t()};this._queuedCallbacks=[];var t,i;this.keypadType=(t=e==null?void 0:e.keypadType)!=null?t:"scientific",this.projectorMode=(i=e==null?void 0:e.projectorMode)!=null?i:"none",this.dispatcher=new iu,this.hookUpDispatcher()}getBackgroundColor(){return"does-not-matter"}runAfterDispatch(e){this._queuedCallbacks.push(e)}enqueueEvent(e){this.runAfterDispatch(()=>{this.onEventEmitted&&this.onEventEmitted(e)})}getKeypadType(){return this.keypadType}getProjectorMode(){return this.projectorMode}getScientificKeyboardMode(){return this.scientificKeyboardMode}updateKeyboardMode(e){this.scientificKeyboardMode=e}typeIntoFocusedMathquill(e){e=e.replace(/\r|\n/g,"");let t=this.activeMQ;t&&(t.typedText(e),Ze.simulateUserChangedLatex(t))}pressKeyInFocusedMathquill(e,t){let i=this.activeMQ;if(i){if(e==="Enter"){t&&(t.preventDefault(),t.stopPropagation()),this.enqueueEvent("enter");return}i.keystroke(e,t)}}executeCommandInFocusedMathquill(e){let t=this.activeMQ;t&&Xx(t,e,{capExpressionSize:!1})}hookUpDispatcher(){this.dispatcher.register(e=>{switch(this.enqueueEvent("render"),e.type){case"hide-keypad":this.enqueueEvent("hide-keypad");break;case"set-active-mq":this.activeMQ=e.mq;break;case"set-keypad-type":this.keypadType=e.keypadType;break;case"keypad/shift":this.updateKeyboardMode(this.scientificKeyboardMode==="capitalQwerty"?"qwerty":"capitalQwerty");break;case"main":this.updateKeyboardMode("main");break;case"ABC":this.updateKeyboardMode("qwerty");break;case"functions":this.updateKeyboardMode("functions");break;case"keypad/type-text":this.typeIntoFocusedMathquill(e.text);break;case"keypad/press-key":this.pressKeyInFocusedMathquill(e.key,e.evt);break;case"keypad/custom-command":this.executeCommandInFocusedMathquill(e.command);break;case"keypad/123":case"keypad/abc":case"keypad/audio-trace":break;default:return e}})}};var Tn=__dcg_shared_module_exports__['e'](te());var VQ=__dcg_shared_module_exports__['e'](te()),is=class extends VQ.Class{init(){this.controller=this.props.controller(),this.dispatch=this.controller.dispatch,this.s=this.controller.s}};var qn=__dcg_shared_module_exports__['e'](te());var SL=class extends is{template(){return qn.createElement(Er,{controller:this.props.controller},qn.createElement(je,null,k(this,"a^2"),k(this,"a^b"),k(this,"|a|"),k(this,"a/b"),qn.createElement("div",{class:qn.const("dcg-partition-placeholder")}),k(this,"7",{style:"highlight"}),k(this,"8",{style:"highlight"}),k(this,"9",{style:"highlight"}),k(this,"/"),qn.createElement("div",{class:qn.const("dcg-partition-placeholder")}),k(this,"x"),k(this,"y")),qn.createElement(je,null,k(this,"("),k(this,")"),k(this,"<"),k(this,">"),qn.createElement("div",{class:qn.const("dcg-partition-placeholder")}),k(this,"4",{style:"highlight"}),k(this,"5",{style:"highlight"}),k(this,"6",{style:"highlight"}),k(this,"*"),qn.createElement("div",{class:qn.const("dcg-partition-placeholder")}),k(this,"left",{style:"highlight"}),k(this,"right",{style:"highlight"})),qn.createElement(je,null,k(this,"sqrt"),k(this,","),k(this,"<="),k(this,">="),qn.createElement("div",{class:qn.const("dcg-partition-placeholder")}),k(this,"1",{style:"highlight"}),k(this,"2",{style:"highlight"}),k(this,"3",{style:"highlight"}),k(this,"-"),qn.createElement("div",{class:qn.const("dcg-partition-placeholder")}),Jr(.5),k(this,"backspace",{style:"highlight",colspan:1.5})),qn.createElement(je,null,k(this,"nthroot"),k(this,"pi"),k(this,"%"),k(this,"a_b"),qn.createElement("div",{class:qn.const("dcg-partition-placeholder")}),k(this,"0",{style:"highlight"}),k(this,".",{style:"highlight"}),k(this,"="),k(this,"+"),qn.createElement("div",{class:qn.const("dcg-partition-placeholder")}),k(this,"enter",{colspan:2,style:"blue"})))}};var hp=__dcg_shared_module_exports__['e'](te());var DL=class extends is{template(){return hp.createElement(Er,{controller:this.props.controller},hp.createElement(je,null,k(this,"q"),k(this,"w"),k(this,"e"),k(this,"r"),k(this,"t"),k(this,"y"),k(this,"u"),k(this,"i"),k(this,"o"),k(this,"p")),hp.createElement(je,null,hp.createElement("div",{class:hp.const("dcg-half-width-placeholder")}),k(this,"a"),k(this,"s"),k(this,"d"),k(this,"f"),k(this,"g"),k(this,"h"),k(this,"j"),k(this,"k"),k(this,"l"),hp.createElement("div",{class:hp.const("dcg-half-width-placeholder")})),hp.createElement(je,null,k(this,"shift",{style:"highlight"}),k(this,"z"),k(this,"x"),k(this,"c"),k(this,"v"),k(this,"b"),k(this,"n"),k(this,"m"),k(this,":"),k(this,"backspace",{style:"highlight"})),hp.createElement(je,null,k(this,"~"),k(this,"{"),k(this,"}"),k(this,"["),k(this,"]"),k(this,"\xB1"),k(this,"'"),k(this,"obelus"),k(this,"enter",{style:"blue"})))}};var gp=__dcg_shared_module_exports__['e'](te());var kL=class extends is{template(){return gp.createElement(Er,{controller:this.props.controller},gp.createElement(je,null,k(this,"Q"),k(this,"W"),k(this,"E"),k(this,"R"),k(this,"T"),k(this,"Y"),k(this,"U"),k(this,"I"),k(this,"O"),k(this,"P")),gp.createElement(je,null,gp.createElement("div",{class:gp.const("dcg-half-width-placeholder")}),k(this,"A"),k(this,"S"),k(this,"D"),k(this,"F"),k(this,"G"),k(this,"H"),k(this,"J"),k(this,"K"),k(this,"L"),gp.createElement("div",{class:gp.const("dcg-half-width-placeholder")})),gp.createElement(je,null,k(this,"shift",{style:"highlight"}),k(this,"Z"),k(this,"X"),k(this,"C"),k(this,"V"),k(this,"B"),k(this,"N"),k(this,"M"),k(this,","),k(this,"backspace",{style:"highlight"})),gp.createElement(je,null,k(this,"="),k(this,"("),k(this,")"),k(this,"["),k(this,"]"),k(this,"\xB1"),k(this,"'"),k(this,"obelus"),k(this,"enter",{style:"blue"})))}};var _l=__dcg_shared_module_exports__['e'](te());var GL=class extends is{template(){return _l.createElement(Er,{controller:this.props.controller},_l.createElement(je,null,k(this,"sin"),k(this,"cos"),k(this,"tan"),_l.createElement("div",{class:_l.const("dcg-partition-placeholder")}),k(this,"ln"),k(this,"log"),k(this,"backspace",{style:"highlight"})),_l.createElement(je,null,k(this,"arcsin"),k(this,"arccos"),k(this,"arctan"),_l.createElement("div",{class:_l.const("dcg-partition-placeholder")}),k(this,"e^x"),k(this,"abs"),k(this,"round")),_l.createElement(je,null,k(this,"mean"),k(this,"stdev"),k(this,"stdevp"),_l.createElement("div",{class:_l.const("dcg-partition-placeholder")}),k(this,"a^b"),k(this,"sqrt"),k(this,"nthroot")),_l.createElement(je,null,k(this,"nPr"),k(this,"nCr"),k(this,"!"),_l.createElement("div",{class:_l.const("dcg-partition-placeholder")}),k(this,"e"),k(this,"%"),k(this,"enter",{style:"blue"})))}};var nl=__dcg_shared_module_exports__['e'](te());var TL=class extends is{template(){return nl.createElement(Er,{controller:this.props.controller},nl.createElement(je,null,k(this,"1",{style:"highlight"}),k(this,"2",{style:"highlight"}),k(this,"3",{style:"highlight"}),k(this,"4",{style:"highlight"}),k(this,"5",{style:"highlight"}),k(this,"6",{style:"highlight"}),k(this,"7",{style:"highlight"}),k(this,"8",{style:"highlight"}),k(this,"9",{style:"highlight"}),k(this,"0",{style:"highlight"}),nl.createElement("div",{class:nl.const("dcg-partition-placeholder")}),k(this,"left",{style:"highlight"}),k(this,"right",{style:"highlight"}),nl.createElement("div",{class:nl.const("dcg-inline-hide-keypad-button"),"dcg-command":nl.const("hide-keypad"),onTap:()=>this.props.controller().dispatch({type:"hide-keypad"})},nl.createElement("div",{class:nl.const("dcg-inline-hide-keypad-button-inner")},nl.createElement("i",{class:nl.const("dcg-icon-hide"),"aria-hidden":nl.const("true")})))),nl.createElement(je,null,Jr(2),k(this,"."),k(this,"="),k(this,"+"),k(this,"-"),k(this,"multiplication"),k(this,"obelus"),Jr(3),k(this,"backspace",{style:"highlight",colspan:1.5}),Jr(1)),nl.createElement(je,null,Jr(2),k(this,"a/b"),k(this,","),k(this,"("),k(this,")"),k(this,"<"),k(this,">"),Jr(2.5),k(this,"enter",{colspan:2,style:"blue"}),Jr(1)))}};var Dd=__dcg_shared_module_exports__['e'](te());var ML=class extends is{template(){let r=this.props.controller();return Dd.createElement(Vc,{controller:this.props.controller},Dd.createElement(Ri,{command:this.const("main"),selected:()=>r.getScientificKeyboardMode()==="main",ignoreInTabOrder:this.const(!0),selectable:this.const(!0),onTap:()=>r.dispatch({type:"main"})},()=>r.s("basic-calculator-button-controlbar-main")),Dd.createElement(Ri,{command:this.const("ABC"),selected:()=>["qwerty","capitalQwerty"].indexOf(r.getScientificKeyboardMode())!==-1,ignoreInTabOrder:this.const(!0),selectable:this.const(!0),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-abc"),onTap:()=>r.dispatch({type:"ABC"})},()=>r.s("basic-calculator-button-controlbar-abc")),Dd.createElement(Ri,{command:this.const("functions"),selected:()=>["functions","restrictedFunctions"].indexOf(r.getScientificKeyboardMode())!==-1,ariaLabel:()=>r.s("basic-calculator-narration-controlbar-functions"),ignoreInTabOrder:this.const(!0),selectable:this.const(!0),onTap:()=>r.dispatch({type:"functions"})},()=>r.s("shared-calculator-button-controlbar-functions")),Dd.createElement("div",{class:Dd.const("dcg-hide-keypad-button"),"dcg-command":Dd.const("hide-keypad"),onTap:()=>r.dispatch({type:"hide-keypad"})},Dd.createElement("i",{class:Dd.const("dcg-icon-hide"),"aria-hidden":Dd.const("true")})))}};var{Switch:Jme,SwitchUnion:Qme}=Tn.Components,IL=class extends is{template(){return Tn.createElement("div",{class:Tn.const("dcg-calculator-api-container"),style:()=>"width: 100%; height: 100%; position: relative;"},Tn.createElement("div",{class:Tn.const("dcg-do-not-blur dcg-container dcg-api-shared-keypad-root"),didMount:this.bindFn(this.didMountRoot)},this.children))}didMountRoot(e){rh(e)}},wN=class extends is{template(){return Tn.createElement(IL,{...this.props},Tn.createElement("div",{class:()=>({"dcg-fourfunction-keypad-container":!0,"dcg-projector-mode":this.props.controller().getProjectorMode()!=="none","dcg-classroom-large-projector-mode":this.props.controller().getProjectorMode()==="large"}),role:Tn.const("region"),"aria-label":()=>this.s("shared-calculator-narration-keypad")},Tn.createElement(TL,{controller:this.props.controller})))}},vN=class extends is{template(){return Tn.createElement(IL,{...this.props},Tn.createElement("div",{class:()=>({"dcg-scientific-keypad-container":!0,"dcg-projector-mode":this.props.controller().getProjectorMode()!=="none","dcg-classroom-large-projector-mode":this.props.controller().getProjectorMode()==="large"})},Tn.createElement(ML,{controller:this.props.controller}),Tn.createElement("div",{role:Tn.const("group"),"aria-label":()=>this.s("shared-calculator-narration-keypad")},Tn.createElement(Jme,{key:()=>this.controller.getScientificKeyboardMode()},e=>{switch(e){case"qwerty":return Tn.createElement(DL,{controller:this.props.controller});case"capitalQwerty":return Tn.createElement(kL,{controller:this.props.controller});case"functions":return Tn.createElement(GL,{controller:this.props.controller});default:return Tn.createElement(SL,{controller:this.props.controller})}}))))}},AL=class extends is{template(){return Qme(()=>this.controller.getKeypadType(),{fourfunction:()=>Tn.createElement(wN,{...this.props}),scientific:()=>Tn.createElement(vN,{...this.props})})}};var vv=class extends Tb{constructor(e,t){super(e),this.init(t)}init(e){this.controller=new F0(e),this.controller.onEventEmitted=t=>{t==="render"&&this.updateView(),this.triggerEvent(t,void 0)},this.setupDomChangeDetector(!0)}setActiveMathquill(e){this.controller.dispatch({type:"set-active-mq",mq:e})}setKeypadType(e){this.controller.dispatch({type:"set-keypad-type",keypadType:e})}onCreateView(){return Cv.mountToNode(AL,this.rootElt,{controller:Cv.const(this.controller)})}onResizeView(e){}onDestroyView(){Cv.unmountFromNode(this.rootElt)}destroy(){super.destroy()}};var Lm=class extends zh{constructor(e,t,i){super(e,{...t,product:"geometry-calculator"},i),this.setState(Vx),this.clearHistory()}};var Zme=__dcg_shared_module_exports__['e'](te());Rc();var N0;typeof Desmos!="undefined"?N0=Desmos:(N0={},window.Desmos=N0);var efe={SMALL:"0.85",MEDIUM:"1",LARGE:"1.35"};function CN(...r){return new Eu(...r)}CN.prototype=Eu.prototype;function EN(...r){return new Lm(...r)}EN.prototype=Lm.prototype;function SN(...r){return new pv(...r)}SN.prototype=pv.prototype;function LQ(...r){return new xv(...r)}LQ.prototype=xv.prototype;function PQ(...r){return new wv(...r)}PQ.prototype=wv.prototype;function _Q(...r){return new vv(...r)}_Q.prototype=vv.prototype;var Vb={Colors:{RED:BG,BLUE:UG,GREEN:zG,ORANGE:qG,PURPLE:KG,BLACK:HG},imageFileToDataURL:XA,supportedLanguages:["en"].concat(typeof desmosLocaleData=="object"?Object.keys(desmosLocaleData):[]),Styles:{...C3,...v3},ColumnModes:ZS,DragModes:E3,AxisArrowModes:__dcg_shared_module_exports__['L'],FontSizes:jA,LabelSizes:efe,LabelOrientations:S3,GraphingCalculator:CN,Calculator:CN,FourFunctionCalculator:LQ,ScientificCalculator:PQ,Geometry:EN,Abraham:tu,Private:{Abraham:tu,Mathtools:e1,Graphtools:{ScalePair:__dcg_shared_module_exports__['_c'],getClippingGraphType:VC,mapSegmentToCanvas:Ig,computeDrawingCommandsForDOMLabel:GT,drawCommandsToCtx:TT},MathquillConfig:{getAutoCommands:Hp,getAutoOperators:Wp},Parser:__dcg_shared_module_exports__['Bd'],extractSliderValueFromLatex:iC,__compareBranches:{getSliderMin:hc,getSliderMax:Rd,valueTypes:__dcg_shared_module_exports__['$a'],migrateGeoStateToCalcState:fh,Mathtools:e1},GeometryBeta:EN,migrateGeoStateToCalcState:fh,HeadlessGraphingCalculator:SN,maybeNotifyUserChangedLatex:Ze.simulateUserChangedLatex,Fragile:{DCGView:Zme,PromptSliderView:op,Checkbox:xt,SegmentedControl:Xi,MathquillView:Ze,InlineMathInputView:_r,StaticMathquillView:lt,Tooltip:$e,ExpressionOptionsMenuView:Ow,ExpressionView:hb,ImageIconView:gb,evaluateLatex:Bi,Keys:Ur,getQueryParams:tn,getReconciledExpressionProps:__dcg_shared_module_exports__['Ic'],List:{moveItemsTo:Mg,removeItemById:sx},currentLanguage:Yv}},TestInternal:{subscribeToSharedClockBus:r=>Il(r),getCalcConfigAll:()=>ok(),fetchLanguage:r=>vy(r)},MathQuill:Zc,PillowKeypad:_Q,HeadlessGraphingCalculator:SN};function DN(r){var e=N0.enabledFeatures;return!e||e[r]}function LL(r){Vb[r]=function(){throw new Error("The Desmos "+r+" is not enabled for this API key.")}}DN("GraphingCalculator")||(LL("GraphingCalculator"),LL("Calculator"));DN("FourFunctionCalculator")||LL("FourFunctionCalculator");DN("ScientificCalculator")||LL("ScientificCalculator");for(VL in Vb)Vb.hasOwnProperty(VL)&&(N0[VL]=Vb[VL]);var VL;var ht=__dcg_shared_module_exports__['e'](te());function OQ(r){let e=r.split(","),t=e[0].match(/:(.*?);/),i=t!==null?t[1]:"",o=e[1]!==null?atob(e[1]):"",n=o.length,a=new Uint8Array(n);for(;n--;)a[n]=o.charCodeAt(n);return new Blob([a],{type:i})}function RQ(r){if(r.indexOf("xmlns=")===-1)throw new Error('Programming error: <svg> elements require the "xmlns" attribute to render properly');return new Blob([r],{type:"image/xml+svg;charset=utf-8"})}var fa=__dcg_shared_module_exports__['e'](te());qt();var{If:tfe,For:rfe,IfElse:ife}=fa.Components,B0=class extends fa.Class{init(){var e,t;this.controller=this.props.controller(),this.filter=(t=(e=this.props).defaultValue)==null?void 0:t.call(e),this.shouldShowResults=!1}template(){return fa.createElement("div",{class:fa.const("dcg-dropdown-container"),onKeydown:this.bindFn(this.onKeydown),didMount:this.bindFn(this.attachTapListener),didUnmount:this.bindFn(this.unmountTapListener),id:()=>`dcg-dropdown-container-${this.props.id()}`},fa.createElement("button",{class:()=>({"dcg-dropdown-input":!0,"dcg-results-hidden":!this.showResults()}),"aria-haspopup":this.const("listbox"),"aria-expanded":()=>this.showResults(),manageFocus:this.const({shouldBeFocused:this.bindFn(this.shouldFilterBeFocused),onFocusedChanged:this.bindFn(this.onFilterFocusChange)}),onTap:this.bindFn(this.toggleShowResults),didMount:e=>{var t,i;(i=(t=this.props).focusOnMount)!=null&&i.call(t)&&e.focus()},id:this.props.id},()=>this.getFilterString(),ife(()=>this.showResults(),{true:()=>fa.createElement("i",{class:fa.const("dcg-icon-caret-up dcg-open-options"),"aria-label":()=>this.controller.s("shared-calculator-button-hide-options")}),false:()=>fa.createElement("i",{class:fa.const("dcg-icon-caret-down dcg-open-options"),"aria-label":()=>this.controller.s("shared-calculator-button-show-options")})})),fa.createElement(tfe,{predicate:()=>this.showResults()},()=>fa.createElement(rfe,{each:()=>this.props.options(),key:e=>e.id+"-"+e.label},fa.createElement("ul",{class:fa.const("dcg-dropdown-list"),role:fa.const("listbox"),"aria-label":()=>this.controller.s("shared-calculator-label-dropdown-options")},e=>fa.createElement("li",{class:()=>({"dcg-dropdown-option":!0,"dcg-is-selected":e.label===this.getFilterString()}),role:fa.const("option"),"aria-selected":()=>e.label===this.getFilterString(),onTap:()=>this.selectOption(e),manageFocus:this.const({shouldBeFocused:()=>this.shouldOptionBeFocused(e),onFocusedChanged:t=>this.onOptionFocusChange(e,t)}),tabindex:fa.const(0)},this.const(e.label))))))}showResults(){return!!this.shouldShowResults}shouldFilterBeFocused(){return this.focusLocation&&this.focusLocation.type==="filter"}onFilterFocusChange(e){e?this.focusFilter():(this.focusLocation=void 0,this.update())}shouldOptionBeFocused(e){return this.focusLocation&&this.focusLocation.type==="option"&&this.focusLocation.id===e.id}focusFilter(){this.focusLocation={type:"filter"},this.update()}toggleShowResults(){if(this.shouldShowResults)this.shouldShowResults=!1,this.focusFilter();else if(this.shouldShowResults=!0,this.filter){let e=this.props.options().find(t=>t.id===this.filter);this.focusOption(e)}else if(this.props.externalControl){let e=this.props.externalControl().getValue(),t=this.props.options().find(i=>i.label===e);this.focusOption(t)}else this.focusFirstOption();this.update()}focusOption(e){e&&(this.focusLocation={type:"option",id:e.id},this.update())}getFocusedOptionIndex(){if(!this.focusLocation||this.focusLocation.type!=="option")return-1;let e=this.focusLocation.id,t=this.props.options();for(let i=0;i<t.length;i++)if(t[i].id===e)return i;return-1}onOptionFocusChange(e,t){t?this.focusOption(e):(this.focusLocation=void 0,this.update())}onKeydown(e){switch(Be(e)){case un:this.moveFocusInDirection(-1)&&e.preventDefault();break;case hn:this.showResults()?this.moveFocusInDirection(1)&&e.preventDefault():(this.toggleShowResults(),e.preventDefault());break;case Dp:e.preventDefault(),this.focusLastOption();break;case cl:this.showResults()&&(e.preventDefault(),this.selectFocusedOption());break;case rn:this.showResults()&&(e.preventDefault(),e.stopPropagation(),this.toggleShowResults());break}}moveFocusInDirection(e){let t=this.props.options(),i=this.getFocusedOptionIndex();if(i===-1)return!1;let o=i+e;if(o==-1||o==t.length)return!0;let n=t[o];return n?(this.focusOption(n),!0):!1}focusFirstOption(){let e=this.props.options();e.length!==0&&this.focusOption(e[0])}focusLastOption(){let e=this.props.options();e.length!==0&&this.focusOption(e[e.length-1])}onInputChange(e){this.props.externalControl?this.props.externalControl().onValueChange(e):this.filter=e,this.update()}getFilterString(){if(this.props.externalControl)return this.props.externalControl().getValue();let t=this.props.options().find(i=>i.id===this.filter);return(t==null?void 0:t.label)||""}selectFocusedOption(){if(!this.focusLocation||this.focusLocation.type!=="option")return;let e=this.focusLocation.id,i=this.props.options().find(o=>o.id===e);this.selectOption(i)}selectOption(e){var t,i;e&&(this.onInputChange(e.id),this.focusFilter(),this.shouldShowResults=!1,this.update(),(i=(t=this.props).onChange)==null||i.call(t,e.id))}unmountTapListener(){ie(document.body).off("dcg-tapstart.dcg-dropdown-container")}attachTapListener(){ie(document.body).on("dcg-tapstart.dcg-dropdown-container",this.bindFn(this.tapListener))}tapListener(e){e.target.closest(`#dcg-dropdown-container-${this.props.id()}`)||(this.focusLocation=void 0,this.shouldShowResults=!1,this.update())}};var{If:$h,IfElse:FQ}=ht.Components,Iu={};Iu.small_square={width:160,height:160,name:r=>r.s("account-shell-label-export-size-small-square")};Iu.medium_square={width:400,height:400,name:r=>r.s("account-shell-label-export-size-medium-square")};Iu.large_square={width:1e3,height:1e3,name:r=>r.s("account-shell-label-export-size-large-square")};Iu.medium_rectangle={width:600,height:400,name:r=>r.s("account-shell-label-export-size-medium-rectangle")};Iu.large_rectangle={width:1200,height:800,name:r=>r.s("account-shell-label-export-size-large-rectangle")};Iu={...Iu,...Yg};var U0=class extends ht.Class{init(){this.controller=this.props.controller(),this.thickness="thin";let e=this.controller.api.controller.getBrailleMode();this.brailleMode=e!=="none"?e:"nemeth",this.showDownloadButton=mL(),this.markImagesDirty(),this.loaded=!1,this.exportType=e!=="none"?this.brailleMode:"png",this.size=e!=="none"?"vpmax8":"medium_square"}template(){return ht.createElement(Qo,{title:()=>this.controller.s("account-shell-heading-export-graph"),size:this.const("wide"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},ht.createElement("div",{id:ht.const("export-image-dialog")},ht.createElement("div",{class:ht.const("dcg-offscreen-calculator"),didMount:this.bindFn(this.didMountOffscreenCalc),willUnmount:this.bindFn(this.willUnmountOffscreenCalc),"aria-hidden":ht.const("true")}),ht.createElement("div",{class:ht.const("dcg-columns")},ht.createElement("div",{class:ht.const("dcg-left-column")},ht.createElement("div",{class:()=>({"dcg-graph-preview":!0,"dcg-preview-loading":this.pngDirty})},ht.createElement($h,{predicate:()=>this.loaded},()=>ht.createElement("img",{class:ht.const("dcg-graph-image"),didMount:this.bindFn(this.didMountGraphPreview),src:()=>this.previewDataURL,alt:()=>this.controller.s("account-shell-narration-graph-preview")})),ht.createElement($h,{predicate:()=>this.pngDirty},()=>ht.createElement("span",{class:ht.const("dcg-loading-message")},ht.createElement("span",{class:ht.const("dcg-spinner")}),()=>this.controller.s("account-shell-label-loading"))),ht.createElement($h,{predicate:()=>!this.pngDirty&&!this.isExportingBraille()},()=>ht.createElement("span",{class:ht.const("dcg-zoom-percentage")},this.bindFn(this.getZoom))))),ht.createElement("div",{class:ht.const("dcg-right-column")},ht.createElement("div",{class:ht.const("dcg-option-container")},ht.createElement("label",{class:ht.const("dcg-section-title"),for:ht.const("export-graph-type")},()=>this.controller.s("account-shell-heading-file-format")),ht.createElement(B0,{controller:this.bindFn(this.props.controller),options:this.bindFn(this.getExportOptions),onChange:e=>this.setExportType(e),id:this.const("export-graph-type"),defaultValue:()=>this.exportType,focusOnMount:this.const(!0)})),ht.createElement("div",{class:ht.const("dcg-option-container")},ht.createElement("label",{class:ht.const("dcg-section-title"),for:ht.const("export-graph-size")},()=>this.controller.s("account-shell-heading-export-size")),ht.createElement(B0,{controller:this.bindFn(this.props.controller),options:this.bindFn(this.getSizeOptions),id:this.const("export-graph-size"),externalControl:()=>({getValue:()=>Iu[this.size].name(this.controller),onValueChange:e=>this.selectSize(e)})})),ht.createElement($h,{predicate:()=>!this.isExportingBraille()},()=>ht.createElement("div",null,ht.createElement("h2",{class:ht.const("dcg-section-title")},()=>this.controller.s("account-shell-heading-line-thickness")),ht.createElement(Xi,{staticConfig:this.bindFn(this.getLineThicknessOptions),ariaGroupLabel:()=>this.controller.s("account-shell-heading-line-thickness")}))),ht.createElement($h,{predicate:()=>this.isExportingBraille()},()=>ht.createElement("div",{class:ht.const("braille-container")},ht.createElement("h2",{class:ht.const("dcg-section-title")},()=>this.controller.s("account-shell-heading-embossing-instructions")),ht.createElement($h,{predicate:()=>this.size==="vpmax8"||this.size==="vpmax11"},()=>ht.createElement("ul",null,ht.createElement("li",null,()=>this.controller.s("account-shell-text-embossing-vpmax-save")),ht.createElement("li",null,()=>this.controller.s("account-shell-text-embossing-vpmax-print",{size:NQ(this.size)})))),ht.createElement($h,{predicate:()=>this.size==="etc8"||this.size==="etc11"},()=>ht.createElement("ul",null,ht.createElement("li",null,()=>this.controller.s("account-shell-text-embossing-etc-save")),ht.createElement("li",null,()=>this.controller.s("account-shell-text-embossing-etc-print",{size:NQ(this.size)})))),ht.createElement("div",null,ht.createElement(yi,{i18n:this.const(this.controller),key:this.const("graphing-calculator-text-export-braille-email-accessibility")},ht.const("Feedback? Email"),ht.const(" "),ht.createElement("a",{class:ht.const("dcg-blue-link"),href:ht.const("mailto:accessibility@desmos.com")},ht.const("accessibility@desmos.com")),ht.const("."))))),FQ(()=>this.showDownloadButton,{true:()=>ht.createElement("div",{class:ht.const("dcg-export-button-actions")},ht.createElement($h,{predicate:()=>this.isExportingBraille()&&!Sp},()=>ht.createElement(Hh,{buttonType:this.const("secondary"),data:()=>this.brailleBlob,enabled:()=>!this.pngDirty,filename:this.const("desmos-equations.brl"),text:()=>this.controller.s("account-shell-button-download-braille"),triggerLogEvent:()=>xo({category:"share",action:"download-equations",name:`${this.exportType} - ${this.size}`})})),ht.createElement("div",{class:ht.const("dcg-download-button-group")},FQ(()=>this.exportType==="svg",{true:()=>ht.createElement(Hh,{buttonType:this.const("primary"),data:()=>this.svgBlob,enabled:()=>!this.svgDirty,filename:this.const("desmos-graph.svg"),text:()=>this.controller.s("account-shell-button-download-svg"),triggerLogEvent:()=>xo({category:"share",action:"download-image",name:`${this.exportType} - ${this.size}`})}),false:()=>ht.createElement(Hh,{buttonType:this.const("primary"),data:()=>this.previewBlob,enabled:()=>!this.pngDirty,filename:this.const("desmos-graph.png"),text:()=>this.controller.s("account-shell-button-download-png"),triggerLogEvent:()=>xo({category:"share",action:"download-image",name:`${this.exportType} - ${this.size}`})})}))),false:()=>ht.createElement($h,{predicate:()=>!this.isExportingBraille()},()=>ht.createElement("div",{class:ht.const("dcg-download-not-enabled-notice")},ht.createElement("h2",{class:ht.const("dcg-title")},()=>this.controller.s("account-shell-heading-download-instructions")),()=>this.controller.s("account-shell-text-download-instructions")))})))))}getSizeOptions(){return this.isExportingBraille()?[{id:"vpmax8",label:this.controller.s("graphing-calculator-label-braille-size-vpmax8")},{id:"vpmax11",label:this.controller.s("graphing-calculator-label-braille-size-vpmax11")},{id:"etc8",label:this.controller.s("graphing-calculator-label-braille-size-etc8")},{id:"etc11",label:this.controller.s("graphing-calculator-label-braille-size-etc11")}]:[{id:"small_square",label:this.controller.s("account-shell-label-export-size-small-square")},{id:"medium_square",label:this.controller.s("account-shell-label-export-size-medium-square")},{id:"large_square",label:this.controller.s("account-shell-label-export-size-large-square")},{id:"medium_rectangle",label:this.controller.s("account-shell-label-export-size-medium-rectangle")},{id:"large_rectangle",label:this.controller.s("account-shell-label-export-size-large-rectangle")}]}getExportOptions(){return[{id:"png",label:this.controller.s("graphing-calculator-label-png")},{id:"svg",label:this.controller.s("graphing-calculator-label-svg")},{id:"nemeth",label:this.controller.s("graphing-calculator-label-braille-nemeth")},{id:"ueb",label:this.controller.s("graphing-calculator-label-braille-ueb")}]}getLineThicknessOptions(){return[{key:"thin",label:()=>this.controller.s("account-shell-button-line-thin"),selected:()=>this.thickness==="thin",onSelect:()=>this.selectThickness("thin")},{key:"medium",label:()=>this.controller.s("account-shell-button-line-medium"),selected:()=>this.thickness==="medium",onSelect:()=>this.selectThickness("medium")},{key:"thick",label:()=>this.controller.s("account-shell-button-line-thick"),selected:()=>this.thickness==="thick",onSelect:()=>this.selectThickness("thick")}]}didMountOffscreenCalc(e){let i=this.controller.api.controller.isGeometry()?Vb.Geometry:Vb.GraphingCalculator;i&&(this.calculator=i(e,{expressions:!1,keypad:!1,branding:!1,border:!1,enableTabindex:!1}),this.calculator._calc.evaluator.notifyWhenSynced(()=>{this.markImagesDirty(),this.updateIfMounted()}),this.calculator.setState(this.controller.api.getState()))}willUnmountOffscreenCalc(){this.calculator&&this.calculator.destroy()}markImagesDirty(){this.pngDirty=!0,this.svgDirty=!0}selectSize(e){this.size=e,this.markImagesDirty(),this.updateIfMounted()}setExportType(e){PL(e)!==PL(this.exportType)&&(this.size=PL(e)?"vpmax8":"medium_square"),this.exportType=e,this.markImagesDirty(),this.updateIfMounted()}getZoom(){return this.controller.s("account-shell-label-zoom",{value:Math.min(100,Math.round(100*400/this.getWidth()))})}selectThickness(e){this.thickness=e,this.markImagesDirty(),this.updateIfMounted()}didMountGraphPreview(e){this.previewImg=e}getGridOpacity(){switch(this.thickness){case"thick":return 1;case"medium":return .6;case"thin":return .4;default:return this.thickness}}getAxisWeight(){switch(this.thickness){case"thick":return 2;case"medium":return 2;case"thin":return 1.5;default:return this.thickness}}getGraphThickness(){switch(this.thickness){case"thick":return 5;case"medium":return 3.5;case"thin":return 2.5;default:return this.thickness}}getLabelSize(){if(this.size==="small_square")switch(this.thickness){case"thick":return 14;case"medium":return 12;case"thin":return 10;default:return this.thickness}else switch(this.thickness){case"thick":return 20;case"medium":return 17;case"thin":return 14;default:return this.thickness}}updateViewSettings(){if(this.calculator===void 0||this.calculator._calc===void 0||this.calculator._calc.grapher===void 0||this.calculator._calc.grapher.settings===void 0)return;let e=this.calculator._calc.grapher.settings;this.isExportingBraille()||(e.majorAxisOpacity=this.getGridOpacity(),e.minorAxisOpacity=this.getGridOpacity()/2,e.axisLineOffset=0,e.setProperty("axisLineWidth",this.getAxisWeight()),e.labelSize=this.getLabelSize(),e.graphLineWidth=this.getGraphThickness(),e.pointLineWidth=this.getGraphThickness()*3)}getHeight(){return Iu[this.size].height}getWidth(){return Iu[this.size].width}updateIfMounted(){this._isMounted&&this.update()}updateGraphPreview(){if(!this.pngDirty&&!this.svgDirty||this.calculator===void 0||this.calculator._calc===void 0||this.calculator._calc.grapher===void 0||this.calculator._calc.grapher.settings===void 0)return;this.updateViewSettings();let e={width:this.getWidth(),height:this.getHeight(),preserveAxisNumbers:!0,showLabels:!0,targetPixelRatio:2},t={braille:{embosserModel:this.size,brailleMode:this.exportType}};if(this.pngDirty){let o=this.isExportingBraille()?t:e;this.calculator.asyncScreenshot(o,n=>{this._isMounted&&typeof n=="string"&&(this.previewDataURL=n,this.previewBlob=OQ(this.previewDataURL),this.pngDirty=!1,this.loaded=!0,this.update(),this.resizePreviewImg())})}if(this.svgDirty){var i={...e,svg:!0};let o=pr("worksheetSVG");o&&(i.targetPixelRatio=1),this.calculator.asyncScreenshot(i,n=>{this._isMounted&&typeof n=="string"&&(o&&(n=ofe(n)),n!==void 0&&(this.svgBlob=RQ(n),this.svgDirty=!1,this.update(),this.resizePreviewImg()))})}}updateBrailleEquations(){if(this.isExportingBraille()){let e=GQ(this.controller.api.controller,this.brailleMode);this.brailleBlob=new Blob([e],{type:"text/plain"})}}resizePreviewImg(){if(!this.previewImg)return;let e=1;(this.size==="etc8"||this.size==="etc11")&&(e=2),(this.size==="vpmax8"||this.size==="vpmax11")&&(e=1.5);let t=Math.min(this.getWidth(),400),o=this.getHeight()/this.getWidth()*t;this.previewImg.width=t*e,this.previewImg.height=o*e}willUpdate(){this.updateGraphPreview(),this.updateBrailleEquations()}isExportingBraille(){return PL(this.exportType)}};function PL(r){return r==="nemeth"||r==="ueb"}function NQ(r){switch(r){case"etc8":return"8.5 x 11.0";case"etc11":return"11.5 x 11.0";case"vpmax8":return"8.5 x 11";case"vpmax11":return"11.5 x 11";default:return r}}function ofe(r){var e=new DOMParser,t=e.parseFromString(r,"text/xml");function i(o,n){t.querySelectorAll(o).forEach(n)}return i(".dcg-svg-region",function(o){o.setAttribute("fill","black")}),i(".dcg-svg-label *",function(o){o.setAttribute("stroke","none"),o.setAttribute("fill","black")}),i(".dcg-svg-axis-value text",function(o){o.getAttribute("stroke")!=="none"?o.parentElement&&o.parentElement.removeChild(o):(o.setAttribute("font-family","Helvetica Neue"),o.setAttribute("font-weight","bold"))}),i(".dcg-svg-offcenter-axis-value",function(o){o.parentElement&&o.parentElement.removeChild(o)}),i(".dcg-svg-curve",function(o){o.setAttribute("stroke","black"),o.setAttribute("stroke-width","5"),o.setAttribute("stroke-opacity","1")}),i(".dcg-svg-point",function(o){o.setAttribute("stroke","black"),o.setAttribute("stroke-width","10"),o.setAttribute("stroke-opacity","1")}),i(".dcg-svg-background",function(o){var n=parseFloat(o.getAttribute("width")),a=parseFloat(o.getAttribute("height")),s=3,l=t.createElementNS("http://www.w3.org/2000/svg","path");l.setAttribute("d",`M${n-s},${s}v${a-2*s}H${s}V${s}H${n-s} M${n},0H0v${a}h${n}V0L${n},0z`),o.parentElement.appendChild(l)}),i(".dcg-svg-axis-line",function(o){o.setAttribute("stroke","black"),o.setAttribute("stroke-width","4"),o.setAttribute("stroke-opacity","1")}),i(".dcg-svg-minor-gridline, .dcg-svg-major-gridline",function(o){o.setAttribute("stroke","black"),o.setAttribute("stroke-width","1"),o.setAttribute("stroke-opacity","1")}),t.firstChild.outerHTML}var ce=__dcg_shared_module_exports__['e'](te());var co=__dcg_shared_module_exports__['e'](te());var{If:_L,For:nfe,Input:afe}=co.Components,z0=class extends co.Class{constructor(){super(...arguments),this.filter=void 0,this.focusLocation=void 0,this.lastResultCount=0}init(){this.controller=this.props.controller()}template(){return co.createElement("div",{class:co.const("dcg-search-container"),onKeydown:this.bindFn(this.onKeydown)},co.createElement(_L,{predicate:this.props.renderWithInput},()=>co.createElement("div",{role:co.const("search"),class:co.const("dcg-searchable-dropdown")},co.createElement(afe,{class:()=>({"dcg-results-hidden":!this.showResults()}),id:()=>this.props.id?this.props.id():void 0,didMount:this.bindFn(this.didMountInput),onInput:this.bindFn(this.onInputChange),value:this.bindFn(this.getFilterString),placeholder:()=>this.props.placeholder(),autofill:this.const(!1),"data-1p-ignore":this.const(!0),manageFocus:this.const({shouldBeFocused:this.bindFn(this.shouldFilterBeFocused),onFocusedChanged:this.bindFn(this.onFilterFocusChange)}),required:()=>{var e,t;return(t=(e=this.props).required)==null?void 0:t.call(e)}}),co.createElement(_L,{predicate:()=>this.shouldShowDeleteX()},()=>co.createElement("i",{class:co.const("dcg-icon-remove dcg-remove-x dcg-do-not-blur"),role:co.const("button"),tabindex:co.const("0"),"aria-label":()=>this.controller.s("shared-calculator-button-clear"),onTap:this.bindFn(this.onDeleteXTapped)})))),co.createElement(_L,{predicate:()=>this.getFilteredOptions().length>0&&this.showResults()},()=>co.createElement("div",{class:()=>{var e,t;return{"dcg-searchable-dropdown-list-container":!0,"dcg-render-as-popover":(t=(e=this.props).popoverOptionsOnFocus)==null?void 0:t.call(e)}}},co.createElement(nfe,{each:()=>this.getFilteredOptions(),key:e=>e.id+"-"+e.label},co.createElement("div",{class:()=>({"dcg-searchable-dropdown-list":!0,"dcg-do-not-blur":!0,"dcg-no-input":!this.props.renderWithInput()}),role:co.const("listbox"),"aria-label":()=>this.controller.s("shared-calculator-label-search-results")},e=>co.createElement("div",{class:co.const("dcg-searchable-dropdown-option"),role:co.const("option"),onTap:t=>this.selectOption(e,t.device==="keyboard"),manageFocus:this.const({shouldBeFocused:()=>this.shouldOptionBeFocused(e),onFocusedChanged:t=>this.onOptionFocusChange(e,t)}),tabindex:co.const(0)},this.const(e.label)))))),co.createElement(_L,{predicate:()=>this.getFilteredOptions().length===0&&this.showResults()},()=>co.createElement("div",{class:()=>{var e,t;return{"dcg-searchable-dropdown-list-container":!0,"dcg-render-as-popover":(t=(e=this.props).popoverOptionsOnFocus)==null?void 0:t.call(e)}}},co.createElement("div",{class:()=>({"dcg-searchable-dropdown-list":!0,"dcg-no-search-results":!0})},()=>this.controller.s("shared-calculator-text-search-results",{count:new on(0)})))))}showResults(){var e,t;return(t=(e=this.props).popoverOptionsOnFocus)!=null&&t.call(e)?!!this.focusLocation:!0}didMountInput(){var e,t;(t=(e=this.props).popoverOptionsOnFocus)!=null&&t.call(e)||this.focusFilter()}shouldShowDeleteX(){return!!this.getFilterString()}onDeleteXTapped(e){this.onInputChange(""),this.props.externalControl?(this.props.externalControl().onClear(),e.device==="keyboard"&&this.focusFilter()):(this.focusFilter(),this.update())}shouldFilterBeFocused(){return this.focusLocation&&this.focusLocation.type==="filter"}onFilterFocusChange(e){e?this.focusFilter():(this.focusLocation=void 0,this.update())}shouldOptionBeFocused(e){return this.focusLocation&&this.focusLocation.type==="option"&&this.focusLocation.id===e.id}focusFilter(){this.focusLocation={type:"filter"},this.update()}focusOption(e){this.focusLocation={type:"option",id:e.id},this.update()}getFocusedOptionIndex(){if(!this.focusLocation||this.focusLocation.type!=="option")return-1;for(var e=this.focusLocation.id,t=this.getFilteredOptions(),i=0;i<t.length;i++){var o=t[i];if(o.id===e)return i}return-1}onOptionFocusChange(e,t){t?this.focusOption(e):(this.focusLocation=void 0,this.update())}onKeydown(e){switch(Be(e)){case dl:if(this.shouldFilterBeFocused()){var t=this.getFilteredOptions();t.length===1&&this.selectOption(t[0],!0)}break;case un:this.moveFocusInDirection(-1)&&e.preventDefault();break;case hn:this.moveFocusInDirection(1)&&e.preventDefault();break;case cg:e.preventDefault(),this.focusFirstOption();break;case Dp:e.preventDefault(),this.focusLastOption();break;case rn:this.props.onCancel();break;case cl:e.shiftKey?this.moveFocusInDirection(-1)&&e.preventDefault():this.moveFocusInDirection(1)&&e.preventDefault();break}}moveFocusInDirection(e){var t=this.getFilteredOptions(),i=this.getFocusedOptionIndex(),o=i+e;if(o==-1&&this.props.renderWithInput())return this.focusFilter(),!0;var n=t[o];return n?(this.focusOption(n),!0):!1}focusFirstOption(){var e=this.getFilteredOptions();e.length!==0&&this.focusOption(e[0])}focusLastOption(){var e=this.getFilteredOptions();e.length!==0&&this.focusOption(e[e.length-1])}onInputChange(e){this.props.externalControl?this.props.externalControl().onValueChange(e):this.filter=e,this.update()}getFilterString(){return this.props.externalControl?this.props.externalControl().getValue():this.filter||""}selectOption(e,t){var i,o;(o=(i=this.props).popoverOptionsOnFocus)!=null&&o.call(i)?this.onInputChange(e.label):this.onInputChange(""),this.focusLocation=void 0,this.update(),this.props.onChange({value:e.id,fromKeyboard:t})}getFilteredOptions(){var e=this.props.options(),t=this.getFilterString().toLowerCase().trim();return t&&(e=e.filter(function(i){return i.label.toLowerCase().indexOf(t)!==-1})),e}onUpdate(){let e=this.getFilteredOptions().length;this.focusLocation&&this.focusLocation.type==="filter"&&e!==this.lastResultCount&&Te(this.controller.s("shared-calculator-text-search-results",{count:new on(e)})),this.lastResultCount=e}};function kN(r){return!!r&&!!r.country&&!!r.birth_year&&!!r.email&&!!r.artist_statement&&!!r.name&&!!r.graph_hash&&!!r.product&&!!r.country&&!!r.age_group}var BQ={US:"United States",AF:"Afghanistan",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua and Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BQ:"Bonaire, Sint Eustatius and Saba",BA:"Bosnia and Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",CV:"Cabo Verde",KH:"Cambodia",CM:"Cameroon",CA:"Canada",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CD:"Congo (the Democratic Republic of the)",CG:"Congo",CK:"Cook Islands",CR:"Costa Rica",HR:"Croatia",CU:"Cuba",CW:"Cura\xE7ao",CY:"Cyprus",CZ:"Czechia",CI:"C\xF4te d'Ivoire",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",SZ:"Eswatini",ET:"Ethiopia",FK:"Falkland Islands [Malvinas]",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island and McDonald Islands",VA:"Holy See",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran",IQ:"Iraq",IE:"Ireland",IM:"Isle of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KP:"North Korea",KR:"South Korea",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MK:"North Macedonia",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestine, State of",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",RE:"R\xE9union",BL:"Saint Barth\xE9lemy",SH:"Saint Helena, Ascension and Tristan da Cunha",KN:"Saint Kitts and Nevis",LC:"Saint Lucia",MF:"Saint Martin (French part)",PM:"Saint Pierre and Miquelon",VC:"Saint Vincent and the Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome and Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SX:"Sint Maarten (Dutch part)",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia and the South Sandwich Islands",SS:"South Sudan",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard and Jan Mayen",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad and Tobago",TN:"Tunisia",TM:"Turkmenistan",TC:"Turks and Caicos Islands",TV:"Tuvalu",TR:"T\xFCrkiye",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",UM:"United States Minor Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:"Viet Nam",VG:"Virgin Islands (British)",VI:"Virgin Islands (U.S.)",WF:"Wallis and Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe",AX:"\xC5land Islands"},UQ={Algeria:13,Angola:13,"Antigua and Barbuda":16,Argentina:18,Armenia:18,Australia:15,Austria:14,Azerbaijan:20,Bahamas:16,Barbados:18,Bangladesh:18,Belgium:13,Belize:16,Benin:13,Bolivia:14,Botswana:13,Brazil:13,Bulgaria:14,"Burkina Faso":13,Burundi:13,Cameroon:13,Canada:16,"Cabo Verde":13,"Central African Republic":13,Chad:13,Chile:18,China:14,Colombia:18,Comoros:13,Congo:13,"Costa Rica":15,"C\xF4te d'Ivoire":13,Croatia:16,Cyprus:14,Czechia:15,Denmark:13,Djibouti:13,"Dominican Republic":16,Ecuador:14,Egypt:18,"El Salvador":18,"Equatorial Guinea":13,Eritrea:13,Estonia:13,Ethiopia:13,Finland:13,France:15,Gabon:13,Gambia:13,Germany:16,Ghana:13,Gibraltar:16,Greece:15,Grenada:16,Guatemala:16,Guinea:13,Guyana:16,Haiti:16,"Hong Kong":20,Hungary:16,Iceland:18,India:18,Indonesia:21,Ireland:16,Israel:14,Italy:14,Jamaica:16,Japan:20,Jordan:16,Kazakhstan:18,Kenya:13,Kuwait:17,Kyrgyzstan:18,Latvia:13,Lebanon:18,Lesotho:13,Liberia:13,Libya:13,Lithuania:14,Luxembourg:16,"North Macedonia":14,Madagascar:13,Malawi:13,Malaysia:18,Mali:13,Malta:13,Mauritania:13,Mauritius:13,Mexico:18,Moldova:18,Morocco:18,Mozambique:13,Namibia:13,Nepal:16,Netherlands:16,"New Zealand":16,Niger:13,Nigeria:13,Norway:15,Pakistan:18,Panama:18,Paraguay:20,Peru:15,Philippines:18,Poland:16,Portugal:13,"Puerto Rico":18,R\u00E9union:13,Romania:16,"Russian Federation":18,Rwanda:13,"Saint Lucia":16,"Saint Vincent and the Grenadines":15,"Sao Tome and Principe":13,"Saudi Arabia":20,Senegal:13,Serbia:18,Seychelles:13,"Sierra Leone":13,Singapore:13,Slovakia:16,Slovenia:16,Somalia:13,"South Africa":18,"South Korea":14,"South Sudan":13,Spain:14,"Sri Lanka":18,Sudan:13,Suriname:16,Eswatini:13,Sweden:13,Switzerland:18,Taiwan:18,Tajikistan:18,Tanzania:13,Thailand:20,Togo:13,"Trinidad and Tobago":16,Tunisia:13,T\u00FCrkiye:16,Uganda:13,Ukraine:14,"United Arab Emirates":18,"United Kingdom":13,"United States":13,Uruguay:18,Uzbekistan:18,Venezuela:18,"Western Sahara":13,"Viet Nam":18,Yemen:9,Zambia:13,Zimbabwe:13};var{If:Pm,IfElse:GN,Input:zQ,SwitchUnion:sfe,Textarea:lfe}=ce.Components,cfe=Object.values(BQ).map(r=>({id:r,label:r})),dfe=Array.from({length:121},(r,e)=>{let t=2020-e;return{id:t.toString(),label:t.toString()}}),pfe={country:"account-shell-text-art-contest-someone-else-country","birth-year":"account-shell-text-art-contest-someone-else-birth-year",name:"account-shell-text-art-contest-someone-else-name",email:"account-shell-text-art-contest-someone-else-email","artist-statement":"account-shell-text-art-contest-someone-else-artist-statement","artist-statement-description":"account-shell-text-art-contest-someone-else-artist-statement-description",agreement:"account-shell-text-art-contest-someone-else-copyright-agreement","first-year":"account-shell-text-art-contest-someone-else-first-year"},ufe={country:"account-shell-heading-country","birth-year":"account-shell-heading-birth-year",name:"account-shell-heading-name",email:"account-shell-heading-email","artist-statement":"account-shell-heading-artist-statement","artist-statement-description":"account-shell-label-artist-statement-description",agreement:"account-shell-text-art-contest-copyright-agreement","first-year":"account-shell-text-art-contest-my-first-year"},K0=class extends ce.Class{getProductType(){var t,i,o;let e=(t=this.shellController)==null?void 0:t.getProduct();if(e==="geometry")throw new Error("Art contest does not work on legacy geometry tool.");return(o=(i=this.currentSubmission)==null?void 0:i.product)!=null?o:e}shouldSaveGraph(){var e;return(e=this.shellController)==null?void 0:e.graphsController.hasUnsavedChanges()}async saveGraph(){if(!(!this.shellController||!this.currentSubmission)){this.saveStatus="pending";try{let e;if(this.shellController.graphsController.isCurrentGraphTitled()&&this.shellController.graphsController.wasCurrentGraphEverSaved()?(await this.shellController.graphsController.save(),e=this.shellController.graphsController.currentGraph):e=await this.shellController.graphsController.shareGraph(),!this._isMounted)return;this.currentSubmission.title=e.title,this.currentSubmission.graph_hash=e.hash,this.saveStatus="success"}catch(e){if(!this._isMounted)return;this.saveStatus="fail"}finally{this._isMounted&&this.update()}}}init(){var e,t,i;"frontpageController"in this.props?(this.frontpageController=this.props.frontpageController(),this.s=this.frontpageController.s):(this.shellController=this.props.shellController(),this.s=this.shellController.s),this.saveStatus="idle",this.submitStatus="idle",this.currentSubmission={...(t=(e=this.props).currentSubmission)==null?void 0:t.call(e)},(i=this.currentSubmission)!=null&&i.submitting_for_someone_else?this.translationStrings=pfe:this.translationStrings=ufe,this.getScreen()==="form"&&this.initEditMode()}getProductSafely(){var t;let e=(t=this.shellController)==null?void 0:t.getProduct();if(e==="geometry")throw new Error("Art contest is invalid on geometry tool");return e}async initEditMode(){var i,o,n,a;let e=((i=this.currentSubmission)==null?void 0:i.name)||((o=this.shellController)==null?void 0:o.userController.getFullName()),t=(n=this.currentSubmission)==null?void 0:n.name;if(this.currentSubmission={age_group:this.getSelectedAgeGroup(),product:this.getProductSafely(),...this.currentSubmission,name:this.getIsForSomeoneElse()?t:e,email:((a=this.currentSubmission)==null?void 0:a.email)||this.getController().userController.getEmail()},this.hasConsent=!1,this.shouldSaveGraph()){if(await this.saveGraph(),!this._isMounted)return}else this.shellController&&(this.currentSubmission.graph_hash=this.shellController.graphsController.getCurrentGraphHash(),this.currentSubmission.title=this.shellController.graphsController.getCurrentGraphTitle())}getIsForSomeoneElse(){var e;return!!((e=this.currentSubmission)!=null&&e.submitting_for_someone_else)}getScreen(){var e;return(e=this.currentSubmission)!=null&&e.submission_id&&this.submitStatus==="idle"&&!this.shouldUpdateSubmission?"showing-submission":this.saveStatus==="pending"?"saving":this.saveStatus==="fail"?"save-failed":this.submitStatus==="fail"?"submit-failed":this.submitStatus==="pending"?"submitting":this.submitStatus==="success"?"submitted":"form"}closeModalAndShowSubmissions(){this.getController().dispatch({type:"close-modal"}),this.shellController&&!this.isSmallScreen()&&this.shellController.dispatch({type:"toggle-menu",payload:"art-contest"})}isSmallScreen(){let e=window.platform;return document.body.getBoundingClientRect().width<650||e==="ios"||e==="android"}getController(){return"shellController"in this.props?this.props.shellController():this.props.frontpageController()}getThumbAlt(){var e,t;return(e=this.currentSubmission)!=null&&e.title&&this.currentSubmission.title!==""?this.s("frontpage-narration-art-contest-image-of-graph",{graphTitle:this.currentSubmission.title}):(t=this.currentSubmission)!=null&&t.name?this.s("frontpage-narration-art-contest-image-of-graph-by",{name:this.currentSubmission.name}):""}shouldAllowUpdate(){return this.shellController?this.shellController.isGraphComplexEnoughForContest()&&!this.shellController.graphsController.willSaveCopy():!1}template(){return ce.createElement(Du,{controller:this.bindFn(this.getController)},ce.createElement("div",{class:ce.const("dcg-contest-submission-dialog")},sfe(()=>this.getScreen(),{"showing-submission":()=>ce.createElement("div",{class:ce.const("dcg-art-contest-info-container")},ce.createElement("div",{class:ce.const("dcg-flex-container")},ce.createElement("div",{class:ce.const("dcg-art-contest-world-image dcg-art-contest-submission-thumbnail")},ce.createElement("img",{src:()=>{var e;return(e=this.currentSubmission)==null?void 0:e.thumb},alt:this.bindFn(this.getThumbAlt)})),ce.createElement("div",{class:ce.const("dcg-contest-about")},ce.createElement("h1",{class:ce.const("dcg-contest-submission-title dcg-shared-left-align-title")},()=>this.s("account-shell-label-submission-already-received")),ce.createElement("div",{class:ce.const("dcg-contest-text")},ce.createElement("div",{class:ce.const("dcg-submission-wrapper")},ce.createElement("div",{class:ce.const("dcg-submission-header")},()=>this.s(this.translationStrings.name)),ce.createElement("div",{class:ce.const("dcg-submission-content")},()=>{var e;return(e=this.currentSubmission)==null?void 0:e.name}),ce.createElement("div",{class:ce.const("dcg-submission-header")},()=>this.s(this.translationStrings.email)),ce.createElement("div",{class:ce.const("dcg-submission-content")},()=>{var e;return(e=this.currentSubmission)==null?void 0:e.email}),ce.createElement("div",{class:ce.const("dcg-submission-header")},()=>this.s(this.translationStrings["artist-statement"]),ce.const(" ")),ce.createElement("div",{class:ce.const("dcg-submission-content")},()=>{var e;return(e=this.currentSubmission)==null?void 0:e.artist_statement}))),ce.createElement(Pm,{predicate:()=>this.shouldAllowUpdate()},()=>ce.createElement("button",{class:ce.const("dcg-resubmit-link"),onTap:this.bindFn(this.triggerSubmissionUpdate)},()=>this.s("account-shell-button-update-graph")))))),saving:()=>ce.createElement("div",{class:ce.const("dcg-save-animation-container")},ce.createElement("div",{class:ce.const("dcg-saving")},ce.createElement("div",{"aria-live":ce.const("polite"),"aria-atomic":ce.const("true")},ce.createElement("span",{class:ce.const("dcg-spinner")}),()=>this.s("account-shell-label-saving-graph")))),"save-failed":()=>ce.createElement("div",{class:ce.const("dcg-save-animation-container")},ce.createElement("div",{class:ce.const("dcg-saving")},ce.createElement("div",{"aria-live":ce.const("polite"),"aria-atomic":ce.const("true")},()=>this.s("account-shell-error-save-art-contest")))),submitting:()=>ce.createElement("div",{class:ce.const("dcg-save-animation-container")},ce.createElement("div",{class:ce.const("dcg-saving")},ce.createElement("div",{"aria-live":ce.const("polite"),"aria-atomic":ce.const("true")},ce.createElement("span",{class:ce.const("dcg-spinner")}),()=>this.s("account-shell-label-submitting")))),"submit-failed":()=>ce.createElement("div",{class:ce.const("dcg-save-animation-container")},ce.createElement("div",{class:ce.const("dcg-saving")},ce.createElement("div",{"aria-live":ce.const("polite"),"aria-atomic":ce.const("true")},()=>this.s("account-shell-error-submitting")))),submitted:()=>ce.createElement("div",{class:ce.const("dcg-save-animation-container")},ce.createElement("div",{class:ce.const("dcg-art-contest-success-image")},ce.createElement("img",{src:()=>{var e;return(e=this.currentSubmission)==null?void 0:e.thumb},alt:this.bindFn(this.getThumbAlt)})),ce.createElement("div",{class:ce.const("dcg-save-success"),"aria-live":ce.const("polite"),"aria-atomic":ce.const("true")},()=>this.s("account-shell-label-submission-received"),ce.createElement("div",{class:ce.const("dcg-save-animation-content")},ce.createElement("div",null,ce.createElement("div",{class:ce.const("dcg-congrats-message")},GN(()=>this.getIsForSomeoneElse(),{false:()=>ce.createElement(yi,{i18n:this.bindFn(this.getController),key:this.const("account-shell-text-art-contest-success-paragraph")},ce.const("If you'd like to revise your submission, feel free to resubmit anytime before"),ce.createElement("span",{class:ce.const("bold-text")},ce.const(" January 15th")),ce.const(". We'll only look at the most recent submission for each tool.")),true:()=>ce.createElement(yi,{i18n:this.bindFn(this.getController),key:this.const("account-shell-text-art-contest-success-paragraph-someone-else")},ce.const("If you'd like to revise the submission, please delete it from the table of graphs you\u2019ve submitted and resubmit. Feel free to resubmit anytime before"),ce.createElement("span",{class:ce.const("bold-text")},ce.const(" January 15th")),ce.const(". We'll only look at the most recent submission for each tool."))})),ce.createElement("div",{class:ce.const("dcg-congrats-message")},()=>this.s("account-shell-text-art-contest-congratulations")),ce.createElement(Pm,{predicate:()=>!this.getIsForSomeoneElse()&&!this.isSmallScreen()},()=>ce.createElement("button",{class:ce.const("dcg-btn-primary dcg-see-submission-button"),onTap:this.bindFn(this.closeModalAndShowSubmissions)},()=>this.s("account-shell-text-art-contest-see-submissions"))))))),form:()=>ce.createElement("div",null,ce.createElement("h1",{class:ce.const("dcg-contest-submission-title dcg-shared-left-align-title")},()=>this.s("account-shell-heading-submit-graph")),ce.createElement("form",{class:ce.const("dcg-submission-form"),onSubmit:this.bindFn(this.submitEntry)},ce.createElement("div",{class:ce.const("dcg-country-and-year")},ce.createElement("div",{class:ce.const("dcg-form-section")},ce.createElement("label",{class:ce.const("dcg-section-title"),for:ce.const("art-contest-country")},()=>this.s(this.translationStrings.country)),ce.createElement(Pm,{predicate:()=>!!this.getSelectedCountry()},()=>ce.createElement("button",{class:ce.const("dcg-blue-link dcg-edit-link"),onTap:()=>{this.setSelectedCountry(void 0)},"aria-label":()=>this.s("account-shell-narration-edit-selected-country")},()=>this.s("account-shell-button-edit"))),GN(()=>!!this.getSelectedCountry(),{true:()=>ce.createElement("div",{class:ce.const("dcg-your-country-name")},()=>this.getSelectedCountry()),false:()=>ce.createElement(z0,{controller:this.bindFn(this.getController),options:()=>this.getListOfCountries(),onChange:e=>this.setSelectedCountry(e.value),onCancel:()=>this.setSelectedCountry(void 0),renderWithInput:()=>!0,id:this.const("art-contest-country"),placeholder:()=>this.s("account-shell-label-country-placeholder"),required:this.const(!0)})})),ce.createElement("div",{class:ce.const("dcg-form-section")},ce.createElement("label",{class:ce.const("dcg-section-title"),for:ce.const("art-contest-birth-year")},()=>this.s(this.translationStrings["birth-year"])),ce.createElement(Pm,{predicate:()=>!!this.getSelectedCountry()&&!!this.getSelectedYear()},()=>ce.createElement("button",{class:ce.const("dcg-blue-link dcg-edit-link"),onTap:()=>{this.setSelectedYear(void 0)},"aria-label":()=>this.s("account-shell-narration-edit-selected-year")},()=>this.s("account-shell-button-edit"))),ce.createElement(Pm,{predicate:()=>this.shouldShowAgeOptions()},()=>ce.createElement("div",null,GN(()=>!!this.getSelectedYear(),{true:()=>ce.createElement("div",{class:ce.const("dcg-your-birth-year")},()=>this.getSelectedYear()),false:()=>ce.createElement(z0,{controller:this.bindFn(this.getController),options:()=>this.getListOfYears(),onChange:e=>this.setSelectedYear(e.value),onCancel:()=>this.setSelectedYear(void 0),renderWithInput:()=>!0,placeholder:()=>this.s("account-shell-label-birth-year-placeholder"),id:this.const("art-contest-birth-year"),required:()=>!0})}))))),ce.createElement(Pm,{predicate:()=>this.isSubmissionEligible()},()=>ce.createElement("div",null,ce.createElement("div",{class:ce.const("dcg-form-section-flex")},ce.createElement("div",{class:ce.const("dcg-form-section")},ce.createElement("label",{class:ce.const("dcg-section-title"),for:ce.const("art-contest-name")},()=>this.s(this.translationStrings.name)),ce.createElement("div",{class:ce.const("dcg-section-subtitle"),id:ce.const("art-contest-name-description")},()=>this.s("account-shell-heading-name-details")),ce.createElement(zQ,{class:this.const("dcg-shared-input-blue-outline"),didMount:e=>{e.focus(),e.select()},"data-1p-ignore":this.const(!0),onInput:e=>this.setUserName(e),value:this.bindFn(this.getUserName),disabled:()=>!1,id:this.const("art-contest-name"),required:()=>!0,"aria-describedby":this.const("art-contest-name-description")})),ce.createElement("div",{class:ce.const("dcg-form-section")},ce.createElement("label",{class:ce.const("dcg-section-title"),for:ce.const("art-contest-email")},()=>this.s(this.translationStrings.email)),ce.createElement("div",{class:ce.const("dcg-section-subtitle"),id:ce.const("art-contest-email-description")},()=>this.s("account-shell-heading-email-details")),ce.createElement(zQ,{class:this.const("dcg-shared-input-blue-outline"),"data-1p-ignore":this.const(!0),onInput:e=>this.setUserEmail(e),value:this.bindFn(this.getUserEmail),placeholder:()=>this.s("account-shell-label-email-address"),disabled:()=>!1,id:this.const("art-contest-email"),required:()=>!0,"aria-describedby":this.const("art-contest-email-description"),type:this.const("email"),pattern:this.const(xd)}))),ce.createElement(xt,{checked:this.bindFn(this.getFirstParticipant),onChange:this.bindFn(this.toggleFirstParticipant)},()=>this.s(this.translationStrings["first-year"])),ce.createElement("div",{class:ce.const("dcg-form-section")},ce.createElement("label",{class:ce.const("dcg-section-title"),for:ce.const("art-contest-artist-statement")},()=>this.s(this.translationStrings["artist-statement"])),ce.createElement("div",{class:ce.const("dcg-section-subtitle"),id:ce.const("art-contest-artist-statement-description")},()=>this.s(this.translationStrings["artist-statement-description"])),ce.createElement(lfe,{class:this.const("dcg-shared-input-blue-outline dcg-artist-statement-input"),onInput:e=>this.setArtistStatement(e),value:this.bindFn(this.getArtistStatement),maxlength:this.const(900),placeholder:()=>this.s("account-shell-label-artist-statement-placeholder"),id:this.const("art-contest-artist-statement"),required:()=>!0,"aria-describedby":this.const("art-contest-artist-statement-description")})),ce.createElement(xt,{checked:this.bindFn(this.getConsentTicked),onChange:this.bindFn(this.toggleConsent),required:()=>!0},()=>this.s(this.translationStrings.agreement)),ce.createElement("button",{class:()=>({"dcg-btn-blue":!0,"dcg-disabled":this.isSubmitButtonDisabled(),"dcg-submit-this-graph-btn":!0}),"aria-disabled":()=>this.isSubmitButtonDisabled()?!0:void 0,type:ce.const("submit")},()=>this.s("account-shell-button-submit-graph")),ce.createElement("div",{class:ce.const("dcg-disclaimer")},()=>this.s("account-shell-text-art-contest-legal-disclaimer")))),ce.createElement(Pm,{predicate:()=>this.shouldShowIneligible()},()=>ce.createElement("div",{class:ce.const("dcg-ineligible-container"),"aria-live":ce.const("polite"),"aria-atomic":ce.const("true")},ce.createElement("i",{class:ce.const("dcg-icon-error"),"aria-hidden":ce.const("true")}),ce.createElement(yi,{i18n:this.bindFn(this.getController),key:this.const("account-shell-text-artcontest-ineligible")},ce.createElement("div",{class:ce.const("dcg-ineligible-text-container")},ce.createElement("div",{class:ce.const("dcg-ineligible-text")},ce.const("Based on the provided age, we aren\u2019t able to accept this graph submission this year.")),ce.createElement("div",{class:ce.const("dcg-ineligible-text")},ce.const("Keep up the awesome graphing! There will be new contests every year.")))))),ce.createElement(Pm,{predicate:()=>this.shouldPromptSomeoneElse()},()=>ce.createElement("div",{class:ce.const("dcg-ineligible-container"),"aria-live":ce.const("polite"),"aria-atomic":ce.const("true")},ce.createElement("i",{class:ce.const("dcg-icon-error"),"aria-hidden":ce.const("true")}),ce.createElement(yi,{i18n:this.bindFn(this.getController),key:this.const("account-shell-text-artcontest-someone-else")},ce.createElement("div",{class:ce.const("dcg-ineligible-text-container")},ce.createElement("div",{class:ce.const("dcg-ineligible-text")},ce.const("Based on your age and location, you need a teacher, parent, or guardian over the age of 18 to submit your graph for you.")),ce.createElement("div",{class:ce.const("dcg-ineligible-text")},ce.const("Here is the link to your graph:"),ce.const(" ")),yi.subview("graphlink",()=>ce.createElement(rv,{controller:this.bindFn(this.getController),link:()=>U9(this.getGraphHash(),this.getProductType())})),ce.createElement("div",{class:ce.const("dcg-ineligible-text")},ce.const("Please share it with one of them and have them submit it at"),ce.const(" "),ce.createElement("a",{href:ce.const("/art"),class:ce.const("dcg-blue-link"),target:ce.const("_blank")},ce.const("desmos.com/art")),ce.const("."))))))))})))}getGraphHash(){return this.currentSubmission.graph_hash}async submitEntry(e){var t,i,o;if(e.preventDefault(),!this.isSubmitButtonDisabled()){this.submitStatus="pending",this.update();try{let n=this.currentSubmission;if(!kN(n))throw new Error("Invalid submission");let a=await TJ(n);if(!this._isMounted||((a.submission_id||a[0].submission_id)&&(this.submitStatus="success",(i=(t=this.props).onSuccessfulSubmit)==null||i.call(t),(o=this.currentSubmission)!=null&&o.submitting_for_someone_else?xo({category:"art-contest",action:"submit-for-someone-else"}):xo({category:"art-contest",action:"submit"})),await this.fetchContestEntry(),!this._isMounted))return;this.shouldUpdateSubmission=!1}catch(n){if(!this._isMounted)return;Te(this.s("account-shell-error-submitting")),this.submitStatus="fail"}finally{this._isMounted&&this.update()}}}triggerSubmissionUpdate(){this.initEditMode(),this.shouldUpdateSubmission=!0,this.update()}async fetchContestEntry(){let e=this.getProductType();if(e)try{let t=await ev(e);if(!this._isMounted)return;this.currentSubmission=t[0]}catch(t){if(!this._isMounted)return;Te(this.s("account-shell-error-submitting")),this.submitStatus="fail"}finally{this._isMounted&&this.update()}}shouldShowAgeOptions(){return!!this.getSelectedCountry()}shouldShowIneligible(){return!!this.getSelectedCountry()&&!!this.getSelectedYear()&&this.getUserAgeInYears()<13}shouldPromptSomeoneElse(){return!!this.getSelectedCountry()&&!!this.getSelectedYear()&&!this.isSubmissionEligible()&&!this.shouldShowIneligible()}setArtistStatement(e){this.currentSubmission.artist_statement=e,this.update()}setSelectedYear(e){this.currentSubmission.birth_year!==e&&(this.currentSubmission.birth_year=e,this.currentSubmission.age_group=this.getSelectedAgeGroup(),this.update())}setSelectedCountry(e){this.currentSubmission.country=e,this.update()}getArtistStatement(){return this.currentSubmission.artist_statement||""}getSelectedCountry(){return this.currentSubmission.country}getSelectedYear(){return this.currentSubmission.birth_year}getUserAgeInYears(){return 2023-parseFloat(this.currentSubmission.birth_year||"")}getSelectedAgeGroup(e=this.getUserAgeInYears()){return e>=19?"19+":e>=17?"17-18":e>=15?"15-16":e>=13?"13-14":""}getUserName(){return this.currentSubmission.name||""}setUserName(e){this.currentSubmission.name=e,this.update()}getUserEmail(){return this.currentSubmission.email||""}setUserEmail(e){this.currentSubmission.email=e,this.update()}getConsentTicked(){return!!this.hasConsent}toggleConsent(){this.hasConsent=!this.hasConsent,this.update()}getFirstParticipant(){return!!this.currentSubmission.first_time_submission}toggleFirstParticipant(){this.currentSubmission.first_time_submission=!this.currentSubmission.first_time_submission,this.update()}isSubmitButtonDisabled(){return!this.hasConsent||this.submitStatus==="pending"||!kN(this.currentSubmission)}isSubmissionEligible(){var i,o;if(!this.currentSubmission.country||!this.currentSubmission.birth_year)return!1;let e=this.getUserAgeInYears();if((i=this.currentSubmission)!=null&&i.submitting_for_someone_else&&e>=13)return!0;let t=(o=UQ[this.currentSubmission.country])!=null?o:16;return e>=t}getListOfCountries(){return cfe}getListOfYears(){return dfe}};var kd=__dcg_shared_module_exports__['e'](te());var OL=class extends kd.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller}template(){return kd.createElement(Qo,{title:()=>this.i18n.s("shared-title-account-reactivated"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},kd.createElement("div",{class:kd.const("dcg-shared-recover-password-dialog dcg-shared-account-dialog")},kd.createElement("div",{class:kd.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-message-account-reactivated")),kd.createElement("div",{class:kd.const("dcg-shared-modal-actions-container")},kd.createElement("button",{class:()=>({"dcg-btn-blue":!0}),onTap:()=>this.controller.dispatch({type:"close-modal"})},()=>this.i18n.s("shared-button-continue-to-desmos")))))}};var po=__dcg_shared_module_exports__['e'](te());as();var{IfDefined:hfe,For:gfe}=po.Components,RL={"dcg-actions":{label:"account-shell-label-feature-flag-actions",description:"account-shell-text-feature-flag-actions-description",learnMoreLink:"https://help.desmos.com/hc/en-us/articles/4407725009165"}},FL=class extends po.Class{init(){this.formErrors=[]}template(){return po.createElement("div",{class:po.const("dcg-advanced-settings")},po.createElement("div",{class:po.const("dcg-shared-account-paragraph")},()=>this.props.controller().s("account-shell-text-advanced-preferences-instructions")),po.createElement(gfe,{each:()=>__dcg_shared_module_exports__['B'](RL)},po.createElement("div",{class:po.const("dcg-feature-flag-list")},e=>po.createElement("div",null,po.createElement(xt,{checked:()=>this.isFeatureFlagEnabled(e),disabled:()=>!!this.updateInFlight,onChange:t=>this.toggleFeatureFlag(e,t)},po.createElement("span",{class:po.const("dcg-feature-flag-label")},()=>this.label(e))),po.createElement("div",{class:po.const("dcg-feature-flag-description")},()=>this.description(e),po.const(" "),po.createElement("a",{href:()=>this.learnMoreLink(e),class:po.const("dcg-blue-link"),target:po.const("_blank")},()=>this.props.controller().s("graphing-calculator-link-learn-more")))))),po.createElement(ma,{controller:this.props.controller,errors:()=>this.formErrors}),hfe(this.bindFn(this.getSaveProgress),e=>po.createElement("span",{"aria-live":po.const("assertive"),"aria-atomic":po.const("true"),class:po.const("dcg-shared-confirmation-message")},po.createElement("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0,"dcg-saving":e()==="saving"}),"aria-hidden":po.const("true")}),()=>e()==="saving"?this.props.controller().s("shared-calculator-label-saving"):this.props.controller().s("shared-message-information-saved"))))}getSaveProgress(){if(this.updateInFlight)return"saving";if(this.showSuccessConfirmation)return"saved"}isFeatureFlagEnabled(e){return this.updateInFlight&&e in this.updateInFlight?this.updateInFlight[e]:this.props.controller().userController.getFeatureFlags().indexOf(e)!==-1}async toggleFeatureFlag(e,t){this.updateInFlight={[e]:t},this.props.controller().dispatch({type:"render"});try{if(await this.props.controller().userController.updateFeatureFlags({featureFlagsUpdate:this.updateInFlight,lang:this.props.controller().getLanguage()}),!this._isMounted)return;this.showSuccessConfirmation=!0,setTimeout(this.bindIfMounted(()=>{this.showSuccessConfirmation=!1,this.props.controller().dispatch({type:"render"})}),3e3)}catch(i){if(!this._isMounted)return;Ii(i),this.formErrors=[this.props.controller().s("account-shell-error-unknown")]}finally{this._isMounted&&(this.updateInFlight=void 0,this.props.controller().dispatch({type:"render"}))}}learnMoreLink(e){return RL[e].learnMoreLink}label(e){return this.props.controller().s(RL[e].label)}description(e){return this.props.controller().s(RL[e].description)}};var ba=__dcg_shared_module_exports__['e'](te());var{IfDefined:mfe}=ba.Components,NL=class extends ba.Class{init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController}template(){return ba.createElement(Qo,{size:this.const("narrow"),onClose:()=>{this.controller.dispatch({type:"close-modal"})},i18n:this.const(this.controller),title:()=>this.controller.s("account-shell-label-delete-graph-modal-title"),class:this.const("dcg-delete-modal")},ba.createElement("div",{class:ba.const("dcg-delete-modal-contents")},ba.createElement("div",{class:ba.const("dcg-delete-confirmation-message")},this.bindFn(this.getConfirmationMessage)),mfe(()=>this.errorMessage,e=>ba.createElement("div",{class:ba.const("dcg-error-message")},e)),ba.createElement("div",{class:ba.const("dcg-action-buttons")},ba.createElement("span",{class:ba.const("dcg-gray-link"),role:ba.const("button"),tabindex:ba.const("0"),"aria-label":()=>this.controller.s("account-shell-button-cancel"),onTap:()=>this.controller.dispatch({type:"close-modal"})},()=>this.controller.s("account-shell-button-cancel")),ba.createElement("div",{class:()=>({"dcg-btn-red dcg-action-delete":!0,"dcg-disabled":!!this.deleteInProgress}),role:ba.const("button"),tabindex:()=>this.deleteInProgress?-1:0,"aria-label":this.bindFn(this.getButtonText),"aria-disabled":()=>!!this.deleteInProgress,onTap:this.bindFn(this.deleteGraph)},this.bindFn(this.getButtonText)))))}async deleteGraph(){this.deleteInProgress=!0;try{if(await this.graphsController._deleteGraph(this.graphsController.currentGraph),!this._isMounted)return;this.graphsController.clearGraphByUserAction(),this.controller.dispatch({type:"close-modal"})}catch(e){if(!this._isMounted)return;this.deleteInProgress=!1,this.errorMessage=this.controller.s("account-shell-error-deletion-error"),this.controller.dispatch({type:"render"})}}getConfirmationMessage(){return this.controller.s("account-shell-text-delete-graphs-confirmation",{count:this.getGraphCount(),title:this.getTitle()})}getButtonText(){return this.controller.s("account-shell-button-confirm-delete",{count:this.getGraphCount()})}getGraphCount(){return new on(1)}getTitle(){return this.graphsController.getCurrentGraphTitle()||this.graphsController.getUntitledString()}};var{SwitchUnion:ffe}=Zt.Components,BL=class extends Zt.Class{init(){this.controller=this.props.controller()}template(){return ffe("modal",()=>this.controller.getModalState())({save:()=>Zt.createElement(Lb,{controller:this.props.controller},Zt.createElement(cv,{controller:this.props.controller})),rename:()=>Zt.createElement(Lb,{controller:this.props.controller},Zt.createElement(cv,{controller:this.props.controller})),duplicate:()=>Zt.createElement(Lb,{controller:this.props.controller},Zt.createElement(cv,{controller:this.props.controller})),"export-image":()=>Zt.createElement(U0,{controller:this.props.controller}),login:()=>Zt.createElement(ZV,{controller:this.props.controller}),signup:()=>Zt.createElement(QV,{controller:this.props.controller}),"recover-password":()=>Zt.createElement(tL,{controller:this.props.controller}),hotkeys:()=>Zt.createElement(Lb,{controller:this.props.controller},Zt.createElement(iL,{controller:this.props.controller}),Zt.const(";")),"unsupported-browser":()=>Zt.createElement(Lb,{controller:this.props.controller},Zt.createElement(oL,{controller:this.props.controller})),"account-settings":e=>Zt.createElement(uL,{controller:this.props.controller,extraTabs:this.bindFn(this.getAccountSettingsExtraTabs),initialTab:()=>e().initialTab}),"change-email":()=>Zt.createElement(hL,{controller:this.props.controller}),"account-reenabled":()=>Zt.createElement(OL,{controller:this.props.controller}),"contest-submission":e=>Zt.createElement(Qo,{title:()=>"",size:this.const("wide"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},Zt.createElement(K0,{shellController:this.props.controller,currentSubmission:()=>e().currentSubmission})),delete:()=>Zt.createElement(NL,{controller:this.props.controller}),none:()=>Zt.createElement("div",null)})}getAccountSettingsExtraTabs(){return{tabs:[{key:"advanced",wideLabel:()=>this.props.controller().s("account-shell-label-advanced-preferences"),narrowLabel:()=>this.props.controller().s("account-shell-label-advanced-preferences"),class:"advanced"}],createView:e=>e?e=="advanced"?Zt.createElement(FL,{controller:this.props.controller}):e:Zt.createElement("span",null)}}},Lb=class extends Zt.Class{init(){this.controller=this.props.controller()}template(){return Zt.createElement("div",{role:Zt.const("dialog"),class:()=>({"dcg-modal-container":!0,"dcg-wide-modal":this.controller.getOpenModal()==="hotkeys","dcg-fixed-width-height":this.shouldBeFixedWidthHeight(),"dcg-export-modal":this.controller.getOpenModal()==="export-image"})},Zt.createElement("div",{class:Zt.const("dcg-modal-background"),onTap:()=>this.controller.dispatch({type:"close-modal"})}),Zt.createElement("div",{class:Zt.const("modal dcg-state-modals")},Zt.createElement("span",{role:Zt.const("link"),tabindex:Zt.const(0),"aria-label":Zt.const("Close Dialog"),class:Zt.const("action-close-modal close-modal internal-close"),onTap:()=>this.controller.dispatch({type:"close-modal"}),didMount:e=>{if(this.controller.getOpenModal()==="hotkeys")return e.focus()}},Zt.createElement("i",{class:Zt.const("dcg-icon-remove"),"aria-hidden":Zt.const("true")})),this.children),Zt.createElement("span",{role:Zt.const("link"),tabindex:Zt.const(0),onTap:()=>this.controller.dispatch({type:"close-modal"}),"aria-label":Zt.const("Close Dialog"),class:Zt.const("action-close-modal close-modal external-close")},Zt.createElement("i",{class:Zt.const("dcg-icon-remove"),"aria-hidden":Zt.const("true")})))}shouldBeFixedWidthHeight(){var e=this.controller.getOpenModal();return e==="export-image"||e==="contest-submission"}};var Gd=null,H0=null,MN=!1,W0={},KQ=0;function bfe(){window.fetch=function(r,e){let t=new Request(r,e);var i=KQ+"";KQ+=1;let o=new Promise((n,a)=>{W0[i]={resolve:n,reject:a}});return t.text().then(n=>{Gd.methods.proxyXHR(JSON.stringify({id:i,url:t.url,method:t.method,headers:t.headers,body:n}))},()=>{W0[i].reject(new TypeError("Could not decode request body")),delete W0[i]}),o}}function yfe(r){var i;var e=(i=r.target)==null?void 0:i.closest("a[href]");if(e&&e.protocol==="file:"){var t=e.getAttribute("href");t[0]!=="/"&&(t="/"+t),e.setAttribute("href",Tm()+t)}}Fc?(q0=[],UL=[],qQ=function(r){var e=UL.length?UL.pop():q0.length;return q0[e]=r,e},HQ=function(r){var e=q0[r];return q0[r]=null,UL.push(r),e},Gd={loaded:!1,methods:{},queuedMethodCalls:[]},XD(function(){var r=[];window.ObjC_callback=function(t){Gd.loaded=!0,t.split(" ").forEach(function(i){Gd.methods[i]=function(o,n){var a=n?qQ(n):-1;r.push("desmos:"+i+"/"+a+"/"+encodeURIComponent(o)),r.length===1&&e.setAttribute("src",r[0])}}),this.ObjC_callback=function(i,o){try{i!==-1&&HQ(i)(o)}finally{r.shift(),r.length>0&&e.setAttribute("src",r[0])}},Gd.methods.proxyXHR&&bfe(),Gd.queuedMethodCalls.forEach(function(i){Pb[i.methodName].apply(Pb,i.args)})};var e=document.createElement("iframe");aa(e,{position:"absolute",left:"-1000px",zIndex:"-1"}),e.setAttribute("id","objc-bridge"),e.setAttribute("src","desmos:loaded"),document.body.append(e)})):Ju?H0=window.Android:MN=!0;var q0,UL,qQ,HQ,xfe=["hideLoadingScreen","gaEvent","openGoogleLogin","openAppleLogin","logout","saveCookies","deleteCookies","startSingleAppMode","endSingleAppMode","setWWWSubdomain","sendSerializedAnalyticsEvent","sendStoredLogsToDesmos"],TN=class extends Yr{constructor(){super(),this.heartbeatTimeout=void 0,this.observeEvent("started resumed",e=>{this.gaEvent(e+":"+this.versionNumber),this.incrementHeartbeat(0)}),document.location.search.indexOf("simulateVersionNumber")!==-1&&(this.versionNumber="?.?.?");for(let e of xfe)this[e]=function(){MN||(H0?H0[e]?H0[e].apply(H0,arguments):__dcg_shared_module_exports__['M'].log("call to missing Android method",e,arguments):Gd&&(Gd.loaded?Gd.methods[e]?Gd.methods[e].apply(Gd,arguments):__dcg_shared_module_exports__['M'].log("call to missing ObjC method",e,arguments):Gd.queuedMethodCalls.push({methodName:e,args:arguments})))}}heartbeat(e){clearTimeout(this.heartbeatTimeout),this.gaEvent("heartbeat-"+10*e),this.incrementHeartbeat(e)}incrementHeartbeat(e){clearTimeout(this.heartbeatTimeout),this.heartbeatTimeout=setTimeout(()=>{this.heartbeat(e+1)},600*1e3)}_started(e,t){this.appId=e,this.versionNumber=t,this.triggerEvent("started",void 0)}_resumed(){this.triggerEvent("resumed",void 0)}handleAndroidBackButtonAndReturnIfShouldMoveToBackground(){var e=window.Calc&&window.Calc.controller;return e&&e.isKeypadOpen()?(pi(),"false"):(e=window.MainController,e&&e.handleAndroidBackButton()?"false":"true")}isInApp(){return window.platform&&window.platform!=="www"}onGoogleAuthResult(e){this.triggerEvent("onGoogleAuthResult",e)}onAppleAuthResult(e){this.triggerEvent("onAppleAuthResult",e)}onObjCXHRProxyResult(e){var t=e.id;let{resolve:i,reject:o}=W0[t];delete W0[t],e.status===0?o(new TypeError("Network error")):i(new Response(e.body,{status:e.status,headers:e.headers}))}sendAnalyticsEvent(e,t){this.sendSerializedAnalyticsEvent(JSON.stringify({type:e,payload:t}))}},Pb=new TN;MN||(window.AppBridge=Pb,document.addEventListener("click",yfe,!0));window.__dcgAppBridgeDefined=!0;var eP=__dcg_shared_module_exports__['e'](te());var Ce=__dcg_shared_module_exports__['e'](te());qt();var jt=__dcg_shared_module_exports__['e'](te());qt();var{If:$0}=jt.Components,Ev=class extends jt.Class{template(){return jt.createElement("div",{role:jt.const("listitem"),class:()=>({"saved-graph":!0,"graph-link-container":!0,"dcg-selected":this.props.isSelected()}),onTap:e=>{e.wasHandled()||this.props.onTap(e)}},jt.createElement($0,{predicate:()=>!this.props.isDeletingGraph()&&!this.props.didDeleteGraphFail()},()=>jt.createElement("div",{role:jt.const("link"),tabindex:jt.const(0),class:()=>({"graph-link":!0,"dcg-action-preview-graph":!0,"example-graph":this.props.isExample()}),didMount:this.bindFn(this.didMount)},jt.createElement("span",{class:jt.const("dcg-thumb"),style:this.const({"background-image":`url(${this.props.getThumbURL()})`})}),jt.createElement("div",{class:jt.const("dcg-graph-details")},jt.createElement("div",{class:jt.const("dcg-title")},this.props.getTitle),jt.createElement("div",{class:jt.const("dcg-subtitle dcg-graph-date")},()=>this.props.isExample()?this.props.s("account-shell-label-mygraphs-example"):this.props.getDisplayDate())))),jt.createElement($0,{predicate:this.props.isDeletingGraph},()=>jt.createElement("div",{"aria-live":jt.const("assertive"),"aria-atomic":jt.const("true"),class:jt.const("deleting"),handleEvent:jt.const("true"),onTap:()=>{this.props.canCancelDelete()&&this.props.cancelDeleteGraph()}},()=>this.props.s("account-shell-text-mygraphs-deleting"),jt.createElement($0,{predicate:this.props.canCancelDelete},()=>jt.createElement("div",{role:jt.const("button"),tabindex:jt.const(0),class:jt.const("cancel-delete")},()=>this.props.s("account-shell-button-mygraphs-cancel"))))),jt.createElement($0,{predicate:this.props.didDeleteGraphFail},()=>jt.createElement("div",{"aria-live":jt.const("assertive"),"aria-atomic":jt.const("true"),class:jt.const("retry-delete"),handleEvent:jt.const("true")},()=>this.props.s("account-shell-error-mygraphs-error-deleting"),jt.createElement("a",{role:jt.const("button"),tabindex:jt.const(0),class:jt.const("dcg-action-removegraph"),onTap:this.props.requestDeleteGraph},()=>this.props.s("account-shell-button-mygraphs-try-again")),()=>this.props.s("account-shell-text-mygraphs-or"),jt.createElement("a",{role:jt.const("button"),tabindex:jt.const(0),class:jt.const("dcg-action-cancelremovegraph"),onTap:this.props.cancelDeleteGraph},()=>this.props.s("account-shell-button-mygraphs-cancel")))),jt.createElement($0,{predicate:()=>!this.props.isExample()&&!this.props.isDeletingGraph()&&!this.props.didDeleteGraphFail()},()=>jt.createElement("span",{class:jt.const("actions"),handleEvent:jt.const("true")},jt.createElement("span",{role:jt.const("button"),tabindex:jt.const(0),"aria-label":()=>this.props.s("account-shell-button-mygraphs-delete-title",{graphTitle:this.props.getTitle()}),class:jt.const("dcg-action-removegraph"),onTap:this.props.requestDeleteGraph},jt.createElement($e,{tooltip:()=>this.props.s("account-shell-button-mygraphs-delete-graph"),gravity:this.const("e")},jt.createElement("i",{class:jt.const("dcg-icon-remove"),"aria-hidden":jt.const("true")}))))))}didUpdate(){this.props.isSelected()&&ie(this.node).trigger("focus")}didMount(e){this.node=e,ie(this.node).on("focus",()=>{this.props.isSelected()||this.props.onFocus()})}};var Es=__dcg_shared_module_exports__['e'](te());var Si=__dcg_shared_module_exports__['e'](te());var{If:zL,IfElse:wfe}=Si.Components,KL=class extends Si.Class{shouldShowSaveButton(){return!this.props.isSaving()&&!this.props.didSaveRecentlySucceed()&&!this.props.didSaveRecentlyFail()}template(){return Si.createElement("div",{class:Si.const("save-btn-container")},Si.createElement(zL,{predicate:()=>this.shouldShowSaveButton()},()=>Si.createElement("div",{role:Si.const("button"),onTap:this.props.onTap,class:()=>({"dcg-action-save":!0,"dcg-btn-primary":this.props.enabled(),"dcg-disabled":!this.props.enabled()}),"aria-disabled":()=>!this.props.enabled(),tabindex:()=>this.props.enabled()?0:-1},wfe(()=>!this.props.isSyncing()&&this.props.willSaveCopy(),{true:()=>Si.createElement("span",null,()=>this.props.s("account-shell-button-save-copy")),false:()=>Si.createElement("span",null,()=>this.props.s("account-shell-button-mygraphs-save"))}))),Si.createElement(zL,{predicate:this.props.isSaving},()=>Si.createElement("div",{class:Si.const("save-saving")},Si.createElement("span",{class:Si.const("dcg-spinner-dark")}))),Si.createElement(zL,{predicate:this.props.didSaveRecentlyFail},()=>Si.createElement("div",{class:Si.const("save-error"),"aria-live":Si.const("assertive"),"aria-atomic":Si.const("true")},Si.createElement("i",{class:Si.const("dcg-icon-remove"),"aria-hidden":Si.const("true")}),Si.const(" "),()=>this.props.s("account-shell-text-error"))),Si.createElement(zL,{predicate:this.props.didSaveRecentlySucceed},()=>Si.createElement("div",{class:Si.const("save-success")},Si.createElement("i",{class:Si.const("dcg-icon-check"),"aria-hidden":Si.const("true")}),Si.const(" "),()=>this.props.s("account-shell-text-saved"))))}};var qL=class extends Es.Class{template(){return Es.createElement("div",{class:Es.const("graph-link-container graph-in-progress")},Es.createElement("div",{role:Es.const("link"),"aria-label":()=>this.props.s("account-shell-button-mygraphs-save"),class:Es.const("graph-link dcg-action-preview-graph"),onTap:this.props.openSaveDialog},Es.createElement("span",{class:Es.const("dcg-thumb"),style:()=>({"background-image":`url(${this.props.getThumbnail()})`})}),Es.createElement("div",{class:Es.const("dcg-graph-details")},Es.createElement("div",{class:Es.const("dcg-title")},this.props.getTitle),Es.createElement("div",{class:Es.const("dcg-subtitle dcg-save-status")},()=>this.props.isSaveEnabled()?this.props.wasCurrentGraphEverSaved()?this.props.s("account-shell-label-mygraphs-last-saved",{date:this.props.getDisplayDate()}):this.props.s("account-shell-label-mygraphs-unsaved-graph"):this.props.s("account-shell-label-mygraphs-no-unsaved-changes"))),Es.createElement(KL,{enabled:this.props.isSaveEnabled,isSaving:this.props.isSaving,didSaveRecentlySucceed:this.props.didSaveRecentlySucceed,didSaveRecentlyFail:this.props.didSaveRecentlyFail,isSyncing:this.props.isSyncing,willSaveCopy:this.props.willSaveCopy,onTap:()=>{},s:this.props.s})))}shouldUpdate(){return this.props.isOpen()}};var Gr=__dcg_shared_module_exports__['e'](te());qt();var{Input:vfe,If:HL}=Gr.Components,WQ=4,WL=class extends Gr.Class{willUpdate(){this.props.isSearching()||this.setSearchValue("")}setSearchValue(e){this.searchValue!==e&&(this.searchValue=e,this.props.updateFilter(e))}init(){this.controller=this.props.controller(),this.searchValue=""}template(){return Gr.createElement("div",{class:Gr.const("dcg-user-bar")},Gr.createElement(HL,{predicate:()=>!this.props.isSearching()},()=>Gr.createElement("div",{class:Gr.const("dcg-account-link-container")},Gr.createElement("button",{class:Gr.const("dcg-unstyled-button dcg-account-link"),"dcg-menu-button":Gr.const("account-mygraphs"),"aria-haspopup":Gr.const("true"),"aria-expanded":()=>this.controller.getOpenMenu()==="account-mygraphs","aria-label":()=>this.props.s("account-shell-label-account-information"),onTap:e=>{var t;if(this.measureAccountDropdownArrowOffset(),this.props.controller().dispatch({type:"toggle-menu",payload:"account-mygraphs"}),e.device=="keyboard"){let o=this.props.controller().getOpenMenu()==="account-mygraphs"?".dcg-action-accountsettings":".dcg-account-link";(t=document.querySelector(o))==null||t.focus()}}},Gr.createElement("span",{class:Gr.const("dcg-variable-name")},()=>this.controller.userController.getFirstName()),Gr.createElement("i",{class:Gr.const("dcg-icon-caret-down"),"aria-hidden":Gr.const("true")})),Gr.createElement(HL,{predicate:()=>this.controller.getOpenMenu()==="account-mygraphs"},()=>Gr.createElement(tv,{type:this.const("account-mygraphs"),controller:this.const(this.controller),left:this.const(WQ),arrowLeft:this.const(this.accountDropdownArrowOffset-WQ)})))),Gr.createElement(HL,{predicate:()=>!this.props.isSearching()},()=>Gr.createElement("div",{role:Gr.const("link"),tabindex:Gr.const("0"),class:Gr.const("dcg-search-btn"),onTap:e=>{var t;e.preventDefault(),this.props.openSearch(),(t=document.querySelector(".search-container input"))==null||t.focus()}},Gr.createElement("i",{class:Gr.const("dcg-icon-search search-icon"),"aria-hidden":Gr.const("true")}),Gr.createElement("span",{class:Gr.const("dcg-menu-title")},()=>this.props.s("account-shell-heading-title-mygraphs-search")))),Gr.createElement(HL,{predicate:()=>this.props.isSearching()},()=>Gr.createElement("div",{role:Gr.const("search"),class:Gr.const("search-container search-open")},Gr.createElement("i",{class:Gr.const("dcg-icon-search search-icon"),"aria-hidden":Gr.const("true")}),Gr.createElement(vfe,{placeholder:()=>this.props.s("account-shell-text-mygraphs-search-by-title"),onInput:this.bindFn(this.setSearchValue),onFocus:this.props.openSearch,value:()=>this.searchValue,didMount:this.bindFn(this.didMountSearch)}),Gr.createElement("span",{role:Gr.const("button"),tabindex:Gr.const(0),"aria-label":()=>this.props.s("account-shell-heading-title-mygraphs-search"),class:Gr.const("dcg-icon-remove dcg-action-close-search"),onTap:e=>{e.preventDefault(),this.props.closeSearch()}}))))}didMountSearch(e){ie(e).on("blur",()=>{e.value||this.props.closeSearch()})}measureAccountDropdownArrowOffset(){var a,s;let e=this.findRootNode().querySelector(".dcg-account-link i"),t=e&&go(e),i=(a=t==null?void 0:t.left)!=null?a:0,o=(s=e==null?void 0:e.getBoundingClientRect().width)!=null?s:0,n=i+o/2;this.accountDropdownArrowOffset=n}};var Fi=__dcg_shared_module_exports__['e'](te());var ti=__dcg_shared_module_exports__['e'](te());var{If:$L}=ti.Components,_m=class extends ti.Class{template(){return ti.createElement("div",{class:ti.const("dcg-loading-container")},ti.createElement($L,{predicate:()=>!this.props.didDataLoadFail()},()=>ti.createElement("div",{class:ti.const("dcg-graph-loading")},ti.createElement("div",{class:ti.const("pulsing-message")},()=>this.props.s("account-shell-text-mygraphs-loading")),ti.createElement("div",{role:ti.const("link"),tabindex:ti.const("0"),class:ti.const("dcg-cancel-while-loading"),onTap:this.props.onCancel},()=>this.props.s("account-shell-button-mygraphs-cancel")))),ti.createElement($L,{predicate:()=>this.props.didDataLoadFail()},()=>ti.createElement("div",{class:ti.const("dcg-graph-loading-error"),"aria-live":ti.const("assertive"),"aria-atomic":ti.const("true")},ti.createElement("div",{class:ti.const("dcg-graph-loading-error-title")},()=>this.props.s("account-shell-error-mygraphs-error-loading")),ti.createElement("div",{class:ti.const("dcg-graph-loading-error-subtitle")},()=>this.props.s("account-shell-error-mygraphs-check-connection")),ti.createElement("div",{class:ti.const("dcg-graph-loading-error-options")},ti.createElement("span",{role:ti.const("button"),tabindex:ti.const("0"),class:ti.const("dcg-action-try-again dcg-btn-blue dcg-btn-medium"),onTap:this.props.requestLoadGraphData},()=>this.props.s("account-shell-button-mygraphs-try-again")),ti.createElement($L,{predicate:()=>!!this.props.onCancel},()=>ti.createElement("span",null,()=>this.props.s("account-shell-text-mygraphs-or"))),ti.createElement($L,{predicate:()=>!!this.props.onCancel},()=>ti.createElement("span",{role:ti.const("button"),tabindex:ti.const("0"),class:ti.const("dcg-action-cancel dcg-btn-light-gray dcg-btn-medium"),onTap:this.props.onCancel},()=>this.props.s("account-shell-button-mygraphs-cancel")))))))}};var{If:Cfe}=Fi.Components,jL=class extends Fi.Class{didMountGraphPreview(e){return this.graphPreview=e,this.updateGraphPreviewTop()}didMountArrow(e){return this.arrow=e,this.updateArrowTop()}didMountCalc(e){return this.previewCalc=this.props.makeAPI(e),this.updatePreviewCalc()}willUnmountCalc(){this.previewCalc&&this.previewCalc.destroy&&this.previewCalc.destroy()}didUpdate(){return this.updateGraphPreviewTop(),this.updateArrowTop(),this.updatePreviewCalc()}updateGraphPreviewTop(){this.graphPreview.style.top=this.getTopOffset()+"px"}updateArrowTop(){this.arrow.style.top=this.getArrowOffset()+"px"}updatePreviewCalc(){let e=this.props.getGraphData();e!==this.cachedGraphData&&(this.cachedGraphData=e,this.previewCalc.setState(e),this.previewCalc.resize())}getMaxTop(){return window.innerHeight-this.graphPreview.offsetHeight-10}getIdealTop(){let e=this.props.alignToNode();return e==null?null:go(e).top+.5*e.offsetHeight-60}getTopOffset(){let e=this.getIdealTop();if(e==null)return 0;let t=this.getMaxTop();return Math.min(e,t)}getArrowOffset(){let e=this.getIdealTop();if(e==null)return 60;let t=this.getTopOffset();return 60+e-t}template(){return Fi.createElement("div",{class:Fi.const("graph-preview"),didMount:this.bindFn(this.didMountGraphPreview)},Fi.createElement("div",{class:Fi.const("dcg-graph-preview-info")},Fi.createElement("h4",{class:Fi.const("dcg-title")},this.props.getTitle),Fi.createElement("span",{role:Fi.const("button"),tabindex:Fi.const("0"),class:Fi.const("dcg-action-cancel"),onTap:this.props.onCancel},Fi.createElement("i",{class:Fi.const("dcg-icon-remove"),"aria-hidden":Fi.const("true")}))),Fi.createElement("div",{class:Fi.const("preview-graph-area")},Fi.createElement(Cfe,{predicate:()=>!this.props.getGraphData()},()=>Fi.createElement(_m,{didDataLoadFail:this.props.didDataLoadFail,onCancel:this.props.onCancel,requestLoadGraphData:this.props.requestLoadGraphData,s:this.props.s.bind(this.props)})),Fi.createElement("div",{didMount:this.bindFn(this.didMountCalc),willUnmount:this.bindFn(this.willUnmountCalc),class:()=>({"dcg-preview-calculator":!0,"dcg-visible":this.props.getGraphData()})}),Fi.createElement("div",{class:()=>({"screenshot-clickjack":!0,"dcg-action-open-graph":!0,"dcg-visible":this.props.getGraphData()})},Fi.createElement("span",{role:Fi.const("button"),tabindex:Fi.const("0"),class:Fi.const("dcg-action-open-graph dcg-open-graph-btn dcg-btn-primary"),onTap:this.props.onOpenGraph},this.props.getOpenText))),Fi.createElement("div",{class:Fi.const("active-arrow"),didMount:this.bindFn(this.didMountArrow)},Fi.createElement("div",{class:Fi.const("dcg-graphic")})))}};var oa=__dcg_shared_module_exports__['e'](te());var{If:IN}=oa.Components,YL=class extends oa.Class{template(){return oa.createElement("div",{class:()=>({"syncing-status-bar":!0,visible:this.props.isSyncingGraphs()||this.props.didSyncFail()})},oa.createElement(IN,{predicate:this.props.isSyncingGraphs},()=>oa.createElement("div",{class:oa.const("syncing-status-text")},oa.createElement("span",{class:oa.const("dcg-pulse")},()=>this.props.s("account-shell-text-mygraphs-updating-graphs")))),oa.createElement(IN,{predicate:()=>!this.props.isSyncingGraphs()&&!this.props.didSyncFail()},()=>oa.createElement("div",{class:oa.const("success-status-text")},oa.createElement("i",{class:oa.const("dcg-icon-check"),"aria-hidden":oa.const("true")}),oa.const(" "),()=>this.props.s("account-shell-text-mygraphs-synced"))),oa.createElement(IN,{predicate:this.props.didSyncFail},()=>oa.createElement("div",{class:oa.const("error-status-text"),onTap:this.props.requestSyncGraphs},()=>this.props.s("account-shell-button-mygraphs-offline-try-again"))))}};var Ns=__dcg_shared_module_exports__['e'](te());var XL=class extends Ns.Class{init(){this.controller=this.props.controller()}template(){return Ns.createElement("div",{class:Ns.const("dcg-account-reminder")},Ns.createElement("span",{class:Ns.const("dcg-login")},Ns.createElement("a",{role:Ns.const("link"),tabindex:Ns.const(0),class:Ns.const("dcg-sign-in dcg-action-login dcg-btn-white-outline"),onTap:this.props.onSignIn},()=>this.props.controller().s("account-shell-button-log-in")),()=>this.props.controller().s("account-shell-text-or"),Ns.createElement("a",{role:Ns.const("link"),tabindex:Ns.const(0),class:Ns.const("dcg-create-account dcg-btn dcg-btn-primary dcg-tool-color dcg-action-createaccount"),onTap:this.props.onCreateAccount},()=>this.props.controller().s("account-shell-button-sign-up"))),Ns.createElement("div",null,()=>this.getToSaveYourText()))}getToSaveYourText(){return this.controller.product==="graphing"?this.controller.s("account-shell-text-mygraphs-to-save-graphs"):this.controller.product==="geometry"?this.controller.s("account-shell-text-mygraphs-to-save-constructions"):""}};var Au=__dcg_shared_module_exports__['e'](te()),_b=class extends Au.Class{template(){return Au.createElement("div",{class:Au.const("dcg-mygraphs-section-title-container")},Au.createElement("span",{role:Au.const("heading"),"aria-level":Au.const("1"),class:Au.const("dcg-mygraphs-section-title")},()=>this.props.title()))}};var{If:ya,For:AN,IfElse:$Q}=Ce.Components,JL="default",jh="search",Efe=50,QL=class extends Ce.Class{constructor(){super(...arguments),this.state="default"}didUpdate(){if(this.previewGraph){let e=this.getSelectedNode();e&&yc(e,this.scrollableNode,60)&&this.update()}}didMountScrollable(e){this.scrollableNode=e,ie(this.scrollableNode).on("focusin",i=>{if(this.previewGraph&&!i.target.classList.contains("graph-link"))return this.previewItem(void 0)}),ie(window).on("keydown",i=>{if(!this.props.isOpen())return!0;switch(Be(i)){case un:return this.selectUp(i);case hn:return this.selectDown(i)}});let t=__dcg_shared_module_exports__['z'](this.hidePreviewIfTooScrolled.bind(this),200);ie(this.scrollableNode).on("scroll",t),this.debouncedFetchSelectedGraph=__dcg_shared_module_exports__['A'](this.fetchSelectedGraph.bind(this),200)}fetchSelectedGraph(){return this.props.graphsController().loadDataForGraph(this.previewGraph)}hidePreviewIfTooScrolled(){if(!this.previewGraph)return;let e=this.getSelectedNode();if(!e)return;let t=this.findRootNode().querySelector(".active-arrow")||void 0,i=go(e),o=e.getBoundingClientRect().height,n=go(t);if(i===void 0||o===void 0||n===void 0)return;let a=i.top+.5*o,s=n.top;Math.abs(a-s)>10&&this.previewItem(void 0)}openSearch(){this.state=jh,this.previewItem(void 0)}closeSearch(){this.state=JL,this.previewItem(void 0)}updateFilter(e){this.filter=e,this.update()}getMaxGraphs(){return this.maxGraphs||Efe}getCountRemaining(){return this.getSavedGraphs().length-this.getMaxGraphs()}showMoreGraphs(e){let t=this.getMaxGraphs();if(this.getCountRemaining()<2*t?this.maxGraphs=1/0:this.maxGraphs=2*t,this.update(),(e!=null?e.device:void 0)==="keyboard"){let i=this.getSavedAndExampleGraphs(),o=i?i[t]:void 0;o&&this.previewItem(o)}}getSelectedNode(){return document.querySelector(".dcg-mygraphs .graph-link-container.dcg-selected")}selectUp(e){if(!this.previewGraph)return;e.preventDefault();let t=this.getSavedAndExampleGraphs();if(!t.length)return;let i=this.previewGraph?this.previewGraph.hash:void 0,o=__dcg_shared_module_exports__['x'](__dcg_shared_module_exports__['m'](t,"hash"),i),n=t?t[o-1]:void 0;n?n&&this.previewItem(n):this.newGraph&&ie(this.newGraph).trigger("focus")}selectDown(e){if(!this.previewGraph)return;let t=this.getSavedAndExampleGraphs();if(!t.length)return;e.preventDefault();let i=this.previewGraph?this.previewGraph.hash:void 0,o=__dcg_shared_module_exports__['x'](__dcg_shared_module_exports__['m'](t,"hash"),i),n=t?t[o+1]:void 0;n&&(!n.example&&o+1>=this.getMaxGraphs()&&this.showMoreGraphs(),this.previewItem(n))}getFilter(){return this.state===jh&&this.filter?this.filter:""}getRecoveryGraphs(){return this.props.graphsController().getRecoveryGraphs()}attemptRecovery(){this.controller.mygraphsController.recoveryAttempted=!0,this.controller.graphsController.fetchRecoveryGraphs(),this.update()}hasAttemptedRecovery(){return this.controller.mygraphsController.hasAttemptedRecovery()&&!this.isAttemptingRecovery()}isAttemptingRecovery(){return this.controller.graphsController.isLoadingRecoveryGraphs}shouldShowAttemptRecoveryText(){return this.graphsController.isRecoveryUIEnabledForProduct()?!this.hasAttemptedRecovery():!1}getSavedGraphs(){return this.props.graphsController().getSavedGraphs()}getExampleGraphs(){return this.props.graphsController().getExampleGraphs()}getSavedAndExampleGraphs(){return this.props.graphsController().getSavedAndExampleGraphs()}filterGraphs(e){let t=this.getFilter().toLowerCase();return t?e.filter(i=>this.sanitizeTitle(i).toLowerCase().indexOf(t)>=0):e}sliceGraphs(e){return e.slice(0,this.getMaxGraphs())}canShowMore(e){return e.length>this.getMaxGraphs()}onFocusGraph(e){this.isSmallScreen()||this.previewItem(e)}onTapGraph(e,t){this.isSmallScreen()||t.device==="keyboard"?this.openGraphWithCover(e):this.previewGraph!==e&&this.previewItem(e)}previewItem(e){this.previewGraph&&(this.previewGraph=void 0),e&&(this.previewGraph=e,this.debouncedFetchSelectedGraph()),this.update()}isSmallScreen(){let e=window.platform;return document.body.getBoundingClientRect().width<650||e==="ios"||e==="android"}onOpenPreviewGraph(){if(!this.previewGraph)return;let{previewGraph:e}=this;this.previewItem(void 0),this.props.onOpenGraph(e)}openGraphWithCover(e){if(this.graphWithCover=e,this.previewItem(void 0),e!==void 0)return setTimeout(async()=>{try{if(await this.props.graphsController().loadGraphImmediately(e),!this.graphWithCover)return;this.props.openGraphBehindCover(e).then(this.bindIfMounted(()=>{this.graphWithCover=void 0,this.update()}))}catch(t){}this._isMounted&&this.update()},250)}cancelLoadGraphWithCover(){this.graphWithCover=void 0,this.update()}didDataLoadFail(e){return e?this.props.graphsController().didDataLoadFail(e):!1}willUpdate(){(!this.props.isOpen()||!this.controller.userController.isLoggedIn())&&(this.state=JL)}didMountNewGraph(e){return this.newGraph=e,ie(this.newGraph).on("keydown",t=>{if(Be(t)!==hn)return;let i=this.getSavedAndExampleGraphs();return this.previewItem(i[0]),t.preventDefault(),t.stopPropagation()})}sanitizeTitle(e){return e.i18nKey?this.controller.s(e.i18nKey):e.title||this.graphsController.getUntitledString()}async hideGraphsAndShowArtContest(e){if(this.props.closeDrawer(),this.isSmallScreen())try{let i=(await ev(this.controller.getProduct())).filter(o=>!(o!=null&&o.submitting_for_someone_else));this.props.controller().dispatch({type:"show-modal",modal:"contest-submission",device:e.device,currentSubmission:i[0]})}catch(t){this.controller.api.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("frontpage-error-something-went-wrong-try-again-later")}})}else this.props.controller().dispatch({type:"toggle-menu",payload:"art-contest"})}init(){this.state=JL,this.controller=this.props.controller(),this.graphsController=this.controller.graphsController}template(){return Ce.createElement("div",{class:()=>({"dcg-mygraphs":!0,"logged-in":this.controller.userController.isLoggedIn(),"preview-mode":!!this.props.previewMode(),"maintenance-mode":!!this.props.maintenanceMode()})},Ce.createElement("div",{class:Ce.const("dcg-resources-container")},Ce.createElement(ya,{predicate:()=>this.props.accountsEnabled()&&!this.controller.userController.isLoggedIn()&&!this.props.previewMode()&&!this.props.maintenanceMode()},()=>Ce.createElement(XL,{onCreateAccount:this.props.onCreateAccount,onSignIn:this.props.onSignIn,controller:this.props.controller})),Ce.createElement(ya,{predicate:()=>this.controller.userController.isLoggedIn()},()=>Ce.createElement("div",null,Ce.createElement(ya,{predicate:()=>this.controller.userController.isLoggedIn()&&this.state===JL},()=>Ce.createElement(YL,{isSyncingGraphs:()=>this.props.graphsController().isSyncing(),didSyncFail:()=>this.props.graphsController().didSyncFail(),requestSyncGraphs:this.props.refreshGraphs,s:this.controller.s})),Ce.createElement(WL,{controller:this.props.controller,openSearch:this.bindFn(this.openSearch),closeSearch:this.bindFn(this.closeSearch),updateFilter:this.bindFn(this.updateFilter),isSearching:()=>this.state===jh,s:this.controller.s}))),Ce.createElement("div",{class:Ce.const("dcg-scrollable"),didMount:this.bindFn(this.didMountScrollable)},Ce.createElement("div",{class:Ce.const("dcg-scrollable-interior")},Ce.createElement(ya,{predicate:this.props.maintenanceMode},()=>Ce.createElement("div",{class:Ce.const("maintenance-mode")},()=>this.controller.s("account-shell-text-mygraphs-maintenance-mode"))),Ce.createElement(ya,{predicate:this.props.previewMode},()=>Ce.createElement("div",{class:Ce.const("maintenance-mode")},()=>{var e;return(e=this.props.previewMode())==null?void 0:e.message},Ce.createElement("br",null),Ce.createElement("a",{tabindex:Ce.const("0"),class:Ce.const("dcg-btn-primary"),href:()=>{var e;return(e=this.props.previewMode())==null?void 0:e.url},target:Ce.const("_blank")},()=>this.controller.s("account-shell-text-mygraphs-share-thoughts")))),Ce.createElement(ya,{predicate:()=>this.state!==jh&&this.controller.shouldShowArtContestNudge()},()=>Ce.createElement("button",{onTap:this.bindFn(this.hideGraphsAndShowArtContest),class:Ce.const("dcg-sidebar-contest-submit")},Ce.createElement("span",{class:Ce.const("dcg-trophy-icon")},Ce.const("\u{1F3C6}")),Ce.const(" "),Ce.createElement(yi,{i18n:this.const(this.controller),key:this.const("account-shell-text-mygraphs-contest-submit-to-contest")},Ce.createElement("span",{class:Ce.const("dcg-contest-submit-message")},Ce.const("Submit this graph to the"),Ce.const(" "),Ce.createElement("span",{class:Ce.const("dcg-bold-text")},Ce.const("Global Math Art Contest!")))))),Ce.createElement(ya,{predicate:()=>this.state!==jh},()=>Ce.createElement("div",{role:Ce.const("link"),tabindex:Ce.const("0"),class:Ce.const("new-blank-graph dcg-action-newblankgraph"),onTap:()=>(this.previewItem(void 0),this.props.openBlankGraph()),didMount:this.bindFn(this.didMountNewGraph)},Ce.createElement("div",{class:Ce.const("new-blank-graph-inner")},Ce.createElement("span",{class:Ce.const("dcg-add-blank")},Ce.createElement("i",{class:Ce.const("dcg-icon-plus"),"aria-hidden":Ce.const("true")})),Ce.createElement("span",{class:Ce.const("dcg-new-graph-title")},()=>this.props.controller().getProduct()==="geometry"?this.controller.s("account-shell-text-mygraphs-new-construction"):this.controller.s("account-shell-text-mygraphs-new-blank-graph"))))),Ce.createElement(ya,{predicate:()=>!this.props.maintenanceMode()&&!this.props.previewMode()&&this.controller.userController.isLoggedIn()&&this.state!==jh},()=>Ce.createElement("div",null,Ce.createElement(_b,{title:()=>this.props.controller().getProduct()==="geometry"?this.controller.s("account-shell-text-mygraphs-current-construction"):this.controller.s("account-shell-text-mygraphs-current-graph")}),Ce.createElement(qL,{getTitle:()=>this.getPreviewTitle(),getDisplayDate:()=>this.controller.unpack(this.props.graphsController().getCurrentDisplayDate()),isOpen:this.props.isOpen,getThumbnail:this.props.getThumbnail,isSaveEnabled:this.props.isSaveEnabled,simpleSave:()=>(this.props.simpleSave(),this.previewItem(void 0)),openSaveDialog:()=>(this.props.openSaveDialog(),this.previewItem(void 0)),wasCurrentGraphEverSaved:()=>this.props.graphsController().wasCurrentGraphEverSaved(),isSaving:()=>this.props.graphsController().isSaving(),didSaveRecentlySucceed:()=>this.props.graphsController().didSaveSucceed(),didSaveRecentlyFail:()=>this.props.graphsController().didSaveFail(),isSyncing:()=>this.props.graphsController().isSyncing(),willSaveCopy:()=>this.props.graphsController().willSaveCopy(),s:this.controller.s}),Ce.createElement(ya,{predicate:this.bindFn(this.shouldShowAttemptRecoveryText)},()=>Ce.createElement("div",{class:Ce.const("dcg-lost-work-link")},$Q(()=>this.isAttemptingRecovery(),{true:()=>Ce.createElement("span",null,Ce.createElement("span",null,()=>this.controller.s("account-shell-text-mygraphs-attempting-recovery")),Ce.createElement("span",{class:Ce.const("dcg-spinner-dark")})),false:()=>Ce.createElement("span",null,Ce.createElement("span",null,()=>this.controller.s("account-shell-text-mygraphs-lost-work")+" "),Ce.createElement("span",{tabIndex:Ce.const("0"),role:Ce.const("link"),class:Ce.const("dcg-attempt-recovery"),onTap:this.bindFn(this.attemptRecovery)},()=>this.controller.s("account-shell-button-mygraphs-attempt-recovery")))}))))),Ce.createElement(ya,{predicate:()=>!this.props.maintenanceMode()&&!this.props.previewMode()&&this.controller.userController.isLoggedIn()&&this.hasAttemptedRecovery()&&this.state!==jh&&this.controller.graphsController.didFetchRecoveryGraphsFail()},()=>Ce.createElement("div",{class:Ce.const("no-matches"),"aria-live":Ce.const("assertive"),"aria-atomic":Ce.const("true")},()=>this.controller.s("account-shell-error-unknown"))),Ce.createElement(ya,{predicate:()=>!this.props.maintenanceMode()&&!this.props.previewMode()&&this.controller.userController.isLoggedIn()&&this.hasAttemptedRecovery()&&this.state!==jh&&!this.controller.graphsController.didFetchRecoveryGraphsFail()},()=>Ce.createElement("div",null,$Q(()=>this.getRecoveryGraphs().length>0,{true:()=>Ce.createElement("div",{class:Ce.const("dcg-recovery-graphs-list")},Ce.createElement(_b,{title:()=>this.controller.s("account-shell-heading-mygraphs-recovered-work")}),Ce.createElement(AN,{each:()=>this.getRecoveryGraphs(),key:e=>e.getCollectionKey()},Ce.createElement("div",{role:Ce.const("list")},e=>Ce.createElement(Ev,{onTap:t=>this.onTapGraph(e,t),onFocus:()=>this.onFocusGraph(e),cancelDeleteGraph:()=>this.props.graphsController().cancelDeleteGraph(e),requestDeleteGraph:()=>(this.previewItem(void 0),this.props.graphsController().requestDeleteGraph(e)),isDeletingGraph:()=>this.props.graphsController().isDeletingGraph(e),canCancelDelete:()=>this.props.graphsController().canCancelDelete(e),didDeleteGraphFail:()=>this.props.graphsController().didDeleteGraphFail(e),isSelected:()=>e===this.previewGraph,isExample:Ce.const(!1),getDisplayDate:()=>this.controller.unpack(e.displayDate()),getTitle:()=>this.sanitizeTitle(e),getThumbURL:()=>e.thumbURL,s:this.controller.s})))),false:()=>Ce.createElement("div",{class:Ce.const("dcg-no-recovery-graphs")},()=>this.controller.s("account-shell-text-mygraphs-no-unsaved-graphs"))}))),Ce.createElement(ya,{predicate:()=>this.controller.userController.isLoggedIn()},()=>Ce.createElement(_b,{title:()=>this.props.controller().getProduct()==="geometry"?this.controller.s("account-shell-heading-mygraphs-saved-constructions"):this.controller.s("account-shell-heading-mygraphs-saved-graphs")})),Ce.createElement(AN,{each:()=>this.sliceGraphs(this.filterGraphs(this.getSavedGraphs())),key:e=>e.getCollectionKey()},Ce.createElement("div",{class:Ce.const("dcg-saved-graphs-list"),role:Ce.const("list")},e=>Ce.createElement(Ev,{onTap:t=>this.onTapGraph(e,t),onFocus:()=>this.onFocusGraph(e),cancelDeleteGraph:()=>this.props.graphsController().cancelDeleteGraph(e),requestDeleteGraph:()=>(this.previewItem(void 0),this.props.graphsController().requestDeleteGraph(e)),isDeletingGraph:()=>this.props.graphsController().isDeletingGraph(e),canCancelDelete:()=>this.props.graphsController().canCancelDelete(e),didDeleteGraphFail:()=>this.props.graphsController().didDeleteGraphFail(e),isSelected:()=>e===this.previewGraph,isExample:Ce.const(!1),getDisplayDate:()=>this.controller.unpack(e.displayDate()),getTitle:()=>this.sanitizeTitle(e),getThumbURL:()=>e.thumbURL,s:this.controller.s}))),Ce.createElement(ya,{predicate:()=>this.controller.userController.isLoggedIn()&&this.controller.graphsController.didSyncFail()},()=>Ce.createElement("div",{"aria-live":Ce.const("assertive"),"aria-atomic":Ce.const("true"),class:Ce.const("no-matches")},()=>this.controller.s("account-shell-error-unknown"))),Ce.createElement(ya,{predicate:()=>this.controller.userController.isLoggedIn()&&!this.controller.graphsController.didSyncFail()&&this.filterGraphs(this.getSavedGraphs()).length===0},()=>Ce.createElement("div",{"aria-live":Ce.const("assertive"),"aria-atomic":Ce.const("true"),class:Ce.const("no-matches")},()=>this.state===jh?this.controller.s("account-shell-text-mygraphs-no-search-results"):this.controller.s("account-shell-text-mygraphs-no-saved-graphs"))),Ce.createElement(ya,{predicate:()=>this.canShowMore(this.filterGraphs(this.getSavedGraphs()))},()=>Ce.createElement("div",{class:Ce.const("dcg-show-more-graphs"),onTap:this.bindFn(this.showMoreGraphs),role:Ce.const("button"),tabindex:Ce.const("0")},()=>this.controller.s("account-shell-text-mygraphs-count-more",{count:this.getCountRemaining()}))),Ce.createElement(ya,{predicate:()=>this.getExampleGraphs().length>0},()=>Ce.createElement(_b,{title:()=>this.controller.s("account-shell-heading-mygraphs-examples")})),Ce.createElement(AN,{each:()=>this.filterGraphs(this.getExampleGraphs()),key:e=>e.getCollectionKey()},Ce.createElement("div",{role:Ce.const("list")},e=>Ce.createElement(Ev,{onTap:t=>this.onTapGraph(e,t),onFocus:()=>this.onFocusGraph(e),cancelDeleteGraph:()=>{},requestDeleteGraph:()=>{},isDeletingGraph:Ce.const(!1),didDeleteGraphFail:Ce.const(!1),canCancelDelete:Ce.const(!1),isSelected:()=>e===this.previewGraph,isExample:Ce.const(!0),getDisplayDate:()=>this.controller.unpack(e.displayDate()),getTitle:()=>this.sanitizeTitle(e),getThumbURL:()=>e.thumbURL,s:this.controller.s}))),Ce.createElement(ya,{predicate:()=>this.getFilter()?this.filterGraphs(this.getExampleGraphs()).length===0:!1},()=>Ce.createElement("div",{"aria-live":Ce.const("assertive"),"aria-atomic":Ce.const("true"),class:Ce.const("no-matches")},()=>this.controller.s("account-shell-text-mygraphs-no-examples-match-search"))),Ce.createElement("div",{class:Ce.const("dcg-mygraphs-legal")},Ce.createElement("a",{href:Ce.const("/terms"),target:Ce.const("_blank")},()=>this.controller.s("account-shell-link-terms")),Ce.const("|"),Ce.createElement("a",{href:Ce.const("/privacy"),target:Ce.const("_blank")},()=>this.controller.s("account-shell-link-privacy")),Ce.createElement(ya,{predicate:()=>!!this.props.versionNumber()},()=>Ce.createElement("div",{class:Ce.const("dcg-version")},()=>this.controller.s("account-shell-text-mygraphs-version"),Ce.const(" "),this.props.versionNumber))))),Ce.createElement(ya,{predicate:()=>!!this.previewGraph},()=>Ce.createElement(jL,{alignToNode:()=>this.getSelectedNode(),getTitle:()=>this.previewGraph?this.sanitizeTitle(this.previewGraph):"",getGraphData:()=>this.previewGraph?this.previewGraph.graphData:void 0,onCancel:()=>this.previewItem(void 0),didDataLoadFail:()=>this.didDataLoadFail(this.previewGraph),requestLoadGraphData:this.bindFn(this.fetchSelectedGraph),onOpenGraph:this.bindFn(this.onOpenPreviewGraph),s:this.controller.s,makeAPI:this.props.makeAPI,getOpenText:()=>this.controller.getOpenText()}))),Ce.createElement(ya,{predicate:this.props.isOpen},()=>Ce.createElement("div",{role:Ce.const("link"),tabindex:Ce.const("0"),class:Ce.const("dcg-resources-cover dcg-action-close-resources"),style:()=>({opacity:this.previewGraph?.6:0}),onTap:()=>this.previewGraph?this.previewItem(void 0):this.props.closeDrawer(),"aria-label":()=>this.previewGraph?this.controller.s("account-shell-button-mygraphs-close-graph-preview"):this.controller.s("account-shell-button-mygraphs-close-graph-list")})),Ce.createElement(ya,{predicate:()=>!!this.graphWithCover},()=>Ce.createElement("div",{class:Ce.const("dcg-fullscreen-loading-container")},Ce.createElement(_m,{didDataLoadFail:()=>this.didDataLoadFail(this.graphWithCover),onCancel:this.bindFn(this.cancelLoadGraphWithCover),requestLoadGraphData:()=>this.openGraphWithCover(this.graphWithCover),s:this.controller.s}))))}getPreviewTitle(){return this.graphsController.getCurrentGraphTitle()||this.graphsController.getUntitledString()}};var ZL=class extends eP.Class{init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController,this.mygraphsController=this.controller.mygraphsController}template(){return eP.createElement(QL,{isOpen:()=>this.mygraphsController.isMygraphsOpen(),graphsController:()=>this.graphsController,maintenanceMode:()=>this.controller.isInMaintenanceMode(),previewMode:()=>this.controller.getPreviewParams(),accountsEnabled:this.const(!0),controller:()=>this.controller,closeDrawer:()=>this.controller.dispatch({type:"close-mygraphs"}),openBlankGraph:()=>this.mygraphsController.openBlankGraph(),onOpenGraph:e=>this.mygraphsController.onOpenGraph(e),openGraphBehindCover:e=>this.mygraphsController.openGraphBehindCover(e),onLogout:()=>this.controller.userController.logout(),onEditAccount:()=>this.controller.dispatch({type:"show-modal",modal:"account-settings",device:"mouse"}),onCreateAccount:()=>this.controller.dispatch({type:"show-modal",modal:"signup",device:"mouse"}),onSignIn:()=>this.controller.dispatch({type:"show-modal",modal:"login",device:"mouse"}),refreshGraphs:()=>this.graphsController.refreshGraphs(),getThumbnail:()=>this.mygraphsController.getThumbnail(),simpleSave:()=>this.controller.simpleSave(),openSaveDialog:()=>this.controller.openSaveDialog({fromSaveInProgress:!0}),versionNumber:()=>Pb.versionNumber,isSaveEnabled:()=>this.controller.isSaveEnabled(),makeAPI:this.props.makeAPI})}};as();af();var tP=class extends Yr{constructor(){super();this.loggedIn="not-checked";this.maintenanceMode=!1;this.logoutFailed=!1;this.loggingOut=!1;this.userId="";this.name="";this.email="";this.teacher=!1;this.featureFlags=[];this.emailVerificationStatus="";this.maintenanceMode=!!pr("maintenance"),hJ(()=>this.logout())}desmosLogin(t){return fJ(t).then(this.completeLogin.bind(this))}googleLogin(t){this.triggerEvent("googleLogin",t)}appleLogin(t){this.triggerEvent("appleLogin",t)}askServerIfLoggedIn(){return V3().then(this.completeLogin.bind(this),t=>{var i,o,n;t.status===503&&((n=(o=(i=t.responseJSON)==null?void 0:i.errors)==null?void 0:o[0])==null?void 0:n.key)==="maintenance_mode"?this.maintenanceMode=!0:this.maintenanceMode=!1,this.completeLogout()})}driveCallback(){return V3().then(this.completeLogin.bind(this),this.logout.bind(this))}createAccount(t){let i={...t,name:t.userProvidedName.given};return i.teacher===!1&&delete i.teacher,yJ(i).then(this.completeLogin.bind(this))}checkPendingDeletion(t){return bJ(t)}isTeacher(){return!!this.teacher}setNameLegacy(t){return vJ(t).then(i=>{this.name=i.name||"",this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)})}setNameDetail(t){return CJ(t).then(i=>{this.name=i.name||"",this.nameDetail=i.nameDetail,this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)})}recoverPassword(t){return EJ(t)}completeLogin(t){this.maintenanceMode=!1,this.loggedIn="logged-in",this.userId=t.userId||"",this.name=t.name||"",this.nameDetail=t.nameDetail,this.email=t.email||"",this.featureFlags=t.featureFlags||[],this.emailVerificationStatus=t.emailVerificationStatus||"",this.teacher=!!t.isTeacher,this.triggerEvent("loginChanged",void 0),this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)}async logout(){this.loggingOut=!0,this.triggerEvent("logout",void 0),this.triggerEvent("triggerRender",void 0);try{await A3(),this.completeLogout()}catch(t){this._onLogoutFailure()}finally{this.loggingOut=!1,this.triggerEvent("triggerRender",void 0)}}completeLogout(){this.loggedIn="logged-out",this.logoutFailed=!1,this.userId="",this.email="",this.name="",this.featureFlags=[],this.emailVerificationStatus="",this.teacher=!1,this.triggerEvent("loginChanged",void 0),this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)}_onLogoutFailure(){this.logoutFailed=!0,this.triggerEvent("triggerRender",void 0),setTimeout(()=>{this.logoutFailed=!1,this.triggerEvent("triggerRender",void 0)},2e3)}initiateAccountDeletion(t){return SJ(t)}getEmailChangeToken(){return oh(location.search,"changeToken")}initiateEmailChange(t){return DJ(t)}setEmail(t){return kJ(t).then(()=>{this.email=t.newEmail||"",this.emailVerificationStatus="VERIFYING",this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)})}updateFeatureFlags(t){return GJ(t).then(i=>{this.featureFlags=i.featureFlags,this.triggerEvent("userUpdated",void 0)})}getFeatureFlags(){return this.featureFlags}hasFeatureFlag(t){return this.featureFlags.some(i=>i===t)}getLoginStatus(){return this.loggedIn}isLoggedIn(){return this.loggedIn==="logged-in"}isMaintenanceMode(){return this.maintenanceMode}isLoggingOut(){return!!this.loggingOut}didLogoutFail(){return!!this.logoutFailed}getEmail(){return this.email}getFirstName(){return Sfe(this.name)}getFullName(){return this.name}getNameDetail(){return this.nameDetail}getUserId(){return this.userId}getVerificationStatus(){return this.emailVerificationStatus}getUserAsJSON(){if(this.isLoggedIn())return{email:this.email,name:this.name,emailVerificationStatus:this.emailVerificationStatus}}};function Sfe(r){if(!r)return"";if(r.match(/[\d@_&\.\']/))return r;var e=r.split(" ");return e[0].length>=3?e[0]:r}var _N={};__dcg_shared_module_exports__['d'](_N,{init:()=>Afe,next:()=>Mfe,nextSeed:()=>Ife});var VN=class{constructor(e){this.bauArc4=new LN(Dfe(e))}g(e){for(var t=Array(e),i=0;i<e;i++)t[i]=this.bauArc4.g(1);return t}},j0=256;function Vu(r){return r&j0-1}function Dfe(r){var e=r+"",t=[],i=0,o;for(o=0;o<e.length;o++)t[Vu(o)]=Vu((i^=t[Vu(o)]*19)+e.charCodeAt(o));return t}var LN=class{constructor(e){this.S=[];this.c=[];this.i=0;this.j=0;this.m=0;var t,i,o=e.length,n=0,a=0;for(o||(e=[o++]);n<j0;)this.S[n]=n++;for(n=0;n<j0;n++)t=this.S[n],a=Vu(a+t+e[n%o]),i=this.S[a],this.S[n]=i,this.S[a]=t;this.g(j0)}g(e){var t=this.S,i=Vu(this.i+1),o=t[i],n=Vu(this.j+o),a=t[n];t[i]=a,t[n]=o;for(var s=t[Vu(o+a)];--e;)i=Vu(i+1),o=t[i],n=Vu(n+o),a=t[n],t[i]=a,t[n]=o,s=s*j0+t[Vu(o+a)];return this.i=i,this.j=n,s}},kfe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",Gfe=kfe.toLowerCase(),Tfe=62,jQ=10,PN=class{constructor(e){if(!e||!e.length||e.length<32)throw new Error("You must supply a seed to RandomHashFactory. It should have at least 128 bits of entropy, but was "+e);this.arc4=new VN(e)}next(){for(var e=Array(jQ),t=0,i;t<jQ;)i=this.arc4.g(1)[0]>>2,i<Tfe&&(e[t]=Gfe[i],t++);return e.join("")}nextSeed(){for(var e=16,t=this.arc4.g(e),i=Array(e),o=0;o<e;o++)i[o]=t[o].toString(16),i[o].length===1&&(i[o]="0"+i[o]);return i.join("")}},Y0;function Mfe(){if(!Y0)throw"Random Hash Factory not initialized";return Y0.next()}function Ife(){if(!Y0)throw"Random Hash Factory not initialized";return Y0.nextSeed()}function Afe(r){Y0=new PN(r)}as();function ON(r,e){if(!e.hasOwnProperty("myConstructions"))throw new Error("Argument Error: saveConstruction options must specify myConstructions");if(!e.hasOwnProperty("isUpdate"))throw new Error("Argument Error: saveConstruction options must specify isUpdate");var t={state:r.graphData,parent_hash:r.parentHash,thumb_data:r.thumbURL,hash:r.hash,my_constructions:e.myConstructions,is_update:e.isUpdate,title:r.title||void 0};return ta("/api/v1/geometry/save",t).then(function(i){return ra.updateFromSync(r,i),r})}function RN(){return Ic("/api/v1/geometry/my_constructions")}function YQ(r){return ta("/api/v1/geometry/my_constructions/remove",{hash:r.hash})}var rP=class extends Yr{constructor({api:e,s:t,getLanguage:i,examplesJSON:o,randomSeed:n,product:a}){super(),this.product=a,this.api=e,this.s=t,this.getLanguage=i,this.previousGraph=void 0,this.recoveryParentHash=void 0,this.randomHash=_N,this._seedRandom(n),this.__savedGraphs=[],this.__recoveryGraphs=[];let s=o.map(ra.fromAjax);this.__exampleGraphs=__dcg_shared_module_exports__['i'](s,l=>!l.easterEgg),this.__easterEggGraphs=__dcg_shared_module_exports__['i'](s,l=>!!l.easterEgg),this.__graphInfoCache={},this.__exampleGraphs.forEach(l=>{this._addGraphToCache(l)}),this.__easterEggGraphs.forEach(l=>{this._addGraphToCache(l)}),this.lastSync=void 0,this.lastSaveFailureMessage="",this.recentSaveFailure=!1,this.recentSaveSuccess=!1,this.saving=!1,this.syncError=!1,this.isLoadingGraphs=!1,this.fetchRecoveryGraphsError=!1,this.currentGraph=new ra,this._enableLoadingGraphStates(),this.pageLoadTime=Date.now()}_seedRandom(e){if(!e){alert(this.s("account-shell-error-something-went-wrong",{error_num:"77361"}));return}let t=new Date,i=""+e+t.getTime()+t.getMilliseconds();this.randomHash.init(i)}requestDeleteGraph(e){let t=this._getCachedGraphInfo(e);t.canCancelDelete=!0,t.deleteTimeout=setTimeout(this._deleteGraph.bind(this,e),3e3),t.isDeletingGraph=!0,t.didDeleteGraphFail=!1,this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0)}_removeSavedGraphByHash(e){this.__savedGraphs=__dcg_shared_module_exports__['i'](this.__savedGraphs,t=>t.hash!==e)}_removeRecoveryGraphByHash(e){this.__recoveryGraphs=__dcg_shared_module_exports__['i'](this.__recoveryGraphs,t=>t.hash!==e)}async _deleteGraph(e){let t=e.hash,i=this._getCachedGraphInfo(e);i.canCancelDelete=!1,this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0);let o;switch(this.product){case"graphing":case"geometry-calculator":{o=KJ({hash:t,lang:this.getLanguage()});break}case"graphing-3d":{o=jJ(e);break}case"geometry":{o=YQ(e);break}}try{await o,this._removeSavedGraphByHash(t),this._removeRecoveryGraphByHash(t)}catch(n){i.didDeleteGraphFail=!0}finally{i.isDeletingGraph=!1,this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0)}}cancelDeleteGraph(e){let t=this._getCachedGraphInfo(e);clearTimeout(t.deleteTimeout),t.isDeletingGraph=!1,t.didDeleteGraphFail=!1,t.canCancelDelete=!1,this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0)}millisecondsSinceSync(){return this.lastSync?Date.now()-this.lastSync:1/0}clear(){this.lastSync=void 0,this.setSavedGraphsFromJSON([]),this.setRecoveryGraphsFromJSON([])}dismissSaveError(){this.recentSaveFailure=!1,this.triggerEvent("triggerRender",void 0)}_triggerSaveSuccess(){this.saving=!1,this.recentSaveSuccess=!0,this.lastSaveFailureMessage=void 0,this.triggerEvent("triggerRender",void 0),this.recentSaveTimeout=setTimeout(()=>{this.recentSaveSuccess=!1,this.triggerEvent("triggerRender",void 0)},3e3)}_triggerSaveError(e){let t=e.length&&e[0].message?e[0].message:this.s("account-shell-error-unexpected-error");this.saving=!1,this.recentSaveFailure=!0,this.lastSaveFailureMessage=t,this.triggerEvent("triggerRender",void 0),this.toast(t,{}),this.recentSaveTimeout=setTimeout(this.dismissSaveError.bind(this),3e3)}_updateGraphData(e){let t=JSON.stringify(this.api.getState());e.setProperty("graphData",t),e.setProperty("parentHash",e.hash),e.setProperty("recoveryParentHash",this.recoveryParentHash);let i=this.randomHash.next();e.setProperty("hash",i),this.recoveryParentHash=i;let o=this.api.screenshot({width:200,height:200,targetPixelRatio:2});e.setProperty("thumbURL",o)}_clearSaveTimeout(){this.recentSaveFailure=!1,this.recentSaveSuccess=!1,this.lastSaveFailureMessage=void 0,this.triggerEvent("triggerRender",void 0),clearTimeout(this.recentSaveTimeout)}async save(e){let t=e&&e.newTitle,i=!!(e&&e.saveCopy);if(this.isSaving())return;t&&(this.currentGraph.title=t),this._clearSaveTimeout(),this.saving=!0,this.triggerEvent("triggerRender",void 0);let o=this.currentGraph.copy();o.recovery&&(o.recovery=!1),this._updateGraphData(o);let n=!i&&this.wasCurrentGraphEverSaved(),a;switch(this.product){case"graphing":case"geometry-calculator":{a=fV(o,{myGraphs:!0,isUpdate:n,product:this.product,lang:this.getLanguage()});break}case"graphing-3d":{a=U3(o,{myGraphs:!0,isUpdate:n});break}case"geometry":{a=ON(o,{myConstructions:!0,isUpdate:n});break}}try{let s=await a;this.currentGraph=s.copy(),this._onCurrentGraphChanged(),this.triggerEvent("clearUnsavedChanges",void 0),this.triggerEvent("triggerRender",void 0),n&&this._removeSavedGraphByHash(s.parentHash),s.draft&&this._removeRecoveryGraphByHash(s.parentHash),this.__savedGraphs.unshift(s),this._addGraphToCache(s),this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0),this._triggerSaveSuccess()}catch(s){let l=(s==null?void 0:s.status)===413?[{message:this.s("account-shell-error-graph-too-large")}]:z3(s);this._triggerSaveError(l)}}shareGraph(){let e=this.currentGraph.copy();this._updateGraphData(e);let t;switch(this.product){case"graphing":case"geometry-calculator":{t=fV(e,{myGraphs:!1,isUpdate:!1,product:this.product,lang:this.getLanguage()});break}case"graphing-3d":{t=U3(e,{myGraphs:!1,isUpdate:!1});break}case"geometry":{t=ON(e,{myConstructions:!1,isUpdate:!1});break}}return t}saveRecoveryGraph(){switch(this.product){case"graphing":case"geometry-calculator":{let e=this.currentGraph.copy(),t=JSON.stringify(this.api.getState());e.setProperty("graphData",t),e.setProperty("parentHash",e.hash),e.setProperty("recoveryParentHash",this.recoveryParentHash);let i=this.randomHash.next()+this.randomHash.next();e.setProperty("hash",i),this.recoveryParentHash=i;let o=this.api.screenshot({width:200,height:200,targetPixelRatio:2});return e.setProperty("thumbURL",o),fV(e,{myGraphs:!1,isUpdate:!1,recovery:!0,product:this.product,lang:this.getLanguage()})}case"geometry":case"graphing-3d":throw new Error(`Programming Error: ${this.product} cannot save recovery graphs`)}}isCurrentGraphTitled(){return!!this.currentGraph.title&&!this.currentGraph.questHash}isCurrentGraphARecoveryGraph(){let e=this.currentGraph;if(!e||!e.hash)return!1;let t=e.hash;return __dcg_shared_module_exports__['k'](this.__recoveryGraphs,i=>i.hash===t)}wasCurrentGraphEverSaved(){let e=this.currentGraph;if(!e||!e.hash)return!1;let t=e.hash;return __dcg_shared_module_exports__['k'](this.__savedGraphs,i=>i.hash===t)}willSaveCopy(){let e=this.currentGraph;return!!e.questHash||!!e.hash&&!this.wasCurrentGraphEverSaved()}isSaveEnabled(){var e;return this.hasUnsavedChanges()?!0:(e=this.currentGraph)!=null&&e.hash?!this.wasCurrentGraphEverSaved():!1}isRecoveryUIEnabledForProduct(){return this.product==="graphing"||this.product==="geometry-calculator"}async fetchRecoveryGraphs(){let t=Date.now(),i;switch(this.isLoadingRecoveryGraphs=!0,this.fetchRecoveryGraphsError=!1,clearTimeout(this.fetchDurationTimeout),this.triggerEvent("triggerRender",void 0),this.product){case"graphing":case"geometry-calculator":{i=zJ({product:this.product,lang:this.getLanguage()});break}case"graphing-3d":throw new Error("code error: should not fetchRecoveryGraphs for 3d");case"geometry":throw new Error("code error: should not fetchRecoveryGraphs for geometry")}try{let o=await i;this.setRecoveryGraphsFromJSON(o.recoveryGraphs||o.recoveryConstructions)}catch(o){this.triggerEvent("onRecoveryGraphsError",void 0),this.fetchRecoveryGraphsError=!0}finally{let n=2e3-(Date.now()-t);this.isLoadingRecoveryGraphs=!1,n>0?this.fetchDurationTimeout=setTimeout(()=>{this.triggerEvent("triggerRender",void 0)},n):this.triggerEvent("triggerRender",void 0)}}clearRecoveryGraphsForTests(){return qJ()}async refreshGraphs(){this.isLoadingGraphs=!0,this.syncError=!1,this.triggerEvent("triggerRender",void 0);let e;switch(this.product){case"graphing":e=B3({product:this.product,lang:this.getLanguage()});break;case"geometry-calculator":{e=Promise.all([B3({product:this.product,lang:this.getLanguage()}),RN().catch(t=>{Ii("Error loading constructions from legacy geometry backend: "+String(t))})]);break}case"graphing-3d":{e=$J();break}case"geometry":{e=RN();break}}try{let t=await e;Array.isArray(t)||(t=[t]);let i=t.reduce((o,n)=>o.concat((n==null?void 0:n.myGraphs)||(n==null?void 0:n.myConstructions)||[]),[]);this.lastSync=Date.now(),this.setSavedGraphsFromJSON(i)}catch(t){this.syncError=!0,this.triggerEvent("onSyncError",void 0)}finally{this.isLoadingGraphs=!1,this.triggerEvent("triggerRender",void 0),this.triggerEvent("graphsLoaded",void 0)}}getRecoveryGraphs(){return this.__recoveryGraphs.slice(0)}getSavedGraphs(){return this.__savedGraphs.slice(0)}getExampleGraphs(){return this.__exampleGraphs.slice(0)}getEasterEggGraphs(e){return __dcg_shared_module_exports__['i'](this.__easterEggGraphs,t=>t.easterEgg===e)}getSavedAndExampleGraphs(){return this.__savedGraphs.concat(this.__exampleGraphs)}setSavedGraphsFromJSON(e){e||(e=[]),e.sort((t,i)=>{let o=new Date(t.created);return new Date(i.created).valueOf()-o.valueOf()}),this.__savedGraphs=e.map(t=>{let i=ra.fromAjax(t),o=this._getCachedGraphInfo(i);return o?o.graph:(this._addGraphToCache(i),i)}),this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0)}setRecoveryGraphsFromJSON(e){e||(e=[]),this.__recoveryGraphs=e.map(t=>{let i=ra.fromAjax(t);i.draft=!0,i.recovery=!0;let o=this._getCachedGraphInfo(i);return o?o.graph:(this._addGraphToCache(i),i)}),this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0)}getSavedGraphsAsJSON(){return this.__savedGraphs.map(ra.toAjax)}_enableLoadingGraphStates(){clearTimeout(this.__loadNextGraphStateTimeout);let e=()=>{this._loadNextGraphState(),this.__loadNextGraphStateTimeout=setTimeout(e,50)};e()}_disableLoadingGraphStates(){clearTimeout(this.__loadNextGraphStateTimeout)}async _loadNextGraphState(){if(this.__currentAjaxRequest)return;let e=this._dequeueGraphInfo();if(e){this.__currentAjaxRequest=this.loadGraphImmediately(e.graph);try{await this.__currentAjaxRequest}catch(t){}this.__currentAjaxRequest=void 0}}async loadGraphImmediately(e){if(e.graphData)return;let t=e.stateURL,i=this._getCachedGraphInfo(e);i.isDataLoading=!0;try{let o=await fetch(`${t}?${new URLSearchParams(Ip)}`),n=await o.json();if(!o.ok)throw n;return e.graphData=n,this.product==="geometry-calculator"&&z9(t)&&(e.graphData=fh(e.graphData),e.isMigratedFromLegacyGeometry=!0),i.didDataLoadFail=!1,n}catch(o){throw i.didDataLoadFail=!0,o}finally{i.isDataLoading=!1,this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0)}}_getCachedGraphInfo(e){return e&&this.__graphInfoCache[e.getCollectionKey()]}_addGraphToCache(e){this.__graphInfoCache[e.getCollectionKey()]={graph:e}}_enqueueGraphInfo(e){this.__nextAjaxRequestPriority||(this.__nextAjaxRequestPriority=0),e.ajaxPriority=++this.__nextAjaxRequestPriority}_dequeueGraphInfo(){let e=-1/0,t;for(let i in this.__graphInfoCache){let o=this.__graphInfoCache[i],n=o.ajaxPriority;n!==void 0&&n>e&&(e=n,t=o)}return!__dcg_shared_module_exports__['H'](t)||t===void 0?null:(delete t.ajaxPriority,t)}loadDataForGraph(e){if(!e)return;let t=this._getCachedGraphInfo(e);if(!t)throw new Error('graphsController does not have a reference to graph with hash "'+e.hash+'"');t.graph.graphData||(t.isDataLoading=!0,t.didDataLoadFail=!1,this._enqueueGraphInfo(t),this.triggerEvent("triggerRender",void 0))}didDataLoadFail(e){let t=this._getCachedGraphInfo(e);return!!(t&&t.didDataLoadFail)}didDeleteGraphFail(e){let t=this._getCachedGraphInfo(e);return!!(t&&t.didDeleteGraphFail)}isDeletingGraph(e){let t=this._getCachedGraphInfo(e);return!!(t&&t.isDeletingGraph)}canCancelDelete(e){let t=this._getCachedGraphInfo(e);return!!(t&&t.canCancelDelete)}loadGraph(e,t){this.previousGraph=this.currentGraph?this.currentGraph.copy():new ra,this.previousGraph.graphData=JSON.stringify(this.api.getState());let i=e.copy();delete i.example,this.api.setState(i.graphData,{forceExpressionsOpen:!0,forceUnsavedChanges:!!i.recovery,allowUndo:t&&t.allowUndo}),this.currentGraph=i,this._onCurrentGraphChanged(),this.recoveryParentHash=this.currentGraph.hash,(!t||!t.allowUndo)&&this.triggerEvent("clearUndoRedo",void 0),i.recovery||this.triggerEvent("clearUnsavedChanges",void 0),this.triggerEvent("triggerRender",void 0),this.triggerEvent("onLoadGraph",void 0)}restorePreviousGraph(){let e=this.previousGraph.copy()||new ra;this.loadGraph(e),this.triggerEvent("restoredGraph",{graph:e})}clearGraph(e){this.loadGraph(new ra,e),this.triggerEvent("onClearGraph",void 0)}defaultTitle(){switch(this.product){case"graphing":return this.s("account-shell-heading-graphingcalc-page-title");case"graphing-3d":return this.s("account-shell-heading-3dcalc-page-title");case"geometry-calculator":return this.s("account-shell-heading-geometry-page-title");case"geometry":return this.s("account-shell-heading-geometry-legacy-page-title")}}_onCurrentGraphChanged(){let e=this.currentGraph;e.title?document.title=this.s("account-shell-heading-named-graph",{title:e.title}):document.title=this.defaultTitle(),this._replaceState(e)}_replaceState(e){if(!(window.history&&history.replaceState))return;let t=e.getURL();t&&(window.location.search&&(t+=window.location.search),t!==window.location.href&&history.replaceState(e.hash,e.title,t))}toast(e,t){this.triggerEvent("toast",{message:e,opts:t})}clearGraphByUserAction(){let e;if(this.currentGraph.hash||this.currentGraph.questHash){this.clearGraph(),e=this.product==="geometry"?this.s("account-shell-text-new-construction-created"):this.s("account-shell-text-new-graph-created"),this.toast(e,{undoCallback:()=>{this.restorePreviousGraph(),this._replaceState(this.currentGraph)}});return}let t=this.api.getState();this.clearGraph({allowUndo:!0}),e=this.product==="geometry"?this.s("account-shell-text-construction-cleared"):this.s("account-shell-text-graph-cleared"),this.toast(e,{undoCallback:()=>{this.api.setState(t,{forceExpressionsOpen:!0,allowUndo:!0})}})}getSaveFailureMessage(){return this.lastSaveFailureMessage||""}isSaving(){return!!this.saving}didSaveFail(){return!!this.recentSaveFailure}didSaveSucceed(){return!!this.recentSaveSuccess}isSyncing(){return!!this.isLoadingGraphs}didSyncFail(){return!!this.syncError}didFetchRecoveryGraphsFail(){return this.fetchRecoveryGraphsError}getCurrentDisplayDate(){return this.currentGraph.displayDate()}getCurrentGraphTitle(){return this.currentGraph.title}getCurrentGraphHash(){return this.currentGraph.hash}getUntitledString(){return this.product==="geometry"?this.s("account-shell-text-untitled"):this.product==="graphing"?this.s("account-shell-text-untitled-graph"):this.product==="graphing-3d"?this.s("account-shell-text-untitled-graph"):this.product==="geometry-calculator"?this.s("account-shell-text-untitled"):(Ii("Unknown product: "+this.product),"Untitled")}hasUnsavedChanges(){return this.api.hasUnsavedChanges()}};af();var X0=class{constructor(e){this.s=uc(()=>this._language);this._language=Jv(),this.Calc=e}raw(e,t){return Kl(e,t)}unpack(e){return Mp(e,this._language)}getLanguage(){return this._language}updateUrl(e){if(!(window.history&&history.replaceState))return;let{origin:t,pathname:i,search:o,hash:n}=location,a=Ek(o,"lang",e),s=`${t}${i}${a}${n}`;history.replaceState(null,"",s)}setHeaderController(e){this.headerController=e}fetchAndSetLanguage(e){vy(e).then(()=>{this._language=e,this.Calc.updateSettings({language:e}),this.updateUrl(e),this.headerController&&this.headerController.triggerRender()})}};as();qt();qt();var XQ=!!pr("disableWorkerOnZoom"),Lfe=1e3;function Pfe(){return new Ec(1024,768)}function JQ(){return new di(__dcg_shared_module_exports__['kc'].xmin,__dcg_shared_module_exports__['kc'].xmax,__dcg_shared_module_exports__['kc'].ymin,__dcg_shared_module_exports__['kc'].ymax,__dcg_shared_module_exports__['kc'].zmin,__dcg_shared_module_exports__['kc'].zmax)}var iP=class extends Hx{constructor(t,i,o,n){super({elt:t,settings:i,controller:o,evaluator:n});this.type="3d";this.screen=Pfe();this.redrawTickCount=0;let a=JQ();this.setUserRequestedViewport(a),this.viewportController=new mI(a,this),this.graphSketches={};let s=document.createElement("canvas");s.className="dcg-webgl-canvas",this.webglLayer=new oS(s,o),this.elt.appendChild(s),this.transition=new bI,this.controls=new fI(this.webglLayer.spinningWorld,this,this.canvasLayer.canvasNode),this.controls.setWorldRotation(uu()),this.controls.unsnappedRotation.copy(this.controls.worldRotation3D),this.addKeydownEventHandler()}isDefaultDomain(){let t=this.viewportController.getViewport(),i=this.getDefaultViewport();return t.xmin===i.xmin&&t.xmax===i.xmax&&t.ymin===i.ymin&&t.ymax===i.ymax&&t.zmin===i.zmin&&t.zmax===i.zmax}startZoom(){XQ&&this.evaluator.setTicksEnabled(!1)}endZoom(){XQ&&this.evaluator.setTicksEnabled(!0)}remove(){this.controls.dispose(),this.elt.remove(),this.viewportController.remove(),this.webglLayer.remove()}tick(t){this.redrawTickCount+=1,this.controller.getGrapher2d().tick(t),wY(this.controls);let i=this.webglLayer.getZoomScrollWheelPickResult();this.webglLayer.pickAtMouseAndReadResults();let o=this.webglLayer.getZoomScrollWheelPickResult();__dcg_shared_module_exports__['E'](i,o)||(this.__redrawRequested=!0),(!this.lastRenderedWorldRotation||!this.lastRenderedWorldRotation.equals(this.controls.worldRotation3D))&&(this.__redrawRequested=!0,this.lastRenderedWorldRotation=this.controls.worldRotation3D.clone()),this.__redrawRequested&&this._redrawAllLayers()}clear(){this.graphSketches={},this.controller.getGrapher2d().clear()}getGraphSketch(t){return this.graphSketches[t]}addGraphSketch(t){this.graphSketches[t.id]=t}removeGraphSketch(t){t in this.graphSketches&&delete this.graphSketches[t]}flatWorldRotation3D(){return[...this.controls.worldRotation3D.elements]}debounceUserRequestedRotationChange(){this.__debouncedRotationCommit||(this.__debouncedRotationCommit=__dcg_shared_module_exports__['A'](()=>{if(this.isDragging)return;let t=this.flatWorldRotation3D();(this.settings.worldRotation3D.length===0&&this.controls.worldRotation3D.equals(uu())||__dcg_shared_module_exports__['E'](this.settings.worldRotation3D,t))&&this.settings.axis3D===this.controls.axis3D&&this.settings.speed3D===this.controls.speed3D||this.controller.dispatch({type:"commit-user-requested-rotation",worldRotation3D:t,axis3D:this.controls.axis3D,speed3D:this.controls.speed3D})},Lfe)),this.__debouncedRotationCommit()}getDefaultViewport(){return JQ()}_updateScreenSize(t,i){if(t<=0||i<=0)return;let o=this.screen;o.width===t&&o.height===i||(this.screen=new Ec(t,i),this.viewportController.setScreen(this.screen))}getProjection(){return new wl(this.screen,this.viewportController.getViewport(),this.settings)}size(){let t=this.canvasLayer.ctx;if(!t)return this.controller.getGrapher2d().size();let{width:i,height:o}=t.canvas.getBoundingClientRect();return i===0||o===0?this.controller.getGrapher2d().size():{width:i,height:o}}update(){let{top:t,left:i,width:o,height:n}=this.controller.computeMajorLayout().grapher,a=this.baseplaneWidth(),s=this.controller.getGrapher2d();s.setCanvasSizeFor3D(a,a),s.update(),this.webglLayer.updateDomainObjects(),o>0&&n>0?(this._setIsVisible(!0),this._updateScreenSize(o,n),aa(this.elt,{position:"absolute",left:i+"px",top:t+"px",width:o+"px",height:n+"px"})):this._setIsVisible(!1)}deselectSketch(t){let i=this.getGraphSketch(t);i&&(i.selected=!1,i.showHighlight=!1)}selectSketch(t){let i=this.getGraphSketch(t);i&&(i.selected=!0,i.showHighlight=!0)}updateSketch(t,i){if(!i.length){this.removeGraphSketch(t);return}let o=new Fx(t,i);o.color=i[0].color;let n=this.getGraphSketch(t);n&&o.updateFrom(n);let a=!!this.controller.getPropagatedSelectedIds()[t];o.selected=a,o.showHighlight=a,this.addGraphSketch(o)}_redrawAllLayers(){if(!this.isVisible)return;let t=Date.now();this.__redrawRequested=!1,this.canvasLayer.resize(this.screen.width,this.screen.height),this.controls.update(),this._redrawWebglLayer(),this.events.triggerEvent("redraw",Date.now()-t),this.canvasLayer.updateAria(this.isVisible,0)}_redrawWebglLayer(){this.webglLayer.canvas.width=this.canvasLayer.canvasNode.width,this.webglLayer.canvas.height=this.canvasLayer.canvasNode.height,this.webglLayer.redraw(this.graphSketches,this.__sketchOrder)}_parseScreenshotOpts(t){return tR(t,this.settings,this.screen)}screenshot(t){let i=document.createElement("canvas"),o=this._parseScreenshotOpts(t);i.width=o.width*o.targetPixelRatio,i.height=o.height*o.targetPixelRatio;let n=this.screenshotToCanvas(i),a=i.toDataURL("image/png");return n&&n(),a}asyncScreenshot(t,i){t.format==="svg"&&__dcg_shared_module_exports__['M'].warn("Unsupported format 'svg' for 3d screenshot. Assuming 'png' format instead.");for(let o of["showLabels","showMovablePoints","mathBounds","mode"])t.hasOwnProperty(o)&&__dcg_shared_module_exports__['M'].warn(`Property ${o} is ignored for 3d screenshot.`);i(this.screenshot(t))}screenshotToCanvas(t){let i=new oS(t,this.controller);return i.spinningWorld.setRotationFromMatrix(new rr().setFromMatrix3(this.controls.worldRotation3D)),i.redraw(this.graphSketches,this.__sketchOrder),()=>i.remove()}_afterViewportChange(){this.webglLayer!==void 0&&this.webglLayer.updateDomainObjects()}computeConcreteViewport(t){return t}setGrapherState(t,i){t=__dcg_shared_module_exports__['cd'](Uc,t),(!i||!i.doNotClear)&&this.clear();for(let o in Uc)Uc.hasOwnProperty(o)&&this.settings.setProperty(o,t[o]);if("viewport"in t){let o=di.fromObject(t.viewport);this.setUserRequestedViewport(o),this.viewportController.setViewport(o),this.webglLayer!==void 0&&this.webglLayer.updateDomainObjects()}if("speed3D"in t&&(this.controls.speed3D=t.speed3D),"worldRotation3D"in t){let o=t.worldRotation3D;if(o.length===9){let n=new Go;n.set(o[0],o[3],o[6],o[1],o[4],o[7],o[2],o[5],o[8]),this.controls.setWorldRotation(n),this.controls.unsnappedRotation.copy(this.controls.worldRotation3D),!this.controls.isHorizonLevel()&&!pr("beta3d")&&(this.controls.setWorldRotation(uu()),this.controls.unsnappedRotation.copy(this.controls.worldRotation3D),this.controls.speed3D=0)}else this.controls.setWorldRotation(uu()),this.controls.unsnappedRotation.copy(this.controls.worldRotation3D)}"axis3D"in t&&(this.controls.axis3D=t.axis3D),this.controller.requestRedrawGraph()}baseplaneWidth(){let t=this.controller.computeMajorLayout().grapher,{width:i,height:o}=t;return i<360&&(o=360*(o/i),i=360),o<360&&(i=360*(i/o),o=360),Math.ceil(Math.min(i,o)*this.webglLayer.baseplaneMultiplier())}mathCoordinatesToScreenCoordinates(t){return this.webglLayer.mathCoordinatesToScreenCoordinates(t)}addKeydownEventHandler(){ie(this.elt).on("keydown",t=>{if(!this.controller.isGraphPaperFocused())return;let i=t;if(i.altKey||i.ctrlKey||i.metaKey)return;let o=Be(i);if(o==="Tab"){let a=i.shiftKey?"prev":"next";this.handleTabEvent(a,i),this.redrawAllLayers();return}let n=this.controller.getGrapher2d().poiController.keyboardAttentionManager.getKeyboardAttention();if(n){if(o==="Enter"||o==="Space"){let a=this.controller.getItemModel(n.calcId);Ly(a)&&this.controller.dispatch({type:"clickable-item-clicked",id:n.calcId,listIndex:n.listIndex})}return}o!=="Up"&&o!=="Down"&&o!=="Left"&&o!=="Right"||(i.stopPropagation(),i.preventDefault(),this.controls.applyTiltFromKeyboard(o,i.shiftKey),this.debounceUserRequestedRotationChange())}),ie(this.elt).on("keyup",()=>{this.controller.isGraphPaperFocused()&&this.controls.keyUp()})}getCanvasNode(){return this.webglLayer.canvas}getOrderedTabTargets(){return this.webglLayer.getOrderedTabTargets()}handleTabEvent(t,i){let n=this.controller.getGrapher2d().poiController.keyboardAttentionManager,s=n.getKeyboardAttention()!==void 0;if(t==="prev"&&!s){n.updateKeyboardAttention(void 0,{describe:!1}),this.webglLayer.updateDomainObjects();return}if(n.focusNextObjFromKeyboard({direction:t,allowWrapping:!1,selectNonClickables:!1})){i==null||i.preventDefault(),i==null||i.stopPropagation(),this.webglLayer.updateDomainObjects();return}else{n.updateKeyboardAttention(void 0,{describe:!1}),t==="prev"&&s&&(this.controller.dispatch({type:"set-focus-location",location:{type:"graph-paper"}}),this.speakGrapherFocusAriaLabel(),i==null||i.preventDefault(),i==null||i.stopPropagation()),this.webglLayer.updateDomainObjects();return}}speakGrapherFocusAriaLabel(){let i=this.elt.getElementsByClassName("dcg-graph-outer")[0].getAttribute("aria-label");i&&Te(i)}};var J0=class extends zh{constructor(e,t,i){super(e,{...t,product:"graphing-3d"},i),this._calc.initializeGrapher3d(iP),this._calc.grapher.update()}};Rc();var QQ=5*60*1e3;tn().fastAutoSave&&(QQ=5*1e3);var oP=class{constructor(e){this.defaultModalDevice="mouse";if(e.graphsController.product!==e.product)throw new Error("Programming error: mismatched product between graphsController and calculator-shell controller");this.userController=e.userController,this.graphsController=e.graphsController,this.tourController=e.tourController,this.languageController=e.languageController,this.mygraphsController=e.mygraphsController,this.api=e.api,this.raw=e.raw,this.s=e.s,this.getLanguage=e.getLanguage,this.unpack=e.unpack,this.product=e.product,this.SOMETHING_WENT_WRONG=this.s("account-shell-error-unknown"),this._openMenu="none",this._requestedContactForm=!1,this._feedbackMessage="",this.state={},this.languageController&&this.languageController.setHeaderController(this),this.hookupControllers(),this.hookupHotkeys(),this.dispatcher=new iu,this.dispatch=t=>(nf("dispatch::header-controller",{type:t.type}),this.dispatcher.dispatch(t)),this.dispatcher.register(t=>{switch(this.logDispatches(t),t.type){case"save-graph":this.saveGraph(t.device,t.payload);break;case"edit-title":this.launchEditTitle();break;case"close-modal":this.closeModal();break;case"toggle-menu":this.setOpenMenu(t.payload);break;case"open-mygraphs":this.setOpenMenu("none",!1),this.mygraphsController.openMygraphs();break;case"close-mygraphs":this.mygraphsController.closeMygraphs();break;case"render":break;case"show-modal":this.showModal(t);break;case"show-contact-form":this._requestedContactForm=t.showForm;break;default:return t}return this.triggerRender()}),this.lastRecoveryState={},this.checkRecoveryState()}logDispatches(e){e.type==="toggle-menu"&&this.getOpenMenu()!==e.payload?e.payload==="help"?this.logEvent({category:"help",action:"open-menu"}):e.payload==="art-contest"&&this.logEvent({category:"art-contest",action:"open-menu"}):e.type==="open-mygraphs"&&this.logEvent({category:"mygraphs",action:"open-menu"})}triggerRender(){}hookupControllers(){this.mygraphsController.observeEvent("onOpenMygraphs",()=>{this.isLoggedIn()&&this.graphsController.millisecondsSinceSync()>2*60*1e3&&this.graphsController.refreshGraphs()}),this.mygraphsController.observeEvent("triggerRender",()=>{this.triggerRender()}),this.userController.observeEvent("loginChanged",()=>{this.mygraphsController.recoveryAttempted=!1,this.isLoggedIn()?this.graphsController.refreshGraphs():this.graphsController.clear()}),this.graphsController.observeEvent("graphsLoaded",()=>{this._isSavingGraph&&this.simpleSave(this.getModalDevice())}),this.userController.observeEvent("userUpdated",()=>{pr("actions")===void 0&&"_calc"in this.api&&this.api._calc.setOption("actions",this.isActionsFlagEnabled()?!0:"auto")}),this.userController.observeEvent("triggerRender",()=>{this.triggerRender()}),this.graphsController.observeEvent("triggerRender",()=>{this.triggerRender()})}hookupHotkeys(){ie(document).on("keydown",e=>{let t,{altKey:i,ctrlKey:o,metaKey:n,shiftKey:a}=e;if(Ti?t=!o&&n&&!i&&!a:t=o&&!n&&!i&&!a,t)switch(ji(e)){case"S":return this.simpleSave("keyboard"),!1;case"O":return this.dispatch({type:"open-mygraphs"}),!1}})}disablePrintAndExport(){this._disablePrintAndExport=!0}shouldDisablePrintAndExport(){return this.product==="graphing-3d"?!0:!!this._disablePrintAndExport}getOpenMenu(){return this._openMenu}getModalState(){return this._openModal||{modal:"none"}}getOpenModal(){var e,t;return(t=(e=this._openModal)==null?void 0:e.modal)!=null?t:"none"}hasOpenModal(){return!!this._openModal}getModalDevice(){var e;return(e=this._openModal)==null?void 0:e.device}getModalStartingError(){var e;return((e=this._openModal)==null?void 0:e.error)||""}closeModal(){var e,t;(((e=this._openModal)==null?void 0:e.modal)!=="login"&&((t=this._openModal)==null?void 0:t.modal)!=="signup"||!this.isLoggedIn())&&(this._isSavingGraph=!1),this._openModal=void 0,this.triggerRender()}closeMenu(){this._openMenu="none",this.maybeResetContactForm()}showModal(e){this.closeMenu(),this._openModal=e,this.defaultModalDevice=e.device}setOpenMenu(e,t=!0){var i,o;(e==="none"||e===this._openMenu&&t)&&((o=(i=this._lastActiveElement)==null?void 0:i.focus)==null||o.call(i)),this._openMenu=e===this._openMenu?"none":e,this._lastActiveElement=document.activeElement,this.maybeResetContactForm()}getFeedbackMessage(){return this._feedbackMessage}setFeedbackMessage(e){this._feedbackMessage=e}maybeResetContactForm(){this.getOpenMenu()!=="help"&&(this.getFeedbackMessage().trim().length||(this.setFeedbackMessage(""),this._requestedContactForm=!1))}getProduct(){return this.product}saveRecoveryState(){let e=this.graphsController.api.getState();var t=this.graphsController.saveRecoveryGraph();return this.lastRecoveryState=e,t}shouldSaveRecoveryState(){if(!this.userController.isLoggedIn()||!this.graphsController.hasUnsavedChanges())return!1;let e=this.graphsController.api.getState();return!__dcg_shared_module_exports__['E'](e,this.lastRecoveryState)}checkRecoveryState(){this.graphsController.isRecoveryUIEnabledForProduct()&&setTimeout(()=>{this.checkRecoveryState(),this.shouldSaveRecoveryState()&&this.saveRecoveryState()},QQ)}isLoggedIn(){return this.userController.isLoggedIn()}isInMaintenanceMode(){return!!pr("maintenance")}getPreviewParams(){return pr("previewMode")?{url:pr("previewFeedbackUrl"),message:pr("previewMessage")}:null}isDecimalToFractionEnabled(){return!!pr("decimalToFraction")}isSaveEnabled(){return this.graphsController.isSaveEnabled()}saveGraph(e,t){this.isLoggedIn()?(this.graphsController.save({newTitle:t==null?void 0:t.title,saveCopy:!!(t!=null&&t.saveAs)}),this.closeModal(),this.closeMenu(),this._isSavingGraph=!1):this.showModal({modal:"login",device:e})}simpleSave(e=this.defaultModalDevice){this.userController.isLoggedIn()?this._isSavingGraph&&this.graphsController.wasCurrentGraphEverSaved()?this.dispatch({type:"show-modal",modal:"duplicate",device:e}):this.graphsController.isCurrentGraphTitled()?(this.saveGraph(e||"mouse"),this.dispatch({type:"render"})):this.openSaveDialog({device:e}):(this._isSavingGraph=!0,this.dispatch({type:"show-modal",modal:"login",device:e}))}openSaveDialog(e={}){this.showModal({modal:"save",device:e.device||this.defaultModalDevice,fromSaveInProgress:e.fromSaveInProgress}),this.dispatch({type:"render"})}launchEditTitle(){this.closeMenu(),!(this.getPreviewParams()!=null||this.isInMaintenanceMode())&&(this.isLoggedIn()?this.product==="geometry"?this.showModal({modal:"save",device:this.defaultModalDevice}):this.showModal({modal:"rename",device:this.defaultModalDevice}):this.showModal({modal:"signup",device:this.defaultModalDevice}))}getOpenText(){switch(this.product){case"graphing":case"geometry-calculator":case"graphing-3d":return this.s("account-shell-button-open-graph");case"geometry":return this.s("account-shell-button-open-construction")}}getArtContestStatus(){if(Pb.isInApp())return"inactive";let e="promoted",t=tn().contest;return t==="open"||t==="closed"||t==="inactive"?t:e}isGraphComplexEnoughForContest(){if(!(this.api instanceof Eu||this.api instanceof Lm||this.api instanceof J0))return!1;let e=this.api.getState(),{list:t}=e.expressions;return t.filter(o=>o.type!=="folder"&&(o.type!=="expression"||!!o.latex&&o.latex!=="")).length>=1}shouldShowArtContestNudge(){return this.getArtContestStatus()==="open"&&this.isGraphComplexEnoughForContest()&&this.isLoggedIn()&&!this.graphsController.willSaveCopy()}getLimitedSignupRole(){return"student"}wasModalOpenedWithKeyboard(){var e;return((e=this._openModal)==null?void 0:e.device)==="keyboard"}allowSignInWithApple(){return!0}getSomethingWentWrongText(){return this.s("account-shell-error-unknown")}logEvent(e){xo(e)}parseJSONErrors(e){return bV(e)}requestedContactForm(){return this.product==="geometry-calculator"?!0:this._requestedContactForm}isActionsFlagEnabled(){return this.userController.hasFeatureFlag("dcg-actions")}};qt();var _fe=0,Q0=class{constructor(e,t,i){this.__id=_fe++,this.controller=e,this.headerController=t,this.userController=t.userController,this.mygraphsController=t.mygraphsController,this.instanceHotkeys=i,this.startListening()}remove(){this.stopListening()}startListening(){this.isListening||(ie(document).on("keydown.dcg-global-keyboard-listener-"+this.__id,e=>this.handleGlobalKeydown(e)),this.isListening=!0)}stopListening(){this.isListening&&(ie(document).off("keydown.dcg-global-keyboard-listener-"+this.__id),this.isListening=!1)}handleGlobalKeydown(e){let t=!1;if(tf(e)||rf(e))(!this.controller.getRootElt()||document.activeElement&&document.activeElement!=document.body&&!document.activeElement.closest(".dcg-dom-change-wrapper"))&&(t=!0);else if(!e.ctrlKey&&!e.altKey&&!e.metaKey&&!e.shiftKey&&Be(e)===rn)t=this.handleEscape(e);else if(RP(e))e.preventDefault(),e.stopPropagation(),t=!0,this.headerController.dispatch({type:"show-modal",modal:"hotkeys",device:"keyboard"});else if(e.ctrlKey&&(e.altKey||e.metaKey)&&!e.shiftKey)if(ji(e)==="A")if(e.preventDefault(),e.stopPropagation(),t=!0,this.userController.isLoggedIn())this.headerController.dispatch({type:"toggle-menu",payload:this.mygraphsController.isMygraphsOpen()?"account-mygraphs":"account"});else{let i=document.querySelector(".dcg-sign-in");this.triggerKeyboardTapEvent(i)}else ji(e)==="L"?(e.preventDefault(),e.stopPropagation(),t=!0,this.headerController.dispatch({type:"toggle-menu",payload:"language"})):ji(e)==="H"?(e.preventDefault(),e.stopPropagation(),this.headerController.dispatch({type:"toggle-menu",payload:"help"})):ji(e)==="S"&&(e.preventDefault(),e.stopPropagation(),t=!0,this.headerController.dispatch({type:"toggle-menu",payload:"share"}));t||this.instanceHotkeys.handleKeydown(e)}handleEscape(e){let t=!1,i=this.headerController.getModalState().modal!=="none",o=!!document.querySelector(".graph-preview"),n=this.mygraphsController.isMygraphsOpen(),a=!1;if(i)this.headerController.dispatch({type:"close-modal"}),a=!0;else if(o){let s=document.querySelector(".dcg-action-close-resources");Zu(s)&&this.triggerKeyboardTapEvent(s),a=!0}else n&&(this.headerController.dispatch({type:"close-mygraphs"}),a=!0);if(a){if(!Sp)if(!o&&!(i&&n)){let s=this.controller.getSelectedItem();if(s)this.controller.dispatch({type:"move-focus-to-item",id:s.id});else{let l=this.controller.getItemModelByIndex(0);l&&this.controller.dispatch({type:"move-focus-to-item",id:l.id})}}else i&&n&&document.querySelector(".new-blank-graph").focus();e.preventDefault(),e.stopPropagation(),t=!0}return t}triggerKeyboardTapEvent(e){if(!e)return;let t=ie.Event("dcg-tap");t.device="keyboard",ie(e).trigger(t)}};af();var FN={};function nP(r){let e=r.toString();e=e.replace(/=&/g,"&").replace(/=$/,"");let t=`${window.location.pathname}${e?"?"+e:""}`;window.location.href!==t&&history.replaceState({},"",t)}var aP=class{constructor(e,t,i){this.isUndoing=!1;this.currentValidationStatus="never-validated";this.CHECK_ANIMATION_DELAY=900;this.didCloseSuccessModal=!1;this.currentQuestIsClosing=!1;this.questWindowPos=void 0;this.controller=e,this.tourController=t,this.validator=new d0(this.controller),this.graphsController=i}isValidQuestId(e){return e in Ll}removeQuestFromQueryParams(){let e=new URLSearchParams(window.location.search);e.delete("quest"),nP(e)}getUrlForQuest(e){let t=new URLSearchParams(window.location.search);return t.delete("quest"),t.append("quest",e),`/3d?${t.toString()}`}startQuest(e,t={}){var o,n,a,s,l;if(this.currentQuestIsClosing=!1,this.isValidatingStep=void 0,this.isUndoing=!1,this.didCloseSuccessModal=!1,this.setHintsVisible(!1),this.tourController.stopTour("exit"),this.currentValidationStatus="never-validated",!(e in Ll))return;this.currentQuestId=e;let i=this.getCurrentQuest();if(i){if(this.graphsController.previousGraph=this.graphsController.currentGraph?this.graphsController.currentGraph.copy():new ra,this.graphsController.previousGraph.graphData=JSON.stringify(this.controller.getState()),this.cachedOldCalcState=this.controller.getState(),i!=null&&i.startingState&&!t.isUndoing&&this.controller.setState(i.startingState),this.controller.getGraphSettings().setProperty("defaultState",i.startingState),this.controller.dispatch({type:"render"}),!t.isLoadingFromUrl){let c=this.getUrlForQuest(this.currentQuestId);this.cachedPreviousUrl=window.location.href,window.location.href!==c&&history.replaceState({},"",c)}this.graphsController.currentGraph=new ra,this.graphsController.currentGraph.title=this.controller.s("graphing-calculator-heading-quest",{title:(n=(o=this.getCurrentQuest())==null?void 0:o.title)!=null?n:""}),this.graphsController.currentGraph.questHash=this.currentQuestId,this.graphsController._onCurrentGraphChanged(),xo({category:"quest",action:"start",name:(a=this.getCurrentQuest())==null?void 0:a.title}),this.tourController.triggerEvent("startQuest",void 0),this.currentQuestStartTime=Date.now(),this.cancelChangeSubcription=this.controller.subscribeToChanges(()=>this.tourController.updateRootView()),!t.isUndoing&&!t.isLoadingFromUrl&&(this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-tours-narration-quest-started",{title:(l=(s=this.getCurrentQuest())==null?void 0:s.title)!=null?l:""}),undoCallback:()=>{this.isUndoing=!0,this.stopQuest(),this.graphsController.restorePreviousGraph()}}}),t.isLoadingFromUrl||this.controller.dispatch({type:"set-focus-location",location:{type:"quest",location:"quest-pane"}})),this.controller.runAfterDispatch(()=>this.tourController.updateRootView())}}getCurrentQuest(){if(this.currentQuestId)return Ll[this.currentQuestId]}getQuestActive(){return!!this.currentQuestId}getQuestGoals(){var e,t;return(t=(e=this.getCurrentQuest())==null?void 0:e.goals)!=null?t:[]}getQuestValidationStatus(){return this.currentValidationStatus}stopQuest({doRedirect:e}={doRedirect:!0}){if(!this.currentQuestId)return;this.currentQuestIsClosing=!0,this.isValidatingStep=void 0,this.tourController.updateRootView(),clearTimeout(this.validationTimeoutId),this.controller.getGraphSettings().setProperty("defaultState",void 0),this.cancelChangeSubcription&&this.cancelChangeSubcription(),this.removeQuestFromQueryParams();let{currentQuestId:t}=this;this.currentQuestStartTime=void 0;let i=setTimeout(()=>{this.currentQuestId=void 0,this.tourController.triggerEvent("stopQuest",void 0),this.tourController.updateRootView(),e&&this.removeQuestFromQueryParams()},300);this.isUndoing||this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-tours-narration-exiting-quest"),undoCallback:()=>{clearTimeout(i),this.startQuest(t,{isUndoing:!0})}}})}getGoalValidationStatus(e){switch(this.getQuestValidationStatus()){case"unvalidated":case"never-validated":return"unvalidated";case"complete":return"satisfied";case"incomplete":return e.satisfied?"satisfied":"unsatisfied";case"validating":if(this.isValidatingStep===void 0)return"unvalidated";let t=this.getQuestGoals().indexOf(e);return t===this.isValidatingStep?"validating":t>this.isValidatingStep?"unvalidated":e.satisfied?"satisfied":"unsatisfied"}}checkQuestGoals(){if(!this.currentQuestId)return;this.tourController.stopTour("exit");let e=this.getQuestGoals();if(this.didCloseSuccessModal=!1,ay){e.forEach(t=>t.satisfied=this.validateGoal(t)),this.ariaAlertGoalStatus(),this.completeValidation();return}this.isValidatingStep=0,this.currentValidationStatus="validating",this.ariaAlertGoalStatus(),this.checkCurrentQuestGoal()}validateGoal(e){let t=!0;return e.expressionCriteria!==void 0&&(t=this.validator.hasMatchingExpression(e.expressionCriteria)),e.controllerCriteria!==void 0&&(t=t&&this.matchesControllerCriteria(e.controllerCriteria)),e.complexCriterion!==void 0?e.complexCriterion.call({},this.validator):t}startNextQuest(){var i;let e=Object.keys(Ll),t=0;if(this.currentQuestId){let o=e.findIndex(n=>n===this.currentQuestId);o<e.length-1&&(t=o+1)}xo({category:"quest",action:"start-next",name:(i=this.getCurrentQuest())==null?void 0:i.title}),this.stopQuest({doRedirect:!1}),setTimeout(()=>this.startQuest(e[t]),300)}getSuccessModalIsOpen(){return this.getQuestValidationStatus()==="complete"&&!this.didCloseSuccessModal}continueCurrentQuest(){var e;xo({category:"quest",action:"keep-playing",name:(e=this.getCurrentQuest())==null?void 0:e.title}),this.closeSuccessModal()}closeSuccessModal(){this.didCloseSuccessModal=!0,this.tourController.updateRootView()}setQuestWindowPos(e,t){this.questWindowPos={left:e,top:t}}getQuestWindowPos(){return this.questWindowPos}checkCurrentQuestGoal(){if(this.isValidatingStep===void 0)return;let e=this.isValidatingStep,t=this.getQuestGoals();if(e>=t.length)return this.completeValidation();t[e].satisfied=this.validateGoal(t[e]),this.tourController.updateRootView(),this.isValidatingStep++,this.validationTimeoutId=setTimeout(this.checkCurrentQuestGoal.bind(this),this.CHECK_ANIMATION_DELAY)}ariaAlertGoalStatus(){var t;let e=[];(t=this.getCurrentQuest())==null||t.goals.forEach(i=>{this.validateGoal(i)?e.push(this.controller.s("graphing-tours-narration-quest-goal-complete",{goal:i.text})):e.push(this.controller.s("graphing-tours-narration-quest-goal-incomplete",{goal:i.text}))}),e.length>0&&Te(e.join(" "))}matchesControllerCriteria(e){return Array.isArray(e)?e.every(t=>t(this.controller)):e(this.controller)}completeValidation(){var t;let e=this.getQuestGoals();clearTimeout(this.validationTimeoutId),this.isValidatingStep=void 0,this.currentValidationStatus=e.every(i=>i.satisfied)?"complete":"incomplete",this.currentValidationStatus==="complete"&&xo({category:"quest",action:"finish",name:(t=this.getCurrentQuest())==null?void 0:t.title,value:this.currentQuestStartTime?Date.now()-this.currentQuestStartTime:void 0}),this.tourController.updateRootView()}setHintsVisible(e){var i,o;this.isValidatingStep&&this.completeValidation(),this.hintsVisible=e;let t=(o=(i=this.tourController.rootView)==null?void 0:i.findRootNode())==null?void 0:o.querySelector(".dcg-quest__body");if(t)if(e){let n=t.getBoundingClientRect();t.style.height=`${n.height}px`,t.style.width=`${n.width}px`}else t.style.height="unset",t.style.width="unset";this.tourController.updateRootView(),e||this.tourController.stopTour()}getHintsVisible(){return this.hintsVisible}};var lP=__dcg_shared_module_exports__['e'](te());var sP=class extends Yr{constructor(t,i){super();this.questListModalIsOpen=!1;this.tourKeyDownListener=t=>{"key"in t&&t.key.startsWith("Esc")&&this.stopTour()};this.controller=t,this.questController=new aP(this.controller,this,i)}shouldPopupTour(t){if(this.controller.getItemCount()>3)return!0;let i=this.getTourClass(t);if(!i)return!1;let o=new i({id:()=>t,controller:()=>this.controller,tourController:()=>this},[]);return o&&o.shouldPopup?o.shouldPopup():!1}startTour(t,i=!1){if(this.mountedTour&&this.unmountTour(),!t||(this.buildTour(t),!this.mountedTour))return;this.isMiniTour=i;let o=this.isMiniTour?{category:"quest",action:"start-tour",name:t}:{category:"tour",action:"start",name:t};xo(o),setTimeout(()=>{this.mountedTour&&(this.mountedTour.update(),setTimeout(()=>{var n;return(n=this.tourContainerElt)==null?void 0:n.classList.add("dcg-tour-loaded")}))}),document.addEventListener("keydown",this.tourKeyDownListener)}startMiniTour(t){this.activeMinitour=t,this.startTour(t,!0),this.updateRootView()}startTourFromUrl(){let t=new URLSearchParams(window.location.search),i=t.get("quest");if(i){this.controller.is3dProduct()&&this.questController.isValidQuestId(i)&&!this.controller.isNarrow()?this.questController.startQuest(i,{isLoadingFromUrl:!0}):this.questController.removeQuestFromQueryParams();return}else this.controller.is3dProduct()&&t.has("showQuestsList")&&(this.questListModalIsOpen=!0);if(document.querySelectorAll(".dcg-expressionitem").length<2){setTimeout(this.startTourFromUrl.bind(this),100);return}let o=oh(location.search,"tour");o&&this.startTour(o)}getTourClass(t){var i;if(t==="baseTour")return Am;if(this.controller.is3dProduct()&&t in FN)return(i=FN[t])==null?void 0:i.tour;if(t in u0)return u0[t].tour;if(t in sv)return sv[t].tour}buildTour(t){t===this.tourId?this.stopTour("restart"):this.stopTour("exit"),this.tourId=t;let i=this.getTourClass(t);if(i)return this.mountTour(t,i)}mountTour(t,i){var o;return this.tourContainerElt||(this.tourContainerElt=document.createElement("div"),this.tourContainerElt.id="dcg-tour-container",(o=this.controller.getRootElt())==null||o.append(this.tourContainerElt)),this.mountedTour=lP.mountToNode(i,this.tourContainerElt,{controller:()=>this.controller,tourController:()=>this,id:()=>t}),this.mountedTour}unmountTour(){this.mountedTour&&this.tourContainerElt&&lP.unmountFromNode(this.tourContainerElt),this.mountedTour=void 0,this.tourId=void 0}getActiveMinitour(){return this.activeMinitour}stopTour(t="finish"){if(!(!this.mountedTour||!this.tourContainerElt)){if(this.activeMinitour=void 0,this.clearTimeouts(),document.removeEventListener("keydown",this.tourKeyDownListener),this.tourContainerElt.classList.remove("dcg-tour-loaded"),setTimeout(()=>{this.activeMinitour||this.unmountTour()},300),t==="finish"){let i=this.isMiniTour?{category:"quest",action:"finish-tour",name:this.tourId}:{category:"tour",action:"finish",name:this.tourId};xo(i)}this.updateRootView()}}forceUpdate(){this.mountedTour&&this.mountedTour.update()}addInterval(t){this.intervalId!==void 0&&(clearInterval(this.intervalId),this.intervalId=void 0),this.intervalId=setInterval(()=>{this.mountedTour&&this.mountedTour.update()},t)}addUpdateTimeout(t){this.updateTimeoutId!==void 0&&(clearTimeout(this.updateTimeoutId),this.updateTimeoutId=void 0),this.updateTimeoutId=setTimeout(()=>{this.mountedTour&&this.mountedTour.update()},t)}clearTimeouts(){clearTimeout(this.updateTimeoutId),clearInterval(this.intervalId),this.intervalId=void 0,this.updateTimeoutId=void 0}setRootView(t){this.rootView=t}updateRootView(){var t;(t=this.rootView)==null||t.update()}setQuestsListModalVisibility(t){this.questListModalIsOpen=t;let i=new URLSearchParams(window.location.search);t?(i.set("showQuestsList",""),xo({category:"quest",action:"open-list",name:"3d-expression-list"})):i.delete("showQuestsList"),nP(i),this.updateRootView()}getQuestsListModalIsOpen(){return this.questListModalIsOpen}getSuccessModalIsOpen(){return this.questController.getSuccessModalIsOpen()}continueCurrentQuest(){return this.questController.continueCurrentQuest()}closeSuccessModal(){return this.questController.closeSuccessModal()}startQuest(t){return this.questController.startQuest(t)}startQuestFromUndo(t){return this.questController.startQuest(t,{isUndoing:!0})}startNextQuest(){return this.questController.startNextQuest()}getCurrentQuest(){return this.questController.getCurrentQuest()}getQuestActive(){return this.questController.getQuestActive()}getQuestGoals(){return this.questController.getQuestGoals()}getQuestValidationStatus(){return this.questController.getQuestValidationStatus()}stopQuest(){return this.questController.stopQuest()}getGoalValidationStatus(t){return this.questController.getGoalValidationStatus(t)}validateGoal(t){return this.questController.validateGoal(t)}getCurrentQuestIsClosing(){return this.questController.currentQuestIsClosing}setQuestWindowPos(t,i){return this.questController.setQuestWindowPos(t,i)}getQuestWindowPos(){return this.questController.getQuestWindowPos()}checkQuestGoals(){return this.setHintsVisible(!1),this.questController.checkQuestGoals()}getUrlForQuest(t){return this.questController.getUrlForQuest(t)}setHintsVisible(t){return this.questController.setHintsVisible(t)}getHintsVisible(){return this.questController.getHintsVisible()}};var cP=class extends Yr{constructor(t,i,o,n){super();this.recoveryAttempted=!1;this.isOpen=!1;this.graphsController=t,this.userController=n,this.api=i,this.s=o,this.pageLoadTime=Date.now()}isMygraphsOpen(){return this.isOpen}hasAttemptedRecovery(){return this.recoveryAttempted}openMygraphs(){var t;this.recoveryAttempted=!1,this.isOpen=!0,document.body.classList.add("resources-open"),Te(this.s("account-shell-narration-mygraphs-open-graph")),pi(),(t=document.querySelector(".dcg-action-newblankgraph"))==null||t.focus(),this.triggerEvent("onOpenMygraphs",void 0)}closeMygraphs(){this.isOpen=!1,document.body.classList.remove("resources-open")}openBlankGraph(){this.triggerEvent("beforeChangeOpenedGraph",void 0),this.closeMygraphs(),this.graphsController.clearGraphByUserAction(),this.triggerEvent("triggerRender",void 0)}onOpenGraph(t){this.triggerEvent("beforeChangeOpenedGraph",void 0);let i=this.copyGraphWithTranslation(t);this.graphsController.loadGraph(i),this._concludeOpenGraph(i)}toast(t,i){this.triggerEvent("toast",{message:t,opts:i})}_concludeOpenGraph(t){if(t.isMigratedFromLegacyGeometry)this.showLegacyGeometryMigrationToast(t);else{let i=t.title||this.graphsController.getUntitledString();this.toast(this.s("account-shell-text-mygraphs-opened-graph",{graphTitle:i}),{undoCallback:()=>{this.graphsController.restorePreviousGraph()}})}this.closeMygraphs(),this.triggerEvent("triggerRender",void 0),tV(this.graphsController.product==="geometry-calculator"||this.graphsController.product==="graphing-3d")}showLegacyGeometryMigrationToast(t){this.toast(this.s("account-shell-text-graph-migrated-from-geometry",{title:t.title}),{link:{text:this.s("shared-calculator-label-toast-learn-more"),url:"https://help.desmos.com/hc/en-us/articles/17817122756877"}})}copyGraphWithTranslation(t){var i=t.copy();return t.i18nKey&&(i.title=this.s(t.i18nKey)),i}openGraphBehindCover(t){var i=this.copyGraphWithTranslation(t);return this.graphsController.loadGraph(i),new Promise(o=>{this.graphsController.product==="graphing"||this.graphsController.product==="graphing-3d"||this.graphsController.product==="geometry-calculator"?(this.api._calc.evaluator.notifyWhenSynced(function(){o()}),setTimeout(function(){o()},6e3)):this.graphsController.product==="geometry"&&o()}).then(()=>{this._concludeOpenGraph(i)})}getThumbnail(){return this.api.screenshot({width:200,height:200,targetPixelRatio:2})}};function ZQ(r){let e=JSON.parse(r.exampleGraphsRaw);PJ();let t=r.api;t.hasUnsavedChanges=function(){return t._calc.controller.hasUnsavedChanges()};let i=new X0(t),o=new tP,n=i.s.bind(i),a=i.raw.bind(i),s=i.unpack.bind(i),l=new rP({api:t,s:n,getLanguage:i.getLanguage.bind(i),examplesJSON:e,randomSeed:r.seed,product:r.product}),c=new sP(t._calc.controller,l),d=new cP(l,t,n,o);l.observeEvent("onClearGraph",function(){t.focusFirstExpression()}),d.observeEvent("toast",function(f,y){if(!y)return;let x={message:y.message};for(let E in y.opts)y.opts.hasOwnProperty(E)&&(x[E]=y.opts[E]);t._calc.controller.dispatch({type:"toast/show",toast:x})}),l.observeEvent("toast",function(f,y){if(!y)return;let x={message:y.message};for(let E in y.opts)y.opts.hasOwnProperty(E)&&(x[E]=y.opts[E]);t._calc.controller.dispatch({type:"toast/show",toast:x})}),l.observeEvent("clearUnsavedChanges",function(){t._calc.controller.dispatch({type:"clear-unsaved-changes"})}),l.observeEvent("clearUndoRedo",function(){t._calc.controller.dispatch({type:"clear-undoredo-history"})});let p=!1;t._calc.controller.subscribeToChanges(function(){let f=t._calc.controller.hasUnsavedChanges();f!==p&&h.triggerRender(),p=f});let g;t._calc.controller.triggerEasterEgg=function(f){let y=f==="betchacant"?t._calc.controller.s("account-shell-label-betchacant-loading"):t._calc.controller.s("account-shell-label-loading"),x=l.getEasterEggGraphs(f);x.length!==0&&(g=Math.floor(Math.random()*x.length),t._calc.controller.dispatch({type:"toast/show",toast:{message:y,hideAfter:0,toastStyle:"cover"}}),l.loadGraphImmediately(x[g]).then(function(){d.openGraphBehindCover(x[g])}))},pr("expressions")!==!1&&(t._calc.controller.triggerClearGraph=function(){l.clearGraphByUserAction()},t.observeEvent("openDrawer",function(){h.dispatch({type:"open-mygraphs"})}));let h=new oP({userController:o,graphsController:l,tourController:c,languageController:i,mygraphsController:d,api:t,s:n,raw:a,unpack:s,getLanguage:i.getLanguage.bind(i),product:r.product});return d.observeEvent("beforeChangeOpenedGraph",()=>{c.stopQuest()}),l.observeEvent("restoredGraph",(f,y)=>{y&&"graph"in y&&y.graph.questHash&&c.startQuestFromUndo(y.graph.questHash)}),c.observeEvent("startQuest",()=>h.triggerRender()),c.observeEvent("stopQuest",()=>h.triggerRender()),t._calc.controller.getQuestIsActive=()=>c.getQuestActive(),t._calc.controller.showContestDropdown=()=>{xo({category:"notice",action:"show-art-contest"}),h.dispatch({type:"toggle-menu",payload:"art-contest"})},t._calc.controller.showQuestModal=()=>c.setQuestsListModalVisibility(!0),t._calc.globalHotkeys=new Q0(t._calc.controller,h,t._calc.instanceHotkeys),t._calc.controller.setCanShowKeyboardShortcuts(!0),t.observeEvent("showHotkeysModal",function(){h.dispatch({type:"show-modal",modal:"hotkeys",device:"keyboard"})}),t._calc.controller.logEvent=xo,window.userController=o,window.headerController=h,window.tourController=c,{userController:o,graphsController:l,tourController:c,headerController:h}}var eZ=__dcg_shared_module_exports__['e'](te());function Ofe(r,e){var t=document.createElement("div");t.style.zIndex="999999",t.style.position="fixed",t.style.bottom="50px",t.style.left="0",t.style.right="0",document.body.append(t),eZ.mountToNode(_m,t,{s:e,didDataLoadFail:function(){return!0},requestLoadGraphData:function(){t.remove(),r()}})}function tZ(r,e){return new Promise(t=>{if(r&&r.state)t(r);else if(r&&typeof r.stateUrl=="string"){var i=!1;let o=async()=>{if(!i){i=!0;try{let n=await fetch(`${r.stateUrl}?${new URLSearchParams(Ip)}`,{headers:{Accept:"application/json"}});if(!n.ok)throw void 0;let a=await n.json();r.state=a,t(r)}catch(n){Ofe(o,e)}finally{i=!1}}};o()}else t(void 0)})}var Rfe=500*1024,rZ=[];function iZ(){for(var r=[],e=0,t=0;t<rZ.length;t++){let i=rZ[t];if(e+=i.size,e>Rfe)break;r.push(i.payload)}return r}var sZ=__dcg_shared_module_exports__['e'](nZ());function Ffe(r){return r.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&")}var Nfe=["UnhandledRejection","lnrAppboy","socratic","MyAppGet","SymBrowser_","mobincube_","_avast_submit","Cannot redefine property: googletag","jcarousel","SyntaxError: Unexpected identifier 'script'","__gCrWeb.autofill.extractForms","BrowseITEXT","Can't find variable: removeAllHighlights","aAttribruteValue.parentNode.getAttribute","vid_mate_check","GetImageTagSrcFromPoint","Can't find variable: didEnterViewPort","tinyMCE is not defined","div:has(> iframe[id='198230182308109283091823098102938908128390'])"],aZ=new RegExp(Nfe.map(Ffe).join("|"));function Bfe(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){let e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}function Ufe(){var r=window.Desmos&&window.Desmos.commit;return r}function zfe(){var r="production";if(location&&location.hostname){var e=location.hostname,t=e.split("."),i=t.slice(0,t.length-2).join("."),o=t.slice(t.length-2).join(".");o==="desmos.com"&&(!i||i==="www"?r="production":r=i)}return r}var dP=class{constructor(){this.numberOfSentErrors=0;this.pageLoadId=Bfe();this.bugsnagClient=sZ.default.start({apiKey:"7f7807097671acbc4557e64bbf5eb529",maxBreadcrumbs:40,appVersion:Ufe(),releaseStage:zfe(),onError:e=>this.onError(e),enabledBreadcrumbTypes:["error","navigation","request","user"]})}onError(e){let t=Xu;return t&&t[0]<=10||e.errors.some(i=>aZ.test(i.errorClass)||aZ.test(i.errorMessage))?!1:(this.beforeSendCb&&this.beforeSendCb(e),this.attachWebGLReport&&this.attachWebGLReport(e),this.numberOfSentErrors+=1,e.addMetadata("custom",{errorNumber:this.numberOfSentErrors,pageLoadId:this.pageLoadId}),!0)}setBeforeSendCB(e){this.beforeSendCb=e}setAttachWebGLReport(e){this.attachWebGLReport=e}leaveBreadcrumb(e,t,i){if(t){t={...t};for(let o in t)try{t[o]=JSON.stringify(t[o],null,2)}catch(n){t[o]="[[could not stringify]]"}}this.bugsnagClient.leaveBreadcrumb(e,t,i)}notify(e,t){this.bugsnagClient&&this.bugsnagClient.notify(e,i=>(t&&t.metaData&&i.addMetadata("custom",t.metaData),t&&t.context&&(i.context=t.context),t&&t.severity&&(i.severity=t.severity),!0))}};pr("testing")||Yz(new dP);async function lZ({calcConstructor:r,exampleGraphsRaw:e,extraOptions:t,product:i,notice:o,graphJSON:n}){let a=Jv(),s=await vy(a).then(()=>a,()=>"en"),l=ok();l.disableScrollFix||BY(),l={...l,border:!1,disableScrollFix:!0,showHamburger:!0,pasteGraphLink:!0,onlyTraceSelected:!0,showKeyboardShortcutsInTooltips:!0,...t};let c=document.getElementById("graph-container"),d=new r(c,l),p=ZQ({api:d,seed:Kh.seed,exampleGraphsRaw:e,product:i}),g=d._calc.controller;g.setBugsnagContext("main-controller"),o&&g.setNotice(o),d.updateSettings({language:s});let h=p.userController,f=p.graphsController,y=p.tourController,x=p.headerController,E=g.s.bind(g);Xz(function(I){let P=g.stateStack;P&&P.serializeForBugsnag&&I.addMetadata("states",P.serializeForBugsnag());let _=I.originalError;_&&_.dcgExtraErrorMetaData&&I.addMetadata("extraErrorData",_.dcgExtraErrorMetaData),I.addMetadata("codeEvents",iZ())});let C=new t0({calcController:g,graphsController:f});C.trackFeatureUsage("graph-feature","hasSlider"),C.trackFeatureUsage("graph-feature","hasRegression"),C.trackFeatureUsage("graph-feature","hasAction"),C.trackFeatureUsage("graph-feature","expressionErrors"),C.trackFeatureUsage("graph-feature","expressionCount"),C.trackFeatureUsage("graph-feature","folderCount"),C.trackFeatureUsage("graph-feature","imageCount"),C.trackFeatureUsage("graph-feature","tableCount"),C.trackFeatureUsage("graph-feature","textCount"),C.start(),VJ(h,E),pr("no_navigation_warning")||ie(window).on("beforeunload",function(){if(d.hasUnsavedChanges())return E("account-shell-text-confirm-leave")}),Kh.user&&h.completeLogin(Kh.user),Kh.graph||(f.clearGraph(),Kh.latex&&d.setExpression({latex:Kh.latex})),tV(i==="graphing-3d"||i==="geometry-calculator"),y.startTourFromUrl(),h.getEmailChangeToken()&&x.dispatch({type:"show-modal",modal:"change-email",device:"mouse"}),x.triggerRender=function(){S.update(),v.update(),M.update(),h.getEmailChangeToken()&&x.getOpenModal()!=="change-email"&&history.replaceState(null,"",document.location.pathname)};let S=Sv.mountToNode($V,document.getElementById("dcg-header-container"),{controller:function(){return x}}),v=Sv.mountToNode(BL,document.getElementById("dcg-modal-container"),{controller:function(){return x}}),M=Sv.mountToNode(ZL,document.getElementById("mygraphs-container"),{controller:Sv.const(x),makeAPI:function(I){return new r(I,{settingsMenu:!1,keypad:!1,zoomButtons:!1,branding:!1,border:!1,disableScrollFix:!0,expressions:!1,hideGeoUI:!0})}});Ju&&!iU&&!ny&&x.dispatch({type:"show-modal",modal:"unsupported-browser",device:"touch"}),document.location.search.match(/(\?|\&)create_account/)?(history.replaceState(null,"",document.location.pathname),h.isLoggedIn()?g.dispatch({type:"toast/show",toast:{message:E("account-shell-text-logged-in")}}):x.dispatch({type:"show-modal",modal:"signup",device:"mouse"})):document.location.search.match(/(\?|\&)login/)?(history.replaceState(null,"",document.location.pathname),h.isLoggedIn()?g.dispatch({type:"toast/show",toast:{message:E("account-shell-text-logged-in")}}):x.dispatch({type:"show-modal",modal:"login",device:"mouse"})):document.location.search.match(/(\?|\&)reset_password/)&&(history.replaceState(null,"",document.location.pathname),x.dispatch({type:"show-modal",modal:"recover-password",device:"mouse"})),window.matchMedia&&window.matchMedia("print").addListener(function(P){P.matches?g.dispatch({type:"enter-printmode"}):g.dispatch({type:"exit-printmode"})}),qS(document);let A=await tZ(n,E);return{Calc:d,graphsController:f,calcController:g,headerController:x,fullGraph:A}}async function Kfe(){let{Calc:r,graphsController:e,fullGraph:t}=await lZ({calcConstructor:Eu,exampleGraphsRaw:wU,extraOptions:{onlyTraceSelected:!1},product:"graphing",graphJSON:Kh.graph});return t&&t.state&&(t.state.graph.product==="geometry-calculator"?window.location.replace(document.location.href.split("/calculator/").join("/geometry/")):e.loadGraph(ra.fromAjax(t))),r}var cZ=Kfe();qt();typeof Desmos=="undefined"&&(Desmos={});function dZ(){Desmos.$=ie,Desmos.$.noConflict(!0)}rh(document.body);dZ();cZ.then(function(r){document.querySelector(".dcg-loading-div-container").style.display="none",window.Calc=r,L5()});
/*!
 * jQuery JavaScript Library v3.6.0
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2021-03-02T17:08Z
 */
/*!!
 *  Canvas 2 Svg v1.0.19
 *  A low level canvas to SVG converter. Uses a mock canvas context to build an SVG document.
 *
 *  Licensed under the MIT license:
 *  http://www.opensource.org/licenses/mit-license.php
 *
 *  Author:
 *  Kerry Liu
 *
 *  Copyright (c) 2014 Gliffy Inc.
 *
 *  Modifications by Desmos:
 *  - wrapped in AMD pattern
 *  - added ctx.ellipse() method
 *  - fixed image opacity bug
 *  - added ability to add classNames to exported svg elements
 *  - added ability to add named groups
 *  - removed dominant-basline attribute. Editors appear to ignore it. Must solve baseline issues using transformations
 */
})()